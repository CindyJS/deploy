/* CindyJS - (C) 2014-2016  The CindyJS Project
 * Mostly licensed under the Apache License 2.0, but subprojects may use different licensing.
 * See https://github.com/CindyJS/CindyJS/tree/515d277e317c487cb68a045ae0030e89a7248bf8
 * for corresponding sources and their respective licensing conditions.
 */
/*
 npm.im/iphone-inline-video 2.2.2  npm.im/intervalometer  https://github.com/paulmillr/es6-shim
 @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
   and contributors,  MIT License
 es6-shim: v0.35.4
 see https://github.com/paulmillr/es6-shim/blob/0.35.3/LICENSE
 Details and documentation:
 https://github.com/paulmillr/es6-shim/
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(J,V,ia){if(J==Array.prototype||J==Object.prototype)return J;J[V]=ia.value;return J};
$jscomp.getGlobal=function(J){J=["object"==typeof globalThis&&globalThis,J,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var V=0;V<J.length;++V){var ia=J[V];if(ia&&ia.Math==Math)return ia}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;
$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(J,V){var ia=$jscomp.propertyToPolyfillSymbol[V];if(null==ia)return J[V];ia=J[ia];return void 0!==ia?ia:J[V]};$jscomp.polyfill=function(J,V,ia,va){V&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(J,V,ia,va):$jscomp.polyfillUnisolated(J,V,ia,va))};
$jscomp.polyfillUnisolated=function(J,V,ia,va){ia=$jscomp.global;J=J.split(".");for(va=0;va<J.length-1;va++){var xa=J[va];if(!(xa in ia))return;ia=ia[xa]}J=J[J.length-1];va=ia[J];V=V(va);V!=va&&null!=V&&$jscomp.defineProperty(ia,J,{configurable:!0,writable:!0,value:V})};
$jscomp.polyfillIsolated=function(J,V,ia,va){var xa=J.split(".");J=1===xa.length;va=xa[0];va=!J&&va in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var Pa=0;Pa<xa.length-1;Pa++){var sb=xa[Pa];if(!(sb in va))return;va=va[sb]}xa=xa[xa.length-1];ia=$jscomp.IS_SYMBOL_NATIVE&&"es6"===ia?va[xa]:null;V=V(ia);null!=V&&(J?$jscomp.defineProperty($jscomp.polyfills,xa,{configurable:!0,writable:!0,value:V}):V!==ia&&(void 0===$jscomp.propertyToPolyfillSymbol[xa]&&(ia=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[xa]=
$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(xa):$jscomp.POLYFILL_PREFIX+ia+"$"+xa),$jscomp.defineProperty(va,$jscomp.propertyToPolyfillSymbol[xa],{configurable:!0,writable:!0,value:V})))};$jscomp.underscoreProtoCanBeSet=function(){var J={a:!0},V={};try{return V.__proto__=J,V.a}catch(ia){}return!1};
$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(J,V){J.__proto__=V;if(J.__proto__!==V)throw new TypeError(J+" is not extensible");return J}:null;$jscomp.arrayIteratorImpl=function(J){var V=0;return function(){return V<J.length?{done:!1,value:J[V++]}:{done:!0}}};$jscomp.arrayIterator=function(J){return{next:$jscomp.arrayIteratorImpl(J)}};
$jscomp.makeIterator=function(J){var V="undefined"!=typeof Symbol&&Symbol.iterator&&J[Symbol.iterator];return V?V.call(J):$jscomp.arrayIterator(J)};$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(J){if(!(J instanceof Object))throw new TypeError("Iterator result "+J+" is not an object");};
$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};
$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(J){this.yieldResult=J};$jscomp.generator.Context.prototype.throw_=function(J){this.abruptCompletion_={exception:J,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(J){this.abruptCompletion_={return:J};this.nextAddress=this.finallyAddress_};
$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(J){this.abruptCompletion_={jumpTo:J};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(J,V){this.nextAddress=V;return{value:J}};
$jscomp.generator.Context.prototype.yieldAll=function(J,V){J=$jscomp.makeIterator(J);var ia=J.next();$jscomp.generator.ensureIteratorResultIsObject_(ia);if(ia.done)this.yieldResult=ia.value,this.nextAddress=V;else return this.yieldAllIterator_=J,this.yield(ia.value,V)};$jscomp.generator.Context.prototype.jumpTo=function(J){this.nextAddress=J};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(J,V){this.catchAddress_=J;void 0!=V&&(this.finallyAddress_=V)};$jscomp.generator.Context.prototype.setFinallyBlock=function(J){this.catchAddress_=0;this.finallyAddress_=J||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(J,V){this.nextAddress=J;this.catchAddress_=V||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(J){this.catchAddress_=J||0;J=this.abruptCompletion_.exception;this.abruptCompletion_=null;return J};$jscomp.generator.Context.prototype.enterFinallyBlock=function(J,V,ia){ia?this.finallyContexts_[ia]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=J||0;this.finallyAddress_=V||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(J,V){V=this.finallyContexts_.splice(V||0)[0];if(V=this.abruptCompletion_=this.abruptCompletion_||V){if(V.isException)return this.jumpToErrorHandler_();void 0!=V.jumpTo&&this.finallyAddress_<V.jumpTo?(this.nextAddress=V.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=J};$jscomp.generator.Context.prototype.forIn=function(J){return new $jscomp.generator.Context.PropertyIterator(J)};
$jscomp.generator.Context.PropertyIterator=function(J){this.object_=J;this.properties_=[];for(var V in J)this.properties_.push(V);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var J=this.properties_.pop();if(J in this.object_)return J}return null};$jscomp.generator.Engine_=function(J){this.context_=new $jscomp.generator.Context;this.program_=J};
$jscomp.generator.Engine_.prototype.next_=function(J){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,J,this.context_.next_);this.context_.next_(J);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(J){this.context_.start_();var V=this.context_.yieldAllIterator_;if(V)return this.yieldAllStep_("return"in V?V["return"]:function(ia){return{value:ia,done:!0}},J,this.context_.return);this.context_.return(J);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(J){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],J,this.context_.next_);this.context_.throw_(J);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(J,V,ia){try{var va=J.call(this.context_.yieldAllIterator_,V);$jscomp.generator.ensureIteratorResultIsObject_(va);if(!va.done)return this.context_.stop_(),va;var xa=va.value}catch(Pa){return this.context_.yieldAllIterator_=null,this.context_.throw_(Pa),this.nextStep_()}this.context_.yieldAllIterator_=null;ia.call(this.context_,xa);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var J=this.program_(this.context_);if(J)return this.context_.stop_(),{value:J.value,done:!1}}catch(V){this.context_.yieldResult=void 0,this.context_.throw_(V)}this.context_.stop_();if(this.context_.abruptCompletion_){J=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(J.isException)throw J.exception;return{value:J.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(J){this.next=function(V){return J.next_(V)};this.throw=function(V){return J.throw_(V)};this.return=function(V){return J.return_(V)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(J,V){V=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(V));$jscomp.setPrototypeOf&&J.prototype&&$jscomp.setPrototypeOf(V,J.prototype);return V};
$jscomp.asyncExecutePromiseGenerator=function(J){function V(va){return J.next(va)}function ia(va){return J.throw(va)}return new Promise(function(va,xa){function Pa(sb){sb.done?va(sb.value):Promise.resolve(sb.value).then(V,ia).then(Pa,xa)}Pa(J.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(J){return $jscomp.asyncExecutePromiseGenerator(J())};$jscomp.asyncExecutePromiseGeneratorProgram=function(J){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(J)))};
$jscomp.initSymbol=function(){};$jscomp.iteratorPrototype=function(J){J={next:J};J[Symbol.iterator]=function(){return this};return J};$jscomp.iteratorFromArray=function(J,V){J instanceof String&&(J+="");var ia=0,va=!1,xa={next:function(){if(!va&&ia<J.length){var Pa=ia++;return{value:V(Pa,J[Pa]),done:!1}}va=!0;return{done:!0,value:void 0}}};xa[Symbol.iterator]=function(){return xa};return xa};
$jscomp.polyfill("Array.prototype.values",function(J){return J?J:function(){return $jscomp.iteratorFromArray(this,function(V,ia){return ia})}},"es8","es3");$jscomp.owns=function(J,V){return Object.prototype.hasOwnProperty.call(J,V)};$jscomp.polyfill("Object.values",function(J){return J?J:function(V){var ia=[],va;for(va in V)$jscomp.owns(V,va)&&ia.push(V[va]);return ia}},"es8","es3");
$jscomp.polyfill("Object.entries",function(J){return J?J:function(V){var ia=[],va;for(va in V)$jscomp.owns(V,va)&&ia.push([va,V[va]]);return ia}},"es8","es3");
var enableInlineVideo=function(){function J(T,ua,Ca,Gb){function Jb(Cb){Db=ua(Jb,Gb);T(Cb-(Hb||Cb));Hb=Cb}var Db,Hb;return{start:function(){Db||Jb(0)},stop:function(){Ca(Db);Db=null;Hb=0}}}function V(T,ua,Ca){function Gb(Jb){Ca&&!Ca(T,ua)||Jb.stopImmediatePropagation()}return T.addEventListener(ua,Gb),Gb}function ia(T,ua,Ca,Gb){function Jb(Db){Ca[ua]=Db}Gb&&Jb(T[ua]);Object.defineProperty(T,ua,{get:function(){return Ca[ua]},set:Jb})}function va(T,ua,Ca){Ca.addEventListener(ua,function(){return T.dispatchEvent(new Event(ua))})}
function xa(T,ua){Promise.resolve().then(function(){T.dispatchEvent(new Event(ua))})}function Pa(T){var ua=new Audio;return va(T,"play",ua),va(T,"playing",ua),va(T,"pause",ua),ua.crossOrigin=T.crossOrigin,ua.src=T.src||T.currentSrc||"data:",ua}function sb(T,ua,Ca){(mb||0)+200<Date.now()&&(T[nb]=!0,mb=Date.now());Ca||(T.currentTime=ua);Ya[++db%3]=100*ua|0}function A(T){this.video.readyState>=this.video.HAVE_FUTURE_DATA?(this.hasAudio||(this.driver.currentTime=this.video.currentTime+T*this.video.playbackRate/
1E3,this.video.loop&&this.driver.currentTime>=this.video.duration&&(this.driver.currentTime=0)),sb(this.video,this.driver.currentTime)):this.video.networkState===this.video.NETWORK_IDLE&&0===this.video.buffered.length&&this.video.load();this.video.ended&&(delete this.video[nb],this.video.pause(!0))}function $a(){var T=this[hb];if(this.webkitDisplayingFullscreen)return void this[u]();"data:"!==T.driver.src&&T.driver.src!==this.src&&(sb(this,0,!0),T.driver.src=this.src);this.paused&&(T.paused=!1,0===
this.buffered.length&&this.load(),T.driver.play(),T.updater.start(),T.hasAudio||(xa(this,"play"),T.video.readyState>=T.video.HAVE_ENOUGH_DATA&&xa(this,"playing")))}function aa(T){var ua=this[hb];ua.driver.pause();ua.updater.stop();this.webkitDisplayingFullscreen&&this[Ua]();ua.paused&&!T||(ua.paused=!0,ua.hasAudio||xa(this,"pause"),this.ended&&!this.webkitDisplayingFullscreen&&(this[nb]=!0,xa(this,"ended")))}function Ea(T,ua){var Ca={};T[hb]=Ca;Ca.paused=!0;Ca.hasAudio=ua;Ca.video=T;Ca.updater=J(A.bind(Ca),
requestAnimationFrame,cancelAnimationFrame);ua?Ca.driver=Pa(T):(T.addEventListener("canplay",function(){T.paused||xa(T,"playing")}),Ca.driver={src:T.src||T.currentSrc||"data:",muted:!0,paused:!0,pause:function(){Ca.driver.paused=!0},play:function(){Ca.driver.paused=!1;Ca.driver.currentTime>=Ca.video.duration&&sb(T,0)},get ended(){return Ca.driver.currentTime>=Ca.video.duration}});T.addEventListener("emptied",function(){var Gb=!Ca.driver.src||"data:"===Ca.driver.src;Ca.driver.src&&Ca.driver.src!==
T.src&&(sb(T,0,!0),Ca.driver.src=T.src,Gb||!ua&&T.autoplay?Ca.driver.play():Ca.updater.stop())},!1);T.addEventListener("webkitbeginfullscreen",function(){T.paused?ua&&0===Ca.driver.buffered.length&&Ca.driver.load():(T.pause(),T[u]())});ua&&(T.addEventListener("webkitendfullscreen",function(){Ca.driver.currentTime=T.currentTime}),T.addEventListener("seeking",function(){0>Ya.indexOf(100*T.currentTime|0)&&(Ca.driver.currentTime=T.currentTime)}))}function Ta(T){var ua=T[nb];return delete T[nb],!T.webkitDisplayingFullscreen&&
!ua}function jb(T){var ua=T[hb];T[u]=T.play;T[Ua]=T.pause;T.play=$a;T.pause=aa;ia(T,"paused",ua.driver);ia(T,"muted",ua.driver,!0);ia(T,"playbackRate",ua.driver,!0);ia(T,"ended",ua.driver);ia(T,"loop",ua.driver,!0);V(T,"seeking",function(Ca){return!Ca.webkitDisplayingFullscreen});V(T,"seeked",function(Ca){return!Ca.webkitDisplayingFullscreen});V(T,"timeupdate",Ta);V(T,"ended",Ta)}var mb,Da="object"==typeof document&&"object-fit"in document.head.style&&!matchMedia("(-webkit-video-playable-inline)").matches,
hb="bfred-it:iphone-inline-video",nb="bfred-it:iphone-inline-video:event",u="bfred-it:iphone-inline-video:nativeplay",Ua="bfred-it:iphone-inline-video:nativepause",Ya=[],db=0;return function(T,ua){if(void 0===ua&&(ua={}),!T[hb])if(ua.everywhere||Da&&(ua.iPad||ua.ipad?/iPhone|iPod|iPad/:/iPhone|iPod/).test(navigator.userAgent))T.pause(),ua=T.autoplay,T.autoplay=!1,Ea(T,!T.muted),jb(T),T.classList.add("IIV"),T.muted&&ua&&(T.play(),T.addEventListener("playing",function Gb(){T.autoplay=!0;T.removeEventListener("playing",
Gb)})),/iPhone|iPod|iPad/.test(navigator.platform)||console.warn("iphone-inline-video is not guaranteed to work in emulated environments")}}();
(function(){function J(e,g,l){u.biginteger_used=1;null!=e&&("number"==typeof e&&"undefined"==typeof g?this.fromInt(e):"number"==typeof e?this.fromNumber(e,g,l):null==g&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,g))}function V(){return new J(null,void 0,void 0)}function ia(e,g,l,r,x,D){for(;0<=--D;){var I=g*this[e++]+l[r]+x;x=Math.floor(I/67108864);l[r++]=I&67108863}return x}function va(e,g,l,r,x,D){var I=g&32767;for(g>>=15;0<=--D;){var X=this[e]&32767,ea=this[e++]>>15,ha=g*X+ea*
I;X=I*X+((ha&32767)<<15)+l[r]+(x&1073741823);x=(X>>>30)+(ha>>>15)+g*ea+(x>>>30);l[r++]=X&1073741823}return x}function xa(e,g,l,r,x,D){var I=g&16383;for(g>>=14;0<=--D;){var X=this[e]&16383,ea=this[e++]>>14,ha=g*X+ea*I;X=I*X+((ha&16383)<<14)+l[r]+x;x=(X>>28)+(ha>>14)+g*ea;l[r++]=X&268435455}return x}function Pa(e,g){e=Hb[e.charCodeAt(g)];return null==e?-1:e}function sb(e){var g=V();g.fromInt(e);return g}function A(e){var g=1,l;0!=(l=e>>>16)&&(e=l,g+=16);0!=(l=e>>8)&&(e=l,g+=8);0!=(l=e>>4)&&(e=l,g+=
4);0!=(l=e>>2)&&(e=l,g+=2);0!=e>>1&&(g+=1);return g}function $a(e){this.m=e}function aa(e){this.m=e;this.mp=e.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<e.DB-15)-1;this.mt2=2*e.t}function Ea(e,g){return e&g}function Ta(e,g){return e|g}function jb(e,g){return e^g}function mb(e,g){return e&~g}function Da(){}function hb(e){return e}function nb(e){this.r2=V();this.q3=V();J.ONE.dlShiftTo(2*e.t,this.r2);this.mu=this.r2.divide(e);this.m=e}var u={use_lines:!0,use_xyz:!1},Ua=!1;"undefined"!==
typeof module&&module.exports?(module.exports=u,Ua=!0):"undefined"!==typeof document?window.ClipperLib=u:self.ClipperLib=u;if(Ua){db="chrome";var Ya="Netscape"}else{var db=navigator.userAgent.toString().toLowerCase();Ya=navigator.appName}var T=-1!=db.indexOf("chrome")&&-1==db.indexOf("chromium")?1:0;Ua=-1!=db.indexOf("chromium")?1:0;var ua=-1!=db.indexOf("safari")&&-1==db.indexOf("chrome")&&-1==db.indexOf("chromium")?1:0;var Ca=-1!=db.indexOf("firefox")?1:0;db.indexOf("firefox/17");db.indexOf("firefox/15");
db.indexOf("firefox/3");var Gb=-1!=db.indexOf("opera")?1:0;db.indexOf("msie 10");db.indexOf("msie 9");var Jb=-1!=db.indexOf("msie 8")?1:0;var Db=-1!=db.indexOf("msie 7")?1:0;db=-1!=db.indexOf("msie ")?1:0;u.biginteger_used=null;"Microsoft Internet Explorer"==Ya?(J.prototype.am=va,Ya=30):"Netscape"!=Ya?(J.prototype.am=ia,Ya=26):(J.prototype.am=xa,Ya=28);J.prototype.DB=Ya;J.prototype.DM=(1<<Ya)-1;J.prototype.DV=1<<Ya;J.prototype.FV=Math.pow(2,52);J.prototype.F1=52-Ya;J.prototype.F2=2*Ya-52;var Hb=[],
Cb;Ya=48;for(Cb=0;9>=Cb;++Cb)Hb[Ya++]=Cb;Ya=97;for(Cb=10;36>Cb;++Cb)Hb[Ya++]=Cb;Ya=65;for(Cb=10;36>Cb;++Cb)Hb[Ya++]=Cb;$a.prototype.convert=function(e){return 0>e.s||0<=e.compareTo(this.m)?e.mod(this.m):e};$a.prototype.revert=function(e){return e};$a.prototype.reduce=function(e){e.divRemTo(this.m,null,e)};$a.prototype.mulTo=function(e,g,l){e.multiplyTo(g,l);this.reduce(l)};$a.prototype.sqrTo=function(e,g){e.squareTo(g);this.reduce(g)};aa.prototype.convert=function(e){var g=V();e.abs().dlShiftTo(this.m.t,
g);g.divRemTo(this.m,null,g);0>e.s&&0<g.compareTo(J.ZERO)&&this.m.subTo(g,g);return g};aa.prototype.revert=function(e){var g=V();e.copyTo(g);this.reduce(g);return g};aa.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var g=0;g<this.m.t;++g){var l=e[g]&32767,r=l*this.mpl+((l*this.mph+(e[g]>>15)*this.mpl&this.um)<<15)&e.DM;l=g+this.m.t;for(e[l]+=this.m.am(0,r,e,g,0,this.m.t);e[l]>=e.DV;)e[l]-=e.DV,e[++l]++}e.clamp();e.drShiftTo(this.m.t,e);0<=e.compareTo(this.m)&&e.subTo(this.m,e)};
aa.prototype.mulTo=function(e,g,l){e.multiplyTo(g,l);this.reduce(l)};aa.prototype.sqrTo=function(e,g){e.squareTo(g);this.reduce(g)};J.prototype.copyTo=function(e){for(var g=this.t-1;0<=g;--g)e[g]=this[g];e.t=this.t;e.s=this.s};J.prototype.fromInt=function(e){this.t=1;this.s=0>e?-1:0;0<e?this[0]=e:-1>e?this[0]=e+this.DV:this.t=0};J.prototype.fromString=function(e,g){if(16==g)g=4;else if(8==g)g=3;else if(256==g)g=8;else if(2==g)g=1;else if(32==g)g=5;else if(4==g)g=2;else{this.fromRadix(e,g);return}this.s=
this.t=0;for(var l=e.length,r=!1,x=0;0<=--l;){var D=8==g?e[l]&255:Pa(e,l);0>D?"-"==e.charAt(l)&&(r=!0):(r=!1,0==x?this[this.t++]=D:x+g>this.DB?(this[this.t-1]|=(D&(1<<this.DB-x)-1)<<x,this[this.t++]=D>>this.DB-x):this[this.t-1]|=D<<x,x+=g,x>=this.DB&&(x-=this.DB))}8==g&&0!=(e[0]&128)&&(this.s=-1,0<x&&(this[this.t-1]|=(1<<this.DB-x)-1<<x));this.clamp();r&&J.ZERO.subTo(this,this)};J.prototype.clamp=function(){for(var e=this.s&this.DM;0<this.t&&this[this.t-1]==e;)--this.t};J.prototype.dlShiftTo=function(e,
g){var l;for(l=this.t-1;0<=l;--l)g[l+e]=this[l];for(l=e-1;0<=l;--l)g[l]=0;g.t=this.t+e;g.s=this.s};J.prototype.drShiftTo=function(e,g){for(var l=e;l<this.t;++l)g[l-e]=this[l];g.t=Math.max(this.t-e,0);g.s=this.s};J.prototype.lShiftTo=function(e,g){var l=e%this.DB,r=this.DB-l,x=(1<<r)-1;e=Math.floor(e/this.DB);var D=this.s<<l&this.DM,I;for(I=this.t-1;0<=I;--I)g[I+e+1]=this[I]>>r|D,D=(this[I]&x)<<l;for(I=e-1;0<=I;--I)g[I]=0;g[e]=D;g.t=this.t+e+1;g.s=this.s;g.clamp()};J.prototype.rShiftTo=function(e,
g){g.s=this.s;var l=Math.floor(e/this.DB);if(l>=this.t)g.t=0;else{e%=this.DB;var r=this.DB-e,x=(1<<e)-1;g[0]=this[l]>>e;for(var D=l+1;D<this.t;++D)g[D-l-1]|=(this[D]&x)<<r,g[D-l]=this[D]>>e;0<e&&(g[this.t-l-1]|=(this.s&x)<<r);g.t=this.t-l;g.clamp()}};J.prototype.subTo=function(e,g){for(var l=0,r=0,x=Math.min(e.t,this.t);l<x;)r+=this[l]-e[l],g[l++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;l<this.t;)r+=this[l],g[l++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;l<e.t;)r-=e[l],g[l++]=r&
this.DM,r>>=this.DB;r-=e.s}g.s=0>r?-1:0;-1>r?g[l++]=this.DV+r:0<r&&(g[l++]=r);g.t=l;g.clamp()};J.prototype.multiplyTo=function(e,g){var l=this.abs(),r=e.abs(),x=l.t;for(g.t=x+r.t;0<=--x;)g[x]=0;for(x=0;x<r.t;++x)g[x+l.t]=l.am(0,r[x],g,x,0,l.t);g.s=0;g.clamp();this.s!=e.s&&J.ZERO.subTo(g,g)};J.prototype.squareTo=function(e){for(var g=this.abs(),l=e.t=2*g.t;0<=--l;)e[l]=0;for(l=0;l<g.t-1;++l){var r=g.am(l,g[l],e,2*l,0,1);(e[l+g.t]+=g.am(l+1,2*g[l],e,2*l+1,r,g.t-l-1))>=g.DV&&(e[l+g.t]-=g.DV,e[l+g.t+
1]=1)}0<e.t&&(e[e.t-1]+=g.am(l,g[l],e,2*l,0,1));e.s=0;e.clamp()};J.prototype.divRemTo=function(e,g,l){var r=e.abs();if(!(0>=r.t)){var x=this.abs();if(x.t<r.t)null!=g&&g.fromInt(0),null!=l&&this.copyTo(l);else{null==l&&(l=V());var D=V(),I=this.s;e=e.s;var X=this.DB-A(r[r.t-1]);0<X?(r.lShiftTo(X,D),x.lShiftTo(X,l)):(r.copyTo(D),x.copyTo(l));r=D.t;x=D[r-1];if(0!=x){var ea=x*(1<<this.F1)+(1<r?D[r-2]>>this.F2:0),ha=this.FV/ea;ea=(1<<this.F1)/ea;var Fa=1<<this.F2,Xa=l.t,ja=Xa-r,zb=null==g?V():g;D.dlShiftTo(ja,
zb);0<=l.compareTo(zb)&&(l[l.t++]=1,l.subTo(zb,l));J.ONE.dlShiftTo(r,zb);for(zb.subTo(D,D);D.t<r;)D[D.t++]=0;for(;0<=--ja;){var Ma=l[--Xa]==x?this.DM:Math.floor(l[Xa]*ha+(l[Xa-1]+Fa)*ea);if((l[Xa]+=D.am(0,Ma,l,ja,0,r))<Ma)for(D.dlShiftTo(ja,zb),l.subTo(zb,l);l[Xa]<--Ma;)l.subTo(zb,l)}null!=g&&(l.drShiftTo(r,g),I!=e&&J.ZERO.subTo(g,g));l.t=r;l.clamp();0<X&&l.rShiftTo(X,l);0>I&&J.ZERO.subTo(l,l)}}}};J.prototype.invDigit=function(){if(1>this.t)return 0;var e=this[0];if(0==(e&1))return 0;var g=e&3;g=
g*(2-(e&15)*g)&15;g=g*(2-(e&255)*g)&255;g=g*(2-((e&65535)*g&65535))&65535;g=g*(2-e*g%this.DV)%this.DV;return 0<g?this.DV-g:-g};J.prototype.isEven=function(){return 0==(0<this.t?this[0]&1:this.s)};J.prototype.exp=function(e,g){if(4294967295<e||1>e)return J.ONE;var l=V(),r=V(),x=g.convert(this),D=A(e)-1;for(x.copyTo(l);0<=--D;)if(g.sqrTo(l,r),0<(e&1<<D))g.mulTo(r,x,l);else{var I=l;l=r;r=I}return g.revert(l)};J.prototype.toString=function(e){if(0>this.s)return"-"+this.negate().toString(e);if(16==e)e=
4;else if(8==e)e=3;else if(2==e)e=1;else if(32==e)e=5;else if(4==e)e=2;else return this.toRadix(e);var g=(1<<e)-1,l,r=!1,x="",D=this.t,I=this.DB-D*this.DB%e;if(0<D--)for(I<this.DB&&0<(l=this[D]>>I)&&(r=!0,x="0123456789abcdefghijklmnopqrstuvwxyz".charAt(l));0<=D;)I<e?(l=(this[D]&(1<<I)-1)<<e-I,l|=this[--D]>>(I+=this.DB-e)):(l=this[D]>>(I-=e)&g,0>=I&&(I+=this.DB,--D)),0<l&&(r=!0),r&&(x+="0123456789abcdefghijklmnopqrstuvwxyz".charAt(l));return r?x:"0"};J.prototype.negate=function(){var e=V();J.ZERO.subTo(this,
e);return e};J.prototype.abs=function(){return 0>this.s?this.negate():this};J.prototype.compareTo=function(e){var g=this.s-e.s;if(0!=g)return g;var l=this.t;g=l-e.t;if(0!=g)return 0>this.s?-g:g;for(;0<=--l;)if(0!=(g=this[l]-e[l]))return g;return 0};J.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+A(this[this.t-1]^this.s&this.DM)};J.prototype.mod=function(e){var g=V();this.abs().divRemTo(e,null,g);0>this.s&&0<g.compareTo(J.ZERO)&&e.subTo(g,g);return g};J.prototype.modPowInt=function(e,
g){g=256>e||g.isEven()?new $a(g):new aa(g);return this.exp(e,g)};J.ZERO=sb(0);J.ONE=sb(1);Da.prototype.convert=hb;Da.prototype.revert=hb;Da.prototype.mulTo=function(e,g,l){e.multiplyTo(g,l)};Da.prototype.sqrTo=function(e,g){e.squareTo(g)};nb.prototype.convert=function(e){if(0>e.s||e.t>2*this.m.t)return e.mod(this.m);if(0>e.compareTo(this.m))return e;var g=V();e.copyTo(g);this.reduce(g);return g};nb.prototype.revert=function(e){return e};nb.prototype.reduce=function(e){e.drShiftTo(this.m.t-1,this.r2);
e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>e.compareTo(this.r2);)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);0<=e.compareTo(this.m);)e.subTo(this.m,e)};nb.prototype.mulTo=function(e,g,l){e.multiplyTo(g,l);this.reduce(l)};nb.prototype.sqrTo=function(e,g){e.squareTo(g);this.reduce(g)};var Ab=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,
131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,
929,937,941,947,953,967,971,977,983,991,997],nd=67108864/Ab[Ab.length-1];J.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))};J.prototype.toRadix=function(e){null==e&&(e=10);if(0==this.signum()||2>e||36<e)return"0";var g=this.chunkSize(e);g=Math.pow(e,g);var l=sb(g),r=V(),x=V(),D="";for(this.divRemTo(l,r,x);0<r.signum();)D=(g+x.intValue()).toString(e).substr(1)+D,r.divRemTo(l,r,x);return x.intValue().toString(e)+D};J.prototype.fromRadix=function(e,g){this.fromInt(0);
null==g&&(g=10);for(var l=this.chunkSize(g),r=Math.pow(g,l),x=!1,D=0,I=0,X=0;X<e.length;++X){var ea=Pa(e,X);0>ea?"-"==e.charAt(X)&&0==this.signum()&&(x=!0):(I=g*I+ea,++D>=l&&(this.dMultiply(r),this.dAddOffset(I,0),I=D=0))}0<D&&(this.dMultiply(Math.pow(g,D)),this.dAddOffset(I,0));x&&J.ZERO.subTo(this,this)};J.prototype.fromNumber=function(e,g,l){if("number"==typeof g)if(2>e)this.fromInt(1);else for(this.fromNumber(e,l),this.testBit(e-1)||this.bitwiseTo(J.ONE.shiftLeft(e-1),Ta,this),this.isEven()&&
this.dAddOffset(1,0);!this.isProbablePrime(g);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(J.ONE.shiftLeft(e-1),this);else{l=[];var r=e&7;l.length=(e>>3)+1;g.nextBytes(l);l[0]=0<r?l[0]&(1<<r)-1:0;this.fromString(l,256)}};J.prototype.bitwiseTo=function(e,g,l){var r,x=Math.min(e.t,this.t);for(r=0;r<x;++r)l[r]=g(this[r],e[r]);if(e.t<this.t){var D=e.s&this.DM;for(r=x;r<this.t;++r)l[r]=g(this[r],D);l.t=this.t}else{D=this.s&this.DM;for(r=x;r<e.t;++r)l[r]=g(D,e[r]);l.t=e.t}l.s=g(this.s,e.s);l.clamp()};
J.prototype.changeBit=function(e,g){e=J.ONE.shiftLeft(e);this.bitwiseTo(e,g,e);return e};J.prototype.addTo=function(e,g){for(var l=0,r=0,x=Math.min(e.t,this.t);l<x;)r+=this[l]+e[l],g[l++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;l<this.t;)r+=this[l],g[l++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;l<e.t;)r+=e[l],g[l++]=r&this.DM,r>>=this.DB;r+=e.s}g.s=0>r?-1:0;0<r?g[l++]=r:-1>r&&(g[l++]=this.DV+r);g.t=l;g.clamp()};J.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,
0,this.t);++this.t;this.clamp()};J.prototype.dAddOffset=function(e,g){if(0!=e){for(;this.t<=g;)this[this.t++]=0;for(this[g]+=e;this[g]>=this.DV;)this[g]-=this.DV,++g>=this.t&&(this[this.t++]=0),++this[g]}};J.prototype.multiplyLowerTo=function(e,g,l){var r=Math.min(this.t+e.t,g);l.s=0;for(l.t=r;0<r;)l[--r]=0;var x;for(x=l.t-this.t;r<x;++r)l[r+this.t]=this.am(0,e[r],l,r,0,this.t);for(x=Math.min(e.t,g);r<x;++r)this.am(0,e[r],l,r,0,g-r);l.clamp()};J.prototype.multiplyUpperTo=function(e,g,l){--g;var r=
l.t=this.t+e.t-g;for(l.s=0;0<=--r;)l[r]=0;for(r=Math.max(g-this.t,0);r<e.t;++r)l[this.t+r-g]=this.am(g-r,e[r],l,0,0,this.t+r-g);l.clamp();l.drShiftTo(1,l)};J.prototype.modInt=function(e){if(0>=e)return 0;var g=this.DV%e,l=0>this.s?e-1:0;if(0<this.t)if(0==g)l=this[0]%e;else for(var r=this.t-1;0<=r;--r)l=(g*l+this[r])%e;return l};J.prototype.millerRabin=function(e){var g=this.subtract(J.ONE),l=g.getLowestSetBit();if(0>=l)return!1;var r=g.shiftRight(l);e=e+1>>1;e>Ab.length&&(e=Ab.length);for(var x=V(),
D=0;D<e;++D){x.fromInt(Ab[Math.floor(Math.random()*Ab.length)]);var I=x.modPow(r,this);if(0!=I.compareTo(J.ONE)&&0!=I.compareTo(g)){for(var X=1;X++<l&&0!=I.compareTo(g);)if(I=I.modPowInt(2,this),0==I.compareTo(J.ONE))return!1;if(0!=I.compareTo(g))return!1}}return!0};J.prototype.clone=function(){var e=V();this.copyTo(e);return e};J.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&
(1<<32-this.DB)-1)<<this.DB|this[0]};J.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24};J.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16};J.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1};J.prototype.toByteArray=function(){var e=this.t,g=[];g[0]=this.s;var l=this.DB-e*this.DB%8,r,x=0;if(0<e--)for(l<this.DB&&(r=this[e]>>l)!=(this.s&this.DM)>>l&&(g[x++]=r|this.s<<this.DB-l);0<=e;)if(8>l?(r=(this[e]&(1<<l)-1)<<8-l,r|=
this[--e]>>(l+=this.DB-8)):(r=this[e]>>(l-=8)&255,0>=l&&(l+=this.DB,--e)),0!=(r&128)&&(r|=-256),0==x&&(this.s&128)!=(r&128)&&++x,0<x||r!=this.s)g[x++]=r;return g};J.prototype.equals=function(e){return 0==this.compareTo(e)};J.prototype.min=function(e){return 0>this.compareTo(e)?this:e};J.prototype.max=function(e){return 0<this.compareTo(e)?this:e};J.prototype.and=function(e){var g=V();this.bitwiseTo(e,Ea,g);return g};J.prototype.or=function(e){var g=V();this.bitwiseTo(e,Ta,g);return g};J.prototype.xor=
function(e){var g=V();this.bitwiseTo(e,jb,g);return g};J.prototype.andNot=function(e){var g=V();this.bitwiseTo(e,mb,g);return g};J.prototype.not=function(){for(var e=V(),g=0;g<this.t;++g)e[g]=this.DM&~this[g];e.t=this.t;e.s=~this.s;return e};J.prototype.shiftLeft=function(e){var g=V();0>e?this.rShiftTo(-e,g):this.lShiftTo(e,g);return g};J.prototype.shiftRight=function(e){var g=V();0>e?this.lShiftTo(-e,g):this.rShiftTo(e,g);return g};J.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=
this[e]){var g=e*this.DB;e=this[e];if(0==e)e=-1;else{var l=0;0==(e&65535)&&(e>>=16,l+=16);0==(e&255)&&(e>>=8,l+=8);0==(e&15)&&(e>>=4,l+=4);0==(e&3)&&(e>>=2,l+=2);0==(e&1)&&++l;e=l}return g+e}return 0>this.s?this.t*this.DB:-1};J.prototype.bitCount=function(){for(var e=0,g=this.s&this.DM,l=0;l<this.t;++l){for(var r=this[l]^g,x=0;0!=r;)r&=r-1,++x;e+=x}return e};J.prototype.testBit=function(e){var g=Math.floor(e/this.DB);return g>=this.t?0!=this.s:0!=(this[g]&1<<e%this.DB)};J.prototype.setBit=function(e){return this.changeBit(e,
Ta)};J.prototype.clearBit=function(e){return this.changeBit(e,mb)};J.prototype.flipBit=function(e){return this.changeBit(e,jb)};J.prototype.add=function(e){var g=V();this.addTo(e,g);return g};J.prototype.subtract=function(e){var g=V();this.subTo(e,g);return g};J.prototype.multiply=function(e){var g=V();this.multiplyTo(e,g);return g};J.prototype.divide=function(e){var g=V();this.divRemTo(e,g,null);return g};J.prototype.remainder=function(e){var g=V();this.divRemTo(e,null,g);return g};J.prototype.divideAndRemainder=
function(e){var g=V(),l=V();this.divRemTo(e,g,l);return[g,l]};J.prototype.modPow=function(e,g){var l=e.bitLength(),r=sb(1);if(0>=l)return r;var x=18>l?1:48>l?3:144>l?4:768>l?5:6;g=8>l?new $a(g):g.isEven()?new nb(g):new aa(g);var D=[],I=3,X=x-1,ea=(1<<x)-1;D[1]=g.convert(this);if(1<x)for(l=V(),g.sqrTo(D[1],l);I<=ea;)D[I]=V(),g.mulTo(l,D[I-2],D[I]),I+=2;var ha=e.t-1,Fa,Xa=!0,ja=V();for(l=A(e[ha])-1;0<=ha;){l>=X?Fa=e[ha]>>l-X&ea:(Fa=(e[ha]&(1<<l+1)-1)<<X-l,0<ha&&(Fa|=e[ha-1]>>this.DB+l-X));for(I=x;0==
(Fa&1);)Fa>>=1,--I;0>(l-=I)&&(l+=this.DB,--ha);if(Xa)D[Fa].copyTo(r),Xa=!1;else{for(;1<I;)g.sqrTo(r,ja),g.sqrTo(ja,r),I-=2;0<I?g.sqrTo(r,ja):(I=r,r=ja,ja=I);g.mulTo(ja,D[Fa],r)}for(;0<=ha&&0==(e[ha]&1<<l);)g.sqrTo(r,ja),I=r,r=ja,ja=I,0>--l&&(l=this.DB-1,--ha)}return g.revert(r)};J.prototype.modInverse=function(e){var g=e.isEven();if(this.isEven()&&g||0==e.signum())return J.ZERO;for(var l=e.clone(),r=this.clone(),x=sb(1),D=sb(0),I=sb(0),X=sb(1);0!=l.signum();){for(;l.isEven();)l.rShiftTo(1,l),g?(x.isEven()&&
D.isEven()||(x.addTo(this,x),D.subTo(e,D)),x.rShiftTo(1,x)):D.isEven()||D.subTo(e,D),D.rShiftTo(1,D);for(;r.isEven();)r.rShiftTo(1,r),g?(I.isEven()&&X.isEven()||(I.addTo(this,I),X.subTo(e,X)),I.rShiftTo(1,I)):X.isEven()||X.subTo(e,X),X.rShiftTo(1,X);0<=l.compareTo(r)?(l.subTo(r,l),g&&x.subTo(I,x),D.subTo(X,D)):(r.subTo(l,r),g&&I.subTo(x,I),X.subTo(D,X))}if(0!=r.compareTo(J.ONE))return J.ZERO;if(0<=X.compareTo(e))return X.subtract(e);if(0>X.signum())X.addTo(e,X);else return X;return 0>X.signum()?X.add(e):
X};J.prototype.pow=function(e){return this.exp(e,new Da)};J.prototype.gcd=function(e){var g=0>this.s?this.negate():this.clone();e=0>e.s?e.negate():e.clone();if(0>g.compareTo(e)){var l=g;g=e;e=l}l=g.getLowestSetBit();var r=e.getLowestSetBit();if(0>r)return g;l<r&&(r=l);for(0<r&&(g.rShiftTo(r,g),e.rShiftTo(r,e));0<g.signum();)0<(l=g.getLowestSetBit())&&g.rShiftTo(l,g),0<(l=e.getLowestSetBit())&&e.rShiftTo(l,e),0<=g.compareTo(e)?(g.subTo(e,g),g.rShiftTo(1,g)):(e.subTo(g,e),e.rShiftTo(1,e));0<r&&e.lShiftTo(r,
e);return e};J.prototype.isProbablePrime=function(e){var g,l=this.abs();if(1==l.t&&l[0]<=Ab[Ab.length-1]){for(g=0;g<Ab.length;++g)if(l[0]==Ab[g])return!0;return!1}if(l.isEven())return!1;for(g=1;g<Ab.length;){for(var r=Ab[g],x=g+1;x<Ab.length&&r<nd;)r*=Ab[x++];for(r=l.modInt(r);g<x;)if(0==r%Ab[g++])return!1}return l.millerRabin(e)};J.prototype.square=function(){var e=V();this.squareTo(e);return e};J.prototype.IsNegative=function(){return-1==this.compareTo(J.ZERO)?!0:!1};J.op_Equality=function(e,g){return 0==
e.compareTo(g)?!0:!1};J.op_Inequality=function(e,g){return 0!=e.compareTo(g)?!0:!1};J.op_GreaterThan=function(e,g){return 0<e.compareTo(g)?!0:!1};J.op_LessThan=function(e,g){return 0>e.compareTo(g)?!0:!1};J.op_Addition=function(e,g){return(new J(e)).add(new J(g))};J.op_Subtraction=function(e,g){return(new J(e)).subtract(new J(g))};J.Int128Mul=function(e,g){return(new J(e)).multiply(new J(g))};J.op_Division=function(e,g){return e.divide(g)};J.prototype.ToDouble=function(){return parseFloat(this.toString())};
Ya=function(e,g){var l;if("undefined"==typeof Object.getOwnPropertyNames)for(l in g.prototype){if("undefined"==typeof e.prototype[l]||e.prototype[l]==Object.prototype[l])e.prototype[l]=g.prototype[l]}else for(var r=Object.getOwnPropertyNames(g.prototype),x=0;x<r.length;x++)"undefined"==typeof Object.getOwnPropertyDescriptor(e.prototype,r[x])&&Object.defineProperty(e.prototype,r[x],Object.getOwnPropertyDescriptor(g.prototype,r[x]));for(l in g)"undefined"==typeof e[l]&&(e[l]=g[l]);e.$baseCtor=g};u.Path=
function(){return[]};u.Paths=function(){return[]};u.DoublePoint=function(){var e=arguments;this.Y=this.X=0;1==e.length?(this.X=e[0].X,this.Y=e[0].Y):2==e.length&&(this.X=e[0],this.Y=e[1])};u.DoublePoint0=function(){this.Y=this.X=0};u.DoublePoint1=function(e){this.X=e.X;this.Y=e.Y};u.DoublePoint2=function(e,g){this.X=e;this.Y=g};u.PolyNode=function(){this.m_Parent=null;this.m_polygon=new u.Path;this.m_endtype=this.m_jointype=this.m_Index=0;this.m_Childs=[];this.IsOpen=!1};u.PolyNode.prototype.IsHoleNode=
function(){for(var e=!0,g=this.m_Parent;null!==g;)e=!e,g=g.m_Parent;return e};u.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length};u.PolyNode.prototype.Contour=function(){return this.m_polygon};u.PolyNode.prototype.AddChild=function(e){var g=this.m_Childs.length;this.m_Childs.push(e);e.m_Parent=this;e.m_Index=g};u.PolyNode.prototype.GetNext=function(){return 0<this.m_Childs.length?this.m_Childs[0]:this.GetNextSiblingUp()};u.PolyNode.prototype.GetNextSiblingUp=function(){return null===
this.m_Parent?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]};u.PolyNode.prototype.Childs=function(){return this.m_Childs};u.PolyNode.prototype.Parent=function(){return this.m_Parent};u.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()};u.PolyTree=function(){this.m_AllPolys=[];u.PolyNode.call(this)};u.PolyTree.prototype.Clear=function(){for(var e=0,g=this.m_AllPolys.length;e<g;e++)this.m_AllPolys[e]=null;this.m_AllPolys.length=
0;this.m_Childs.length=0};u.PolyTree.prototype.GetFirst=function(){return 0<this.m_Childs.length?this.m_Childs[0]:null};u.PolyTree.prototype.Total=function(){var e=this.m_AllPolys.length;0<e&&this.m_Childs[0]!=this.m_AllPolys[0]&&e--;return e};Ya(u.PolyTree,u.PolyNode);u.Math_Abs_Int64=u.Math_Abs_Int32=u.Math_Abs_Double=function(e){return Math.abs(e)};u.Math_Max_Int32_Int32=function(e,g){return Math.max(e,g)};u.Cast_Int32=db||Gb||ua?function(e){return e|0}:function(e){return~~e};u.Cast_Int64=T?function(e){return-2147483648>
e||2147483647<e?0>e?Math.ceil(e):Math.floor(e):~~e}:Ca&&"function"==typeof Number.toInteger?function(e){return Number.toInteger(e)}:Db||Jb?function(e){return parseInt(e,10)}:db?function(e){return-2147483648>e||2147483647<e?0>e?Math.ceil(e):Math.floor(e):e|0}:function(e){return 0>e?Math.ceil(e):Math.floor(e)};u.Clear=function(e){e.length=0};u.PI=3.141592653589793;u.PI2=6.283185307179586;u.IntPoint=function(){var e=arguments,g=e.length;this.Y=this.X=0;u.use_xyz?(this.Z=0,3==g?(this.X=e[0],this.Y=e[1],
this.Z=e[2]):2==g?(this.X=e[0],this.Y=e[1],this.Z=0):1==g?e[0]instanceof u.DoublePoint?(e=e[0],this.X=u.Clipper.Round(e.X),this.Y=u.Clipper.Round(e.Y),this.Z=0):(e=e[0],"undefined"==typeof e.Z&&(e.Z=0),this.X=e.X,this.Y=e.Y,this.Z=e.Z):this.Z=this.Y=this.X=0):2==g?(this.X=e[0],this.Y=e[1]):1==g?e[0]instanceof u.DoublePoint?(e=e[0],this.X=u.Clipper.Round(e.X),this.Y=u.Clipper.Round(e.Y)):(e=e[0],this.X=e.X,this.Y=e.Y):this.Y=this.X=0};u.IntPoint.op_Equality=function(e,g){return e.X==g.X&&e.Y==g.Y};
u.IntPoint.op_Inequality=function(e,g){return e.X!=g.X||e.Y!=g.Y};u.use_xyz?(u.IntPoint0=function(){this.Z=this.Y=this.X=0},u.IntPoint1=function(e){this.X=e.X;this.Y=e.Y;this.Z=e.Z},u.IntPoint1dp=function(e){this.X=u.Clipper.Round(e.X);this.Y=u.Clipper.Round(e.Y);this.Z=0},u.IntPoint2=function(e,g){this.X=e;this.Y=g;this.Z=0},u.IntPoint3=function(e,g,l){this.X=e;this.Y=g;this.Z=l}):(u.IntPoint0=function(){this.Y=this.X=0},u.IntPoint1=function(e){this.X=e.X;this.Y=e.Y},u.IntPoint1dp=function(e){this.X=
u.Clipper.Round(e.X);this.Y=u.Clipper.Round(e.Y)},u.IntPoint2=function(e,g){this.X=e;this.Y=g});u.IntRect=function(){var e=arguments,g=e.length;4==g?(this.left=e[0],this.top=e[1],this.right=e[2],this.bottom=e[3]):1==g?(this.left=e[0].left,this.top=e[0].top,this.right=e[0].right,this.bottom=e[0].bottom):this.bottom=this.right=this.top=this.left=0};u.IntRect0=function(){this.bottom=this.right=this.top=this.left=0};u.IntRect1=function(e){this.left=e.left;this.top=e.top;this.right=e.right;this.bottom=
e.bottom};u.IntRect4=function(e,g,l,r){this.left=e;this.top=g;this.right=l;this.bottom=r};u.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3};u.PolyType={ptSubject:0,ptClip:1};u.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3};u.JoinType={jtSquare:0,jtRound:1,jtMiter:2};u.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4};u.EdgeSide={esLeft:0,esRight:1};u.Direction={dRightToLeft:0,dLeftToRight:1};u.TEdge=function(){this.Bot=new u.IntPoint;
this.Curr=new u.IntPoint;this.Top=new u.IntPoint;this.Delta=new u.IntPoint;this.Dx=0;this.PolyTyp=u.PolyType.ptSubject;this.Side=u.EdgeSide.esLeft;this.OutIdx=this.WindCnt2=this.WindCnt=this.WindDelta=0;this.PrevInSEL=this.NextInSEL=this.PrevInAEL=this.NextInAEL=this.NextInLML=this.Prev=this.Next=null};u.IntersectNode=function(){this.Edge2=this.Edge1=null;this.Pt=new u.IntPoint};u.MyIntersectNodeSort=function(){};u.MyIntersectNodeSort.Compare=function(e,g){e=g.Pt.Y-e.Pt.Y;return 0<e?1:0>e?-1:0};u.LocalMinima=
function(){this.Y=0;this.Next=this.RightBound=this.LeftBound=null};u.Scanbeam=function(){this.Y=0;this.Next=null};u.OutRec=function(){this.Idx=0;this.IsOpen=this.IsHole=!1;this.PolyNode=this.BottomPt=this.Pts=this.FirstLeft=null};u.OutPt=function(){this.Idx=0;this.Pt=new u.IntPoint;this.Prev=this.Next=null};u.Join=function(){this.OutPt2=this.OutPt1=null;this.OffPt=new u.IntPoint};u.ClipperBase=function(){this.m_edges=[];this.PreserveCollinear=!1;this.m_CurrentLM=this.m_MinimaList=null;this.m_HasOpenPaths=
this.m_UseFullRange=!1};u.ClipperBase.horizontal=-9007199254740992;u.ClipperBase.Skip=-2;u.ClipperBase.Unassigned=-1;u.ClipperBase.tolerance=1E-20;u.ClipperBase.loRange=47453132;u.ClipperBase.hiRange=0xfffffffffffff;u.ClipperBase.near_zero=function(e){return e>-u.ClipperBase.tolerance&&e<u.ClipperBase.tolerance};u.ClipperBase.IsHorizontal=function(e){return 0===e.Delta.Y};u.ClipperBase.prototype.PointIsVertex=function(e,g){var l=g;do{if(u.IntPoint.op_Equality(l.Pt,e))return!0;l=l.Next}while(l!=g);
return!1};u.ClipperBase.prototype.PointOnLineSegment=function(e,g,l,r){return r?e.X==g.X&&e.Y==g.Y||e.X==l.X&&e.Y==l.Y||e.X>g.X==e.X<l.X&&e.Y>g.Y==e.Y<l.Y&&J.op_Equality(J.Int128Mul(e.X-g.X,l.Y-g.Y),J.Int128Mul(l.X-g.X,e.Y-g.Y)):e.X==g.X&&e.Y==g.Y||e.X==l.X&&e.Y==l.Y||e.X>g.X==e.X<l.X&&e.Y>g.Y==e.Y<l.Y&&(e.X-g.X)*(l.Y-g.Y)==(l.X-g.X)*(e.Y-g.Y)};u.ClipperBase.prototype.PointOnPolygon=function(e,g,l){for(var r=g;;){if(this.PointOnLineSegment(e,r.Pt,r.Next.Pt,l))return!0;r=r.Next;if(r==g)break}return!1};
u.ClipperBase.prototype.SlopesEqual=u.ClipperBase.SlopesEqual=function(){var e=arguments,g=e.length,l,r;if(3==g)return g=e[0],l=e[1],e[2]?J.op_Equality(J.Int128Mul(g.Delta.Y,l.Delta.X),J.Int128Mul(g.Delta.X,l.Delta.Y)):u.Cast_Int64(g.Delta.Y*l.Delta.X)==u.Cast_Int64(g.Delta.X*l.Delta.Y);if(4==g)return g=e[0],l=e[1],r=e[2],e[3]?J.op_Equality(J.Int128Mul(g.Y-l.Y,l.X-r.X),J.Int128Mul(g.X-l.X,l.Y-r.Y)):0===u.Cast_Int64((g.Y-l.Y)*(l.X-r.X))-u.Cast_Int64((g.X-l.X)*(l.Y-r.Y));g=e[0];l=e[1];r=e[2];var x=
e[3];return e[4]?J.op_Equality(J.Int128Mul(g.Y-l.Y,r.X-x.X),J.Int128Mul(g.X-l.X,r.Y-x.Y)):0===u.Cast_Int64((g.Y-l.Y)*(r.X-x.X))-u.Cast_Int64((g.X-l.X)*(r.Y-x.Y))};u.ClipperBase.SlopesEqual3=function(e,g,l){return l?J.op_Equality(J.Int128Mul(e.Delta.Y,g.Delta.X),J.Int128Mul(e.Delta.X,g.Delta.Y)):u.Cast_Int64(e.Delta.Y*g.Delta.X)==u.Cast_Int64(e.Delta.X*g.Delta.Y)};u.ClipperBase.SlopesEqual4=function(e,g,l,r){return r?J.op_Equality(J.Int128Mul(e.Y-g.Y,g.X-l.X),J.Int128Mul(e.X-g.X,g.Y-l.Y)):0===u.Cast_Int64((e.Y-
g.Y)*(g.X-l.X))-u.Cast_Int64((e.X-g.X)*(g.Y-l.Y))};u.ClipperBase.SlopesEqual5=function(e,g,l,r,x){return x?J.op_Equality(J.Int128Mul(e.Y-g.Y,l.X-r.X),J.Int128Mul(e.X-g.X,l.Y-r.Y)):0===u.Cast_Int64((e.Y-g.Y)*(l.X-r.X))-u.Cast_Int64((e.X-g.X)*(l.Y-r.Y))};u.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var e=0,g=this.m_edges.length;e<g;++e){for(var l=0,r=this.m_edges[e].length;l<r;++l)this.m_edges[e][l]=null;u.Clear(this.m_edges[e])}u.Clear(this.m_edges);this.m_HasOpenPaths=
this.m_UseFullRange=!1};u.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;null!==this.m_MinimaList;){var e=this.m_MinimaList.Next;this.m_MinimaList=null;this.m_MinimaList=e}this.m_CurrentLM=null};u.ClipperBase.prototype.RangeTest=function(e,g){if(g.Value)(e.X>u.ClipperBase.hiRange||e.Y>u.ClipperBase.hiRange||-e.X>u.ClipperBase.hiRange||-e.Y>u.ClipperBase.hiRange)&&u.Error("Coordinate outside allowed range in RangeTest().");else if(e.X>u.ClipperBase.loRange||e.Y>u.ClipperBase.loRange||
-e.X>u.ClipperBase.loRange||-e.Y>u.ClipperBase.loRange)g.Value=!0,this.RangeTest(e,g)};u.ClipperBase.prototype.InitEdge=function(e,g,l,r){e.Next=g;e.Prev=l;e.Curr.X=r.X;e.Curr.Y=r.Y;u.use_xyz&&(e.Curr.Z=r.Z);e.OutIdx=-1};u.ClipperBase.prototype.InitEdge2=function(e,g){e.Curr.Y>=e.Next.Curr.Y?(e.Bot.X=e.Curr.X,e.Bot.Y=e.Curr.Y,u.use_xyz&&(e.Bot.Z=e.Curr.Z),e.Top.X=e.Next.Curr.X,e.Top.Y=e.Next.Curr.Y,u.use_xyz&&(e.Top.Z=e.Next.Curr.Z)):(e.Top.X=e.Curr.X,e.Top.Y=e.Curr.Y,u.use_xyz&&(e.Top.Z=e.Curr.Z),
e.Bot.X=e.Next.Curr.X,e.Bot.Y=e.Next.Curr.Y,u.use_xyz&&(e.Bot.Z=e.Next.Curr.Z));this.SetDx(e);e.PolyTyp=g};u.ClipperBase.prototype.FindNextLocMin=function(e){for(var g;;){for(;u.IntPoint.op_Inequality(e.Bot,e.Prev.Bot)||u.IntPoint.op_Equality(e.Curr,e.Top);)e=e.Next;if(e.Dx!=u.ClipperBase.horizontal&&e.Prev.Dx!=u.ClipperBase.horizontal)break;for(;e.Prev.Dx==u.ClipperBase.horizontal;)e=e.Prev;for(g=e;e.Dx==u.ClipperBase.horizontal;)e=e.Next;if(e.Top.Y!=e.Prev.Bot.Y){g.Prev.Bot.X<e.Bot.X&&(e=g);break}}return e};
u.ClipperBase.prototype.ProcessBound=function(e,g){var l,r=e,x;if(r.OutIdx==u.ClipperBase.Skip){e=r;if(g){for(;e.Top.Y==e.Next.Bot.Y;)e=e.Next;for(;e!=r&&e.Dx==u.ClipperBase.horizontal;)e=e.Prev}else{for(;e.Top.Y==e.Prev.Bot.Y;)e=e.Prev;for(;e!=r&&e.Dx==u.ClipperBase.horizontal;)e=e.Next}e==r?r=g?e.Next:e.Prev:(e=g?r.Next:r.Prev,l=new u.LocalMinima,l.Next=null,l.Y=e.Bot.Y,l.LeftBound=null,l.RightBound=e,e.WindDelta=0,r=this.ProcessBound(e,g),this.InsertLocalMinima(l));return r}e.Dx==u.ClipperBase.horizontal&&
(l=g?e.Prev:e.Next,l.OutIdx!=u.ClipperBase.Skip&&(l.Dx==u.ClipperBase.horizontal?l.Bot.X!=e.Bot.X&&l.Top.X!=e.Bot.X&&this.ReverseHorizontal(e):l.Bot.X!=e.Bot.X&&this.ReverseHorizontal(e)));l=e;if(g){for(;r.Top.Y==r.Next.Bot.Y&&r.Next.OutIdx!=u.ClipperBase.Skip;)r=r.Next;if(r.Dx==u.ClipperBase.horizontal&&r.Next.OutIdx!=u.ClipperBase.Skip){for(x=r;x.Prev.Dx==u.ClipperBase.horizontal;)x=x.Prev;x.Prev.Top.X==r.Next.Top.X?g||(r=x.Prev):x.Prev.Top.X>r.Next.Top.X&&(r=x.Prev)}for(;e!=r;)e.NextInLML=e.Next,
e.Dx==u.ClipperBase.horizontal&&e!=l&&e.Bot.X!=e.Prev.Top.X&&this.ReverseHorizontal(e),e=e.Next;e.Dx==u.ClipperBase.horizontal&&e!=l&&e.Bot.X!=e.Prev.Top.X&&this.ReverseHorizontal(e);r=r.Next}else{for(;r.Top.Y==r.Prev.Bot.Y&&r.Prev.OutIdx!=u.ClipperBase.Skip;)r=r.Prev;if(r.Dx==u.ClipperBase.horizontal&&r.Prev.OutIdx!=u.ClipperBase.Skip){for(x=r;x.Next.Dx==u.ClipperBase.horizontal;)x=x.Next;x.Next.Top.X==r.Prev.Top.X?g||(r=x.Next):x.Next.Top.X>r.Prev.Top.X&&(r=x.Next)}for(;e!=r;)e.NextInLML=e.Prev,
e.Dx==u.ClipperBase.horizontal&&e!=l&&e.Bot.X!=e.Next.Top.X&&this.ReverseHorizontal(e),e=e.Prev;e.Dx==u.ClipperBase.horizontal&&e!=l&&e.Bot.X!=e.Next.Top.X&&this.ReverseHorizontal(e);r=r.Prev}return r};u.ClipperBase.prototype.AddPath=function(e,g,l){u.use_lines?l||g!=u.PolyType.ptClip||u.Error("AddPath: Open paths must be subject."):l||u.Error("AddPath: Open paths have been disabled.");var r=e.length-1;if(l)for(;0<r&&u.IntPoint.op_Equality(e[r],e[0]);)--r;for(;0<r&&u.IntPoint.op_Equality(e[r],e[r-
1]);)--r;if(l&&2>r||!l&&1>r)return!1;for(var x=[],D=0;D<=r;D++)x.push(new u.TEdge);var I=!0;x[1].Curr.X=e[1].X;x[1].Curr.Y=e[1].Y;u.use_xyz&&(x[1].Curr.Z=e[1].Z);var X={Value:this.m_UseFullRange};this.RangeTest(e[0],X);this.m_UseFullRange=X.Value;X.Value=this.m_UseFullRange;this.RangeTest(e[r],X);this.m_UseFullRange=X.Value;this.InitEdge(x[0],x[1],x[r],e[0]);this.InitEdge(x[r],x[0],x[r-1],e[r]);for(D=r-1;1<=D;--D)X.Value=this.m_UseFullRange,this.RangeTest(e[D],X),this.m_UseFullRange=X.Value,this.InitEdge(x[D],
x[D+1],x[D-1],e[D]);for(D=e=r=x[0];;)if(e.Curr!=e.Next.Curr||!l&&e.Next==r){if(e.Prev==e.Next)break;else if(l&&u.ClipperBase.SlopesEqual(e.Prev.Curr,e.Curr,e.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(e.Prev.Curr,e.Curr,e.Next.Curr))){e==r&&(r=e.Next);e=this.RemoveEdge(e);D=e=e.Prev;continue}e=e.Next;if(e==D||!l&&e.Next==r)break}else{if(e==e.Next)break;e==r&&(r=e.Next);D=e=this.RemoveEdge(e)}if(!l&&e==e.Next||l&&e.Prev==e.Next)return!1;l||(this.m_HasOpenPaths=
!0,r.Prev.OutIdx=u.ClipperBase.Skip);e=r;do this.InitEdge2(e,g),e=e.Next,I&&e.Curr.Y!=r.Curr.Y&&(I=!1);while(e!=r);if(I){if(l)return!1;e.Prev.OutIdx=u.ClipperBase.Skip;e.Prev.Bot.X<e.Prev.Top.X&&this.ReverseHorizontal(e.Prev);g=new u.LocalMinima;g.Next=null;g.Y=e.Bot.Y;g.LeftBound=null;g.RightBound=e;g.RightBound.Side=u.EdgeSide.esRight;for(g.RightBound.WindDelta=0;e.Next.OutIdx!=u.ClipperBase.Skip;)e.NextInLML=e.Next,e.Bot.X!=e.Prev.Top.X&&this.ReverseHorizontal(e),e=e.Next;this.InsertLocalMinima(g);
this.m_edges.push(x);return!0}this.m_edges.push(x);I=null;for(u.IntPoint.op_Equality(e.Prev.Bot,e.Prev.Top)&&(e=e.Next);;){e=this.FindNextLocMin(e);if(e==I)break;else null==I&&(I=e);g=new u.LocalMinima;g.Next=null;g.Y=e.Bot.Y;e.Dx<e.Prev.Dx?(g.LeftBound=e.Prev,g.RightBound=e,x=!1):(g.LeftBound=e,g.RightBound=e.Prev,x=!0);g.LeftBound.Side=u.EdgeSide.esLeft;g.RightBound.Side=u.EdgeSide.esRight;g.LeftBound.WindDelta=l?g.LeftBound.Next==g.RightBound?-1:1:0;g.RightBound.WindDelta=-g.LeftBound.WindDelta;
e=this.ProcessBound(g.LeftBound,x);e.OutIdx==u.ClipperBase.Skip&&(e=this.ProcessBound(e,x));r=this.ProcessBound(g.RightBound,!x);r.OutIdx==u.ClipperBase.Skip&&(r=this.ProcessBound(r,!x));g.LeftBound.OutIdx==u.ClipperBase.Skip?g.LeftBound=null:g.RightBound.OutIdx==u.ClipperBase.Skip&&(g.RightBound=null);this.InsertLocalMinima(g);x||(e=r)}return!0};u.ClipperBase.prototype.AddPaths=function(e,g,l){for(var r=!1,x=0,D=e.length;x<D;++x)this.AddPath(e[x],g,l)&&(r=!0);return r};u.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=
function(e,g,l){return u.IntPoint.op_Equality(e,l)||u.IntPoint.op_Equality(e,g)||u.IntPoint.op_Equality(l,g)?!1:e.X!=l.X?g.X>e.X==g.X<l.X:g.Y>e.Y==g.Y<l.Y};u.ClipperBase.prototype.RemoveEdge=function(e){e.Prev.Next=e.Next;e.Next.Prev=e.Prev;var g=e.Next;e.Prev=null;return g};u.ClipperBase.prototype.SetDx=function(e){e.Delta.X=e.Top.X-e.Bot.X;e.Delta.Y=e.Top.Y-e.Bot.Y;e.Dx=0===e.Delta.Y?u.ClipperBase.horizontal:e.Delta.X/e.Delta.Y};u.ClipperBase.prototype.InsertLocalMinima=function(e){if(null===this.m_MinimaList)this.m_MinimaList=
e;else if(e.Y>=this.m_MinimaList.Y)e.Next=this.m_MinimaList,this.m_MinimaList=e;else{for(var g=this.m_MinimaList;null!==g.Next&&e.Y<g.Next.Y;)g=g.Next;e.Next=g.Next;g.Next=e}};u.ClipperBase.prototype.PopLocalMinima=function(){null!==this.m_CurrentLM&&(this.m_CurrentLM=this.m_CurrentLM.Next)};u.ClipperBase.prototype.ReverseHorizontal=function(e){var g=e.Top.X;e.Top.X=e.Bot.X;e.Bot.X=g;u.use_xyz&&(g=e.Top.Z,e.Top.Z=e.Bot.Z,e.Bot.Z=g)};u.ClipperBase.prototype.Reset=function(){this.m_CurrentLM=this.m_MinimaList;
if(null!=this.m_CurrentLM)for(var e=this.m_MinimaList;null!=e;){var g=e.LeftBound;null!=g&&(g.Curr.X=g.Bot.X,g.Curr.Y=g.Bot.Y,u.use_xyz&&(g.Curr.Z=g.Bot.Z),g.Side=u.EdgeSide.esLeft,g.OutIdx=u.ClipperBase.Unassigned);g=e.RightBound;null!=g&&(g.Curr.X=g.Bot.X,g.Curr.Y=g.Bot.Y,u.use_xyz&&(g.Curr.Z=g.Bot.Z),g.Side=u.EdgeSide.esRight,g.OutIdx=u.ClipperBase.Unassigned);e=e.Next}};u.Clipper=function(e){"undefined"==typeof e&&(e=0);this.m_PolyOuts=null;this.m_ClipType=u.ClipType.ctIntersection;this.m_IntersectNodeComparer=
this.m_IntersectList=this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;this.m_ExecuteLocked=!1;this.m_SubjFillType=this.m_ClipFillType=u.PolyFillType.pftEvenOdd;this.m_GhostJoins=this.m_Joins=null;this.StrictlySimple=this.ReverseSolution=this.m_UsingPolyTree=!1;u.ClipperBase.call(this);this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;this.m_IntersectList=[];this.m_IntersectNodeComparer=u.MyIntersectNodeSort.Compare;this.m_UsingPolyTree=this.m_ExecuteLocked=!1;this.m_PolyOuts=[];
this.m_Joins=[];this.m_GhostJoins=[];this.ReverseSolution=0!==(1&e);this.StrictlySimple=0!==(2&e);this.PreserveCollinear=0!==(4&e);u.use_xyz&&(this.ZFillFunction=null)};u.Clipper.ioReverseSolution=1;u.Clipper.ioStrictlySimple=2;u.Clipper.ioPreserveCollinear=4;u.Clipper.prototype.Clear=function(){0!==this.m_edges.length&&(this.DisposeAllPolyPts(),u.ClipperBase.prototype.Clear.call(this))};u.Clipper.prototype.DisposeScanbeamList=function(){for(;null!==this.m_Scanbeam;){var e=this.m_Scanbeam.Next;this.m_Scanbeam=
null;this.m_Scanbeam=e}};u.Clipper.prototype.Reset=function(){u.ClipperBase.prototype.Reset.call(this);this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;for(var e=this.m_MinimaList;null!==e;)this.InsertScanbeam(e.Y),e=e.Next};u.Clipper.prototype.InsertScanbeam=function(e){if(null===this.m_Scanbeam)this.m_Scanbeam=new u.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=e;else if(e>this.m_Scanbeam.Y){var g=new u.Scanbeam;g.Y=e;g.Next=this.m_Scanbeam;this.m_Scanbeam=g}else{for(var l=this.m_Scanbeam;null!==
l.Next&&e<=l.Next.Y;)l=l.Next;e!=l.Y&&(g=new u.Scanbeam,g.Y=e,g.Next=l.Next,l.Next=g)}};u.Clipper.prototype.Execute=function(){var e=arguments,g=e.length,l=e[1]instanceof u.PolyTree;if(4!=g||l){if(4==g&&l){g=e[0];var r=e[1];l=e[2];e=e[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0;this.m_SubjFillType=l;this.m_ClipFillType=e;this.m_ClipType=g;this.m_UsingPolyTree=!0;try{(x=this.ExecuteInternal())&&this.BuildResult2(r)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return x}if(2==
g&&!l||2==g&&l)return g=e[0],r=e[1],this.Execute(g,r,u.PolyFillType.pftEvenOdd,u.PolyFillType.pftEvenOdd)}else{g=e[0];r=e[1];l=e[2];e=e[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&u.Error("Error: PolyTree struct is need for open path clipping.");this.m_ExecuteLocked=!0;u.Clear(r);this.m_SubjFillType=l;this.m_ClipFillType=e;this.m_ClipType=g;this.m_UsingPolyTree=!1;try{var x=this.ExecuteInternal();x&&this.BuildResult(r)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return x}};
u.Clipper.prototype.FixHoleLinkage=function(e){if(null!==e.FirstLeft&&(e.IsHole==e.FirstLeft.IsHole||null===e.FirstLeft.Pts)){for(var g=e.FirstLeft;null!==g&&(g.IsHole==e.IsHole||null===g.Pts);)g=g.FirstLeft;e.FirstLeft=g}};u.Clipper.prototype.ExecuteInternal=function(){try{this.Reset();if(null===this.m_CurrentLM)return!1;var e=this.PopScanbeam();do{this.InsertLocalMinimaIntoAEL(e);u.Clear(this.m_GhostJoins);this.ProcessHorizontals(!1);if(null===this.m_Scanbeam)break;var g=this.PopScanbeam();if(!this.ProcessIntersections(g))return!1;
this.ProcessEdgesAtTopOfScanbeam(g);e=g}while(null!==this.m_Scanbeam||null!==this.m_CurrentLM);e=0;for(var l=this.m_PolyOuts.length;e<l;e++){var r=this.m_PolyOuts[e];null===r.Pts||r.IsOpen||(r.IsHole^this.ReverseSolution)==0<this.Area(r)&&this.ReversePolyPtLinks(r.Pts)}this.JoinCommonEdges();e=0;for(l=this.m_PolyOuts.length;e<l;e++)r=this.m_PolyOuts[e],null===r.Pts||r.IsOpen||this.FixupOutPolygon(r);this.StrictlySimple&&this.DoSimplePolygons();return!0}finally{u.Clear(this.m_Joins),u.Clear(this.m_GhostJoins)}};
u.Clipper.prototype.PopScanbeam=function(){var e=this.m_Scanbeam.Y;this.m_Scanbeam=this.m_Scanbeam.Next;return e};u.Clipper.prototype.DisposeAllPolyPts=function(){for(var e=0,g=this.m_PolyOuts.length;e<g;++e)this.DisposeOutRec(e);u.Clear(this.m_PolyOuts)};u.Clipper.prototype.DisposeOutRec=function(e){this.m_PolyOuts[e].Pts=null;this.m_PolyOuts[e]=null};u.Clipper.prototype.AddJoin=function(e,g,l){var r=new u.Join;r.OutPt1=e;r.OutPt2=g;r.OffPt.X=l.X;r.OffPt.Y=l.Y;u.use_xyz&&(r.OffPt.Z=l.Z);this.m_Joins.push(r)};
u.Clipper.prototype.AddGhostJoin=function(e,g){var l=new u.Join;l.OutPt1=e;l.OffPt.X=g.X;l.OffPt.Y=g.Y;u.use_xyz&&(l.OffPt.Z=g.Z);this.m_GhostJoins.push(l)};u.Clipper.prototype.SetZ=function(e,g,l){null!==this.ZFillFunction&&0==e.Z&&null!==this.ZFillFunction&&(u.IntPoint.op_Equality(e,g.Bot)?e.Z=g.Bot.Z:u.IntPoint.op_Equality(e,g.Top)?e.Z=g.Top.Z:u.IntPoint.op_Equality(e,l.Bot)?e.Z=l.Bot.Z:u.IntPoint.op_Equality(e,l.Top)?e.Z=l.Top.Z:this.ZFillFunction(g.Bot,g.Top,l.Bot,l.Top,e))};u.Clipper.prototype.InsertLocalMinimaIntoAEL=
function(e){for(;null!==this.m_CurrentLM&&this.m_CurrentLM.Y==e;){var g=this.m_CurrentLM.LeftBound,l=this.m_CurrentLM.RightBound;this.PopLocalMinima();var r=null;null===g?(this.InsertEdgeIntoAEL(l,null),this.SetWindingCount(l),this.IsContributing(l)&&(r=this.AddOutPt(l,l.Bot))):(null==l?(this.InsertEdgeIntoAEL(g,null),this.SetWindingCount(g),this.IsContributing(g)&&(r=this.AddOutPt(g,g.Bot))):(this.InsertEdgeIntoAEL(g,null),this.InsertEdgeIntoAEL(l,g),this.SetWindingCount(g),l.WindCnt=g.WindCnt,l.WindCnt2=
g.WindCnt2,this.IsContributing(g)&&(r=this.AddLocalMinPoly(g,l,g.Bot))),this.InsertScanbeam(g.Top.Y));null!=l&&(u.ClipperBase.IsHorizontal(l)?this.AddEdgeToSEL(l):this.InsertScanbeam(l.Top.Y));if(null!=g&&null!=l){if(null!==r&&u.ClipperBase.IsHorizontal(l)&&0<this.m_GhostJoins.length&&0!==l.WindDelta)for(var x=0,D=this.m_GhostJoins.length;x<D;x++){var I=this.m_GhostJoins[x];this.HorzSegmentsOverlap(I.OutPt1.Pt.X,I.OffPt.X,l.Bot.X,l.Top.X)&&this.AddJoin(I.OutPt1,r,I.OffPt)}0<=g.OutIdx&&null!==g.PrevInAEL&&
g.PrevInAEL.Curr.X==g.Bot.X&&0<=g.PrevInAEL.OutIdx&&u.ClipperBase.SlopesEqual(g.PrevInAEL,g,this.m_UseFullRange)&&0!==g.WindDelta&&0!==g.PrevInAEL.WindDelta&&(x=this.AddOutPt(g.PrevInAEL,g.Bot),this.AddJoin(r,x,g.Top));if(g.NextInAEL!=l&&(0<=l.OutIdx&&0<=l.PrevInAEL.OutIdx&&u.ClipperBase.SlopesEqual(l.PrevInAEL,l,this.m_UseFullRange)&&0!==l.WindDelta&&0!==l.PrevInAEL.WindDelta&&(x=this.AddOutPt(l.PrevInAEL,l.Bot),this.AddJoin(r,x,l.Top)),r=g.NextInAEL,null!==r))for(;r!=l;)this.IntersectEdges(l,r,
g.Curr,!1),r=r.NextInAEL}}};u.Clipper.prototype.InsertEdgeIntoAEL=function(e,g){if(null===this.m_ActiveEdges)e.PrevInAEL=null,e.NextInAEL=null,this.m_ActiveEdges=e;else if(null===g&&this.E2InsertsBeforeE1(this.m_ActiveEdges,e))e.PrevInAEL=null,e.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges=this.m_ActiveEdges.PrevInAEL=e;else{for(null===g&&(g=this.m_ActiveEdges);null!==g.NextInAEL&&!this.E2InsertsBeforeE1(g.NextInAEL,e);)g=g.NextInAEL;e.NextInAEL=g.NextInAEL;null!==g.NextInAEL&&(g.NextInAEL.PrevInAEL=
e);e.PrevInAEL=g;g.NextInAEL=e}};u.Clipper.prototype.E2InsertsBeforeE1=function(e,g){return g.Curr.X==e.Curr.X?g.Top.Y>e.Top.Y?g.Top.X<u.Clipper.TopX(e,g.Top.Y):e.Top.X>u.Clipper.TopX(g,e.Top.Y):g.Curr.X<e.Curr.X};u.Clipper.prototype.IsEvenOddFillType=function(e){return e.PolyTyp==u.PolyType.ptSubject?this.m_SubjFillType==u.PolyFillType.pftEvenOdd:this.m_ClipFillType==u.PolyFillType.pftEvenOdd};u.Clipper.prototype.IsEvenOddAltFillType=function(e){return e.PolyTyp==u.PolyType.ptSubject?this.m_ClipFillType==
u.PolyFillType.pftEvenOdd:this.m_SubjFillType==u.PolyFillType.pftEvenOdd};u.Clipper.prototype.IsContributing=function(e){var g,l;e.PolyTyp==u.PolyType.ptSubject?(g=this.m_SubjFillType,l=this.m_ClipFillType):(g=this.m_ClipFillType,l=this.m_SubjFillType);switch(g){case u.PolyFillType.pftEvenOdd:if(0===e.WindDelta&&1!=e.WindCnt)return!1;break;case u.PolyFillType.pftNonZero:if(1!=Math.abs(e.WindCnt))return!1;break;case u.PolyFillType.pftPositive:if(1!=e.WindCnt)return!1;break;default:if(-1!=e.WindCnt)return!1}switch(this.m_ClipType){case u.ClipType.ctIntersection:switch(l){case u.PolyFillType.pftEvenOdd:case u.PolyFillType.pftNonZero:return 0!==
e.WindCnt2;case u.PolyFillType.pftPositive:return 0<e.WindCnt2;default:return 0>e.WindCnt2}case u.ClipType.ctUnion:switch(l){case u.PolyFillType.pftEvenOdd:case u.PolyFillType.pftNonZero:return 0===e.WindCnt2;case u.PolyFillType.pftPositive:return 0>=e.WindCnt2;default:return 0<=e.WindCnt2}case u.ClipType.ctDifference:if(e.PolyTyp==u.PolyType.ptSubject)switch(l){case u.PolyFillType.pftEvenOdd:case u.PolyFillType.pftNonZero:return 0===e.WindCnt2;case u.PolyFillType.pftPositive:return 0>=e.WindCnt2;
default:return 0<=e.WindCnt2}else switch(l){case u.PolyFillType.pftEvenOdd:case u.PolyFillType.pftNonZero:return 0!==e.WindCnt2;case u.PolyFillType.pftPositive:return 0<e.WindCnt2;default:return 0>e.WindCnt2}case u.ClipType.ctXor:if(0===e.WindDelta)switch(l){case u.PolyFillType.pftEvenOdd:case u.PolyFillType.pftNonZero:return 0===e.WindCnt2;case u.PolyFillType.pftPositive:return 0>=e.WindCnt2;default:return 0<=e.WindCnt2}}return!0};u.Clipper.prototype.SetWindingCount=function(e){for(var g=e.PrevInAEL;null!==
g&&(g.PolyTyp!=e.PolyTyp||0===g.WindDelta);)g=g.PrevInAEL;if(null===g)e.WindCnt=0===e.WindDelta?1:e.WindDelta,e.WindCnt2=0,g=this.m_ActiveEdges;else{if(0===e.WindDelta&&this.m_ClipType!=u.ClipType.ctUnion)e.WindCnt=1;else if(this.IsEvenOddFillType(e))if(0===e.WindDelta){for(var l=!0,r=g.PrevInAEL;null!==r;)r.PolyTyp==g.PolyTyp&&0!==r.WindDelta&&(l=!l),r=r.PrevInAEL;e.WindCnt=l?0:1}else e.WindCnt=e.WindDelta;else e.WindCnt=0>g.WindCnt*g.WindDelta?1<Math.abs(g.WindCnt)?0>g.WindDelta*e.WindDelta?g.WindCnt:
g.WindCnt+e.WindDelta:0===e.WindDelta?1:e.WindDelta:0===e.WindDelta?0>g.WindCnt?g.WindCnt-1:g.WindCnt+1:0>g.WindDelta*e.WindDelta?g.WindCnt:g.WindCnt+e.WindDelta;e.WindCnt2=g.WindCnt2;g=g.NextInAEL}if(this.IsEvenOddAltFillType(e))for(;g!=e;)0!==g.WindDelta&&(e.WindCnt2=0===e.WindCnt2?1:0),g=g.NextInAEL;else for(;g!=e;)e.WindCnt2+=g.WindDelta,g=g.NextInAEL};u.Clipper.prototype.AddEdgeToSEL=function(e){null===this.m_SortedEdges?(this.m_SortedEdges=e,e.PrevInSEL=null,e.NextInSEL=null):(e.NextInSEL=this.m_SortedEdges,
e.PrevInSEL=null,this.m_SortedEdges=this.m_SortedEdges.PrevInSEL=e)};u.Clipper.prototype.CopyAELToSEL=function(){var e=this.m_ActiveEdges;for(this.m_SortedEdges=e;null!==e;)e.PrevInSEL=e.PrevInAEL,e=e.NextInSEL=e.NextInAEL};u.Clipper.prototype.SwapPositionsInAEL=function(e,g){if(e.NextInAEL!=e.PrevInAEL&&g.NextInAEL!=g.PrevInAEL){if(e.NextInAEL==g){var l=g.NextInAEL;null!==l&&(l.PrevInAEL=e);var r=e.PrevInAEL;null!==r&&(r.NextInAEL=g);g.PrevInAEL=r;g.NextInAEL=e;e.PrevInAEL=g;e.NextInAEL=l}else g.NextInAEL==
e?(l=e.NextInAEL,null!==l&&(l.PrevInAEL=g),r=g.PrevInAEL,null!==r&&(r.NextInAEL=e),e.PrevInAEL=r,e.NextInAEL=g,g.PrevInAEL=e,g.NextInAEL=l):(l=e.NextInAEL,r=e.PrevInAEL,e.NextInAEL=g.NextInAEL,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=e),e.PrevInAEL=g.PrevInAEL,null!==e.PrevInAEL&&(e.PrevInAEL.NextInAEL=e),g.NextInAEL=l,null!==g.NextInAEL&&(g.NextInAEL.PrevInAEL=g),g.PrevInAEL=r,null!==g.PrevInAEL&&(g.PrevInAEL.NextInAEL=g));null===e.PrevInAEL?this.m_ActiveEdges=e:null===g.PrevInAEL&&(this.m_ActiveEdges=
g)}};u.Clipper.prototype.SwapPositionsInSEL=function(e,g){if(null!==e.NextInSEL||null!==e.PrevInSEL)if(null!==g.NextInSEL||null!==g.PrevInSEL){if(e.NextInSEL==g){var l=g.NextInSEL;null!==l&&(l.PrevInSEL=e);var r=e.PrevInSEL;null!==r&&(r.NextInSEL=g);g.PrevInSEL=r;g.NextInSEL=e;e.PrevInSEL=g;e.NextInSEL=l}else g.NextInSEL==e?(l=e.NextInSEL,null!==l&&(l.PrevInSEL=g),r=g.PrevInSEL,null!==r&&(r.NextInSEL=e),e.PrevInSEL=r,e.NextInSEL=g,g.PrevInSEL=e,g.NextInSEL=l):(l=e.NextInSEL,r=e.PrevInSEL,e.NextInSEL=
g.NextInSEL,null!==e.NextInSEL&&(e.NextInSEL.PrevInSEL=e),e.PrevInSEL=g.PrevInSEL,null!==e.PrevInSEL&&(e.PrevInSEL.NextInSEL=e),g.NextInSEL=l,null!==g.NextInSEL&&(g.NextInSEL.PrevInSEL=g),g.PrevInSEL=r,null!==g.PrevInSEL&&(g.PrevInSEL.NextInSEL=g));null===e.PrevInSEL?this.m_SortedEdges=e:null===g.PrevInSEL&&(this.m_SortedEdges=g)}};u.Clipper.prototype.AddLocalMaxPoly=function(e,g,l){this.AddOutPt(e,l);0==g.WindDelta&&this.AddOutPt(g,l);e.OutIdx==g.OutIdx?(e.OutIdx=-1,g.OutIdx=-1):e.OutIdx<g.OutIdx?
this.AppendPolygon(e,g):this.AppendPolygon(g,e)};u.Clipper.prototype.AddLocalMinPoly=function(e,g,l){var r,x;u.ClipperBase.IsHorizontal(g)||e.Dx>g.Dx?(r=this.AddOutPt(e,l),g.OutIdx=e.OutIdx,e.Side=u.EdgeSide.esLeft,g.Side=u.EdgeSide.esRight,x=e,e=x.PrevInAEL==g?g.PrevInAEL:x.PrevInAEL):(r=this.AddOutPt(g,l),e.OutIdx=g.OutIdx,e.Side=u.EdgeSide.esRight,g.Side=u.EdgeSide.esLeft,x=g,e=x.PrevInAEL==e?e.PrevInAEL:x.PrevInAEL);null!==e&&0<=e.OutIdx&&u.Clipper.TopX(e,l.Y)==u.Clipper.TopX(x,l.Y)&&u.ClipperBase.SlopesEqual(x,
e,this.m_UseFullRange)&&0!==x.WindDelta&&0!==e.WindDelta&&(l=this.AddOutPt(e,l),this.AddJoin(r,l,x.Top));return r};u.Clipper.prototype.CreateOutRec=function(){var e=new u.OutRec;e.Idx=-1;e.IsHole=!1;e.IsOpen=!1;e.FirstLeft=null;e.Pts=null;e.BottomPt=null;e.PolyNode=null;this.m_PolyOuts.push(e);e.Idx=this.m_PolyOuts.length-1;return e};u.Clipper.prototype.AddOutPt=function(e,g){var l=e.Side==u.EdgeSide.esLeft;if(0>e.OutIdx){var r=this.CreateOutRec();r.IsOpen=0===e.WindDelta;var x=new u.OutPt;r.Pts=
x;x.Idx=r.Idx;x.Pt.X=g.X;x.Pt.Y=g.Y;u.use_xyz&&(x.Pt.Z=g.Z);x.Next=x;x.Prev=x;r.IsOpen||this.SetHoleState(e,r);e.OutIdx=r.Idx}else{r=this.m_PolyOuts[e.OutIdx];e=r.Pts;if(l&&u.IntPoint.op_Equality(g,e.Pt))return e;if(!l&&u.IntPoint.op_Equality(g,e.Prev.Pt))return e.Prev;x=new u.OutPt;x.Idx=r.Idx;x.Pt.X=g.X;x.Pt.Y=g.Y;u.use_xyz&&(x.Pt.Z=g.Z);x.Next=e;x.Prev=e.Prev;x.Prev.Next=x;e.Prev=x;l&&(r.Pts=x)}return x};u.Clipper.prototype.SwapPoints=function(e,g){var l=new u.IntPoint(e.Value);e.Value.X=g.Value.X;
e.Value.Y=g.Value.Y;u.use_xyz&&(e.Value.Z=g.Value.Z);g.Value.X=l.X;g.Value.Y=l.Y;u.use_xyz&&(g.Value.Z=l.Z)};u.Clipper.prototype.HorzSegmentsOverlap=function(e,g,l,r){var x;e>g&&(x=e,e=g,g=x);l>r&&(x=l,l=r,r=x);return e<r&&l<g};u.Clipper.prototype.SetHoleState=function(e,g){var l=!1;for(e=e.PrevInAEL;null!==e;)0<=e.OutIdx&&0!=e.WindDelta&&(l=!l,null===g.FirstLeft&&(g.FirstLeft=this.m_PolyOuts[e.OutIdx])),e=e.PrevInAEL;l&&(g.IsHole=!0)};u.Clipper.prototype.GetDx=function(e,g){return e.Y==g.Y?u.ClipperBase.horizontal:
(g.X-e.X)/(g.Y-e.Y)};u.Clipper.prototype.FirstIsBottomPt=function(e,g){for(var l=e.Prev;u.IntPoint.op_Equality(l.Pt,e.Pt)&&l!=e;)l=l.Prev;var r=Math.abs(this.GetDx(e.Pt,l.Pt));for(l=e.Next;u.IntPoint.op_Equality(l.Pt,e.Pt)&&l!=e;)l=l.Next;e=Math.abs(this.GetDx(e.Pt,l.Pt));for(l=g.Prev;u.IntPoint.op_Equality(l.Pt,g.Pt)&&l!=g;)l=l.Prev;var x=Math.abs(this.GetDx(g.Pt,l.Pt));for(l=g.Next;u.IntPoint.op_Equality(l.Pt,g.Pt)&&l!=g;)l=l.Next;l=Math.abs(this.GetDx(g.Pt,l.Pt));return r>=x&&r>=l||e>=x&&e>=l};
u.Clipper.prototype.GetBottomPt=function(e){for(var g=null,l=e.Next;l!=e;)l.Pt.Y>e.Pt.Y?(e=l,g=null):l.Pt.Y==e.Pt.Y&&l.Pt.X<=e.Pt.X&&(l.Pt.X<e.Pt.X?(g=null,e=l):l.Next!=e&&l.Prev!=e&&(g=l)),l=l.Next;if(null!==g)for(;g!=l;)for(this.FirstIsBottomPt(l,g)||(e=g),g=g.Next;u.IntPoint.op_Inequality(g.Pt,e.Pt);)g=g.Next;return e};u.Clipper.prototype.GetLowermostRec=function(e,g){null===e.BottomPt&&(e.BottomPt=this.GetBottomPt(e.Pts));null===g.BottomPt&&(g.BottomPt=this.GetBottomPt(g.Pts));var l=e.BottomPt,
r=g.BottomPt;return l.Pt.Y>r.Pt.Y?e:l.Pt.Y<r.Pt.Y?g:l.Pt.X<r.Pt.X?e:l.Pt.X>r.Pt.X?g:l.Next==l?g:r.Next==r?e:this.FirstIsBottomPt(l,r)?e:g};u.Clipper.prototype.Param1RightOfParam2=function(e,g){do if(e=e.FirstLeft,e==g)return!0;while(null!==e);return!1};u.Clipper.prototype.GetOutRec=function(e){for(e=this.m_PolyOuts[e];e!=this.m_PolyOuts[e.Idx];)e=this.m_PolyOuts[e.Idx];return e};u.Clipper.prototype.AppendPolygon=function(e,g){var l=this.m_PolyOuts[e.OutIdx],r=this.m_PolyOuts[g.OutIdx];var x=this.Param1RightOfParam2(l,
r)?r:this.Param1RightOfParam2(r,l)?l:this.GetLowermostRec(l,r);var D=l.Pts,I=D.Prev,X=r.Pts,ea=X.Prev;e.Side==u.EdgeSide.esLeft?(g.Side==u.EdgeSide.esLeft?(this.ReversePolyPtLinks(X),X.Next=D,D.Prev=X,I.Next=ea,ea.Prev=I,l.Pts=ea):(ea.Next=D,D.Prev=ea,X.Prev=I,I.Next=X,l.Pts=X),D=u.EdgeSide.esLeft):(g.Side==u.EdgeSide.esRight?(this.ReversePolyPtLinks(X),I.Next=ea,ea.Prev=I,X.Next=D,D.Prev=X):(I.Next=X,X.Prev=I,D.Prev=ea,ea.Next=D),D=u.EdgeSide.esRight);l.BottomPt=null;x==r&&(r.FirstLeft!=l&&(l.FirstLeft=
r.FirstLeft),l.IsHole=r.IsHole);r.Pts=null;r.BottomPt=null;r.FirstLeft=l;x=e.OutIdx;I=g.OutIdx;e.OutIdx=-1;g.OutIdx=-1;for(X=this.m_ActiveEdges;null!==X;){if(X.OutIdx==I){X.OutIdx=x;X.Side=D;break}X=X.NextInAEL}r.Idx=l.Idx};u.Clipper.prototype.ReversePolyPtLinks=function(e){if(null!==e){var g=e;do{var l=g.Next;g.Next=g.Prev;g=g.Prev=l}while(g!=e)}};u.Clipper.SwapSides=function(e,g){var l=e.Side;e.Side=g.Side;g.Side=l};u.Clipper.SwapPolyIndexes=function(e,g){var l=e.OutIdx;e.OutIdx=g.OutIdx;g.OutIdx=
l};u.Clipper.prototype.IntersectEdges=function(e,g,l){var r=0<=e.OutIdx,x=0<=g.OutIdx;u.use_xyz&&this.SetZ(l,e,g);if(!u.use_lines||0!==e.WindDelta&&0!==g.WindDelta){if(e.PolyTyp==g.PolyTyp)if(this.IsEvenOddFillType(e)){var D=e.WindCnt;e.WindCnt=g.WindCnt;g.WindCnt=D}else e.WindCnt=0===e.WindCnt+g.WindDelta?-e.WindCnt:e.WindCnt+g.WindDelta,g.WindCnt=0===g.WindCnt-e.WindDelta?-g.WindCnt:g.WindCnt-e.WindDelta;else this.IsEvenOddFillType(g)?e.WindCnt2=0===e.WindCnt2?1:0:e.WindCnt2+=g.WindDelta,this.IsEvenOddFillType(e)?
g.WindCnt2=0===g.WindCnt2?1:0:g.WindCnt2-=e.WindDelta;var I,X,ea;e.PolyTyp==u.PolyType.ptSubject?(I=this.m_SubjFillType,ea=this.m_ClipFillType):(I=this.m_ClipFillType,ea=this.m_SubjFillType);g.PolyTyp==u.PolyType.ptSubject?(X=this.m_SubjFillType,D=this.m_ClipFillType):(X=this.m_ClipFillType,D=this.m_SubjFillType);switch(I){case u.PolyFillType.pftPositive:I=e.WindCnt;break;case u.PolyFillType.pftNegative:I=-e.WindCnt;break;default:I=Math.abs(e.WindCnt)}switch(X){case u.PolyFillType.pftPositive:X=g.WindCnt;
break;case u.PolyFillType.pftNegative:X=-g.WindCnt;break;default:X=Math.abs(g.WindCnt)}if(r&&x)0!=I&&1!=I||0!=X&&1!=X||e.PolyTyp!=g.PolyTyp&&this.m_ClipType!=u.ClipType.ctXor?this.AddLocalMaxPoly(e,g,l):(this.AddOutPt(e,l),this.AddOutPt(g,l),u.Clipper.SwapSides(e,g),u.Clipper.SwapPolyIndexes(e,g));else if(r){if(0===X||1==X)this.AddOutPt(e,l),u.Clipper.SwapSides(e,g),u.Clipper.SwapPolyIndexes(e,g)}else if(x){if(0===I||1==I)this.AddOutPt(g,l),u.Clipper.SwapSides(e,g),u.Clipper.SwapPolyIndexes(e,g)}else if(!(0!=
I&&1!=I||0!=X&&1!=X)){switch(ea){case u.PolyFillType.pftPositive:r=e.WindCnt2;break;case u.PolyFillType.pftNegative:r=-e.WindCnt2;break;default:r=Math.abs(e.WindCnt2)}switch(D){case u.PolyFillType.pftPositive:x=g.WindCnt2;break;case u.PolyFillType.pftNegative:x=-g.WindCnt2;break;default:x=Math.abs(g.WindCnt2)}if(e.PolyTyp!=g.PolyTyp)this.AddLocalMinPoly(e,g,l);else if(1==I&&1==X)switch(this.m_ClipType){case u.ClipType.ctIntersection:0<r&&0<x&&this.AddLocalMinPoly(e,g,l);break;case u.ClipType.ctUnion:0>=
r&&0>=x&&this.AddLocalMinPoly(e,g,l);break;case u.ClipType.ctDifference:(e.PolyTyp==u.PolyType.ptClip&&0<r&&0<x||e.PolyTyp==u.PolyType.ptSubject&&0>=r&&0>=x)&&this.AddLocalMinPoly(e,g,l);break;case u.ClipType.ctXor:this.AddLocalMinPoly(e,g,l)}else u.Clipper.SwapSides(e,g)}}else if(0!=e.WindDelta||0!=g.WindDelta)e.PolyTyp==g.PolyTyp&&e.WindDelta!=g.WindDelta&&this.m_ClipType==u.ClipType.ctUnion?0===e.WindDelta?x&&(this.AddOutPt(e,l),r&&(e.OutIdx=-1)):r&&(this.AddOutPt(g,l),x&&(g.OutIdx=-1)):e.PolyTyp!=
g.PolyTyp&&(0!==e.WindDelta||1!=Math.abs(g.WindCnt)||this.m_ClipType==u.ClipType.ctUnion&&0!==g.WindCnt2?0!==g.WindDelta||1!=Math.abs(e.WindCnt)||this.m_ClipType==u.ClipType.ctUnion&&0!==e.WindCnt2||(this.AddOutPt(g,l),x&&(g.OutIdx=-1)):(this.AddOutPt(e,l),r&&(e.OutIdx=-1)))};u.Clipper.prototype.DeleteFromAEL=function(e){var g=e.PrevInAEL,l=e.NextInAEL;if(null!==g||null!==l||e==this.m_ActiveEdges)null!==g?g.NextInAEL=l:this.m_ActiveEdges=l,null!==l&&(l.PrevInAEL=g),e.NextInAEL=null,e.PrevInAEL=null};
u.Clipper.prototype.DeleteFromSEL=function(e){var g=e.PrevInSEL,l=e.NextInSEL;if(null!==g||null!==l||e==this.m_SortedEdges)null!==g?g.NextInSEL=l:this.m_SortedEdges=l,null!==l&&(l.PrevInSEL=g),e.NextInSEL=null,e.PrevInSEL=null};u.Clipper.prototype.UpdateEdgeIntoAEL=function(e){null===e.NextInLML&&u.Error("UpdateEdgeIntoAEL: invalid call");var g=e.PrevInAEL,l=e.NextInAEL;e.NextInLML.OutIdx=e.OutIdx;null!==g?g.NextInAEL=e.NextInLML:this.m_ActiveEdges=e.NextInLML;null!==l&&(l.PrevInAEL=e.NextInLML);
e.NextInLML.Side=e.Side;e.NextInLML.WindDelta=e.WindDelta;e.NextInLML.WindCnt=e.WindCnt;e.NextInLML.WindCnt2=e.WindCnt2;e=e.NextInLML;e.Curr.X=e.Bot.X;e.Curr.Y=e.Bot.Y;u.use_xyz&&(e.Curr.Z=e.Bot.Z);e.PrevInAEL=g;e.NextInAEL=l;u.ClipperBase.IsHorizontal(e)||this.InsertScanbeam(e.Top.Y);return e};u.Clipper.prototype.ProcessHorizontals=function(e){for(var g=this.m_SortedEdges;null!==g;)this.DeleteFromSEL(g),this.ProcessHorizontal(g,e),g=this.m_SortedEdges};u.Clipper.prototype.GetHorzDirection=function(e,
g){e.Bot.X<e.Top.X?(g.Left=e.Bot.X,g.Right=e.Top.X,g.Dir=u.Direction.dLeftToRight):(g.Left=e.Top.X,g.Right=e.Bot.X,g.Dir=u.Direction.dRightToLeft)};u.Clipper.prototype.ProcessHorizontal=function(e,g){var l={Dir:null,Left:null,Right:null};this.GetHorzDirection(e,l);for(var r=l.Dir,x=l.Left,D=l.Right,I=e,X=null;null!==I.NextInLML&&u.ClipperBase.IsHorizontal(I.NextInLML);)I=I.NextInLML;for(null===I.NextInLML&&(X=this.GetMaximaPair(I));;){for(var ea=e==I,ha=this.GetNextInAEL(e,r);null!==ha&&!(ha.Curr.X==
e.Top.X&&null!==e.NextInLML&&ha.Dx<e.NextInLML.Dx);){l=this.GetNextInAEL(ha,r);if(r==u.Direction.dLeftToRight&&ha.Curr.X<=D||r==u.Direction.dRightToLeft&&ha.Curr.X>=x){if(ha==X&&ea){if(0<=e.OutIdx){r=this.AddOutPt(e,e.Top);for(l=this.m_SortedEdges;null!==l;)0<=l.OutIdx&&this.HorzSegmentsOverlap(e.Bot.X,e.Top.X,l.Bot.X,l.Top.X)&&(x=this.AddOutPt(l,l.Bot),this.AddJoin(x,r,l.Top)),l=l.NextInSEL;this.AddGhostJoin(r,e.Bot);this.AddLocalMaxPoly(e,X,e.Top)}this.DeleteFromAEL(e);this.DeleteFromAEL(X);return}if(r==
u.Direction.dLeftToRight){var Fa=new u.IntPoint(ha.Curr.X,e.Curr.Y);this.IntersectEdges(e,ha,Fa)}else Fa=new u.IntPoint(ha.Curr.X,e.Curr.Y),this.IntersectEdges(ha,e,Fa);this.SwapPositionsInAEL(e,ha)}else if(r==u.Direction.dLeftToRight&&ha.Curr.X>=D||r==u.Direction.dRightToLeft&&ha.Curr.X<=x)break;ha=l}if(null!==e.NextInLML&&u.ClipperBase.IsHorizontal(e.NextInLML))e=this.UpdateEdgeIntoAEL(e),0<=e.OutIdx&&this.AddOutPt(e,e.Bot),l={Dir:r,Left:x,Right:D},this.GetHorzDirection(e,l),r=l.Dir,x=l.Left,D=
l.Right;else break}null!==e.NextInLML?0<=e.OutIdx?(r=this.AddOutPt(e,e.Top),g&&this.AddGhostJoin(r,e.Bot),e=this.UpdateEdgeIntoAEL(e),0!==e.WindDelta&&(X=e.PrevInAEL,l=e.NextInAEL,null!==X&&X.Curr.X==e.Bot.X&&X.Curr.Y==e.Bot.Y&&0!==X.WindDelta&&0<=X.OutIdx&&X.Curr.Y>X.Top.Y&&u.ClipperBase.SlopesEqual(e,X,this.m_UseFullRange)?(x=this.AddOutPt(X,e.Bot),this.AddJoin(r,x,e.Top)):null!==l&&l.Curr.X==e.Bot.X&&l.Curr.Y==e.Bot.Y&&0!==l.WindDelta&&0<=l.OutIdx&&l.Curr.Y>l.Top.Y&&u.ClipperBase.SlopesEqual(e,
l,this.m_UseFullRange)&&(x=this.AddOutPt(l,e.Bot),this.AddJoin(r,x,e.Top)))):this.UpdateEdgeIntoAEL(e):(0<=e.OutIdx&&this.AddOutPt(e,e.Top),this.DeleteFromAEL(e))};u.Clipper.prototype.GetNextInAEL=function(e,g){return g==u.Direction.dLeftToRight?e.NextInAEL:e.PrevInAEL};u.Clipper.prototype.IsMinima=function(e){return null!==e&&e.Prev.NextInLML!=e&&e.Next.NextInLML!=e};u.Clipper.prototype.IsMaxima=function(e,g){return null!==e&&e.Top.Y==g&&null===e.NextInLML};u.Clipper.prototype.IsIntermediate=function(e,
g){return e.Top.Y==g&&null!==e.NextInLML};u.Clipper.prototype.GetMaximaPair=function(e){var g=null;u.IntPoint.op_Equality(e.Next.Top,e.Top)&&null===e.Next.NextInLML?g=e.Next:u.IntPoint.op_Equality(e.Prev.Top,e.Top)&&null===e.Prev.NextInLML&&(g=e.Prev);return null===g||-2!=g.OutIdx&&(g.NextInAEL!=g.PrevInAEL||u.ClipperBase.IsHorizontal(g))?g:null};u.Clipper.prototype.ProcessIntersections=function(e){if(null==this.m_ActiveEdges)return!0;try{this.BuildIntersectList(e);if(0==this.m_IntersectList.length)return!0;
if(1==this.m_IntersectList.length||this.FixupIntersectionOrder())this.ProcessIntersectList();else return!1}catch(g){this.m_SortedEdges=null,this.m_IntersectList.length=0,u.Error("ProcessIntersections error")}this.m_SortedEdges=null;return!0};u.Clipper.prototype.BuildIntersectList=function(e){if(null!==this.m_ActiveEdges){var g=this.m_ActiveEdges;for(this.m_SortedEdges=g;null!==g;)g.PrevInSEL=g.PrevInAEL,g.NextInSEL=g.NextInAEL,g.Curr.X=u.Clipper.TopX(g,e),g=g.NextInAEL;for(var l=!0;l&&null!==this.m_SortedEdges;){l=
!1;for(g=this.m_SortedEdges;null!==g.NextInSEL;){e=g.NextInSEL;var r=new u.IntPoint;g.Curr.X>e.Curr.X?(this.IntersectPoint(g,e,r),l=new u.IntersectNode,l.Edge1=g,l.Edge2=e,l.Pt.X=r.X,l.Pt.Y=r.Y,u.use_xyz&&(l.Pt.Z=r.Z),this.m_IntersectList.push(l),this.SwapPositionsInSEL(g,e),l=!0):g=e}if(null!==g.PrevInSEL)g.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null}};u.Clipper.prototype.EdgesAdjacent=function(e){return e.Edge1.NextInSEL==e.Edge2||e.Edge1.PrevInSEL==e.Edge2};u.Clipper.IntersectNodeSort=
function(e,g){return g.Pt.Y-e.Pt.Y};u.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer);this.CopyAELToSEL();for(var e=this.m_IntersectList.length,g=0;g<e;g++){if(!this.EdgesAdjacent(this.m_IntersectList[g])){for(var l=g+1;l<e&&!this.EdgesAdjacent(this.m_IntersectList[l]);)l++;if(l==e)return!1;var r=this.m_IntersectList[g];this.m_IntersectList[g]=this.m_IntersectList[l];this.m_IntersectList[l]=r}this.SwapPositionsInSEL(this.m_IntersectList[g].Edge1,
this.m_IntersectList[g].Edge2)}return!0};u.Clipper.prototype.ProcessIntersectList=function(){for(var e=0,g=this.m_IntersectList.length;e<g;e++){var l=this.m_IntersectList[e];this.IntersectEdges(l.Edge1,l.Edge2,l.Pt);this.SwapPositionsInAEL(l.Edge1,l.Edge2)}this.m_IntersectList.length=0};T=function(e){return 0>e?Math.ceil(e-.5):Math.round(e)};Ca=function(e){return 0>e?Math.ceil(e-.5):Math.floor(e+.5)};Gb=function(e){return 0>e?-Math.round(Math.abs(e)):Math.round(e)};Jb=function(e){if(0>e)return e-=
.5,-2147483648>e?Math.ceil(e):e|0;e+=.5;return 2147483647<e?Math.floor(e):e|0};u.Clipper.Round=db?T:Ua?Gb:ua?Jb:Ca;u.Clipper.TopX=function(e,g){return g==e.Top.Y?e.Top.X:e.Bot.X+u.Clipper.Round(e.Dx*(g-e.Bot.Y))};u.Clipper.prototype.IntersectPoint=function(e,g,l){l.X=0;l.Y=0;var r,x;if(e.Dx==g.Dx)l.Y=e.Curr.Y,l.X=u.Clipper.TopX(e,l.Y);else{if(0===e.Delta.X)l.X=e.Bot.X,u.ClipperBase.IsHorizontal(g)?l.Y=g.Bot.Y:(x=g.Bot.Y-g.Bot.X/g.Dx,l.Y=u.Clipper.Round(l.X/g.Dx+x));else if(0===g.Delta.X)l.X=g.Bot.X,
u.ClipperBase.IsHorizontal(e)?l.Y=e.Bot.Y:(r=e.Bot.Y-e.Bot.X/e.Dx,l.Y=u.Clipper.Round(l.X/e.Dx+r));else{r=e.Bot.X-e.Bot.Y*e.Dx;x=g.Bot.X-g.Bot.Y*g.Dx;var D=(x-r)/(e.Dx-g.Dx);l.Y=u.Clipper.Round(D);l.X=Math.abs(e.Dx)<Math.abs(g.Dx)?u.Clipper.Round(e.Dx*D+r):u.Clipper.Round(g.Dx*D+x)}if(l.Y<e.Top.Y||l.Y<g.Top.Y){if(e.Top.Y>g.Top.Y)return l.Y=e.Top.Y,l.X=u.Clipper.TopX(g,e.Top.Y),l.X<e.Top.X;l.Y=g.Top.Y;l.X=Math.abs(e.Dx)<Math.abs(g.Dx)?u.Clipper.TopX(e,l.Y):u.Clipper.TopX(g,l.Y)}l.Y>e.Curr.Y&&(l.Y=
e.Curr.Y,l.X=Math.abs(e.Dx)>Math.abs(g.Dx)?u.Clipper.TopX(g,l.Y):u.Clipper.TopX(e,l.Y))}};u.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(e){for(var g=this.m_ActiveEdges;null!==g;){var l=this.IsMaxima(g,e);l&&(l=this.GetMaximaPair(g),l=null===l||!u.ClipperBase.IsHorizontal(l));if(l){var r=g.PrevInAEL;this.DoMaxima(g);g=null===r?this.m_ActiveEdges:r.NextInAEL}else{this.IsIntermediate(g,e)&&u.ClipperBase.IsHorizontal(g.NextInLML)?(g=this.UpdateEdgeIntoAEL(g),0<=g.OutIdx&&this.AddOutPt(g,g.Bot),
this.AddEdgeToSEL(g)):(g.Curr.X=u.Clipper.TopX(g,e),g.Curr.Y=e);if(this.StrictlySimple&&(r=g.PrevInAEL,0<=g.OutIdx&&0!==g.WindDelta&&null!==r&&0<=r.OutIdx&&r.Curr.X==g.Curr.X&&0!==r.WindDelta)){var x=new u.IntPoint(g.Curr);u.use_xyz&&this.SetZ(x,r,g);l=this.AddOutPt(r,x);r=this.AddOutPt(g,x);this.AddJoin(l,r,x)}g=g.NextInAEL}}this.ProcessHorizontals(!0);for(g=this.m_ActiveEdges;null!==g;)this.IsIntermediate(g,e)&&(l=null,0<=g.OutIdx&&(l=this.AddOutPt(g,g.Top)),g=this.UpdateEdgeIntoAEL(g),r=g.PrevInAEL,
x=g.NextInAEL,null!==r&&r.Curr.X==g.Bot.X&&r.Curr.Y==g.Bot.Y&&null!==l&&0<=r.OutIdx&&r.Curr.Y>r.Top.Y&&u.ClipperBase.SlopesEqual(g,r,this.m_UseFullRange)&&0!==g.WindDelta&&0!==r.WindDelta?(r=this.AddOutPt(r,g.Bot),this.AddJoin(l,r,g.Top)):null!==x&&x.Curr.X==g.Bot.X&&x.Curr.Y==g.Bot.Y&&null!==l&&0<=x.OutIdx&&x.Curr.Y>x.Top.Y&&u.ClipperBase.SlopesEqual(g,x,this.m_UseFullRange)&&0!==g.WindDelta&&0!==x.WindDelta&&(r=this.AddOutPt(x,g.Bot),this.AddJoin(l,r,g.Top))),g=g.NextInAEL};u.Clipper.prototype.DoMaxima=
function(e){var g=this.GetMaximaPair(e);if(null===g)0<=e.OutIdx&&this.AddOutPt(e,e.Top),this.DeleteFromAEL(e);else{for(var l=e.NextInAEL;null!==l&&l!=g;)this.IntersectEdges(e,l,e.Top),this.SwapPositionsInAEL(e,l),l=e.NextInAEL;-1==e.OutIdx&&-1==g.OutIdx?(this.DeleteFromAEL(e),this.DeleteFromAEL(g)):0<=e.OutIdx&&0<=g.OutIdx?(0<=e.OutIdx&&this.AddLocalMaxPoly(e,g,e.Top),this.DeleteFromAEL(e),this.DeleteFromAEL(g)):u.use_lines&&0===e.WindDelta?(0<=e.OutIdx&&(this.AddOutPt(e,e.Top),e.OutIdx=-1),this.DeleteFromAEL(e),
0<=g.OutIdx&&(this.AddOutPt(g,e.Top),g.OutIdx=-1),this.DeleteFromAEL(g)):u.Error("DoMaxima error")}};u.Clipper.ReversePaths=function(e){for(var g=0,l=e.length;g<l;g++)e[g].reverse()};u.Clipper.Orientation=function(e){return 0<=u.Clipper.Area(e)};u.Clipper.prototype.PointCount=function(e){if(null===e)return 0;var g=0,l=e;do g++,l=l.Next;while(l!=e);return g};u.Clipper.prototype.BuildResult=function(e){u.Clear(e);for(var g=0,l=this.m_PolyOuts.length;g<l;g++){var r=this.m_PolyOuts[g];if(null!==r.Pts){r=
r.Pts.Prev;var x=this.PointCount(r);if(!(2>x)){for(var D=Array(x),I=0;I<x;I++)D[I]=r.Pt,r=r.Prev;e.push(D)}}}};u.Clipper.prototype.BuildResult2=function(e){e.Clear();for(var g=0,l=this.m_PolyOuts.length;g<l;g++){var r=this.m_PolyOuts[g],x=this.PointCount(r.Pts);if(!(r.IsOpen&&2>x||!r.IsOpen&&3>x)){this.FixHoleLinkage(r);var D=new u.PolyNode;e.m_AllPolys.push(D);r.PolyNode=D;D.m_polygon.length=x;r=r.Pts.Prev;for(var I=0;I<x;I++)D.m_polygon[I]=r.Pt,r=r.Prev}}g=0;for(l=this.m_PolyOuts.length;g<l;g++)r=
this.m_PolyOuts[g],null!==r.PolyNode&&(r.IsOpen?(r.PolyNode.IsOpen=!0,e.AddChild(r.PolyNode)):null!==r.FirstLeft&&null!=r.FirstLeft.PolyNode?r.FirstLeft.PolyNode.AddChild(r.PolyNode):e.AddChild(r.PolyNode))};u.Clipper.prototype.FixupOutPolygon=function(e){var g=null;e.BottomPt=null;for(var l=e.Pts;;){if(l.Prev==l||l.Prev==l.Next){e.Pts=null;return}if(u.IntPoint.op_Equality(l.Pt,l.Next.Pt)||u.IntPoint.op_Equality(l.Pt,l.Prev.Pt)||u.ClipperBase.SlopesEqual(l.Prev.Pt,l.Pt,l.Next.Pt,this.m_UseFullRange)&&
(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(l.Prev.Pt,l.Pt,l.Next.Pt)))g=null,l.Prev.Next=l.Next,l=l.Next.Prev=l.Prev;else if(l==g)break;else null===g&&(g=l),l=l.Next}e.Pts=l};u.Clipper.prototype.DupOutPt=function(e,g){var l=new u.OutPt;l.Pt.X=e.Pt.X;l.Pt.Y=e.Pt.Y;u.use_xyz&&(l.Pt.Z=e.Pt.Z);l.Idx=e.Idx;g?(l.Next=e.Next,l.Prev=e,e.Next.Prev=l,e.Next=l):(l.Prev=e.Prev,l.Next=e,e.Prev.Next=l,e.Prev=l);return l};u.Clipper.prototype.GetOverlap=function(e,g,l,r,x){e<g?l<r?(x.Left=Math.max(e,l),
x.Right=Math.min(g,r)):(x.Left=Math.max(e,r),x.Right=Math.min(g,l)):l<r?(x.Left=Math.max(g,l),x.Right=Math.min(e,r)):(x.Left=Math.max(g,r),x.Right=Math.min(e,l));return x.Left<x.Right};u.Clipper.prototype.JoinHorz=function(e,g,l,r,x,D){var I=e.Pt.X>g.Pt.X?u.Direction.dRightToLeft:u.Direction.dLeftToRight;r=l.Pt.X>r.Pt.X?u.Direction.dRightToLeft:u.Direction.dLeftToRight;if(I==r)return!1;if(I==u.Direction.dLeftToRight){for(;e.Next.Pt.X<=x.X&&e.Next.Pt.X>=e.Pt.X&&e.Next.Pt.Y==x.Y;)e=e.Next;D&&e.Pt.X!=
x.X&&(e=e.Next);g=this.DupOutPt(e,!D);u.IntPoint.op_Inequality(g.Pt,x)&&(e=g,e.Pt.X=x.X,e.Pt.Y=x.Y,u.use_xyz&&(e.Pt.Z=x.Z),g=this.DupOutPt(e,!D))}else{for(;e.Next.Pt.X>=x.X&&e.Next.Pt.X<=e.Pt.X&&e.Next.Pt.Y==x.Y;)e=e.Next;D||e.Pt.X==x.X||(e=e.Next);g=this.DupOutPt(e,D);u.IntPoint.op_Inequality(g.Pt,x)&&(e=g,e.Pt.X=x.X,e.Pt.Y=x.Y,u.use_xyz&&(e.Pt.Z=x.Z),g=this.DupOutPt(e,D))}if(r==u.Direction.dLeftToRight){for(;l.Next.Pt.X<=x.X&&l.Next.Pt.X>=l.Pt.X&&l.Next.Pt.Y==x.Y;)l=l.Next;D&&l.Pt.X!=x.X&&(l=l.Next);
r=this.DupOutPt(l,!D);u.IntPoint.op_Inequality(r.Pt,x)&&(l=r,l.Pt.X=x.X,l.Pt.Y=x.Y,u.use_xyz&&(l.Pt.Z=x.Z),r=this.DupOutPt(l,!D))}else{for(;l.Next.Pt.X>=x.X&&l.Next.Pt.X<=l.Pt.X&&l.Next.Pt.Y==x.Y;)l=l.Next;D||l.Pt.X==x.X||(l=l.Next);r=this.DupOutPt(l,D);u.IntPoint.op_Inequality(r.Pt,x)&&(l=r,l.Pt.X=x.X,l.Pt.Y=x.Y,u.use_xyz&&(l.Pt.Z=x.Z),r=this.DupOutPt(l,D))}I==u.Direction.dLeftToRight==D?(e.Prev=l,l.Next=e,g.Next=r,r.Prev=g):(e.Next=l,l.Prev=e,g.Prev=r,r.Next=g);return!0};u.Clipper.prototype.JoinPoints=
function(e,g,l){var r=e.OutPt1,x;new u.OutPt;var D=e.OutPt2,I;new u.OutPt;if((I=e.OutPt1.Pt.Y==e.OffPt.Y)&&u.IntPoint.op_Equality(e.OffPt,e.OutPt1.Pt)&&u.IntPoint.op_Equality(e.OffPt,e.OutPt2.Pt)){if(g!=l)return!1;for(x=e.OutPt1.Next;x!=r&&u.IntPoint.op_Equality(x.Pt,e.OffPt);)x=x.Next;x=x.Pt.Y>e.OffPt.Y;for(I=e.OutPt2.Next;I!=D&&u.IntPoint.op_Equality(I.Pt,e.OffPt);)I=I.Next;if(x==I.Pt.Y>e.OffPt.Y)return!1;x?(x=this.DupOutPt(r,!1),I=this.DupOutPt(D,!0),r.Prev=D,D.Next=r,x.Next=I,I.Prev=x):(x=this.DupOutPt(r,
!0),I=this.DupOutPt(D,!1),r.Next=D,D.Prev=r,x.Prev=I,I.Next=x);e.OutPt1=r;e.OutPt2=x;return!0}if(I){for(x=r;r.Prev.Pt.Y==r.Pt.Y&&r.Prev!=x&&r.Prev!=D;)r=r.Prev;for(;x.Next.Pt.Y==x.Pt.Y&&x.Next!=r&&x.Next!=D;)x=x.Next;if(x.Next==r||x.Next==D)return!1;for(I=D;D.Prev.Pt.Y==D.Pt.Y&&D.Prev!=I&&D.Prev!=x;)D=D.Prev;for(;I.Next.Pt.Y==I.Pt.Y&&I.Next!=D&&I.Next!=r;)I=I.Next;if(I.Next==D||I.Next==r)return!1;l={Left:null,Right:null};if(!this.GetOverlap(r.Pt.X,x.Pt.X,D.Pt.X,I.Pt.X,l))return!1;g=l.Left;var X=l.Right;
l=new u.IntPoint;r.Pt.X>=g&&r.Pt.X<=X?(l.X=r.Pt.X,l.Y=r.Pt.Y,u.use_xyz&&(l.Z=r.Pt.Z),g=r.Pt.X>x.Pt.X):D.Pt.X>=g&&D.Pt.X<=X?(l.X=D.Pt.X,l.Y=D.Pt.Y,u.use_xyz&&(l.Z=D.Pt.Z),g=D.Pt.X>I.Pt.X):x.Pt.X>=g&&x.Pt.X<=X?(l.X=x.Pt.X,l.Y=x.Pt.Y,u.use_xyz&&(l.Z=x.Pt.Z),g=x.Pt.X>r.Pt.X):(l.X=I.Pt.X,l.Y=I.Pt.Y,u.use_xyz&&(l.Z=I.Pt.Z),g=I.Pt.X>D.Pt.X);e.OutPt1=r;e.OutPt2=D;return this.JoinHorz(r,x,D,I,l,g)}for(x=r.Next;u.IntPoint.op_Equality(x.Pt,r.Pt)&&x!=r;)x=x.Next;if(X=x.Pt.Y>r.Pt.Y||!u.ClipperBase.SlopesEqual(r.Pt,
x.Pt,e.OffPt,this.m_UseFullRange)){for(x=r.Prev;u.IntPoint.op_Equality(x.Pt,r.Pt)&&x!=r;)x=x.Prev;if(x.Pt.Y>r.Pt.Y||!u.ClipperBase.SlopesEqual(r.Pt,x.Pt,e.OffPt,this.m_UseFullRange))return!1}for(I=D.Next;u.IntPoint.op_Equality(I.Pt,D.Pt)&&I!=D;)I=I.Next;var ea=I.Pt.Y>D.Pt.Y||!u.ClipperBase.SlopesEqual(D.Pt,I.Pt,e.OffPt,this.m_UseFullRange);if(ea){for(I=D.Prev;u.IntPoint.op_Equality(I.Pt,D.Pt)&&I!=D;)I=I.Prev;if(I.Pt.Y>D.Pt.Y||!u.ClipperBase.SlopesEqual(D.Pt,I.Pt,e.OffPt,this.m_UseFullRange))return!1}if(x==
r||I==D||x==I||g==l&&X==ea)return!1;X?(x=this.DupOutPt(r,!1),I=this.DupOutPt(D,!0),r.Prev=D,D.Next=r,x.Next=I,I.Prev=x):(x=this.DupOutPt(r,!0),I=this.DupOutPt(D,!1),r.Next=D,D.Prev=r,x.Prev=I,I.Next=x);e.OutPt1=r;e.OutPt2=x;return!0};u.Clipper.GetBounds=function(e){for(var g=0,l=e.length;g<l&&0==e[g].length;)g++;if(g==l)return new u.IntRect(0,0,0,0);var r=new u.IntRect;r.left=e[g][0].X;r.right=r.left;r.top=e[g][0].Y;for(r.bottom=r.top;g<l;g++)for(var x=0,D=e[g].length;x<D;x++)e[g][x].X<r.left?r.left=
e[g][x].X:e[g][x].X>r.right&&(r.right=e[g][x].X),e[g][x].Y<r.top?r.top=e[g][x].Y:e[g][x].Y>r.bottom&&(r.bottom=e[g][x].Y);return r};u.Clipper.prototype.GetBounds2=function(e){var g=e,l=new u.IntRect;l.left=e.Pt.X;l.right=e.Pt.X;l.top=e.Pt.Y;l.bottom=e.Pt.Y;for(e=e.Next;e!=g;)e.Pt.X<l.left&&(l.left=e.Pt.X),e.Pt.X>l.right&&(l.right=e.Pt.X),e.Pt.Y<l.top&&(l.top=e.Pt.Y),e.Pt.Y>l.bottom&&(l.bottom=e.Pt.Y),e=e.Next;return l};u.Clipper.PointInPolygon=function(e,g){var l=0,r=g.length;if(3>r)return 0;for(var x=
g[0],D=1;D<=r;++D){var I=D==r?g[0]:g[D];if(I.Y==e.Y&&(I.X==e.X||x.Y==e.Y&&I.X>e.X==x.X<e.X))return-1;if(x.Y<e.Y!=I.Y<e.Y)if(x.X>=e.X)if(I.X>e.X)l=1-l;else{var X=(x.X-e.X)*(I.Y-e.Y)-(I.X-e.X)*(x.Y-e.Y);if(0==X)return-1;0<X==I.Y>x.Y&&(l=1-l)}else if(I.X>e.X){X=(x.X-e.X)*(I.Y-e.Y)-(I.X-e.X)*(x.Y-e.Y);if(0==X)return-1;0<X==I.Y>x.Y&&(l=1-l)}x=I}return l};u.Clipper.prototype.PointInPolygon=function(e,g){var l=0,r=g,x=e.X;e=e.Y;var D=g.Pt.X,I=g.Pt.Y;do{g=g.Next;var X=g.Pt.X,ea=g.Pt.Y;if(ea==e&&(X==x||I==
e&&X>x==D<x))return-1;if(I<e!=ea<e)if(D>=x)if(X>x)l=1-l;else{D=(D-x)*(ea-e)-(X-x)*(I-e);if(0==D)return-1;0<D==ea>I&&(l=1-l)}else if(X>x){D=(D-x)*(ea-e)-(X-x)*(I-e);if(0==D)return-1;0<D==ea>I&&(l=1-l)}D=X;I=ea}while(r!=g);return l};u.Clipper.prototype.Poly2ContainsPoly1=function(e,g){var l=e;do{var r=this.PointInPolygon(l.Pt,g);if(0<=r)return 0<r;l=l.Next}while(l!=e);return!0};u.Clipper.prototype.FixupFirstLefts1=function(e,g){for(var l=0,r=this.m_PolyOuts.length;l<r;l++){var x=this.m_PolyOuts[l];
null!=x.Pts&&null!=x.FirstLeft&&this.ParseFirstLeft(x.FirstLeft)==e&&this.Poly2ContainsPoly1(x.Pts,g.Pts)&&(x.FirstLeft=g)}};u.Clipper.prototype.FixupFirstLefts2=function(e,g){for(var l=0,r=this.m_PolyOuts,x=r.length,D=r[l];l<x;l++,D=r[l])D.FirstLeft==e&&(D.FirstLeft=g)};u.Clipper.ParseFirstLeft=function(e){for(;null!=e&&null==e.Pts;)e=e.FirstLeft;return e};u.Clipper.prototype.JoinCommonEdges=function(){for(var e=0,g=this.m_Joins.length;e<g;e++){var l=this.m_Joins[e],r=this.GetOutRec(l.OutPt1.Idx),
x=this.GetOutRec(l.OutPt2.Idx);if(null!=r.Pts&&null!=x.Pts){var D=r==x?r:this.Param1RightOfParam2(r,x)?x:this.Param1RightOfParam2(x,r)?r:this.GetLowermostRec(r,x);if(this.JoinPoints(l,r,x))if(r==x){r.Pts=l.OutPt1;r.BottomPt=null;x=this.CreateOutRec();x.Pts=l.OutPt2;this.UpdateOutPtIdxs(x);if(this.m_UsingPolyTree){D=0;for(var I=this.m_PolyOuts.length;D<I-1;D++){var X=this.m_PolyOuts[D];null!=X.Pts&&u.Clipper.ParseFirstLeft(X.FirstLeft)==r&&X.IsHole!=r.IsHole&&this.Poly2ContainsPoly1(X.Pts,l.OutPt2)&&
(X.FirstLeft=x)}}this.Poly2ContainsPoly1(x.Pts,r.Pts)?(x.IsHole=!r.IsHole,x.FirstLeft=r,this.m_UsingPolyTree&&this.FixupFirstLefts2(x,r),(x.IsHole^this.ReverseSolution)==0<this.Area(x)&&this.ReversePolyPtLinks(x.Pts)):this.Poly2ContainsPoly1(r.Pts,x.Pts)?(x.IsHole=r.IsHole,r.IsHole=!x.IsHole,x.FirstLeft=r.FirstLeft,r.FirstLeft=x,this.m_UsingPolyTree&&this.FixupFirstLefts2(r,x),(r.IsHole^this.ReverseSolution)==0<this.Area(r)&&this.ReversePolyPtLinks(r.Pts)):(x.IsHole=r.IsHole,x.FirstLeft=r.FirstLeft,
this.m_UsingPolyTree&&this.FixupFirstLefts1(r,x))}else x.Pts=null,x.BottomPt=null,x.Idx=r.Idx,r.IsHole=D.IsHole,D==x&&(r.FirstLeft=x.FirstLeft),x.FirstLeft=r,this.m_UsingPolyTree&&this.FixupFirstLefts2(x,r)}}};u.Clipper.prototype.UpdateOutPtIdxs=function(e){var g=e.Pts;do g.Idx=e.Idx,g=g.Prev;while(g!=e.Pts)};u.Clipper.prototype.DoSimplePolygons=function(){for(var e=0;e<this.m_PolyOuts.length;){var g=this.m_PolyOuts[e++],l=g.Pts;if(null!=l&&!g.IsOpen){do{for(var r=l.Next;r!=g.Pts;){if(u.IntPoint.op_Equality(l.Pt,
r.Pt)&&r.Next!=l&&r.Prev!=l){var x=l.Prev,D=r.Prev;l.Prev=D;D.Next=l;r.Prev=x;x.Next=r;g.Pts=l;x=this.CreateOutRec();x.Pts=r;this.UpdateOutPtIdxs(x);this.Poly2ContainsPoly1(x.Pts,g.Pts)?(x.IsHole=!g.IsHole,x.FirstLeft=g,this.m_UsingPolyTree&&this.FixupFirstLefts2(x,g)):this.Poly2ContainsPoly1(g.Pts,x.Pts)?(x.IsHole=g.IsHole,g.IsHole=!x.IsHole,x.FirstLeft=g.FirstLeft,g.FirstLeft=x,this.m_UsingPolyTree&&this.FixupFirstLefts2(g,x)):(x.IsHole=g.IsHole,x.FirstLeft=g.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(g,
x));r=l}r=r.Next}l=l.Next}while(l!=g.Pts)}}};u.Clipper.Area=function(e){var g=e.length;if(3>g)return 0;for(var l=0,r=0,x=g-1;r<g;++r)l+=(e[x].X+e[r].X)*(e[x].Y-e[r].Y),x=r;return.5*-l};u.Clipper.prototype.Area=function(e){var g=e.Pts;if(null==g)return 0;var l=0;do l+=(g.Prev.Pt.X+g.Pt.X)*(g.Prev.Pt.Y-g.Pt.Y),g=g.Next;while(g!=e.Pts);return.5*l};u.Clipper.SimplifyPolygon=function(e,g){var l=[],r=new u.Clipper(0);r.StrictlySimple=!0;r.AddPath(e,u.PolyType.ptSubject,!0);r.Execute(u.ClipType.ctUnion,
l,g,g);return l};u.Clipper.SimplifyPolygons=function(e,g){"undefined"==typeof g&&(g=u.PolyFillType.pftEvenOdd);var l=[],r=new u.Clipper(0);r.StrictlySimple=!0;r.AddPaths(e,u.PolyType.ptSubject,!0);r.Execute(u.ClipType.ctUnion,l,g,g);return l};u.Clipper.DistanceSqrd=function(e,g){var l=e.X-g.X;e=e.Y-g.Y;return l*l+e*e};u.Clipper.DistanceFromLineSqrd=function(e,g,l){var r=g.Y-l.Y;l=l.X-g.X;g=r*g.X+l*g.Y;g=r*e.X+l*e.Y-g;return g*g/(r*r+l*l)};u.Clipper.SlopesNearCollinear=function(e,g,l,r){return Math.abs(e.X-
g.X)>Math.abs(e.Y-g.Y)?e.X>g.X==e.X<l.X?u.Clipper.DistanceFromLineSqrd(e,g,l)<r:g.X>e.X==g.X<l.X?u.Clipper.DistanceFromLineSqrd(g,e,l)<r:u.Clipper.DistanceFromLineSqrd(l,e,g)<r:e.Y>g.Y==e.Y<l.Y?u.Clipper.DistanceFromLineSqrd(e,g,l)<r:g.Y>e.Y==g.Y<l.Y?u.Clipper.DistanceFromLineSqrd(g,e,l)<r:u.Clipper.DistanceFromLineSqrd(l,e,g)<r};u.Clipper.PointsAreClose=function(e,g,l){var r=e.X-g.X;e=e.Y-g.Y;return r*r+e*e<=l};u.Clipper.ExcludeOp=function(e){var g=e.Prev;g.Next=e.Next;e.Next.Prev=g;g.Idx=0;return g};
u.Clipper.CleanPolygon=function(e,g){"undefined"==typeof g&&(g=1.415);var l=e.length;if(0==l)return[];for(var r=Array(l),x=0;x<l;++x)r[x]=new u.OutPt;for(x=0;x<l;++x)r[x].Pt=e[x],r[x].Next=r[(x+1)%l],r[x].Next.Prev=r[x],r[x].Idx=0;x=g*g;for(r=r[0];0==r.Idx&&r.Next!=r.Prev;)u.Clipper.PointsAreClose(r.Pt,r.Prev.Pt,x)?(r=u.Clipper.ExcludeOp(r),l--):u.Clipper.PointsAreClose(r.Prev.Pt,r.Next.Pt,x)?(u.Clipper.ExcludeOp(r.Next),r=u.Clipper.ExcludeOp(r),l-=2):u.Clipper.SlopesNearCollinear(r.Prev.Pt,r.Pt,
r.Next.Pt,x)?(r=u.Clipper.ExcludeOp(r),l--):(r.Idx=1,r=r.Next);3>l&&(l=0);e=Array(l);for(x=0;x<l;++x)e[x]=new u.IntPoint(r.Pt),r=r.Next;return e};u.Clipper.CleanPolygons=function(e,g){for(var l=Array(e.length),r=0,x=e.length;r<x;r++)l[r]=u.Clipper.CleanPolygon(e[r],g);return l};u.Clipper.Minkowski=function(e,g,l,r){r=r?1:0;var x=e.length,D=g.length,I=[];if(l)for(l=0;l<D;l++){for(var X=Array(x),ea=0,ha=e.length,Fa=e[ea];ea<ha;ea++,Fa=e[ea])X[ea]=new u.IntPoint(g[l].X+Fa.X,g[l].Y+Fa.Y);I.push(X)}else for(l=
0;l<D;l++){X=Array(x);ea=0;ha=e.length;for(Fa=e[ea];ea<ha;ea++,Fa=e[ea])X[ea]=new u.IntPoint(g[l].X-Fa.X,g[l].Y-Fa.Y);I.push(X)}e=[];for(l=0;l<D-1+r;l++)for(ea=0;ea<x;ea++)g=[],g.push(I[l%D][ea%x]),g.push(I[(l+1)%D][ea%x]),g.push(I[(l+1)%D][(ea+1)%x]),g.push(I[l%D][(ea+1)%x]),u.Clipper.Orientation(g)||g.reverse(),e.push(g);return e};u.Clipper.MinkowskiSum=function(e,g,l){if(g[0]instanceof Array){I=g;g=new u.Paths;for(var r=new u.Clipper,x=0;x<I.length;++x){var D=u.Clipper.Minkowski(e,I[x],!0,l);r.AddPaths(D,
u.PolyType.ptSubject,!0);l&&(D=u.Clipper.TranslatePath(I[x],e[0]),r.AddPath(D,u.PolyType.ptClip,!0))}r.Execute(u.ClipType.ctUnion,g,u.PolyFillType.pftNonZero,u.PolyFillType.pftNonZero);return g}var I=u.Clipper.Minkowski(e,g,!0,l);r=new u.Clipper;r.AddPaths(I,u.PolyType.ptSubject,!0);r.Execute(u.ClipType.ctUnion,I,u.PolyFillType.pftNonZero,u.PolyFillType.pftNonZero);return I};u.Clipper.TranslatePath=function(e,g){for(var l=new u.Path,r=0;r<e.length;r++)l.push(new u.IntPoint(e[r].X+g.X,e[r].Y+g.Y));
return l};u.Clipper.MinkowskiDiff=function(e,g){e=u.Clipper.Minkowski(e,g,!1,!0);g=new u.Clipper;g.AddPaths(e,u.PolyType.ptSubject,!0);g.Execute(u.ClipType.ctUnion,e,u.PolyFillType.pftNonZero,u.PolyFillType.pftNonZero);return e};u.Clipper.PolyTreeToPaths=function(e){var g=[];u.Clipper.AddPolyNodeToPaths(e,u.Clipper.NodeType.ntAny,g);return g};u.Clipper.AddPolyNodeToPaths=function(e,g,l){var r=!0;switch(g){case u.Clipper.NodeType.ntOpen:return;case u.Clipper.NodeType.ntClosed:r=!e.IsOpen}0<e.m_polygon.length&&
r&&l.push(e.m_polygon);r=0;e=e.Childs();for(var x=e.length,D=e[r];r<x;r++,D=e[r])u.Clipper.AddPolyNodeToPaths(D,g,l)};u.Clipper.OpenPathsFromPolyTree=function(e){for(var g=new u.Paths,l=0,r=e.ChildCount();l<r;l++)e.Childs()[l].IsOpen&&g.push(e.Childs()[l].m_polygon);return g};u.Clipper.ClosedPathsFromPolyTree=function(e){var g=new u.Paths;u.Clipper.AddPolyNodeToPaths(e,u.Clipper.NodeType.ntClosed,g);return g};Ya(u.Clipper,u.ClipperBase);u.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2};u.ClipperOffset=
function(e,g){"undefined"==typeof e&&(e=2);"undefined"==typeof g&&(g=u.ClipperOffset.def_arc_tolerance);this.m_destPolys=new u.Paths;this.m_srcPoly=new u.Path;this.m_destPoly=new u.Path;this.m_normals=[];this.m_StepsPerRad=this.m_miterLim=this.m_cos=this.m_sin=this.m_sinA=this.m_delta=0;this.m_lowest=new u.IntPoint;this.m_polyNodes=new u.PolyNode;this.MiterLimit=e;this.ArcTolerance=g;this.m_lowest.X=-1};u.ClipperOffset.two_pi=6.28318530717959;u.ClipperOffset.def_arc_tolerance=.25;u.ClipperOffset.prototype.Clear=
function(){u.Clear(this.m_polyNodes.Childs());this.m_lowest.X=-1};u.ClipperOffset.Round=u.Clipper.Round;u.ClipperOffset.prototype.AddPath=function(e,g,l){var r=e.length-1;if(!(0>r)){var x=new u.PolyNode;x.m_jointype=g;x.m_endtype=l;if(l==u.EndType.etClosedLine||l==u.EndType.etClosedPolygon)for(;0<r&&u.IntPoint.op_Equality(e[0],e[r]);)r--;x.m_polygon.push(e[0]);var D=0;g=0;for(var I=1;I<=r;I++)u.IntPoint.op_Inequality(x.m_polygon[D],e[I])&&(D++,x.m_polygon.push(e[I]),e[I].Y>x.m_polygon[g].Y||e[I].Y==
x.m_polygon[g].Y&&e[I].X<x.m_polygon[g].X)&&(g=D);if(!(l==u.EndType.etClosedPolygon&&2>D)&&(this.m_polyNodes.AddChild(x),l==u.EndType.etClosedPolygon))if(0>this.m_lowest.X)this.m_lowest=new u.IntPoint(this.m_polyNodes.ChildCount()-1,g);else if(e=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y],x.m_polygon[g].Y>e.Y||x.m_polygon[g].Y==e.Y&&x.m_polygon[g].X<e.X)this.m_lowest=new u.IntPoint(this.m_polyNodes.ChildCount()-1,g)}};u.ClipperOffset.prototype.AddPaths=function(e,g,l){for(var r=
0,x=e.length;r<x;r++)this.AddPath(e[r],g,l)};u.ClipperOffset.prototype.FixOrientations=function(){if(0<=this.m_lowest.X&&!u.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var e=0;e<this.m_polyNodes.ChildCount();e++){var g=this.m_polyNodes.Childs()[e];(g.m_endtype==u.EndType.etClosedPolygon||g.m_endtype==u.EndType.etClosedLine&&u.Clipper.Orientation(g.m_polygon))&&g.m_polygon.reverse()}else for(e=0;e<this.m_polyNodes.ChildCount();e++)g=this.m_polyNodes.Childs()[e],g.m_endtype!=
u.EndType.etClosedLine||u.Clipper.Orientation(g.m_polygon)||g.m_polygon.reverse()};u.ClipperOffset.GetUnitNormal=function(e,g){var l=g.X-e.X;e=g.Y-e.Y;if(0==l&&0==e)return new u.DoublePoint(0,0);g=1/Math.sqrt(l*l+e*e);return new u.DoublePoint(e*g,-(l*g))};u.ClipperOffset.prototype.DoOffset=function(e){this.m_destPolys=[];this.m_delta=e;if(u.ClipperBase.near_zero(e))for(var g=0;g<this.m_polyNodes.ChildCount();g++){var l=this.m_polyNodes.Childs()[g];l.m_endtype==u.EndType.etClosedPolygon&&this.m_destPolys.push(l.m_polygon)}else{this.m_miterLim=
2<this.MiterLimit?2/(this.MiterLimit*this.MiterLimit):.5;var r=3.14159265358979/Math.acos(1-(0>=this.ArcTolerance?u.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(e)*u.ClipperOffset.def_arc_tolerance?Math.abs(e)*u.ClipperOffset.def_arc_tolerance:this.ArcTolerance)/Math.abs(e));this.m_sin=Math.sin(u.ClipperOffset.two_pi/r);this.m_cos=Math.cos(u.ClipperOffset.two_pi/r);this.m_StepsPerRad=r/u.ClipperOffset.two_pi;0>e&&(this.m_sin=-this.m_sin);for(g=0;g<this.m_polyNodes.ChildCount();g++){l=
this.m_polyNodes.Childs()[g];this.m_srcPoly=l.m_polygon;var x=this.m_srcPoly.length;if(!(0==x||0>=e&&(3>x||l.m_endtype!=u.EndType.etClosedPolygon))){this.m_destPoly=[];if(1==x)if(l.m_jointype==u.JoinType.jtRound){l=1;x=0;for(var D=1;D<=r;D++){this.m_destPoly.push(new u.IntPoint(u.ClipperOffset.Round(this.m_srcPoly[0].X+l*e),u.ClipperOffset.Round(this.m_srcPoly[0].Y+x*e)));var I=l;l=l*this.m_cos-this.m_sin*x;x=I*this.m_sin+x*this.m_cos}}else for(x=l=-1,D=0;4>D;++D)this.m_destPoly.push(new u.IntPoint(u.ClipperOffset.Round(this.m_srcPoly[0].X+
l*e),u.ClipperOffset.Round(this.m_srcPoly[0].Y+x*e))),0>l?l=1:0>x?x=1:l=-1;else{for(D=this.m_normals.length=0;D<x-1;D++)this.m_normals.push(u.ClipperOffset.GetUnitNormal(this.m_srcPoly[D],this.m_srcPoly[D+1]));l.m_endtype==u.EndType.etClosedLine||l.m_endtype==u.EndType.etClosedPolygon?this.m_normals.push(u.ClipperOffset.GetUnitNormal(this.m_srcPoly[x-1],this.m_srcPoly[0])):this.m_normals.push(new u.DoublePoint(this.m_normals[x-2]));if(l.m_endtype==u.EndType.etClosedPolygon)for(I=x-1,D=0;D<x;D++)I=
this.OffsetPoint(D,I,l.m_jointype);else if(l.m_endtype==u.EndType.etClosedLine){I=x-1;for(D=0;D<x;D++)I=this.OffsetPoint(D,I,l.m_jointype);this.m_destPolys.push(this.m_destPoly);this.m_destPoly=[];I=this.m_normals[x-1];for(D=x-1;0<D;D--)this.m_normals[D]=new u.DoublePoint(-this.m_normals[D-1].X,-this.m_normals[D-1].Y);this.m_normals[0]=new u.DoublePoint(-I.X,-I.Y);I=0;for(D=x-1;0<=D;D--)I=this.OffsetPoint(D,I,l.m_jointype)}else{I=0;for(D=1;D<x-1;++D)I=this.OffsetPoint(D,I,l.m_jointype);l.m_endtype==
u.EndType.etOpenButt?(D=x-1,I=new u.IntPoint(u.ClipperOffset.Round(this.m_srcPoly[D].X+this.m_normals[D].X*e),u.ClipperOffset.Round(this.m_srcPoly[D].Y+this.m_normals[D].Y*e)),this.m_destPoly.push(I),I=new u.IntPoint(u.ClipperOffset.Round(this.m_srcPoly[D].X-this.m_normals[D].X*e),u.ClipperOffset.Round(this.m_srcPoly[D].Y-this.m_normals[D].Y*e)),this.m_destPoly.push(I)):(D=x-1,I=x-2,this.m_sinA=0,this.m_normals[D]=new u.DoublePoint(-this.m_normals[D].X,-this.m_normals[D].Y),l.m_endtype==u.EndType.etOpenSquare?
this.DoSquare(D,I):this.DoRound(D,I));for(D=x-1;0<D;D--)this.m_normals[D]=new u.DoublePoint(-this.m_normals[D-1].X,-this.m_normals[D-1].Y);this.m_normals[0]=new u.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y);I=x-1;for(D=I-1;0<D;--D)I=this.OffsetPoint(D,I,l.m_jointype);l.m_endtype==u.EndType.etOpenButt?(I=new u.IntPoint(u.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*e),u.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*e)),this.m_destPoly.push(I),I=new u.IntPoint(u.ClipperOffset.Round(this.m_srcPoly[0].X+
this.m_normals[0].X*e),u.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*e)),this.m_destPoly.push(I)):(this.m_sinA=0,l.m_endtype==u.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1))}}this.m_destPolys.push(this.m_destPoly)}}}};u.ClipperOffset.prototype.Execute=function(){var e=arguments;if(e[0]instanceof u.PolyTree)if(g=e[0],l=e[1],g.Clear(),this.FixOrientations(),this.DoOffset(l),e=new u.Clipper(0),e.AddPaths(this.m_destPolys,u.PolyType.ptSubject,!0),0<l)e.Execute(u.ClipType.ctUnion,
g,u.PolyFillType.pftPositive,u.PolyFillType.pftPositive);else if(l=u.Clipper.GetBounds(this.m_destPolys),r=new u.Path,r.push(new u.IntPoint(l.left-10,l.bottom+10)),r.push(new u.IntPoint(l.right+10,l.bottom+10)),r.push(new u.IntPoint(l.right+10,l.top-10)),r.push(new u.IntPoint(l.left-10,l.top-10)),e.AddPath(r,u.PolyType.ptSubject,!0),e.ReverseSolution=!0,e.Execute(u.ClipType.ctUnion,g,u.PolyFillType.pftNegative,u.PolyFillType.pftNegative),1==g.ChildCount()&&0<g.Childs()[0].ChildCount())for(e=g.Childs()[0],
g.Childs()[0]=e.Childs()[0],g.Childs()[0].m_Parent=g,l=1;l<e.ChildCount();l++)g.AddChild(e.Childs()[l]);else g.Clear();else{var g=e[0],l=e[1];u.Clear(g);this.FixOrientations();this.DoOffset(l);e=new u.Clipper(0);e.AddPaths(this.m_destPolys,u.PolyType.ptSubject,!0);if(0<l)e.Execute(u.ClipType.ctUnion,g,u.PolyFillType.pftPositive,u.PolyFillType.pftPositive);else{l=u.Clipper.GetBounds(this.m_destPolys);var r=new u.Path;r.push(new u.IntPoint(l.left-10,l.bottom+10));r.push(new u.IntPoint(l.right+10,l.bottom+
10));r.push(new u.IntPoint(l.right+10,l.top-10));r.push(new u.IntPoint(l.left-10,l.top-10));e.AddPath(r,u.PolyType.ptSubject,!0);e.ReverseSolution=!0;e.Execute(u.ClipType.ctUnion,g,u.PolyFillType.pftNegative,u.PolyFillType.pftNegative);0<g.length&&g.splice(0,1)}}};u.ClipperOffset.prototype.OffsetPoint=function(e,g,l){this.m_sinA=this.m_normals[g].X*this.m_normals[e].Y-this.m_normals[e].X*this.m_normals[g].Y;if(1>Math.abs(this.m_sinA*this.m_delta)){if(0<this.m_normals[g].X*this.m_normals[e].X+this.m_normals[e].Y*
this.m_normals[g].Y)return this.m_destPoly.push(new u.IntPoint(u.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[g].X*this.m_delta),u.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[g].Y*this.m_delta))),g}else 1<this.m_sinA?this.m_sinA=1:-1>this.m_sinA&&(this.m_sinA=-1);if(0>this.m_sinA*this.m_delta)this.m_destPoly.push(new u.IntPoint(u.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[g].X*this.m_delta),u.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[g].Y*this.m_delta))),
this.m_destPoly.push(new u.IntPoint(this.m_srcPoly[e])),this.m_destPoly.push(new u.IntPoint(u.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[e].X*this.m_delta),u.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[e].Y*this.m_delta)));else switch(l){case u.JoinType.jtMiter:l=1+(this.m_normals[e].X*this.m_normals[g].X+this.m_normals[e].Y*this.m_normals[g].Y);l>=this.m_miterLim?this.DoMiter(e,g,l):this.DoSquare(e,g);break;case u.JoinType.jtSquare:this.DoSquare(e,g);break;case u.JoinType.jtRound:this.DoRound(e,
g)}return e};u.ClipperOffset.prototype.DoSquare=function(e,g){var l=Math.tan(Math.atan2(this.m_sinA,this.m_normals[g].X*this.m_normals[e].X+this.m_normals[g].Y*this.m_normals[e].Y)/4);this.m_destPoly.push(new u.IntPoint(u.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_delta*(this.m_normals[g].X-this.m_normals[g].Y*l)),u.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_delta*(this.m_normals[g].Y+this.m_normals[g].X*l))));this.m_destPoly.push(new u.IntPoint(u.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_delta*
(this.m_normals[e].X+this.m_normals[e].Y*l)),u.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_delta*(this.m_normals[e].Y-this.m_normals[e].X*l))))};u.ClipperOffset.prototype.DoMiter=function(e,g,l){l=this.m_delta/l;this.m_destPoly.push(new u.IntPoint(u.ClipperOffset.Round(this.m_srcPoly[e].X+(this.m_normals[g].X+this.m_normals[e].X)*l),u.ClipperOffset.Round(this.m_srcPoly[e].Y+(this.m_normals[g].Y+this.m_normals[e].Y)*l)))};u.ClipperOffset.prototype.DoRound=function(e,g){var l=Math.max(u.Cast_Int32(u.ClipperOffset.Round(this.m_StepsPerRad*
Math.abs(Math.atan2(this.m_sinA,this.m_normals[g].X*this.m_normals[e].X+this.m_normals[g].Y*this.m_normals[e].Y)))),1),r=this.m_normals[g].X;g=this.m_normals[g].Y;for(var x,D=0;D<l;++D)this.m_destPoly.push(new u.IntPoint(u.ClipperOffset.Round(this.m_srcPoly[e].X+r*this.m_delta),u.ClipperOffset.Round(this.m_srcPoly[e].Y+g*this.m_delta))),x=r,r=r*this.m_cos-this.m_sin*g,g=x*this.m_sin+g*this.m_cos;this.m_destPoly.push(new u.IntPoint(u.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[e].X*this.m_delta),
u.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[e].Y*this.m_delta)))};u.Error=function(e){try{throw Error(e);}catch(g){alert(g.message)}};u.JS={};u.JS.AreaOfPolygon=function(e,g){g||(g=1);return u.Clipper.Area(e)/(g*g)};u.JS.AreaOfPolygons=function(e,g){g||(g=1);for(var l=0,r=0;r<e.length;r++)l+=u.Clipper.Area(e[r]);return l/(g*g)};u.JS.BoundsOfPath=function(e,g){return u.JS.BoundsOfPaths([e],g)};u.JS.BoundsOfPaths=function(e,g){g||(g=1);e=u.Clipper.GetBounds(e);e.left/=g;e.bottom/=g;e.right/=
g;e.top/=g;return e};u.JS.Clean=function(e,g){if(!(e instanceof Array))return[];var l=e[0]instanceof Array;e=u.JS.Clone(e);if("number"!=typeof g||null===g)return u.Error("Delta is not a number in Clean()."),e;if(0===e.length||1==e.length&&0===e[0].length||0>g)return e;l||(e=[e]);for(var r=e.length,x,D,I,X,ea,ha,Fa,Xa=[],ja=0;ja<r;ja++)if(D=e[ja],x=D.length,0!==x)if(3>x)I=D,Xa.push(I);else{I=D;X=g*g;ea=D[0];for(Fa=ha=1;Fa<x;Fa++)(D[Fa].X-ea.X)*(D[Fa].X-ea.X)+(D[Fa].Y-ea.Y)*(D[Fa].Y-ea.Y)<=X||(I[ha]=
D[Fa],ea=D[Fa],ha++);ea=D[ha-1];(D[0].X-ea.X)*(D[0].X-ea.X)+(D[0].Y-ea.Y)*(D[0].Y-ea.Y)<=X&&ha--;ha<x&&I.splice(ha,x-ha);I.length&&Xa.push(I)}!l&&Xa.length?Xa=Xa[0]:l||0!==Xa.length?l&&0===Xa.length&&(Xa=[[]]):Xa=[];return Xa};u.JS.Clone=function(e){if(!(e instanceof Array)||0===e.length)return[];if(1==e.length&&0===e[0].length)return[[]];var g=e[0]instanceof Array;g||(e=[e]);var l=e.length,r,x,D=Array(l);for(r=0;r<l;r++){var I=e[r].length;var X=Array(I);for(x=0;x<I;x++)X[x]={X:e[r][x].X,Y:e[r][x].Y};
D[r]=X}g||(D=D[0]);return D};u.JS.Lighten=function(e,g){if(!(e instanceof Array))return[];if("number"!=typeof g||null===g)return u.Error("Tolerance is not a number in Lighten()."),u.JS.Clone(e);if(0===e.length||1==e.length&&0===e[0].length||0>g)return u.JS.Clone(e);e[0]instanceof Array||(e=[e]);var l,r,x,D,I,X=e.length,ea=g*g,ha=[];for(g=0;g<X;g++)if(r=e[g],D=r.length,0!=D){for(x=0;1E6>x;x++){var Fa=[];D=r.length;r[D-1].X!=r[0].X||r[D-1].Y!=r[0].Y?(I=1,r.push({X:r[0].X,Y:r[0].Y}),D=r.length):I=0;
var Xa=[];for(l=0;l<D-2;l++){var ja=r[l];var zb=r[l+1];var Ma=r[l+2];var tc=ja.X;var wb=ja.Y;ja=Ma.X-tc;var Zb=Ma.Y-wb;if(0!==ja||0!==Zb){var ec=((zb.X-tc)*ja+(zb.Y-wb)*Zb)/(ja*ja+Zb*Zb);1<ec?(tc=Ma.X,wb=Ma.Y):0<ec&&(tc+=ja*ec,wb+=Zb*ec)}ja=zb.X-tc;Zb=zb.Y-wb;Ma=ja*ja+Zb*Zb;Ma<=ea&&(Xa[l+1]=1,l++)}Fa.push({X:r[0].X,Y:r[0].Y});for(l=1;l<D-1;l++)Xa[l]||Fa.push({X:r[l].X,Y:r[l].Y});Fa.push({X:r[D-1].X,Y:r[D-1].Y});I&&r.pop();if(Xa.length)r=Fa;else break}D=Fa.length;Fa[D-1].X==Fa[0].X&&Fa[D-1].Y==Fa[0].Y&&
Fa.pop();2<Fa.length&&ha.push(Fa)}e[0]instanceof Array||(ha=ha[0]);"undefined"==typeof ha&&(ha=[[]]);return ha};u.JS.PerimeterOfPath=function(e,g,l){if("undefined"==typeof e)return 0;var r=Math.sqrt,x=0,D=e.length;if(2>D)return 0;for(g&&(e[D]=e[0],D++);--D;){var I=e[D];var X=I.X;I=I.Y;var ea=e[D-1];var ha=ea.X;ea=ea.Y;x+=r((X-ha)*(X-ha)+(I-ea)*(I-ea))}g&&e.pop();return x/l};u.JS.PerimeterOfPaths=function(e,g,l){l||(l=1);for(var r=0,x=0;x<e.length;x++)r+=u.JS.PerimeterOfPath(e[x],g,l);return r};u.JS.ScaleDownPath=
function(e,g){var l;g||(g=1);for(l=e.length;l--;){var r=e[l];r.X/=g;r.Y/=g}};u.JS.ScaleDownPaths=function(e,g){var l,r;g||(g=1);for(l=e.length;l--;)for(r=e[l].length;r--;){var x=e[l][r];x.X/=g;x.Y/=g}};u.JS.ScaleUpPath=function(e,g){var l,r=Math.round;g||(g=1);for(l=e.length;l--;){var x=e[l];x.X=r(x.X*g);x.Y=r(x.Y*g)}};u.JS.ScaleUpPaths=function(e,g){var l,r,x=Math.round;g||(g=1);for(l=e.length;l--;)for(r=e[l].length;r--;){var D=e[l][r];D.X=x(D.X*g);D.Y=x(D.Y*g)}};u.ExPolygons=function(){return[]};
u.ExPolygon=function(){this.holes=this.outer=null};u.JS.AddOuterPolyNodeToExPolygons=function(e,g){var l=new u.ExPolygon;l.outer=e.Contour();e=e.Childs();var r=e.length;l.holes=Array(r);var x,D;for(x=0;x<r;x++){var I=e[x];l.holes[x]=I.Contour();var X=0;var ea=I.Childs();for(D=ea.length;X<D;X++)I=ea[X],u.JS.AddOuterPolyNodeToExPolygons(I,g)}g.push(l)};u.JS.ExPolygonsToPaths=function(e){var g,l,r=new u.Paths;var x=0;for(g=e.length;x<g;x++){r.push(e[x].outer);var D=0;for(l=e[x].holes.length;D<l;D++)r.push(e[x].holes[D])}return r};
u.JS.PolyTreeToExPolygons=function(e){var g=new u.ExPolygons,l;var r=0;var x=e.Childs();for(l=x.length;r<l;r++)e=x[r],u.JS.AddOuterPolyNodeToExPolygons(e,g);return g}})();
(function(J,V){"function"===typeof define&&define.amd?define(V):"object"===typeof exports?module.exports=V():J.returnExports=V()})(this,function(){var J=Function.call.bind(Function.apply),V=Function.call.bind(Function.call),ia=Array.isArray,va=Object.keys,xa=function(M){try{return M(),!1}catch(p){return!0}},Pa=function(M){try{return M()}catch(p){return!1}},sb=function(M){return function(){return!J(M,this,arguments)}}(xa),A=function(){return!xa(function(){return Object.defineProperty({},"x",{get:function(){}})})},
$a=!!Object.defineProperty&&A(),aa="foo"===function(){}.name,Ea=Function.call.bind(Array.prototype.forEach),Ta=Function.call.bind(Array.prototype.reduce),jb=Function.call.bind(Array.prototype.filter),mb=Function.call.bind(Array.prototype.some),Da=function(M,p,B,G){!G&&p in M||($a?Object.defineProperty(M,p,{configurable:!0,enumerable:!1,writable:!0,value:B}):M[p]=B)},hb=function(M,p,B){Ea(va(p),function(G){Da(M,G,p[G],!!B)})},nb=Function.call.bind(Object.prototype.toString),u="function"===typeof/abc/?
function(M){return"function"===typeof M&&"[object Function]"===nb(M)}:function(M){return"function"===typeof M},Ua={getter:function(M,p,B){if(!$a)throw new TypeError("getters require true ES5 support");Object.defineProperty(M,p,{configurable:!0,enumerable:!1,get:B})},proxy:function(M,p,B){if(!$a)throw new TypeError("getters require true ES5 support");var G=Object.getOwnPropertyDescriptor(M,p);Object.defineProperty(B,p,{configurable:G.configurable,enumerable:G.enumerable,get:function(){return M[p]},
set:function(z){M[p]=z}})},redefine:function(M,p,B){if($a){var G=Object.getOwnPropertyDescriptor(M,p);G.value=B;Object.defineProperty(M,p,G)}else M[p]=B},defineByDescriptor:function(M,p,B){$a?Object.defineProperty(M,p,B):"value"in B&&(M[p]=B.value)},preserveToString:function(M,p){p&&u(p.toString)&&Da(M,"toString",p.toString.bind(p),!0)}},Ya=Object.create||function(M,p){var B=function(){};B.prototype=M;var G=new B;"undefined"!==typeof p&&va(p).forEach(function(z){Ua.defineByDescriptor(G,z,p[z])});
return G},db=function(M,p){return Object.setPrototypeOf?Pa(function(){var B=function K(z){z=new M(z);Object.setPrototypeOf(z,K.prototype);return z};Object.setPrototypeOf(B,M);B.prototype=Ya(M.prototype,{constructor:{value:B}});return p(B)}):!1},T=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof global)return global;throw Error("unable to locate global object");}(),ua=T.isFinite,Ca=Function.call.bind(String.prototype.indexOf),
Gb=Function.apply.bind(Array.prototype.indexOf),Jb=Function.call.bind(Array.prototype.concat),Db=Function.call.bind(String.prototype.slice),Hb=Function.call.bind(Array.prototype.push),Cb=Function.apply.bind(Array.prototype.push),Ab=Function.call.bind(Array.prototype.join),nd=Function.call.bind(Array.prototype.shift),e=Math.max,g=Math.min,l=Math.floor,r=Math.abs,x=Math.exp,D=Math.log,I=Math.sqrt,X=Function.call.bind(Object.prototype.hasOwnProperty),ea=function(){},ha=T.Map,Fa=ha&&ha.prototype["delete"],
Xa=ha&&ha.prototype.get,ja=ha&&ha.prototype.has,zb=ha&&ha.prototype.set,Ma=T.Symbol||{},tc=Ma.species||"@@species",wb=Number.isNaN||function(M){return M!==M},Zb=Number.isFinite||function(M){return"number"===typeof M&&ua(M)},ec=u(Math.sign)?Math.sign:function(M){M=Number(M);return 0===M||wb(M)?M:0>M?-1:1},Pc=function(M){M=Number(M);return-1>M||wb(M)?NaN:0===M||Infinity===M?M:-1===M?-Infinity:0===1+M-1?M:M*(D(1+M)/(1+M-1))},Ad=function(M){return"[object Arguments]"===nb(M)},xe=function(M){return null!==
M&&"object"===typeof M&&"number"===typeof M.length&&0<=M.length&&"[object Array]"!==nb(M)&&"[object Function]"===nb(M.callee)},Bd=Ad(arguments)?Ad:xe,Bb={primitive:function(M){return null===M||"function"!==typeof M&&"object"!==typeof M},string:function(M){return"[object String]"===nb(M)},regex:function(M){return"[object RegExp]"===nb(M)},symbol:function(M){return"function"===typeof T.Symbol&&"symbol"===typeof M}},za=function(M,p,B){var G=M[p];Da(M,p,B,!0);Ua.preserveToString(M[p],G)},Ac="function"===
typeof Ma&&"function"===typeof Ma["for"]&&Bb.symbol(Ma()),nc=Bb.symbol(Ma.iterator)?Ma.iterator:"_es6-shim iterator_";T.Set&&"function"===typeof(new T.Set)["@@iterator"]&&(nc="@@iterator");T.Reflect||Da(T,"Reflect",{},!0);var Bc=T.Reflect,Cd=String,Dd="undefined"!==typeof document&&document?document.all:null,oc=null==Dd?function(M){return null==M}:function(M){return null==M&&M!==Dd},Q={Call:function(M,p){var B=2<arguments.length?arguments[2]:[];if(!Q.IsCallable(M))throw new TypeError(M+" is not a function");
return J(M,p,B)},RequireObjectCoercible:function(M,p){if(oc(M))throw new TypeError(p||"Cannot call method on "+M);return M},TypeIsObject:function(M){return void 0===M||null===M||!0===M||!1===M?!1:"function"===typeof M||"object"===typeof M||M===Dd},ToObject:function(M,p){return Object(Q.RequireObjectCoercible(M,p))},IsCallable:u,IsConstructor:function(M){return Q.IsCallable(M)},ToInt32:function(M){return Q.ToNumber(M)>>0},ToUint32:function(M){return Q.ToNumber(M)>>>0},ToNumber:function(M){if(Ac&&"[object Symbol]"===
nb(M))throw new TypeError("Cannot convert a Symbol value to a number");return+M},ToInteger:function(M){M=Q.ToNumber(M);return wb(M)?0:0!==M&&Zb(M)?(0<M?1:-1)*l(r(M)):M},ToLength:function(M){M=Q.ToInteger(M);return 0>=M?0:M>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:M},SameValue:function(M,p){return M===p?0===M?1/M===1/p:!0:wb(M)&&wb(p)},SameValueZero:function(M,p){return M===p||wb(M)&&wb(p)},IsIterable:function(M){return Q.TypeIsObject(M)&&("undefined"!==typeof M[nc]||Bd(M))},GetIterator:function(M){if(Bd(M))return new pc(M,
"value");var p=Q.GetMethod(M,nc);if(!Q.IsCallable(p))throw new TypeError("value is not an iterable");M=Q.Call(p,M);if(!Q.TypeIsObject(M))throw new TypeError("bad iterator");return M},GetMethod:function(M,p){M=Q.ToObject(M)[p];if(!oc(M)){if(!Q.IsCallable(M))throw new TypeError("Method not callable: "+p);return M}},IteratorComplete:function(M){return!!M.done},IteratorClose:function(M,p){var B=Q.GetMethod(M,"return");if(void 0!==B){try{var G=Q.Call(B,M)}catch(K){var z=K}if(!p){if(z)throw z;if(!Q.TypeIsObject(G))throw new TypeError("Iterator's return method returned a non-object.");
}}},IteratorNext:function(M){var p=1<arguments.length?M.next(arguments[1]):M.next();if(!Q.TypeIsObject(p))throw new TypeError("bad iterator");return p},IteratorStep:function(M){M=Q.IteratorNext(M);return Q.IteratorComplete(M)?!1:M},Construct:function(M,p,B,G){B="undefined"===typeof B?M:B;if(!G&&Bc.construct)return Bc.construct(M,p,B);G=B.prototype;Q.TypeIsObject(G)||(G=Object.prototype);G=Ya(G);M=Q.Call(M,G,p);return Q.TypeIsObject(M)?M:G},SpeciesConstructor:function(M,p){M=M.constructor;if(void 0===
M)return p;if(!Q.TypeIsObject(M))throw new TypeError("Bad constructor");M=M[tc];if(oc(M))return p;if(!Q.IsConstructor(M))throw new TypeError("Bad @@species");return M},CreateHTML:function(M,p,B,G){M=Q.ToString(M);var z="<"+p;""!==B&&(G=Q.ToString(G).replace(/"/g,"&quot;"),z+=" "+B+'="'+G+'"');return z+">"+M+"</"+p+">"},IsRegExp:function(M){if(!Q.TypeIsObject(M))return!1;var p=M[Ma.match];return"undefined"!==typeof p?!!p:Bb.regex(M)},ToString:function(M){if(Ac&&"[object Symbol]"===nb(M))throw new TypeError("Cannot convert a Symbol value to a number");
return Cd(M)}};if($a&&Ac){var od=function(M){if(Bb.symbol(Ma[M]))return Ma[M];var p=Ma["for"]("Symbol."+M);Object.defineProperty(Ma,M,{configurable:!1,enumerable:!1,writable:!1,value:p});return p};if(!Bb.symbol(Ma.search)){var pd=od("search"),ye=String.prototype.search;Da(RegExp.prototype,pd,function(M){return Q.Call(ye,M,[this])});za(String.prototype,"search",function(M){var p=Q.RequireObjectCoercible(this);if(!oc(M)){var B=Q.GetMethod(M,pd);if("undefined"!==typeof B)return Q.Call(B,M,[p])}return Q.Call(ye,
p,[Q.ToString(M)])})}if(!Bb.symbol(Ma.replace)){var Yc=od("replace"),$d=String.prototype.replace;Da(RegExp.prototype,Yc,function(M,p){return Q.Call($d,M,[this,p])});za(String.prototype,"replace",function(M,p){var B=Q.RequireObjectCoercible(this);if(!oc(M)){var G=Q.GetMethod(M,Yc);if("undefined"!==typeof G)return Q.Call(G,M,[B,p])}return Q.Call($d,B,[Q.ToString(M),p])})}if(!Bb.symbol(Ma.split)){var Tb=od("split"),Ic=String.prototype.split;Da(RegExp.prototype,Tb,function(M,p){return Q.Call(Ic,M,[this,
p])});za(String.prototype,"split",function(M,p){var B=Q.RequireObjectCoercible(this);if(!oc(M)){var G=Q.GetMethod(M,Tb);if("undefined"!==typeof G)return Q.Call(G,M,[B,p])}return Q.Call(Ic,B,[Q.ToString(M),p])})}var ae=Bb.symbol(Ma.match),xb=ae&&function(){var M={};M[Ma.match]=function(){return 42};return 42!=="a".match(M)}();if(!ae||xb){var Jc=od("match"),qd=String.prototype.match;Da(RegExp.prototype,Jc,function(M){return Q.Call(qd,M,[this])});za(String.prototype,"match",function(M){var p=Q.RequireObjectCoercible(this);
if(!oc(M)){var B=Q.GetMethod(M,Jc);if("undefined"!==typeof B)return Q.Call(B,M,[p])}return Q.Call(qd,p,[Q.ToString(M)])})}}var be=function(M,p,B){Ua.preserveToString(p,M);Object.setPrototypeOf&&Object.setPrototypeOf(M,p);$a?Ea(Object.getOwnPropertyNames(M),function(G){G in ea||B[G]||Ua.proxy(M,G,p)}):Ea(Object.keys(M),function(G){G in ea||B[G]||(p[G]=M[G])});p.prototype=M.prototype;Ua.redefine(M.prototype,"constructor",p)},ze=function(){return this},Cc=function(M){$a&&!X(M,tc)&&Ua.getter(M,tc,ze)},
L=function(M,p){p=p||function(){return this};Da(M,nc,p);!M[nc]&&Bb.symbol(nc)&&(M[nc]=p)},W=function(M,p,B){$a?Object.defineProperty(M,p,{configurable:!0,enumerable:!0,writable:!0,value:B}):M[p]=B;if(!Q.SameValue(M[p],B))throw new TypeError("property is nonconfigurable");},ya=function(M,p,B,G){if(!Q.TypeIsObject(M))throw new TypeError("Constructor requires `new`: "+p.name);M=p.prototype;Q.TypeIsObject(M)||(M=B);B=Ya(M);for(var z in G)X(G,z)&&Da(B,z,G[z],!0);return B};if(String.fromCodePoint&&1!==
String.fromCodePoint.length){var uc=String.fromCodePoint;za(String,"fromCodePoint",function(M){return Q.Call(uc,this,arguments)})}var Ae={fromCodePoint:function(M){for(var p=[],B,G=0,z=arguments.length;G<z;G++){B=Number(arguments[G]);if(!Q.SameValue(B,Q.ToInteger(B))||0>B||1114111<B)throw new RangeError("Invalid code point "+B);65536>B?Hb(p,String.fromCharCode(B)):(B-=65536,Hb(p,String.fromCharCode((B>>10)+55296)),Hb(p,String.fromCharCode(B%1024+56320)))}return Ab(p,"")},raw:function(M){var p=Q.ToObject(M,
"bad template");p=Q.ToObject(p.raw,"bad raw value");var B=Q.ToLength(p.length);if(0>=B)return"";for(var G=[],z=0,K;z<B;){K=Q.ToString(z);K=Q.ToString(p[K]);Hb(G,K);if(z+1>=B)break;K=z+1<arguments.length?arguments[z+1]:"";K=Q.ToString(K);Hb(G,K);z+=1}return Ab(G,"")}};String.raw&&"xy"!==String.raw({raw:{0:"x",1:"y",length:2}})&&za(String,"raw",Ae.raw);hb(String,Ae);var ob=function G(p,B){if(1>B)return"";if(B%2)return G(p,B-1)+p;p=G(p,B/2);return p+p},Kc={repeat:function(p){var B=Q.ToString(Q.RequireObjectCoercible(this));
p=Q.ToInteger(p);if(0>p||Infinity<=p)throw new RangeError("repeat count must be less than infinity and not overflow maximum string size");return ob(B,p)},startsWith:function(p){var B=Q.ToString(Q.RequireObjectCoercible(this));if(Q.IsRegExp(p))throw new TypeError('Cannot call method "startsWith" with a regex');var G=Q.ToString(p),z;1<arguments.length&&(z=arguments[1]);z=e(Q.ToInteger(z),0);return Db(B,z,z+G.length)===G},endsWith:function(p){var B=Q.ToString(Q.RequireObjectCoercible(this));if(Q.IsRegExp(p))throw new TypeError('Cannot call method "endsWith" with a regex');
var G=Q.ToString(p),z=B.length,K;1<arguments.length&&(K=arguments[1]);K="undefined"===typeof K?z:Q.ToInteger(K);z=g(e(K,0),z);return Db(B,z-G.length,z)===G},includes:function(p){if(Q.IsRegExp(p))throw new TypeError('"includes" does not accept a RegExp');var B=Q.ToString(p),G;1<arguments.length&&(G=arguments[1]);return-1!==Ca(this,B,G)},codePointAt:function(p){var B=Q.ToString(Q.RequireObjectCoercible(this)),G=Q.ToInteger(p),z=B.length;if(0<=G&&G<z){p=B.charCodeAt(G);if(55296>p||56319<p||G+1===z)return p;
B=B.charCodeAt(G+1);return 56320>B||57343<B?p:1024*(p-55296)+(B-56320)+65536}}};String.prototype.includes&&!1!=="a".includes("a",Infinity)&&za(String.prototype,"includes",Kc.includes);if(String.prototype.startsWith&&String.prototype.endsWith){var Be=xa(function(){return"/a/".startsWith(/a/)}),Ce=Pa(function(){return!1==="abc".startsWith("a",Infinity)});Be&&Ce||(za(String.prototype,"startsWith",Kc.startsWith),za(String.prototype,"endsWith",Kc.endsWith))}Ac&&(Pa(function(){var p=/a/;p[Ma.match]=!1;
return"/a/".startsWith(p)})||za(String.prototype,"startsWith",Kc.startsWith),Pa(function(){var p=/a/;p[Ma.match]=!1;return"/a/".endsWith(p)})||za(String.prototype,"endsWith",Kc.endsWith),Pa(function(){var p=/a/;p[Ma.match]=!1;return"/a/".includes(p)})||za(String.prototype,"includes",Kc.includes));hb(String.prototype,Kc);var cf=RegExp("(^[\t\n\v\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]+)|([\t\n\v\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]+$)",
"g"),De=function(){return Q.ToString(Q.RequireObjectCoercible(this)).replace(cf,"")},rd=RegExp("[\u0085\u200b\ufffe]","g"),Ee=/^[-+]0x[0-9a-f]+$/i;Da(String.prototype,"trim",De,!0);var $b=function(p){return{value:p,done:0===arguments.length}},Ed=function(p){Q.RequireObjectCoercible(p);this._s=Q.ToString(p);this._i=0};Ed.prototype.next=function(){var p=this._s,B=this._i;if("undefined"===typeof p||B>=p.length)return this._s=void 0,$b();var G=p.charCodeAt(B);55296>G||56319<G||B+1===p.length?G=1:(G=p.charCodeAt(B+
1),G=56320>G||57343<G?1:2);this._i=B+G;return $b(p.substr(B,G))};L(Ed.prototype);L(String.prototype,function(){return new Ed(this)});var sd={from:function(p){var B;1<arguments.length&&(B=arguments[1]);var G;if("undefined"===typeof B)var z=!1;else{if(!Q.IsCallable(B))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(G=arguments[2]);z=!0}var K;if("undefined"!==typeof(Bd(p)||Q.GetMethod(p,nc))){var Y=Q.IsConstructor(this)?Object(new this):[];
var ca=Q.GetIterator(p);for(K=0;;){var fa=Q.IteratorStep(ca);if(!1===fa)break;fa=fa.value;try{z&&(fa="undefined"===typeof G?B(fa,K):V(B,G,fa,K)),Y[K]=fa}catch(Ga){throw Q.IteratorClose(ca,!0),Ga;}K+=1}ca=K}else for(fa=Q.ToObject(p),ca=Q.ToLength(fa.length),Y=Q.IsConstructor(this)?Object(new this(ca)):Array(ca),K=0;K<ca;++K){var sa=fa[K];z&&(sa="undefined"===typeof G?B(sa,K):V(B,G,sa,K));W(Y,K,sa)}Y.length=ca;return Y},of:function(){for(var p=arguments.length,B=ia(this)||!Q.IsCallable(this)?Array(p):
Q.Construct(this,[p]),G=0;G<p;++G)W(B,G,arguments[G]);B.length=p;return B}};hb(Array,sd);Cc(Array);var pc=function(p,B){this.i=0;this.array=p;this.kind=B};hb(pc.prototype,{next:function(){var p=this.i,B=this.array;if(!(this instanceof pc))throw new TypeError("Not an ArrayIterator");if("undefined"!==typeof B){var G=Q.ToLength(B.length);if(p<G){G=this.kind;var z;"key"===G?z=p:"value"===G?z=B[p]:"entry"===G&&(z=[p,B[p]]);this.i=p+1;return $b(z)}}this.array=void 0;return $b()}});L(pc.prototype);Array.of===
sd.of||function(){var p=function(G){this.length=G};p.prototype=[];var B=Array.of.apply(p,[1,2]);return B instanceof p&&2===B.length}()||za(Array,"of",sd.of);var fc={copyWithin:function(p,B){var G=Q.ToObject(this),z=Q.ToLength(G.length),K=Q.ToInteger(p),Y=Q.ToInteger(B);K=0>K?e(z+K,0):g(K,z);Y=0>Y?e(z+Y,0):g(Y,z);var ca;2<arguments.length&&(ca=arguments[2]);ca="undefined"===typeof ca?z:Q.ToInteger(ca);ca=0>ca?e(z+ca,0):g(ca,z);z=g(ca-Y,z-K);ca=1;Y<K&&K<Y+z&&(ca=-1,Y+=z-1,K+=z-1);for(;0<z;)Y in G?G[K]=
G[Y]:delete G[K],Y+=ca,K+=ca,--z;return G},fill:function(p){var B;1<arguments.length&&(B=arguments[1]);var G;2<arguments.length&&(G=arguments[2]);var z=Q.ToObject(this),K=Q.ToLength(z.length);B=Q.ToInteger("undefined"===typeof B?0:B);G=Q.ToInteger("undefined"===typeof G?K:G);B=0>B?e(K+B,0):g(B,K);for(G=0>G?K+G:G;B<K&&B<G;++B)z[B]=p;return z},find:function(p){var B=Q.ToObject(this),G=Q.ToLength(B.length);if(!Q.IsCallable(p))throw new TypeError("Array#find: predicate must be a function");for(var z=
1<arguments.length?arguments[1]:null,K=0,Y;K<G;K++)if(Y=B[K],z){if(V(p,z,Y,K,B))return Y}else if(p(Y,K,B))return Y},findIndex:function(p){var B=Q.ToObject(this),G=Q.ToLength(B.length);if(!Q.IsCallable(p))throw new TypeError("Array#findIndex: predicate must be a function");for(var z=1<arguments.length?arguments[1]:null,K=0;K<G;K++)if(z){if(V(p,z,B[K],K,B))return K}else if(p(B[K],K,B))return K;return-1},keys:function(){return new pc(this,"key")},values:function(){return new pc(this,"value")},entries:function(){return new pc(this,
"entry")}};Array.prototype.keys&&!Q.IsCallable([1].keys().next)&&delete Array.prototype.keys;Array.prototype.entries&&!Q.IsCallable([1].entries().next)&&delete Array.prototype.entries;Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[nc]&&(hb(Array.prototype,{values:Array.prototype[nc]}),Bb.symbol(Ma.unscopables)&&(Array.prototype[Ma.unscopables].values=!0));if(aa&&Array.prototype.values&&"values"!==Array.prototype.values.name){var Zc=Array.prototype.values;za(Array.prototype,
"values",function(){return Q.Call(Zc,this,arguments)});Da(Array.prototype,nc,Array.prototype.values,!0)}hb(Array.prototype,fc);0>1/[!0].indexOf(!0,-0)&&Da(Array.prototype,"indexOf",function(p){var B=Gb(this,arguments);return 0===B&&0>1/B?0:B},!0);L(Array.prototype,function(){return this.values()});Object.getPrototypeOf&&L(Object.getPrototypeOf([].values()));var ce=function(){return Pa(function(){return 0===Array.from({length:-1}).length})}(),Fe=function(){var p=Array.from([0].entries());return 1===
p.length&&ia(p[0])&&0===p[0][0]&&0===p[0][1]}();ce&&Fe||za(Array,"from",sd.from);if(!function(){return Pa(function(){return Array.from([0],void 0)})}()){var de=Array.from;za(Array,"from",function(p){return 1<arguments.length&&"undefined"!==typeof arguments[1]?Q.Call(de,this,arguments):V(de,this,p)})}var ee=-(Math.pow(2,32)-1),ac=function(p,B){var G={length:ee};G[B?(G.length>>>0)-1:0]=!0;return Pa(function(){V(p,G,function(){throw new RangeError("should not reach here");},[]);return!0})};if(!ac(Array.prototype.forEach)){var Ge=
Array.prototype.forEach;za(Array.prototype,"forEach",function(p){return Q.Call(Ge,0<=this.length?this:[],arguments)})}if(!ac(Array.prototype.map)){var He=Array.prototype.map;za(Array.prototype,"map",function(p){return Q.Call(He,0<=this.length?this:[],arguments)})}if(!ac(Array.prototype.filter)){var $c=Array.prototype.filter;za(Array.prototype,"filter",function(p){return Q.Call($c,0<=this.length?this:[],arguments)})}if(!ac(Array.prototype.some)){var Fd=Array.prototype.some;za(Array.prototype,"some",
function(p){return Q.Call(Fd,0<=this.length?this:[],arguments)})}if(!ac(Array.prototype.every)){var df=Array.prototype.every;za(Array.prototype,"every",function(p){return Q.Call(df,0<=this.length?this:[],arguments)})}if(!ac(Array.prototype.reduce)){var ef=Array.prototype.reduce;za(Array.prototype,"reduce",function(p){return Q.Call(ef,0<=this.length?this:[],arguments)})}if(!ac(Array.prototype.reduceRight,!0)){var Ie=Array.prototype.reduceRight;za(Array.prototype,"reduceRight",function(p){return Q.Call(Ie,
0<=this.length?this:[],arguments)})}var Je=8!==Number("0o10"),ad=2!==Number("0b10"),Ke=mb("\u0085\u200b\ufffe",function(p){return 0===Number(p+0+p)});if(Je||ad||Ke){var vc=Number,fe=/^0b[01]+$/i,Ub=/^0o[0-7]+$/i,Le=fe.test.bind(fe),Gd=Ub.test.bind(Ub),ff=function(p,B){if("function"===typeof p.valueOf&&(B=p.valueOf(),Bb.primitive(B))||"function"===typeof p.toString&&(B=p.toString(),Bb.primitive(B)))return B;throw new TypeError("No default value");},Me=rd.test.bind(rd),ge=Ee.test.bind(Ee),td=function(){var p=
function(B){var G=0<arguments.length?Bb.primitive(B)?B:ff(B,"number"):0;if("string"===typeof G)if(G=Q.Call(De,G),Le(G))G=parseInt(Db(G,2),2);else if(Gd(G))G=parseInt(Db(G,2),8);else if(Me(G)||ge(G))G=NaN;var z=this,K=Pa(function(){vc.prototype.valueOf.call(z);return!0});return z instanceof p&&!K?new vc(G):vc(G)};return p}();be(vc,td,{});hb(td,{NaN:vc.NaN,MAX_VALUE:vc.MAX_VALUE,MIN_VALUE:vc.MIN_VALUE,NEGATIVE_INFINITY:vc.NEGATIVE_INFINITY,POSITIVE_INFINITY:vc.POSITIVE_INFINITY});Number=td;Ua.redefine(T,
"Number",td)}var Ne=Math.pow(2,53)-1;hb(Number,{MAX_SAFE_INTEGER:Ne,MIN_SAFE_INTEGER:-Ne,EPSILON:2.220446049250313E-16,parseInt:T.parseInt,parseFloat:T.parseFloat,isFinite:Zb,isInteger:function(p){return Zb(p)&&Q.ToInteger(p)===p},isSafeInteger:function(p){return Number.isInteger(p)&&r(p)<=Number.MAX_SAFE_INTEGER},isNaN:wb});Da(Number,"parseInt",T.parseInt,Number.parseInt!==T.parseInt);1===[,1].find(function(){return!0})&&za(Array.prototype,"find",fc.find);0!==[,1].findIndex(function(){return!0})&&
za(Array.prototype,"findIndex",fc.findIndex);var Oe=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable),qc=function(p,B){$a&&Oe(p,B)&&Object.defineProperty(p,B,{enumerable:!1})},gf=function(){var p=Number(this),B=arguments.length,G=B-p;G=Array(0>G?0:G);for(var z=p;z<B;++z)G[z-p]=arguments[z];return G},Qc=function(p){return function(B,G){B[G]=p[G];return B}},Hd=function(p,B){var G=va(Object(B)),z;Q.IsCallable(Object.getOwnPropertySymbols)&&(z=jb(Object.getOwnPropertySymbols(Object(B)),
Oe(B)));return Ta(Jb(G,z||[]),Qc(B),p)},he={assign:function(p,B){var G=Q.ToObject(p,"Cannot convert undefined or null to object");return Ta(Q.Call(gf,1,arguments),Hd,G)},is:function(p,B){return Q.SameValue(p,B)}};Object.assign&&Object.preventExtensions&&function(){var p=Object.preventExtensions({1:2});try{Object.assign(p,"xy")}catch(B){return"y"===p[1]}}()&&za(Object,"assign",he.assign);hb(Object,he);if($a){var hf={setPrototypeOf:function(p,B){var G=function(K,Y){if(!Q.TypeIsObject(K))throw new TypeError("cannot set prototype on a non-object");
if(null!==Y&&!Q.TypeIsObject(Y))throw new TypeError("can only set prototype to an object or null"+Y);V(z,K,Y);return K};try{var z=p.getOwnPropertyDescriptor(p.prototype,B).set;V(z,{},null)}catch(K){if(p.prototype!=={}[B])return;z=function(Y){this[B]=Y};G.polyfill=G(G({},null),p.prototype)instanceof p}return G}(Object,"__proto__")};hb(Object,hf)}Object.setPrototypeOf&&Object.getPrototypeOf&&null!==Object.getPrototypeOf(Object.setPrototypeOf({},null))&&null===Object.getPrototypeOf(Object.create(null))&&
function(){var p=Object.create(null),B=Object.getPrototypeOf,G=Object.setPrototypeOf;Object.getPrototypeOf=function(z){z=B(z);return z===p?null:z};Object.setPrototypeOf=function(z,K){return G(z,null===K?p:K)};Object.setPrototypeOf.polyfill=!1}();if(xa(function(){return Object.keys("foo")})){var Qb=Object.keys;za(Object,"keys",function(p){return Qb(Q.ToObject(p))});va=Object.keys}if(xa(function(){return Object.keys(/a/g)})){var Pe=Object.keys;za(Object,"keys",function(p){if(Bb.regex(p)){var B=[],G;
for(G in p)X(p,G)&&Hb(B,G);return B}return Pe(p)});va=Object.keys}if(Object.getOwnPropertyNames&&xa(function(){return Object.getOwnPropertyNames("foo")})){var Qe="object"===typeof window?Object.getOwnPropertyNames(window):[],ie=Object.getOwnPropertyNames;za(Object,"getOwnPropertyNames",function(p){p=Q.ToObject(p);if("[object Window]"===nb(p))try{return ie(p)}catch(B){return Jb([],Qe)}return ie(p)})}if(Object.getOwnPropertyDescriptor&&xa(function(){return Object.getOwnPropertyDescriptor("foo","bar")})){var jf=
Object.getOwnPropertyDescriptor;za(Object,"getOwnPropertyDescriptor",function(p,B){return jf(Q.ToObject(p),B)})}if(Object.seal&&xa(function(){return Object.seal("foo")})){var kf=Object.seal;za(Object,"seal",function(p){return Q.TypeIsObject(p)?kf(p):p})}if(Object.isSealed&&xa(function(){return Object.isSealed("foo")})){var bd=Object.isSealed;za(Object,"isSealed",function(p){return Q.TypeIsObject(p)?bd(p):!0})}if(Object.freeze&&xa(function(){return Object.freeze("foo")})){var Za=Object.freeze;za(Object,
"freeze",function(p){return Q.TypeIsObject(p)?Za(p):p})}if(Object.isFrozen&&xa(function(){return Object.isFrozen("foo")})){var wc=Object.isFrozen;za(Object,"isFrozen",function(p){return Q.TypeIsObject(p)?wc(p):!0})}if(Object.preventExtensions&&xa(function(){return Object.preventExtensions("foo")})){var Qa=Object.preventExtensions;za(Object,"preventExtensions",function(p){return Q.TypeIsObject(p)?Qa(p):p})}if(Object.isExtensible&&xa(function(){return Object.isExtensible("foo")})){var gc=Object.isExtensible;
za(Object,"isExtensible",function(p){return Q.TypeIsObject(p)?gc(p):!1})}if(Object.getPrototypeOf&&xa(function(){return Object.getPrototypeOf("foo")})){var je=Object.getPrototypeOf;za(Object,"getPrototypeOf",function(p){return je(Q.ToObject(p))})}var ke=$a&&function(){var p=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return p&&Q.IsCallable(p.get)}();$a&&!ke&&Ua.getter(RegExp.prototype,"flags",function(){if(!Q.TypeIsObject(this))throw new TypeError("Method called on incompatible type: must be an object.");
var p="";this.global&&(p+="g");this.ignoreCase&&(p+="i");this.multiline&&(p+="m");this.unicode&&(p+="u");this.sticky&&(p+="y");return p});var lf=$a&&Pa(function(){return"/a/i"===String(new RegExp(/a/g,"i"))}),Re=Ac&&$a&&function(){var p=/./;p[Ma.match]=!1;return RegExp(p)===p}(),cd=Pa(function(){return"/abc/"===RegExp.prototype.toString.call({source:"abc"})}),kb=cd&&Pa(function(){return"/a/b"===RegExp.prototype.toString.call({source:"a",flags:"b"})});if(!cd||!kb){var Dc=RegExp.prototype.toString;
Da(RegExp.prototype,"toString",function(){var p=Q.RequireObjectCoercible(this);if(Bb.regex(p))return V(Dc,p);var B=Cd(p.source);p=Cd(p.flags);return"/"+B+"/"+p},!0);Ua.preserveToString(RegExp.prototype.toString,Dc)}if($a&&(!lf||Re)){var Se=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get,dd=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{},Te=function(){return this.source},Ue=Q.IsCallable(dd.get)?dd.get:Te,le=RegExp,ud=function(){return function z(B,G){var K=Q.IsRegExp(B);
return this instanceof z||!K||"undefined"!==typeof G||B.constructor!==z?Bb.regex(B)?(K=Q.Call(Ue,B),B="undefined"===typeof G?Q.Call(Se,B):G,new z(K,B)):new le(B,G):B}}();be(le,ud,{$input:!0});RegExp=ud;Ua.redefine(T,"RegExp",ud)}if($a){var bc={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};Ea(va(bc),function(p){p in RegExp&&!(bc[p]in RegExp)&&Ua.getter(RegExp,bc[p],function(){return RegExp[p]})})}Cc(RegExp);var Id=1/Number.EPSILON,Jd=Math.pow(2,-23),mf=Math.pow(2,127)*
(2-Jd),me=Math.pow(2,-126),ed=Math.E,fd=Math.LOG2E,Ob=Math.LOG10E,Kb=Number.prototype.clz;delete Number.prototype.clz;var wa={acosh:function(p){var B=Number(p);if(wb(B)||1>p)return NaN;if(1===B)return 0;if(Infinity===B)return B;p=1/(B*B);if(2>B)return Pc(B-1+I(1-p)*B);B/=2;return Pc(B+I(1-p)*B-1)+1/fd},asinh:function(p){var B=Number(p);if(0===B||!ua(B))return B;p=r(B);var G=p*p;B=ec(B);return 1>p?B*Pc(p+G/(I(G+1)+1)):B*(Pc(p/2+I(1+1/G)*p/2-1)+1/fd)},atanh:function(p){p=Number(p);if(0===p)return p;
if(-1===p)return-Infinity;if(1===p)return Infinity;if(wb(p)||-1>p||1<p)return NaN;var B=r(p);return ec(p)*Pc(2*B/(1-B))/2},cbrt:function(p){p=Number(p);if(0===p)return p;var B=0>p;B&&(p=-p);if(Infinity===p)var G=Infinity;else G=x(D(p)/3),G=(p/(G*G)+2*G)/3;return B?-G:G},clz32:function(p){p=Q.ToUint32(Number(p));return 0===p?32:Kb?Q.Call(Kb,p):31-l(D(p+.5)*fd)},cosh:function(p){p=Number(p);if(0===p)return 1;if(wb(p))return NaN;if(!ua(p))return Infinity;p=x(r(p)-1);return ed/2*(p+1/(p*ed*ed))},expm1:function(p){p=
Number(p);if(-Infinity===p)return-1;if(!ua(p)||0===p)return p;if(.5<r(p))return x(p)-1;for(var B=p,G=0,z=1;G+B!==G;)G+=B,z+=1,B*=p/z;return G},hypot:function(p,B){for(var G=0,z=0,K=0;K<arguments.length;++K){var Y=r(Number(arguments[K]));z<Y?(G*=z/Y*(z/Y),G+=1,z=Y):G+=0<Y?Y/z*(Y/z):Y}return Infinity===z?Infinity:z*I(G)},log2:function(p){return D(p)*fd},log10:function(p){return D(p)*Ob},log1p:Pc,sign:ec,sinh:function(p){p=Number(p);if(!ua(p)||0===p)return p;var B=r(p);if(1>B)return B=Math.expm1(B),
ec(p)*B*(1+1/(B+1))/2;B=x(B-1);return ec(p)*(B-1/(B*ed*ed))*(ed/2)},tanh:function(p){p=Number(p);return wb(p)||0===p?p:20<=p?1:-20>=p?-1:(Math.expm1(p)-Math.expm1(-p))/(x(p)+x(-p))},trunc:function(p){p=Number(p);return 0>p?-l(-p):l(p)},imul:function(p,B){p=Q.ToUint32(p);B=Q.ToUint32(B);var G=p&65535,z=B&65535;return G*z+((p>>>16&65535)*z+G*(B>>>16&65535)<<16>>>0)|0},fround:function(p){var B=Number(p);if(0===B||Infinity===B||-Infinity===B||wb(B))return B;p=ec(B);B=r(B);if(B<me)return p*(B/me/Jd+Id-
Id)*me*Jd;var G=(1+Jd/Number.EPSILON)*B;B=G-(G-B);return B>mf||wb(B)?Infinity*p:p*B}};hb(Math,wa);Da(Math,"sinh",wa.sinh,Infinity===Math.sinh(710));Da(Math,"cosh",wa.cosh,Infinity===Math.cosh(710));Da(Math,"log1p",wa.log1p,-1E-17!==Math.log1p(-1E-17));Da(Math,"asinh",wa.asinh,Math.asinh(-1E7)!==-Math.asinh(1E7));Da(Math,"asinh",wa.asinh,Infinity===Math.asinh(1E300));Da(Math,"atanh",wa.atanh,0===Math.atanh(1E-300));Da(Math,"tanh",wa.tanh,-2E-17!==Math.tanh(-2E-17));Da(Math,"acosh",wa.acosh,Infinity===
Math.acosh(Number.MAX_VALUE));Da(Math,"acosh",wa.acosh,!(8>r(1-Math.acosh(1+Number.EPSILON)/Math.sqrt(2*Number.EPSILON))/Number.EPSILON));Da(Math,"cbrt",wa.cbrt,!(8>r(1-Math.cbrt(1E-300)/1E-100)/Number.EPSILON));Da(Math,"sinh",wa.sinh,-2E-17!==Math.sinh(-2E-17));var xc=Math.expm1(10);Da(Math,"expm1",wa.expm1,22025.465794806718<xc||22025.465794806718>xc);Da(Math,"hypot",wa.hypot,Infinity!==Math.hypot(Infinity,NaN));var Kd=Math.round,gd=0===Math.round(.5-Number.EPSILON/4)&&1===Math.round(-.5+Number.EPSILON/
3.99),Ve=[Id+1,2*Id-1].every(function(p){return Math.round(p)===p});Da(Math,"round",function(p){var B=l(p);return.5>p-B?B:-1===B?-0:B+1},!gd||!Ve);Ua.preserveToString(Math.round,Kd);var We=Math.imul;2!==Math.imul.length&&za(Math,"imul",function(p,B){return Q.Call(We,Math,arguments)});var Uc=function(){var p=T.setTimeout;if("function"===typeof p||"object"===typeof p){Q.IsPromise=function(ka){return Q.TypeIsObject(ka)&&"undefined"!==typeof ka._promise?!0:!1};var B=function(ka){if(!Q.IsConstructor(ka))throw new TypeError("Bad promise constructor");
var qa=this;qa.resolve=void 0;qa.reject=void 0;qa.promise=new ka(function(oa,Sa){if(void 0!==qa.resolve||void 0!==qa.reject)throw new TypeError("Bad Promise implementation!");qa.resolve=oa;qa.reject=Sa});if(!Q.IsCallable(qa.resolve)||!Q.IsCallable(qa.reject))throw new TypeError("Bad promise constructor");},G;"undefined"!==typeof window&&Q.IsCallable(window.postMessage)&&(G=function(){var ka=[];window.addEventListener("message",function(qa){qa.source===window&&"zero-timeout-message"===qa.data&&(qa.stopPropagation(),
0!==ka.length&&nd(ka)())},!0);return function(qa){Hb(ka,qa);window.postMessage("zero-timeout-message","*")}});var z=function(){var ka=T.Promise,qa=ka&&ka.resolve&&ka.resolve();return qa&&function(oa){return qa.then(oa)}},K=Q.IsCallable(T.setImmediate)?T.setImmediate:"object"===typeof process&&process.nextTick?process.nextTick:z()||(Q.IsCallable(G)?G():function(ka){p(ka,0)}),Y=function(ka){return ka},ca=function(ka){throw ka;},fa={},sa=function(ka,qa,oa){K(function(){if(qa===fa)ka(oa);else{try{var Sa=
ka(oa);var Va=qa.resolve}catch(na){Sa=na,Va=qa.reject}Va(Sa)}})},Ga=function(ka,qa){var oa=ka._promise,Sa=oa.reactionLength;if(0<Sa&&(sa(oa.fulfillReactionHandler0,oa.reactionCapability0,qa),oa.fulfillReactionHandler0=void 0,oa.rejectReactions0=void 0,oa.reactionCapability0=void 0,1<Sa))for(var Va=1,na=0;Va<Sa;Va++,na+=3)sa(oa[na+0],oa[na+2],qa),ka[na+0]=void 0,ka[na+1]=void 0,ka[na+2]=void 0;oa.result=qa;oa.state=1;oa.reactionLength=0},eb=function(ka,qa){var oa=ka._promise,Sa=oa.reactionLength;if(0<
Sa&&(sa(oa.rejectReactionHandler0,oa.reactionCapability0,qa),oa.fulfillReactionHandler0=void 0,oa.rejectReactions0=void 0,oa.reactionCapability0=void 0,1<Sa))for(var Va=1,na=0;Va<Sa;Va++,na+=3)sa(oa[na+1],oa[na+2],qa),ka[na+0]=void 0,ka[na+1]=void 0,ka[na+2]=void 0;oa.result=qa;oa.state=2;oa.reactionLength=0},Ec=function(ka){var qa=!1;return{resolve:function(oa){if(!qa){qa=!0;if(oa===ka)return eb(ka,new TypeError("Self resolution"));if(!Q.TypeIsObject(oa))return Ga(ka,oa);try{var Sa=oa.then}catch(Va){return eb(ka,
Va)}if(!Q.IsCallable(Sa))return Ga(ka,oa);K(function(){var Va=Sa,na=Ec(ka),Vb=na.resolve;na=na.reject;try{Lb(Va,oa,Vb,na)}catch(Fc){na(Fc)}})}},reject:function(oa){if(!qa)return qa=!0,eb(ka,oa)}}},Lb=function(ka,qa,oa,Sa){ka===nf?V(ka,qa,oa,Sa,fa):V(ka,qa,oa,Sa)},Sc=function(){var ka=function(qa){if(!(this instanceof ka))throw new TypeError('Constructor Promise requires "new"');if(this&&this._promise)throw new TypeError("Bad construction");if(!Q.IsCallable(qa))throw new TypeError("not a valid resolver");
var oa=ya(this,ka,Rc,{_promise:{result:void 0,state:0,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}}),Sa=Ec(oa),Va=Sa.reject;try{qa(Sa.resolve,Va)}catch(na){Va(na)}return oa};return ka}();var Rc=Sc.prototype;var vd=function(ka,qa,oa,Sa){var Va=!1;return function(na){Va||(Va=!0,qa[ka]=na,0===--Sa.count&&(na=oa.resolve,na(qa)))}};hb(Sc,{all:function(ka){if(!Q.TypeIsObject(this))throw new TypeError("Promise is not object");var qa=new B(this),
oa;try{var Sa=Q.GetIterator(ka);ka=oa={iterator:Sa,done:!1};for(var Va=ka.iterator,na=[],Vb={count:1},Fc,hd,Tc=0;;){try{Fc=Q.IteratorStep(Va);if(!1===Fc){ka.done=!0;break}hd=Fc.value}catch(wd){throw ka.done=!0,wd;}na[Tc]=void 0;var ne=this.resolve(hd),Xe=vd(Tc,na,qa,Vb);Vb.count+=1;Lb(ne.then,ne,Xe,qa.reject);Tc+=1}if(0===--Vb.count){var of=qa.resolve;of(na)}return qa.promise}catch(wd){Va=wd;if(oa&&!oa.done)try{Q.IteratorClose(Sa,!0)}catch(pf){Va=pf}Sa=qa.reject;Sa(Va);return qa.promise}},race:function(ka){if(!Q.TypeIsObject(this))throw new TypeError("Promise is not object");
var qa=new B(this),oa;try{var Sa=Q.GetIterator(ka);ka=oa={iterator:Sa,done:!1};for(var Va=ka.iterator,na,Vb,Fc;;){try{na=Q.IteratorStep(Va);if(!1===na){ka.done=!0;break}Vb=na.value}catch(hd){throw ka.done=!0,hd;}Fc=this.resolve(Vb);Lb(Fc.then,Fc,qa.resolve,qa.reject)}return qa.promise}catch(hd){Va=hd;if(oa&&!oa.done)try{Q.IteratorClose(Sa,!0)}catch(Tc){Va=Tc}Sa=qa.reject;Sa(Va);return qa.promise}},reject:function(ka){if(!Q.TypeIsObject(this))throw new TypeError("Bad promise constructor");var qa=new B(this),
oa=qa.reject;oa(ka);return qa.promise},resolve:function(ka){if(!Q.TypeIsObject(this))throw new TypeError("Bad promise constructor");if(Q.IsPromise(ka)&&ka.constructor===this)return ka;var qa=new B(this),oa=qa.resolve;oa(ka);return qa.promise}});hb(Rc,{"catch":function(ka){return this.then(null,ka)},then:function(ka,qa){if(!Q.IsPromise(this))throw new TypeError("not a promise");var oa=Q.SpeciesConstructor(this,Sc);oa=2<arguments.length&&arguments[2]===fa&&oa===Sc?fa:new B(oa);var Sa=Q.IsCallable(ka)?
ka:Y,Va=Q.IsCallable(qa)?qa:ca,na=this._promise;if(0===na.state){if(0===na.reactionLength)na.fulfillReactionHandler0=Sa,na.rejectReactionHandler0=Va,na.reactionCapability0=oa;else{var Vb=3*(na.reactionLength-1);na[Vb+0]=Sa;na[Vb+1]=Va;na[Vb+2]=oa}na.reactionLength+=1}else if(1===na.state)na=na.result,sa(Sa,oa,na);else if(2===na.state)na=na.result,sa(Va,oa,na);else throw new TypeError("unexpected Promise state");return oa.promise}});fa=new B(Sc);var nf=Rc.then;return Sc}}();T.Promise&&(delete T.Promise.accept,
delete T.Promise.defer,delete T.Promise.prototype.chain);if("function"===typeof Uc){hb(T,{Promise:Uc});var Ye=db(T.Promise,function(p){return p.resolve(42).then(function(){})instanceof p}),qf=!xa(function(){return T.Promise.reject(42).then(null,5).then(null,ea)}),Ld=xa(function(){return T.Promise.call(3,ea)}),Rb=function(p){var B=p.resolve(5);B.constructor={};p=p.resolve(B);try{p.then(null,ea).then(null,ea)}catch(G){return!0}return B===p}(T.Promise),oe=$a&&function(){var p=0,B=Object.defineProperty({},
"then",{get:function(){p+=1}});Promise.resolve(B);return 1===p}(),Vc=function G(B){var z=new Promise(B);B(3,function(){});this.then=z.then;this.constructor=G};Vc.prototype=Promise.prototype;Vc.all=Promise.all;var id=Pa(function(){return!!Vc.all([1,2])});Ye&&qf&&Ld&&!Rb&&oe&&!id||(Promise=Uc,za(T,"Promise",Uc));if(1!==Promise.all.length){var xd=Promise.all;za(Promise,"all",function(B){return Q.Call(xd,this,arguments)})}if(1!==Promise.race.length){var Md=Promise.race;za(Promise,"race",function(B){return Q.Call(Md,
this,arguments)})}if(1!==Promise.resolve.length){var Nd=Promise.resolve;za(Promise,"resolve",function(B){return Q.Call(Nd,this,arguments)})}if(1!==Promise.reject.length){var pb=Promise.reject;za(Promise,"reject",function(B){return Q.Call(pb,this,arguments)})}qc(Promise,"all");qc(Promise,"race");qc(Promise,"resolve");qc(Promise,"reject");Cc(Promise)}var fb=function(p){var B=va(Ta(p,function(G,z){G[z]=!0;return G},{}));return p.join(":")===B.join(":")},Od=fb(["z","a","bb"]),Wb=fb(["z",1,"a","3",2]);
if($a){var tb=function(p,B){return B||Od?oc(p)?"^"+Q.ToString(p):"string"===typeof p?"$"+p:"number"===typeof p?Wb?p:"n"+p:"boolean"===typeof p?"b"+p:null:null},P=function(){return Object.create?Object.create(null):{}},gb=function(p,B,G){if(ia(G)||Bb.string(G))Ea(G,function(Y){if(!Q.TypeIsObject(Y))throw new TypeError("Iterator value "+Y+" is not an entry object");B.set(Y[0],Y[1])});else if(G instanceof p)V(p.prototype.forEach,G,function(Y,ca){B.set(ca,Y)});else{if(!oc(G)){var z=B.set;if(!Q.IsCallable(z))throw new TypeError("bad map");
var K=Q.GetIterator(G)}if("undefined"!==typeof K)for(;;){p=Q.IteratorStep(K);if(!1===p)break;p=p.value;try{if(!Q.TypeIsObject(p))throw new TypeError("Iterator value "+p+" is not an entry object");V(z,B,p[0],p[1])}catch(Y){throw Q.IteratorClose(K,!0),Y;}}}},ib=function(p,B,G){if(ia(G)||Bb.string(G))Ea(G,function(Y){B.add(Y)});else if(G instanceof p)V(p.prototype.forEach,G,function(Y){B.add(Y)});else{if(!oc(G)){var z=B.add;if(!Q.IsCallable(z))throw new TypeError("bad set");var K=Q.GetIterator(G)}if("undefined"!==
typeof K)for(;;){p=Q.IteratorStep(K);if(!1===p)break;p=p.value;try{V(z,B,p)}catch(Y){throw Q.IteratorClose(K,!0),Y;}}}},E={Map:function(){var p={},B=function(ca,fa){this.key=ca;this.value=fa;this.prev=this.next=null};B.prototype.isRemoved=function(){return this.key===p};var G=function(ca,fa){if(!Q.TypeIsObject(ca)||!ca._es6map)throw new TypeError("Method Map.prototype."+fa+" called on incompatible receiver "+Q.ToString(ca));},z=function(ca,fa){G(ca,"[[MapIterator]]");this.i=this.head=ca._head;this.kind=
fa};z.prototype={isMapIterator:!0,next:function(){if(!this.isMapIterator)throw new TypeError("Not a MapIterator");var ca=this.i,fa=this.kind,sa=this.head;if("undefined"===typeof this.i)return $b();for(;ca.isRemoved()&&ca!==sa;)ca=ca.prev;for(;ca.next!==sa;)if(ca=ca.next,!ca.isRemoved())return fa="key"===fa?ca.key:"value"===fa?ca.value:[ca.key,ca.value],this.i=ca,$b(fa);this.i=void 0;return $b()}};L(z.prototype);var K=function fa(){if(!(this instanceof fa))throw new TypeError('Constructor Map requires "new"');
if(this&&this._es6map)throw new TypeError("Bad construction");var sa=ya(this,fa,Y,{_es6map:!0,_head:null,_map:ha?new ha:null,_size:0,_storage:P()}),Ga=new B(null,null);Ga.next=Ga.prev=Ga;sa._head=Ga;0<arguments.length&&gb(fa,sa,arguments[0]);return sa};var Y=K.prototype;Ua.getter(Y,"size",function(){if("undefined"===typeof this._size)throw new TypeError("size method called on incompatible Map");return this._size});hb(Y,{get:function(fa){G(this,"get");var sa=tb(fa,!0);if(null!==sa){if(fa=this._storage[sa])return fa.value}else if(this._map){if(fa=
Xa.call(this._map,fa))return fa.value}else for(var Ga=sa=this._head;(Ga=Ga.next)!==sa;)if(Q.SameValueZero(Ga.key,fa))return Ga.value},has:function(fa){G(this,"has");var sa=tb(fa,!0);if(null!==sa)return"undefined"!==typeof this._storage[sa];if(this._map)return ja.call(this._map,fa);for(var Ga=sa=this._head;(Ga=Ga.next)!==sa;)if(Q.SameValueZero(Ga.key,fa))return!0;return!1},set:function(fa,sa){G(this,"set");var Ga=this._head,eb=Ga,Ec=tb(fa,!0);if(null!==Ec){if("undefined"!==typeof this._storage[Ec])return this._storage[Ec].value=
sa,this;var Lb=this._storage[Ec]=new B(fa,sa);eb=Ga.prev}else this._map&&(ja.call(this._map,fa)?Xa.call(this._map,fa).value=sa:(Lb=new B(fa,sa),zb.call(this._map,fa,Lb),eb=Ga.prev));for(;(eb=eb.next)!==Ga;)if(Q.SameValueZero(eb.key,fa))return eb.value=sa,this;Lb=Lb||new B(fa,sa);Q.SameValue(-0,fa)&&(Lb.key=0);Lb.next=this._head;Lb.prev=this._head.prev;Lb.prev.next=Lb;Lb.next.prev=Lb;this._size+=1;return this},"delete":function(fa){G(this,"delete");var sa=this._head,Ga=sa,eb=tb(fa,!0);if(null!==eb){if("undefined"===
typeof this._storage[eb])return!1;Ga=this._storage[eb].prev;delete this._storage[eb]}else if(this._map){if(!ja.call(this._map,fa))return!1;Ga=Xa.call(this._map,fa).prev;Fa.call(this._map,fa)}for(;(Ga=Ga.next)!==sa;)if(Q.SameValueZero(Ga.key,fa))return Ga.key=p,Ga.value=p,Ga.prev.next=Ga.next,Ga.next.prev=Ga.prev,--this._size,!0;return!1},clear:function(){G(this,"clear");this._map=ha?new ha:null;this._size=0;this._storage=P();for(var fa=this._head,sa,Ga=fa.next;(sa=Ga)!==fa;)sa.key=p,sa.value=p,Ga=
sa.next,sa.next=sa.prev=fa;fa.next=fa.prev=fa},keys:function(){G(this,"keys");return new z(this,"key")},values:function(){G(this,"values");return new z(this,"value")},entries:function(){G(this,"entries");return new z(this,"key+value")},forEach:function(fa){G(this,"forEach");for(var sa=1<arguments.length?arguments[1]:null,Ga=this.entries(),eb=Ga.next();!eb.done;eb=Ga.next())sa?V(fa,sa,eb.value[1],eb.value[0],this):fa(eb.value[1],eb.value[0],this)}});L(Y,Y.entries);return K}(),Set:function(){var p=
function(Y,ca){if(!Q.TypeIsObject(Y)||!Y._es6set||"undefined"===typeof Y._storage)throw new TypeError("Set.prototype."+ca+" called on incompatible receiver "+Q.ToString(Y));},B=function ca(){if(!(this instanceof ca))throw new TypeError('Constructor Set requires "new"');if(this&&this._es6set)throw new TypeError("Bad construction");var fa=ya(this,ca,G,{_es6set:!0,"[[SetData]]":null,_storage:P()});if(!fa._es6set)throw new TypeError("bad set");0<arguments.length&&ib(ca,fa,arguments[0]);return fa};var G=
B.prototype;var z=function(ca){if(!ca["[[SetData]]"]){var fa=new E.Map;ca["[[SetData]]"]=fa;Ea(va(ca._storage),function(sa){if("^null"===sa)sa=null;else if("^undefined"!==sa){var Ga=sa.charAt(0);sa="$"===Ga?Db(sa,1):"n"===Ga?+Db(sa,1):"b"===Ga?"btrue"===sa:+sa}else sa=void 0;fa.set(sa,sa)});ca["[[SetData]]"]=fa}ca._storage=null};Ua.getter(B.prototype,"size",function(){p(this,"size");if(this._storage)return va(this._storage).length;z(this);return this["[[SetData]]"].size});hb(B.prototype,{has:function(ca){p(this,
"has");var fa;if(this._storage&&null!==(fa=tb(ca)))return!!this._storage[fa];z(this);return this["[[SetData]]"].has(ca)},add:function(ca){p(this,"add");var fa;if(this._storage&&null!==(fa=tb(ca)))return this._storage[fa]=!0,this;z(this);this["[[SetData]]"].set(ca,ca);return this},"delete":function(ca){p(this,"delete");var fa;if(this._storage&&null!==(fa=tb(ca)))return ca=X(this._storage,fa),delete this._storage[fa]&&ca;z(this);return this["[[SetData]]"]["delete"](ca)},clear:function(){p(this,"clear");
this._storage&&(this._storage=P());this["[[SetData]]"]&&this["[[SetData]]"].clear()},values:function(){p(this,"values");z(this);return new K(this["[[SetData]]"].values())},entries:function(){p(this,"entries");z(this);return new K(this["[[SetData]]"].entries())},forEach:function(ca){p(this,"forEach");var fa=1<arguments.length?arguments[1]:null,sa=this;z(sa);this["[[SetData]]"].forEach(function(Ga,eb){fa?V(ca,fa,eb,eb,sa):ca(eb,eb,sa)})}});Da(B.prototype,"keys",B.prototype.values,!0);L(B.prototype,
B.prototype.values);var K=function(ca){this.it=ca};K.prototype={isSetIterator:!0,next:function(){if(!this.isSetIterator)throw new TypeError("Not a SetIterator");return this.it.next()}};L(K.prototype);return B}()};T.Set&&!Set.prototype["delete"]&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys)&&(T.Set=E.Set);if(T.Map||T.Set){Pa(function(){return 2===(new Map([[1,2]])).get(1)})||(T.Map=function B(){if(!(this instanceof B))throw new TypeError('Constructor Map requires "new"');
var G=new ha;0<arguments.length&&gb(B,G,arguments[0]);delete G.constructor;Object.setPrototypeOf(G,T.Map.prototype);return G},T.Map.prototype=Ya(ha.prototype),Da(T.Map.prototype,"constructor",T.Map,!0),Ua.preserveToString(T.Map,ha));var yc=new Map,Pd=function(){var p=new Map([[1,0],[2,0],[3,0],[4,0]]);p.set(-0,p);return p.get(0)===p&&p.get(-0)===p&&p.has(0)&&p.has(-0)}(),pe=yc.set(1,2)===yc;Pd&&pe||za(Map.prototype,"set",function(p,B){V(zb,this,0===p?0:p,B);return this});Pd||(hb(Map.prototype,{get:function(p){return V(Xa,
this,0===p?0:p)},has:function(p){return V(ja,this,0===p?0:p)}},!0),Ua.preserveToString(Map.prototype.get,Xa),Ua.preserveToString(Map.prototype.has,ja));var hc=new Set,Qd=Set.prototype["delete"]&&Set.prototype.add&&Set.prototype.has&&function(p){p["delete"](0);p.add(-0);return!p.has(0)}(hc),yd=hc.add(1)===hc;if(!Qd||!yd){var qe=Set.prototype.add;Set.prototype.add=function(p){V(qe,this,0===p?0:p);return this};Ua.preserveToString(Set.prototype.add,qe)}if(!Qd){var jd=Set.prototype.has;Set.prototype.has=
function(p){return V(jd,this,0===p?0:p)};Ua.preserveToString(Set.prototype.has,jd);var Gc=Set.prototype["delete"];Set.prototype["delete"]=function(p){return V(Gc,this,0===p?0:p)};Ua.preserveToString(Set.prototype["delete"],Gc)}var zd=db(T.Map,function(p){var B=new p([]);B.set(42,42);return B instanceof p}),Mb=Object.setPrototypeOf&&!zd;try{var Rd=!(T.Map()instanceof T.Map)}catch(p){Rd=p instanceof TypeError}if(0!==T.Map.length||Mb||!Rd)T.Map=function B(){if(!(this instanceof B))throw new TypeError('Constructor Map requires "new"');
var G=new ha;0<arguments.length&&gb(B,G,arguments[0]);delete G.constructor;Object.setPrototypeOf(G,B.prototype);return G},T.Map.prototype=ha.prototype,Da(T.Map.prototype,"constructor",T.Map,!0),Ua.preserveToString(T.Map,ha);var Sd=db(T.Set,function(p){var B=new p([]);B.add(42,42);return B instanceof p}),ab=Object.setPrototypeOf&&!Sd;try{var qb=!(T.Set()instanceof T.Set)}catch(p){qb=p instanceof TypeError}if(0!==T.Set.length||ab||!qb){var Td=T.Set;T.Set=function B(){if(!(this instanceof B))throw new TypeError('Constructor Set requires "new"');
var G=new Td;0<arguments.length&&ib(B,G,arguments[0]);delete G.constructor;Object.setPrototypeOf(G,B.prototype);return G};T.Set.prototype=Td.prototype;Da(T.Set.prototype,"constructor",T.Set,!0);Ua.preserveToString(T.Set,Td)}var Ud=new T.Map,ic=!Pa(function(){return Ud.keys().next().done});("function"!==typeof T.Map.prototype.clear||0!==(new T.Set).size||0!==Ud.size||"function"!==typeof T.Map.prototype.keys||"function"!==typeof T.Set.prototype.keys||"function"!==typeof T.Map.prototype.forEach||"function"!==
typeof T.Set.prototype.forEach||sb(T.Map)||sb(T.Set)||"function"!==typeof Ud.keys().next||ic||!zd)&&hb(T,{Map:E.Map,Set:E.Set},!0);T.Set.prototype.keys!==T.Set.prototype.values&&Da(T.Set.prototype,"keys",T.Set.prototype.values,!0);L(Object.getPrototypeOf((new T.Map).keys()));L(Object.getPrototypeOf((new T.Set).keys()));if(aa&&"has"!==T.Set.prototype.has.name){var Hc=T.Set.prototype.has;za(T.Set.prototype,"has",function(p){return V(Hc,this,p)})}}hb(T,E);Cc(T.Map);Cc(T.Set)}var Nb=function(p){if(!Q.TypeIsObject(p))throw new TypeError("target must be an object");
},Xb={apply:function(){return Q.Call(Q.Call,null,arguments)},construct:function(p,B){if(!Q.IsConstructor(p))throw new TypeError("First argument must be a constructor.");var G=2<arguments.length?arguments[2]:p;if(!Q.IsConstructor(G))throw new TypeError("new.target must be a constructor.");return Q.Construct(p,B,G,"internal")},deleteProperty:function(p,B){Nb(p);if($a){var G=Object.getOwnPropertyDescriptor(p,B);if(G&&!G.configurable)return!1}return delete p[B]},has:function(p,B){Nb(p);return B in p}};
Object.getOwnPropertyNames&&Object.assign(Xb,{ownKeys:function(p){Nb(p);var B=Object.getOwnPropertyNames(p);Q.IsCallable(Object.getOwnPropertySymbols)&&Cb(B,Object.getOwnPropertySymbols(p));return B}});Object.preventExtensions&&Object.assign(Xb,{isExtensible:function(p){Nb(p);return Object.isExtensible(p)},preventExtensions:function(p){Nb(p);return!xa(function(){return Object.preventExtensions(p)})}});if($a){var Vd=function(p,B,G){var z=Object.getOwnPropertyDescriptor(p,B);if(!z)return p=Object.getPrototypeOf(p),
null===p?void 0:Vd(p,B,G);if("value"in z)return z.value;if(z.get)return Q.Call(z.get,G)},Ze=function(p,B,G,z){var K=Object.getOwnPropertyDescriptor(p,B);if(!K){p=Object.getPrototypeOf(p);if(null!==p)return Ze(p,B,G,z);K={value:void 0,writable:!0,enumerable:!0,configurable:!0}}return"value"in K?K.writable&&Q.TypeIsObject(z)?Object.getOwnPropertyDescriptor(z,B)?Bc.defineProperty(z,B,{value:G}):Bc.defineProperty(z,B,{value:G,writable:!0,enumerable:!0,configurable:!0}):!1:K.set?(V(K.set,z,G),!0):!1};
Object.assign(Xb,{defineProperty:function(p,B,G){Nb(p);return!xa(function(){return Object.defineProperty(p,B,G)})},getOwnPropertyDescriptor:function(p,B){Nb(p);return Object.getOwnPropertyDescriptor(p,B)},get:function(p,B){Nb(p);return Vd(p,B,2<arguments.length?arguments[2]:p)},set:function(p,B,G){Nb(p);return Ze(p,B,G,3<arguments.length?arguments[3]:p)}})}if(Object.getPrototypeOf){var n=Object.getPrototypeOf;Xb.getPrototypeOf=function(p){Nb(p);return n(p)}}Object.setPrototypeOf&&Xb.getPrototypeOf&&
Object.assign(Xb,{setPrototypeOf:function(p,B){Nb(p);if(null!==B&&!Q.TypeIsObject(B))throw new TypeError("proto must be an object or null");if(B===Bc.getPrototypeOf(p))return!0;if(Bc.isExtensible&&!Bc.isExtensible(p))return!1;var G;a:{for(G=B;G;){if(p===G){G=!0;break a}G=Xb.getPrototypeOf(G)}G=!1}if(G)return!1;Object.setPrototypeOf(p,B);return!0}});var re=function(p,B){Q.IsCallable(T.Reflect[p])?Pa(function(){T.Reflect[p](1);T.Reflect[p](NaN);T.Reflect[p](!0);return!0})&&za(T.Reflect,p,B):Da(T.Reflect,
p,B)};Object.keys(Xb).forEach(function(p){re(p,Xb[p])});var se=T.Reflect.getPrototypeOf;aa&&se&&"getPrototypeOf"!==se.name&&za(T.Reflect,"getPrototypeOf",function(p){return V(se,T.Reflect,p)});T.Reflect.setPrototypeOf&&Pa(function(){T.Reflect.setPrototypeOf(1,{});return!0})&&za(T.Reflect,"setPrototypeOf",Xb.setPrototypeOf);T.Reflect.defineProperty&&(Pa(function(){var p=!T.Reflect.defineProperty(1,"test",{value:1}),B="function"!==typeof Object.preventExtensions||!T.Reflect.defineProperty(Object.preventExtensions({}),
"test",{});return p&&B})||za(T.Reflect,"defineProperty",Xb.defineProperty));T.Reflect.construct&&(Pa(function(){var p=function(){};return T.Reflect.construct(function(){},[],p)instanceof p})||za(T.Reflect,"construct",Xb.construct));if("Invalid Date"!==String(new Date(NaN))){var te=Date.prototype.toString;za(Date.prototype,"toString",function(){var p=+this;return p!==p?"Invalid Date":Q.Call(te,this)})}var $e={anchor:function(p){return Q.CreateHTML(this,"a","name",p)},big:function(){return Q.CreateHTML(this,
"big","","")},blink:function(){return Q.CreateHTML(this,"blink","","")},bold:function(){return Q.CreateHTML(this,"b","","")},fixed:function(){return Q.CreateHTML(this,"tt","","")},fontcolor:function(p){return Q.CreateHTML(this,"font","color",p)},fontsize:function(p){return Q.CreateHTML(this,"font","size",p)},italics:function(){return Q.CreateHTML(this,"i","","")},link:function(p){return Q.CreateHTML(this,"a","href",p)},small:function(){return Q.CreateHTML(this,"small","","")},strike:function(){return Q.CreateHTML(this,
"strike","","")},sub:function(){return Q.CreateHTML(this,"sub","","")},sup:function(){return Q.CreateHTML(this,"sup","","")}};Ea(Object.keys($e),function(p){var B=String.prototype[p];if(Q.IsCallable(B)){B=V(B,"",' " ');var G=Jb([],B.match(/"/g)).length;B=B!==B.toLowerCase()||2<G}else B=!0;B&&za(String.prototype,p,$e[p])});var rf=function(){if(!Ac)return!1;var p="object"===typeof JSON&&"function"===typeof JSON.stringify?JSON.stringify:null;if(!p)return!1;if("undefined"!==typeof p(Ma())||"[null]"!==
p([Ma()]))return!0;var B={a:Ma()};B[Ma()]=!0;return"{}"!==p(B)?!0:!1}(),h=Pa(function(){return Ac?"{}"===JSON.stringify(Object(Ma()))&&"[{}]"===JSON.stringify([Object(Ma())]):!0});if(rf||!h){var Ia=JSON.stringify;za(JSON,"stringify",function(p){if("symbol"!==typeof p){var B;1<arguments.length&&(B=arguments[1]);var G=[p];if(ia(B))G.push(B);else{var z=Q.IsCallable(B)?B:null;G.push(function(K,Y){K=z?V(z,this,K,Y):Y;if("symbol"!==typeof K)return Bb.symbol(K)?Qc({})(K):K})}2<arguments.length&&G.push(arguments[2]);
return Ia.apply(this,G)}})}return T});
var CindyJS=function(){function J(aa){if(0===ia)return console.error("Waiting for "+aa+" after we finished waiting."),function(){};0>ia&&(ia=0);++ia;return function(){--ia;0>ia&&console.error("Wait count mismatch: "+aa);if(0===ia)for(var Ea=0,Ta=va.length;Ea<Ta;)va[Ea++].startup()}}function V(aa){var Ea=V.newInstance(aa);0>=ia?Ea.startup():!1!==aa.autostart&&va.push(Ea);return Ea}var ia=-1,va=[];Math.sign||(Math.sign=function(aa){return(0<aa)-(0>aa)||+aa});"undefined"===typeof document||"undefined"===
typeof window||"undefined"===typeof document.addEventListener||"undefined"!==typeof window.cindyDontWait&&!0===window.cindyDontWait||document.addEventListener("DOMContentLoaded",J("DOMContentLoaded"));var xa=null,Pa=null,sb={};V.getBaseDir=function(){if(null!==xa)return xa;for(var aa=document.getElementsByTagName("script"),Ea=0;Ea<aa.length;++Ea){var Ta=aa[Ea],jb=Ta.src;if(jb){var mb=/Cindy\.js$/.exec(jb);if(mb)return xa=jb.substr(0,mb.index),console.log("Will load extensions from "+xa),Pa=Ta,xa}}console.error("Could not find <script> tag for Cindy.js");
return xa=Pa=!1};V.addNewScript=function(aa,Ea){Ea||console.error.bind(console);var Ta=V.getBaseDir();if(!1===Ta)return!1;Ea=document.createElement("script");Ea.src=Ta+aa;aa=Pa.nextSibling;Ta=Pa.parentElement;aa?Ta.insertBefore(Ea,aa):Ta.appendChild(Ea);return Ea};V.loadScript=function(aa,Ea,Ta,jb){for(var mb=String(aa).split("."),Da=window;mb.length&&"object"===typeof Da&&null!==Da;)Da=Da[mb.shift()];if(Da&&!mb.length)return Ta(),!0;jb||(jb=console.error.bind(console));mb=sb[aa];if(!mb){mb=V.addNewScript(Ea,
jb);if(!1===mb)return jb("Can't load additional components."),!1;sb[aa]=mb}mb.addEventListener("load",Ta);mb.addEventListener("error",jb);return null};V._autoLoadingPlugin={};V.autoLoadPlugin=function(aa,Ea,Ta){if(V._pluginRegistry[aa])return Ta(),!0;var jb=V._autoLoadingPlugin[aa];if(!jb){Ea||(Ea=aa+"-plugin.js");jb=V._autoLoadingPlugin[aa]=[];aa=V.addNewScript(Ea);if(!1===aa)return!1;aa.addEventListener("error",console.error.bind(console))}jb.push(Ta);return null};var A={ctype:"undefined"};V.waitFor=
J;V._pluginRegistry={};V.instances=[];V.registerPlugin=function(aa,Ea,Ta){if(1!==aa)return console.error("Plugin API version "+aa+" not supported"),!1;V._pluginRegistry[Ea]=Ta;(V._autoLoadingPlugin[Ea]||[]).forEach(function(jb){jb()})};var $a=0;V.dumpState=function(aa){aa=V.instances[aa||0].saveState();console.log(JSON.stringify(aa))};V.debugState=function(aa){V.instances.map(function(Ea){var Ta=Ea.config;Ta=JSON.parse(JSON.stringify(Ta));var jb=Ea.saveState();console.log(JSON.stringify(jb));for(var mb in jb)Ta[mb]=
jb[mb];Ea.shutdown();return Ta}).forEach(function(Ea){V(Ea)})};V.newInstance=function(aa){function Ea(){fb.width=gb=fb.clientWidth;fb.height=ib=fb.clientHeight;pb=1;if(Md||Nd)pb=Math.max(Md?Md/fb.width:0,Nd?Nd/fb.height:0),gb=pb*fb.clientWidth,ib=pb*fb.clientHeight;P.setTransform(1/pb,0,0,1/pb,0,0);O.setMat(25,0,0,25,250.5,250.5);if(Od)for(var a of Od){var b=Object.keys(a)[0];"scale"===b&&(Ld=a.scale,O[b](a.scale));if("translate"===b)O[b](a.translate[0],a.translate[1]);"scaleAndOrigin"===b&&(Ld=a[b][0]/
25,O[b].apply(null,a[b]));"visibleRect"===b&&(O[b].apply(null,a[b]),Ld=O.drawingstate.initialmatrix.a/25)}O.createnewbackup();O.greset();a=1;"undefined"!==typeof window&&window.devicePixelRatio&&(a=window.devicePixelRatio);b=P.webkitBackingStorePixelRatio||P.mozBackingStorePixelRatio||P.msBackingStorePixelRatio||P.oBackingStorePixelRatio||P.backingStorePixelRatio||1;a!==b&&(a/=b,fb.width=gb*a,fb.height=ib*a,P.scale(a,a))}function Ta(a){let b;if("canvas"!==a.tagName.toLowerCase())for(b=a,fb=document.createElement("canvas");b.firstChild;)b.removeChild(b.firstChild);
else{fb=a;b=document.createElement("div");let c=null,d=null;Array.prototype.slice.call(fb.attributes).forEach(function(f){"width"===f.name?c=f.value:"height"===f.name?d=f.value:b.setAttributeNodeNS(fb.removeAttributeNode(f))});null===c||b.style.width||(b.style.width=c+"px");null===d||b.style.height||(b.style.height=d+"px");fb.parentNode.replaceChild(b,fb)}b.classList.add("CindyJS-widget");a=fb.style;a.position="absolute";a.border="none";a.margin=a.padding=a.left=a.top="0px";a.width=a.height="100%";
a="static";window.getComputedStyle&&(a=window.getComputedStyle(b).getPropertyValue("position"),a=String(a||"static"));"static"===a&&(b.style.position="relative");b.appendChild(fb);return fb}function jb(){const a=aa.cinderella;if(!a||!a.version)return!1;for(let b=0;b<arguments.length;++b){const c=a.version[b],d=arguments[b];if(c!==d)return typeof c===typeof d&&c<d}return!1}function mb(){return $jscomp.asyncExecutePromiseGeneratorFunction(function*(){Rd=!0;if(0===Sd){if(aa.exclusive)for(m=Ob.instances.length;0<
m;)Ob.instances[--m].shutdown();void 0!==aa.csconsole&&(Kb=aa.csconsole);Kb=null===Kb?new nd:!0===Kb?new Cb:"string"===typeof Kb?new Ab(Kb):"object"===typeof Kb&&"function"===typeof Kb.appendChild?new Ab(Kb):new nd;tb=[100,100];var a=null;Od=aa.transform;if(aa.ports&&0<aa.ports.length){m=aa.ports[0];(a=m.element)||(a=document.getElementById(m.id));a=Ta(a);var b=a.parentNode.style;"window"===m.fill?(b.width="100vw",b.height="100vh"):"parent"===m.fill?(b.width="100%",b.height="100%"):m.width&&m.height&&
(b.width=m.width+"px",b.height=m.height+"px");m.virtualwidth&&(Md=m.virtualwidth);m.virtualheight&&(Nd=m.virtualheight);m.background&&(a.style.backgroundColor=m.background);void 0!==m.transform&&(Od=m.transform);Wb(m.grid)&&0<m.grid&&(Rb=m.grid);Wb(m.tgrid)&&0<m.tgrid&&(oe=m.tgrid);m.snap&&(Vc=!0);Number.isFinite(m.snapdistance)&&(id=Math.max(m.snapdistance,0));m.axes&&(xd=!0)}a||(a=aa.canvas,a||"undefined"===typeof document||(a=document.getElementById(aa.canvasname))&&(a=Ta(a)));a&&(fb=a,P=a.getContext("2d"),
Ea(),P.setLineDash||(P.setLineDash=function(){}),(aa.animation?aa.animation.controls:aa.animcontrols)&&u(aa),aa.animation&&Wb(aa.animation.speed)&&(void 0===aa.animation.accuracy&&jb(2,9,1875)?Ua(.5*aa.animation.speed):Ua(aa.animation.speed)),aa.animation&&Wb(aa.animation.accuracy)&&(Uc=aa.animation.accuracy));aa.statusbar&&(Ec="string"===typeof aa.statusbar?document.getElementById(aa.statusbar):aa.statusbar);var c=aa.scripts,d=null;"string"===typeof c&&0<=c.search(/\*/)&&(d=c);"object"!==typeof c&&
(c=null);if(aa.import&&Array.isArray(aa.import)&&0<aa.import.length){m="csinit";if(aa.initscript)m=aa.initscript;else if(d)m=d.replace(/\*/,"init");else return;console.log("===== Importing CindyScript libraries to "+m+" =====");b="";for(var f of aa.import.reverse()){if("string"!==typeof f)continue;console.log("Loading "+f+" ...");let t=-1==f.search(/.+\.cjs$/)?f+".cjs":f;try{var k=yield fetch(t);if(200===k.status){let w=yield k.text();b=w+(";"==w[w.length-1]?"":";")+"\n"+b;console.log(f+" loaded!")}else console.log("CAUTION! Import of "+
f+" failed.")}catch(w){if("Failed to fetch"===w.message)console.log("CAUTION! Import of "+f+" failed."),console.log("This website seems to not run on a web server. CindyJS will continue without importing CindyScript libraries.");else throw w;}}f=Da(m);k=document.createTextNode(b);hb(f,k);console.log("===== Import of libraries to "+m+" finished ========")}"move keydown keyup keytyped keytype mousedown mouseup mousedrag mousemove mouseclick multidown multiup multidrag init tick draw simulationstep simulationstart simulationstop ondrop xrdraw xrinputsourceschange xrselectstart xrselectend xrselect xrselecthold xrsqueezestart xrsqueezeend xrsqueeze xrsqueezehold".split(" ").forEach(function(t){if(null!==
c&&c[t])var w=c[t];else{w=t+"script";if(aa[w])w=document.getElementById(aa[w]);else if(d){if(w=document.getElementById(d.replace(/\*/,t)),!w)return}else return;w=w.text}w=uc(w,!1);"error"===w.ctype?console.error("Error compiling "+t+" script: "+w.message):wa[t]=Ae(w,t)});jb(2,9,1888)&&!wa.keydown&&(wa.keydown=wa.keytyped,wa.keytyped=wa.keytype,wa.keytype=void 0);Wb(aa.grid)&&0<aa.grid&&(Rb=aa.grid);aa.snap&&(Vc=!0);Number.isFinite(aa.snapdistance)&&(id=Math.max(aa.snapdistance,0));E={};var m=0;yc=
{};aa.geometry||(aa.geometry=[]);ef(aa.geometry);aa.behavior||(aa.behavior=[]);"function"===typeof fd&&fd(aa.behavior);for(var q in aa.images)f=nb(aa.images[q],!1),f!==A&&(yc[q]=f);for(const t in aa.videos)q=nb(aa.videos[t],!0),q!==A&&(yc[t]=q);Mb.canvas=a;if(aa.oninit)aa.oninit(Mb);Ob.instances.push(Mb);aa.use&&aa.use.forEach(function(t){z.use$1([p.wrap(t)],{})});kd.convexhull3d$1&&db("QuickHull3D","QuickHull3D.js");(kd.colorplot$1||kd.colorplot$2||kd.colorplot$3||kd.colorplot$4)&&db("CindyGL","CindyGL.js");
(kd.playtone$1||kd.playmelody$1)&&db("midi","midi-plugin.js");T()}})}function Da(a){var b=document.getElementById(a);b||(b=document.createElement("script"),b.id=a,b.type="text/x-cindyscript",document.head.appendChild(b));return b}function hb(a,b){a.firstChild?a.insertBefore(b,a.firstChild):a.appendChild(b)}function nb(a,b){let c;"string"===typeof a?(b?(c=document.createElement("video"),c.preload="auto",c.loop=!0,c.setAttribute("playsinline",""),enableInlineVideo(c)):c=new Image,c.src=a):c=a;if(!c.tagName)return console.error("Not a valid image element",
c),A;const d={img:c,width:NaN,height:NaN,ready:!0,live:!1,generation:0,whenReady:Ya};a=c.tagName.toLowerCase();const f=[];if("img"===a)c.complete?(d.width=c.width,d.height=c.height):(d.ready=!1,c.addEventListener("load",function(){d.width=c.width;d.height=c.height;d.ready=!0;d.whenReady=Ya;f.forEach(Ya);x()}),d.whenReady=f.push.bind(f));else if("video"===a)d.live=!0,c.readyState>=c.HAVE_METADATA?(d.width=c.videoWidth,d.height=c.videoHeight):(d.ready=!1,c.addEventListener("loadedmetadata",function(){d.width=
c.videoWidth;d.height=c.videoHeight;d.ready=!0;d.whenReady=Ya;f.forEach(Ya);x()}),d.whenReady=f.push.bind(f));else if("canvas"===a)d.width=c.width,d.height=c.height;else return console.error("Not a valid image element",a,c),A;return{ctype:"image",value:d}}function u(a){function b(C,F){const H=document.createElement("button"),R=document.createElement("img");H.appendChild(R);w.appendChild(H);yd(R,C);H.addEventListener("click",F);hc[C]=function(S){S?H.classList.add("CindyJS-active"):H.classList.remove("CindyJS-active")}}
function c(C){if(y){var F=q.getBoundingClientRect();Ua(m*(C.clientX-F.left-q.clientLeft+.5)/F.width+f)}}const d=document.createElement("div");d.className="CindyJS-animcontrols";fb.parentNode.appendChild(d);let f=0,k=1,m=1;a.animation&&a.animation.speedRange&&Wb(a.animation.speedRange[0])&&Wb(a.animation.speedRange[1])&&(f=a.animation.speedRange[0],k=a.animation.speedRange[1],m=k-f);const q=document.createElement("div");q.className="CindyJS-animspeed";d.appendChild(q);const t=document.createElement("div");
q.appendChild(t);e(q,"mousedown",function(C){y=!0;c(C)});e(q,"mousemove",c);e(fb.parentNode,"mouseup",function(C){y=!1},!0);const w=document.createElement("div");w.className="CindyJS-animbuttons";d.appendChild(w);b("play",Ca);b("pause",Gb);b("stop",Jb);hc.stop(!0);Qd=function(C){C=(C-f)/m;C=Math.max(0,Math.min(1,C));C=.1*Math.round(1E3*C);t.style.width=C+"%"};let y=!1}function Ua(a){Ve=a;Qd&&Qd(a)}function Ya(a){return a()}function db(a,b,c){let d=null;aa.plugins&&(d=aa.plugins[a]);d||(d=Ob._pluginRegistry[a]);
d?z.use$1([p.wrap(a)],{}):(++qe,Ob.autoLoadPlugin(a,b,function(){z.use$1([p.wrap(a)],{});T(c)}))}function T(a){0===--qe&&(a?x():(L(wa.init),(aa.animation||aa).autoplay&&Ca(),Mb.canvas&&g(Mb.canvas,aa)))}function ua(){null!==jd&&(Eb.set(jd.state),Object.keys(jd.speeds).forEach(function(a){const b=E.csnames[a];"undefined"!==typeof b.behavior&&(a=jd.speeds[a],b.behavior.vx=a[0],b.behavior.vy=a[1],b.behavior.vz=a[2],b.behavior.fx=0,b.behavior.fy=0,b.behavior.fz=0)}),Qe())}function Ca(){if(!xc){if(Kd){const a=
Lc.backup;a.set(Eb);const b={};for(const c of E.points)"undefined"!==typeof c.behavior&&(b[c.name]=[c.behavior.vx,c.behavior.vy,c.behavior.vz]);jd={state:a,speeds:b};gd=0;Kd=!1;hc.stop(!1)}else hc.pause(!1);We=Date.now();hc.play(!0);"function"===typeof fd&&sf&&ed();xc=!0;L(wa.simulationstart);x()}}function Gb(){xc&&(hc.play(!1),hc.pause(!0),xc=!1)}function Jb(){Kd||(xc?(L(wa.simulationstop),xc=!1,hc.play(!1)):hc.pause(!1),hc.stop(!0),Kd=!0,ua())}function Db(){if(!zd){zd=!0;for(var a=Ob.instances.length;0<
a;)if(Ob.instances[--a]===Mb){Ob.instances.splice(a,1);break}for(a=Gc.length;0<a;)try{Gc[--a]()}catch(b){console.error(b)}}}function Hb(a){this.in=function(b,c){console.log(b);c?this.append(this.createTextNode("span","blue",b)):this.append(this.createTextNode("p","blue",b))};this.out=function(b,c){console.log(b);c?this.append(this.createTextNode("span","red",b)):this.append(this.createTextNode("p","red",b))};this.err=function(b,c){console.log(b);c?this.append(this.createTextNode("span","red",b)):
this.append(this.createTextNode("p","red",b))};this.createTextNode=function(b,c,d){return"undefined"!==typeof document?(b=document.createElement(b),b.appendChild(document.createTextNode(d)),b.style.color=c,b):d+"\n"}}function Cb(){const a=this;let b;const c=document.createElement("div");let d;c.innerHTML='<div id="console" style="border-top: 1px solid #333333; bottom: 0px; position: absolute; width: 100%;"><div id="log" style="height: 150px; overflow-y: auto;"></div><input id="cmd" type="text" style="box-sizing: border-box; height: 30px; width: 100%;"></div>';
document.body.appendChild(c);b=document.getElementById("cmd");d=document.getElementById("log");b.onkeydown=function(f){13===f.keyCode&&""!==b.value&&(a.in(b.value),f=z.parse$1([p.wrap(b.value)],[]),f=L(f),console.log(ja(f)),"undefined"!==f.ctype&&Kb.out(ja(f)),b.value="",d.scrollTop=d.scrollHeight)};this.append=function(f){d.appendChild(f)};this.clear=function(){d.innerHTML=""}}function Ab(a){let b=a;"string"===typeof a&&(b=document.getElementById(a));this.append=function(c){b.appendChild(c)};this.clear=
function(){b.innerHTML=""}}function nd(){this.append=function(a){};this.clear=function(){}}function e(a,b,c,d){void 0===d&&(d=!1);Gc.push(function(){a.removeEventListener(b,c,d)});a.addEventListener(b,c,d)}function g(a,b){function c(y,C){for(let H of y.changedTouches)if(y=f(H.identifier),C||Hc[y]){var F=a.getBoundingClientRect();F=O.to(H.clientX-F.left-a.clientLeft+.5,H.clientY-F.top-a.clientTop+.5);Hc[y]=[F[0],F[1]]}x()}function d(y){const C=a.getBoundingClientRect();y=O.to(y.clientX-C.left-a.clientLeft+
.5,y.clientY-C.top-a.clientTop+.5);ab.prevx=ab.x;ab.prevy=ab.y;ab.x=y[0];ab.y=y[1];tb[0]=ab.x;tb[1]=ab.y;x()}function f(y){if(Nb.hasOwnProperty(y))return Nb[y];let C=Object.values(Nb);C=C.sort((H,R)=>H-R);let F=!1;for(let H in C)!F&&C[H]>(H|0)+1&&(Nb[y]=(H|0)+1,F=!0);F||(Nb[y]=C.length+1);return Nb[y]}function k(y){const C=y.changedTouches;c(y,!1);for(var F=0;F<y.changedTouches.length;F++)ic=f(y.changedTouches[F].identifier),ha(ic),delete Nb[y.changedTouches[F].identifier];F=!1;for(var H=0;H<C.length;H++)C[H].identifier===
w&&(F=!0);F&&(w=-1,ab.down=!1,qb=void 0,L(wa.mouseup),Zc("mouseup"),t||L(wa.mouseclick),x(),y.preventDefault())}let m=null,q=null,t=!1;"undefined"!==typeof MutationObserver&&(m=MutationObserver);m||"undefined"===typeof WebKitMutationObserver||(m=WebKitMutationObserver);m?(m=new m(function(y){document.body.contains(a)||Db()}),m.observe(document.documentElement,{childList:!0,subtree:!0}),Gc.push(function(){m.disconnect()})):(e(a,"DOMNodeRemovedFromDocument",Db),e(a,"DOMNodeRemoved",Db));if(!0===b.keylistener)e(document,
"keydown",function(y){X(y,wa.keydown);return!1}),e(document,"keyup",function(y){X(y,wa.keyup);return!1}),e(document,"keypress",function(y){X(y,wa.keytyped);return!1});else if(wa.keydown||wa.keyup||wa.keytyped)a.setAttribute("tabindex","0"),e(a,"mousedown",function(){a.focus()}),e(a,"keydown",function(y){9!==y.keyCode&&(X(y,wa.keydown),wa.keytyped||y.preventDefault())}),e(a,"keyup",function(y){X(y,wa.keyup);y.preventDefault()}),e(a,"keypress",function(y){9!==y.keyCode&&(X(y,wa.keytyped),y.preventDefault())});
e(a,"mousedown",function(y){q=y;t=!1;ab.button=y.which;d(y);ea(0);L(wa.mousedown);Zc("mousedown");ab.down=!0;y.preventDefault()});e(a,"mouseup",function(y){ab.down=!1;qb=void 0;L(wa.mouseup);ha(0);Zc("mouseup");delete Hc[0];x();y.preventDefault()});e(a,"mousemove",function(y){d(y);ab.down?(q&&(2<Math.abs(q.clientX-y.clientX)||2<Math.abs(q.clientY-y.clientY))&&(t=!0),L(wa.mousedrag),Hc[0]&&(ic=0,L(wa.multidrag),ic=0)):L(wa.mousemove);Zc("mousemove");y.preventDefault()});e(a,"click",function(y){d(y);
t||L(wa.mouseclick);y.preventDefault()});e(a,"dragenter",function(y){y.preventDefault()});e(a,"dragover",function(y){y.preventDefault()});e(a,"drop",function(y){function C(ta,Ja){function Wa(){Ka.readyState===XMLHttpRequest.DONE&&(200!==Ka.status?(console.error("GET request for "+ta+" failed: "+(Ka.responseText||"(no error message)")),S(Ja,A)):H(Ja,Ka.responseText))}let Ra=ta.replace(/[?#][^]*/,"");Ra=Ra.replace(/[^]*\/([^\/])/,"$1");U[Ja]={type:"",name:Ra};let Ka=new XMLHttpRequest;Ka.onreadystatechange=
function(){if(Ka.readyState===XMLHttpRequest.DONE)if(200!==Ka.status)console.error("HEAD request for "+ta+" failed: "+(Ka.responseText||"(no error message)")),S(Ja,A);else{var Na=Ka.getResponseHeader("Content-Type");U[Ja].type=Na;/^image\//.test(Na)?R(Ja,ta):F(Na)?(Ka=new XMLHttpRequest,Ka.onreadystatechange=Wa,Ka.open("GET",ta),Ka.send()):S(Ja,A)}};Ka.open("HEAD",ta);Ka.send()}function F(ta){ta=ta.replace(/;[^]*/,"");return/^text\//.test(ta)?1:"application/json"===ta?2:0}function H(ta,Ja){switch(F(U[ta].type)){case 1:S(ta,
p.string(Ja));break;case 2:let Wa,Ra;try{Wa=JSON.parse(Ja),Ra=p.wrapJSON(Wa)}catch(Ka){console.error(Ka),Ra=A}S(ta,Ra);break;default:S(ta,A)}}function R(ta,Ja){const Wa=new Image;let Ra=!1;Wa.onload=function(){Ra||(Ra=!0,S(ta,nb(Wa,!1)))};Wa.onerror=function(Ka){Ra||(Ra=!0,console.error(Ka),S(ta,A))};Wa.src=Ja}function S(ta,Ja,Wa){pa[ta]=h.turnIntoCSList([Ja,p.string(Wa||Ja.ctype),p.string(U[ta].type),p.string(U[ta].name)]);0===--da&&(ta=Oa,Pd=h.turnIntoCSList(pa),pe=ta,L(wa.ondrop),pe=Pd=A,x())}
y.preventDefault();const Z=y.dataTransfer;let U=Z.files,pa=Array(U.length),da=U.length;const Ba=y.currentTarget.getBoundingClientRect(),Oa=h.realVector(O.to(y.clientX-Ba.left-a.clientLeft+.5,y.clientY-Ba.top-a.clientTop+.5));if(0<U.length)Array.prototype.forEach.call(U,function(ta,Ja){const Wa=new FileReader;F(ta.type)?(Wa.onload=function(){H(Ja,Wa.result)},Wa.readAsText(ta)):/^image\//.test(ta.type)?(Wa.onload=function(){R(Ja,Wa.result)},Wa.readAsDataURL(ta)):(console.log("Unknown MIME type: "+ta.type),
S(Ja,A))});else if(y=Z.getData("text/uri-list"))y=y.split("\n").filter(function(ta){return!/^\s*(#|$)/.test(ta)}),da=y.length,pa=Array(da),U=Array(da),y.forEach(C)});var w=-1;e(a,"touchstart",function(y){c(y,!0);for(var C=0;C<y.changedTouches.length;C++)ea(f(y.changedTouches[C].identifier));-1===w&&(C=y.changedTouches,0!==C.length&&(w=C[0].identifier,d(y.targetTouches[0]),L(wa.mousedown),ab.down=!0,q=y.targetTouches[0],t=!1,Zc("mousedown"),y.preventDefault()))},!1);e(a,"touchmove",function(y){c(y,
!1);for(var C=0;C<y.changedTouches.length;C++)ic=f(y.changedTouches[C].identifier),L(wa.multidrag),ic=0;C=y.changedTouches;let F=!1;for(var H=0;H<C.length;H++)C[H].identifier===w&&(F=!0);F&&(d(y.targetTouches[0]),ab.down?(q&&(2<Math.abs(q.clientX-y.targetTouches[0].clientX)||2<Math.abs(q.clientY-y.targetTouches[0].clientY))&&(t=!0),ic=f(w),L(wa.mousedrag)):L(wa.mousemove),Zc("mousemove"),y.preventDefault())},!0);e(a,"touchend",k,!1);"undefined"!==typeof document&&document.body&&e(document.body,"touchcancel",
k,!1);"undefined"!==typeof window&&e(window,"resize",function(){Xb(function(){Ea();x()})},!1);r(a.parentNode);x()}function l(a,b){const c=document.createElement("div");c.setAttribute("style",b);a.appendChild(c);return c}function r(a){function b(){d.scrollLeft=d.scrollTop=f.scrollLeft=f.scrollTop=1E5}function c(){if(k!==a.clientWidth||m!==a.clientHeight)k=a.clientWidth,m=a.clientHeight,q||(q=!0,Xb(function(){q=!1;Ea();x()}));b()}if("undefined"!==typeof document){var d=l(a,"position: absolute; transition: 0s; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;");
l(d,"position: absolute; transition: 0s; left: 0; top: 0; width: 100000px; height: 100000px");var f=l(a,"position: absolute; transition: 0s; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;");l(f,"position: absolute; transition: 0s; left: 0; top: 0; width: 200%; height: 200%");b();var k=a.clientWidth,m=a.clientHeight,q=!1;d.addEventListener("scroll",c);f.addEventListener("scroll",c)}}function x(){Vd||(Vd=Xb(D))}function D(){Vd=null;if(!zd){if(xc){var a=Date.now();
const b=Math.min(50,a-We)*Ve*qf;gd=a;a=gd+b;sf&&"undefined"!==typeof Yb&&Yb.tick(b);gd=a;xc&&L(wa.tick)}I();xc&&x()}}function I(){O.reset();P.save();P.clearRect(0,0,gb,ib);var a=O.drawingstate.matrix,b,c;if(0!==Rb){P.beginPath();P.strokeStyle="rgba(0,0,0,0.1)";P.lineWidth=1;P.lineCap="butt";var d=Rb*a.a;for(b=Math.ceil(-a.tx/d);(c=b*d+a.tx)<gb;){if(b||!xd)P.moveTo(c,0),P.lineTo(c,ib);b++}for(b=Math.floor(a.ty/d);(c=b*d-a.ty)<ib;){if(b||!xd)P.moveTo(0,c),P.lineTo(gb,c);b++}P.stroke()}if(0!==oe){P.beginPath();
P.strokeStyle="rgba(0,0,0,0.1)";P.lineWidth=1;P.lineCap="butt";d=oe*a.a;var f=Math.sqrt(3);var k=a.ty/f;var m=(ib+a.ty)/f;for(b=Math.ceil(-(a.tx+m)/d);(c=b*d+a.tx)+k<gb;)P.moveTo(c+k,0),P.lineTo(c+m,ib),b++;for(b=Math.ceil(-(a.tx-k)/d);(c=b*d+a.tx)-m<gb;)P.moveTo(c-k,0),P.lineTo(c-m,ib),b++;d*=.5*f;for(b=Math.floor(a.ty/d);(c=b*d-a.ty)<ib;){if(b||!xd)P.moveTo(0,c),P.lineTo(gb,c);b++}P.stroke()}xd&&(P.beginPath(),P.strokeStyle="rgba(0,0,0,0.2)",P.lineWidth=3,P.lineCap="butt",P.lineJoin="miter",P.miterLimit=
10,P.beginPath(),P.moveTo(0,-a.ty),P.lineTo(gb-6,-a.ty),P.moveTo(gb-13,-5-a.ty),P.lineTo(gb-3,-a.ty),P.lineTo(gb-13,5-a.ty),P.moveTo(a.tx,ib),P.lineTo(a.tx,6),P.moveTo(a.tx-5,13),P.lineTo(a.tx,3),P.lineTo(a.tx+5,13),P.stroke());hf();O.greset();Oe();for(a=0;a<E.polygons.length;a++)d=E.polygons[a],d.isshowing&&!1!==d.visible&&(k={color:d.color,alpha:d.alpha,fillcolor:d.fillcolor,fillalpha:d.fillalpha,size:d.size,lineJoin:p.string("miter"),fillrule:p.string(d.fillrule)},K.drawpolygon([d.vertices],k,
"D",!0));for(a=0;a<E.conics.length;a++)E.conics[a].isArc?(d=E.conics[a],d.isshowing&&!1!==d.visible&&(k={},k.color=d.color,k.alpha=d.alpha,k.size=d.size,K.drawarc(d,k,d.filled?"F":"D"))):(d=E.conics[a],d.isshowing&&!1!==d.visible&&(k={},k.color=d.color,k.alpha=d.alpha,k.size=d.size,K.drawconic(d.matrix,k)));for(a=0;a<E.lines.length;a++)a:if(d=E.lines[a],d.isshowing&&!1!==d.visible&&h._helper.isAlmostReal(d.homog))if("S"===d.kind)k={overhang:d.overhang,dashtype:d.dashtype,size:d.size,color:d.color,
alpha:d.alpha,arrow:d.arrow,arrowsize:d.arrowsize,arrowposition:d.arrowposition,arrowshape:d.arrowshape,arrowsides:d.arrowsides},0<=n.mult(d.startpos.value[2],n.conjugate(d.endpos.value[2])).value.real?(z.draw$2([d.startpos,d.endpos],k),d.labeled&&!d.tmp&&(k=d.printname||d.name||"S",m=h.scalmult(n.real(Math.sign(d.startpos.value[2].value.real)*Math.sign(d.endpos.value[2].value.real)),h.cross(d.startpos,d.endpos)),m={x:m.value[0].value.real,y:m.value[1].value.real},b=Math.sqrt(m.x*m.x+m.y*m.y),m={x:8*
m.x/b-3,y:8*m.y/b-3},m=d.labelpos||m,b=N.makeColor(ub.textColor),c=v._helper.midpoint(v._helper.midpoint(d.startpos,d.endpos),d.endpos),td(d,k,c,m,b))):(N.handleModifs(k,N.lineModifs),N.drawRaySegment(d.startpos,d.endpos));else if("end"===d.clip.value&&"Join"===d.type)b=E.csnames[d.args[0]],k=E.csnames[d.args[1]],z.draw$2([b.homog,k.homog],{overhang:d.overhang,dashtype:d.dashtype,size:d.size,color:d.color,alpha:d.alpha});else{if("inci"===d.clip.value){b=[1E6,0];k=[-1E6,0];c=[1E6,0];m=[-1E6,0];for(f=
0;f<d.incidences.length;f++){const q=E.csnames[d.incidences[f]].homog;let t=q.value[0],w=q.value[1];const y=q.value[2];n._helper.isAlmostZero(y)||(t=n.div(t,y),w=n.div(w,y),n._helper.isAlmostReal(t)&&n._helper.isAlmostReal(w)&&(t.value.real<b[0]&&(b=[t.value.real,q]),t.value.real>k[0]&&(k=[t.value.real,q]),w.value.real<c[0]&&(c=[w.value.real,q]),w.value.real>m[0]&&(m=[w.value.real,q])))}k[0]-b[0]>m[0]-c[0]?(b=b[1],k=k[1]):(b=c[1],k=m[1]);if(b!==k){z.draw$2([b,k],{dashtype:d.dashtype,size:d.size,color:d.color,
alpha:d.alpha,overhang:d.overhang});break a}}z.draw$1([d.homog],{dashtype:d.dashtype,size:d.size,color:d.color,alpha:d.alpha})}for(a=0;a<E.points.length;a++)if(d=E.points[a],d.isshowing&&!1!==d.visible&&h._helper.isAlmostReal(d.homog)&&(k=d.color,d.behavior&&(k=d.color),z.draw$1([d.homog],{size:d.size,color:k,alpha:d.alpha,noborder:d.noborder,border:d.border}),d.labeled&&!d.tmp)){m=d.printname||d.name||"P";b=d.labelpos||{x:3,y:3};c=N.makeColor(ub.textColor);if(!0===d.noborder.value||!1===d.border.value)c=
k;td(d,m,d.homog,b,c)}for(a=0;a<E.texts.length;a++)Ne(E.texts[a]);if(E.ifs.length){if(bb.dirty||!p.deeplyEqual(bb.mat,O.drawingstate.matrix))v.IFS.updateParameters(),bb.dirty=!1;bb.img&&P.drawImage(bb.img,0,0,gb,ib)}P.restore()}function X(a,b){a=window.event?event:a;a=a.charCode?a.charCode:a.keyCode;Td=String.fromCharCode(a);Ud=a;L(b);x()}function ea(a){ic=a;0===a&&(Hc[0]=tb);L(wa.multidown);ic=0}function ha(a){ic=a;L(wa.multiup);delete Hc[a];ic=0}function Fa(a){var b=a.value;a=b[0].value;const c=
b[1].value;b=b[2].value;return h.turnIntoCSList([a[0],n.add(a[1],c[0]),n.add(a[2],b[0]),c[1],n.add(c[2],b[1]),b[2]])}function Xa(a){let b=!0;return function(c,d){b&&(console.error("Operator "+a+" is not supported yet."),b=!1);return A}}function ja(a,b){if("undefined"===typeof a)return"_??_";if(null===a)return"_???_";if("undefined"===a.ctype)return"___";if("number"===a.ctype)return n.niceprint(a);if("string"===a.ctype||"boolean"===a.ctype)return a.value;if("list"===a.ctype){b="[";for(let c=0;c<a.value.length;c++)b+=
ja(L(a.value[c])),c!==a.value.length-1&&(b+=", ");return b+"]"}if("JSON"===a.ctype)try{return Ia.niceprint(a,b)}catch(c){return Ia._helper.handlePrintException(c)}return"dict"===a.ctype?M.niceprint(a):"function"===a.ctype?"FUNCTION":"infix"===a.ctype?"INFIX":"modifier"===a.ctype?a.key+"->"+ja(a.value):"shape"===a.ctype?a.type:"error"===a.ctype?"Error: "+a.message:"variable"===a.ctype?ja(Y.getvar(a.name)):"geo"===a.ctype?a.value.name:"image"===a.ctype?"IMAGE":"_?_"}function zb(a,b){b="undefined"===
a[0].ctype;const c="undefined"===a[1].ctype,d=L(a[1]);if(b||c)return A;"variable"===a[0].ctype?("list"===d.ctype&&(d.internal_usage=void 0),Y.setvar(a[0].name,d)):"infix"===a[0].ctype?"_"===a[0].oper?K.assigntake(a[0],d):ob("Can't use infix expression as lvalue"):"field"===a[0].ctype?K.assigndot(a[0],d):"userdata"===a[0].ctype?K.assigncolon(a[0],d):"function"===a[0].ctype&&"genList"===a[0].oper?"list"===d.ctype?K.assignlist(a[0].args,d.value):ob("Expected list in rhs of assignment"):ob("Left hand side of assignment is not a recognized lvalue");
return d}function Ma(a,b){b=L(a[0]);a=L(a[1]);if(b.ctype===a.ctype){if("number"===b.ctype)return p.bool(b.value.real===a.value.real&&b.value.imag===a.value.imag);if("string"===b.ctype||"boolean"===b.ctype)return p.bool(b.value===a.value);if("list"===b.ctype)return h.equals(b,a);if("geo"===b.ctype||"JSON"===b.ctype)return p.bool(b.value===a.value)}return{ctype:"boolean",value:!1}}function tc(a,b){return p.not(Ma(a,b))}function wb(a,b){b=W(a[0]);a=W(a[1]);return"number"===b.ctype&&"number"===a.ctype?
{ctype:"boolean",value:n._helper.isAlmostEqual(b,a)}:"string"===b.ctype&&"string"===a.ctype||"boolean"===b.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:b.value===a.value}:"list"===b.ctype&&"list"===a.ctype?h.almostequals(b,a):{ctype:"boolean",value:!1}}function Zb(a,b){b=W(a[0]);a=W(a[1]);return"boolean"===b.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:b.value&&a.value}:A}function ec(a,b){b=W(a[0]);a=W(a[1]);return"boolean"===b.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:b.value||
a.value}:A}function Pc(a,b){b=a[0];"void"!==b.ctype&&(b=W(b));a=W(a[1]);let c=p.add(b,a);"Angle"===b.usage&&"Angle"===a.usage&&(c=p.withUsage(c,"Angle"));return c}function Ad(a,b){b=a[0];"void"!==b.ctype&&(b=W(b));a=W(a[1]);let c=p.sub(b,a);"Angle"===b.usage&&"Angle"===a.usage&&(c=p.withUsage(c,"Angle"));return c}function xe(a,b){b=W(a[0]);a=W(a[1]);let c=p.mult(b,a);"Angle"!==b.usage||a.usage?"Angle"!==a.usage||b.usage||(c=p.withUsage(c,"Angle")):c=p.withUsage(c,"Angle");return c}function Bd(a,b){b=
W(a[0]);a=W(a[1]);"number"===a.ctype&&n._helper.isZero(a)&&ob("WARNING: Division by zero!");let c=p.div(b,a);"Angle"!==b.usage||a.usage?"Angle"!==a.usage||b.usage||(c=p.withUsage(c,"Angle")):c=p.withUsage(c,"Angle");return c}function Bb(a,b){b=W(a[0]);a=W(a[1]);return"number"===b.ctype&&"number"===a.ctype?n.pow(b,a):A}function za(a,b){b=ya(a[0]);a=ya(a[1]);if(b!==A&&a!==A){let c=h.cross(b,a);"Point"===b.usage&&"Point"===a.usage&&(c=p.withUsage(c,"Line"));"Line"===b.usage&&"Line"===a.usage&&(c=p.withUsage(c,
"Point"));return c}return A}function Ac(a){const b=a.length;if(0===b)return[];if(1===b)return[0];if(2===b)return a[0][0]+a[1][1]<=a[0][1]+a[1][0]?[0,1]:[1,0];if(4<b)return nc(a);var c=sa[b];let d=Number.POSITIVE_INFINITY,f=c[0];for(const k of c){c=0;for(let m=0;m<b;++m)c+=a[m][k[m]];c<d&&(d=c,f=k)}return f}function nc(a){function b(){return{matched:-1,prev:-1,start:-1,cost:0,used:!1,leaf:!1}}function c(H){for(let R=0;R<k;++R)0<y[H][R]||w[R].used||(w[R].used=!0,c(w[R].matched))}function d(H){for(let R=
0;R<k;++R)0<y[R][H]||t[R].used||(t[R].used=!0,d(t[R].matched))}const f=Math.abs,k=a.length;let m,q;const t=Array(k),w=Array(k),y=Array(k);for(m=0;m<k;++m)y[m]=Array(k);for(m=0;m<k;++m)for(t[m]=b(),w[m]=b(),t[m].cost=a[m][0],q=1;q<k;++q)t[m].cost>a[m][q]&&(t[m].cost=a[m][q]);for(;;){for(m=0;m<k;++m)for(q=0;q<k;++q)y[m][q]=a[m][q]-t[m].cost-w[q].cost,y[m][q]<1E-14*(f(a[m][q])+f(t[m].cost)+f(w[q].cost))&&(y[m][q]=0);for(m=0;m<k;++m)t[m].matched=w[m].matched=-1;for(var C=0;;){for(m=0;m<k;++m)t[m].used=
t[m].leaf=w[m].used=w[m].leaf=!1,-1===t[m].matched&&(t[m].start=m,t[m].used=t[m].leaf=!0,t[m].prev=-1);var F=!1;let H=!1;for(;!H;){for(m=0;m<k;++m)if(t[m].leaf)for(t[m].leaf=!1,q=0;q<k;++q)if(!(w[q].used||0<y[m][q])&&t[m].matched!==q&&(w[q].prev=m,w[q].start=t[m].start,w[q].used=w[q].leaf=!0,-1===w[q].matched)){t[w[q].start].prev=q;F=!0;break}if(F)break;H=!0;for(q=0;q<k;++q)w[q].leaf&&(w[q].leaf=!1,m=w[q].matched,t[m].used||(t[m].prev=q,t[m].start=w[q].start,t[m].used=t[m].leaf=!0,H=!1))}if(!F)break;
for(F=0;F<k;++F)if(-1===t[F].matched&&-1!==t[F].prev){q=t[F].prev;do m=w[q].prev,w[q].matched=m,t[m].matched=q,q=t[m].prev;while(m!==F);++C}}if(C===k)break;for(m=0;m<k;++m)t[m].used=t[m].leaf=w[m].used=w[m].leaf=!1;for(m=0;m<k;++m)-1===t[m].matched&&c(m);for(q=0;q<k;++q)-1===w[q].matched&&d(q);for(m=0;m<k;++m)-1===t[m].matched||t[m].used||w[t[m].matched].used||(t[m].used=!0);C=Number.POSITIVE_INFINITY;for(m=0;m<k;++m)if(!t[m].used)for(q=0;q<k;++q)w[q].used||C>y[m][q]&&(C=y[m][q]);for(m=0;m<k;++m)t[m].used||
(t[m].cost+=C),w[m].used&&(w[m].cost-=C)}a=Array(k);for(m=0;m<k;++m)q=t[m].matched,a[m]=q;return a}function Bc(a,b){b=L(a[0]);a=W(a[1]);"string"!==b.ctype&&"JSON"!==b.ctype&&(b=h.asList(b));if("JSON"!==b.ctype&&"number"===a.ctype){a=Math.floor(a.value.real);0>a&&(a=b.value.length+a+1);if(0<a&&a<b.value.length+1)return"list"===b.ctype?b.value[a-1]:{ctype:"string",value:b.value.charAt(a-1)};ob("WARNING: Index out of range!");return A}if("JSON"===b.ctype){a=ja(a);if(ja.errorTypes.includes(a))return A;
b=b.value[a];return void 0!==b&&b.ctype?b:A}if("list"===a.ctype){const c=[];for(let d=0;d<a.value.length;d++){const f=W(a.value[d]);c[d]=Bc([b,f],[])}return h.turnIntoCSList(c)}return A}function Cd(a,b){b=L(a[0]);a=L(a[1]);if("shape"===b.ctype&&"shape"===a.ctype)return K.shapeconcat(b,a);b=h.asList(b);a=h.asList(a);return"list"===b.ctype&&"list"===a.ctype?h.concat(b,a):A}function Dd(a,b){b=L(a[0]);a=L(a[1]);return"list"===b.ctype&&"list"===a.ctype?h.set(h.common(b,a)):"shape"===b.ctype&&"shape"===
a.ctype?K.shapecommon(b,a):A}function oc(a,b){b=L(a[0]);a=L(a[1]);return"list"===b.ctype&&"list"===a.ctype?h.remove(b,a):"shape"===b.ctype&&"shape"===a.ctype?K.shaperemove(b,a):A}function Q(a,b){b=L(a[0]);a=L(a[1]);return"list"===b.ctype?h.append(b,a):A}function od(a,b){b=L(a[0]);a=L(a[1]);return"list"===a.ctype?h.prepend(b,a):A}function pd(a,b){a|=0;b|=0;if(0===a&&0===b)return 0;for(;0!==b;){const c=a;a=b;b=c%b|0}return a}function ye(a){return 1===a?0:1}function Yc(a,b,c){var d=b*b-4*a*c;0<=d?(d=
Math.sqrt(d),0<b&&(d=-d),a=[[d-b,2*a],[2*c,d-b]]):a=null;b=a;if(null===b)return null;a=b[0][0]/b[0][1];b=b[1][0]/b[1][1];return b<a?[b,a]:[a,b]}function $d(a,b,c,d,f,k,m,q=0){if(b.includes("\n")){let w=Infinity,y=-Infinity,C=Infinity,F=-Infinity;b.split("\n").forEach(function(H){H=$d(a,H,c,d,f,k);w>H.left&&(w=H.left);y<H.right&&(y=H.right);C>H.top&&(C=H.top);F<H.bottom&&(F=H.bottom);d+=m});return{left:w,right:y,top:C,bottom:F}}const t=a.measureText(b);q?(a.save(),a.translate(c,d),a.rotate(-q),a.fillText(b,
-t.width*f,0),a.restore()):a.fillText(b,c-t.width*f,d);return{left:c-t.width*f,right:c+t.width*(1-f),top:d-.84*k,bottom:d+.36*k}}function Tb(a){return"image"===a.ctype?a.value:"string"===a.ctype&&yc.hasOwnProperty(a.value)?yc[a.value].value:null}function Ic(a,b,c,d,f){let k=[];if(a.readPixels)k=a.readPixels(b,c,d,f);else{let m,q;if(a.img.getContext)q=a.img.getContext("2d"),m=q.getImageData(b,c,d,f).data;else try{vd||(vd=document.createElement("canvas")),vd.width=d,vd.height=f,q=vd.getContext("2d"),
q.drawImage(a.img,b,c,d,f,0,0,d,f),m=q.getImageData(0,0,d,f).data}catch(t){console.log(t)}for(const t in m)k.push(m[t]/255)}return k}function ae(a){return a.replace(/[^A-Za-z0-9 \u0080-\uffff]/gi,"\\$&")}function xb(a,b,c){var d=a;b&&(d=d+" at "+b.row+":"+b.col);c&&(d=d+": \u2018"+c+"\u2019");d=Error(d);d.name="CindyScriptParseError";d.description=a;d.location=b;d.text=c;return d}function Jc(a){this.input=a;this.re=new RegExp(Xe,"g");const b=[];let c=a.indexOf("\n")+1;for(;c;)b.push(c),c=a.indexOf("\n",
c)+1;b.push(a.length);this.bols=b;this.bol=this.pos=0;this.line=1}function qd(a){const b=a[a.length-2],c=a[a.length-3],d=a[a.length-1];if(c){if(c.isSuperscript&&b.precedence<=c.precedence)throw xb("Operator not allowed after superscript",b.start,b.text);if(d){if(!b.op.infix)throw xb("Operator may not be used infix",b.start,b.text);}else if(!b.op.postfix)throw xb("Operator may not be used postfix",b.start,b.text);}else if(d){if(!b.op.prefix)throw xb("Operator may not be used prefix",b.start,b.text);
}else if(!b.op.bare)throw xb("Operator without operands",b.start,b.text);b.ctype="infix";b.oper=b.op.sym;b.args=[c,d];a.splice(a.length-3,3,b)}function be(a,b,c,d){a.length&1||a.push(null);for(c=na[c];3<=a.length&&a[a.length-2].precedence<=c.precedence;)qd(a);a.push({op:c,precedence:c.precedence+(c.rassoc?1:0),start:b.start,end:b.end,text:b.text,rawtext:b.rawtext});c="";const f=b.text;for(let k=0;k<f.length;++k)c+="0123456789+-".charAt(d.indexOf(f.charAt(k)));b.ctype="number";b.value={real:+c,imag:0};
a.push(b);qd(a)}function ze(a,b){const c=[];let d="}"===b;a:for(;;){var f=a.next();switch(f.toktype){case "OP":var k=na[f.text];"_"!==k.sym||!c.length||c.length&1||"OP"!==c[c.length-1].toktype||":="!==c[c.length-1].op.sym||(c.pop(),k=na[":=_"],f.text=k.sym);f.op=k;f.precedence=k.precedence;for(c.length&1||c.push(null);3<=c.length&&c[c.length-2].precedence<=f.precedence;)qd(c);k.rassoc&&f.precedence++;d&&":"===k.sym&&(f.jsonatom=!0,f.precedence=na[","].precedence,d=!1);"}"===b&&","===k.sym&&0<c.length&&
c[c.length-1].jsonatom&&(d=!0);c.push(f);break;case "ID":f.ctype="variable";f.name=f.text;if(c.length&1)throw xb("Missing operator",f.start,f.text);c.push(f);break;case "NUM":f.ctype="number";f.value={real:+f.text,imag:0};if(c.length&1)throw xb("Missing operator",f.start,f.text);c.push(f);break;case "STR":f.ctype="string";f.value=f.raw.substring(1,f.raw.length-1);if(c.length&1)throw xb("Missing operator",f.start,f.text);c.push(f);break;case "SUB":be(c,f,"_","\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089\u208a\u208b");
break;case "SUP":be(c,f,"^","\u2070\u00b9\u00b2\u00b3\u2074\u2075\u2076\u2077\u2078\u2079\u207a\u207b");c[c.length-1].isSuperscript=!0;break;case "BRA":k="[](){}||".indexOf(f.text);if(f.text===b||k&1)break a;k="[](){}||".charAt(k+1);var m=ze(a,k),q=m.closedBy;if(q.text!==k)throw xb("Opening "+f.text+" at "+f.start.row+":"+f.start.col+" closed by "+(q.text||"EOF")+" at "+q.start.row+":"+q.start.col);q=f.text+q.text;k=[];if(m=m.expr){for(;m&&"infix"===m.ctype&&","===m.oper;)k.push(m.args[0]),m=m.args[1];
k.push(m)}if(c.length&1){if("{}"===q)throw xb("{\u2026} not yet defined for operators.",f.start);m=c[c.length-1];if("variable"!==m.ctype)throw xb("Function name must be an identifier",m.start);if(2<c.length&&c[c.length-2].precedence<Vb)throw xb("Function call in indexing construct must be enclosed in parentheses",f.start);m.ctype="function";f=m.args=[];q=m.modifs={};for(const t of k)if(t&&"infix"===t.ctype&&"->"===t.oper){k=t.args[0];if("variable"!==k.ctype)throw xb("Modifier name must be an identifier",
t.start);q[k.name]=t.args[1]}else f.push(t);m.oper=m.name.toLowerCase()+"$"+m.args.length}else if("||"===q)if(1===k.length)c.push({ctype:"function",oper:"abs_infix",args:k,modifs:{}});else if(2===k.length)c.push({ctype:"function",oper:"dist_infix",args:k,modifs:{}});else throw xb("Don't support |\u2026| with "+k.length+" arguments",f.start);else"{}"===q?c.push({ctype:"function",oper:"genJSON",args:k,modifs:{}}):"[]"!==q&&1===k.length?c.push({ctype:"paren",args:k}):0===k.length?c.push({ctype:"list",
value:[]}):c.push({ctype:"function",oper:"genList",args:k,modifs:{}});break;case "EOF":break a}}for(c.length&1||c.push(null);3<=c.length;)qd(c);return{expr:c[0],closedBy:f}}function Cc(a){this.usedFunctions={};this.usedVariables={}}function L(a){if(void 0===a)return A;if("infix"===a.ctype)return a.impl(a.args,{},a);if("variable"===a.ctype)return L(Y.getvar(a.name));if("function"===a.ctype)return ue.push(a),a=K.evaluate(a.oper,a.args,a.modifs),ue.pop(),a;if("void"===a.ctype)return A;if("field"===a.ctype){var b=
L(a.obj);if("geo"===b.ctype){var c=Ia._helper.self;Ia._helper.self=b;a=L(ca.getField(b.value,a.key));Ia._helper.self=c;return a}return"list"===b.ctype?(c=Ia._helper.self,Ia._helper.self=b,a=h.getField(b,a.key),Ia._helper.self=c,a):"JSON"===b.ctype?(c=Ia._helper.self,Ia._helper.self=b,a=L(Ia.getField(b,a.key)),Ia._helper.self=c,a):A}return"userdata"===a.ctype?(b=L(a.obj),a=p.string(ja(L(a.key))),"_?_"===a.value&&(a=A),"geo"===b.ctype?(c=Ia._helper.self,Ia._helper.self=b,a=L(ca.getuserData(b.value,
a)),Ia._helper.self=c,a):"list"===b.ctype||"string"===b.ctype?(c=Ia._helper.self,Ia._helper.self=b,a=L(ca.getuserData(b,a)),Ia._helper.self=c,a):"JSON"===b.ctype?(c=Ia._helper.self,Ia._helper.self=b,a=L(Ia.getField(b,a.value)),Ia._helper.self=c,a):A):a}function W(a){a=L(a);if("geo"===a.ctype){const b=a.value;if("P"===b.kind)return ca.getField(b,"xy");if("V"===b.kind)return b.value}return a}function ya(a){a=L(a);if("geo"===a.ctype){var b=a.value;if("P"===b.kind||"L"===b.kind)return ca.getField(b,"homog")}return h._helper.isNumberVecN(a,
3)?a:h._helper.isNumberVecN(a,2)?(b=h.turnIntoCSList([a.value[0],a.value[1],n.real(1)]),a.usage&&(b=p.withUsage(b,a.usage)),b):A}function uc(a){const b=new Cc;b.usedFunctions=kd;b.infixmap=G;a=b.parse(a);for(const c in b.usedVariables)Y.create(c);return a}function Ae(a,b){return{ctype:"infix",args:[],impl:function(){ue=[{oper:b}];const c=L(a);ue=[];return c}}}function ob(a){Kb.err(a+ue.map(function(b){return"\n  at "+b.oper}).join("\n"))}function Kc(){this._path=[];this._defs=["<defs>"];this._imgcache=
[];this._body=[];this._saveStack=[""];this._clipIndex=0;this._stroke=this._fill="#000";this._strokeOpacity=this._fillOpacity=null;this.height=this.width=0;this.lineWidth=1;this.lineCap="butt";this.lineJoin="miter";this.miterLimit=10;this.globalAlpha=1}function Be(){this._body=[];this._yPos=this._xPos=NaN;this._extGState={Af255:"<< /ca 1 >>",As255:"<< /CA 1 >>"};this._objects=[["%PDF-1.4\n"]];this._offset=this._objects[0][0].length;this._nextIndex=5;this._imgcache=[];this._xobjects={};this._pathUsed=
-1;this._fillAlpha=this._strokeAlpha=this._globalAlpha=1;this.height=this.width=0;this.lineWidth=1;this.lineCap="butt";this.lineJoin="miter";this.miterLimit=10}function Ce(a,b){const c=a.width,d=a.height,f=document.createElement("canvas");f.setAttribute("width",c);f.setAttribute("height",d);f.setAttribute("style","display:none;");const k=Mb.canvas;k.parentNode.insertBefore(f,k.nextSibling);try{return f.getContext("2d").drawImage(a,0,0,c,d),f.toDataURL(b||"image/png")}finally{f.parentNode.removeChild(f)}}
function cf(a){a=a.replace(RegExp("[^ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/]+","g"),"");const b=new Uint8Array(3*a.length>>2);let c,d,f,k,m,q;for(d=c=0;c+3<a.length;c+=4)f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c)),k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+1)),m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+2)),q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+
3)),b[d++]=f<<2|k>>4,b[d++]=k<<4|m>>2,b[d++]=m<<6|q;switch(a.length-c){case 0:break;case 2:f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c));k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+1));b[d++]=f<<2|k>>4;break;case 3:f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c));k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+1));m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+
2));b[d++]=f<<2|k>>4;b[d++]=k<<4|m>>2;break;default:throw Error("Malformed Base64 input: "+(a.length-c)+" chars left: "+a.substr(c));}if(d!==b.length)throw Error("Failed assertion: "+d+" should be "+b.length);return b}function De(a){function b(f){return(a[f]<<24|a[f+1]<<16|a[f+2]<<8|a[f+3])>>>0}if(57>a.length)throw Error("Too short to be a PNG file");if(2303741511!==b(0)||218765834!==b(4))throw Error("PNG signature missing");const c=[];let d=8;for(;d<a.length;){if(d+12>a.length)throw Error("Incomplete chunk at offset 0x"+
d.toString(16));const f=b(d);if(2147483648<=f)throw Error("Chunk too long");const k=d+12+f;if(k>a.length)throw Error("Incomplete chunk at offset 0x"+d.toString(16));let m=a.subarray(d+4,d+8);m=String.fromCharCode.apply(String,m);c.push({len:f,type:m,data:a.subarray(d+8,d+8+f),crc:b(d+8+f)});d=k}return c}function rd(a,b){let c;if(c=/^rgba\(([0-9.]+), *([0-9.]+), *([0-9.]+), *([0-9.]+)\)$/.exec(a))b(+c[1],+c[2],+c[3],+c[4]);else if(c=/^rgb\(([0-9.]+), *([0-9.]+), *([0-9.]+)\)$/.exec(a))b(+c[1],+c[2],
+c[3],1);else throw Error("Can't handle color style "+a);}function Ee(a){let b=1;Object.keys(yc).forEach(function(c){const d=yc[c].value.img;if(void 0===d.cachedDataURL&&d.src)if("data:"===d.src.substr(0,5))d.cachedDataURL=d.src;else{++b;d.cachedDataURL=null;var f=new XMLHttpRequest;f.responseType="blob";f.onreadystatechange=function(){if(f.readyState===XMLHttpRequest.DONE)if(200===f.status){const k=new FileReader;k.onloadend=function(){d.cachedDataURL=k.result;console.log("Cached data for image "+
d.src);0===--b&&a()};k.readAsDataURL(f.response)}else console.error("Failed to load "+d.src+": "+f.statusText),0===--b&&a()};f.open("GET",d.src,!0);f.send()}});0===--b&&a()}function $b(a,b,c){for(c||(c="0");a.length<b;)a=c+a;return a}function Ed(){null!==ve&&(window.URL.revokeObjectURL(ve),ve=null)}function sd(a){Ee(function(){const b=P;try{P=new a;P.width=gb;P.height=ib;I();const c=P.toBlob();ve=window.URL.createObjectURL(c);zf(ve)}finally{P=b}})}function pc(a){let b=null,c=1E6,d;console.log("getElementAtMouse");
for(const q of E.gslp){if(q.pinned||!1===q.visible||!0===q.tmp)continue;var f=void 0,k=void 0,m=void 0;const t=O.drawingstate.matrix.sdet;if("P"===q.kind){const w=h.normalizeZ(q.homog);if(!h._helper.isAlmostReal(w))continue;f=w.value[0].value.real-a.x;k=w.value[1].value.real-a.y;m=Math.sqrt(f*f+k*k);q.narrow&m>20/t&&(m=1E4)}else if("C"===q.kind)k=E.csnames[q.args[0]],m=0,"undefined"!==typeof q.radius&&(m=q.radius.value.real),f=n.div(k.homog.value[0],k.homog.value[2]).value.real,k=n.div(k.homog.value[1],
k.homog.value[2]).value.real,f-=a.x,k-=a.y,m=Math.sqrt(f*f+k*k)-m,k=f=0,0>m&&(m=-m),m+=30/t;else if("L"===q.kind||"S"===q.kind)f=q.homog,m=n,k=m.add(m.mult(f.value[0],m.conjugate(f.value[0])),m.mult(f.value[1],m.conjugate(f.value[1]))),k=h.scaldiv(m.sqrt(k),f),m=k.value[0].value.real*a.x+k.value[1].value.real*a.y+k.value[2].value.real,f=k.value[0].value.real*m,k=k.value[1].value.real*m,0>m&&(m=-m),m+=1;m<c+.2/t&&(c=m,b=q,d={x:f,y:k})}return null===b?null:{mover:b,offset:d,prev:{x:a.x,y:a.y}}}function fc(){return"P"+
Ff++}function Zc(a){const b=ba[tf].actions;b[Wd].event===a&&b[Wd].do()&&(x(),Wd===b.length-1?(cc=[],Wd=Mc=0):Wd++)}function ce(a){return a&&.5>Math.abs(a.offset.x)&&.5>Math.abs(a.offset.y)&&!a.mover.tmp}function Fe(a){return ce(a)&&"P"===a.mover.kind}function de(a){return ce(a)&&("L"===a.mover.kind||"S"===a.mover.kind)}function ee(a){qb={mover:a,offset:{x:0,y:0},prev:{x:ab.x,y:ab.y}}}function ac(){const a=pc(ab);Fe(a)?cc[Mc]=a.mover:(cc[Mc]={type:"Free",name:fc(),labeled:!0,pos:[tb[0],tb[1],1]},Ub(cc[Mc]));
Mc++}function Ge(){const a=pc(ab);return de(a)?(cc[Mc]=a.mover,Mc++,!0):!1}function He(){const a=pc(ab);var b;(b=de(a))||(b=ce(a)&&"C"===a.mover.kind);return b?(cc[Mc]=a.mover,Mc++,!0):!1}function $c(){const a=pc(ab);if(Fe(a)){we.args[1]=a.mover.name;for(const b of E.gslp)!0===b.tmp&&Gd(b.name)}else for(const b of E.gslp)!0===b.tmp&&(b.tmp=!1)}function Fd(a){let b={type:"Free",name:fc(),labeled:!0,pos:[tb[0],tb[1],1],tmp:!0};b=Ub(b);we=Ub({type:a,name:fc(),labeled:!0,args:[cc[0].name,b.name]});ee(b)}
function df(a){let b;for(b in a)null!==a[b]&&(ub[b]=a[b])}function ef(a){Object.keys(v).forEach(function(b){const c=v[b];qc(c.signature||"_helper"===b,b+" has no signature");void 0!==c.updatePosition&&void 0===c.stateSize&&(c.stateSize=0)});E.gslp=[];E.csnames={};E.points=[];E.lines=[];E.conics=[];E.texts=[];E.free=[];E.polygons=[];E.ifs=[];E.sets={points:[],lines:[],conics:[]};a.forEach(Le);le()}function Ie(a){"undefined"===typeof a.tracedim&&(a.tracedim=1);"undefined"===typeof a.tracelength&&(a.tracelength=
100);"undefined"===typeof a.traceskip&&(a.traceskip=1);a._traces=Array(a.tracelength);a._traces_index=0;a._traces_tick=0}function Je(a){void 0===a.size&&(a.size=ub.pointSize);a.size=n.real(a.size);!a.movable||a.pinned?(a.color=h.realVector(a.color||ub.pointColor),a.color=h.scalmult(n.real(ub.dimDependent),a.color)):a.color=h.realVector(a.color||ub.pointColor);void 0===a.alpha&&(a.alpha=ub.alpha);a.alpha=n.real(a.alpha);"boolean"!==typeof a.noborder&&(a.noborder=ub.noborder);a.noborder=p.bool(a.noborder);
"boolean"!==typeof a.border&&(a.border=!ub.noborder);a.border=p.bool(a.border);a.drawtrace&&Ie(a)}function ad(a){void 0===a.size&&(a.size=ub.lineSize);a.size=n.real(a.size);a.color=h.realVector(a.color||ub.lineColor);void 0===a.alpha&&(a.alpha=ub.alpha);a.alpha=n.real(a.alpha);a.clip=p.string(a.clip||ub.clip);void 0===a.overhang&&(a.overhang=ub.overhangLine);a.overhang=n.real(a.overhang);a.dashtype&&(a.dashtype=p.wrap(a.dashtype))}function Ke(a){void 0===a.overhang&&(a.overhang=ub.overhangSeg);a.arrow&&
(a.arrow=p.bool(a.arrow));a.arrowsize&&(a.arrowsize=n.real(a.arrowsize));a.arrowposition&&(a.arrowposition=n.real(a.arrowposition));a.arrowshape&&(a.arrowshape=p.string(a.arrowshape));a.arrowsides&&(a.arrowsides=p.string(a.arrowsides));ad(a);a.clip=p.string("end")}function vc(a){a.size=void 0!==a.textsize?a.textsize:ub.textsize;a.size=n.real(+a.size)}function fe(a){a.filled=void 0!==a.filled?p.bool(a.filled):p.bool(!0);a.fillcolor=void 0===a.fillcolor?A:h.realVector(a.fillcolor);void 0===a.fillalpha&&
(a.fillalpha=0);a.fillalpha=n.real(a.fillalpha);ad(a)}function Ub(a,b){a=Le(a);le();return"boolean"===typeof b&&b&&a.Duplicate?(b=a.Duplicate,console.log("duplication detected: removing "+a.name+" (type "+a.kind+") (duplicate of "+b.name+")."),Gd(a.name),b):a}function Le(a){if(void 0!==E.csnames[a.name]){console.log("Element name '"+a.name+"' already exists");var b=E.csnames[a.name];v[b.type].isMovable&&"P"===v[b.type].kind&&Qb(b,a.pos,"homog");return b}for(;Xd.hasOwnProperty(a.type);)a.type=Xd[a.type];
if(b=uf[a.type]){var c=b(a),d=null;for(b=0;b<c.length;++b)d=Ub(c[b]);return d}const f=v[a.type];c=!1;if(!f)return console.error(a),console.error("Operation "+a.type+" not implemented yet"),null;if("**"!==f.signature)if(!Array.isArray(f.signature)&&"*"===f.signature.charAt(1))c=!0,a.args.forEach(function(k){if(E.csnames[k].kind!==f.signature.charAt(0))return console.error("Not all elements in set are of same type: "+a.name+" expects "+f.signature+" but "+k+" is of kind "+E.csnames[k].kind),"undefined"!==
typeof window&&window.alert("Not all elements in set are of same type: "+a.name),null});else if(f.signature.length!==(a.args?a.args.length:0))return console.error("Wrong number of arguments for "+a.name+" of type "+a.type),"undefined"!==typeof window&&window.alert("Wrong number of arguments for "+a.name),null;if(a.args)for(b=0;b<a.args.length;++b){if(!E.csnames.hasOwnProperty(a.args[b]))return console.log("Dropping "+a.name+" due to missing argument "+a.args[b]),null;if("**"!==f.signature&&!c&&(d=
E.csnames[a.args[b]].kind,f.signature[b]!==d&&("S"!==d||"L"!==f.signature[b])))return window.alert("Wrong argument kind "+d+" as argument "+b+" to element "+a.name+" of type "+a.type),null}f.signatureConstraints&&!f.signatureConstraints(a)&&window.alert("signature constraints violated for element "+a.name);E.gslp.push(a);E.csnames[a.name]=a;b=jc.length;a.kind=f.kind;a.stateIdx=b;b+=f.stateSize;a.incidences=[];a.isshowing=!0;a.movable=!1;f.isMovable&&(a.movable=!0,E.free.push(a));"P"===a.kind&&(E.points.push(a),
Je(a));"L"===a.kind&&(E.lines.push(a),ad(a));"C"===a.kind&&(E.conics.push(a),ad(a));"S"===a.kind&&(E.lines.push(a),Ke(a));"Text"===a.kind&&(E.texts.push(a),vc(a));"Poly"===a.kind&&(E.polygons.push(a),fe(a));"IFS"===a.kind&&E.ifs.push(a);/^[P|L|S|C]s$/.test(a.kind)&&E.sets[{P:"points",L:"lines",S:"lines",C:"conics"}[a.kind[0]]].push(a);gf(b);Eb=zc=jc;ld=!0;f.initialize&&(dc=kc=a.stateIdx,a.param=f.initialize(a),qc(kc===a.stateIdx+f.stateSize,"State fully initialized"));dc=kc=a.stateIdx;f.updatePosition(a,
!1);qc(dc===a.stateIdx+f.stateSize,"State fully consumed");qc(kc===a.stateIdx+f.stateSize,"State fully updated");ld=!1;Eb=Lc.in;Eb.set(jc);zc=Lc.out;ge(a,f);af={};try{kb(a),Dc(a)}catch(k){console.error(k)}return E.csnames[a.name]}function Gd(a){if(E.csnames.hasOwnProperty(a)){var b={};Object.keys(E.csnames).forEach(function(d){const f=E.csnames[d];f.hasOwnProperty("args")&&f.args.forEach(function(k){b.hasOwnProperty(k)||(b[k]={});b[k][d]=!0})});var c=function(d,f){f[d]=!0;if(!b.hasOwnProperty(d))return f;
for(const k in b[d])f[k]||c(k,f);return f};a=c(a,{});ff(a)}else console.log("removeElement: name "+a+"does not exist.")}function ff(a){const b=Object.keys(a),c=function(f,k){return function(m){return f[m.name]?!1:!0}},d={};b.forEach(function(f){E.csnames[f].incidences.forEach(function(k){d[k]||(E.csnames[k].incidences=E.csnames[k].incidences.filter(function(m){return!a[m]}),d[k]=!0)})});"conics free gslp ifs lines points polygons texts".split(" ").map(function(f){E[f]=E[f].filter(c(a,f))});for(const f in E.sets)E.sets[f]=
E.sets[f].filter(c(a,"set of "+f));b.forEach(function(f){delete E.csnames[f]});af={}}function Me(a,b){var c=E.csnames[b.args[0]].homog,d=E.csnames[b.args[1]].homog;b=a.homog;a=n.div(c.value[0],c.value[2]);c=n.div(c.value[1],c.value[2]);let f=n.div(d.value[0],d.value[2]);d=n.div(d.value[1],d.value[2]);let k=n.div(b.value[0],b.value[2]);b=n.div(b.value[1],b.value[2]);return n._helper.isAlmostReal(a)&&n._helper.isAlmostReal(c)&&n._helper.isAlmostReal(f)&&n._helper.isAlmostReal(d)&&n._helper.isAlmostReal(k)&&
n._helper.isAlmostReal(b)?(a=a.value.real,c=c.value.real,f=f.value.real,d=d.value.real,k=k.value.real,b=b.value.real,a=Math.sqrt((a-f)*(a-f)+(c-d)*(c-d))-Math.sqrt((a-k)*(a-k)+(c-b)*(c-b))-Math.sqrt((f-k)*(f-k)+(d-b)*(d-b)),1E-15>a*a):!1}function ge(a,b){a.isshowing=!0;if(a.args)for(let c=0;c<a.args.length;c++)if(!E.csnames[a.args[c]].isshowing){a.isshowing=!1;return}b.visiblecheck&&b.visiblecheck(a)}function td(a,b,c,d,f){const k=a.textsize||ub.textsize,m=!0===a.textbold,q=!0===a.textitalics,t=a.text_fontfamily||
ub.fontFamily,w=d.x*d.x+d.y*d.y;let y=1;0<w&&(y=1+a.size.value.real/Math.sqrt(w));a=a.alpha||n.real(ub.alpha);K.drawtext([c,p.wrap(b)],{xoffset:p.wrap(y*d.x),yoffset:p.wrap(y*d.y),size:p.wrap(k),bold:p.wrap(m),italics:p.wrap(q),family:p.wrap(t),color:f,alpha:a})}function Ne(a){a._bbox=null;if(a.isshowing&&!1!==a.visible){var b={size:a.size},c=a.homog,d=a.text,f=v[a.type].getText;d=f?f(a):d.replace(/@[$#]"([^"\\]|\\.)*"/g,function(k){let m,q;try{if(m=JSON.parse(k.substring(2)),q=E.csnames[m],!q)return"?"}catch(t){return"?"}switch(k.charAt(1)){case "$":return q.printname||
m;case "#":return"V"!==q.kind?"?":ja(q.value)}});f=null;if(a.html){const k=a._textCache||{text:!1},m=a.html,q=m.parentNode,t=q.parentNode;f=function(w,y,C,F,H){y/=pb;C/=pb;H=N.bold+N.italics+Math.round(H/pb*10)/10+"px "+N.family;k.invisible&&t.style.removeProperty("display");if(w!==k.text||H!==k.font||y!==k.x||C!==k.y||F!==k.align){H!==k.font&&(m.style.font=H,m.style.lineHeight=ub.lineHeight);w!==k.text&&!1!==w&&!1===Sc(m,w,H)&&(w=!1);t.style.left=y+"px";t.style.top=C+"px";if(F||q.style.transform)q.style.transform=
"translateX("+-100*F+"%)";a._textCache={text:w,font:H,x:y,y:C,align:F}}}}d=p.string(d);a.dock&&(a.dock.to?c=E.csnames[a.dock.to].homog:Af.hasOwnProperty(a.dock.corner)&&(c=z.screenbounds$0([],{}),c=c.value[Af[a.dock.corner]]),b.offset=a.dock.offset);a.align&&(b.align=p.string(a.align));c&&(a._bbox=K.drawtext([c,d],b,f))}else a.html&&(a.html.parentNode.parentNode.style.display="none",a._textCache={invisible:!0})}function Oe(){function a(){var q=m++/b._traces.length;const t=b._traces[k];t&&(q*=c*q*
q,z.draw$1([t],{size:n.real(d),color:b.color,alpha:n.real(q)}));d*=f}for(let q=0;q<E.points.length;q++){var b=E.points[q];if(b.drawtrace){b._traces_tick===b.traceskip?(b._traces[b._traces_index]=b.homog,b._traces_index=(b._traces_index+1)%b._traces.length,b._traces_tick=0):b._traces_tick++;var c=b.alpha.value.real,d=b.size.value.real,f=1;1!==b.tracedim&&(d*=b.tracedim,f=b.tracedim**(-1/b._traces.length));var k,m=0;for(k=b._traces_index;k<b._traces.length;++k)a();for(k=0;k<b._traces_index;++k)a()}}}
function qc(a,b){b="Assertion failed: "+b;if(!a)throw console.log(b),Db(),"undefined"!==typeof alert&&alert(b),Error(b);}function gf(a){if(a!==jc.length){var b,c=vf.length;if(md.length<a*c){var d=2*a;md=new Float64Array(c*d)}else d=md.length/c|0;for(b=0;b<c;++b)Lc[vf[b]]=md.subarray(b*d,b*d+a);a=jc;Eb=Lc.in;zc=Lc.out;jc=Lc.good;jc.set(a)}}function Qc(){jc.set(Eb);rc=!1;ie(!1);const a=jc.length,b=Math.abs;for(let c=0;c<a;c+=2)b(jc[c])>1E12*b(jc[c+1])&&(jc[c+1]=0)}function Hd(){if(Yd)rc=!0;else throw Bf;
}function he(a,b,c,d,f){return p.add(d,p.mult(c,p.sub(f,d)))}function hf(){ra&&(ra.currentMouseAndScripts=[]);wf=!0;if(qb){const a=qb.mover,b=h.realVector([ab.x+qb.offset.x,ab.y+qb.offset.y,1]);Pe(a,b,"mouse");qb.prev.x=ab.x;qb.prev.y=ab.y}L(wa.move);L(wa.draw);rc||Qc();wf=!1;ra&&(ra.fullLog.push(h.turnIntoCSList([h.turnIntoCSList(ra.currentMouseAndScripts)])),ra.length>ra.logLength&&ra.splice(0,ra.length-ra.logLength),ra.currentMouseAndScripts=null,ra.postMouseHooks.forEach(function(a){a()}))}function Qb(a,
b,c){Pe(a,b,c);wf||rc||Qc()}function Pe(a,b,c){ra&&ra.currentMouseAndScripts&&(ra.currentMover=[]);a===Cf?(Eb.set(jc),rc=!1):(Cf=a,Qc());zc.set(Eb);let d=1E4;var f=af[a.name];if(!f){var k={};var m=0;f=[];k[a.name]=a;var q=E.gslp;for(var t of q)if(q=t.args)for(var w of q)k.hasOwnProperty(w)&&(k[t.name]=t,f[m++]=t);af[a.name]=f}k=f;m=-1;f=.9;let y,C,F;t=v[a.type];w=t.parameterPath||he;dc=a.stateIdx;q=t.getParamFromState(a);dc=kc=a.stateIdx;const H=t.getParamForInput(a,b,c);let R=m+f;for(;m!==R;){var S=
R*R,Z=.5/(1+S);Z=n.complex(2*R*Z+.5,(1-S)*Z);Yd=m+.5*f<=m||0===d;0===d&&console.log("tracing limit Reached");S=!1;ra&&ra.currentMouseAndScripts&&(ra.currentStep=[]);try{dc=kc=a.stateIdx;const U=w(a,R,Z,q,H);ra&&(ra.currentParam=U);Z=zc;zc=Eb;t.putParamToState(a,U);zc=Z;kc=a.stateIdx;ra&&(ra.currentElement=a);t.updatePosition(a,!0);qc(dc===a.stateIdx+t.stateSize,"State fully consumed");qc(kc===a.stateIdx+t.stateSize,"State fully updated");for(y=0;y<k.length;++y)C=k[y],F=v[C.type],dc=kc=C.stateIdx,
ra&&(ra.currentElement=C),F.updatePosition(C,!1),qc(dc===C.stateIdx+F.stateSize,"State fully consumed"),qc(kc===C.stateIdx+F.stateSize,"State fully updated");ra&&(ra.currentElement=null);m=R;f*=1.25;R+=f;1<=R&&(R=1);zc=Eb;Eb=Z}catch(U){if(U!==Bf)throw U;f*=.5;R=m+f;--d;S=!0}ra&&ra.currentMouseAndScripts&&(ra.currentMover.push(h.turnIntoCSList([h.turnIntoCSList(ra.currentStep),p.wrap(S),p.wrap(m),p.wrap(R),p.wrap(ra.currentParam)])),ra.currentStep=null,ra.currentParam=null)}ie(rc);for(y=0;y<k.length;++y)C=
k[y],F=v[C.type],ge(C,F);ra&&ra.currentMouseAndScripts&&(ra.currentMouseAndScripts.push(h.turnIntoCSList([h.turnIntoCSList(ra.currentMover),p.wrap(rc),p.wrap(a.name),b,p.wrap(c),q,H])),ra.currentMover=null)}function Qe(){Qc();Yd=!0;var a=E.gslp;for(var b of a)a=v[b.type],dc=kc=b.stateIdx,a.updatePosition(b,!1),ge(b,a);b=zc;zc=Eb;Eb=b;Qc()}function ie(a){const b=aa.tracingStateReport;"string"===typeof b&&(document.getElementById(b).textContent=a?"BAD":"GOOD")}function jf(){return h.turnIntoCSList(ra.fullLog.slice())}
function kf(a){const b=JSON.stringify(ra.fullLog);a=new Blob([b],{type:a?"application/octet-stream":"application/json"});return window.URL.createObjectURL(a)}function bd(){const a=dc;dc+=2;return n.complex(Eb[a],Eb[a+1])}function Za(a){const b=Array(a);for(let c=0;c<a;++c)b[c]=bd();return h.turnIntoCSList(b)}function wc(a){zc[kc]=a.value.real;zc[kc+1]=a.value.imag;kc+=2}function Qa(a){for(let b=0,c=a.value.length;b<c;++b)wc(a.value[b])}function gc(a,b){const c=Za(3),d=Za(3);a=je(a,b,c,d);Qa(a[0]);
Qa(a[1]);return h.turnIntoCSList(a)}function je(a,b,c,d){if(ld)return[a,b];const f=h.projectiveDistMinScal(c,a),k=h.projectiveDistMinScal(c,b),m=h.projectiveDistMinScal(d,a),q=h.projectiveDistMinScal(d,b),t=h.projectiveDistMinScal(c,d),w=h.projectiveDistMinScal(a,b);var y=f+q,C=k+m;let F;y>C?(F=[b,a],y=C):F=[a,b];C=function(){};if(ra&&ra.currentStep){const H=[ra.labelTracing2,p.wrap(ra.currentElement.name),h.turnIntoCSList(F),h.turnIntoCSList([c,d]),h.realMatrix([[f,k],[m,q]]),p.wrap(y),p.wrap(t),
p.wrap(w),A];ra.currentStep.push(h.turnIntoCSList(H));C=function(R){ra.hasOwnProperty(R)||(ra[R]=p.wrap(R));H[H.length-1]=ra[R]}}h._helper.isNaN(a)||h._helper.isNaN(b)?(C("Tracing failed due to NaNs."),rc=!0):t>3*y&&w>3*y?C("Normal case, everything all right."):1E-5>w?1E-5>t?C("Staying inside singularity."):(C("Moved into singularity."),rc=!0):1E-5>t?C("Moved out of singularity."):(Yd?C("Reached refinement limit, giving up."):C("Need to refine."),Hd());return F}function ke(a,b,c,d){const f=Za(3),
k=Za(3),m=Za(3),q=Za(3);a=lf(a,b,c,d,f,k,m,q);Qa(a[0]);Qa(a[1]);Qa(a[2]);Qa(a[3]);return h.turnIntoCSList(a)}function lf(a,b,c,d,f,k,m,q){let t=function(){};f=[f,k,m,q];a=[a,b,c,d];if(ld)return a;k=0;d=Array(4);for(c=0;4>c;c++)for(d[c]=Array(4),q=0;4>q;q++)m=h.projectiveDistMinScal(f[c],a[q]),d[c][q]=m;m=Ac(d);b=Array(4);for(c=0;4>c;++c)b[c]=a[m[c]],k+=d[c][m[c]];const w=1*k;let y=Infinity,C=Infinity;for(c=0;4>c;c++){if(h._helper.isNaN(a[c]))return t("Tracing failed due to NaNs."),rc=!0,b;for(q=c+
1;4>q;q++)m=h.projectiveDistMinScal(f[c],f[q]),y>m&&(y=m),m=h.projectiveDistMinScal(b[c],b[q]),C>m&&(C=m)}if(ra&&ra.currentStep){const F=[ra.labelTracing4,p.wrap(ra.currentElement.name),h.turnIntoCSList(b),h.turnIntoCSList(f),h.realMatrix(d),p.wrap(k),p.wrap(y),p.wrap(C),A];ra.currentStep.push(h.turnIntoCSList(F));t=function(H){ra.hasOwnProperty(H)||(ra[H]=p.wrap(H));F[F.length-1]=ra[H]}}y>w&&C>w||(1E-5>C?1E-5>y?t("Staying inside singularity."):(t("Moved into singularity."),rc=!0):1E-5>y?t("Moved out of singularity."):
(Yd?t("Reached refinement limit, giving up."):t("Need to refine."),Hd()));return b}function Re(a){const b=a.length;let c;var d;if(ld){for(c=0;c<b;++c)dc+=2*a[c].value.length,Qa(a[c]);return a}const f=Array(b);var k=Array(b),m=Array(b);let q=99,t=99;const w=Array(b);for(c=0;c<b;++c)f[c]=Za(a[c].value.length),k[c]=h.normSquared(f[c]).value.real,m[c]=h.normSquared(a[c]).value.real,w[c]=Array(b);for(c=0;c<b;++c){for(d=0;d<b;++d){var y=h.sesquilinearproduct(f[c],a[d]).value;y=(y.real*y.real+y.imag*y.imag)/
(k[c]*m[d]);w[c][d]=1-y}for(d=c+1;d<b;++d)y=h.sesquilinearproduct(f[c],f[d]).value,y=(y.real*y.real+y.imag*y.imag)/(k[c]*k[d]),q>1-y&&(q=1-y),y=h.sesquilinearproduct(a[c],a[d]).value,y=(y.real*y.real+y.imag*y.imag)/(m[c]*m[d]),t>1-y&&(t=1-y)}y=Ac(w);d=Array(b);k=0;m=!1;for(c=0;c<b;++c){k+=w[c][y[c]];const C=d[c]=a[y[c]];Qa(C);m|=h._helper.isNaN(C)}m|=isNaN(k);a=function(){};if(ra&&ra.currentStep){const C=[ra.labelTracingSesq,p.wrap(ra.currentElement.name),h.turnIntoCSList(d),h.turnIntoCSList(f),h.realMatrix(w),
p.wrap(k),p.wrap(q),p.wrap(t),A];ra.currentStep.push(h.turnIntoCSList(C));a=function(F){ra.hasOwnProperty(F)||(ra[F]=p.wrap(F));C[C.length-1]=ra[F]}}m?(a("Tracing failed due to NaNs."),rc=!0):q>3*k&&t>3*k?a("Normal case, everything all right."):1E-5>t?1E-5>q?a("Staying inside singularity."):(a("Moved into singularity."),rc=!0):1E-5>q?a("Moved out of singularity."):(Yd?a("Reached refinement limit, giving up."):a("Need to refine."),Hd());return d}function cd(a,b){a=v._helper.flattenConicMatrix(a);b=
v._helper.flattenConicMatrix(b);const c=Za(6),d=Za(6);b=je(a,b,c,d);Qa(b[0]);Qa(b[1]);a=v._helper.buildConicMatrix(b[0].value);b=v._helper.buildConicMatrix(b[1].value);return h.turnIntoCSList([a,b])}function kb(a){if(kb.hasOwnProperty(a.kind))kb[a.kind](a)}function Dc(a){Dc.hasOwnProperty(a.kind)&&(a.incidences=[],Dc[a.kind](a))}function Se(a,b){return function(){a.incidences.push(b.name);b.incidences.push(a.name)}}function dd(a,b){return function(){a.Duplicate=b}}function Te(a,b){return{getInvolved:function(){return[a,
b]},toString:function(){return"point "+a.name+" incident line "+b.name},apply:Se(a,b),holds:function(){const c=h.scaldiv(h.abs(a.homog),a.homog),d=h.scaldiv(h.abs(b.homog),b.homog);return n.abs(h.scalproduct(c,d)).value.real<n.epsbig}}}function Ue(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"point "+a.name+" incident conic "+b.name},apply:Se(a,b),holds:function(){let c=p.mult(b.matrix,a.homog);c=p.mult(a.homog,c);c=n.abs(c);return c.value.real<n.epsbig}}}function le(){if(0!==
Pb.length){Lc.prover.set(Eb);var a,b=function(){a={};Pb.forEach(function(k){let m;k.getInvolved().forEach(function(q){a[q.name]||(a[q.name]=!0,m=c(q,{}),m.forEach(function(t){a[t]=!0}))})})},c=function(k,m){k.incidences.forEach(function(q){m[q]||(m[q]=!0,c(E.csnames[q],m))});return Object.keys(m)};b();var d=function(k){return k.holds()};Object.keys(a).forEach(function(k){k=E.csnames[k].args;"undefined"!==typeof k&&k.forEach(function(m){a[m]=!0})});for(let k=0;3>k;k++){for(const m in a){const q=E.csnames[m];
if(!q.pinned&&v[q.type].isMovable){var f=v[q.type].getRandomMove(q);Qb(q,f.value,f.type);Pb=Pb.filter(d)}}b()}Eb.set(Lc.prover);Qe();for(b=0;b<Pb.length;++b)Pb[b].apply();Pb=[]}}function ud(a,b,c){var d=document.createElement("div"),f=document.createElement("img");f.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAPoCAQAAAC1v1zVAAAAGklEQVR42u3BMQEAAADCoPVPbQ0PoAAAgHcDC7gAAVI8ZnwAAAAASUVORK5CYII=";d.className="CindyJS-baseline";d.appendChild(f);f=document.createElement("div");f.className="CindyJS-button";
d.appendChild(f);for(let k=2;k<arguments.length;++k)f.appendChild(arguments[k]);fb.parentNode.appendChild(d);a.html=arguments[arguments.length-1];Wb(a.fillalpha)||(a.fillalpha=1);a.fillcolor&&(a.html.style.backgroundColor=N.makeColor(a.fillcolor,a.fillalpha));Wb(a.alpha)||(a.alpha=1);a.color&&(a.html.style.color=N.makeColor(a.color,a.alpha));d=x;if(a.script){const k=uc(a.script);d=function(){L(k);x()}}c.addEventListener(b,d);!aa.keylistener&&(wa.keydown||wa.keyup||wa.keytyped)&&(c.addEventListener("keydown",
function(k){9!==k.keyCode&&X(k,wa.keydown)}),c.addEventListener("keyup",function(k){X(k,wa.keyup)}),c.addEventListener("keypress",function(k){9!==k.keyCode&&X(k,wa.keytyped)}));v.Text.initialize(a)}function bc(){}function Id(a){if(!/^Select/.test(a.type)&&!v[a.type].isMovable)return null;const b=p.unwrap,c=n.add;switch(a.kind){case "P":case "L":case "Text":return b(a.homog);case "C":return a=a.matrix.value,{xx:b(a[0].value[0]),yy:b(a[1].value[1]),zz:b(a[2].value[2]),xy:b(c(a[0].value[1],a[1].value[0])),
xz:b(c(a[0].value[2],a[2].value[0])),yz:b(c(a[1].value[2],a[2].value[1]))};default:return null}}function Jd(a){const b={};b.offset=p.unwrap(a.offset);a.to&&(b.to=a.to);a.corner&&(b.corner=a.corner);return b}function mf(a){const b={},c={pinned:!1,movable:!0};"P"===a.kind&&Je(c);"L"===a.kind&&ad(c);"C"===a.kind&&ad(c);"S"===a.kind&&Ke(c);"Text"===a.kind&&vc(c);"Poly"===a.kind&&fe(c);Gf.forEach(function(f){if(a.hasOwnProperty(f)){var k=p.unwrap(a[f]),m=p.unwrap(c[f]);null!==k&&void 0!==k&&k!==m&&JSON.stringify(k)!==
JSON.stringify(m)&&(b[f]=k)}});if("P"===a.kind&&(!a.movable||a.pinned)&&b.color){var d=n.real(1/ub.dimDependent);b.color=p.unwrap(h.scalmult(d,a.color))}if(d=Id(a))b.pos=d;a.dock&&(b.dock=Jd(a.dock));return b}function me(){const a=[];E.gslp.forEach(function(b){b.tmp||a.push(mf(b))});return a}function ed(){lc.forEach(function(a){const b=(a.geo||[]).map(function(c){return E.csnames[c]});Ha[a.type].reset(a,b[0],b)})}function fd(a){sf=0!==a.length;lc=[];Ib=[];xf=[];Ha.Environment.init({});a.forEach(function(b){b.behavior?
(b.name&&(b.behavior.geo=[b.name]),b=b.behavior,b.gravity&&(b.gravity=-b.gravity)):c=b.geo;var c=(b.geo||[]).map(function(k){return E.csnames[k]});const d=c[0],f=Ha[b.type];f?(f.init&&f.init(b,d,c),d&&(d.behavior=b,"Mass"===b.type?Ib.push(d):"Spring"===b.type&&xf.push(d)),lc.push(b)):(console.error(b),console.error("Behavior "+b.type+" not implemented yet"))})}const Ob=this;let Kb;const wa={};let xc=!1,Kd=!0,gd=0,Ve=.5,We=0,Uc=10;const Ye=5/360,qf=.32/Ye/1E3*2;let Ld=1,Rb=0,oe=0,Vc=!1,id=.2,xd=!1,
Md=0,Nd=0,pb=1,fb,Od;const Wb=Number.isFinite||function(a){return"number"===typeof a&&isFinite(a)};let tb;var P,gb,ib;let E,yc,Pd=A,pe=A;const hc={play:bc,pause:bc,stop:bc};var Qd=null,yd=function(a,b){let c=[];yd=function(k,m){c.push({img:k,id:m})};yd(a,b);const d=Ob.getBaseDir()+"images/Icons.svg",f=new XMLHttpRequest;f.onreadystatechange=function(){if(f.readyState===XMLHttpRequest.DONE)if(200!==f.status)console.error("Failed to load CindyJS Icons.svg from "+d+": "+f.statusText);else{var k=f.responseXML,
m=k.documentElement,q={},t;for(t=m.firstChild;t;t=w){var w=t.nextSibling;t.nodeType===Node.ELEMENT_NODE&&"http://www.w3.org/2000/svg"===t.namespaceURI&&"g"===t.localName.toLowerCase()&&(m.removeChild(t),t.setAttribute("style","display:inline"),q[t.getAttribute("id")]=t)}var y=new XMLSerializer;yd=function(C,F){if(q.hasOwnProperty(F)){F=q[F];m.appendChild(F);try{var H=y.serializeToString(k)}finally{m.removeChild(F)}C.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(H)}};c.forEach(function(C){yd(C.img,
C.id)});c=null}};f.responseType="document";f.open("GET",d);f.send()};let qe=1,jd=null;const Gc=[];let zd=!1;var Mb={config:aa,startup:mb,shutdown:Db,evokeCS:function(a){a=uc(a,!1);L(a);x()},play:Ca,pause:Gb,stop:Jb,evalcs:function(a){return L(uc(a,!1))},parse:function(a){return uc(a)},niceprint:ja,canvas:null},Rd=!1,Sd=0;aa.use&&aa.use.forEach(function(a){let b=null;aa.plugins&&(b=aa.plugins[a]);b||(b=Ob._pluginRegistry[a]);b||(++Sd,console.log("Loading script for plugin "+a),Ob.loadScript(a+"-plugin",
a+"-plugin.js",function(){console.log("Successfully loaded plugin "+a);0===--Sd&&Rd&&mb()},function(){console.error("Failed to auto-load plugin "+a);0===--Sd&&Rd&&mb()}))});Cb.prototype=new Hb;Ab.prototype=new Hb;nd.prototype=new Hb;const ab={};let qb,Td="",Ud=0,ic=0;const Hc={},Nb={};var Xb=aa.isNode?process.nextTick:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,
0)};let Vd=null;var Ze=[0,8,13,59,"g515d277"];const n={_helper:{}};n._helper.roundingfactor=1E4;n._helper.angleroundingfactor=10;n._helper.niceround=function(a,b){return Math.round(a*b)/b};n.niceprint=function(a,b){b=b||n._helper.roundingfactor;if("Angle"===a.usage)return n._helper.niceangle(a);const c=n._helper.niceround(a.value.real,b);a=n._helper.niceround(a.value.imag,b);return 0===a?""+c:0<a?""+c+" + i*"+a:""+c+" - i*"+-a};const re=aa.angleUnit||"\u00b0",se=re.replace(/\s+/g,""),te=2*Math.PI,
$e=1/te,rf={rad:te,"\u00b0":360,deg:360,degree:360,gra:400,grad:400,turn:1,cyc:1,rev:1,rot:1,"\u03c0":2,pi:2,quad:4};n._helper.niceangle=function(a){const b=rf[se];if(!b)return n.niceprint(p.withUsage(a,null));if("function"===typeof b)return b(a);a=n.niceprint(n.realmult(b*$e,a),200<b?n._helper.angleroundingfactor:null);return a.includes("i*")?"("+a+")"+re:a+re};n.complex=function(a,b){return{ctype:"number",value:{real:a,imag:b}}};n.real=function(a){return{ctype:"number",value:{real:a,imag:0}}};n.zero=
n.real(0);n.one=n.real(1);n.infinity=n.complex(Infinity,Infinity);n.nan=n.complex(NaN,NaN);n._helper.input=function(a){return"object"===typeof a?n.complex(+a.r,+a.i):n.real(+a)};n.argmax=function(a,b){return a.value.real*a.value.real+a.value.imag*a.value.imag<b.value.real*b.value.real+b.value.imag*b.value.imag?b:a};n.max=function(a,b){return{ctype:"number",value:{real:Math.max(a.value.real,b.value.real),imag:Math.max(a.value.imag,b.value.imag)}}};n.min=function(a,b){return{ctype:"number",value:{real:Math.min(a.value.real,
b.value.real),imag:Math.min(a.value.imag,b.value.imag)}}};n.add=function(a,b){return{ctype:"number",value:{real:a.value.real+b.value.real,imag:a.value.imag+b.value.imag}}};n.sub=function(a,b){return{ctype:"number",value:{real:a.value.real-b.value.real,imag:a.value.imag-b.value.imag}}};n.neg=function(a){return Object.assign({},a,{ctype:"number",value:{real:-a.value.real,imag:-a.value.imag}})};n.re=function(a){return{ctype:"number",value:{real:a.value.real,imag:0}}};n.im=function(a){return{ctype:"number",
value:{real:a.value.imag,imag:0}}};n.conjugate=function(a){return{ctype:"number",value:{real:a.value.real,imag:-a.value.imag}}};n.round=function(a){return{ctype:"number",value:{real:Math.round(a.value.real),imag:Math.round(a.value.imag)}}};n.ceil=function(a){return{ctype:"number",value:{real:Math.ceil(a.value.real),imag:Math.ceil(a.value.imag)}}};n.floor=function(a){return{ctype:"number",value:{real:Math.floor(a.value.real),imag:Math.floor(a.value.imag)}}};n.mult=function(a,b){return{ctype:"number",
value:{real:a.value.real*b.value.real-a.value.imag*b.value.imag,imag:a.value.real*b.value.imag+a.value.imag*b.value.real}}};n.realmult=function(a,b){return{ctype:"number",value:{real:a*b.value.real,imag:a*b.value.imag}}};n.multiMult=function(a){let b=a[0];if("number"!==b.ctype)return A;for(let c=1;c<a.length;c++){if("number"!==a[c].ctype)return A;b=n.mult(b,a[c])}return b};n.abs2=function(a){return{ctype:"number",value:{real:a.value.real*a.value.real+a.value.imag*a.value.imag,imag:0}}};n.abs=function(a){return n.sqrt(n.abs2(a))};
n.inv=function(a){const b=a.value.real*a.value.real+a.value.imag*a.value.imag;return{ctype:"number",value:{real:a.value.real/b,imag:-a.value.imag/b}}};n.div=function(a,b){const c=a.value.real;a=a.value.imag;const d=b.value.real;b=b.value.imag;const f=d*d+b*b;return{ctype:"number",value:{real:(c*d+a*b)/f,imag:(a*d-c*b)/f}}};n.eps=1E-10;n.epsbig=1E-6;n.snap=function(a){let b=a.value.real,c=a.value.imag;Math.floor(b+n.eps)!==Math.floor(b-n.eps)&&(b=Math.round(b));Math.floor(c+n.eps)!==Math.floor(c-n.eps)&&
(c=Math.round(c));return Object.assign({},a,{ctype:"number",value:{real:b,imag:c}})};n.exp=function(a){const b=Math.exp(a.value.real);return{ctype:"number",value:{real:b*Math.cos(a.value.imag),imag:b*Math.sin(a.value.imag)}}};n.cos=function(a){const b=a.value.real;a=a.value.imag;let c=Math.exp(a);const d=c*Math.sin(-b),f=c*Math.cos(-b);c=Math.exp(-a);return{ctype:"number",value:{real:(f+c*Math.cos(b))/2,imag:(d+c*Math.sin(b))/2}}};n.sin=function(a){const b=a.value.real;a=a.value.imag;let c=Math.exp(a);
const d=c*Math.sin(-b),f=c*Math.cos(-b);c=Math.exp(-a);return{ctype:"number",value:{real:-(d-c*Math.sin(b))/2,imag:(f-c*Math.cos(b))/2}}};n.tan=function(a){const b=n.sin(a);a=n.cos(a);return n.div(b,a)};n.arccos=function(a){var b=n.mult(a,n.neg(a));b=n.sqrt(n.add(n.real(1),b));a=n.add(n.mult(a,n.complex(0,1)),b);a=n.add(n.mult(n.log(a),n.complex(0,1)),n.real(.5*Math.PI));return p.withUsage(a,"Angle")};n.arcsin=function(a){var b=n.mult(a,n.neg(a));b=n.sqrt(n.add(n.real(1),b));a=n.add(n.mult(a,n.complex(0,
1)),b);a=n.mult(n.log(a),n.complex(0,-1));return p.withUsage(a,"Angle")};n.arctan=function(a){var b=n.log(n.add(n.mult(a,n.complex(0,-1)),n.real(1)));a=n.log(n.add(n.mult(a,n.complex(0,1)),n.real(1)));b=n.mult(n.sub(b,a),n.complex(0,.5));return p.withUsage(b,"Angle")};n.arctan2=function(a,b){if(void 0===b)var c=n.real(Math.atan2(a.value.imag,a.value.real));else n._helper.isReal(a)&&n._helper.isReal(b)?c=n.real(Math.atan2(b.value.real,a.value.real)):(c=n.add(a,n.mult(n.complex(0,1),b)),a=n.sqrt(n.add(n.mult(a,
a),n.mult(b,b))),c=n.mult(n.complex(0,-1),n.log(n.div(c,a))));return p.withUsage(c,"Angle")};n.sqrt=function(a){var b=a.value.real;const c=a.value.imag;a=Math.sqrt(Math.sqrt(b*b+c*c));b=Math.atan2(c,b);return{ctype:"number",value:{real:a*Math.cos(b/2),imag:a*Math.sin(b/2)}}};n.powRealExponent=function(a,b){var c=a.value.real;const d=a.value.imag;a=Math.sqrt(c*c+d*d)**b;c=Math.atan2(d,c);return{ctype:"number",value:{real:a*Math.cos(c*b),imag:a*Math.sin(c*b)}}};n.powIntegerExponent=function(a,b){return 0>
b?n.powIntegerExponent(n.inv(a),-b):0===b?n.one:0===b%2?n.powIntegerExponent(n.mult(a,a),b/2):1===b%2?n.mult(a,n.powIntegerExponent(n.mult(a,a),(b-1)/2)):A};n.log=function(a){const b=a.value.real;a=a.value.imag;const c=Math.sqrt(b*b+a*a);let d=Math.atan2(a,b);0>a&&(d+=2*Math.PI);0===a&&0>b&&(d=Math.PI);d>Math.PI&&(d-=2*Math.PI);return n.snap({ctype:"number",value:{real:Math.log(c),imag:d}})};n.pow=function(a,b){return n._helper.isZero(b)?n.one:n._helper.isZero(a)?n.zero:[a,b].every(n._helper.isReal)?
n.real(a.value.real**b.value.real):n._helper.isReal(b)?(b=b.value.real,Number.isInteger(b)?n.powIntegerExponent(a,b):n.powRealExponent(a,b)):n.exp(n.mult(n.log(a),b))};n.mod=function(a,b){var c=a.value.real;const d=b.value.real;var f=a.value.imag;const k=b.value.imag;c-=Math.floor(c/d)*d;f-=Math.floor(f/k)*k;0===d&&(c=0);0===k&&(f=0);return n.snap(Object.assign({},[a,b].every(m=>"Angle"===m.usage)&&{usage:"Angle"},{ctype:"number",value:{real:c,imag:f}}))};n._helper.seed="NO";n._helper.seedrandom=
function(a){a-=Math.floor(a);n._helper.seed=.8*a+.1};n._helper.rand=function(){if("NO"===n._helper.seed)return Math.random();let a=n._helper.seed;a=1E3*Math.sin(1E3*a);a-=Math.floor(a);return n._helper.seed=a};n._helper.randnormal=function(){const a=n._helper.rand(),b=n._helper.rand();return Math.sqrt(-2*Math.log(a))*Math.cos(2*Math.PI*b)};n._helper.isEqual=function(a,b){return a.value.real===b.value.real&&a.value.imag===b.value.imag};n._helper.isLessThan=function(a,b){return a.value.real<b.value.real||
a.value.real===b.value.real&&a.value.imag<b.value.imag};n._helper.compare=function(a,b){return n._helper.isLessThan(a,b)?-1:n._helper.isEqual(a,b)?0:1};n._helper.isAlmostEqual=function(a,b,c){let d=n.eps;"undefined"!==typeof c&&(d=c);c=a.value.real-b.value.real;a=a.value.imag-b.value.imag;return c<d&&c>-d&&a<d&&a>-d};n._helper.isZero=function(a){return 0===a.value.real&&0===a.value.imag};n._helper.isAlmostZero=function(a){const b=a.value.real;a=a.value.imag;return b<n.eps&&b>-n.eps&&a<n.eps&&a>-n.eps};
n._helper.isReal=function(a){return 0===a.value.imag};n._helper.isAlmostReal=function(a){a=a.value.imag;return a<n.epsbig&&a>-n.epsbig};n._helper.isNaN=function(a){return isNaN(a.value.real)||isNaN(a.value.imag)};n._helper.isFinite=function(a){return isFinite(a.value.real)&&isFinite(a.value.imag)};n._helper.isAlmostImag=function(a){a=a.value.real;return a<n.epsbig&&a>-n.epsbig};n._helper.z3a=n.complex(-.5,.5*Math.sqrt(3));n._helper.z3b=n.complex(-.5,-.5*Math.sqrt(3));n._helper.cub1={ctype:"list",
value:[n.one,n.one,n.one]};n._helper.cub2={ctype:"list",value:[n._helper.z3a,n.one,n._helper.z3b]};n._helper.cub3={ctype:"list",value:[n._helper.z3b,n.one,n._helper.z3a]};n.solveCubic=function(a,b,c,d){a=n._helper.solveCubicHelper(a,b,c,d);return[h.scalproduct(n._helper.cub1,a),h.scalproduct(n._helper.cub2,a),h.scalproduct(n._helper.cub3,a)]};n._helper.solveCubicHelper=function(a,b,c,d){var f=a.value.real;a=a.value.imag;var k=b.value.real;b=b.value.imag;var m=c.value.real;const q=c.value.imag,t=d.value.real,
w=d.value.imag;var y=f*m-a*q;c=f*q+a*m;d=4*y-(k*k-b*b);var C=4*c-2*k*b;const F=f*k-a*b,H=f*b+a*k,R=d*m-C*q-18*(F*t-H*w);C=d*q+C*m-18*(F*w+H*t);d=27*(f*f-a*a);var S=54*a*f;const Z=d*t-S*w,U=d*w+S*t,pa=k*k-b*b;var da=2*k*b;let Ba=pa*k-da*b,Oa=pa*b+da*k,ta=Z+4*Ba;S=U+4*Oa;d=27*(R*m-C*q+ta*t-S*w);C=27*(R*q+C*m+ta*w+S*t);ta=Math.sqrt(Math.sqrt(d*d+C*C));S=Math.atan2(C,d);C=ta*Math.sin(S/2);d=ta*Math.cos(S/2);Ba=-2*Ba+9*(F*m-H*q)-Z+(d*f-C*a);Oa=-2*Oa+9*(F*q+H*m)-U+(d*a+C*f);d=Math.exp(Math.log(Math.sqrt(Ba*
Ba+Oa*Oa))/3);m=Math.atan2(Oa,Ba);S=d*Math.sin(m/3);C=d*Math.cos(m/3);d*=d;m*=2;y=2*pa-6*y;c=2*da-6*c;da=-1.5874010519681996*(k*C-b*S);k=-1.5874010519681996*(k*S+b*C);b=1.2599210498948732*d*Math.cos(m/3);m=1.2599210498948732*d*Math.sin(m/3);d=4.762203155904599*(C*f-S*a);C=4.762203155904599*(C*a+S*f);f=d*d+C*C;S=(-y*C+c*d)/f;y=(y*d+c*C)/f;c=S;S=(-da*C+k*d)/f;da=(da*d+k*C)/f;k=S;S=(-b*C+m*d)/f;b=(b*d+m*C)/f;m=S;return h.turnIntoCSList([n.complex(y,c),n.complex(da,k),n.complex(b,m)])};n._helper.getRangeRand=
function(a,b){return Math.random()*(b-a)+a};n.getRandReal=function(a,b){a=n._helper.getRangeRand(a,b);return n.real(a)};n.getRandComplex=function(a,b){const c=n._helper.getRangeRand(a,b);a=n._helper.getRangeRand(a,b);return n.complex(c,a)};const h={_helper:{},turnIntoCSList:function(a){return{ctype:"list",value:a}}};h.EMPTY=h.turnIntoCSList([]);h.asList=function(a){return"list"===a.ctype?a:"number"===a.ctype||"boolean"===a.ctype||"geo"===a.ctype?h.turnIntoCSList([a]):h.EMPTY};h.realVector=function(a){const b=
[];for(let c=0;c<a.length;c++)b[c]={ctype:"number",value:{real:a[c],imag:0}};return{ctype:"list",value:b}};h._helper.unitvector=function(a,b){a=h.zerovector(a);a.value[Math.floor(b.value.real-1)]=n.real(1);return a};h.idMatrix=function(a){const b=h.zeromatrix(a,a),c=n.real(1);for(let d=0;d<a.value.real;d++)b.value[d].value[d]=c;return b};h._helper.flippedidMatrix=function(a){const b=h.zeromatrix(a,a),c=n.real(1);for(let d=0;d<a.value.real;d++)b.value[d].value[a.value.real-d-1]=c;return b};h.println=
function(a){const b=[];for(let c=0;c<a.value.length;c++)if("number"===a.value[c].ctype)b[c]=n.niceprint(a.value[c]);else if("list"===a.value[c].ctype)h.println(a.value[c]);else return A;"number"===a.value[0].ctype&&console.log(b)};h.matrix=function(a){return h.turnIntoCSList(a.map(h.turnIntoCSList))};h.realMatrix=function(a){const b=a.length,c=Array(b);for(let d=0;d<b;d++)c[d]=h.realVector(a[d]);return h.turnIntoCSList(c)};h.ex=h.realVector([1,0,0]);h.ey=h.realVector([0,1,0]);h.ez=h.realVector([0,
0,1]);h.linfty=h.realVector([0,0,1]);h.ii=h.turnIntoCSList([n.complex(1,0),n.complex(0,1),n.complex(0,0)]);h.jj=h.turnIntoCSList([n.complex(1,0),n.complex(0,-1),n.complex(0,0)]);h.fundDual=h.realMatrix([[1,0,0],[0,1,0],[0,0,0]]);h.fund=h.realMatrix([[0,0,0],[0,0,0],[0,0,1]]);h.sequence=function(a,b){a=Math.ceil(a.value.real);b=Math.floor(b.value.real)+1;let c=[];for(let d=a,f=0;d<b;d++,f++)c[f]=n.real(d);return h.turnIntoCSList(c)};h.pairs=function(a){const b=[];for(let c=0;c<a.value.length-1;c++)for(let d=
c+1;d<a.value.length;d++)b.push({ctype:"list",value:[a.value[c],a.value[d]]});return{ctype:"list",value:b}};h.triples=function(a){const b=[];for(let c=0;c<a.value.length-2;c++)for(let d=c+1;d<a.value.length-1;d++)for(let f=d+1;f<a.value.length;f++)b.push({ctype:"list",value:[a.value[c],a.value[d],a.value[f]]});return{ctype:"list",value:b}};h.cycle=function(a){const b=[];for(let c=0;c<a.value.length-1;c++)b[c]={ctype:"list",value:[a.value[c],a.value[c+1]]};b.push({ctype:"list",value:[a.value[a.value.length-
1],a.value[0]]});return{ctype:"list",value:b}};h.consecutive=function(a){const b=[];for(let c=0;c<a.value.length-1;c++)b[c]={ctype:"list",value:[a.value[c],a.value[c+1]]};return{ctype:"list",value:b}};h.reverse=function(a){const b=Array(a.value.length);for(let c=a.value.length-1,d=0;0<=c;c--,d++)b[d]=a.value[c];return{ctype:"list",value:b}};h.directproduct=function(a,b){const c=[];for(let d=0;d<a.value.length;d++)for(let f=0;f<b.value.length;f++)c.push({ctype:"list",value:[a.value[d],b.value[f]]});
return{ctype:"list",value:c}};h.concat=function(a,b){const c=[];for(let d=0;d<a.value.length;d++)c.push(a.value[d]);for(a=0;a<b.value.length;a++)c.push(b.value[a]);return{ctype:"list",value:c}};h.prepend=function(a,b){const c=[];c[0]=a;for(a=0;a<b.value.length;a++)c[a+1]=b.value[a];return{ctype:"list",value:c}};h.append=function(a,b){const c=[];for(let d=0;d<a.value.length;d++)c[d]=a.value[d];c.push(b);return{ctype:"list",value:c}};h.contains=function(a,b){for(const c of a.value)if(K.equals(c,b).value)return{ctype:"boolean",
value:!0};return{ctype:"boolean",value:!1}};h.common=function(a,b){const c=[];let d=0;for(let f=0;f<a.value.length;f++){let k=!1;const m=a.value[f];for(let q=0;q<b.value.length;q++)k=k||K.equals(m,b.value[q]).value;k&&(c[d]=a.value[f],d++)}return{ctype:"list",value:c}};h.remove=function(a,b){const c=[];let d=0;for(let f=0;f<a.value.length;f++){let k=!1;const m=a.value[f];for(let q=0;q<b.value.length;q++)k=k||K.equals(m,b.value[q]).value;k||(c[d]=a.value[f],d++)}return{ctype:"list",value:c}};h.sort1=
function(a){a=a.value.slice();a.sort(p.compare);return h.turnIntoCSList(a)};h._helper.isEqual=function(a,b){return h.equals(a,b).value};h._helper.isLessThan=function(a,b){const c=a.value.length,d=b.value.length;let f=0;for(;!(f>=c||f>=d)&&p.isEqual(a.value[f],b.value[f]);)f++;return f===c&&f<d?!0:f===d&&f<c||f===c&&f===d?!1:p.isLessThan(a.value[f],b.value[f])};h._helper.compare=function(a,b){return h._helper.isLessThan(a,b)?-1:h._helper.isEqual(a,b)?0:1};h.equals=function(a,b){if(a.value.length!==
b.value.length)return{ctype:"boolean",value:!1};let c=!0;for(let d=0;d<a.value.length;d++){const f=a.value[d],k=b.value[d];c="list"===f.ctype&&"list"===k.ctype?c&&h.equals(f,k).value:c&&Ma([f,k],[]).value}return{ctype:"boolean",value:c}};h.almostequals=function(a,b){if(a.value.length!==b.value.length)return{ctype:"boolean",value:!1};let c=!0;for(let d=0;d<a.value.length;d++){const f=a.value[d],k=b.value[d];c="list"===f.ctype&&"list"===k.ctype?c&&h.almostequals(f,k).value:c&&wb([f,k],[]).value}return{ctype:"boolean",
value:c}};h._helper.isAlmostReal=function(a){let b=!0;for(const c of a.value)b="list"===c.ctype?b&&h._helper.isAlmostReal(c):b&&n._helper.isAlmostReal(c);return b};h._helper.isAlmostZero=function(a){for(const b of a.value)if("list"===b.ctype){if(!h._helper.isAlmostZero(b))return!1}else if(!n._helper.isAlmostZero(b))return!1;return!0};h._helper.isNaN=function(a){let b=!1;for(const c of a.value)b="list"===c.ctype?b||h._helper.isNaN(c):b||n._helper.isNaN(c);return b};h.set=function(a){const b=[];let c=
0;a=a.value.slice();a.sort(p.compare);for(let d=0;d<a.length;d++)0!==d&&Ma([b[b.length-1],a[d]],[]).value||(b[c]=a[d],c++);return{ctype:"list",value:b}};h.maxval=function(a){let b=n.zero;for(const c of a.value)"number"===c.ctype&&(b=n.argmax(b,c)),"list"===c.ctype&&(b=n.argmax(b,h.maxval(c)));return b};h.maxIndex=function(a,b,c){var d=0;void 0!==c&&(d=c);c=d;let f=b(a.value[d]).value.real;for(;d<a.value.length;++d){const k=b(a.value[d]).value.real;k>f&&(c=d,f=k)}return c};h.normalizeMax=function(a){const b=
n.inv(h.maxval(a));return n._helper.isFinite(b)?h.scalmult(b,a):a};h.normalizeZ=function(a){const b=n.inv(a.value[2]);return h.scalmult(b,a)};h.dehom=function(a){a=a.value.slice();const b=a.length-1,c=n.inv(a[b]);a.length=b;for(let d=0;d<b;++d)a[d]=n.mult(c,a[d]);return h.turnIntoCSList(a)};h.normalizeAbs=function(a){const b=n.inv(h.abs(a));return h.scalmult(b,a)};h.max=function(a,b){if(a.value.length!==b.value.length)return A;const c=[];for(let d=0;d<a.value.length;d++)c[d]=p.max(a.value[d],b.value[d]);
return{ctype:"list",value:c}};h.min=function(a,b){if(a.value.length!==b.value.length)return A;const c=[];for(let d=0;d<a.value.length;d++)c[d]=p.min(a.value[d],b.value[d]);return{ctype:"list",value:c}};h.scaldiv=function(a,b){if("number"!==a.ctype)return A;const c=[];for(let d=0;d<b.value.length;d++){const f=b.value[d];c[d]="number"===f.ctype?p.div(f,a):"list"===f.ctype?h.scaldiv(a,f):A}return{ctype:"list",value:c}};h.scalmult=function(a,b){if("number"!==a.ctype)return A;const c=[];for(let d=0;d<
b.value.length;d++){const f=b.value[d];c[d]="number"===f.ctype?p.mult(f,a):"list"===f.ctype?h.scalmult(a,f):A}return{ctype:"list",value:c}};h.add=function(a,b){if(a.value.length!==b.value.length)return A;const c=[];for(let d=0;d<a.value.length;d++){const f=a.value[d],k=b.value[d];c[d]="number"===f.ctype&&"number"===k.ctype?p.add(f,k):"list"===f.ctype&&"list"===k.ctype?h.add(f,k):A}return{ctype:"list",value:c}};h.sub=function(a,b){if(a.value.length!==b.value.length)return A;const c=[];for(let d=0;d<
a.value.length;d++){const f=a.value[d],k=b.value[d];c[d]="number"===f.ctype&&"number"===k.ctype?n.sub(f,k):"list"===f.ctype&&"list"===k.ctype?h.sub(f,k):A}return{ctype:"list",value:c}};h.abs2=function(a){let b=0;for(const c of a.value)if("number"===c.ctype)b+=n.abs2(c).value.real;else if("list"===c.ctype)b+=h.abs2(c).value.real;else return A;return{ctype:"number",value:{real:b,imag:0}}};h.abs=function(a){return n.sqrt(h.abs2(a))};h.normalizeMaxXX=function(a){let b=-1E4,c=n.real(1);for(let d=0;d<a.value.length;d++){const f=
n.abs(a.value[d]);f.value.real>b&&(c=a.value[d],b=f.value.real)}return h.scaldiv(c,a)};h.recursive=function(a,b){const c=[];for(let d=0;d<a.value.length;d++){const f=W(a.value[d]);c[d]="number"===f.ctype?n[b](f):"list"===f.ctype?h[b](f):A}return{ctype:"list",value:c}};h.re=function(a){return h.recursive(a,"re")};h.neg=function(a){return h.recursive(a,"neg")};h.im=function(a){return h.recursive(a,"im")};h.conjugate=function(a){return h.recursive(a,"conjugate")};h.transjugate=function(a){return h.transpose(h.conjugate(a))};
h.round=function(a){return h.recursive(a,"round")};h.ceil=function(a){return h.recursive(a,"ceil")};h.floor=function(a){return h.recursive(a,"floor")};h._helper.colNumb=function(a){if("list"!==a.ctype)return-1;let b=-1;for(let c=0;c<a.value.length;c++){if("list"!==a.value[c].ctype)return-1;if(0===c)b=a.value[c].value.length;else if(b!==a.value[c].value.length)return-1}return b};h._helper.isNumberVecN=function(a,b){if("list"!==a.ctype||a.value.length!==b)return!1;for(b=0;b<a.value.length;b++)if("number"!==
a.value[b].ctype)return!1;return!0};h.isNumberVector=function(a){if("list"!==a.ctype)return{ctype:"boolean",value:!1};for(let b=0;b<a.value.length;b++)if("number"!==a.value[b].ctype)return{ctype:"boolean",value:!1};return{ctype:"boolean",value:!0}};h.isNumberVectorN=function(a,b){if("list"!==a.ctype)return{ctype:"boolean",value:!1};if(a.value)for(b=0;b<a.value.length;b++)if("number"!==a.value[b].ctype)return{ctype:"boolean",value:!1};return{ctype:"boolean",value:!0}};h.isNumberMatrix=function(a){if(-1===
h._helper.colNumb(a))return{ctype:"boolean",value:!1};for(let b=0;b<a.value.length;b++)if(!h.isNumberVector(a.value[b]).value)return{ctype:"boolean",value:!1};return{ctype:"boolean",value:!0}};h._helper.isNumberMatrixMN=function(a,b,c){return h.isNumberMatrix(a).value&&a.value.length===b&&a.value[0].value.length===c};h.scalproduct=function(a,b){if(a.value.length!==b.value.length)return A;let c={ctype:"number",value:{real:0,imag:0}};for(let d=0;d<b.value.length;d++){const f=a.value[d],k=b.value[d];
if("number"===f.ctype&&"number"===k.ctype)c=n.add(n.mult(f,k),c);else return A}return c};h.sesquilinearproduct=function(a,b){if(a.value.length!==b.value.length)return A;let c=0,d=0;for(let f=0;f<b.value.length;f++){const k=a.value[f].value,m=b.value[f].value;c+=k.real*m.real+k.imag*m.imag;d+=k.real*m.imag-k.imag*m.real}return n.complex(c,d)};h.normSquared=function(a){let b=0;for(let c=0;c<a.value.length;c++){const d=a.value[c].value;b+=d.real*d.real+d.imag*d.imag}return n.real(b)};h.productMV=function(a,
b){if(a.value[0].value.length!==b.value.length)return A;const c=[];for(let d=0;d<a.value.length;d++){let f={ctype:"number",value:{real:0,imag:0}};const k=a.value[d];for(let m=0;m<b.value.length;m++){const q=k.value[m],t=b.value[m];if("number"===q.ctype&&"number"===t.ctype)f=n.add(n.mult(q,t),f);else return A}c[d]=f}return h.turnIntoCSList(c)};h.productVM=function(a,b){if(a.value.length!==b.value.length)return A;const c=[];for(let d=0;d<b.value[0].value.length;d++){let f={ctype:"number",value:{real:0,
imag:0}};for(let k=0;k<a.value.length;k++){const m=a.value[k],q=b.value[k].value[d];if("number"===m.ctype&&"number"===q.ctype)f=n.add(n.mult(m,q),f);else return A}c[d]=f}return h.turnIntoCSList(c)};h.productMM=function(a,b){if(a.value[0].value.length!==b.value.length)return A;const c=[];for(let d=0;d<a.value.length;d++){const f=h.productVM(a.value[d],b);c[d]=f}return h.turnIntoCSList(c)};h.mult=function(a,b){return a.value.length===b.value.length&&h.isNumberVector(a).value&&h.isNumberVector(b).value?
h.scalproduct(a,b):h.isNumberMatrix(a).value&&b.value.length===a.value[0].value.length&&h.isNumberVector(b).value?h.productMV(a,b):h.isNumberMatrix(b).value&&a.value.length===b.value.length&&h.isNumberVector(a).value?h.productVM(a,b):h.isNumberMatrix(a).value&&h.isNumberMatrix(b).value&&b.value.length===a.value[0].value.length?h.productMM(a,b):A};h.projectiveDistMinScal=function(a,b){const c=h.abs(a);var d=h.abs(b);if(0===c.value.real||0===d.value.real)return 0;var f=h.conjugate(b);f=h.scalproduct(a,
f);f=n._helper.isAlmostZero(f)?n.real(1):n.div(f,n.abs(f));a=h.scaldiv(c,a);b=h.scaldiv(d,b);b=h.scalmult(f,b);d=h.abs(h.add(a,b));b=h.abs(h.sub(a,b));return Math.min(d.value.real,b.value.real)};h.conicDist=function(a,b){a=Fa(a);b=Fa(b);return h.projectiveDistMinScal(a,b)};h.crossOperator=function(a){const b=a.value[0],c=a.value[1];a=a.value[2];return h.turnIntoCSList([h.turnIntoCSList([n.zero,n.neg(a),c]),h.turnIntoCSList([a,n.zero,n.neg(b)]),h.turnIntoCSList([n.neg(c),b,n.zero])])};h.cross=function(a,
b){const c=n.sub(n.mult(a.value[1],b.value[2]),n.mult(a.value[2],b.value[1])),d=n.sub(n.mult(a.value[2],b.value[0]),n.mult(a.value[0],b.value[2]));a=n.sub(n.mult(a.value[0],b.value[1]),n.mult(a.value[1],b.value[0]));return h.turnIntoCSList([c,d,a])};h.crossratio3harm=function(a,b,c,d,f){var k=h.det3(a,c,f),m=h.det3(b,d,f);a=h.det3(a,d,f);b=h.det3(b,c,f);k=n.mult(k,m);m=n.mult(a,b);return h.turnIntoCSList([k,m])};h.crossratio3=function(a,b,c,d,f){a=h.crossratio3harm(a,b,c,d,f);return n.div(a.value[0],
a.value[1])};h.veronese=function(a){const b=n.mult(a.value[0],a.value[0]),c=n.mult(a.value[1],a.value[1]),d=n.mult(a.value[2],a.value[2]),f=n.mult(a.value[0],a.value[1]),k=n.mult(a.value[0],a.value[2]);a=n.mult(a.value[1],a.value[2]);return h.turnIntoSCList([b,c,d,f,k,a])};h.matrixFromVeronese=function(a){const b=a.value[0],c=a.value[1],d=a.value[2],f=n.realmult(.5,a.value[3]),k=n.realmult(.5,a.value[4]);a=n.realmult(.5,a.value[5]);return h.turnIntoCSList([h.turnIntoCSList([b,f,k]),h.turnIntoCSList([f,
c,a]),h.turnIntoCSList([k,a,d])])};h.det2=function(a,b){let c=n.mult(a.value[0],b.value[1]);return c=n.sub(c,n.mult(a.value[1],b.value[0]))};h.det3=function(a,b,c){return n.complex(a.value[0].value.real*b.value[1].value.real*c.value[2].value.real-a.value[0].value.imag*b.value[1].value.imag*c.value[2].value.real-a.value[0].value.imag*b.value[1].value.real*c.value[2].value.imag-a.value[0].value.real*b.value[1].value.imag*c.value[2].value.imag+a.value[2].value.real*b.value[0].value.real*c.value[1].value.real-
a.value[2].value.imag*b.value[0].value.imag*c.value[1].value.real-a.value[2].value.imag*b.value[0].value.real*c.value[1].value.imag-a.value[2].value.real*b.value[0].value.imag*c.value[1].value.imag+a.value[1].value.real*b.value[2].value.real*c.value[0].value.real-a.value[1].value.imag*b.value[2].value.imag*c.value[0].value.real-a.value[1].value.imag*b.value[2].value.real*c.value[0].value.imag-a.value[1].value.real*b.value[2].value.imag*c.value[0].value.imag-a.value[0].value.real*b.value[2].value.real*
c.value[1].value.real+a.value[0].value.imag*b.value[2].value.imag*c.value[1].value.real+a.value[0].value.imag*b.value[2].value.real*c.value[1].value.imag+a.value[0].value.real*b.value[2].value.imag*c.value[1].value.imag-a.value[2].value.real*b.value[1].value.real*c.value[0].value.real+a.value[2].value.imag*b.value[1].value.imag*c.value[0].value.real+a.value[2].value.imag*b.value[1].value.real*c.value[0].value.imag+a.value[2].value.real*b.value[1].value.imag*c.value[0].value.imag-a.value[1].value.real*
b.value[0].value.real*c.value[2].value.real+a.value[1].value.imag*b.value[0].value.imag*c.value[2].value.real+a.value[1].value.imag*b.value[0].value.real*c.value[2].value.imag+a.value[1].value.real*b.value[0].value.imag*c.value[2].value.imag,-a.value[0].value.imag*b.value[1].value.imag*c.value[2].value.imag+a.value[0].value.imag*b.value[1].value.real*c.value[2].value.real+a.value[0].value.real*b.value[1].value.real*c.value[2].value.imag+a.value[0].value.real*b.value[1].value.imag*c.value[2].value.real-
a.value[2].value.imag*b.value[0].value.imag*c.value[1].value.imag+a.value[2].value.imag*b.value[0].value.real*c.value[1].value.real+a.value[2].value.real*b.value[0].value.real*c.value[1].value.imag+a.value[2].value.real*b.value[0].value.imag*c.value[1].value.real-a.value[1].value.imag*b.value[2].value.imag*c.value[0].value.imag+a.value[1].value.imag*b.value[2].value.real*c.value[0].value.real+a.value[1].value.real*b.value[2].value.real*c.value[0].value.imag+a.value[1].value.real*b.value[2].value.imag*
c.value[0].value.real+a.value[0].value.imag*b.value[2].value.imag*c.value[1].value.imag-a.value[0].value.imag*b.value[2].value.real*c.value[1].value.real-a.value[0].value.real*b.value[2].value.real*c.value[1].value.imag-a.value[0].value.real*b.value[2].value.imag*c.value[1].value.real+a.value[2].value.imag*b.value[1].value.imag*c.value[0].value.imag-a.value[2].value.imag*b.value[1].value.real*c.value[0].value.real-a.value[2].value.real*b.value[1].value.real*c.value[0].value.imag-a.value[2].value.real*
b.value[1].value.imag*c.value[0].value.real+a.value[1].value.imag*b.value[0].value.imag*c.value[2].value.imag-a.value[1].value.imag*b.value[0].value.real*c.value[2].value.real-a.value[1].value.real*b.value[0].value.real*c.value[2].value.imag-a.value[1].value.real*b.value[0].value.imag*c.value[2].value.real)};h.det4m=function(a){var b=a.value,c=b[0].value,d=c[0].value,f=+d.real,k=+d.imag;d=c[1].value;var m=+d.real,q=+d.imag;d=c[2].value;var t=+d.real;let w=+d.imag;d=c[3].value;let y=+d.real,C=+d.imag;
c=b[1].value;d=c[0].value;var F=+d.real,H=+d.imag;d=c[1].value;let R=+d.real,S=+d.imag;d=c[2].value;let Z=+d.real,U=+d.imag;d=c[3].value;c=+d.real;d=+d.imag;a=f*R-k*S-m*F+q*H;const pa=f*S+k*R-m*H-q*F,da=f*Z-k*U-t*F+w*H,Ba=f*U+k*Z-t*H-w*F,Oa=f*c-k*d-y*F+C*H,ta=f*d+k*c-y*H-C*F,Ja=m*Z-q*U-t*R+w*S,Wa=m*U+q*Z-t*S-w*R,Ra=m*c-q*d-y*R+C*S,Ka=m*d+q*c-y*S-C*R,Na=t*c-w*d-y*Z+C*U,cb=t*d+w*c-y*U-C*Z;c=b[2].value;d=c[0].value;f=+d.real;k=+d.imag;d=c[1].value;m=+d.real;q=+d.imag;d=c[2].value;t=+d.real;w=+d.imag;
d=c[3].value;y=+d.real;C=+d.imag;c=b[3].value;d=c[0].value;F=+d.real;H=+d.imag;d=c[1].value;R=+d.real;S=+d.imag;d=c[2].value;Z=+d.real;U=+d.imag;d=c[3].value;c=+d.real;d=+d.imag;b=f*R-k*S-m*F+q*H;const la=f*S+k*R-m*H-q*F,Aa=f*Z-k*U-t*F+w*H,vb=f*U+k*Z-t*H-w*F,yb=f*c-k*d-y*F+C*H;f=f*d+k*c-y*H-C*F;k=m*Z-q*U-t*R+w*S;F=m*U+q*Z-t*S-w*R;H=m*c-q*d-y*R+C*S;m=m*d+q*c-y*S-C*R;q=t*c-w*d-y*Z+C*U;t=t*d+w*c-y*U-C*Z;return n.complex(a*q-pa*t-da*H+Ba*m+Oa*k-ta*F+Ja*yb-Wa*f-Ra*Aa+Ka*vb+Na*b-cb*la,a*t+pa*q-da*m-Ba*
H+Oa*F+ta*k+Ja*f+Wa*yb-Ra*vb-Ka*Aa+Na*la+cb*b)};h.eucangle=function(a,b){var c=h.cross(a,h.linfty);a=h.cross(b,h.linfty);b=h.det3(h.ez,c,h.ii);c=h.det3(h.ez,c,h.jj);const d=h.det3(h.ez,a,h.ii);a=h.det3(h.ez,a,h.jj);b=n.div(n.mult(b,a),n.mult(d,c));b=n.log(b);return b=n.mult(b,n.complex(0,.5))};h.zerovector=function(a){a=Math.floor(a.value.real);const b=Array(a);for(let c=0;c<a;c++)b[c]=0;return h.realVector(b)};h.zeromatrix=function(a,b){a=Math.floor(a.value.real);const c=Array(a);for(let d=0;d<a;d++)c[d]=
h.zerovector(b);return h.turnIntoCSList(c)};h.vandermonde=function(a){const b=a.value.length,c=h.zeromatrix(b,b);for(let d=0;d<b;d++)for(let f=0;f<b;f++)c.value[d].value[f]=n.pow(a.value[d],n.real(f-1));return c};h.transpose=function(a){const b=[],c=a.value[0].value.length,d=a.value.length;for(let f=0;f<c;f++){const k=[];for(let m=0;m<d;m++)k[m]=a.value[m].value[f];b[f]=h.turnIntoCSList(k)}return h.turnIntoCSList(b)};h.column=function(a,b){const c=[],d=a.value.length;b=Math.floor(b.value.real-1);
for(let f=0;f<d;f++)c[f]=a.value[f].value[b];return h.turnIntoCSList(c)};h.row=function(a,b){const c=[],d=a.value[0].value.length;b=Math.floor(b.value.real-1);for(let f=0;f<d;f++)c[f]=a.value[b].value[f];return h.turnIntoCSList(c)};h.adjoint2=function(a){const b=a.value[0].value[0],c=a.value[1].value[0];let d=Array(2);d[0]=h.turnIntoCSList([a.value[1].value[1],n.neg(a.value[0].value[1])]);d[1]=h.turnIntoCSList([n.neg(c),b]);return d=h.turnIntoCSList(d)};h.adjoint3=function(a){let b,c,d,f,k,m,q,t,
w,y,C,F,H,R,S;var Z=a.value[0].value;var U=Z[0].value;b=U.real;c=U.imag;U=Z[1].value;d=U.real;f=U.imag;U=Z[2].value;k=U.real;m=U.imag;Z=a.value[1].value;U=Z[0].value;q=U.real;t=U.imag;U=Z[1].value;w=U.real;y=U.imag;U=Z[2].value;C=U.real;F=U.imag;Z=a.value[2].value;U=Z[0].value;a=U.real;H=U.imag;U=Z[1].value;R=U.real;S=U.imag;U=Z[2].value;Z=U.real;U=U.imag;return{ctype:"list",value:[{ctype:"list",value:[{ctype:"number",value:{real:w*Z-C*R-y*U+F*S,imag:w*U-C*S-R*F+Z*y}},{ctype:"number",value:{real:-d*
Z+k*R+f*U-m*S,imag:-d*U+k*S+R*m-Z*f}},{ctype:"number",value:{real:d*C-k*w-f*F+m*y,imag:d*F-k*y-w*m+C*f}}]},{ctype:"list",value:[{ctype:"number",value:{real:-q*Z+C*a+t*U-F*H,imag:-q*U+C*H+a*F-Z*t}},{ctype:"number",value:{real:b*Z-k*a-c*U+m*H,imag:b*U-k*H-a*m+Z*c}},{ctype:"number",value:{real:-b*C+k*q+c*F-m*t,imag:-b*F+k*t+q*m-C*c}}]},{ctype:"list",value:[{ctype:"number",value:{real:q*R-w*a-t*S+y*H,imag:q*S-w*H-a*y+R*t}},{ctype:"number",value:{real:-b*R+d*a+c*S-f*H,imag:-b*S+d*H+a*f-R*c}},{ctype:"number",
value:{real:b*w-d*q-c*y+f*t,imag:b*y-d*t-q*f+w*c}}]}]}};h.inverse=function(a){var b=a.value.length;if(b!==a.value[0].value.length)return console.log("Inverse works only for square matrices"),A;if(2===b)return h.scaldiv(h.det(a),h.adjoint2(a));if(3===b)return h.scaldiv(h.det(a),h.adjoint3(a));b=h.LUdecomp(a);a=a.value.length;const c=n.real(0),d=n.real(1),f=h.zerovector(n.real(a));f.value[0]=d;let k=Array(a);for(let m=0;m<a;m++)k[m]=h._helper.LUsolve(b,f),f.value[m]=c,f.value[m+1]=d;k=h.turnIntoCSList(k);
return k=h.transpose(k)};h.linearsolve=function(a,b){return 2===a.value.length?h.linearsolveCramer2(a,b):3===a.value.length?h.linearsolveCramer3(a,b):h.LUsolve(a,b)};h.getDiag=function(a){if(a.value.length!==a.value[0].value.length)return A;const b=Array(a.value.length);for(let c=0;c<a.value.length;c++)b[c]=a.value[c].value[c];return h.turnIntoCSList(b)};h.getSubDiag=function(a){if(a.value.length!==a.value[0].value.length)return A;const b=Array(a.value.length-1);for(let c=0;c<a.value.length-1;c++)b[c]=
a.value[c+1].value[c];return h.turnIntoCSList(b)};h.eig2=function(a){var b=n.add(a.value[0].value[0],a.value[1].value[1]);a=h.det2(a.value[0],a.value[1]);const c=n.mult(b,b);let d=b=n.mult(b,n.real(.5));a=n.sqrt(n.sub(n.div(c,n.real(4)),a));b=n.add(b,a);d=n.sub(d,a);return h.turnIntoCSList([b,d])};h.eig=function(a,b){var c=b||!0,d=a,f=n.real(d.value.length);b=f.value.real;n.real(0);d=h._helper.QRIteration(d)[0];d=h.getDiag(d);d=h.sort1(d);f=h.idMatrix(f,f);let k=Array(b);k=h.turnIntoCSList(k);if(c){let q,
t,w=0,y=!1;for(c=0;c<b;c++){if(y)q=m.value[w];else{var m=d.value[c];m=h.sub(a,h.scalmult(m,f));m=h.nullSpace(m);q=m.value[0];void 0!==q&&(t=q)}void 0===q&&(q=t);1E-8>h.abs(q).value.real&&0===w&&(q=h._helper.inverseIteration(a,d.value[c]));k.value[c]=h._helper.isAlmostZeroVec(q)?q:h.scaldiv(h.abs(q),q);c<b-1&&((y=1E-6>n.abs(n.sub(d.value[c],d.value[c+1])).value.real)?w++:w=0)}k=h.transpose(k)}return h.turnIntoCSList([d,k])};h._helper.isNormalMatrix=function(a){return 1E-10>h.abs(h.sub(a,h.transjugate(a))).value.real};
h._helper.QRIteration=function(a,b){var c=n.real(a.value.length);const d=c.value.real;let f=c.value.real;n.real(0);h.idMatrix(c,c);const k=h.zeromatrix(c,c);c=h.idMatrix(c,c);const m=b?b:2500;let q,t=0;const w=Array(f);for(b=0;b<m;b++){var y=h._helper.getBlock(a,[f-2,f-1],[f-2,f-1]);var C=h.eig2(y);y=C.value[0];C=C.value[1];h.abs(y);h.abs(C);var F=a.value[f-1].value[f-1];q=n.abs(n.sub(F,y)).value.real;F=n.abs(n.sub(F,C)).value.real;C=q<F?y:C;y=h.idMatrix(n.real(f),n.real(f));C=h.scalmult(C,y);y=h.QRdecomp(h.sub(a,
C));a=p.mult(y.R,y.Q);a=h.add(a,C);y.Q=h._helper.buildBlockMatrix(y.Q,h.idMatrix(n.real(t),n.real(t)));c=p.mult(c,y.Q);if(1E-48>n.abs2(a.value[a.value.length-1].value[a.value[0].value.length-2]).value.real&&1<f){w[d-t-1]=a.value[f-1].value[f-1];for(b=0;b<f;b++)k.value[f-1].value[b]=a.value[f-1].value[b],k.value[b].value[f-1]=a.value[b].value[f-1];a=h._helper.getBlock(a,[0,f-2],[0,f-2]);t++;f--}if(1===f){k.value[0].value[0]=a.value[0].value[0];break}if(h._helper.isUpperTriangular(a)){for(b=0;b<f;b++)k.value[b].value[b]=
a.value[b].value[b];break}}return[k,c]};h.rank=function(a,b){return h.RRQRdecomp(a,b).rank};h._helper.isAlmostZeroVec=function(a){const b=a.value.length;for(let c=0;c<b;c++)if(!n._helper.isAlmostZero(a.value[c]))return!1;return!0};h._helper.isLowerTriangular=function(a){const b=a.value.length,c=a.value[0].value.length;for(let d=0;d<b;d++)for(let f=d+1;f<c;f++)if(!n._helper.isAlmostZero(a.value[d].value[f]))return!1;return!0};h._helper.isUpperTriangular=function(a){return h._helper.isLowerTriangular(h.transpose(a))};
h._helper.isAlmostId=function(a){const b=a.value.length;var c=n.real(b);if(b!==a.value[0].value.length)return!1;a=h.sub(a,h.idMatrix(c),c);for(c=0;c<b;c++)for(let d=0;d<b;d++)if(1E-16<n.abs(a.value[c].value[d]).value.real)return!1;return!0};h.nullSpace=function(a,b){const c=a.value.length;b=h.RRQRdecomp(h.transjugate(a),b);a=h.transpose(b.Q);b=c-b.rank.value.real;let d=Array(b);a.value.reverse();let f;for(let k=0;k<b;k++)f=a.value[k],d[k]=h.scaldiv(h.abs(f),f);d=h.turnIntoCSList(d);return 0<d.value.length?
d:h.turnIntoCSList([h.zerovector(n.real(c))])};h._helper.isAlmostDiagonal=function(a){const b=a.value.length;n.real(b);n.real(0);if(b!==a.value[0].value.length)return!1;for(let c=0;c<b;c++)for(let d=0;d<b;d++)if(c!==d&&1E-16<n.abs(a.value[c].value[d]).value.real)return!1;return!0};h._helper.inverseIteration=function(a,b){console.log("warning: code untested");var c=a.value.length,d=Array(c);for(var f=0;f<c;f++)d[f]=2*Math.random()-.5;d=h.realVector(d);c=h.idMatrix(n.real(c),n.real(c));b=n.add(b,n.real(.1*
Math.random()-.5));for(f=0;100>f;f++)d=h.scaldiv(h.abs(d),d),d=h.LUsolve(h.sub(a,h.scalmult(b,c)),JSON.parse(JSON.stringify(d)));return h.scaldiv(h.abs(d),d)};h._helper.toHessenberg=function(a){let b=JSON.parse(JSON.stringify(a));const c=b.value.length,d=n.real(c-1);var f=n.real(c);n.real(1);if(h._helper.isUpperTriangular(b))return[h.idMatrix(d,d),a];a=h.idMatrix(f,f);let k;for(f=1;f<c-1;f++){var m=h.column(b,n.real(f));m.value=m.value.splice(f);k=h.abs2(m).value.real;1E-16<k&&(m=h._helper.getHouseHolder(m),
a=p.mult(a,m),b=p.mult(p.mult(m,b),m));d.value.real--}return[a,b]};h._helper.swapEl=function(a,b,c){let d;"[object Array]"===Object.prototype.toString.call(a)?(d=a[b],a[b]=a[c],a[c]=d):"list"===a.ctype&&(d=a.value[b],a.value[b]=a.value[c],a.value[c]=d)};h.RRQRdecomp=function(a,b){var c=Math.sqrt(n.eps);void 0!==b&&(c=.1*b.value.real);b=c*c;var d;c=a.value.length;let f=n.real(c);const k=n.real(1),m=h._helper.unitvector(n.real(a.value.length),k);let q=h.idMatrix(f,f),t=JSON.parse(JSON.stringify(a));
var w=h.transpose(a);a=Array(c);for(d=0;d<c;d++)a[d]=h.abs2(w.value[d]);a=h.turnIntoCSList(a);w=Array(c);for(d=0;d<c;d++)w[d]=d;d=h.maxIndex(a,n.abs);var y=a.value[d];let C=0;for(let F=0;1E-16<n.abs2(y).value.real;F++){C++;h._helper.swapColumn(t,F,d);h._helper.swapEl(a,F,d);h._helper.swapEl(w,F,d);d=h._helper.getBlock(t,[F],[F]);d=h.column(d,k);y=h.abs2(d).value.real;1E-8<y&&(d=h._helper.getHouseHolder(d),d=h._helper.buildBlockMatrix(h.idMatrix(n.real(F),n.real(F)),d),q=p.mult(q,h.transjugate(d)),
t=p.mult(d,t));for(d=F+1;d<c;d++)a.value[d]=n.sub(a.value[d],n.mult(t.value[F].value[d],n.conjugate(t.value[F].value[d])));d=h.maxIndex(a,n.abs2,F+1);y=a.value[d];if(F+2===c){n.abs(y).value.real>b&&C++;break}f=n.sub(f,k);m.value=m.value.splice(0,m.value.length-1)}return{Q:q,R:t,P:h.turnIntoCSList(w),rank:n.real(C)}};h._helper.getHouseHolder=function(a){var b=n.real(a.value.length);if(1E-16>h.abs2(a))return h.idMatrix(b,b);const c=n.real(1),d=h._helper.unitvector(n.real(a.value.length),c);var f=h._helper.QRgetAlpha(a,
0);f=h.sub(a,h.scalmult(f,d));f=h.scaldiv(h.abs(f),f);a=n.div(h.sesquilinearproduct(a,f),h.sesquilinearproduct(f,a));b=h.idMatrix(b,b);return b=h.sub(b,h.scalmult(n.add(c,a),h._helper.transposeMult(f,h.conjugate(f))))};h._helper.reOrderbyPivots=function(a,b){var c=a.value.length.length;a=h.transpose(a);c=Array(c);for(let d=0;d<b.length;d++)c[b[d]]=a.value[d];c=h.turnIntoCSList(c);return h.transpose(c)};h.QRdecomp=function(a){const b=a.value.length;let c=n.real(b);if(h._helper.isUpperTriangular(a))return{Q:h.idMatrix(c,
c),R:a};const d=n.real(1),f=h._helper.unitvector(n.real(a.value.length),d);let k,m=h.idMatrix(c,c);a=JSON.parse(JSON.stringify(a));for(let t=0;;t++){var q=h._helper.getBlock(a,[t],[t]);q=h.column(q,d);k=h.abs2(q).value.real;1E-8<k&&(q=h._helper.getHouseHolder(q),q=h._helper.buildBlockMatrix(h.idMatrix(n.real(t),n.real(t)),q),m=p.mult(m,h.transjugate(q)),a=p.mult(q,a));if(t+2===b)break;c=n.sub(c,d);f.value=f.value.splice(0,f.value.length-1)}return{Q:m,R:a}};h._helper.swapColumn=function(a,b,c){let d;
for(let f=0;f<a.value.length;f++)d=a.value[f].value[b],a.value[f].value[b]=a.value[f].value[c],a.value[f].value[c]=d};h._helper.buildBlockMatrix=function(a,b){if(0===a.value.length)return b;if(0===b.value.length)return a;const c=a.value.length,d=a.value[0].value.length;var f=d+b.value[0].value.length;f=h.zeromatrix(n.real(c+b.value.length),n.real(f));for(var k=0;k<a.value.length;k++)for(let m=0;m<a.value[0].value.length;m++)f.value[k].value[m]=a.value[k].value[m];for(a=0;a<b.value.length;a++)for(k=
0;k<b.value[0].value.length;k++)f.value[c+a].value[d+k]=b.value[a].value[k];return f};h._helper.getBlock=function(a,b,c){a=JSON.parse(JSON.stringify(a));var d=b[0];const f=c[0];b=void 0===b[1]?a.value.length:b[1];c=void 0===c[1]?a.value[0].value.length:c[1];b++;c++;a.value=a.value.slice(d,b);for(d=0;d<a.value.length;d++)a.value[d].value=a.value[d].value.slice(f,c);return a};h._helper.setBlock=function(a,b,c){a=JSON.parse(JSON.stringify(a));const d=c[0];c=c[1];const f=b.value.length,k=b.value[0].value.length;
for(let m=0;m<f;m++)for(let q=0;q<k;q++)a.value[d+m].value[c+q]=b.value[m].value[q];return a};h._helper.transposeMult=function(a,b){if(a.value.length!==b.value.length)return A;const c=a.value.length,d=Array(c);for(let f=0;f<c;f++)d[f]=h.scalmult(a.value[f],b);return h.turnIntoCSList(d)};h._helper.QRgetAlpha=function(a,b){return 0>a.value[b].value.real?h.abs(a):n.neg(h.abs(a))};h.LUdecomp=function(a){a=JSON.parse(JSON.stringify(a));var b;let c,d;let f=0,k;const m=a.value.length,q=m-1,t=Array(m);for(c=
0;c<m;++c){var w=c;d=a.value[c];k=n.abs(d.value[c]).value.real;for(b=c+1;b<m;++b){var y=n.abs(a.value[b].value[c]);k<y.value.real&&(k=y.value.real,w=b)}k<n.eps&&console.log("Warning: singular matrix!");t[c]=w;w!==c&&(a.value[c]=a.value[w],a.value[w]=d,d=a.value[c],f++);b=d.value[c];for(y=c+1;y<m;++y)a.value[y].value[c]=n.div(a.value[y].value[c],b);for(y=c+1;y<m;++y){w=a.value[y];for(b=c+1;b<q;++b)w.value[b]=n.sub(w.value[b],n.mult(w.value[c],d.value[b])),++b,w.value[b]=n.sub(w.value[b],n.mult(w.value[c],
d.value[b]));b===q&&(w.value[b]=n.sub(w.value[b],n.mult(w.value[c],d.value[b])))}}return{LU:a,P:t,TransPos:f}};h.LUsolve=function(a,b){a=h.LUdecomp(a);return h._helper.LUsolve(a,b)};h._helper.LUsolve=function(a,b){var c=JSON.parse(JSON.stringify(b));b=a.LU;const d=b.value.length,f=JSON.parse(JSON.stringify(c)),k=a.P;for(a=d-1;-1!==a;--a)f.value[a]=c.value[a];for(a=0;a<d;++a){c=k[a];if(k[a]!==a){var m=f.value[a];f.value[a]=f.value[c];f.value[c]=m}m=b.value[a];for(c=0;c<a;++c)f.value[a]=n.sub(f.value[a],
n.mult(f.value[c],m.value[c]))}for(a=d-1;0<=a;--a){m=b.value[a];for(c=a+1;c<d;++c)f.value[a]=n.sub(f.value[a],n.mult(f.value[c],m.value[c]));f.value[a]=n.div(f.value[a],m.value[a])}return f};h.linearsolveCramer2=function(a,b){const c=h.column(a,n.real(1));var d=h.column(a,n.real(2));a=h.det2(c,d);n._helper.isZero(a)&&console.log("A is not regular!");d=h.det2(b,d);d=n.div(d,a);b=h.det2(c,b);b=n.div(b,a);return h.turnIntoCSList([d,b])};h.linearsolveCramer3=function(a,b){const c=h.column(a,n.real(1)),
d=h.column(a,n.real(2));var f=h.column(a,n.real(3));a=h.det3(c,d,f);n._helper.isZero(a)&&console.log("A is not regular!");const k=h.det3(b,d,f);f=h.det3(c,b,f);b=h.det3(c,d,b);b=h.turnIntoCSList([k,f,b]);return b=h.scaldiv(a,b)};h.linearsolveCGNR=function(a,b){const c=h.transpose(a);a=p.mult(c,a);b=p.mult(c,b);return h.linearsolveCG(a,b)};h.linearsolveCG=function(a,b){let c;var d;let f,k,m;f=b;c=b=h.sub(b,p.mult(a,b));const q=Math.ceil(1.2*a.value.length);let t=0;for(;t<q;){t++;k=p.mult(a,c);m=d=
h.scalproduct(b,b);d=n.div(d,h.scalproduct(c,k));f=h.add(f,p.mult(d,c));b=h.sub(b,p.mult(d,k));if(h.abs(b).value.real<n.eps)break;d=h.scalproduct(b,b);d=n.div(d,m);c=h.add(b,p.mult(d,c))}t>=q&&console.log("CG did not converge");return f};h.det=function(a){if(1===a.value.length)return a.value[0].value[0];if(2===a.value.length)return h.det2(a.value[0],a.value[1]);if(3===a.value.length)return h.det3(a.value[0],a.value[1],a.value[2]);if(4===a.value.length)return h.det4m(a);const b=a.value.length;let c=
n.real(1);var d;let f;const k=JSON.parse(JSON.stringify(a));let m,q,t,w;for(a=0;a<b-1;a++){f=a;for(d=a+1;d<b;d++)n.abs(k.value[d].value[a]).value.real>n.abs(k.value[f].value[a]).value.real&&(f=d);f!==a&&(d=k.value[f],k.value[f]=k.value[a],k.value[a]=d,c=n.neg(c));m=k.value[a];for(d=a+1;d<b;d++){q=k.value[d];t=n.div(q.value[a],m.value[a]);for(f=a+1;f<b-1;f+=2)w=f+1,q.value[f]=n.sub(q.value[f],n.mult(m.value[f],t)),q.value[w]=n.sub(q.value[w],n.mult(m.value[w],t));f!==b&&(q.value[f]=n.sub(q.value[f],
n.mult(m.value[f],t)))}if(n._helper.isZero(m.value[a]))return n.real(0);c=n.mult(c,m.value[a])}return n.mult(c,k.value[a].value[a])};h.LUdet=function(a){a=h.LUdecomp(a);const b=a.LU,c=b.value.length;let d=b.value[0].value[0];for(let f=1;f<c;f++)d=n.mult(d,b.value[f].value[f]);1===a.TransPos%2&&(d=n.neg(d));return d};h.getField=function(a,b){let c;if("homog"===b){if(h._helper.isNumberVecN(a,3))return a;if(h._helper.isNumberVecN(a,2))return h.turnIntoCSList([a.value[0],a.value[1],n.real(1)])}if("xy"===
b){if(h._helper.isNumberVecN(a,2))return a;if(h._helper.isNumberVecN(a,3))return h.turnIntoCSList([n.div(a.value[0],a.value[2]),n.div(a.value[1],a.value[2])])}if("x"===b&&h.isNumberVector(a)){c=a.value.length;if(0<c&&3!==c)return a.value[0];if(3===c)return"Point"===a.usage?n.div(a.value[0],a.value[2]):a.value[0]}if("y"===b&&h.isNumberVector(a)){c=a.value.length;if(1<c&&3!==c)return a.value[1];if(3===c)return"Point"===a.usage?n.div(a.value[1],a.value[2]):a.value[1]}return"z"===b&&h.isNumberVector(a)&&
(c=a.value.length,2<c)?a.value[2]:A};h.nil=h.turnIntoCSList([]);h.ofGeos=function(a){return h.turnIntoCSList(a.map(function(b){return{ctype:"geo",value:b}}))};h._helper.isAlmostFarpoint=function(a){a=h.normalizeMax(a).value[2];return n.abs(a).value.real<n.eps};h.getRandRealVec3=function(a,b){const c=n.getRandReal;return h.turnIntoCSList([c(a,b),c(a,b),c(a,b)])};h.getRandComplexVec3=function(a,b){const c=n.getRandComplex;return h.turnIntoCSList([c(a,b),c(a,b),c(a,b)])};const Ia={_helper:{},turnIntoCSJson:function(a){return{ctype:"JSON",
value:a}}};Ia._helper.ShallowClone=function(a){let b,c,d;b=Array.isArray(a)?[]:{};for(d in a)c=a[d],b[d]=c;return b};Ia.getField=function(a,b){return a.value&&a.value[b]?a.value[b]:A};Ia.setField=function(a,b,c){"undefined"===c.ctype&&a[b]?delete a[b]:a[b]=c};Ia.GenFromUserDataEl=function(a){const b=a.key;a=a.value;if(!b||"string"!==b.ctype)return console.log("Error: JSON keys have to be strings."),A;if(a)return{key:b.value,val:L(a)};console.log("Warning: JSON object not defined.");return{key:b.value,
val:A}};Ia._helper.GenJSONAtom=function(a,b){return{ctype:"JSON",value:{key:p.string(a),value:b}}};Ia._helper.forall=function(a,b,c,d){let f="value",k;if(void 0!==d.iterator){d=L(d.iterator);let m=["key","value","pair"];"string"===d.ctype&&m.includes(d.value)&&(f=d.value)}if("value"===f)for(let m in a)Y.setvar(b,a[m]),k=L(c);else if("key"===f)for(let m in a)Y.setvar(b,p.string(m)),k=L(c);else for(let m in a)Y.setvar(b,Ia._helper.GenJSONAtom(m,a[m])),k=L(c);return k};Ia._helper.niceprint=function(a,
b,c){return"JSON"===a.ctype?Ia.niceprint(a,b,c):ja(a)};Ia.niceprint=function(a,b,c){if(!c&&(c={printedWarning:!1,visitedMap:{}},c.visitedMap.tracker=new WeakMap,c.visitedMap.level=0,c.visitedMap.maxLevel=1E3,c.visitedMap.maxElVisit=5E3,b&&b.maxDepth)){let f=L(b.maxDepth);"number"===f.ctype&&(c.visitedMap.maxLevel=f.value.real)}const d=c.visitedMap;d.newLevel=!0;d.level+=1;return"{"+Object.keys(a.value).sort().map(function(f){let k=a.value[f];if(d.tracker.has(k)){if(d[k]>d.maxElVisit||d.level>d.maxLevel)return c.printedWarning||
(console.log("Warning: We visited a key-value pair very often or encountered a very deeply nested dictionary. Dictionary is probably cyclic. Output will be probably incomplete."),c.printedWarning=!0),f+":...";d.newLevel&&(d.tracker.set(k,d.tracker.get(k)+1),d.newLevel=!1)}else d.tracker.set(k,1);return f+":"+Ia._helper.niceprint(k,b,c)}).join(", ")+"}"};Ia._helper.handlePrintException=function(a){a instanceof RangeError?console.log("Warning: Dictionary string could not be generated! Probably large cyclic Dictionary!"):
a instanceof SyntaxError?console.log("Warning: Dictionary string could not be parsed!"):console.log("Warning: Dictionary printing failed!")};const M={key:function(a){if("string"===a.ctype)return"s"+a.value.length+":"+a.value+";";if("number"===a.ctype)return"n"+a.value.real+","+a.value.imag+";";if("list"===a.ctype)return"l"+a.value.length+":"+a.value.map(M.key).join(",")+";";if("boolean"===a.ctype)return"b"+a.value+";";if("dict"===a.ctype)return a=Object.keys(a.value).sort(),"d"+a.length+":"+a.join(",")+
";";"undefined"!==a.ctype&&Kb.err("Bad dictionary key: "+ja(a));return"undef"},create:function(){return{ctype:"dict",value:{}}},clone:function(a){const b=M.create();for(const c in a.value)a.value.hasOwnProperty(c)&&(b.value[c]=a.value[c]);return b},put:function(a,b,c){a.value[M.key(b)]={key:b,value:c}},get:function(a,b,c){return(a=a.value[M.key(b)])?a.value:c},niceprint:function(a){return"{"+Object.keys(a.value).sort().map(function(b){b=a.value[b];return ja(b.key)+":"+ja(b.value)}).join(", ")+"}"}},
p={_helper:{},order:{undefined:0,boolean:1,number:2,term:3,atomic:4,variable:5,geo:6,string:7,list:8},string:function(a){return{ctype:"string",value:a}},bool:function(a){return{ctype:"boolean",value:a}},not:function(a){return p.bool(!a.value)},isLessThan:function(a,b){return-1===p.compare(a,b)},isEqual:function(a,b){return 0===p.compare(a,b)},compareResults:function(a,b){return p.compare(a.result,b.result)},compare:function(a,b){if(a.ctype!==b.ctype)return p.order[a.ctype]-p.order[b.ctype];if("number"===
a.ctype)return n._helper.compare(a,b);if("list"===a.ctype)return h._helper.compare(a,b);if("geo"===a.ctype)return a.value.name===b.value.name?0:a.value.name<b.value.name?-1:1;if("string"===a.ctype)return a.value===b.value?0:a.value<b.value?-1:1;if("boolean"===a.ctype)return a.value===b.value?0:!1===a.value?-1:1},add:function(a,b){return"void"===a.ctype&&"number"===b.ctype||"void"===a.ctype&&"list"===b.ctype?b:"number"===a.ctype&&"number"===b.ctype?n.add(a,b):"string"===a.ctype||"string"===b.ctype?
{ctype:"string",value:ja(a)+ja(b)}:"list"===a.ctype&&"list"===b.ctype?h.add(a,b):A},sub:function(a,b){return"void"===a.ctype&&"number"===b.ctype?n.neg(b):"void"===a.ctype&&"list"===b.ctype?h.neg(b):"number"===a.ctype&&"number"===b.ctype?n.sub(a,b):"list"===a.ctype&&"list"===b.ctype?h.sub(a,b):A},mult:function(a,b){return"number"===a.ctype&&"number"===b.ctype?n.mult(a,b):"number"===a.ctype&&"list"===b.ctype?h.scalmult(a,b):"list"===a.ctype&&"number"===b.ctype?h.scalmult(b,a):"list"===a.ctype&&"list"===
b.ctype?h.mult(a,b):A},div:function(a,b){return"number"===a.ctype&&"number"===b.ctype?n.div(a,b):"list"===a.ctype&&"number"===b.ctype?h.scaldiv(b,a):A},max:function(a,b){return"number"===a.ctype&&"number"===b.ctype?n.max(a,b):"list"===a.ctype&&"list"===b.ctype?h.max(a,b):A},min:function(a,b){return"number"===a.ctype&&"number"===b.ctype?n.min(a,b):"list"===a.ctype&&"list"===b.ctype?h.min(a,b):A},wrap:function(a){if("number"===typeof a)return n.real(a);if("object"===typeof a&&void 0!==a.length){const b=
[];for(let c=0;c<a.length;c++)b[c]=p.wrap(a[c]);return h.turnIntoCSList(b)}return"string"===typeof a?{ctype:"string",value:a}:"boolean"===typeof a?{ctype:"boolean",value:a}:A},unwrap:function(a){if("object"!==typeof a||null===a)return a;if(Array.isArray(a))return a.map(p.unwrap);switch(a.ctype){case "string":case "boolean":return a.value;case "number":return 0===a.value.imag?a.value.real:{r:a.value.real,i:a.value.imag};case "list":return a.value.map(p.unwrap);default:return null}},withUsage:function(a,
b){return{ctype:a.ctype,value:a.value,usage:b}},wrapJSON:function(a){switch(typeof a){case "number":return n.real(a);case "string":return p.string(a);case "boolean":return p.bool(a);case "object":if(null===a)return A;if(Array.isArray(a))return h.turnIntoCSList(a.map(p.wrapJSON));const b=M.create();for(const c in a)M.put(b,p.string(c),p.wrapJSON(a[c]));return b;default:return console.log("Failed to convert "+typeof a+" to CindyJS data type"),A}},identity:function(a){return a},deeplyEqual:function(a,
b){if("object"!==typeof a||"object"!==typeof b||null===a||null===b)return a===b;let c=0,d;for(d in a)if(++c,!(d in b&&p.deeplyEqual(a[d],b[d])))return!1;for(d in b)--c;return 0===c}},B={},G={};G[":"]=Xa(":");G["\u00b0"]=function(a,b){b=W(a[0]);return"number"===b.ctype&&"void"===a[1].ctype?p.withUsage(n.realmult(Math.PI/180,b),"Angle"):A};G._=Bc;G["^"]=Bb;G["\u221a"]=function(a,b){return"void"===a[0].ctype?z.sqrt$1([a[1]],b):A};G["*"]=xe;G["\u00d7"]=za;G["/"]=Bd;G["+"]=Pc;G["-"]=Ad;G["!"]=function(a,
b){b=W(a[1]);return"void"===a[0].ctype&&"boolean"===b.ctype?{ctype:"boolean",value:!b.value}:A};G["=="]=Ma;G["~="]=wb;G["~<"]=function(a,b){b=W(a[0]);a=W(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real-a.value.real<=-n.eps}:A};G["~>"]=function(a,b){b=W(a[0]);a=W(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real-a.value.real>=
n.eps}:A};G["=:="]=Xa("=:=");G[">="]=function(a,b){b=W(a[0]);a=W(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real>=a.value.real}:"string"===b.ctype&&"string"===a.ctype?{ctype:"boolean",value:b.value>=a.value}:A};G["<="]=function(a,b){b=W(a[0]);a=W(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real<=a.value.real}:"string"===
b.ctype&&"string"===a.ctype?{ctype:"boolean",value:b.value<=a.value}:A};G["~>="]=function(a,b){b=W(a[0]);a=W(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real-a.value.real>-n.eps}:A};G["~<="]=function(a,b){b=W(a[0]);a=W(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real-a.value.real<n.eps}:A};G[">"]=function(a,b){b=W(a[0]);
a=W(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real>a.value.real}:"string"===b.ctype&&"string"===a.ctype?{ctype:"boolean",value:b.value>a.value}:A};G["<"]=function(a,b){b=W(a[0]);a=W(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real<a.value.real}:"string"===b.ctype&&"string"===a.ctype?{ctype:"boolean",value:b.value<
a.value}:A};G["<>"]=tc;G["\u2208"]=function(a,b){b=L(a[0]);a=L(a[1]);return"list"===a.ctype?h.contains(a,b):A};G["\u2209"]=function(a,b){b=L(a[0]);a=L(a[1]);return"list"===a.ctype?p.not(h.contains(a,b)):A};G["&"]=Zb;G["%"]=ec;G["!="]=tc;G["~!="]=function(a,b){return p.not(wb(a,b))};G[".."]=function(a,b){b=L(a[0]);a=L(a[1]);return"number"===b.ctype&&"number"===a.ctype?h.sequence(b,a):A};G["++"]=Cd;G["--"]=oc;G["~~"]=Dd;G[":>"]=Q;G["<:"]=od;G["="]=zb;G[":="]=function(a,b,c){b="undefined"===a[1].ctype;
if("undefined"===a[0].ctype||b)return A;if("function"===a[0].ctype){b=a[0].oper;const f=a[0].args;a=a[1];var d=1;if(B.hasOwnProperty(b)){d=B[b];if(d.definer===c)return A;d=d.generation+1}B[b]={oper:b,body:a,arglist:f,definer:c,generation:d}}else"variable"===a[0].ctype?Y.setvar(a[0].name,a[1]):"field"===a[0].ctype?K.assigndotNoVal(a[0],a[1]):"userdata"===a[0].ctype&&K.assigncolonNoVal(a[0],a[1]);return A};G[":=_"]=function(a,b){if("void"!==a[1].ctype)return A;"function"===a[0].ctype&&delete B[a[0].oper];
return A};G["::="]=Xa("::=");G[";"]=function(a,b){b="void"===a[0].ctype;const c="void"===a[1].ctype;if(b&&c)return A;if(!b&&c)return L(a[0]);b||c||L(a[0]);return c?A:L(a[1])};ja.errorTypes=["_?_","_??_","_???_","___"];const z={},K={evaluate:function(a,b,c){if(B.hasOwnProperty(a)){c=B[a];if(void 0===c)b=A;else{var d=[];for(a=0;a<c.arglist.length;a++)d[a]=L(b[a]);for(a=0;a<c.arglist.length;a++)Y.newvar(c.arglist[a].name),Y.setvar(c.arglist[a].name,d[a]);Y.pushVstack("*");b=L(c.body);Y.cleanVstack();
for(a=0;a<c.arglist.length;a++)Y.removevar(c.arglist[a].name)}return b}if(d=z[a])return d(b,c);let f=a.lastIndexOf("$");if(-1!==f&&(f=a.substr(0,f),d=z[f]))return d(b,c);Kb.err("Called undefined function "+f+" (as "+a+")");return A},equals:function(a,b){return"number"===a.ctype&&"number"===b.ctype?{ctype:"boolean",value:a.value.real===b.value.real&&a.value.imag===b.value.imag}:"string"===a.ctype&&"string"===b.ctype||"boolean"===a.ctype&&"boolean"===b.ctype?{ctype:"boolean",value:a.value===b.value}:
"list"===a.ctype&&"list"===b.ctype?h.equals(a,b):"geo"===a.ctype&&"geo"===b.ctype||"JSON"===a.ctype&&"JSON"===b.ctype?{ctype:"boolean",value:a.value===b.value}:{ctype:"boolean",value:!1}}},Y={};Y.vars=function(){const a={pi:n.real(Math.PI),"\u03c0":n.real(Math.PI),i:n.complex(0,1),true:p.bool(!0),false:p.bool(!1),"#":A,nil:h.turnIntoCSList([]),newline:p.string("\n"),tab:p.string("\t")},b=[];for(const c in a)b[c]=[a[c]];return b}();Y.isVariable=function(a){return this.vars.hasOwnProperty(a)};Y.create=
function(a){if(this.vars.hasOwnProperty(a))return this.vars[a];const b=[null];return this.vars[a]=b};Y.newvar=function(a){a=this.vars[a];a.push(A);return a};Y.removevar=function(a){const b=this.vars[a];0===b.length&&console.error("Removing non-existing "+a);b.pop();0===b.length&&console.warn("Removing last "+a)};Y.setvar=function(a,b){const c=this.vars[a];0===c.length&&console.error("Setting non-existing variable "+a);void 0===b&&(console.error("Setting variable "+a+" to undefined value"),b=A);"undefined"===
b.ctype?c[c.length-1]=b:(a=b,null===a&&(a=A),c[c.length-1]=a)};Y.undefinedWarning={};Y.getvar=function(a){var b=this.vars[a]||[];0===b.length&&console.error("Getting non-existing variable "+a);b=b[b.length-1];if(null===b){if(E.csnames.hasOwnProperty(a))return{ctype:"geo",value:E.csnames[a]};console&&console.log&&void 0===this.undefinedWarning[a]&&(this.undefinedWarning[a]=!0,console.log("Warning: Accessing undefined variable: "+a));return A}return b};Y.dump=function(a){const b=this.vars[a];console.log("*** Dump "+
a);for(a=0;a<b.length;a++)console.log(a+":> "+ja(b[a]))};Y.vstack=[];Y.pushVstack=function(a){this.vstack.push(a)};Y.popVstack=function(){this.vstack.pop()};Y.cleanVstack=function(){const a=this.vstack;for(;0<a.length&&"*"!==a[a.length-1];)this.removevar(a[a.length-1]),a.pop();0<a.length&&a.pop()};const ca={generalFields:{color:"color",colorhsb:"",size:"size",alpha:"alpha",fillcolor:"fillcolor",fillalpha:"fillalpha",isshowing:"isshowing",visible:"visible",name:"name",caption:"caption",trace:"",tracelength:"",
selected:"",labeled:"labeled",labelled:"labeled"},getGeoField:function(a,b){return"undefined"!==typeof E.csnames[a]?ca.getField(E.csnames[a],b):A},setGeoField:function(a,b,c){return"undefined"!==typeof E.csnames[a]?ca.setField(E.csnames[a],b,c):A},getField:function(a,b){if("P"===a.kind){if("xy"===b)return a=h.dehom(a.homog),p.withUsage(a,"Point");if("homog"===b)return p.withUsage(a.homog,"Point");if("x"===b)return n.div(a.homog.value[0],a.homog.value[2]);if("y"===b)return n.div(a.homog.value[1],a.homog.value[2]);
if("narrow"===b)return p.wrap(a.narrow)}if("L"===a.kind||"S"===a.kind){if("homog"===b)return p.withUsage(a.homog,"Line");if("angle"===b)return a=h.eucangle(h.ey,a.homog),p.withUsage(a,"Angle");if("slope"===b)return n.neg(n.div(a.homog.value[0],a.homog.value[1]))}if("Tr"===a.kind&&"matrix"===b)return a.matrix;if("C"===a.kind){if("radius"===b){var c=a.matrix;a=c.value[0].value[0];var d=c.value[0].value[2];b=c.value[1].value[2];c=c.value[2].value[2];n.mult(a,a);d=n.div(d,a);b=n.div(b,a);a=n.div(c,a);
return a=n.sqrt(n.sub(n.add(n.mult(d,d),n.mult(b,b)),a))}if("size"===b)return a.size;if("matrix"===b)return a.matrix;if("center"===b)return a=v._helper.CenterOfConic(a.matrix),a=h.dehom(a),p.withUsage(a,"Point");if("dualMatrix"===b)return h.normalizeMax(h.adjoint3(a.matrix));if("narrow"===b)return p.wrap(a.narrow)}if("Text"===a.kind){if("pressed"===b)return a.checkbox?p.bool(a.checkbox.checked):p.bool(!1);if("xy"===b)return a=h.dehom(a.homog),p.withUsage(a,"Point");if("homog"===b)return p.withUsage(a.homog,
"Point");if("x"===b)return n.div(a.homog.value[0],a.homog.value[2]);if("y"===b)return n.div(a.homog.value[1],a.homog.value[2])}if("trace"===b)return p.bool(!!a.drawtrace);if("pinned"===b)return p.bool(!!a.pinned);if(ca.generalFields[b])return(a=a[ca.generalFields[b]])&&a.ctype?a:"object"!==typeof a?p.wrap(a):A;if(a.behavior){if("mass"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.mass);if("radius"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.radius);if("charge"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.charge);
if("friction"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.friction);if("vx"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.vx);if("vy"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.vy);if("v"===b&&"Mass"===a.behavior.type)return h.realVector([a.behavior.vx,a.behavior.vy]);if("fx"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.fx);if("fy"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.fy);if("f"===b&&"Mass"===a.behavior.type)return h.realVector([a.behavior.fx,
a.behavior.fy]);if("ldiff"===b&&"Spring"===a.behavior.type)return n.real(a.behavior.ldiff)}b=v[a.type]["get_"+b];return"function"===typeof b?b(a):A},setField:function(a,b,c){"color"===b&&h._helper.isNumberVecN(c,3)&&(a.color=c);"size"===b&&"number"===c.ctype&&(a.size=c);"alpha"===b&&"number"===c.ctype&&(a.alpha=c);"fillcolor"===b&&h._helper.isNumberVecN(c,3)&&(a.fillcolor=c);"fillalpha"===b&&"number"===c.ctype&&(a.fillalpha=c);"visible"===b&&"boolean"===c.ctype&&(a.visible=c.value);"pinned"===b&&
"boolean"===c.ctype&&(a.pinned=c.value);"labeled"!==b&&"labelled"!==b||"boolean"!==c.ctype||(a.labeled=c.value);"printlabel"===b&&(a.printname=ja(c));"trace"===b&&"boolean"===c.ctype&&(c.value&&!a.drawtrace?(a.drawtrace=!0,Ie(a)):a.drawtrace=c.value);"P"===a.kind&&a.movable&&("xy"===b&&h._helper.isNumberVecN(c,2)&&Qb(a,h.turnIntoCSList([c.value[0],c.value[1],n.real(1)]),"homog"),"xy"===b&&h._helper.isNumberVecN(c,3)&&Qb(a,c,"homog"),"x"===b&&"number"===c.ctype&&Qb(a,h.turnIntoCSList([n.mult(c,a.homog.value[2]),
a.homog.value[1],a.homog.value[2]]),"homog"),"y"===b&&"number"===c.ctype&&Qb(a,h.turnIntoCSList([a.homog.value[0],n.mult(c,a.homog.value[2]),a.homog.value[2]]),"homog"),"homog"===b&&h._helper.isNumberVecN(c,3)&&Qb(a,c,"homog"));"homog"===b&&"L"===a.kind&&a.movable&&h._helper.isNumberVecN(c,3)&&Qb(a,c,"homog");"Text"===a.kind&&("pressed"===b&&"boolean"===c.ctype&&a.checkbox&&(a.checkbox.checked=c.value),a.movable&&("xy"===b?h._helper.isNumberVecN(c,2)?a.homog=h.turnIntoCSList([c.value[0],c.value[1],
n.real(1)]):h._helper.isNumberVecN(c,3)&&(a.homog=c):"homog"===b&&h._helper.isNumberVecN(c,3)?a.homog=c:"x"===b&&"number"===c.ctype?a.homog=h.turnIntoCSList([n.mult(c,a.homog.value[2]),a.homog.value[1],a.homog.value[2]]):"y"===b&&"number"===c.ctype&&(a.homog=h.turnIntoCSList([a.homog.value[0],n.mult(c,a.homog.value[2]),a.homog.value[2]]))));a.behavior&&("mass"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.mass=c.value.real),"mass"===b&&"Sun"===a.behavior.type&&"number"===c.ctype&&
(a.behavior.mass=c.value.real),"friction"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.friction=c.value.real),"charge"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.charge=c.value.real),"radius"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.radius=c.value.real),"vx"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.vx=c.value.real),"vy"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.vy=c.value.real),"v"===b&&"Mass"===
a.behavior.type&&h._helper.isNumberVecN(c,2)&&(a.behavior.vx=c.value[0].value.real,a.behavior.vy=c.value[1].value.real));"narrow"===b&&["P","C"].includes(a.kind)&&("boolean"===c.ctype&&(a.narrow=c.value),"number"===c.ctype&&n._helper.isAlmostReal(c)&&(a.narrow=c.value.real));b=v[a.type]["set_"+b];if("function"===typeof b)return b(a,c)},getuserData:function(a,b){let c;"string"===b.ctype&&a.userData&&a.userData[b.value]&&(c=a.userData[b.value]);return c&&c.ctype?c:"object"!==typeof c?p.wrap(c):A},setuserData:function(a,
b,c){b&&"string"===b.ctype&&a&&c&&(a.userData||(a.userData={}),a.userData[b.value]=c)}};z.version$0=function(a,b){a=["CindyJS"].concat(Ze);return h.turnIntoCSList(a.map(p.wrap))};z.clearconsole$0=function(a,b){Kb.clear()};z.err$1=function(a,b){b="";"variable"===a[0].ctype?(b=a[0].name,a=Y.getvar(a[0].name)):a=a[0];a=b+" ===> "+ja(L(a));ob(a);return A};z.errc$1=function(a,b){"variable"===a[0].ctype?(b=L(Y.getvar(a[0].name)),console.log(a[0].name+" ===> "+ja(b))):(b=L(a[0]),console.log(" ===> "+ja(b)));
return A};z.print$1=function(a,b){Kb.out(ja(L(a[0]),b),!0);return A};z.println$1=function(a,b){Kb.out(ja(L(a[0],b)));return A};z.assert$2=function(a,b){const c=L(a[0]);if("boolean"===c.ctype){if(!1===c.value)return z.println$1([a[1]],b)}else ob("Condition for assert is not boolean");return A};z.dump$1=function(a,b){console.log(JSON.stringify(a[0]));return A};z.repeat$2=function(a,b){return z.repeat$3([a[0],null,a[1]],b)};z.repeat$3=function(a,b){var c=W(a[0]);let d="#";null!==a[1]&&"variable"===a[1].ctype&&
(d=a[1].name);if("number"!==c.ctype)return A;c=Math.round(c.value.real);var f=1,k=1,m=c+1,q=!1,t=!1,w=!1;let y;void 0!==b.start&&(y=L(b.start),"number"===y.ctype&&(q=!0,k=y.value.real));void 0!==b.step&&(y=L(b.step),"number"===y.ctype&&(w=!0,f=y.value.real));void 0!==b.stop&&(y=L(b.stop),"number"===y.ctype&&(t=!0,m=y.value.real));!q||t||w||(m=f*c+k);q||!t||w||(k=-f*(c-1)+m,m+=f);q||t||!w||(m=f*c+k);q&&t&&!w&&(f=(m-k)/(c-1),m+=f);q&&!t&&w&&(m=f*c+k);!q&&t&&w&&(k=-f*(c-1)+m,m+=f);q&&t&&w&&(m+=f);(k<=
m&&0<f||k>=m&&0>f)&&q&&t&&w&&(c=Math.floor((m-k)/f));Y.newvar(d);b=A;for(m=0;m<c;m++)Y.setvar(d,{ctype:"number",value:{real:m*f+k,imag:0}}),b=L(a[2]);Y.removevar(d);return b};z.while$2=function(a,b){b=a[1];a=a[0];let c=L(a),d=A;for(;"list"!==c.ctype&&c.value;)d=L(b),c=L(a);return d};z.apply$2=function(a,b){return z.apply$3([a[0],null,a[1]],b)};z.apply$3=function(a,b){return z.apply$4([a[0],a[1],null,a[2]],b)};z.apply$4=function(a,b){b=W(a[0]);if("list"!==b.ctype&&"JSON"!==b.ctype)return A;let c="#";
null!==a[1]&&"variable"===a[1].ctype&&(c=a[1].name);if(null!==a[2]&&"variable"===a[2].ctype){var d=a[2].name;Y.newvar(d)}const f=b.value;let k="list"===b.ctype?[]:{};Y.newvar(c);if(void 0!==d){if("list"===b.ctype)for(var m=0;m<f.length;m++)Y.setvar(d,n.real(m+1)),Y.setvar(c,f[m]),k[m]=L(a[3]);else for(m in f)Y.setvar(d,p.string(m)),Y.setvar(c,f[m]),k[m]=L(a[3]);Y.removevar(d)}else if("list"===b.ctype)for(k=[],d=0;d<f.length;d++)Y.setvar(c,f[d]),k[d]=L(a[3]);else for(let q in f)Y.setvar(c,f[q]),k[q]=
L(a[3]);Y.removevar(c);return"list"===b.ctype?h.turnIntoCSList(k):Ia.turnIntoCSJson(k)};z.forall$2=function(a,b){return z.forall$3([a[0],null,a[1]],b)};z.forall$3=function(a,b){const c=W(a[0]);if("list"!==c.ctype&&"JSON"!==c.ctype)return A;let d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);const f=c.value;Y.newvar(d);let k;if("list"===c.ctype)for(b=0;b<f.length;b++)Y.setvar(d,f[b]),k=L(a[2]);else k=Ia._helper.forall(f,d,a[2],b);Y.removevar(d);return k};z.select$2=function(a,b){return z.select$3([a[0],
null,a[1]],b)};z.select$3=function(a,b){var c=W(a[0]);if("list"!==c.ctype&&"JSON"!==c.ctype)return A;b="#";null!==a[1]&&"variable"===a[1].ctype&&(b=a[1].name);const d=c.value;let f;Y.newvar(b);if("list"===c.ctype){c=[];var k=0;for(let m=0;m<d.length;m++)Y.setvar(b,d[m]),f=L(a[2]),"boolean"===f.ctype&&!0===f.value&&(c[k]=d[m],k++);a={ctype:"list",value:c}}else{c={};for(k in d)Y.setvar(b,d[k]),f=L(a[2]),"boolean"===f.ctype&&!0===f.value&&(c[k]=d[k]);a={ctype:"JSON",value:c}}Y.removevar(b);return a};
z.flatten$1=function(a,b){function c(d,f){return-1===f||"list"!==d.ctype?d:[].concat.apply([],d.value.map(function(k){return c(k,f-1)}))}a=W(a[0]);if("list"!==a.ctype)return a;b=b.levels;void 0===b?b=1:(b=L(b),b="number"===b.ctype?b.value.real:"string"===b.ctype&&"all"===b.value?-2:1);return{ctype:"list",value:c(a,b)}};z.createvar$1=function(a,b){"variable"===a[0].ctype&&Y.newvar(a[0].name);return A};z.local=function(a,b){for(b=0;b<a.length;b++)"variable"===a[b].ctype&&Y.newvar(a[b].name);return A};
z.removevar$1=function(a,b){b=L(a[0]);"variable"===a[0].ctype&&Y.removevar(a[0].name);return b};z.release=function(a,b){if(0===a.length)return A;b=L(a[a.length-1]);for(let c=0;c<a.length;c++)"variable"===a[c].ctype&&Y.removevar(a[c].name);return b};z.regional=function(a,b){for(b=0;b<a.length;b++)if("variable"===a[b].ctype){const c=a[b].name;Y.newvar(c);Y.pushVstack(c)}return A};z.genList=function(a,b){return h.turnIntoCSList(a.map(L))};z.genJSON=function(a,b){b={};for(let c=0;c<a.length;c++){const d=
Ia.GenFromUserDataEl(a[c]);d.key&&(b[d.key]=d.val)}return{ctype:"JSON",value:b}};K.assigntake=function(a,b){const c=a.args[0],d=L(c);a=W(a.args[1]);var f=A;if("list"===d.ctype||"string"===d.ctype){let k=Math.floor(a.value.real);0>k&&(k=d.value.length+k+1);0<k&&k<=d.value.length&&("list"===d.ctype?(f="userData"===d.internal_usage?d.value:d.value.slice(),f[k-1]=L(b),f=h.turnIntoCSList(f),d.userData&&(f.userData=d.userData)):(f=d.value,f=f.substring(0,k-1)+ja(L(b))+f.substring(k,f.length),f=p.string(f)))}"JSON"===
d.ctype&&(a=ja(a),ja.errorTypes.includes(a)||(f=Ia._helper.ShallowClone(d),f.value[a]=L(b)));zb([c,f])};K.assigndot=function(a,b){const c=L(a.obj);a=a.key;"geo"===c.ctype&&"string"===typeof a&&ca.setField(c.value,a,W(b));"JSON"===c.ctype&&"string"===typeof a&&Ia.setField(c.value,a,W(b));return A};K.assigndotNoVal=function(a,b){const c=L(a.obj);a=a.key;"geo"===c.ctype&&"string"===typeof a&&ca.setField(c.value,a,b);"JSON"===c.ctype&&"string"===typeof a&&Ia.setField(c.value,a,b);return A};K.assigncolon=
function(a,b){const c=a.obj,d=L(c);a=p.string(ja(L(a.key)));"_?_"===a.value&&(a=A);if("geo"===d.ctype&&a)ca.setuserData(d.value,a,W(b));else if("JSON"===d.ctype&&a)Ia.setField(d.value,a.value,W(b));else if("list"===d.ctype||"string"===d.ctype&&a){const f=Object.assign({},d);f.userData||(f.userData={});"userData"!==d.internal_usage&&(f.userData=Object.assign({},f.userData));b=W(b);"list"===b.ctype&&(b.internal_usage="userData");f.userData[a.value]=b;zb([c,f])}else a&&"string"===a.ctype?console.log("User data "+
a.value+" can only be assigned to geo objects and lists, not to "+d.ctype):console.log("Key is undefined");return A};K.assigncolonNoVal=function(a,b){const c=a.obj;var d=L(c);a=p.string(ja(L(a.key)));"_?_"===a.value&&(a=A);if("geo"===d.ctype&&a)ca.setuserData(d.value,a,L(b));else if("JSON"===d.ctype&&a)Ia.setField(d.value,a.value,b);else if("list"===d.ctype||"string"===d.ctype&&a){const f={};for(const k in d)f[k]=d[k];if(f.userData){d={};for(const k in f.userData)d[k]=f.userData[k];f.userData=d}else f.userData=
{};f.userData[a.value]=b;zb([c,f])}else a&&"string"===a.ctype?console.log("User data "+a.value+" can only be assigned to geo objects and lists, not to "+d.ctype):console.log("Key is undefined");return A};z.keys$1=function(a,b){b=L(a[0]);const c=b.ctype;return"geo"===c||"list"===c||"JSON"===c?(a=[],(b="geo"===c?b.value.userData:"list"===c?b.userData:b.value)&&(a=Object.keys(b).map(p.string).sort()),h.turnIntoCSList(a)):A};z.values$1=function(a,b){a=L(a[0]);b=a.ctype;if("list"===b)return a;if("geo"===
b||"JSON"===b){let c=[],d;(d="geo"===b?a.value.userData:a.value)&&(c=Object.keys(d).sort().map(f=>d[f]));return h.turnIntoCSList(c)}return A};K.assignlist=function(a,b){let c=a.length;var d=b.length;d<c&&(c=d);for(d=0;d<c;d++)zb([a[d],b[d]],[])};z.if$2=function(a,b){return z.if$3(a,b)};z.if$3=function(a,b){b=W(a[0]);if("boolean"===b.ctype){if(!0===b.value)return L(a[1]);if(3===a.length)return L(a[2])}else"undefined"!==b.ctype&&ob("Condition for if is not boolean");return A};z.and$2=Zb;z.or$2=ec;z.xor$2=
function(a,b){b=W(a[0]);a=W(a[1]);return"boolean"===b.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:b.value!==a.value}:A};z.not$1=function(a,b){a=W(a[0]);return"boolean"===a.ctype?{ctype:"boolean",value:!a.value}:A};K.genericListMathGen=function(a,b,c){z[a+"$1"]=function(f,k){f=L(f[0]);if("list"!==f.ctype)return A;f=f.value;if(0===f.length)return c;k=f[0];for(let m=1;m<f.length;m++)k=b(k,f[m]);return k};const d=a+"$3";z[a+"$2"]=function(f,k){return z[d]([f[0],null,f[1]])};z[d]=function(f,k){k=
W(f[0]);if("list"!==k.ctype)return A;k=k.value;if(0===k.length)return c;let m="#";null!==f[1]&&"variable"===f[1].ctype&&(m=f[1].name);Y.newvar(m);Y.setvar(m,k[0]);let q=L(f[2]);for(let t=1;t<k.length;t++){Y.setvar(m,k[t]);const w=L(f[2]);q=b(q,w)}Y.removevar(m);return q}};K.genericListMathGen("product",p.mult,n.real(1));K.genericListMathGen("sum",p.add,n.real(0));K.genericListMathGen("max",p.max,A);K.genericListMathGen("min",p.min,A);z.max$2=function(a,b){b=W(a[0]);if("list"===b.ctype)return z.max$3([b,
null,a[1]]);a=W(a[1]);return z.max$1([h.turnIntoCSList([b,a])])};z.min$2=function(a,b){b=W(a[0]);if("list"===b.ctype)return z.min$3([b,null,a[1]]);a=W(a[1]);return z.min$1([h.turnIntoCSList([b,a])])};z.add$2=Pc;z.sub$2=Ad;z.mult$2=xe;z.div$2=Bd;z.mod$2=function(a,b){b=W(a[0]);a=W(a[1]);return"number"===b.ctype&&"number"===a.ctype?n.mod(b,a):A};z.pow$2=Bb;z.exp$1=function(a,b){a=W(a[0]);return"number"===a.ctype?n.exp(a):A};z.sin$1=function(a,b){a=W(a[0]);return"number"===a.ctype?n.sin(a):A};z.sqrt$1=
function(a,b){a=W(a[0]);return"number"===a.ctype?n.sqrt(a):A};K.laguerre=function(a,b,c){if("list"!==a.ctype)return A;const d=a.value.length-1;var f;for(f=0;f<=d;f++)if("number"!==a.value[f].ctype)return A;if("number"!==b.ctype)return A;const k=[1,.3141,.5926,.5358,.9793,.2385,.6264,.3383,.2795,.0288];var m;for(let w=1;w<=c;w++){var q=m=n.zero;var t=a.value[d];for(f=d-1;0<=f;f--)m=n.add(q,n.mult(m,b)),q=n.add(t,n.mult(q,b)),t=n.add(a.value[f],n.mult(t,b));if(n._helper.isLessThan(n.abs(t),n.real(1E-14)))break;
f=n.div(q,t);q=n.mult(f,f);t=n.sub(q,n.div(n.mult(n.real(2),m),t));m=n.sqrt(n.mult(n.real(d-1),n.sub(n.mult(n.real(d),t),q)));t=n.add(f,m);f=n.sub(f,m);n._helper.isLessThan(n.abs(t),n.abs(f))&&(t=f);f=n._helper.isLessThan(n.real(1E-14),n.abs(t))?n.div(n.real(d),t):n.mult(n.add(n.abs(b),n.one),n.complex(Math.cos(w),Math.sin(w)));if(n._helper.isLessThan(n.abs(f),n.real(1E-14)))break;0===w%20&&w<c-19&&(f=n.mult(f,n.real(k[Math.floor(w/20)])));b=n.sub(b,f)}return b};K.quadratic_roots=function(a){if("list"!==
a.ctype)return A;const b=a.value[2],c=a.value[1];a=a.value[0];if(n._helper.isZero(a))return[n.zero,n.neg(n.div(c,b))];let d=n.sqrt(n.sub(n.mult(c,c),n.mult(n.real(4),n.mult(b,a))));0<=n.re(c)&&(d=n.neg(d));return[n.div(n.sub(d,c),n.mult(n.real(2),b)),n.div(n.mult(n.real(2),a),n.sub(d,c))]};K.roots=function(a){let b=[];const c=a,d=a.value.length-1;if(0>=d)return h.turnIntoCSList([]);if(n._helper.isZero(a.value[d]))return b=K.roots(h.turnIntoCSList(a.value.slice(0,d))),h.append(b,n.infinity);if(1===
d)b[0]=n.neg(n.div(a.value[0],a.value[1]));else if(2===d)b=K.quadratic_roots(a);else{for(let f=0;f<d-2;f++){b[f]=K.laguerre(a,n.zero,200);b[f]=K.laguerre(c,b[f],1);const k=[];k[d-f]=a.value[d-f];for(let m=d-f;0<m;m--)k[m-1]=n.add(a.value[m-1],n.mult(k[m],b[f]));k.shift();a=h.turnIntoCSList(k)}a=K.quadratic_roots(a);b[d-2]=a[0];b[d-1]=a[1]}return h.turnIntoCSList(b)};z.roots$1=function(a,b){a=W(a[0]);if("list"===a.ctype){for(b=0;b<a.value.length;b++)if("number"!==a.value[b].ctype)return A;a=K.roots(a);
return h.sort1(a)}return A};z.autodiff$3=function(a,b){b="x";let c;if("function"===a[0].ctype)c=B[a[0].oper].body,b=a[0].args[0].name;else if("function"===typeof a[0].impl)c=a[0];else return ob("could not parse function"),A;const d=W(a[1]);a=W(a[2]);if(1>a.value.real)return ob("grade cant be < 1"),A;a=n.add(a,n.real(1));return La.autodiff(c,b,d,a)};z.cos$1=function(a,b){a=W(a[0]);return"number"===a.ctype?n.cos(a):A};z.tan$1=function(a,b){a=W(a[0]);return"number"===a.ctype?n.tan(a):A};z.arccos$1=function(a,
b){a=W(a[0]);return"number"===a.ctype?n.arccos(a):A};z.arcsin$1=function(a,b){a=W(a[0]);return"number"===a.ctype?n.arcsin(a):A};z.arctan$1=function(a,b){a=W(a[0]);return"number"===a.ctype?n.arctan(a):A};z.arctan2$2=function(a,b){b=W(a[0]);a=W(a[1]);return"number"===b.ctype&&"number"===a.ctype?n.arctan2(b,a):A};z.arctan2$1=function(a,b){a=W(a[0]);if("list"===a.ctype&&2===a.value.length){if(a=a.value,"number"===a[0].ctype&&"number"===a[1].ctype)return z.arctan2$2(a,b)}else if("number"===a.ctype)return n.arctan2(a);
return A};z.log$1=function(a,b){a=W(a[0]);return"number"===a.ctype?n.log(a):A};K.recursiveGen=function(a){const b=n[a],c=h[a];z[a+"$1"]=function(d,f){d=W(d[0]);return"number"===d.ctype?b(d):"list"===d.ctype?c(d):A}};K.recursiveGen("im");K.recursiveGen("re");K.recursiveGen("conjugate");K.recursiveGen("round");K.recursiveGen("ceil");K.recursiveGen("floor");K.recursiveGen("abs");z.abs_infix=z.abs$1;z.random$0=function(a,b){return n.real(n._helper.rand())};z.random$1=function(a,b){a=W(a[0]);return"number"===
a.ctype?n.complex(a.value.real*n._helper.rand(),a.value.imag*n._helper.rand()):A};z.seedrandom$1=function(a,b){a=W(a[0]);"number"===a.ctype&&n._helper.seedrandom(a.value.real);return A};z.randomnormal$0=function(a,b){return n.real(n._helper.randnormal())};z.randominteger$1=function(a,b){b=W(a[0]);return"number"===b.ctype?(a=b.value.real|0,b=b.value.imag|0,a=a*n._helper.rand()|0,b=b*n._helper.rand()|0,n.complex(a,b)):A};z.randomint$1=z.randominteger$1;z.randombool$0=function(a,b){return.5<n._helper.rand()?
{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isreal$1=function(a,b){a=L(a[0]);return"number"===a.ctype&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isinteger$1=function(a,b){a=L(a[0]);return"number"===a.ctype&&n._helper.isAlmostReal(a)&&a.value.real===Math.floor(a.value.real)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.iseven$1=function(a,b){a=L(a[0]);return"number"===a.ctype&&n._helper.isAlmostReal(a)&&a.value.real/2===Math.floor(a.value.real/
2)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isodd$1=function(a,b){a=L(a[0]);return"number"===a.ctype&&n._helper.isAlmostReal(a)&&(a.value.real-1)/2===Math.floor((a.value.real-1)/2)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.iscomplex$1=function(a,b){return"number"===L(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isstring$1=function(a,b){return"string"===L(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.islist$1=function(a,
b){return"list"===L(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.ismatrix$1=function(a,b){a=L(a[0]);return-1!==h._helper.colNumb(a)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.iscircle$1=function(a,b){a=L(a[0]);return"geo"===a.ctype&&"C"===a.value.kind&&"Circle"===a.value.matrix.usage?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isconic$1=function(a,b){a=L(a[0]);return"geo"===a.ctype&&"C"===a.value.kind?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};
z.isline$1=function(a,b){a=L(a[0]);return"geo"===a.ctype&&"L"===a.value.kind?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.ispoint$1=function(a,b){a=L(a[0]);return"geo"===a.ctype&&"P"===a.value.kind?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isgeometric$1=function(a,b){return"geo"===L(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isnumbermatrix$1=function(a,b){a=L(a[0]);return h.isNumberMatrix(a)};z.isnumbervector$1=function(a,b){a=L(a[0]);return h.isNumberVector(a)};
z.issun$1=function(a,b){a=L(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Sun"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.ismass$1=function(a,b){a=L(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Mass"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isspring$1=function(a,b){a=L(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Spring"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",
value:!1}};z.isbouncer$1=function(a,b){a=L(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Bouncer"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};z.isundefined$1=function(a,b){return"undefined"===L(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};const fa={ArcBy3:"Arc",CenterOfConic:"Center",ConicBy1p4l:"Conic1P4L",ConicBy4p1l:"Conic4P1L",ConicBy5lines:"Conic5L",ConicBy2Foci1P:"ConicFoci",ConicFromPrincipalDirections:"ConicPrincipleDirs",
Free:"FreePoint",PolarOfLine:"PolarLine",PolarOfPoint:"PolarPoint",PointOnSegment:"PointOnLine",Button:"Text",ToggleButton:"Text",TrReflectionL:"TrReflection",TrReflectionP:"TrReflection",TrReflectionC:"TrReflection",TrTranslation:"TrProjection",TrSimilarity:"TrProjection",TrAffine:"TrProjection",TransformP:"Transform",TransformL:"Transform",TransformSegment:"Transform",TransformS:"Transform",TransformPolygon:"Transform",TransformArc:"Transform",TransformConic:"Transform",TransformC:"Transform",TrMoebiusP:"Transform",
TrMoebiusL:"Transform",TrMoebiusSegment:"Transform",TrMoebiusS:"Transform",TrMoebiusPolygon:"Transform",TrMoebiusArc:"Transform",TrMoebiusCircle:"Transform",TrMoebiusC:"Transform",TrInverseMoebius:"TrInverse",Perp:"Orthogonal",Para:"Parallel",AngleBisector:"AngularBisector",IntersectLC:"IntersectionConicLine",IntersectCirCir:"IntersectionCircleCircle",OtherPointOnCircle:"PointOnCircle"};z.algorithm$1=function(a,b){a=L(a[0]);if("geo"===a.ctype){a=a.value;let c=a.type;b=W(b.compatibility);"string"===
b.ctype&&/^cinderella$/i.test(b.value)&&(/^Select/.test(c)&&(a=E.csnames[a.args[0]],c=a.type),fa.hasOwnProperty(c)?c=fa[c]:"CircleMr"===c&&(c=a.pinned?"CircleByFixedRadius":"CircleByRadius"));return p.string(c)}return A};z.inputs$1=function(a,b){a=L(a[0]);if("geo"===a.ctype){a=a.value;b=a.type;let c=[];a.args&&(c=a.args.map(function(d){return{ctype:"geo",value:E.csnames[d]}}));if(/^Select/.test(b)||v[b].isMovable)switch(a.kind){case "P":case "L":c.push(a.homog);break;case "C":c.push(a.matrix)}return h.turnIntoCSList(c)}return A};
z.moveto$2=function(a,b){b=L(a[0]);a=W(a[1]);"geo"===b.ctype&&(b=b.value,h._helper.isNumberVecN(a,2)?ca.setField(b,"xy",a):h._helper.isNumberVecN(a,3)&&ca.setField(b,"homog",a));return A};z.continuefromhere$0=function(a,b){Qc();return A};z.matrixrowcolumn$1=function(a,b){a=L(a[0]);return-1!==h._helper.colNumb(a)?h.realVector([a.value.length,a.value[0].value.length]):A};z.rowmatrix$1=function(a,b){a=L(a[0]);return"list"===a.ctype?h.turnIntoCSList([a]):A};z.columnmatrix$1=function(a,b){a=L(a[0]);return"list"===
a.ctype?h.turnIntoCSList(a.value.map(function(c){return h.turnIntoCSList([c])})):A};z.submatrix$3=function(a,b){b=L(a[0]);const c=L(a[1]);a=L(a[2]);if("list"===b.ctype&&"number"===c.ctype&&"number"===a.ctype){const d=Math.round(c.value.real);a=Math.round(a.value.real);b=b.value.slice();0<a&&a<=b.length&&b.splice(a-1,1);let f=!0;b=b.map(function(k){if("list"!==k.ctype)f=!1;else return k=k.value.slice(),0<d&&d<=k.length&&k.splice(d-1,1),h.turnIntoCSList(k)});return f?h.turnIntoCSList(b):A}return A};
z.complex$1=function(a,b){var c=W(a[0]);if("list"===c.ctype&&h.isNumberVector(c)){if(2===c.value.length)return a=c.value[0],b=c.value[1],n.complex(a.value.real-b.value.imag,b.value.real+a.value.imag);if(3===c.value.length)return a=c.value[0],b=c.value[1],c=c.value[2],a=n.div(a,c),b=n.div(b,c),n.complex(a.value.real-b.value.imag,b.value.real+a.value.imag)}return A};z.gauss$1=function(a,b){a=W(a[0]);return"number"===a.ctype?h.realVector([a.value.real,a.value.imag]):A};z.cross$2=za;z.crossratio$4=function(a,
b){b=L(a[0]);const c=L(a[1]),d=L(a[2]);a=L(a[3]);const f=ya(b),k=ya(c),m=ya(d),q=ya(a);return f!==A&&k!==A&&m!==A&&q!==A?h.crossratio3(f,k,m,q,h.ii):"number"===b.ctype&&"number"===c.ctype&&"number"===d.ctype&&"number"===a.ctype?n.div(n.mult(n.sub(b,d),n.sub(c,a)),n.mult(n.sub(b,a),n.sub(c,d))):A};z.para$2=function(a,b){b=W(a[0]);var c=W(a[1]);a=ya(b);const d=ya(c);if(b!==A&&c!==A){c=c.usage;let f=a,k=d;if("Line"===b.usage||"Point"===c)f=d,k=a;b=h.cross(h.cross(h.linfty,k),f);return p.withUsage(b,
"Line")}return A};z.perp$2=function(a,b){b=W(a[0]);var c=W(a[1]);a=ya(b);const d=ya(c);if(b!==A&&c!==A){const f=c.usage||d.usage;c=a;let k=d;if("Line"===(b.usage||a.usage)||"Point"===f)c=d,k=a;b=h.turnIntoCSList([k.value[0],k.value[1],n.zero]);b=h.cross(b,c);return p.withUsage(b,"Line")}return A};z.perp$1=function(a,b){a=W(a[0]);return h._helper.isNumberVecN(a,2)?h.turnIntoCSList([n.neg(a.value[1]),a.value[0]]):A};z.parallel$2=z.para$2;z.perpendicular$2=z.perp$2;z.perpendicular$1=z.perp$1;z.meet$2=
function(a,b){b=ya(a[0]);a=ya(a[1]);return b!==A&&a!==A?(a=h.cross(b,a),p.withUsage(a,"Point")):A};z.join$2=function(a,b){b=ya(a[0]);a=ya(a[1]);return b!==A&&a!==A?(a=h.cross(b,a),p.withUsage(a,"Line")):A};z.dist$2=function(a,b){b=W(a[0]);a=W(a[1]);a=Ad([b,a],[]);return z.abs$1([a],[])};z.dist_infix=z.dist$2;z.point$1=function(a,b){a=L(a[0]);return h._helper.isNumberVecN(a,3)||h._helper.isNumberVecN(a,2)?p.withUsage(a,"Point"):a};z.line$1=function(a,b){a=L(a[0]);return h._helper.isNumberVecN(a,3)?
p.withUsage(a,"Line"):a};z.det$3=function(a,b){b=ya(a[0]);const c=ya(a[1]);a=ya(a[2]);if(b!==A&&c!==A&&a!==A)return h.det3(b,c,a)};z.det$1=function(a,b){a=W(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.det(a):A};z.eig$1=function(a,b){a=W(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.eig(a):A};z.eigenvalues$1=function(a,b){a=W(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.eig(a,!1).value[0]:
A};z.rank$1=function(a,b){a=W(a[0]);if("list"===a.ctype){const c=h._helper.colNumb(a);if(-1!==c&&c===a.value.length)return h.rank(a,b.precision)}return A};z.kernel$1=function(a,b){a=W(a[0]);if("list"===a.ctype){const c=h._helper.colNumb(a);if(-1!==c&&c===a.value.length)return b=h.nullSpace(a,b.precision),h.transpose(b)}return A};z.eigenvectors$1=function(a,b){a=W(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.eig(a).value[1]:A};z.area$3=function(a,b){b=ya(a[0]);
let c=ya(a[1]);a=ya(a[2]);if(b!==A&&c!==A&&a!==A){const d=b.value[2],f=c.value[2],k=a.value[2];if(!n._helper.isAlmostZero(d)&&!n._helper.isAlmostZero(f)&&!n._helper.isAlmostZero(k))return b=h.scaldiv(d,b),c=h.scaldiv(f,c),a=h.scaldiv(k,a),b=h.det3(b,c,a),n.realmult(.5,b)}return A};z.inverse$1=function(a,b){a=W(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.inverse(a):A};z.linearsolve$2=function(a,b){b=W(a[0]);a=W(a[1]);if("list"===b.ctype){const c=h._helper.colNumb(b);
if(-1!==c&&c===b.value.length&&h._helper.isNumberVecN(a,c))return h.linearsolve(b,a)}return A};const sa=[[[]],[[0]],[[0,1],[1,0]],[[0,1,2],[0,2,1],[1,0,2],[1,2,0],[2,0,1],[2,1,0]],[[0,1,2,3],[0,1,3,2],[0,2,1,3],[0,2,3,1],[0,3,1,2],[0,3,2,1],[1,0,2,3],[1,0,3,2],[1,2,0,3],[1,2,3,0],[1,3,0,2],[1,3,2,0],[2,0,1,3],[2,0,3,1],[2,1,0,3],[2,1,3,0],[2,3,0,1],[2,3,1,0],[3,0,1,2],[3,0,2,1],[3,1,0,2],[3,1,2,0],[3,2,0,1],[3,2,1,0]]];z.mincostmatching$1=function(a,b){var c=L(a[0]);if(h.isNumberMatrix(c).value){a=
c.value.length;b=h._helper.colNumb(c);var d=a<b?b:a;let f,k;const m=Array(d);for(f=0;f<d;++f)for(m[f]=Array(d),k=0;k<d;++k)m[f][k]=f<a&&k<b?c.value[f].value[k].value.real:0;c=Ac(m);d=Array(a);for(f=0;f<a;++f)k=c[f],d[f]=k<b?n.real(k+1):n.real(0);return h.turnIntoCSList(d)}return A};z.take$2=Bc;z.length$1=function(a,b){a=L(a[0]);return"list"===a.ctype||"string"===a.ctype?n.real(a.value.length):A};z.pairs$1=function(a,b){a=L(a[0]);return"list"===a.ctype?h.pairs(a):A};z.triples$1=function(a,b){a=L(a[0]);
return"list"===a.ctype?h.triples(a):A};z.cycle$1=function(a,b){a=L(a[0]);return"list"===a.ctype?h.cycle(a):A};z.consecutive$1=function(a,b){a=L(a[0]);return"list"===a.ctype?h.consecutive(a):A};z.reverse$1=function(a,b){a=L(a[0]);return"list"===a.ctype?h.reverse(a):"string"===a.ctype?(a=Array.from(a.value).reverse().join(""),p.string(a)):A};z.directproduct$2=function(a,b){b=L(a[0]);a=L(a[1]);return"list"===b.ctype&&"list"===a.ctype?h.directproduct(b,a):A};z.concat$2=Cd;z.common$2=Dd;z.remove$2=oc;
z.append$2=Q;z.prepend$2=od;z.contains$2=function(a,b){b=L(a[0]);a=L(a[1]);return"list"===b.ctype?h.contains(b,a):A};z.sort$2=function(a,b){return z.sort$3([a[0],null,a[1]],b)};z.sort$3=function(a,b){var c=W(a[0]);if("list"!==c.ctype)return A;b="#";null!==a[1]&&"variable"===a[1].ctype&&(b=a[1].name);c=c.value;const d=[];Y.newvar(b);let f;for(f=0;f<c.length;f++)Y.setvar(b,c[f]),d[f]={val:c[f],result:L(a[2])};Y.removevar(b);d.sort(p.compareResults);a=[];for(f=0;f<c.length;f++)a[f]=d[f].val;return{ctype:"list",
value:a}};z.sort$1=function(a,b){a=L(a[0]);return"list"===a.ctype?h.sort1(a):A};z.set$1=function(a,b){a=L(a[0]);return"list"===a.ctype?h.set(a):A};z.combinations$2=function(a,b){function c(t,w){t===k?q.push(h.turnIntoCSList(m.slice())):w<f&&(m[t]=d.value[w],c(t+1,w+1),c(t,w+1))}const d=L(a[0]);a=L(a[1]);let f,k,m,q;if("number"===a.ctype){k=a.value.real|0;if("number"===d.ctype){f=d.value.real|0;f-k<k&&(k=f-k);if(0>k)return n.real(0);if(0===k)return n.real(1);if(1===k)return d;b=a=1;for(let t=1;t<=
k;++t){let w=f-k+t|0,y=t|0,C=pd(w,y)|0;w=w/C|0;y=y/C|0;C=pd(a,y)|0;a=a/C|0;y=y/C|0;C=pd(w,b)|0;w=w/C|0;b=b/C|0;a=a*w|0;b=b*y|0}return n.real(a/b)}if("list"===d.ctype){f=d.value.length;if(0>k||k>f)return h.turnIntoCSList([]);if(0===k)return h.turnIntoCSList([h.turnIntoCSList([])]);if(k===f)return h.turnIntoCSList([d]);q=[];m=Array(k);c(0,0);return h.turnIntoCSList(q)}}return A};z.zeromatrix$2=function(a,b){b=W(a[0]);a=W(a[1]);return"number"===b.ctype&&"number"===a.ctype?h.zeromatrix(b,a):A};z.zerovector$1=
function(a,b){a=W(a[0]);return"number"===a.ctype?h.zerovector(a):A};z.transpose$1=function(a,b){a=W(a[0]);return"list"===a.ctype&&-1!==h._helper.colNumb(a)?h.transpose(a):A};z.row$2=function(a,b){b=W(a[0]);a=W(a[1]);return"number"===a.ctype&&"list"===b.ctype&&-1!==h._helper.colNumb(b)?h.row(b,a):A};z.column$2=function(a,b){b=W(a[0]);a=W(a[1]);return"number"===a.ctype&&"list"===b.ctype&&-1!==h._helper.colNumb(b)?h.column(b,a):A};z.dict$0=function(a,b){a=M.create();for(const c in b)b.hasOwnProperty(c)&&
M.put(a,p.string(c),L(b[c]));return a};z.put$3=function(a,b){b=L(a[0]);const c=L(a[1]);a=L(a[2]);return"dict"===b.ctype?(b=M.clone(b),M.put(b,c,a),b):A};z.get$2=function(a,b){b=L(a[0]);a=L(a[1]);return"dict"===b.ctype?M.get(b,a,A):A};z.red$1=function(a,b){a=L(a[0]);return"number"===a.ctype?h.realVector([Math.min(1,Math.max(0,a.value.real)),0,0]):A};z.green$1=function(a,b){a=L(a[0]);return"number"===a.ctype?h.realVector([0,Math.min(1,Math.max(0,a.value.real)),0]):A};z.blue$1=function(a,b){a=L(a[0]);
return"number"===a.ctype?h.realVector([0,0,Math.min(1,Math.max(0,a.value.real))]):A};z.gray$1=function(a,b){a=L(a[0]);return"number"===a.ctype?(a=Math.min(1,Math.max(0,a.value.real)),h.realVector([a,a,a])):A};z.grey$1=z.gray$1;K.HSVtoRGB=function(a,b,c){let d,f,k,m,q,t;a&&void 0===b&&void 0===c&&(b=a.s,c=a.v,a=a.h);m=Math.floor(6*a);q=6*a-m;a=c*(1-b);t=c*(1-q*b);b=c*(1-(1-q)*b);switch(m%6){case 0:d=c;f=b;k=a;break;case 1:d=t;f=c;k=a;break;case 2:d=a;f=c;k=b;break;case 3:d=a;f=t;k=c;break;case 4:d=
b;f=a;k=c;break;case 5:d=c,f=a,k=t}return h.realVector([d,f,k])};z.hue$1=function(a,b){a=L(a[0]);return"number"===a.ctype?(a=a.value.real,a-=Math.floor(a),K.HSVtoRGB(a,1,1)):A};K.shapeconvert=function(a){let b;if("circle"===a.type){var c=a.value.value[0];c=p.div(c,c.value[2]);var d=c.value[0].value.real,f=c.value[1].value.real;a=a.value.value[1].value.real;b=Array(125);var k=2*Math.PI/125;for(c=0;125>c;c++)b[c]={X:d+Math.cos(c*k)*a,Y:f+Math.sin(c*k)*a};return[b]}if("polygon"===a.type){d=[];for(c=
0;c<a.value.length;c++){f=a.value[c];b=[];for(k=0;k<f.length;k++)b[k]={X:f[k].X,Y:f[k].Y};d[c]=b}return d}};K.shapeop=function(a,b,c){a=K.shapeconvert(a);var d=K.shapeconvert(b);ClipperLib.JS.ScaleUpPaths(a,1E3);ClipperLib.JS.ScaleUpPaths(d,1E3);b=new ClipperLib.Clipper;b.AddPaths(a,ClipperLib.PolyType.ptSubject,!0);b.AddPaths(d,ClipperLib.PolyType.ptClip,!0);d=a=ClipperLib.PolyFillType.pftNonZero;const f=new ClipperLib.Paths;b.Execute(c,f,a,d);ClipperLib.JS.ScaleDownPaths(f,1E3);return{ctype:"shape",
type:"polygon",value:f}};K.shapecommon=function(a,b){return K.shapeop(a,b,ClipperLib.ClipType.ctIntersection)};K.shaperemove=function(a,b){return K.shapeop(a,b,ClipperLib.ClipType.ctDifference)};K.shapeconcat=function(a,b){return K.shapeop(a,b,ClipperLib.ClipType.ctUnion)};z.key$0=function(a,b){return{ctype:"string",value:Td}};z.keycode$0=function(a,b){return n.real(Ud)};z.mouse$0=function(a,b){return b.id?(a=L(b.id),"number"===a.ctype&&(a=a.value.real,Hc[a])?h.realVector(Hc[a]):A):h.realVector(tb)};
z.mover$0=function(a,b){return qb&&qb.mover?{ctype:"geo",value:qb.mover}:A};z.multiid$0=function(a,b){return n.real(ic)};z.multiidlist$0=function(a,b){a=[];for(let c in Hc)a.push(c);return h.realVector(a)};z.translate$1=function(a,b){a=W(a[0]);"list"===a.ctype&&h.isNumberVector(a)&&2===a.value.length&&O.translate(a.value[0].value.real,a.value[1].value.real);return A};z.rotate$1=function(a,b){a=W(a[0]);"number"===a.ctype&&O.rotate(a.value.real);return A};z.scale$1=function(a,b){a=W(a[0]);"number"===
a.ctype&&O.scale(a.value.real);return A};z.greset$0=function(a,b){a=Wc.stack.length;O.greset();for(b=0;b<a;b++)P.restore();return A};z.gsave$0=function(a,b){O.gsave();P.save();return A};z.grestore$0=function(a,b){O.grestore();P.restore();return A};z.color$1=function(a,b){a=W(a[0]);"list"===a.ctype&&h.isNumberVector(a).value&&O.setcolor(a);return A};z.linecolor$1=function(a,b){a=W(a[0]);"list"===a.ctype&&h.isNumberVector(a).value&&O.setlinecolor(a);return A};z.pointcolor$1=function(a,b){a=W(a[0]);
"list"===a.ctype&&h.isNumberVector(a).value&&O.setpointcolor(a);return A};z.alpha$1=function(a,b){a=W(a[0]);"number"===a.ctype&&O.setalpha(a);return A};z.pointsize$1=function(a,b){a=W(a[0]);"number"===a.ctype&&O.setpointsize(a);return A};z.linesize$1=function(a,b){a=W(a[0]);"number"===a.ctype&&O.setlinesize(a);return A};z.textsize$1=function(a,b){a=W(a[0]);"number"===a.ctype&&O.settextsize(a);return A};z.playanimation$0=function(a,b){Ca();return A};z.pauseanimation$0=function(a,b){Gb();return A};
z.stopanimation$0=function(a,b){Jb();return A};z.text$1=function(a,b){a=W(a[0]);return p.string(ja(a))};z.replace$3=function(a,b){var c=L(a[0]);b=L(a[1]);a=L(a[2]);if("string"===c.ctype&&"string"===b.ctype&&"string"===a.ctype)return c=c.value,b=b.value.replace(/[^A-Za-z0-9]/g,"\\$&"),a=a.value.replace(/\$/g,"$$$$"),c=c.replace(new RegExp(b,"g"),a),{ctype:"string",value:c}};z.replace$2=function(a,b){function c(q,t,w){let y="";f=d=-1;for(let C=0;C<t.length;C++){const F=t[C][0],H=q.indexOf(F,w);-1!==
H&&(-1===d?(y=F,d=H,f=C):H<d&&(y=F,d=H,f=C))}return y}let d,f;var k;b=L(a[0]);const m=L(a[1]);if("string"===b.ctype&&"list"===m.ctype){a=b.value;b=[];for(k of m.value)"list"===k.ctype&&2===k.value.length&&"string"===k.value[0].ctype&&"string"===k.value[1].ctype&&(b[b.length]=[k.value[0].value,k.value[1].value]);d=-1;for(k=c(a,b,0);-1!==d;)a=a.substring(0,d)+b[f][1]+a.substring(d+k.length,a.length),k=d+b[f][1].length,k=c(a,b,k);return{ctype:"string",value:a}}return A};z.substring$3=function(a,b){b=
L(a[0]);const c=W(a[1]);a=W(a[2]);return"string"===b.ctype&&"number"===c.ctype&&"number"===a.ctype?{ctype:"string",value:b.value.substring(Math.floor(c.value.real),Math.floor(a.value.real))}:A};z.tokenize$2=function(a,b){var c=L(a[0]);a=L(a[1]);if("string"===c.ctype&&"string"===a.ctype)return z.tokenize$2([c,h.turnIntoCSList([a])],b);if("string"===c.ctype&&"list"===a.ctype){c=c.value;if(0===a.value.length){a=!0;if(void 0!==b.autoconvert){var d=L(b.autoconvert);"boolean"===d.ctype&&(a=d.value)}return a&&
""!==c&&(a=Number(c),!isNaN(a))?n.real(a):p.string(c)}d=a.value[0];const f=h.turnIntoCSList(a.value.slice(1));c=c.split(d.value);return h.turnIntoCSList(c.map(function(k){return z.tokenize$2([p.string(k),f],b)}))}return A};z.indexof$2=function(a,b){b=L(a[0]);a=L(a[1]);return"string"===b.ctype&&"string"===a.ctype?(a=b.value.indexOf(a.value),n.real(a+1)):A};z.indexof$3=function(a,b){b=L(a[0]);const c=L(a[1]);a=L(a[2]);return"string"===b.ctype&&"string"===c.ctype&&"number"===a.ctype?(a=b.value.indexOf(c.value,
Math.round(a.value.real)-1),n.real(a+1)):A};z.parse$1=function(a,b){a=L(a[0]);return"string"===a.ctype?(a=uc(a.value),L(a)):A};z.unicode$1=function(a,b){a=L(a[0]);let c=16;b.base&&(b=L(b.base),"number"===b.ctype&&(c=b.value.real));if("string"===a.ctype)b=parseInt(a.value,c);else if("number"===a.ctype)b=a.value.real;else return A;"undefined"!==typeof String.fromCodePoint?b=String.fromCodePoint(b):65535>=b?b=String.fromCharCode(b):(b-=65536,b=String.fromCharCode((b>>10)+55296,(b&1023)+56320));return p.string(b)};
z.international$1=function(a,b){return z.international$2([a[0],null],b)};z.international$2=function(a,b){b=L(a[0]);if("string"!==b.ctype)return A;const c=(aa.translations||{})[aa.language||"en"]||{};if(!c.hasOwnProperty(b.value))return b;const d=c[b.value];if("string"===typeof d)return p.string(d);if(null===a[1])return b;a=L(a[1]);a="number"===a.ctype?a.value.real:0;a=(c._pluralFormFunction||ye)(a);return a<d.length?p.string(d[a]):b};z.currentlanguage$0=function(a,b){return p.string(aa.language||
"en")};K.basismap=function(a,b,c,d){let f=h.turnIntoCSList([a,b,c]);f=h.adjoint3(h.transpose(f));d=p.mult(f,d);f=h.turnIntoCSList([p.mult(d.value[0],a),p.mult(d.value[1],b),p.mult(d.value[2],c)]);return h.transpose(f)};z.map$8=function(a,b){b=ya(a[0]);const c=ya(a[1]),d=ya(a[2]),f=ya(a[3]),k=ya(a[4]),m=ya(a[5]),q=ya(a[6]);a=ya(a[7]);return k!==A&&m!==A&&q!==A&&a!==A&&b!==A&&c!==A&&d!==A&&f!==A?(a=K.basismap(k,m,q,a),b=K.basismap(b,c,d,f),b=p.mult(a,h.adjoint3(b)),h.normalizeMax(b)):A};z.map$6=function(a,
b){b=ya(a[0]);const c=ya(a[1]),d=ya(a[2]);var f=h.realVector([0,0,1]);const k=h.cross,m=k(k(d,k(f,k(b,c))),k(c,k(f,k(b,d))));var q=ya(a[3]);const t=ya(a[4]);a=ya(a[5]);f=k(k(a,k(f,k(q,t))),k(t,k(f,k(q,a))));return q!==A&&t!==A&&a!==A&&f!==A&&b!==A&&c!==A&&d!==A&&m!==A?(q=K.basismap(q,t,a,f),b=K.basismap(b,c,d,m),b=p.mult(q,h.adjoint3(b)),h.normalizeMax(b)):A};z.map$4=function(a,b){b=h.ii;const c=h.jj,d=ya(a[0]),f=ya(a[1]),k=ya(a[2]);a=ya(a[3]);return k!==A&&a!==A&&d!==A&&f!==A?(a=K.basismap(k,a,b,
c),b=K.basismap(d,f,b,c),b=p.mult(a,h.adjoint3(b)),h.normalizeMax(b)):A};z.map$2=function(a,b){b=h.ii;const c=h.jj,d=ya(a[0]),f=p.add(h.realVector([1,0,0]),d);a=ya(a[1]);const k=p.add(h.realVector([1,0,0]),a);return a!==A&&k!==A&&d!==A&&f!==A?(a=K.basismap(a,k,b,c),b=K.basismap(d,f,b,c),b=p.mult(a,h.adjoint3(b)),h.normalizeMax(b)):A};z.pointreflect$1=function(a,b){b=h.ii;const c=h.jj;a=ya(a[0]);const d=p.add(h.realVector([1,0,0]),a);var f=p.add(h.realVector([-1,0,0]),a);return f!==A&&a!==A&&d!==A?
(f=K.basismap(a,f,b,c),b=K.basismap(a,d,b,c),b=p.mult(f,h.adjoint3(b)),h.normalizeMax(b)):A};z.linereflect$1=function(a,b){b=h.ii;const c=h.jj;a=ya(a[0]);var d=h.realVector([Math.random(),Math.random(),Math.random()]),f=h.realVector([Math.random(),Math.random(),Math.random()]);d=h.cross(d,a);f=h.cross(f,a);return a!==A&&d!==A?(a=K.basismap(d,f,b,c),b=K.basismap(d,f,c,b),b=p.mult(a,h.adjoint3(b)),h.normalizeMax(b)):A};K.extractPointVec=function(a){const b={ok:!1};if("geo"===a.ctype){var c=a.value;
if("P"===c.kind)return b.x=ca.getField(c,"x"),b.y=ca.getField(c,"y"),b.z=n.real(1),b.ok=!0,b}if("list"!==a.ctype)return b;var d=a.value;if(2===d.length&&(a=d[0],c=d[1],"number"===a.ctype&&"number"===c.ctype))return b.x=a,b.y=c,b.z=n.real(1),b.ok=!0,b;3===d.length&&(a=d[0],c=d[1],d=d[2],"number"===a.ctype&&"number"===c.ctype&&"number"===d.ctype&&(b.x=n.div(a,d),b.y=n.div(c,d),b.z=n.real(1),b.ok=!0));return b};z.polygon$1=function(a,b){a=L(a[0]);if("list"===a.ctype){b=[];for(let c=0;c<a.value.length;c++){const d=
K.extractPoint(a.value[c]);if(!d.ok)return A;b[c]={X:d.x,Y:d.y}}return{ctype:"shape",type:"polygon",value:[b]}}return A};z.circle$2=function(a,b){b=W(a[0]);a=W(a[1]);b=K.extractPointVec(b);if(!b.ok||"number"!==a.ctype)return A;b=h.turnIntoCSList([b.x,b.y,b.z]);return{ctype:"shape",type:"circle",value:h.turnIntoCSList([b,a])}};z.screen$0=function(a,b){const c=O.drawingstate.initialmatrix;a=function(d,f){d-=c.tx;f+=c.ty;return{X:(d*c.d-f*c.b)/c.det,Y:-(-d*c.c+f*c.a)/c.det}};return{ctype:"shape",type:"polygon",
value:[[a(0,0),a(gb,0),a(gb,ib),a(0,ib)]]}};z.halfplane$2=function(a,b){b=W(a[0]);a=W(a[1]);var c=ya(b);const d=ya(a);if(b!==A&&a!==A){const k=a.usage;a=c;var f=d;if("Line"===b.usage||"Point"===k)a=d,f=c;b=h.turnIntoCSList([f.value[0],f.value[1],n.zero]);b=h.cross(b,a);f=h.cross(f,b);f=p.div(f,f.value[2]);a=p.div(a,a.value[2]);a=h.sub(a,f);b=h.abs(a);a=p.div(a,b);b=f.value[0].value.real;f=f.value[1].value.real;c=1E3*a.value[0].value.real;a=1E3*a.value[1].value.real;return{ctype:"shape",type:"polygon",
value:[[{X:b+a/2,Y:f-c/2},{X:b+a/2+c,Y:f-c/2+a},{X:b-a/2+c,Y:f+c/2+a},{X:b-a/2,Y:f+c/2}]]}}return A};z.element$1=function(a,b){a=L(a[0]);return"string"===a.ctype&&E.csnames.hasOwnProperty(a.value)?{ctype:"geo",value:E.csnames[a.value]}:A};K.all$1=function(a,b){a=L(a[0]);return"geo"===a.ctype&&a.value.incidences?h.ofGeos(a.value.incidences.map(function(c){return E.csnames[c]}).filter(b)):h.nil};z.allpoints$0=function(a,b){return h.ofGeos(E.points)};z.allpoints$1=function(a,b){return K.all$1(a,function(c){return"P"===
c.kind})};z.allmasses$0=function(a,b){return h.ofGeos(Ib)};z.allmasses$1=function(a,b){return K.all$1(a,function(c){return"P"===c.kind&&c.behavior&&"Mass"===c.behavior.type})};z.allsprings$0=function(a,b){return h.ofGeos(xf)};z.allsprings$1=function(a,b){return K.all$1(a,function(c){return"S"===c.kind&&c.behavior&&"Spring"===c.behavior.type})};z.alllines$0=function(a,b){return h.ofGeos(E.lines)};z.alllines$1=function(a,b){return K.all$1(a,function(c){return"L"===c.kind||"S"===c.kind})};z.allsegments$0=
function(a,b){return h.ofGeos(E.lines.filter(function(c){return"S"===c.kind}))};z.allsegments$1=function(a,b){return K.all$1(a,function(c){return"S"===c.kind})};z.allconics$0=function(a,b){return h.ofGeos(E.conics)};z.allconics$1=function(a,b){return K.all$1(a,function(c){return"C"===c.kind})};z.allcircles$0=function(a,b){return h.ofGeos(E.conics.filter(function(c){return"Circle"===c.matrix.usage}))};z.allcircles$1=function(a,b){return K.all$1(a,function(c){return"C"===c.kind&&"Circle"===c.matrix.usage})};
z.allelements$0=function(a,b){return h.ofGeos(E.gslp)};z.allelements$1=function(a,b){return K.all$1(a,function(c){return!0})};z.elementsatmouse$0=function(a,b){const c=h.realVector([tb[0],tb[1],1]),d=function(q){if(n._helper.isAlmostZero(q.value[2]))return Infinity;q=h.normalizeZ(q);return h.abs(h.sub(q,c)).value.real},f=function(q){q=h.turnIntoCSList([q.value[0],q.value[1],n.zero]);return h.normalizeMax(h.cross(c,q))},k=function(q){var t=p.mult(q.matrix,c);t=f(t);q=v._helper.IntersectLC(t,q.matrix).map(function(w){return d(w)});
return.5>Math.min(q[0],q[1])};a=E.points.filter(function(q){return.5>d(q.homog)});b=E.lines.filter(function(q){var t=f(q.homog);t=h.normalizeMax(h.cross(q.homog,t));if((t=.5>d(t))&&"S"===q.kind){var w=q.homog;w=h.turnIntoCSList([w.value[0],w.value[1],n.zero]);q=h.crossratio3(q.farpoint,q.startpos,q.endpos,c,w).value.real;if(0>q||1<q)t=!1}return t});const m=E.conics.filter(function(q){let t=k(q);if(t&&q.isArc){var w=h.crossratio3harm(q.startPoint,q.endPoint,q.viaPoint,c,h.ii);q=w.value[0];w=w.value[1];
n._helper.isAlmostZero(q)?(q=n.div(q,w),w=n.real(1)):(w=n.div(w,q),q=n.real(1));const y=h.abs(h.turnIntoCSList([w,q]));q=n.div(q,y);w=n.div(w,y);w=n.mult(w,q);0>q.value.real&&(w=n.neg(w));0>w.value.real&&(t=!1)}return t});a=a.concat(b,m);return h.ofGeos(a)};z.incidences$1=z.allelements$1;z.createpoint$2=function(a,b){b=L(a[0]);a=ya(a[1]);return"string"!==b.ctype?(ob("Name must be a string"),A):"list"!==a.ctype&&h.isNumberVector(a)?(ob("Position must be a number vector"),A):{ctype:"geo",value:Ub({name:b.value,
type:"Free",labeled:!0,pos:a},!0)}};z.create$3=function(a,b){var c=L(a[0]);let d=L(a[1]);var f=L(a[2]);a={};for(var k in b)a[k]=W(b[k]);if("string"===c.ctype)k=c.value;else{if("list"!==c.ctype)return ob("Names must be a string or a list of strings"),A;if(1!==c.value.length){k=p.string(c.value.map(function(t){return t.value}).join("__"));f=z.create$3([k,d,f],a);var m=[];if(f!==A)for(d=p.string(f.value.kind.replace(/^(.*)s$/,"Select$1")),f=h.turnIntoCSList([p.string(f.value.name)]),b=0;b<c.value.length;++b)a.index=
n.real(b+1),m.push(z.create$3([c.value[b],d,f],a));return h.turnIntoCSList(m)}if("string"!==c.value[0].ctype)return ob("Element of names list must be a string"),A;k=c.value[0].value}if("string"!==d.ctype)return ob("Type must be a string"),A;if("list"!==f.ctype)return ob("Arguments must be a list"),A;if(!v.hasOwnProperty(d.value)&&!Xd.hasOwnProperty(d.value)&&!uf.hasOwnProperty(d.value))return ob("Invalid geometric operation: '"+d.value+"'"),A;c=[];var q=null;for(b=0;b<f.value.length;b++){const t=
f.value[b];if("string"===t.ctype)c.push(t.value);else if("geo"===t.ctype)c.push(t.value.name);else if(q=ya(t),q===A)return ob("Unknown argument type"),A}f={name:k,type:d.value,labeled:!0};q&&(f.pos=q);0<c.length&&(f.args=c);for(m in a)f[m]=p.unwrap(a[m]);return{ctype:"geo",value:Ub(f,!0)}};z.create$2=function(a,b){function c(t){function w(F){E.csnames[F]||(y=F)}let y=!1,C;if("P"===t)for(C=0;26>C&!y;C++)8!==C&&9!==C&&w(String.fromCharCode(65+C));else if("L"===t||"S"===t)for(C=0;26>C&!y;C++)8!==C&&
9!==C&&w(String.fromCharCode(97+C));for(C=0;!y;C++)w(t+C);return y}let d=L(a[0]);a=L(a[1]);const f={};for(var k in b)f[k]=W(b[k]);if(!v.hasOwnProperty(d.value)&&!Xd.hasOwnProperty(d.value)&&!uf.hasOwnProperty(d.value))return ob("Invalid geometric operation: '"+d.value+"'"),A;for(;Xd.hasOwnProperty(d.value);)d.value=Xd[d.value];k=v[d.value];b=p.string(c(k.kind));if(a.value.length>k.signature.length){var m="Operation "+d.value+" requieres only "+k.signature.length+" argument"+(1===k.signature.length?
"":"s")+" ("+a.value.length+" argument"+(1===a.value.length?"":"s")+" given) to create "+b.value+". Ignoring the last arguments.";if(!f.pos){var q=ya(a.value[a.value.length-1]);q!==A&&(m+=" Use the last argument as modifier `pos`.",f.pos=q)}ob(m);a=h.turnIntoCSList(a.value.slice(0,k.signature.length))}k=z.create$3([b,d,a],f);if(k!==A&&"s"===k.value.kind[1]&&k.value.results){d=p.string("Select"+k.value.kind[0]);a=h.turnIntoCSList([p.string(k.value.name)]);if(f.pos)return b=p.string(c(k.value.kind[0])),
z.create$3([b,d,a],f);m=[];for(q=0;q<k.value.results.value.length;q++)f.index=n.real(q+1),b=p.string(c(k.value.kind[0])),m.push(z.create$3([b,d,a],f));return h.turnIntoCSList(m)}k.isDuplicate&&delete k.isDuplicate;return k};Ia._helper.self=A;z.self$0=function(a,b){return Ia._helper.self};z.eval$1=function(a,b){Object.entries(b).forEach(function([c,d]){d=L(d);Y.newvar(c);Y.setvar(c,d)});Y.pushVstack("*");a=L(a[0]);Y.cleanVstack();Object.entries(b).forEach(function([c]){Y.removevar(c)});return a};z.javascript$1=
function(a,b){a=L(a[0]);"string"===a.ctype&&(new Function(a.value)).call(Mb);return A};z.use$1=function(a,b){function c(d,f,k){z[d.toLowerCase()+"$"+f]=k}a=L(a[0]);if("string"===a.ctype){a=a.value;let d;aa.plugins&&(d=aa.plugins[a]);d||(d=Ob._pluginRegistry[a]);if(d)return d({instance:Mb,config:aa,nada:A,evaluate:L,cscompiled:wa,extractPoint:K.extractPoint,evaluateAndVal:W,defineFunction:c,addShutdownHook:Gc.push.bind(Gc),addAutoCleaningEventListener:e,getVariable:Y.getvar.bind(Y),getInitialMatrix:function(){return O.drawingstate.initialmatrix},
setTextRenderer:function(f,k){Lb=f;k&&(Sc=k)},getImage:function(f,k){"string"===typeof f&&(f=p.string(f));f=Tb(f);if(!f)return null;!k&&f.cdyUpdate&&f.cdyUpdate();return f},getMyfunction:function(f){return B.hasOwnProperty(f)?B[f]:null},scheduleUpdate:x}),{ctype:"boolean",value:!0};ob("Plugin "+a+" not found");return{ctype:"boolean",value:!1}}return A};z.format$2=function(a,b){function c(q,t){q=q.toFixed(k);let w;do w=q,q=q.substring(0,q.length-1);while(t&&""!==q&&"-"!==q&&+q===+w);t=""+w;b.delimiter&&
"string"===b.delimiter.ctype&&(t=t.replace(".",b.delimiter.value));return t}function d(q,t){let w,y;return"number"===q.ctype?(w=c(q.value.real,m),y=c(q.value.imag,m),q=Math.abs(q.value.imag)<10**-t?w:"-"===y.substring(0,1)?w+" - i*"+y.substring(1):w+" + i*"+y,{ctype:"string",value:q}):"list"===q.ctype?{ctype:"list",value:q.value.map(d)}:{ctype:"string",value:ja(q).toString()}}const f=W(a[0]);a=W(a[1]);let k,m=!0;if(b.truncate){const q=L(b.truncate);"boolean"===q.ctype&&(m=q.value)}return"number"!==
f.ctype&&"list"!==f.ctype||"number"!==a.ctype?A:(k=Math.max(0,Math.min(20,Math.round(a.value.real))),d(f,k))};Date.now||(Date.now=function(){return(new Date).getTime()});let Ga=0;z.timestamp$0=function(a,b){return n.real(Date.now())};z.seconds$0=function(a,b){return n.real((Date.now()-Ga)/1E3)};z.resetclock$0=function(a,b){Ga=Date.now();return A};z.time$0=function(a,b){a=new Date;return h.realVector([a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()])};z.date$0=function(a,b){a=new Date;
return h.realVector([a.getFullYear(),a.getMonth()+1,a.getDate()])};z.simulationtime$0=function(a,b){return n.real(gd*Ye)};z.settimeout$2=function(a,b){function c(){L(d);x()}b=L(a[0]);const d=a[1];"number"===b.ctype&&"undefined"!==typeof window&&window.setTimeout(c,1E3*b.value.real);return A};K.formatForWebGL=function(a){return a.toFixed(10)};z.generateWebGL$2=function(a,b){var c=K.formatForWebGL;b=a[0];a=L(a[1]);console.log(a);if("list"!==a.ctype)return A;const d=[];for(let f=0;f<a.value.length;f++)"string"===
a.value[f].ctype&&d.push(a.value[f].value);console.log("***********");console.log(d);a=K.plotvars(b);console.log(a);a.includes("a")||a.includes("b")||a.includes("c")||a.includes("d")||a.includes("e")||a.includes("f")||(b=W(b));if("number"===b.ctype)return{ctype:"string",value:"vec2("+c(b.value.real)+","+c(b.value.imag)+")"};if("variable"===b.ctype)return{ctype:"string",value:b.name};if("string"===b.ctype||"void"===b.ctype)return b;if(2===b.args.length&&("infix"===b.ctype||"function"===b.ctype)){c=
z.compileToWebGL$1([b.args[0]],{});a=z.compileToWebGL$1([b.args[1]],{});if("+"===b.oper||"add"===b.oper)return void 0===c.value||"void"===c.ctype?{ctype:"string",value:a.value}:{ctype:"string",value:"addc("+c.value+","+a.value+")"};if("*"===b.oper||"mult"===b.oper)return{ctype:"string",value:"multc("+c.value+","+a.value+")"};if("/"===b.oper||"div"===b.oper)return{ctype:"string",value:"divc("+c.value+","+a.value+")"};if("-"===b.oper||"sub"===b.oper)return void 0===c.value||"void"===c.ctype?{ctype:"string",
value:"negc("+a.value+")"}:{ctype:"string",value:"subc("+c.value+","+a.value+")"};if("^"===b.oper||"pow"===b.oper)return{ctype:"string",value:"powc("+c.value+","+a.value+")"}}if("function"===b.ctype&&1===b.args.length){c=z.compileToWebGL$1([b.args[0]],{});if("sin$1"===b.oper)return{ctype:"string",value:"sinc("+c.value+")"};if("cos$1"===b.oper)return{ctype:"string",value:"cosc("+c.value+")"};if("tan$1"===b.oper)return{ctype:"string",value:"tanc("+c.value+")"};if("exp$1"===b.oper)return{ctype:"string",
value:"expc("+c.value+")"};if("log$1"===b.oper)return{ctype:"string",value:"logc("+c.value+")"};if("arctan$1"===b.oper)return{ctype:"string",value:"arctanc("+c.value+")"};if("arcsin$1"===b.oper)return{ctype:"string",value:"arcsinc("+c.value+")"};if("arccos$1"===b.oper)return{ctype:"string",value:"arccosc("+c.value+")"};if("sqrt$1"===b.oper)return{ctype:"string",value:"sqrtc("+c.value+")"}}return A};z.compileToWebGL$1=function(a,b){b=K.formatForWebGL;a=a[0];var c=K.plotvars(a);c.includes("a")||c.includes("b")||
c.includes("c")||c.includes("d")||c.includes("e")||c.includes("f")||(a=W(a));if("number"===a.ctype)return{ctype:"string",value:"vec2("+b(a.value.real)+","+b(a.value.imag)+")"};if("variable"===a.ctype)return{ctype:"string",value:a.name};if("string"===a.ctype||"void"===a.ctype)return a;if(2===a.args.length&&("infix"===a.ctype||"function"===a.ctype)){b=z.compileToWebGL$1([a.args[0]],{});c=z.compileToWebGL$1([a.args[1]],{});if("+"===a.oper||"add"===a.oper)return void 0===b.value||"void"===b.ctype?{ctype:"string",
value:c.value}:{ctype:"string",value:"addc("+b.value+","+c.value+")"};if("*"===a.oper||"mult"===a.oper)return{ctype:"string",value:"multc("+b.value+","+c.value+")"};if("/"===a.oper||"div"===a.oper)return{ctype:"string",value:"divc("+b.value+","+c.value+")"};if("-"===a.oper||"sub"===a.oper)return void 0===b.value||"void"===b.ctype?{ctype:"string",value:"negc("+c.value+")"}:{ctype:"string",value:"subc("+b.value+","+c.value+")"};if("^"===a.oper||"pow"===a.oper)return{ctype:"string",value:"powc("+b.value+
","+c.value+")"}}if("function"===a.ctype&&1===a.args.length){b=z.compileToWebGL$1([a.args[0]],{});if("sin$1"===a.oper)return{ctype:"string",value:"sinc("+b.value+")"};if("cos$1"===a.oper)return{ctype:"string",value:"cosc("+b.value+")"};if("tan$1"===a.oper)return{ctype:"string",value:"tanc("+b.value+")"};if("exp$1"===a.oper)return{ctype:"string",value:"expc("+b.value+")"};if("log$1"===a.oper)return{ctype:"string",value:"logc("+b.value+")"};if("arctan$1"===a.oper)return{ctype:"string",value:"arctanc("+
b.value+")"};if("arcsin$1"===a.oper)return{ctype:"string",value:"arcsinc("+b.value+")"};if("arccos$1"===a.oper)return{ctype:"string$1",value:"arccosc("+b.value+")"};if("sqrt$1"===a.oper)return{ctype:"string",value:"sqrtc("+b.value+")"}}return A};z.setsimulationspeed$1=function(a,b){a=W(a[0]);"number"===a.ctype&&Ua(a.value.real);return A};z.setsimulationaccuracy$1=function(a,b){a=W(a[0]);"number"===a.ctype&&"undefined"!==typeof Ha&&"undefined"!==typeof Ha.env&&(Ha.env.accuracy=Math.max(1,a.value.real|
0));return A};z.setsimulationquality$1=function(a,b){a=W(a[0]);"number"===a.ctype&&"undefined"!==typeof Ha&&"undefined"!==typeof Ha.env&&(a=a.value.real,0===a&&(Ha.env.errorbound=.01,Ha.env.lowestdeltat=1E-5,Ha.env.slowdownfactor=2),1===a&&(Ha.env.errorbound=.001,Ha.env.lowestdeltat=1E-7,Ha.env.slowdownfactor=2),2===a&&(Ha.env.errorbound=1E-5,Ha.env.lowestdeltat=1E-10,Ha.env.slowdownfactor=4),3===a&&(Ha.env.errorbound=1E-6,Ha.env.lowestdeltat=1E-12,Ha.env.slowdownfactor=4));return A};let eb=null,
Ec=null;z.createtool$3=function(a,b){let c="left",d="top",f=null;if(b.space){var k=L(b.space);"number"===k.ctype&&(f=k.value.real/2)}let m=null;b.toolbar&&(k=L(b.toolbar),"string"===k.ctype&&((m=document.getElementById(k.value))||console.warn("Element #"+k.value+" not found")));if(!m){if(b.reference&&(k=L(b.reference),"string"===k.ctype))switch(k.value){case "UR":c="right";break;case "LL":d="bottom";break;case "LR":c="right",d="bottom"}m=document.createElement("div");m.className="CindyJS-toolbar";
fb.parentNode.appendChild(m);k=L(a[1]);var q=L(a[2]);"number"===k.ctype&&(m.style[c]=k.value.real+"px");"number"===q.ctype&&(m.style[d]=q.value.real+"px");null!==f&&(m.style.margin=-f+"px")}a=L(a[0]);if("string"===a.ctype)a=[[a.value]];else if("list"===a.ctype)a=a.value.map(function(t){return"string"===t.ctype?[t.value]:"list"===t.ctype?t.value.map(function(w){return"string"===w.ctype?w.value:null}):[null]});else return ob("Name must be a string or a list of strings"),A;if(b.flipped&&(k=L(b.flipped),
"boolean"===k.ctype&&k.value)){ob("Flipping");let t=0;b=a.length;a.forEach(function(w){w.length>t&&(t=w.length)});k=[];for(q=0;q<t;++q){k[q]=[];for(let w=0;w<b;++w)k[q][w]=a[w][q]||null}a=k}"bottom"===d&&a.reverse();a.forEach(function(t){"right"===c&&t.reverse();const w=document.createElement("div");m.appendChild(w);t.forEach(function(y){function C(){eb&&eb.classList.remove("CindyJS-active");eb=H;H.classList.add("CindyJS-active");tf=y;const R=ba[tf].actions;Ec&&(Ec.textContent=R[0].tooltip||"");cc=
[];Wd=Mc=0}ba.hasOwnProperty(y)||(ob("Tool '"+y+"' not implemented yet."),y=null);if(null===y){var F=document.createElement("span");F.className="CindyJS-spacer";w.appendChild(F)}else{var H=document.createElement("button");F=document.createElement("img");F.src=Ob.getBaseDir()+"images/"+y+".png";H.appendChild(F);H.addEventListener("click",C);eb||C();null!==f&&(H.style.margin=f+"px");w.appendChild(H)}})});return A};z.dropped$0=function(){return Pd};z.droppoint$0=function(){return pe};z.parsecsv$1=function(a,
b){let c=!0;var d=W(b.autoconvert);"boolean"===d.ctype&&(c=d.value);d=null;b=W(b.delimiter);"string"===b.ctype&&/^[^"\r\n]$/.test(b.value)&&(d=b.value);a=W(a[0]);if("string"!==a.ctype)return ob("CSV data is not a string"),A;a=a.value;b='(?:"((?:[^"]+|"")*)"|([^]*?))(\r\n|(,)|[\r\n]|$)';d&&(d=d.replace(/[^A-Za-z0-9]/g,"\\$&").replace(/\$/g,"$$$$"),b=b.replace(/,/g,d));b=new RegExp(b,"g");d=[];const f=[];let k=null;for(;b.lastIndex<a.length;){var m=b.exec(a),q=m[2];"string"===typeof m[1]&&(q=m[1].replace(/""/g,
'"'));q=c?/^[Tt]rue$/.test(q)?p.bool(!0):/^[Ff]alse$/.test(q)?p.bool(!1):/^[\-+]?([0-9]+(\.[0-9]*)?|\.[0-9]+|Infinity)$/.test(q)?n.real(Number(q)):p.string(q):p.string(q);d.push(q);m[4]&&b.lastIndex===a.length&&(d.push(p.string("")),m={});if(!m[4]){null===k&&(k=d.length);if(k<d.length)for(k=d.length,m=0;m<f.length;++m)for(q=f[m].length;q<k;++q)f[m][q]=A;else if(k>d.length)for(m=d.length;m<k;++m)d[m]=A;f.push(d);d=[]}}return h.turnIntoCSList(f.map(h.turnIntoCSList))};z.load$2=function(a,b){return z.load$3([a[0],
null,a[1]],b)};z.load$3=function(a,b){function c(){if(k.readyState===XMLHttpRequest.DONE){if(200===k.status)var m=p.string(String(k.responseText));else ob("Failed to load "+f+": "+k.statusText),m=A;Y.newvar(d);Y.setvar(d,m);L(a[2]);Y.removevar(d);x()}}let d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);b=W(a[0]);let f=null,k=null;"string"===b.ctype&&/^https?:\/\//.test(b.value)&&(f=b.value);return null!==f?(k=new XMLHttpRequest,k.onreadystatechange=c,k.open("GET",f),k.send(),p.bool(!0)):
A};z.removeelement$1=function(a,b){a=L(a[0]);"geo"===a.ctype?Gd(a.value.name):console.log("argument of removeelement is undefined or not of type <geo>")};z.guess$1=function(a,b){function c(t){if((t=Xc.doPSLQ([t,1,Math.PI*Math.E],15))&&0===t[2])return[Math.round(t[0]),Math.round(t[1])]}function d(t){if(n._helper.isAlmostZero(t))return"0";if(!n._helper.isAlmostReal(t)){var w=t.value.real,y=t.value.imag,C=c(w),F=c(w*w+y*y);if(C&&F){w=-C[0]*F[0];var H=-C[1]*F[0]*2,R=C[0]*F[1];C=k(-H,2*w);F=H*H-4*R*w;
t=m(F);F/=t*t;F=t===2*w?"+i*sqrt("+-F+")":t===-2*w?"+i*sqrt("+-F+")":"+i*"+k(t,2*w).substring(1)+"*sqrt("+-F+")";t="-"+F.substring(1);H=Math.abs((H*H-4*R*w)/(4*w*w));w=Math.sqrt(H);H=-Math.sqrt(H);if("+0"===C||"-0"===C)C="";y=Math.abs(y-w)<Math.abs(y-H)?C+F:C+t;y.startsWith("+")&&(y=y.substring(1))}else y=ja(t);return y}var S=Xc.doPSLQ([Math.PI,t.value.real,1],15);y=""+t.value.real;R=w="";var Z=H=1E4;C=1E5;if(S&&3E3>(C=f(S))){w=t.value.real;H=S[0];F=-S[1];S=S[2];var U="";if(0!==H){var pa=Math.round(H);
var da=Math.round(F);U=k(pa,da)+"*pi"}pa="";0!==S&&(pa=Math.round(S),da=Math.round(F),pa=k(pa,da));q=Math.abs(w-(S/F+Math.PI*H/F));w=pa+U;""===w?w="0":w.startsWith("+")&&(w=w.substring(1));H=q}U=Xc.doPSLQ([t.value.real*t.value.real,t.value.real,1],15);F=1E5;if(U&&9E3>(F=10+f(U))){t=t.value.real;Z=U[0];S=U[1];U=U[2];pa=Math.round(Z);da=Math.round(S);var Ba=Math.round(U);R=k(-da,2*pa);da=da*da-4*Ba*pa;Ba=m(da);da/=Ba*Ba;pa=Ba===2*pa?"+sqrt("+da+")":Ba===-2*pa?"-sqrt("+da+")":k(Ba,2*pa)+"*sqrt("+da+
")";da=-S/(2*Z);U=Math.abs((S*S-4*U*Z)/(4*Z*Z));pa="+"+pa.substring(1);Z="-"+pa.substring(1);S=da+Math.sqrt(U);U=da-Math.sqrt(U);if("+0"===R||"-0"===R)R="";Math.abs(t-S)<Math.abs(t-U)?(q=Math.abs(t-S),t=R+pa):(q=Math.abs(t-U),t=R+Z);t.startsWith("+")&&(t=t.substring(1));R=t;Z=q}C<F&&1E-12>H&&(y=w);F<C&&1E-12>Z&&(y=R);return y}function f(t){let w=Math.abs(t[0]);Math.abs(t[1])>w&&(w=Math.abs(t[1]));Math.abs(t[2])>w&&(w=Math.abs(t[2]));return w}function k(t,w){let y="+";0>t*w&&(t=Math.abs(t),w=Math.abs(w),
y="-");const C=pd(t,w);t/=C;w/=C;0>t&&0>w&&(t=-t,w=-w);return 1===w?y+t:y+t+"/"+w}function m(t){for(let w=3E3;0<w;w--)if(0===t%(w*w))return w;return 1}let q=0;a=W(a[0]);return"number"===a.ctype&&n._helper.isFinite(a)?(a=void 0===d(a)?"no guess":d(a),p.string(a)):A};K.extractPoint=function(a){const b={ok:!1};if("geo"===a.ctype){var c=a.value;if("P"===c.kind)return b.x=ca.getField(c,"x").value.real,b.y=ca.getField(c,"y").value.real,b.ok=!0,b}if("list"!==a.ctype)return b;var d=a.value;if(2===d.length&&
(a=d[0],c=d[1],"number"===a.ctype&&"number"===c.ctype))return b.x=a.value.real,b.y=c.value.real,b.ok=!0,b;3===d.length&&(a=d[0],c=d[1],d=d[2],"number"===a.ctype&&"number"===c.ctype&&"number"===d.ctype&&(a=n.div(a,d),c=n.div(c,d),b.x=a.value.real,b.y=c.value.real,b.ok=!0));return b};z.draw$1=function(a,b){a=W(a[0]);if("shape"===a.ctype)K.drawshape(a,b);else if("Line"===a.usage)N.handleModifs(b,N.lineModifs),N.drawline(a);else{const c=K.extractPoint(a);if(!c.ok){if("undefined"!==typeof a.value&&2===
a.value.length)return z.draw$2(a.value,b);return}null!==b&&N.handleModifs(b,N.pointModifs);N.drawpoint(c)}return A};z.draw$2=function(a,b){var c=W(a[0]);a=W(a[1]);c=K.extractPoint(c);a=K.extractPoint(a);if(!c.ok||!a.ok)return A;null!==b&&N.handleModifs(b,N.lineModifs);N.drawsegcore(c,a);return A};z.drawcircle$2=function(a,b){return K.drawcircle(a,b,"D")};K.arcHelper=function(a){const b={};b.startPoint=ya(a[0]);b.viaPoint=ya(a[1]);b.endPoint=ya(a[2]);return b};z.fillcircle$2=function(a,b){return K.drawcircle(a,
b,"F")};z.drawarc$3=function(a,b){a=K.arcHelper(a);return K.drawarc(a,b,"D")};z.fillarc$3=function(a,b){a=K.arcHelper(a);return K.drawarc(a,b,"F")};K.drawarc=function(a,b,c){var d=a.startPoint;let f=a.viaPoint;a=a.endPoint;if(!h._helper.isAlmostReal(h.turnIntoCSList([d,f,a])))return A;N.handleModifs(b,N.conicModifs);N.preDrawCurve();b=h.det3(d,f,a);if(1E-12<Math.abs(b.value.real)){b=v._helper.ConicBy5(null,d,f,a,h.ii,h.jj);var k=v._helper.CenterOfConic(b);k=h.normalizeMax(k);b=n.real(0);var m=h.turnIntoCSList([h.turnIntoCSList([k.value[2],
b,n.neg(k.value[0])]),h.turnIntoCSList([b,k.value[2],n.neg(k.value[1])]),h.turnIntoCSList([b,b,k.value[2]])]);b=h.normalizeZ(p.mult(m,d));h.normalizeZ(p.mult(m,f));m=h.normalizeZ(p.mult(m,a));b=-Math.atan2(b.value[1].value.real,b.value[0].value.real);m=-Math.atan2(m.value[1].value.real,m.value[0].value.real);k=h.normalizeZ(k);d=h.normalizeZ(d);f=h.normalizeZ(f);a=h.normalizeZ(a);var q=h.abs(h.sub(d,k)),t=[k.value[0].value.real,k.value[1].value.real];k=O.drawingstate.matrix;const w=t[0]*k.a-t[1]*k.b+
k.tx;t=t[0]*k.c-t[1]*k.d-k.ty;d=0<h.det3(d,f,a).value.real;P.save();P.beginPath();P.translate(w,t);P.arc(0,0,q.value.real*k.sdet,b,m,d);"F"===c&&(P.fillStyle=N.lineColor,P.closePath(),P.fill());"D"===c&&P.stroke();P.restore()}else{if("D"!==c)return A;c=K.extractPoint(d);b=K.extractPoint(f);m=K.extractPoint(a);if(!c.ok||!b.ok||!m.ok)return A;q=(c.x-m.x)*(c.x-m.x)+(c.y-m.y)*(c.y-m.y);k=(m.x-b.x)*(m.x-b.x)+(m.y-b.y)*(m.y-b.y);if(1E-12>(c.x-b.x)*(c.x-b.x)+(c.y-b.y)*(c.y-b.y)||1E-12>q||1E-12>k)return A;
0>h.crossratio3(d,a,f,h.cross(h.cross(d,f),h.linfty),h.ii).value.real?N.drawsegcore(c,m):N.drawRaySegment(d,a)}return A};K.drawcircle=function(a,b,c){var d=W(a[0]);a=W(a[1]);var f=K.extractPoint(d);if(!f.ok||"number"!==a.ctype||!n._helper.isAlmostReal(a))return A;d=O.drawingstate.matrix;const k=f.x*d.a-f.y*d.b+d.tx;f=f.x*d.c-f.y*d.d-d.ty;N.handleModifs(b,N.conicModifs);N.preDrawCurve();P.lineJoin="miter";P.beginPath();P.arc(k,f,Math.abs(a.value.real)*d.sdet,0,2*Math.PI);P.closePath();"D"===c&&P.stroke();
"F"===c&&(P.fillStyle=N.lineColor,P.fill());"C"===c&&P.clip();return A};z.drawconic$1=function(a,b){a=W(a[0]);if("list"!==a.ctype||3!==a.value.length&&6!==a.value.length)return console.error("could not parse conic"),A;if(6===a.value.length){for(var c=0;6>c;c++)if("number"!==a.value[c].ctype)return console.error("could not parse conic"),A;const d=n.real(.5);c=a.value[0];let f=a.value[2];f=n.mult(f,d);const k=a.value[1];let m=a.value[3];m=n.mult(m,d);let q=a.value[4];q=n.mult(q,d);a=a.value[5];a=h.turnIntoCSList([h.turnIntoCSList([c,
f,m]),h.turnIntoCSList([f,k,q]),h.turnIntoCSList([m,q,a])])}else{if(!h.isNumberMatrix(a).value||3!==a.value.length||3!==a.value[0].value.length)return A;c=h.transpose(a);h.equals(a,c).value||(a=h.add(c,a))}return K.drawconic(a,b)};K.drawconic=function(a,b){function c(la,Aa){la=(t*la+w*Aa+y)*la+(C*Aa+F)*Aa+H;return 0<=la?1:0>la?-1:NaN}function d(la){Ka.next=la;la.prev=Ka;return Ka=la}function f(la,Aa,vb,yb){return{a:la,b1:Aa,b2:vb,vertical:!0,index:yb,sign:function(Fb){return c(la,Fb)},mkp:function(Fb){return{x:la,
y:Fb}},sol:Yc(C,w*la+F,(t*la+y)*la+H),discr:function(){return Yc(da,-2*Z,R)},tpt:function(Fb){return{x:Fb,y:-.5*(w*Fb+F)/C}}}}function k(la,Aa,vb,yb){return{a:la,b1:Aa,b2:vb,vertical:!1,index:yb,sign:function(Fb){return c(Fb,la)},mkp:function(Fb){return{x:Fb,y:la}},sol:Yc(t,w*la+y,(C*la+F)*la+H),discr:function(){return Yc(da,-2*pa,U)},tpt:function(Fb){return{x:-.5*(w*Fb+y)/t,y:Fb}}}}function m(la){var Aa=Math.min(la.b1,la.b2);const vb=Math.max(la.b1,la.b2);var yb=la.sign(Aa);const Fb=la.sign(vb);
if(!isFinite(yb*Fb))return!1;let lb=la.sol,rb;if(yb!==Fb){if(null===lb)return!1;rb=.5*(lb[0]+lb[1]);rb>Aa&&rb<vb?(Aa=la.sign(rb),rb=lb[Aa===Fb?0:1]):(yb=.5*(Aa+vb),rb=lb[Math.abs(yb-lb[0])<Math.abs(yb-lb[1])?0:1]);Ra.push(d(la.mkp(rb)))}else{if(null===lb){if(0>=Ba)return!0;lb=la.discr();if(null===lb)return!0;la=la.tpt(lb[la.index]);la.x>=Oa&&la.x<=Ja&&la.y>=ta&&la.y<=Wa&&d(la);return!0}rb=.5*(lb[0]+lb[1]);if(!(rb>Aa&&rb<vb))return!0;Aa=la.sign(rb);if(Aa===yb||isNaN(Aa))return!0;la.b1>la.b2&&(lb=[lb[1],
lb[0]]);Ra.push(d(la.mkp(lb[0])));Ra.push(d(la.mkp(lb[1])))}return!0}function q(la,Aa,vb,yb,Fb){var lb=Aa-yb,rb=vb-la,mc=la*yb-Aa*vb,Sb=Z*lb+pa*rb+da*mc;if(1E-14>Math.abs(Sb))return P.lineTo(vb,yb);const Zd=(R*lb+S*rb+Z*mc)/Sb;lb=(S*lb+U*rb+pa*mc)/Sb;if(!isFinite(Zd)||!isFinite(lb)||.04>Math.abs(la*lb+Zd*yb+vb*Aa-vb*lb-Zd*Aa-la*yb))return P.lineTo(vb,yb);do{if(10<Fb)break;mc=.5*(la+vb);rb=.5*(Aa+yb);var sc=Zd-mc;Sb=lb-rb;if(.04>sc*sc+Sb*Sb)break;const Df=t*sc*sc+w*sc*Sb+C*Sb*Sb,yf=2*t*sc*mc+w*(sc*
rb+Sb*mc)+2*C*Sb*rb+y*sc+F*Sb,Ef=(t*mc+w*rb+y)*mc+(C*rb+F)*rb+H;let Nc=Yc(Df,yf,Ef);Nc||(Nc=[-.5*yf/Df,-2*Ef/yf]);if(0<Nc[0])Nc=Nc[0];else if(0<=Nc[1])Nc=Nc[1];else break;sc=mc+Nc*sc;Sb=rb+Nc*Sb;mc=sc-.5*(Zd+mc);rb=Sb-.5*(lb+rb);if(!(.04>mc*mc+rb*rb)){q(la,Aa,sc,Sb,Fb+1);q(sc,Sb,vb,yb,Fb+1);return}}while(0);P.quadraticCurveTo(Zd,lb,vb,yb)}N.handleModifs(b,N.conicModifs);if(0!==N.lsize&&(N.preDrawCurve(),a=h.normalizeMax(a),h._helper.isAlmostReal(a))){b=O.toMat();a=h.mult(h.transpose(b),a);a=h.mult(a,
b);a=h.normalizeMax(a);var t=a.value[0].value[0].value.real,w=2*a.value[0].value[1].value.real,y=2*a.value[0].value[2].value.real,C=a.value[1].value[1].value.real,F=2*a.value[1].value[2].value.real,H=a.value[2].value[2].value.real,R=4*H*C-F*F,S=F*y-2*H*w,Z=F*w-2*C*y,U=4*H*t-y*y,pa=y*w-2*F*t,da=4*C*t-w*w,Ba=da;a=C*U+w*S+t*R-H*da;0>a&&(t=-t,w=-w,y=-y,C=-C,F=-F,H=-H,a=-a);a=N.lsize;var Oa=-a,ta=-a,Ja=gb+a,Wa=ib+a,Ra=[],Ka=a={};if(m(f(Oa,ta,Wa,0))&&m(k(Wa,Oa,Ja,1))&&m(f(Ja,Wa,ta,1))&&m(k(ta,Ja,Oa,0))&&
Ka!==a){Ka.next=a.next;a.next.prev=Ka;P.beginPath();if(0===Ra.length){var Na=Ka;P.moveTo(Na.x,Na.y);do{var cb=Na.next;q(Na.x,Na.y,cb.x,cb.y,0);Na=cb}while(Na!==Ka);P.closePath()}b=1===c(Oa,ta)?0:1;if(4===Ra.length){let la=0;for(a=0;2>a;++a){Na=Ra[a];cb=Ra[a+2];const Aa=cb.x-Na.x;Na=cb.y-Na.y;Na=(t*Aa+w*Na)*Aa+C*Na*Na;Math.abs(Na)>Math.abs(la)&&(la=Na)}if(isNaN(la))return;0<=la&&(b=1-b)}for(a=b;a<Ra.length;a+=2)for(Na=Ra[a],b=Ra[(a+1)%Ra.length],P.moveTo(Na.x,Na.y),cb=Na.next;Na!==b;cb=(Na=cb).next)q(Na.x,
Na.y,cb.x,cb.y,0);P.stroke()}}};z.drawall$1=function(a,b){a=L(a[0]);if("list"===a.ctype)for(N.handleModifs(b,N.pointAndLineModifs),b=0;b<a.value.length;b++)z.draw$1([a.value[b]],null);return A};z.connect$1=function(a,b){return K.drawpolygon(a,b,"D",!1)};z.drawpoly$1=function(a,b){return K.drawpolygon(a,b,"D",!0)};z.fillpoly$1=function(a,b){return K.drawpolygon(a,b,"F",!0)};z.drawpolygon$1=function(a,b){return K.drawpolygon(a,b,"D",!0)};z.fillpolygon$1=function(a,b){return K.drawpolygon(a,b,"F",!0)};
K.drawpolygon=function(a,b,c,d){function f(){var t=q.value;for(const y of t){for(t=0;t<y.length;t++){var w=y[t];const C=w.X*m.a-w.Y*m.b+m.tx;w=w.X*m.c-w.Y*m.d-m.ty;0===t?P.moveTo(C,w):P.lineTo(C,w)}P.closePath()}}function k(){let t;for(t=0;t<q.value.length;t++){var w=K.extractPoint(q.value[t]);if(!w.ok)return;const y=w.x*m.a-w.y*m.b+m.tx;w=w.x*m.c-w.y*m.d-m.ty;0===t?P.moveTo(y,w):P.lineTo(y,w)}d&&P.closePath()}N.handleModifs(b,d?N.conicModifs:N.lineModifs);N.preDrawCurve();const m=O.drawingstate.matrix;
var q=L(a[0]);P.beginPath();"list"===q.ctype&&k();"shape"===q.ctype&&f();"D"===c&&(N.fillColor&&(P.fillStyle=N.fillColor,P.fill(N.fillrule)),P.stroke());"F"===c&&(P.fillStyle=N.lineColor,P.fill(N.fillrule));"C"===c&&P.clip();return A};let Lb=$d,Sc=function(a,b,c){if(b.includes("\n"))for(b=b.split("\n"),a.textContent=b[0],c=1;c<b.length;++c)a.appendChild(document.createElement("br")),a.appendChild(document.createTextNode(b[c]));else a.textContent=b};K.drawtext=function(a,b,c){var d=W(a[0]);a=L(a[1]);
var f=K.extractPoint(d);if(!f.ok)return null;N.handleModifs(b,N.textModifs);b=O.drawingstate.textsize;null===b&&(b=ub.textsize);null!==N.size&&(b=N.size);P.fillStyle=N.textColor;const k=O.drawingstate.matrix;d=f.x*k.a-f.y*k.b+k.tx+N.xOffset;f=f.x*k.c-f.y*k.d-k.ty-N.yOffset;a=ja(a);Ob._pluginRegistry.katex||"string"!==typeof a||3<=a.split("$").length&&db("katex","katex-plugin.js",!0);P.font=N.bold+N.italics+Math.round(10*b)/10+"px "+N.family;return c?c(a,d,f,N.align,b):Lb(P,a,d,f,N.align,b,b*ub.lineHeight,
N.angle)};z.drawtext$2=function(a,b){K.drawtext(a,b,null);return A};z.drawtable$2=function(a,b){var c=W(a[0]);a=W(a[1]);var d=K.extractPoint(c);if(!d.ok||"list"!==a.ctype)return A;c=a.value;a=c.length;let f=-1;var k;for(k=0;k<a;++k)"list"===c[k].ctype&&c[k].value.length>f&&(f=c[k].value.length);-1===f?(c=c.map(function(H){return[H]}),f=1):c=c.map(function(H){return h.asList(H).value});let m=100,q=null,t=!0,w=O.drawingstate.textcolor;N.handleModifs(b,{size:!0,color:function(H){h._helper.isNumberVecN(H,
3)&&(w=N.makeColor([H.value[0].value.real,H.value[1].value.real,H.value[2].value.real]))},alpha:!0,bold:!0,italics:!0,family:!0,align:!0,xoffset:!0,yoffset:!0,offset:!0,width:function(H){"number"===H.ctype&&(m=H.value.real)},height:function(H){"number"===H.ctype&&(q=H.value.real)},border:function(H){"boolean"===H.ctype&&(t=H.value)}});k=O.drawingstate.textsize;null===k&&(k=ub.textsize);null!==N.size&&(k=N.size);null===q&&(q=1.6*k);P.font=N.bold+N.italics+Math.round(10*k)/10+"px "+N.family;k=O.drawingstate.matrix;
var y=f*m;const C=a*q;b=d.x*k.a-d.y*k.b+k.tx+N.xOffset;let F=d.x*k.c-d.y*k.d-k.ty-N.yOffset-C;if(t){N.preDrawCurve();P.strokeStyle=N.lineColor;P.beginPath();for(k=1;k<a;++k)P.moveTo(b,F+k*q),P.lineTo(b+y,F+k*q);for(d=1;d<f;++d)P.moveTo(b+d*m,F),P.lineTo(b+d*m,F+C);P.stroke();P.lineWidth=N.lsize+1;P.beginPath();P.rect(b,F,y,C);P.stroke()}b+=N.align*m+(1-2*N.align)*q*.3;F+=.7*q;P.fillStyle=w;for(k=0;k<a;++k)for(d=0;d<f;++d)y=ja(c[k][d]),Lb(P,y,b+d*m,F+k*q,N.align);return A};K.drawshape=function(a,b){return"polygon"===
a.type?K.drawpolygon([a],b,"D",1):"circle"===a.type?K.drawcircle([a.value.value[0],a.value.value[1]],b,"D"):A};K.fillshape=function(a,b){return"polygon"===a.type?K.drawpolygon([a],b,"F",1):"circle"===a.type?K.drawcircle([a.value.value[0],a.value.value[1]],b,"F"):A};K.clipshape=function(a,b){return"polygon"===a.type?K.drawpolygon([a],b,"C",1):"circle"===a.type?K.drawcircle([a.value.value[0],a.value.value[1]],b,"C"):A};z.fill$1=function(a,b){a=L(a[0]);return"shape"===a.ctype?K.fillshape(a,b):A};z.clip$1=
function(a,b){const c=L(a[0]);return"shape"===c.ctype?K.clipshape(c,b):"list"===c.ctype?(a=z.polygon$1(a,[]),z.clip$1([a],[])):A};z.plot$1=function(a,b){return z.plot$2([a[0],null],b)};z.plot$2=function(a,b){function c(da){return"number"===da.ctype&&n._helper.isAlmostReal(da)}function d(da,Ba,Oa,ta,Ja){q++;Ba=+Ba.value.real;Ja=+ta.value.real;ta=Ba*S.a-Ja*S.b+S.tx;Ba=Ba*S.c-Ja*S.d-S.ty;da=+da.value.real;Ja=+Oa.value.real;Oa=da*S.a-Ja*S.b+S.tx;da=da*S.c-Ja*S.d-S.ty;t?(P.lineTo(Oa,da),P.lineTo(ta,Ba)):
(P.beginPath(),P.moveTo(Oa,da),P.lineTo(ta,Ba),t=!0)}function f(da,Ba,Oa,ta,Ja){var Wa=c(Oa),Ra=c(ta);if(.001>Ja)!k&&t&&(P.stroke(),t=!1);else if(Wa||Ra){var Ka=n.real((da.value.real+Ba.value.real)/2);Y.setvar(R,Ka);var Na=L(H),cb=c(Na);if(Wa&&Ra&&cb){var la=Oa.value.real;Ra=Na.value.real;cb=ta.value.real;if(Wa=1>Math.abs(la+cb-2*Ra)/m){var Aa=n.real((da.value.real+Ka.value.real)/2);Y.setvar(R,Aa);Aa=L(H);var vb=n.real((Ka.value.real+Ba.value.real)/2);Y.setvar(R,vb);vb=L(H);la=Math.abs(la+Ra-2*Aa.value.real)/
m;Ra=Math.abs(Ra+cb-2*vb.value.real)/m;Wa=Wa&&1>la&&1>Ra}Wa?(d(da,Ka,Oa,Na,Ja/2),d(Ka,Ba,Na,ta,Ja/2)):(f(da,Ka,Oa,Na,Ja/2),f(Ka,Ba,Na,ta,Ja/2))}else f(da,Ka,Oa,Na,Ja/2),f(Ka,Ba,Na,ta,Ja/2)}}let k=!1;const m=.2/Ld;let q=0,t=!1,w=-10,y=10,C=.1,F=1E3;const H=a[0];let R;null!==a[1]&&"variable"===a[1].ctype?R=a[1].name:(a=K.plotvars(H),R="#",a.includes("t")&&(R="t"),a.includes("z")&&(R="z"),a.includes("y")&&(R="y"),a.includes("x")&&(R="x"));Y.newvar(R);const S=O.drawingstate.matrix;N.handleModifs(b,{color:!0,
alpha:!0,size:!0,dashpattern:!0,dashtype:!0,dashing:!0,lineCap:!0,lineJoin:!0,miterLimit:!0,connect:function(da){"boolean"===da.ctype&&(k=da.value)},start:function(da){"number"===da.ctype&&(w=da.value.real)},stop:function(da){"number"===da.ctype&&(y=da.value.real)},steps:function(da){"number"===da.ctype&&(F=da.value.real)}});P.strokeStyle=N.lineColor;P.lineWidth=N.lsize;let Z;t=!1;b=n.real(14.32);Y.setvar(R,b);Z=L(H);if("number"!==Z.ctype){if(h.isNumberVector(Z).value&&2===Z.value.length){t=!1;C=
(y-w)/F;for(b=w;b<y;b+=C){Y.setvar(R,n.real(b));var U=L(H);if(h.isNumberVector(U).value&&2===U.value.length){var pa=+U.value[0].value.real;U=+U.value[1].value.real;a=pa*S.a-U*S.b+S.tx;pa=pa*S.c-U*S.d-S.ty;t?P.lineTo(a,pa):(P.beginPath(),P.moveTo(a,pa),t=!0)}}P.stroke();Y.removevar(R)}return A}for(a=w;a<y+C;a+=C)b=n.real(a),Y.setvar(R,b),Z=L(H),b.value.real>w&&f(pa,b,U,Z,C),pa=b,U=Z;Y.removevar(R);t&&P.stroke();return A};z.plotX$1=function(a,b){a=a[0];var c=K.plotvars(a);b="#";c.includes("t")&&(b=
"t");c.includes("z")&&(b="z");c.includes("y")&&(b="y");c.includes("x")&&(b="x");Y.newvar(b);c=O.drawingstate.matrix;P.fillStyle=O.drawingstate.linecolor;P.lineWidth=1;P.lineCap=N.lineCap;P.lineJoin=N.lineJoin;P.miterLimit=N.miterLimit;let d=!1;for(let m=-10;10>m;m+=.01){Y.setvar(b,n.real(m));var f=L(a);if("number"===f.ctype){var k=+f.value.real;f=m*c.a-k*c.b+c.tx;k=m*c.c-k*c.d-c.ty;d?P.lineTo(f,k):(P.beginPath(),P.moveTo(f,k),d=!0)}}P.stroke();Y.removevar(b);return A};K.plotvars=function(a){function b(q,
t){const w={};let y;for(y=q.length-1;0<=y;--y)w[q[y]]=q[y];for(y=t.length-1;0<=y;--y)w[t[y]]=t[y];q=[];for(const C in w)w.hasOwnProperty(C)&&q.push(w[C]);return q}function c(q,t){for(let w=0;w<q.length;w++)q[w]===t&&(q.splice(w,1),w--);return q}let d,f,k,m;if("variable"===a.ctype)return[a.name];if("infix"===a.ctype)return d=K.plotvars(a.args[0]),a=K.plotvars(a.args[1]),b(d,a);if("list"===a.ctype){k=a.value;f=[];for(m=0;m<k.length;m++)d=K.plotvars(k[m]),f=b(f,d);return f}if("function"===a.ctype){k=
a.args;f=[];for(m=0;m<k.length;m++)d=K.plotvars(k[m]),f=b(f,d);"apply"!==a.oper&&"select"!==a.oper&&"forall"!==a.oper&&"sum"!==a.oper&&"product"!==a.oper&&"repeat"!==a.oper&&"min"!==a.oper&&"max"!==a.oper&&"sort"!==a.oper||"variable"!==a.args[1].ctype||(f=c(f,a.args[1].name));return f}return[]};z.clrscr$0=function(a,b){"undefined"!==typeof gb&&"undefined"!==typeof ib&&P.clearRect(0,0,gb,ib);return A};z.repaint$0=function(a,b){x();return A};z.screenbounds$0=function(a,b){a=p.withUsage(h.realVector(O.to(0,
0)),"Point");b=p.withUsage(h.realVector(O.to(fb.clientWidth,0)),"Point");const c=p.withUsage(h.realVector(O.to(fb.clientWidth,fb.clientHeight)),"Point"),d=p.withUsage(h.realVector(O.to(0,fb.clientHeight)),"Point");return h.turnIntoCSList([a,b,c,d])};z.createimage$3=function(a,b){b=L(a[0]);const c=W(a[1]);a=W(a[2]);if("number"!==c.ctype||"number"!==a.ctype||"string"!==b.ctype)return A;const d=document.createElement("canvas");d.id=b.value;d.width=c.value.real;d.height=a.value.real;d.style.display="none";
document.body.appendChild(d);yc[b.value]=nb(d,!1);return A};z.clearimage$1=function(a,b){a=L(a[0]);if("string"!==a.ctype&&"image"!==a.ctype)return A;a=Tb(a);if(!a)return A;b=a.img;if("undefined"===typeof b||null===b)return A;const c=a.width,d=a.height;b.getContext("2d").clearRect(0,0,c,d);a.generation++;return A};z.canvas$4=function(a,b){var c=W(a[0]),d=W(a[1]);b=L(a[2]);a=a[3];var f=K.extractPoint(c),k=K.extractPoint(d);if(!f.ok||!k.ok||"string"!==b.ctype&&"image"!==b.ctype)return A;b=Tb(b);if(!b||
!b.img.getContext)return A;d=b.img;var m=b.width;c=b.height;var q=k.x-f.x,t=k.y-f.y,w=f.x-t*c/m,y=f.y+q*c/m;t=k.x-t*c/m;q=k.y+q*c/m;k=O.from(f.x,f.y,1);w=O.from(w,y,1);t=O.from(t,q,1);f=k[0]*pb;y=k[1]*pb;q=w[0]*pb;const C=w[1]*pb,F=t[0]*pb,H=t[1]*pb;w=m*(y-C)/((f-q)*(y-H)-(f-F)*(y-C));m=m*(f-q)/((y-C)*(f-F)-(y-H)*(f-q));t=-w*f-m*y;k=(c*(y-H)-c*(y-C))/((f-q)*(y-H)-(f-F)*(y-C));q=(c*(f-F)-c*(f-q))/((y-C)*(f-F)-(y-H)*(f-q));c=c-k*f-q*y;d=d.getContext("2d");f=P;P=d;P.save();P.transform(w,k,m,q,t,c);b.generation++;
L(a);P.restore();P=f};z.canvas$5=function(a,b){var c=W(a[0]),d=W(a[1]),f=W(a[2]);b=L(a[3]);a=a[4];c=K.extractPoint(c);var k=K.extractPoint(d),m=K.extractPoint(f);if(!c.ok||!k.ok||!m.ok||"string"!==b.ctype&&"image"!==b.ctype)return A;b=Tb(b);if(!b||!b.img.getContext)return A;f=b.img;var q=b.width;d=b.height;var t=O.from(c.x,c.y,1),w=O.from(k.x,k.y,1);k=O.from(m.x,m.y,1);c=t[0]*pb;m=t[1]*pb;var y=w[0]*pb;const C=w[1]*pb,F=k[0]*pb,H=k[1]*pb;k=((0-q)*(m-H)-0*(m-C))/((c-y)*(m-H)-(c-F)*(m-C));q=((0-q)*
(c-F)-0*(c-y))/((m-C)*(c-F)-(m-H)*(c-y));w=-(k*c)-q*m;t=((d-d)*(m-H)-(d-0)*(m-C))/((c-y)*(m-H)-(c-F)*(m-C));y=((d-d)*(c-F)-(d-0)*(c-y))/((m-C)*(c-F)-(m-H)*(c-y));d=d-t*c-y*m;f=f.getContext("2d");c=P;P=f;P.save();P.transform(k,t,q,y,w,d);b.generation++;L(a);P.restore();P=c};z.screenresolution$0=function(a,b){return n.real(O.drawingstate.matrix.a)};z.layer$1=function(a,b){};z.imagesize$1=function(a,b){a=Tb(W(a[0]));b=function(c){return"number"===typeof c&&Number.isFinite(c)};return void 0!=a&&b(a.width)&&
b(a.height)?h.realVector([+a.width,+a.height]):A};z.imageready$1=function(a,b){a=Tb(W(a[0]));return p.bool(!(!a||!a.ready))};z.drawimage$2=function(a,b){function c(){var t=1,w=1,y=1,C=1,F=0,H=1,R=K.extractPoint(f);if(!R.ok)return A;k=Tb(k);if(!k)return A;P.save();if(void 0!==b.angle){var S=L(b.angle);"number"===S.ctype&&(F=S.value.real)}void 0!==b.rotation&&(S=L(b.rotation),"number"===S.ctype&&(F=S.value.real));void 0!==b.scale&&(S=W(b.scale),"number"===S.ctype&&(w=t=S.value.real),h.isNumberVector(S).value&&
2===S.value.length&&(t=S.value[0].value.real,w=S.value[1].value.real));void 0!==b.scalex&&(S=L(b.scalex),"number"===S.ctype&&(t=S.value.real));void 0!==b.scaley&&(S=L(b.scaley),"number"===S.ctype&&(w=S.value.real));void 0!==b.flipx&&(S=L(b.flipx),"boolean"===S.ctype&&S.value&&(y=-1));void 0!==b.flipy&&(S=L(b.flipy),"boolean"===S.ctype&&S.value&&(C=-1));void 0!==b.alpha&&(S=L(b.alpha),"number"===S.ctype&&(H=S.value.real));P.imageSmoothingEnabled=!0;void 0!==b.interpolate&&(S=L(b.interpolate),"boolean"===
S.ctype&&(P.imageSmoothingEnabled=S.value));var Z=O.drawingstate.matrix,U=O.drawingstate.initialmatrix;const pa=k.width,da=k.height;S=R.x*Z.a-R.y*Z.b+Z.tx;const Ba=R.x*Z.c-R.y*Z.d-Z.ty;var Oa=(R.x+1)*Z.a-R.y*Z.b+Z.tx-S;Z=(R.x+1)*Z.c-R.y*Z.d-Z.ty-Ba;const ta=(R.x+1)*U.a-R.y*U.b+U.tx-(R.x*U.a-R.y*U.b+U.tx);U=(R.x+1)*U.c-R.y*U.d-U.ty-(R.x*U.c-R.y*U.d-U.ty);R=Math.sqrt(Oa*Oa+Z*Z)/Math.sqrt(ta*ta+U*U);Oa=-Math.atan2(Oa,Z)+Math.atan2(ta,U);Z=O.drawingstate.matrix.sdet/72;t*=Z;w*=Z;1!==H&&(P.globalAlpha=
H);P.translate(S,Ba);P.scale(t*y*R,w*C*R);P.rotate(F+Oa);P.translate(-S,-Ba);P.translate(-pa/2,-da/2);t=k;t.drawTo?t.drawTo(P,S,Ba):P.drawImage(t.img,S,Ba);P.globalAlpha=1;P.restore()}function d(){var t=1,w=1;let y=1,C=1;var F=K.extractPoint(f);const H=K.extractPoint(m);let R;if(!F.ok||!H.ok)return A;k=Tb(k);if(!k)return A;const S=k.width,Z=k.height;if(0===q)R={},R.x=F.x-(H.y-F.y),R.y=F.y+(H.x-F.x),C=Z/S;else if(R=K.extractPoint(q),!F.ok)return A;P.save();if(void 0!==b.alpha){var U=L(b.alpha);"number"===
U.ctype&&(t=U.value.real)}void 0!==b.aspect&&(U=L(b.aspect),"number"===U.ctype&&(C=U.value.real));void 0!==b.flipx&&(U=L(b.flipx),"boolean"===U.ctype&&U.value&&(w=-1));void 0!==b.flipy&&(U=L(b.flipy),"boolean"===U.ctype&&U.value&&(y=-1));P.imageSmoothingEnabled=!0;void 0!==b.interpolate&&(U=L(b.interpolate),"boolean"===U.ctype&&(P.imageSmoothingEnabled=U.value));U=O.drawingstate.matrix;1!==t&&(P.globalAlpha=t);t=F.x*U.a-F.y*U.b+U.tx;F=F.x*U.c-F.y*U.d-U.ty;P.transform(H.x*U.a-H.y*U.b+U.tx-t,H.x*U.c-
H.y*U.d-U.ty-F,R.x*U.a-R.y*U.b+U.tx-t,R.x*U.c-R.y*U.d-U.ty-F,t,F);P.scale(1/S,-1/Z*C);P.translate(S/2,-Z/2);P.scale(w,y);P.translate(-S/2,Z/2);P.translate(0,-Z);w=k;w.drawTo?w.drawTo(P,0,0):P.drawImage(w.img,0,0);P.globalAlpha=1;P.restore()}if(2===a.length){var f=W(a[0]);var k=W(a[1]);return c()}if(3===a.length){f=W(a[0]);var m=W(a[1]);var q=0;k=W(a[2]);return d()}return 4===a.length?(f=W(a[0]),m=W(a[1]),q=W(a[2]),k=W(a[3]),d()):A};z.drawimage$3=z.drawimage$2;z.drawimage$4=z.drawimage$2;z.allimages$0=
function(){const a=[];Object.keys(yc).forEach(function(b){a.push({ctype:"string",value:b})});return h.turnIntoCSList(a)};const Rc={};z.cameravideo$0=function(a,b){function c(m){return{video:{width:m,advanced:[{width:{max:m,min:m}},{width:{ideal:m}}]},audio:!1}}a=!0;let d={};void 0!==b.resolution&&(b=L(b.resolution),"string"===b.ctype&&"maximal"===b.value?a=!0:"number"===b.ctype?(a=!1,d=c(b.value.real)):h._helper.isNumberVecN(b,2)&&(a=!1,d=c(b.value[0].value.real),b=b.value[1].value.real,10>b||!Number.isInteger(b)?
(d.video.aspectRatio=b,d.video.advanced[0].aspectRatio={min:b,max:b},d.video.advanced[1].aspectRatio={ideal:b}):(d.video.height=b,d.video.advanced[0].height={min:b,max:b},d.video.advanced[1].height={ideal:b})));a&&(d=[320,640,1024,1280,1920,2560],d=d.map(function(m){return{width:{min:m}}}),d={video:{width:16E3,height:9E3,advanced:d},audio:!1});a=JSON.stringify(d);if(Rc[a])return Rc[a];b=null;let f=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia;f?b=function(m,q){navigator.mediaDevices.getUserMedia(d).then(m,
q)}:(f=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)&&(b=function(m,q){f.call(navigator,d,m,q)});if(!b)return console.warn("getUserMedia call not supported"),Rc[a]=A;const k=document.createElement("video");k.autoplay=!0;Rc[a]=nb(k,!0);console.log("Opening stream.");b(function(m){k.srcObject=m;k.setAttribute("autoplay","");k.setAttribute("muted","");k.setAttribute("playsinline","");k.play();k.addEventListener("loadeddata",Ca)},function(m){console.error("Could not get user video:",
String(m),m)});return Rc[a]};z.playvideo$1=function(a,b){a=Tb(W(a[0]));a.live&&a.img.play&&a.img.play();return A};z.pausevideo$1=function(a,b){a=Tb(W(a[0]));a.live&&a.img.pause&&a.img.pause();return A};let vd;z.imagergba$3=function(a,b){b=Tb(W(a[0]));let c=W(a[1]);a=W(a[2]);if(!b||"number"!==c.ctype||"number"!==a.ctype||!b.ready)return A;c=Math.round(c.value.real);a=Math.round(a.value.real);if(!Wb(c)||!Wb(a))return A;a=Ic(b,c,a,1,1);return h.realVector([255*a[0],255*a[1],255*a[2],a[3]])};z.imagergb$3=
z.imagergba$3;z.imagergba$4=function(a,b){var c=Tb(W(a[2]));if(!c||!c.ready)return A;var d=c.width,f=c.height,k=ya(a[0]),m=ya(a[1]),q=ya(h.realVector([0,f,1]));d=ya(h.realVector([d,f,1]));if(k===A||m===A||t===A)return A;t=h.ii;f=h.jj;q=K.basismap(q,d,t,f);k=K.basismap(k,m,f,t);var t=ya(a[3]);f=K.extractPoint(p.mult(q,p.mult(h.adjoint3(k),t)));if(f.ok)if(a=c.width,k=c.height,m=!0,q=!1,void 0!==b.interpolate&&(t=L(b.interpolate),"boolean"===t.ctype&&(m=t.value)),void 0!==b.repeat&&(t=L(b.repeat),"boolean"===
t.ctype&&(q=t.value)),m&&(f.x-=.5,f.y-=.5),q&&(f.x=(f.x%a+a)%a,f.y=(f.y%k+k)%k),t=Math.floor(f.x),d=Math.floor(f.y),Wb(t)&&Wb(d)){b=[0,0,0,0];if(m){m=f.x-t;f=f.y-d;let w=Ic(c,t,d,2,2);if(q){if(t===a-1||d===k-1){q=Ic(c,(t+1)%a,d,1,1);const y=Ic(c,t,(d+1)%k,1,1);c=Ic(c,(t+1)%a,(d+1)%k,1,1);w=w.slice(0,4).concat(q,y,c)}}else{if(-1===t||t===a-1)m=Math.round(m);if(-1===d||d===k-1)f=Math.round(f)}for(c=0;4>c;c++)b[c]=(1-f)*((1-m)*w[c]+m*w[c+4])+f*((1-m)*w[c+8]+m*w[c+12])}else b=Ic(c,t,d,1,1);c=h.realVector(b)}else c=
A;else c=A;return c};z.imagergb$4=function(a,b){a=z.imagergba$4(a,b);return a===A?A:h.turnIntoCSList(a.value.slice(0,3))};z.readpixels$1=function(a,b){a=Tb(W(a[0]));a=Ic(a,0,0,a.width,a.height);b=[];for(let c=0;c+3<a.length;c+=4)b.push(h.turnIntoCSList([n.real(a[c+0]),n.real(a[c+1]),n.real(a[c+2]),n.real(a[c+3])]));return h.turnIntoCSList(b)};"use strict";const nf=[{key:[":"],field:["."],deg:["\u00b0"],take:["_"]},{functionCall:!0},{rassoc:!0,pow:["^"],sqrt:["\u221a"]},{mul:["*","\u2062","\u22c5",
"\u00b7"],cross:["\u00d7"],div:["/","\u00f7","\u2215","\u2236"]},{add:["+"],sub:["-","\u2212"],neg:["!","\u00ac"]},{seq:[".."]},{eq:["==","\u225f"],ne:["!=","<>","\u2260"],lt:["<"],gt:[">"],le:["<=","\u2264","\u2266"],ge:[">=","\u2265","\u2267"],aeq:["~=","\u2248"],ane:["~!=","\u2249"],alt:["~<","\u2a89"],agt:["~>","\u2a8a"],ale:["~<=","\u2a85"],age:["~>=","\u2a86"],in:["\u2208"],nin:["\u2209"]},{and:["&","\u2227"],or:["%","\u2228"]},{rassoc:!0,prepend:["<:"]},{concat:["++","\u222a"],remove:["--",
"\u2216"],common:["~~","\u2229"],append:[":>"]},{rassoc:!0,assign:["="],define:[":="],undefine:[":=_"],bdefine:["::="]},{seq:[";"]},{modif:["->","\u2192"]},{rassoc:!0,list:[","]}],ka=["+","-"],qa=["!","\u221a"],oa=["\u00b0",":=_"],Sa=[";",","],Va=[],na={};let Vb;(function(){let a=0;nf.forEach(function(b){a+=2;const c=!!b.rassoc;b.functionCall&&(Vb=a);for(const d in b){const f=b[d];if("boolean"===typeof f)continue;const k={name:d,sym:f[0],symbols:f,rassoc:c,precedence:a,prefix:!1,postfix:!1,infix:!0,
bare:!1};for(const m of f){if(na.hasOwnProperty(m))throw Error("Duplicate operator: "+m);na[m]=k;Va.push(m)}}});ka.forEach(function(b){na[b].prefix=!0});qa.forEach(function(b){na[b].prefix=!0;na[b].infix=!1});oa.forEach(function(b){na[b].postfix=!0;na[b].infix=!1});Sa.forEach(function(b){na[b].prefix=!0;na[b].postfix=!0;na[b].infix=!0;na[b].bare=!0})})();Va.sort(function(a,b){return b.length-a.length});const Fc="(?:[\u207a\u207b] )?[\u2070\u00b9\u00b2\u00b3\u2074\u2075\u2076\u2077\u2078\u2079](?: [\u2070\u00b9\u00b2\u00b3\u2074\u2075\u2076\u2077\u2078\u2079])*".replace(/ /g,
"[ \t]*"),hd="(?:[\u208a\u208b] )?[\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089](?: [\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089])*".replace(/ /g,"[ \t]*"),Tc=function(a,b,c){let d;let f=0,k="(?:[";const m=b.length;for(d=0;d<m;++d){var q=b.charCodeAt(d);55296<=q?(k+="]|"+b.charAt(d)+"[",f=56320):(k+=String.fromCharCode(q=f=a[q-32]+f),f+=a[b.charCodeAt(++d)-32],f!==q&&(f!==q+1&&(k+="-"),k+=String.fromCharCode(f)))}return k+"]|["+c+"][\udc00-\udfff])"}([2,0,106,3,4,
1,6,5,7,11,17,8,12,21,9,22,30,10,15,24,25,16,13,42,46,14,18,19,29,37,27,28,35,26,32,36,40,43,47,53,20,48,50,56,33,34,39,51,52,55,63,64,65,68,85,23,31,38,45,49,105,59,66,69,72,88,102,114,117,128,157,191,41,44,54,60,67,70,71,73,74,75,76,80,81,82,83,84,86,87,89,93,94,98,99,107,108,116,122,130,132,134,138,160,165,185,195,196,255,268,277,310,332,339,362,365,390,449,457,470,512,513,541,568,582,619,673,726,768,820,921,991,1164,2684,6581,8453,11171,20949],"T4(4I!)!'!&/ 0 \u0096')2$+! !\u0083$ %## !(!   ! ; u \u0086.\u0088 =#!+YoA& 87C% } !5%+%) #!*! <0a,!4B1%'!&-'!1!$!33`HsG$!;!+.52'(#%#- & !$#$!*!9%  2%H''%#- & % % %B# !H *+   - & % $$!;!5%3!,(#%#- & % $$!X%  5!:! '$  #$% ! %$%$ $)W!G(   / 2$!> &%C(   / . $$!L! %5%;(   D#!*!* 4'&*$W + !#&]F %6&]% !#% !#!(# &   ! !#% # %1!#$ !/#L!S( @?$\u00817-!*''#$!$%+ ',6!:= !&!#7 \u0090 ##& ! ##D ##B ##& ! ##9 K ##^Y2*V#'$\u009d#5 4&p((+, #2*2*2,  5OC!'!Uy.D !&_)0J<#$,E'4Q/1Pv!|8:&K<9%)E>@7 )@\u0080# #$%1gT\u008e#'#=#'#( ! ! ! 0#P & !$  &$##'',&  &d!9!*,b!'!#. !$$(! ! ! # 1##&$'!G%\u00a58 8 \u0084(#$%6= !&!#Q+!*/1& & & & & & & &t!\u0097%E$&%'V(  z #&D${:Aj2\u0099\u00a6q\u00a9E\u00a4UZ#\u008d$2)%-8*0#_J+#b#M#(S1   # /0O2[R'$! !6>)/A?+8<!*$ .)$ D3  (-/$!$[ !$%#$#! !4 #1+ 6'#'#'1& & 7 .)c0\u00a86/'I\u00a7\u0093#\\N&6$&! . , $ ! % % \u007fM\u0092;R#Gh)d$ \u0085=4(4,a$'#'#'# \ud800!) 4 : % 9#6@\u0082\u0094?$IIX*5 ((=)<#@'(\ud801!f~N.Of\u008f1-)(\ud802!'#! E %$!#/)/10^: %)-)4nQ(%T!5#   AZ?$?C( >?G)-):9*\ud803!`KJ9J\ud804#PriL3>@7M$!6F2#/! !C* 3V& ! # 9 .+8N(#%#- & % $$!;!6$\ud805eF-% !\u008987#=F-!k7x4\ud806\u0087RB!\u0095K\ud808!\u00a2\ud809e\u008a\ud80d!8\ud811!\u009c\ud81a!\u009b+0c<;F*#BH&:\ud81b\u00a0U,!l,\ud82c!%\ud82f!\"&,$++.\ud835!w m %#!#%## ) ! & S ##( & > # $ !$& \u0091#3 3 0 3 0 3 0 3 0 3 (\ud83a!\u008b\ud83b\u0098# A % !#! . # ! !(!'! ! !   % !#! ! ! ! ! % !## & # # ! . 5&  $ 5\ud869!\u009f7\u008c\ud86d!\u00a1,g\ud86e!<#\u00a3\ud873!\u009e\ud87e!\u009a",
"\ud80c\ud840-\ud868\ud86a-\ud86c\ud86f-\ud872"),ne=("#(?: [1-9])?|(?:'|"+Tc+")(?: (?:[0-9']|"+Tc+"))*").replace(/ /g,"[ \t]*"),Xe=["([ \t\n\r]+)|(//.*)|(/\\*)","("+("(?:[0-9](?: [0-9])*(?: \\.(?! \\.)(?:(?! "+ne+")|(?= (?: [Ee](?: [+-])?(?: [0-9])+)))(?: [0-9])*)?|\\.(?: [0-9])+)(?: [Ee](?: [+-])?(?: [0-9])+)?").replace(/ /g,"[ \t]*")+")","("+Va.map(ae).join("|")+")","("+"[](){}||".split("").map(ae).join("|")+")","("+hd+")","("+Fc+")","("+ne+")",'("[^"]*")|($)'].join("|"),of=new RegExp("[ \t]*".replace(/\*$/,
"+"),"g"),wd="ANY WS COMMENT START_COMMENT NUM OP BRA SUB SUP ID STR EOF".split(" ");(function(){const a=(new RegExp(Xe,"g")).exec("");if(a.hasOwnProperty(wd.length))throw Error("RE has more groups than expected");if(!a.hasOwnProperty(wd.length-1))throw Error("RE has fewer groups than expected");})();Jc.prototype.advanceBy=function(a){this.advanceTo(this.pos+a)};Jc.prototype.advanceTo=function(a){for(this.pos=a;this.bols[0]<=a;)this.bol=this.bols.shift(),this.line++};Jc.prototype.curPos=function(){return{row:this.line,
col:this.pos-this.bol,pos:this.pos}};Jc.prototype.nextInternal=function(){const a=this.re.exec(this.input);if(a.index!==this.pos)throw xb("Invalid token",this.curPos(),this.input.substring(this.pos,a.index));const b=this.curPos();this.advanceBy(a[0].length);const c=this.curPos();let d;for(d=1;null==a[d];++d);return{start:b,end:c,raw:a[0],text:a[0].replace(of,""),toktype:wd[d]}};Jc.prototype.next=function(){let a;do if(a=this.nextInternal(),"START_COMMENT"===a.toktype){const b=/\*\/|\/\*/g;b.lastIndex=
a.start.pos+2;let c=1,d;for(;0<c;)if(d=b.exec(this.input))"/*"===d[0]?++c:--c;else throw xb("Unterminated comment",a.start,a.text);this.re.lastIndex=b.lastIndex;this.advanceTo(b.lastIndex);a.end=this.curPos();a.raw=this.input.substring(a.start.pos,a.end.pos);a.text=a.raw;a.toktype="COMMENT"}while("WS"===a.toktype||"COMMENT"===a.toktype);return a};const pf={ctype:"void"};Cc.prototype.postprocess=function(a){if(null===a)return pf;if(a){if("infix"===a.ctype)if(":="===a.oper){const b=a.args[0];"function"===
b.ctype&&b.args.forEach(function(c){if(null===c||"variable"!==c.ctype)throw xb("Function argument must be an identifier",c.start||a.start);})}else if(","===a.oper)throw xb("comma may only be used to delimit list elements",a.start);a.args&&(a.args=a.args.map(this.postprocess,this));if(a.modifs)for(const b in a.modifs)a.modifs[b]=this.postprocess(a.modifs[b]);if("paren"===a.ctype)return a.args[0];if("infix"===a.ctype){if("."===a.oper){if(!a.args[1]||"variable"!==a.args[1].ctype)throw xb("Field name must be identifier",
a.start,a.text);a.ctype="field";a.obj=a.args[0];a.key=a.args[1].name;delete a.args}if(":"===a.oper){if(a.jsonatom){if(!a.args[1])throw xb("JSON: Value undefined",a.start,a.text);a.ctype="jsonatom";a.key=a.args[0];a.value=a.args[1];delete a.jsonatom}else{if(!a.args[1])throw xb("UserData: Key undefined",a.start,a.text);a.ctype="userdata";a.obj=a.args[0];a.key=a.args[1]}delete a.args}this.infixmap&&(a.impl=this.infixmap[a.oper])}else"variable"===a.ctype?this.usedVariables[a.name]=!0:"function"===a.ctype&&
(this.usedFunctions[a.oper]=!0)}if("infix"===a.ctype)return{ctype:"infix",oper:String(a.oper),args:[a.args[0],a.args[1]],impl:a.impl};if("variable"===a.ctype)return{ctype:"variable",name:String(a.name)};if("number"===a.ctype)return{ctype:"number",value:{real:+a.value.real,imag:+a.value.imag}};if("string"===a.ctype)return{ctype:"string",value:String(a.value)};if("list"===a.ctype)return{ctype:"list",value:a.value};if("function"===a.ctype)return{ctype:"function",oper:String(a.oper),args:a.args,modifs:a.modifs};
if("field"===a.ctype)return{ctype:"field",obj:a.obj,key:String(a.key)};if("userdata"===a.ctype)return{ctype:"userdata",obj:a.obj,key:a.key};if("jsonatom"===a.ctype)return{ctype:"jsonatom",key:a.key,value:a.value};throw Error("Unsupported AST node of type "+a.ctype);};Cc.prototype.parse=function(a){try{const b=ze(new Jc(a));if("EOF"!==b.closedBy.toktype)throw xb("Closing bracket never opened.",b.closedBy.start,b.closedBy.text);return this.postprocess(b.expr)}catch(b){return b.ctype="error",b}};"undefined"!==
typeof process&&"undefined"!==typeof module&&"undefined"!==typeof module.exports&&"undefined"===typeof window&&(module.exports.Parser=Cc,module.exports.Tokenizer=Jc,module.exports.unicodeLetters=Tc,module.exports.parse=function(a){return(new Cc).parse(a)});const kd={};var ue=[];const ma={lines:{},audioCtx:null,getAudioContext:function(){if(this.audioCtx)return this.audioCtx;window.AudioContext||window.webkitAudioContext?this.audioCtx=new (window.AudioContext||window.webkitAudioContext):console.warn("Web Audio API not supported in this browser");
return this.audioCtx},handleModif:function(a,b,c){if(void 0!==a){if(a=L(a),a.ctype===b){if("number"===a.ctype)return a.value.real;if("list"===a.ctype){b=a.value;a=[];for(c=0;c<b.length;c++)a[c]=b[c].value.real;return a}return a.value}}else return c},handleLineModif:function(a,b){return void 0!==a?(a=L(a),ja(a)):b},getBufferNode:function(a,b){var c=this.getAudioContext();if(b*c.sampleRate>a.length){let d=[];for(let f=0,k=0;f<c.sampleRate*b;f++,k++)k>a.length&&(k=0),d[f]=a[k];a=d}b=new Float32Array(a);
a=c.createBuffer(1,b.length,c.sampleRate);a.copyToChannel(b,0);c=c.createBufferSource();c.buffer=a;return c},createMonoOscillator:function(a,b){let c=this.getAudioContext().createOscillator();if(0!==b){let d=new Float32Array(2),f=new Float32Array(2);d[1]=Math.sin(b);f[1]=Math.cos(b);b=this.getAudioContext().createPeriodicWave(d,f,{disableNormalization:!0});c.setPeriodicWave(b)}else c.type="sine";c.mono=!0;c.frequency.setValueAtTime(a,this.audioCtx.currentTime);return c},createWaveOscillator:function(a,
b,c){let d=this.getAudioContext().createOscillator(),f=new Float32Array(b.length+1),k=new Float32Array(b.length+1);for(let m=0;m<b.length;m++)k[m+1]=b[m]*Math.cos(c[m]),f[m+1]=b[m]*Math.sin(c[m]);b=this.getAudioContext().createPeriodicWave(f,k,{disableNormalization:!0});d.setPeriodicWave(b);d.frequency.setValueAtTime(a,this.audioCtx.currentTime);return d},cleanup:function(){for(let a in this.lines)if("sin"===this.lines[a].lineType)if(this.lines[a].oscNodes.every(b=>!b.oscNode.isplaying))delete this.lines[a];
else for(let b=0;b<this.lines[a].oscNodes.length;b++)this.lines[a].oscNodes[b]&&!this.lines[a].oscNodes[b].oscNode.isplaying&&delete this.lines[a].oscNodes[b]},registerInput:function(a){a.cnt?a.cnt++:a.cnt=1},deregisterInput:function(a){a.cnt&&a.cnt--},hasRegisteredInput:function(a){return a.cnt&&0!==a.cnt},playOscillator:function(a,b,c,d,f,k){let m=this.getAudioContext(),q=m.createGain();q.gain.setValueAtTime(0,m.currentTime);a.connect(q);q.connect(b);ma.registerInput(b);a.start(0);a.isplaying=!0;
a.onended=function(){this.isplaying=!1;q.disconnect();ma.deregisterInput(b);ma.hasRegisteredInput(b)||(b.disconnect(),b.panNode&&b.panNode.disconnect());ma.cleanup()};q.gain.linearRampToValueAtTime(c,m.currentTime+d);0<=f&&(q.gain.setValueAtTime(c,m.currentTime+d+f),q.gain.linearRampToValueAtTime(0,m.currentTime+d+f+k),this.triggerStop(a,f+d+k));return{oscNode:a,gainNode:q}},softStop:function(a,b){let c=this.getAudioContext();a.gainNode.gain.cancelScheduledValues(c.currentTime);a.gainNode.gain.setValueAtTime(a.gainNode.gain.value,
c.currentTime);a.gainNode.gain.linearRampToValueAtTime(0,c.currentTime+b);this.triggerStop(a.oscNode,b)},extendDuration:function(a,b,c){let d=this.getAudioContext();a.gainNode.gain.cancelScheduledValues(d.currentTime);a.gainNode.gain.setValueAtTime(a.gainNode.gain.value,d.currentTime);a.gainNode.gain.setValueAtTime(a.gainNode.gain.value,d.currentTime+b);a.gainNode.gain.linearRampToValueAtTime(0,d.currentTime+b+c);this.triggerStop(a.oscNode,b+c)},triggerStop:function(a,b){a.timeoutId&&clearTimeout(a.timeoutId);
a.timeoutId=setTimeout(function(){a.stop(0)},1E3*b+10)}};class Hf{constructor(a){this.audioCtx=a;this.lineType="sin";this.oscNodes=[]}handleModif(a,b,c,d){if("phaseshift"===b)d=this.handlePhaseshiftModif(a.phaseshift,this.harmonics.length);else if(void 0!==a[b]&&(a=L(a[b]),a.ctype===c))if("number"===a.ctype)d=a.value.real;else if("list"===a.ctype){c=a.value;a=[];for(d=0;d<c.length;d++)a[d]=c[d].value.real;d=a}else d=a.value;return this[b]=d}handlePhaseshiftModif(a,b){this.phaseshift=Array(b).fill(0);
if(void 0!==a)if(a=L(a),"list"===a.ctype)for(b=a.value,a=0;a<b.length;a++)this.phaseshift[a]=b[a].value.real;else if("number"===a.ctype)for(let c=0;c<b;c++)this.phaseshift[c]=(c+1)*a.value.real;return this.phaseshift}cleanparameters(a){this.partials.length<this.harmonics.length&&(this.partials=Array(this.harmonics.length).fill(1),a.partials&&console.warn("Ignore partials because the given length does not match with the length of harmonics"));this.phaseshift.length<this.harmonics.length&&(this.phaseshift=
Array(this.harmonics.length).fill(0),a.phaseshift&&console.warn("Ignore phaseshift because the given length does not match with the length of harmonics"));this.precompute&=this.partials.every(b=>1E-8>Math.abs(b-1));0<this.damp&&(this.duration=Math.min(this.duration,6/this.damp))}panit(){0===this.pan||this.masterGain.panNode||(this.masterGain.disconnect(this.audioCtx.destination),this.masterGain.panNode=this.audioCtx.createStereoPanner(),this.masterGain.connect(this.masterGain.panNode),this.masterGain.panNode.connect(this.audioCtx.destination));
this.masterGain.panNode&&this.masterGain.panNode.pan.setValueAtTime(this.pan,this.audioCtx.currentTime)}dampit(){this.masterGain.gain.cancelScheduledValues(this.audioCtx.currentTime);this.masterGain.gain.setValueAtTime(this.masterGain.gain.value,this.audioCtx.currentTime);0<this.damp?this.masterGain.gain.setTargetAtTime(0,this.audioCtx.currentTime+this.attack,1/this.damp):0>this.damp&&this.masterGain.gain.setTargetAtTime(1,this.audioCtx.currentTime+this.attack,-this.damp)}startOscillators(){if(this.precompute)this.oscNodes[0]=
ma.playOscillator(ma.createWaveOscillator(this.freq,this.harmonics,this.phaseshift),this.masterGain,1,this.attack,this.duration,this.release);else for(let a=0;a<this.harmonics.length;a++)this.oscNodes[a]=ma.playOscillator(ma.createMonoOscillator(this.partials[a]*(a+1)*this.freq,this.phaseshift[a]),this.masterGain,this.harmonics[a],this.attack,this.duration,this.release)}stopOscillators(){for(let a in this.oscNodes)ma.softStop(this.oscNodes[a],this.release),delete this.oscNodes[a]}stop(){this.stopOscillators()}updateFrequencyAndGain(){if(this.precompute)this.harmonicsdidnotchange()&&
this.oscNodes[0]&&this.oscNodes[0].oscNode.isplaying&&!this.oscNodes[0].oscNode.mono?(this.oscNodes[0].oscNode.frequency.setValueAtTime(this.freq,this.audioCtx.currentTime),ma.extendDuration(this.oscNodes[0],this.duration,this.release)):(this.stopOscillators(),this.startOscillators());else{for(let a=0;a<this.harmonics.length;a++)0<this.harmonics[a]&&(this.oscNodes[a]&&this.oscNodes[a].oscNode.isplaying&&this.oscNodes[a].oscNode.mono?(this.oscNodes[a].oscNode.frequency.setValueAtTime(this.partials[a]*
(a+1)*this.freq,this.audioCtx.currentTime),this.oscNodes[a].gainNode.gain.setValueAtTime(this.harmonics[a],this.audioCtx.currentTime),ma.extendDuration(this.oscNodes[a],this.duration,this.release)):(this.oscNodes[a]&&this.oscNodes[a].oscNode.isplaying&&!this.oscNodes[a].oscNode.mono&&ma.softStop(this.oscNodes[a],this.release),this.oscNodes[a]=ma.playOscillator(ma.createMonoOscillator(this.partials[a]*(a+1)*this.freq,this.phaseshift[a]),this.masterGain,this.harmonics[a],this.attack,this.duration,this.release)));
for(let a in this.oscNodes)this.harmonics[a]||(ma.softStop(this.oscNodes[a],this.release),delete this.oscNodes[a])}}generateNewMasterGain(a){this.masterGain=this.audioCtx.createGain();this.masterGain.connect(this.audioCtx.destination);this.masterGain.gain.setValueAtTime(a,this.audioCtx.currentTime)}harmonicsdidnotchange(){let a;if(this.lastharmonics){a=1&this.lastharmonics.length===this.harmonics.length;for(let b in this.harmonics)a&&(a&=this.harmonics[b]===this.lastharmonics[b])}else a=!1;return a}evokeplaysin(a,
b,c){this.cleanparameters(c);if(0===this.duration)return this.stop(),A;a||b&&0!==this.damp?(b&&!a&&this.stopOscillators(),this.generateNewMasterGain(this.amp),this.startOscillators()):(this.masterGain||this.generateNewMasterGain(this.amp),this.updateFrequencyAndGain());this.panit();this.dampit();this.lastharmonics=this.harmonics}}z.stopsound$0=function(){if(ma.audioCtx){for(let a in ma.lines)ma.lines[a].stop(),delete ma.lines[a];ma.audioCtx.close();ma.audioCtx=null}};z.playsin$1=function(a,b){var c=
ma.getAudioContext();let d=ma.handleLineModif(b.line,"0"),f=!1;ma.lines[d]&&"sin"===ma.lines[d].lineType||(ma.lines[d]&&ma.lines[d].stop(),ma.lines[d]=new Hf(c),f=!0);c=ma.lines[d];c.freq=L(a[0]).value.real;c.handleModif(b,"amp","number",.5);c.handleModif(b,"damp","number",0);c.handleModif(b,"duration","number",ma.handleModif(b.stop,"number",1));c.handleModif(b,"harmonics","list",[1]);c.handleModif(b,"partials","list",[1]);c.handleModif(b,"attack","number",.01);c.handleModif(b,"release","number",
.01);c.handleModif(b,"pan","number",0);c.handleModif(b,"precompute","boolean",!1);c.handleModif(b,"phaseshift","phaseshift",Array(c.harmonics.length).fill(0));a=ma.handleModif(b.restart,"boolean",!0);c.evokeplaysin(f,a,b);return A};z.playsin$0=function(a,b){if(void 0!==b.line&&(a=ma.handleLineModif(b.line,"0"),a=ma.lines[a])){a.handleModif(b,"freq","number",a.freq);a.handleModif(b,"amp","number",a.amp);a.handleModif(b,"damp","number",a.damp);a.handleModif(b,"duration","number",ma.handleModif(b.stop,
"number",a.duration));a.handleModif(b,"harmonics","list",a.harmonics);a.handleModif(b,"partials","list",a.partials);a.handleModif(b,"attack","number",a.attack);a.handleModif(b,"release","number",a.release);a.handleModif(b,"pan","number",a.pan);a.handleModif(b,"precompute","boolean",a.precompute);a.handleModif(b,"phaseshift","phaseshift",a.phaseshift);let c=ma.handleModif(b.restart,"boolean",!1);a.evokeplaysin(!1,c,b)}return A};z.playfunction$1=function(a,b){let c=ma.getAudioContext();var d=a[0];a=
function(H){let R=[];for(R.push(H);0!==R.length;){H=R.pop();if("variable"===H.ctype&&L(H)===A&&["x","y","t"].includes(H.name))return H.name;if(H.args)for(let S in H.args)R.push(H.args[S])}return A}(d);a!==A&&Y.newvar(a);let f=ma.handleLineModif(b.line,"0"),k=ma.handleModif(b.start,"number",0),m=ma.handleModif(b.amp,"number",.5),q=ma.handleModif(b.damp,"number",0);ma.handleModif(b.stop,"number",1);var t=ma.handleModif(b.duration,"number",1);let w=ma.handleModif(b.attack,"number",.01),y=ma.handleModif(b.release,
"number",.01),C=ma.handleModif(b.export,"boolean",!1),F=ma.handleModif(b.silent,"boolean",!1);b=[];for(let H=0;H<c.sampleRate*t;H++){a!==A&&Y.setvar(a,n.real(H/c.sampleRate));let R=L(d);b[H]=R.value.real*m*Math.exp(-q*H/c.sampleRate)}F||(ma.lines[f]&&"function"===ma.lines[f].lineType?(d=ma.lines[f],d.masterGain.gain.linearRampToValueAtTime(0,c.currentTime+y),d.bufferNode.stop(c.currentTime+y),d.bufferNode=ma.getBufferNode(b,t),d.bufferNode.connect(d.masterGain),d.bufferNode.start(k+y),d.masterGain.gain.linearRampToValueAtTime(m,
c.currentTime+y+w)):(ma.lines[f]&&ma.lines[f].stop(),ma.lines[f]={lineType:"function",bufferNode:ma.getBufferNode(b,t),masterGain:c.createGain(),stop:function(){this.bufferNode.stop()}},t=ma.lines[f],t.masterGain.gain.setValueAtTime(0,c.currentTime),t.masterGain.connect(c.destination),t.bufferNode.connect(t.masterGain),t.bufferNode.start(k),t.masterGain.gain.linearRampToValueAtTime(m,c.currentTime+w)));a!==A&&Y.removevar(a);return C?b:A};z.playwave$1=function(a,b){let c=ma.getAudioContext();var d=
L(a[0]),f=ma.handleLineModif(b.line,"0");a=ma.handleModif(b.amp,"number",.5);ma.handleModif(b.damp,"number",0);let k=ma.handleModif(b.duration,"number",1),m=ma.handleModif(b.attack,"number",.01),q=ma.handleModif(b.release,"number",.01);b=ma.handleModif(b.start,"number",0);if("list"!==d.ctype)return A;ma.lines[f]&&"wave"===ma.lines[f].lineType?(f=ma.lines[f],f.masterGain.gain.linearRampToValueAtTime(0,c.currentTime+q),f.bufferNode.stop(c.currentTime+q),f.bufferNode=ma.getBufferNode(p.unwrap(d),k),
f.bufferNode.connect(f.masterGain),f.bufferNode.start(b+q),f.masterGain.gain.linearRampToValueAtTime(a,c.currentTime+q+m)):(ma.lines[f]&&ma.lines[f].stop(),ma.lines[f]={lineType:"wave",bufferNode:ma.getBufferNode(p.unwrap(d),k),masterGain:c.createGain(),stop:function(){this.bufferNode.stop()}},d=ma.lines[f],d.masterGain.gain.setValueAtTime(0,c.currentTime),d.masterGain.connect(c.destination),d.bufferNode.connect(d.masterGain),d.bufferNode.start(0),d.masterGain.gain.linearRampToValueAtTime(a,c.currentTime+
m));return A};const La={printArr:function(a){const b=a.value.length,c=[],d=[];let f=!1;for(let k=0;k<b;k++)c[k]=a.value[k].value.real,d[k]=a.value[k].value.imag,0!==d[k]&&(f=!0);console.log(c);f&&console.log(d)},zero:function(a){const b=[],c=n.real(0);for(let d=0;d<a.value.real;d++)b[d]=c;return h.turnIntoCSList(b)},number:function(a,b){b=La.zero(b);b.value[0]=a;return b},variable:function(a,b){b=La.zero(b);b.value[0]=a;b.value[1]=n.real(1);return b},add:function(a,b){return h.add(a,b)},sub:function(a,
b){return h.sub(a,b)},mult:function(a,b){if(a.value.length!==b.value.length)return console.error("dims don't fit return nada"),A;const c=a.value.length,d=La.zero(n.real(c));let f=n.real(0);for(let k=0;k<c;k++){for(let m=0;m<=k;m++)f=n.add(f,n.mult(a.value[m],b.value[k-m]));d.value[k]=f;f=n.real(0)}return d},pow:function(a,b){if(0>b.value.real||b.value.real!==Math.floor(b.value.real))return La.root(a,b);let c=a;for(let d=1;d<b.value.real;d++)c=La.mult(c,a);return c},root:function(a,b){const c=n.real(0),
d=n.real(1),f=n.add(d,b),k=a.value.length,m=La.zero(n.real(k));m.value[0]=n.pow(a.value[0],b);var q=c;let t,w;for(b=1;b<k;b++){w=n.real(b);for(let y=1;y<=b;y++)t=n.mult(f,n.real(y)),t=n.div(t,w),t=n.sub(t,d),t=n.mult(t,a.value[y]),t=n.mult(t,m.value[b-y]),q=n.add(q,t);q=n.div(q,a.value[0]);m.value[b]=q;q=c}return m},findFirstNoneZero:function(a,b,c){let d=Infinity,f=Infinity;for(let k=c;k<a.value.length;k++)if(1E-12<n.abs2(a.value[k]).value.real){d=k;break}for(a=c;a<b.value.length;a++)if(1E-12<n.abs2(b.value[a]).value.real){f=
a;break}return[d,f]},div:function(a,b){if(a.value.length!==b.value.length)return console.log("dims don't fit - return nada"),A;let c=a.value.length;const d=n.real(0),f=La.zero(n.real(c));let k=d;for(let q=0;q<c;q++){var m=La.findFirstNoneZero(a,b,q);q<m[0]&&m[0]===m[1]&&Infinity!==m[0]&&(a.value.splice(q,m[0]),b.value.splice(q,m[0]),f.value.splice(q,m[0]),c-=m[0]);m=a.value[q];for(let t=0;t<q;t++)k=n.add(k,n.mult(f.value[t],b.value[q-t]));m=n.sub(m,k);m=n.div(m,b.value[0]);f.value[q]=m;k=d}return f},
exp:function(a){const b=n.real(0),c=a.value.length,d=La.zero(n.real(c));let f=b,k;d.value[0]=n.exp(a.value[0]);for(let m=1;m<c;m++){for(let q=1;q<=m;q++)k=n.mult(n.real(q),a.value[q]),k=n.mult(k,d.value[m-q]),f=n.add(f,k);d.value[m]=n.div(f,n.real(m));f=b}return d},log:function(a){const b=n.real(0),c=a.value.length,d=La.zero(n.real(c));d.value[0]=n.log(a.value[0]);let f=b,k,m;for(let q=1;q<c;q++){k=a.value[q];for(let t=1;t<q;t++)m=n.mult(n.real(t),d.value[t]),m=n.mult(m,a.value[q-t]),f=n.add(f,m);
f=n.div(f,n.real(q));k=n.sub(k,f);k=n.div(k,a.value[0]);d.value[q]=k;f=b}return d},sincos:function(a){const b=n.real(0),c=a.value.length,d=La.zero(n.real(c)),f=La.zero(n.real(c));d.value[0]=n.sin(a.value[0]);f.value[0]=n.cos(a.value[0]);let k=b,m=b,q;let t;for(let y=1;y<c;y++){t=n.real(y);for(let C=1;C<=y;C++){var w=n.mult(n.real(C),a.value[C]);q=n.mult(w,f.value[y-C]);w=n.mult(w,d.value[y-C]);m=n.add(m,q);k=n.add(k,w)}m=n.div(m,t);k=n.div(k,n.neg(t));d.value[y]=m;f.value[y]=k;k=m=b}La.sinsave=d;
La.cossave=f;return[d,f]},sin:function(a){return La.sincos(a)[0]},cos:function(a){return La.sincos(a)[1]},faculty:function(a){let b=[];b[0]=n.real(1);let c=1;for(let d=1;d<=a.value.real;d++)c*=d,b[d]=n.real(c);return b=h.turnIntoCSList(b)},diff:function(a,b,c,d){let f;if("variable"===a.ctype)f=a.name!==b?La.number(L(a),d):La.variable(c,d);else if("number"===a.ctype)f=La.number(a,d);else{if("infix"===a.ctype){if("*"===a.oper)return La.mult(La.diff(a.args[0],b,c,d),La.diff(a.args[1],b,c,d));if("^"===
a.oper)return La.pow(La.diff(a.args[0],b,c,d),La.diff(a.args[1],b,c,d).value[0]);if("/"===a.oper)return La.div(La.diff(a.args[0],b,c,d),La.diff(a.args[1],b,c,d));if("+"===a.oper)return La.add(La.diff(a.args[0],b,c,d),La.diff(a.args[1],b,c,d));if("-"===a.oper)return La.sub(La.diff(a.args[0],b,c,d),La.diff(a.args[1],b,c,d));console.log("infix not found",a.oper);return A}if("function"===a.ctype){if("exp$1"===a.oper)return La.exp(La.diff(a.args[0],b,c,d));if("log$1"===a.oper)return La.log(La.diff(a.args[0],
b,c,d));if("sin$1"===a.oper)return La.sin(La.diff(a.args[0],b,c,d));if("cos$1"===a.oper)return La.cos(La.diff(a.args[0],b,c,d))}else return console.log("ctype not found",a.ctype),A}return f},adevaluate:function(a,b,c,d){a=La.diff(a,b,c,d);d=La.faculty(d);for(b=2;b<a.value.length;b++)a.value[b]=n.mult(a.value[b],d.value[b]);return a},autodiff:function(a,b,c,d){let f=[];const k=c.value.length;let m;for(let q=0;q<k;q++)m=La.adevaluate(a,b,c.value[q],d),f[q]=m;return f=h.turnIntoCSList(f)}},N={handleModifs:function(a,
b){N.dashing&&N.unSetDash();N.colorraw=null;N.fillcolorraw=null;N.fillrule="nonzero";N.size=null;0>=N.psize&&(N.psize=0);0>=N.lsize&&(N.lsize=0);N.overhang=1;N.dashing=!1;N.isArrow=!1;N.arrowSides="==>";N.arrowposition=1;N.headlen=10;N.arrowShape=N.arrowShapes.line;N.alpha=O.drawingstate.alpha;N.fillalpha=0;N.bold="";N.italics="";N.family="sans-serif";N.align=0;N.angle=0;N.xOffset=0;N.yOffset=0;N.lineCap="round";N.lineJoin="round";N.miterLimit=10;N.noborder=!1;let c,d;for(c in a){const f=a[c];f&&
((d=b[c])?(!0===d&&(d=N.modifHandlers[c]),d(L(f))):console.log("Modifier not supported: "+c))}null!==N.size?N.psize=N.lsize=N.size:(N.psize=O.drawingstate.pointsize,N.lsize=O.drawingstate.linesize);N.dashing&&N.dashing(N.lsize);null!==N.colorraw?N.pointColor=N.lineColor=N.textColor=N.makeColor(N.colorraw):1===N.alpha?(N.pointColor=O.drawingstate.pointcolor,N.lineColor=O.drawingstate.linecolor,N.textColor=O.drawingstate.textcolor):(N.pointColor=N.makeColor(O.drawingstate.pointcolorraw),N.lineColor=
N.makeColor(O.drawingstate.linecolorraw),N.textColor=N.makeColor(O.drawingstate.textcolorraw));N.black=1===N.alpha?"rgb(0,0,0)":"rgba(0,0,0,"+N.alpha+")";N.fillColor=N.fillcolorraw&&0<N.fillalpha?N.makeColor(N.fillcolorraw,N.fillalpha):null},modifHandlers:{size:function(a){"number"===a.ctype&&(N.size=a.value.real,0>N.size&&(N.size=0),1E3<N.size&&(N.size=1E3))},color:function(a){h.isNumberVector(a).value&&3===a.value.length&&(N.colorraw=[a.value[0].value.real,a.value[1].value.real,a.value[2].value.real])},
fillcolor:function(a){h.isNumberVector(a).value&&3===a.value.length&&(N.fillcolorraw=[a.value[0].value.real,a.value[1].value.real,a.value[2].value.real])},alpha:function(a){"number"===a.ctype&&(N.alpha=a.value.real)},fillalpha:function(a){"number"===a.ctype&&(N.fillalpha=a.value.real)},dashpattern:function(a){if("list"===a.ctype){const b=[];for(let c=0,d=0;c<a.value.length;c++)"number"===a.value[c].ctype&&(b[d++]=a.value[c].value.real);N.dashing=N.setDash.bind(null,b)}},dashtype:function(a){if("number"===
a.ctype)a=Math.floor(a.value.real);else if("string"===a.ctype)a=a.value;else return;if(a=N.dashTypes[a])N.dashing=N.setDash.bind(null,a)},dashing:function(a){"number"===a.ctype&&(a=Math.floor(a.value.real),N.dashing=N.setDash.bind(null,[2*a,a]))},overhang:function(a){"number"===a.ctype&&(N.overhang=N.overhang*a.value.real+(1-N.overhang)*(1-a.value.real))},arrow:function(a){"boolean"===a.ctype?N.isArrow=a.value:console.error("arrow needs to be of type boolean")},arrowshape:function(a){"string"!==a.ctype?
console.error("arrowshape needs to be of type string"):N.arrowShapes.hasOwnProperty(a.value)?(N.arrowShape=N.arrowShapes[a.value],N.isArrow=!0,N.arrowShape.deprecated&&(console.log("arrowshape "+a.value+" is deprecated, use "+N.arrowShape.deprecated+" instead."),N.arrowShape.deprecated=null)):(a=Object.keys(N.arrowShapes),a.sort(),a=a.join(", "),console.error("arrowshape needs to be one of "+a))},arrowsides:function(a){"string"!==a.ctype?console.error("arrowsides is not of type string"):"==>"!==a.value&&
"<==>"!==a.value&&"<=="!==a.value?console.error("arrowsides is unknows"):(N.arrowSides=a.value,N.isArrow=!0)},arrowposition:function(a){"number"!==a.ctype?console.error("arrowposition is not of type number"):0>a.value.real?console.error("arrowposition has to be positive"):1<a.value.real?N.overhang=N.overhang*a.value.real+(1-N.overhang)*(1-a.value.real):(N.arrowposition=a.value.real,N.isArrow=!0)},arrowsize:function(a){"number"!==a.ctype?console.error("arrowsize is not of type number"):0>a.value.real?
console.error("arrowsize has to be positive"):N.headlen*=a.value.real},bold:function(a){"boolean"===a.ctype&&a.value&&(N.bold="bold ")},italics:function(a){"boolean"===a.ctype&&a.value&&(N.italics="italic ")},family:function(a){"string"===a.ctype&&(N.family=a.value)},align:function(a){"string"===a.ctype&&(a=a.value,"left"===a&&(N.align=0),"right"===a&&(N.align=1),"mid"===a||"center"===a)&&(N.align=.5)},angle:function(a){"number"===a.ctype&&(N.angle=a.value.real)},xoffset:function(a){"number"===a.ctype&&
(N.xOffset=a.value.real)},yoffset:function(a){"number"===a.ctype&&(N.yOffset=a.value.real)},offset:function(a){"list"===a.ctype&&2===a.value.length&&"number"===a.value[0].ctype&&"number"===a.value[1].ctype&&(N.xOffset=a.value[0].value.real,N.yOffset=a.value[1].value.real)},lineCap:function(a){"string"!==a.ctype||"round"!==a.value&&"square"!==a.value&&"butt"!==a.value||(N.lineCap=a.value)},lineJoin:function(a){"string"!==a.ctype||"round"!==a.value&&"bevel"!==a.value&&"miter"!==a.value||(N.lineJoin=
a.value)},fillrule:function(a){"string"!==a.ctype||"nonzero"!==a.value&&"evenodd"!==a.value||(N.fillrule=a.value)},miterLimit:function(a){"number"===a.ctype&&0<a.value.real&&(N.miterLimit=Math.round(a.value.real))},noborder:function(a){"boolean"===a.ctype?N.noborder=a.value:console.error("noborder needs to be of type boolean")},border:function(a){"boolean"===a.ctype?N.noborder=!a.value:console.error("border needs to be of type boolean")}},lineModifs:{size:!0,color:!0,alpha:!0,dashpattern:!0,dashtype:!0,
dashing:!0,overhang:!0,arrow:!0,arrowshape:!0,arrowsides:!0,arrowposition:!0,arrowsize:!0,lineCap:!0,lineJoin:!0,miterLimit:!0},pointModifs:{size:!0,color:!0,alpha:!0,noborder:!0,border:!0}};N.pointAndLineModifs=N.lineModifs;N.conicModifs={size:!0,color:!0,alpha:!0,dashing:!0,dashpattern:!0,dashtype:!0,fillcolor:!0,fillrule:!0,fillalpha:!0,lineCap:!0,lineJoin:!0,miterLimit:!0};N.textModifs={size:!0,color:!0,alpha:!0,bold:!0,italics:!0,family:!0,align:!0,angle:!0,xoffset:!0,yoffset:!0,offset:!0};N.makeColor=
function(a,b){void 0===b&&(b=N.alpha);return"rgba("+Math.floor(255*a[0])+","+Math.floor(255*a[1])+","+Math.floor(255*a[2])+","+b+")"};N.preDrawCurve=function(){P.lineWidth=N.lsize;P.lineCap=N.lineCap;P.lineJoin=N.lineJoin;P.mozFillRule=N.fillrule;P.fillrule=N.fillrule;P.miterLimit=N.miterLimit;P.strokeStyle=N.lineColor};N.arrowShapes={default:{close:!1,fill:!1,ratio:1,deprecated:"line"},line:{close:!1,fill:!1,ratio:1},empty:{close:!0,fill:!1,ratio:1},hollow:{close:!0,fill:!1,ratio:1,deprecated:"empty"},
full:{close:!0,fill:!0,ratio:1},jet:{close:!0,fill:!0,ratio:1.5},delta:{close:!0,fill:!0,ratio:1.5,deprecated:"jet"}};N.clipSegment=function(a,b){var c=b.x-a.x;const d=b.y-a.y;var f=N.clipLineCore(-d,c,a.x*b.y-b.x*a.y);if(2!==f.length)return[];let k=f[0];f=f[1];const m=1/(c*c+d*d),q=((k.x-a.x)*c+(k.y-a.y)*d)*m;c=((f.x-a.x)*c+(f.y-a.y)*d)*m;0>q&&(k=a);1<q&&(k=b);0>c&&(f=a);1<c&&(f=b);return k===f?[]:[k,f]};N.drawsegcore=function(a,b){function c(F,H,R,S){const Z=F-S*y+.5*C,U=H-S*C-.5*y,pa=F-S*y-.5*
C;S=H-S*C+.5*y;P.beginPath();N.arrowShape.fill&&(P.lineWidth=N.lsize/2);P.moveTo(Z,U);P.lineTo(F,H);P.lineTo(pa,S);N.arrowShape.close&&(P.fillStyle=N.lineColor,P.lineTo(F-R*y,H-R*C),P.closePath(),N.arrowShape.fill&&P.fill());P.stroke()}var d=O.drawingstate.matrix,f=a.x*d.a-a.y*d.b+d.tx,k=a.x*d.c-a.y*d.d-d.ty,m=b.x*d.a-b.y*d.b+d.tx,q=b.x*d.c-b.y*d.d-d.ty,t=N.overhang,w=1-t;b=t*f+w*m;d=t*k+w*q;a=t*m+w*f;t=t*q+w*k;if(0>b||b>gb||0>d||d>ib||0>a||a>gb||0>t||t>ib){t=N.clipSegment({x:b,y:d},{x:a,y:t});if(2!==
t.length||.01>N.lsize)return;b=t[0].x;d=t[0].y;a=t[1].x;t=t[1].y}N.preDrawCurve();if(!N.isArrow||f===k&&m===q).01>N.lsize||(P.beginPath(),P.moveTo(b,d),P.lineTo(a,t),P.stroke());else{f=m-f;k=q-k;m=N.headlen/Math.sqrt(f*f+k*k);var y=f*m,C=k*m;q=N.arrowposition;w=1-q;f=q*b+w*a;k=q*d+w*t;m=q*a+w*b;q=q*t+w*d;w=N.arrowSides;P.beginPath();N.arrowShape.close?("<==>"===w||"<=="===w?(1>N.arrowposition&&(P.moveTo(b,d),P.lineTo(f,k)),P.moveTo(f+y,k+C)):P.moveTo(b,d),"==>"===w||"<==>"===w?(P.lineTo(m-y,q-C),
1>N.arrowposition&&(P.moveTo(m,q),P.lineTo(a,t))):P.lineTo(a,t)):(P.moveTo(b,d),P.lineTo(a,t));P.stroke();"==>"!==w&&"<==>"!==w||c(m,q,1,N.arrowShape.ratio);"<=="!==w&&"<==>"!==w||c(f,k,-1,-N.arrowShape.ratio)}};N.drawpoint=function(a){const b=O.drawingstate.matrix,c=a.x*b.a-a.y*b.b+b.tx;a=a.x*b.c-a.y*b.d-b.ty;P.lineWidth=.3*N.psize;P.beginPath();P.arc(c,a,N.psize,0,2*Math.PI);P.fillStyle=N.pointColor;P.fill();N.noborder||(P.beginPath(),P.arc(c,a,1.15*N.psize,0,2*Math.PI),P.fillStyle=N.black,P.strokeStyle=
N.black,P.stroke())};N.clipLineCore=function(a,b,c){var d=Math.SQRT1_2*N.lsize;const f=0-d,k=gb+d,m=0-d;d=ib+d;const q=0>f*a+m*b+c,t=0>k*a+m*b+c,w=0>f*a+d*b+c,y=0>k*a+d*b+c,C=[];q!==t&&C.push({x:(-c-b*m)/a,y:m});t!==y&&C.push({x:k,y:(-c-a*k)/b});w!==y&&C.push({x:(-c-b*d)/a,y:d});q!==w&&C.push({x:f,y:(-c-a*f)/b});return C};N.clipLine=function(a){a=h.normalizeMax(h.productVM(a,O.toMat()));return N.clipLineCore(a.value[0].value.real,a.value[1].value.real,a.value[2].value.real)};N.drawline=function(a){h._helper.isAlmostReal(a)&&
(a=N.clipLine(a),2===a.length&&.01<=N.lsize&&(N.preDrawCurve(),P.beginPath(),P.moveTo(a[0].x,a[0].y),P.lineTo(a[1].x,a[1].y),P.stroke()))};N.drawRaySegment=function(a,b){a=K.extractPoint(a);b=K.extractPoint(b);if(a.ok&&b.ok){var c=a.x-b.x,d=a.y-b.y,f=25E3/O.drawingstate.matrix.sdet/Math.sqrt(c*c+d*d);c*=f;d*=f;N.drawsegcore(a,{x:a.x+c,y:a.y+d});N.drawsegcore(b,{x:b.x-c,y:b.y-d})}};N.dashTypes={solid:[],dashed:[10,10],tightdash:[10,4],dotted:[1,3],dashdot:[10,5,1,5],"dashvalue.solid":[],"dashvalue.dashed":[10,
10],"dashvalue.tightdash":[10,4],"dashvalue.dotted":[1,3],"dashvalue.dashdot":[10,5,1,5],0:[],1:[10,10],2:[10,4],3:[1,3],4:[10,5,1,5]};N.setDash=function(a,b){b=Math.sqrt(b);a=a.slice();for(let c=0;c<a.length;c++)a[c]*=b;P.webkitLineDash=a;P.setLineDash(a);P.mozDash=a};N.unSetDash=function(){P.webkitLineDash=[];P.setLineDash([]);P.mozDash=[]};Kc.prototype={set fillStyle(a){const b=this;rd(a,function(c,d,f,k){b._fill="#"+$b(c.toString(16),2)+$b(d.toString(16),2)+$b(f.toString(16),2);b._fillOpacity=
255===k?null:k})},set strokeStyle(a){const b=this;rd(a,function(c,d,f,k){b._stroke="#"+$b(c.toString(16),2)+$b(d.toString(16),2)+$b(f.toString(16),2);b._strokeOpacity=255===k?null:k})},clearRect:function(){},beginPath:function(){this._path=[]},_pathcmd:function(){this._path.push.apply(this._path,arguments)},closePath:function(){this._pathcmd("Z")},moveTo:function(a,b){this._pathcmd("M",a,b)},lineTo:function(a,b){this._pathcmd("L",a,b)},bezierCurveTo:function(a,b,c,d,f,k){this._pathcmd("C",a,b,c,d,
f,k)},quadraticCurveTo:function(a,b,c,d){this._pathcmd("Q",a,b,c,d)},arc:function(a,b,c,d,f,k){const m=c*Math.cos(d)+a,q=c*Math.sin(d)+b,t=c*Math.cos(f)+a,w=c*Math.sin(f)+b;f=k?d-f:f-d;f>=2*Math.PI?this._pathcmd(this._path.length?"L":"M",m,q,"A",c,c,0,0,k?1:0,a-c*Math.cos(d),b-c*Math.sin(d),"A",c,c,0,0,k?1:0,m,q):this._pathcmd(this._path.length?"L":"M",m,q,"A",c,c,0,f>Math.PI?1:0,k?1:0,t,w)},rect:function(a,b,c,d){this._pathcmd("M",a,b,"h",c,"v",d,"h",-c,"z")},_cmd:function(a){1!==this.globalAlpha?
(this._body.push('<g opacity="'+this.globalAlpha+'">'),this._body.push(a),this._body.push("</g>")):this._body.push(a)},_attrs:function(a){let b="";for(const c in a)null!==a[c]&&(b+=" "+c+'="'+a[c]+'"');return b},fill:function(){this._cmd("<path"+this._attrs({d:this._path.join(" "),fill:this._fill,"fill-opacity":this._fillOpacity})+"/>")},stroke:function(){this._cmd("<path"+this._attrs({d:this._path.join(" "),stroke:this._stroke,"stroke-opacity":this._strokeOpacity,"stroke-width":this.lineWidth,"stroke-linecap":this.lineCap,
"stroke-linejoin":this.lineJoin,"stroke-miterlimit":"miter"===this.lineJoin?this.miterLimit:null})+"/>")},clip:function(){++this._clipIndex;this._body.push('<clipPath id="clip'+this._clipIndex+'"><path d="'+this._path.join(" ")+'"/></clipPath>','<g clip-path="url(#clip'+this._clipIndex+')">');this._saveStack[this._saveStack.length-1]+="</g>"},save:function(){this._saveStack.push("")},restore:function(){this._body.push(this._saveStack.pop());0===this._saveStack.length&&this._saveStack.push("")},_transform:function(a){this._body.push('<g transform="'+
a+'">');this._saveStack[this._saveStack.length-1]+="</g>"},translate:function(a,b){this._transform("translate("+a+" "+b+")")},rotate:function(a){this._transform("rotate("+Math.PI/180*a+")")},scale:function(a,b){this._transform("scale("+a+" "+b+")")},transform:function(a,b,c,d,f,k){this._transform("matrix("+[a,b,c,d,f,k].join(" ")+")")},drawImage:function(a,b,c){if(3!==arguments.length)throw Error("SvgWriterContext only supports 3-argument version of drawImage");let d=this._imgcache.indexOf(a);if(-1===
d){d=this._imgcache.length;let f;f=a.cachedDataURL?a.cachedDataURL:Ce(a);this._defs.push('<image id="img'+d+'" x="0" y="0" width="'+a.width+'" height="'+a.height+'" xlink:href="'+f+'"/>');this._imgcache.push(a)}this._cmd('<use x="'+b+'" y="'+c+'" xlink:href="#img'+d+'"/>')},toBlob:function(){for(;1<this._saveStack.length||""!==this._saveStack[0];)this.restore();const a='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="'+
this.width+'px" height="'+this.height+'px">\n'+this._defs.join("\n")+'\n</defs>\n<g stroke="none" fill="none">\n'+this._body.join("\n")+"\n</g>\n</svg>\n";return new Blob([a],{type:"image/svg+xml"})}};Be.prototype={_cmd:function(){this._body.push(Array.prototype.join.call(arguments," "))},_setAlpha:function(a,b,c){const d=Math.round(255*a*this._globalAlpha);b+=d;this._extGState[b]="<< /"+c+" "+d/255+" >>";this._cmd("/"+b,"gs");return a},set globalAlpha(a){this._globalAlpha=a;this._setAlpha(this._strokeAlpha,
"As","CA");this._setAlpha(this._fillAlpha,"Af","ca")},set fillStyle(a){const b=this;rd(a,function(c,d,f,k){b._cmd(c/255,d/255,f/255,"rg");b._setAlpha(b._fillAlpha=k,"Af","ca")})},set strokeStyle(a){const b=this;rd(a,function(c,d,f,k){b._cmd(c/255,d/255,f/255,"RG");b._setAlpha(b._strokeAlpha=k,"As","CA")})},set lineWidth(a){this._cmd(a,"w")},set lineCap(a){this._cmd({butt:0,round:1,square:2}[a],"J")},set lineJoin(a){this._cmd({miter:0,round:1,bevel:2}[a],"j")},set miterLimit(a){this._cmd(a,"M")},clearRect:function(){},
beginPath:function(){this._pathUsed=!1},closePath:function(){this._cmd("h")},moveTo:function(a,b){this._cmd(this._xPos=a,this._yPos=-b,"m")},lineTo:function(a,b){this._cmd(this._xPos=a,this._yPos=-b,"l")},bezierCurveTo:function(a,b,c,d,f,k){this._cmd(a,-b,c,-d,this._xPos=f,this._yPos=-k,"c")},quadraticCurveTo:function(a,b,c,d){this.bezierCurveTo((2*a+this._xPos)/3,(2*b-this._yPos)/3,(c+2*a)/3,(d+2*b)/3,c,d)},_kappa:.5522847498307935,arc:function(a,b,c,d,f,k){if(0===d&&f===2*Math.PI)d=this._kappa*
c,this.moveTo(a+c,b),this.bezierCurveTo(a+c,b+d,a+d,b+c,a,b+c),this.bezierCurveTo(a-d,b+c,a-c,b+d,a-c,b),this.bezierCurveTo(a-c,b-d,a-d,b-c,a,b-c),this.bezierCurveTo(a+d,b-c,a+c,b-d,a+c,b);else throw Error("PdfWriterContext.arc only supports full circles");},rect:function(a,b,c,d){this._cmd(a,-b,c,-d,"re")},_usePath:function(a){if(this._pathUsed){const b=this._body[this._pathUsed],c={"S + f":"B","f + S":"B","W n + S":"W S","W n + f":"W f","S + W n":"W S","f + W n":"W f","B + W n":"W B","W S + f":"W B",
"W f + S":"W B"}[b+" + "+a];if(!c)throw Error("Don't know how to combine '"+b+"' and '"+a+"'");this._body.splice(this._pathUsed,1);a=c}this._pathUsed=this._body.length;this._cmd(a)},fill:function(){this._usePath("f")},stroke:function(){this._usePath("S")},clip:function(){this._usePath("W n")},save:function(){this._cmd("q")},restore:function(){this._cmd("Q")},translate:function(a,b){this.transform(1,0,0,1,a,b)},rotate:function(a){const b=Math.cos(a);a=Math.sin(a);this.transform(b,a,-a,b,0,0)},scale:function(a,
b){this.transform(a,0,0,b,0,0)},transform:function(a,b,c,d,f,k){this._cmd(a,-b,-c,d,f,-k,"cm")},_png:function(a){if("data:image/png;base64,"!==a.substr(0,22))return{error:"Not a base64-encoded PNG file"};a=cf(a.substr(22));var b=De(a);console.log("PNG chunks:",b.map(function(C){return C.type}));if("IHDR"!==b[0].type)throw Error("Image does not start with an IHDR");var c=b[0].data;a=(c[0]<<24|c[1]<<16|c[2]<<8|c[3])>>>0;const d=(c[4]<<24|c[5]<<16|c[6]<<8|c[7])>>>0,f=c[8];var k=c[9];const m=0===(k&2);
var q=0!==(k&4),t=c[10],w=c[11];c=c[12];if(0!==t)throw Error("Unsupported PNG compression method: "+t);if(0!==w)throw Error("Unsupported PNG filter method: "+w);if(0!==c)return{error:"Interlaced image not supported"};if(0!==(k&1))return{error:"Indexed PNG image not supported"};w=null;k=m?1:3;t=b.filter(function(C){return"IDAT"===C.type}).map(function(C){return C.data});if(q){q=window.pako;w=new q.Inflate;for(b=0;b<t.length;++b)w.push(t[b],b+1===t.length);if(w.err)throw Error(w.err);w=w.result;c=f>>>
3;if(w.length!==d*(a*(k+1)*c+1))throw Error("Data length mismatch");const C=k*c;t=new Uint8Array(d*(a*C+1));let F=new Uint8Array(d*(a*c+1)),H=0,R=0,S=0;for(let Z=0;Z<d;++Z){t[R++]=F[S++]=w[H++];for(let U=0;U<a;++U){for(b=0;b<C;++b)t[R++]=w[H++];for(b=0;b<c;++b)F[S++]=w[H++]}}if(H!==w.length||R!==t.length||S!==F.length)throw Error("Seems we garbled our index computation somehow");F=q.deflate(F);w=this._strm({Type:"/XObject",Subtype:"/Image",Width:a,Height:d,ColorSpace:"/DeviceGray",BitsPerComponent:f,
Filter:"/FlateDecode",DecodeParms:this._dict({Predictor:15,Colors:1,BitsPerComponent:f,Columns:a})},F).ref;t=[q.deflate(t)]}let y=0;t.forEach(function(C){y+=C.length});return this._obj([this._dict({Type:"/XObject",Subtype:"/Image",Name:"/img"+this._imgcache.length,Width:a,Height:d,ColorSpace:m?"/DeviceGray":"/DeviceRGB",SMask:w,BitsPerComponent:f,Length:y,Filter:"/FlateDecode",DecodeParms:this._dict({Predictor:15,Colors:k,BitsPerComponent:f,Columns:a})}),"\nstream\n"].concat(t,["\nendstream"]))},
drawImage:function(a,b,c){if(3!==arguments.length)throw Error("PdfWriterContext only supports 3-argument version of drawImage");let d=this._imgcache.indexOf(a);if(-1===d){d=this._imgcache.length;this._imgcache.push(a);let f=this._png(a.cachedDataURL||"");f.hasOwnProperty("error")&&(f=this._png(Ce(a)));if(f.hasOwnProperty("error"))throw Error(f.error);this._xobjects["img"+d]=f.ref}this._cmd("q");this._setAlpha(1,"Af","ca");this._cmd(a.width,0,0,a.height,b,-c-a.height,"cm");this._cmd("/img"+d,"Do");
this._cmd("Q")},_dict:function(a){let b="<<";for(const c in a)b+=" /"+c+" "+a[c];return b+" >>"},_obj:function(a,b){b||(b=this._nextIndex++);Array.isArray(a)||(a=[this._dict(a)]);a.index=b;a.ref=b+" 0 R";a.offset=this._offset;let c=0;a.unshift(b+" 0 obj\n");a.push("\nendobj\n");for(b=0;b<a.length;++b)c+=a[b].length;this._offset+=c;this._objects.push(a);return a},_strm:function(a,b,c){a.Length=b.length;return this._obj([this._dict(a),"\nstream\n",b,"\nendstream"],c)},toBlob:function(){var a="["+[0,
-this.height,this.width,0].join(" ")+"]";this._obj({Type:"/Catalog",Pages:"2 0 R"},1);this._obj({Type:"/Pages",Kids:"[3 0 R]",Count:1},2);this._obj({Type:"/Page",Parent:"2 0 R",MediaBox:a,Contents:"4 0 R",Resources:this._dict({ProcSet:"[/PDF /Text /ImageB /ImageC /ImageI]",XObject:this._dict(this._xobjects),ExtGState:this._dict(this._extGState)})},3);var b=this._body.join("\n"),c=new Uint8Array(b.length);for(a=0;a<b.length;++a)c[a]=b.charCodeAt(a)&255;b=window.pako.deflate(c);this._strm({Filter:"/FlateDecode"},
b,4);b=this._objects;const d=[];for(a=1;a<b.length;++a)d[b[a].index]=b[a];c="xref\n0 "+d.length+"\n";for(a=0;a<d.length;++a)c=d[a]?c+($b(String(d[a].offset),10)+" 00000 n \n"):c+"0000000000 65535 f \n";a="trailer\n"+this._dict({Size:d.length,Root:"1 0 R"})+"\nstartxref\n"+this._offset+"\n%%EOF\n";b=Array.prototype.concat.apply([],b);b.push(c,a);return new Blob(b,{type:"application/pdf"})}};let ve=null;Gc.push(Ed);Mb.exportSVG=function(){sd(Kc)};Mb.exportPDF=function(){Ob.loadScript("pako","pako.min.js",
function(){sd(Be)})};Mb.exportPNG=function(){zf(P.canvas.toDataURL())};var zf=function(a){const b=document.createElement("a");document.body.appendChild(b);b.style="display: none";b.href=a;b.download="CindyJSExport";b.click();setTimeout(function(){document.body.removeChild(b);Ed()},100)};let tf="Move",we,cc=[],Mc=0,Ff=0,Wd=0;var ba={Delete:{}};ba.Delete.actions=[];ba.Delete.actions[0]={};ba.Delete.actions[0].event="mousedown";ba.Delete.actions[0].tooltip="...";ba.Delete.actions[0].do=function(){qb=
pc(ab);null!==qb&&Gd(qb.mover.name);return!0};ba.Move={};ba.Move.actions=[];ba.Move.actions[0]={};ba.Move.actions[0].event="mousedown";ba.Move.actions[0].tooltip="Move free elements by dragging the mouse";ba.Move.actions[0].do=function(){{var a=ab;let k=null,m=1E6,q;for(const t of E.free){if(t.pinned||!1===t.visible||!0===t.tmp)continue;var b=void 0,c=void 0,d=void 0;const w=O.drawingstate.matrix.sdet;if("P"===t.kind){c=h.normalizeZ(t.homog);if(!h._helper.isAlmostReal(c))continue;b=c.value[0].value.real-
a.x;c=c.value[1].value.real-a.y;d=Math.sqrt(b*b+c*c);if(t.narrow&&d>("number"===typeof t.narrow?t.narrow:20)/w)continue}else if("C"===t.kind){c=h.normalizeZ(E.csnames[t.args[0]].homog);b=t.radius;if(!h._helper.isAlmostReal(c)||!n._helper.isAlmostReal(b))continue;d=c.value[0].value.real;var f=c.value[1].value.real;c=a.x-d;const y=a.y-f,C=Math.sqrt(c*c+y*y);if(0===C)continue;f+=y/C*b.value.real;b=d+c/C*b.value.real-a.x;c=f-a.y;d=Math.sqrt(b*b+c*c);d+=30/w;if(t.narrow&&d>(("number"===typeof t.narrow?
t.narrow:20)+30)/w)continue}else if("L"===t.kind)b=t.homog,d=n,c=d.add(d.mult(b.value[0],d.conjugate(b.value[0])),d.mult(b.value[1],d.conjugate(b.value[1]))),c=h.scaldiv(d.sqrt(c),b),d=c.value[0].value.real*a.x+c.value[1].value.real*a.y+c.value[2].value.real,b=-c.value[0].value.real*d,c=-c.value[1].value.real*d,0>d&&(d=-d),d+=25/w;else if("Text"===t.kind){if(!t.homog||t.dock||!t._bbox)continue;c=O.from(a.x,a.y,1);b=Math.max(0,c[0]-t._bbox.right,t._bbox.left-c[0]);c=Math.max(0,c[1]-t._bbox.bottom,
t._bbox.top-c[1]);d=Math.sqrt(b*b+c*c);if(20<d)continue;d/=w;c=h.normalizeZ(t.homog);if(!h._helper.isAlmostReal(c))continue;b=c.value[0].value.real-a.x;c=c.value[1].value.real-a.y}else continue;d<m+.2/w&&(m=d,k=t,q={x:b,y:c})}console.log("Moving "+(k?k.name:"nothing"));a=null===k?null:{mover:k,offset:q,prev:{x:a.x,y:a.y}}}qb=a;return!0};ba.Point={};ba.Point.actions=[];ba.Point.actions[0]={};ba.Point.actions[0].event="mousedown";ba.Point.actions[0].tooltip="Add a single point with the mouse";ba.Point.actions[0].do=
function(){Ub({type:"Free",name:fc(),labeled:!0,pos:[tb[0],tb[1],1]});return!0};ba.Mid={};ba.Mid.actions=[];ba.Mid.actions[0]={};ba.Mid.actions[0].event="mousedown";ba.Mid.actions[0].tooltip="Construct two points and their midpoint by dragging";ba.Mid.actions[0].do=function(){ac();return!0};ba.Mid.actions[1]={};ba.Mid.actions[1].event="mousemove";ba.Mid.actions[1].do=function(){Fd("Mid");return!0};ba.Mid.actions[2]={};ba.Mid.actions[2].event="mouseup";ba.Mid.actions[2].do=function(){$c();return!0};
ba.Circle={};ba.Circle.actions=[];ba.Circle.actions[0]={};ba.Circle.actions[0].event="mousedown";ba.Circle.actions[0].tooltip="Construct two points and a circle by dragging the mouse";ba.Circle.actions[0].do=function(){ac();return!0};ba.Circle.actions[1]={};ba.Circle.actions[1].event="mousemove";ba.Circle.actions[1].do=function(){Fd("CircleMP");return!0};ba.Circle.actions[2]={};ba.Circle.actions[2].event="mouseup";ba.Circle.actions[2].do=function(){$c();return!0};ba.Compass={};ba.Compass.actions=
[];ba.Compass.actions[0]={};ba.Compass.actions[0].event="mousedown";ba.Compass.actions[0].tooltip="...";ba.Compass.actions[0].do=function(){ac();return!0};ba.Compass.actions[1]={};ba.Compass.actions[1].event="mousedown";ba.Compass.actions[1].tooltip="...";ba.Compass.actions[1].do=function(){ac();return!0};ba.Compass.actions[2]={};ba.Compass.actions[2].event="mousedown";ba.Compass.actions[2].tooltip="...";ba.Compass.actions[2].do=function(){ac();Ub({type:"Compass",name:fc(),labeled:!0,args:[cc[0].name,
cc[1].name,cc[2].name]});return!0};ba.Line={};ba.Line.actions=[];ba.Line.actions[0]={};ba.Line.actions[0].event="mousedown";ba.Line.actions[0].tooltip="Construct two points and their connecting line by dragging the mouse";ba.Line.actions[0].do=function(){ac();return!0};ba.Line.actions[1]={};ba.Line.actions[1].event="mousemove";ba.Line.actions[1].do=function(){Fd("Join");return!0};ba.Line.actions[2]={};ba.Line.actions[2].event="mouseup";ba.Line.actions[2].do=function(){$c();return!0};ba.Segment={};
ba.Segment.actions=[];ba.Segment.actions[0]={};ba.Segment.actions[0].event="mousedown";ba.Segment.actions[0].tooltip="Draw a segment by dragging the mouse";ba.Segment.actions[0].do=function(){ac();return!0};ba.Segment.actions[1]={};ba.Segment.actions[1].event="mousemove";ba.Segment.actions[1].do=function(){Fd("Segment");return!0};ba.Segment.actions[2]={};ba.Segment.actions[2].event="mouseup";ba.Segment.actions[2].do=function(){$c();return!0};ba.Parallel={};ba.Parallel.actions=[];ba.Parallel.actions[0]=
{};ba.Parallel.actions[0].event="mousedown";ba.Parallel.actions[0].tooltip="Construct a parallel line by dragging a line";ba.Parallel.actions[0].do=function(){return Ge()};ba.Parallel.actions[1]={};ba.Parallel.actions[1].event="mousemove";ba.Parallel.actions[1].do=function(){let a={type:"Free",name:fc(),labeled:!0,pos:[tb[0],tb[1],1],tmp:!0};a=Ub(a);we=Ub({type:"Para",name:fc(),labeled:!0,args:[cc[0].name,a.name]});ee(a);return!0};ba.Parallel.actions[2]={};ba.Parallel.actions[2].event="mouseup";ba.Parallel.actions[2].do=
function(){$c();return!0};ba.Orthogonal={};ba.Orthogonal.actions=[];ba.Orthogonal.actions[0]={};ba.Orthogonal.actions[0].event="mousedown";ba.Orthogonal.actions[0].tooltip="Construct a orthogonal line by dragging a line";ba.Orthogonal.actions[0].do=function(){if(Ge()){let a={type:"Free",name:fc(),labeled:!0,pos:[tb[0],tb[1],1],tmp:!0};a=Ub(a);we=Ub({type:"Perp",name:fc(),labeled:!0,args:[cc[0].name,a.name]});ee(a);return!0}return!1};ba.Orthogonal.actions[1]={};ba.Orthogonal.actions[1].event="mouseup";
ba.Orthogonal.actions[1].do=function(){$c();return!0};ba.Intersection={};ba.Intersection.actions=[];ba.Intersection.actions[0]={};ba.Intersection.actions[0].event="mousedown";ba.Intersection.actions[0].tooltip="Select two elements to define their intersection";ba.Intersection.actions[0].do=function(){return He()};ba.Intersection.actions[1]={};ba.Intersection.actions[1].event="mousedown";ba.Intersection.actions[1].do=function(){return He()?(we=Ub({type:"Meet",name:fc(),labeled:!0,args:[cc[0].name,
cc[1].name]}),!0):!1};class Oc{constructor(a){a?(this._e=[],this._e[0]=a[0][0],this._e[1]=a[1][0],this._e[2]=a[2][0],this._e[3]=a[0][1],this._e[4]=a[1][1],this._e[5]=a[2][1],this._e[6]=a[0][2],this._e[7]=a[1][2],this._e[8]=a[2][2]):this._e=[1,0,0,0,1,0,0,0,1]}clone(){let a=[...this._e],b=new Oc;b.set(a);return b}get(a){return this._e[a]}getRow(a){let b=this._e;return[b[a],b[3+a],b[6+a]]}set(a,b){1===arguments.length&&(this._e=a);2===arguments.length&&(this._e[a]=b)}exchange(a,b){[this._e[a],this._e[b]]=
[this._e[b],this._e[a]]}inverse(){var a=this._e;let b=-a[2]*a[4]*a[6]+a[1]*a[5]*a[6]+a[2]*a[3]*a[7]-a[0]*a[5]*a[7]-a[1]*a[3]*a[8]+a[0]*a[4]*a[8];a=[-a[4]*a[7]+a[4]*a[8],a[5]*a[6]-a[3]*a[8],-a[4]*a[6]+a[3]*a[7],a[2]*a[7]-a[1]*a[8],-a[2]*a[6]+a[0]*a[8],a[1]*a[6]-a[0]*a[7],-a[2]*a[4]+a[1]*a[5],a[2]*a[3]-a[0]*a[5],-a[1]*a[3]+a[0]*a[4]];1E-10>Math.abs(b)&&console.log("PSLQ: inverting singular matrix!");this._e=a.map(c=>c/b);return this}swRow(a,b){let c=0;for(;9>c;)this.exchange(c+a,c+b),c+=3}swCol(a,b){for(let c=
0;3>c;++c)this.exchange(3*a+c,3*b+c)}static mult(a,b,c){a=[a.get(0)*b.get(0)+a.get(3)*b.get(1)+a.get(6)*b.get(2),a.get(1)*b.get(0)+a.get(4)*b.get(1)+a.get(7)*b.get(2),a.get(2)*b.get(0)+a.get(5)*b.get(1)+a.get(8)*b.get(2),a.get(0)*b.get(3)+a.get(3)*b.get(4)+a.get(6)*b.get(5),a.get(1)*b.get(3)+a.get(4)*b.get(4)+a.get(7)*b.get(5),a.get(2)*b.get(3)+a.get(5)*b.get(4)+a.get(8)*b.get(5),a.get(0)*b.get(6)+a.get(3)*b.get(7)+a.get(6)*b.get(8),a.get(1)*b.get(6)+a.get(4)*b.get(7)+a.get(7)*b.get(8),a.get(2)*b.get(6)+
a.get(5)*b.get(7)+a.get(8)*b.get(8)];c.set(a)}getString(){let a=this._e;return"/"+a[0]+"\t "+a[3]+"\t "+a[6]+"\\\n|"+a[1]+"\t "+a[4]+"\t "+a[7]+"|\n\\"+a[2]+"\t "+a[5]+"\t "+a[8]+"/\n"}transpose(){this.exchange(1,3);this.exchange(2,6);this.exchange(5,7);return this}static VMmult(a,b,c){c[0]=b.get(0)*a[0]+b.get(1)*a[1]+b.get(2)*a[2];c[1]=b.get(3)*a[0]+b.get(4)*a[1]+b.get(5)*a[2];c[2]=b.get(6)*a[0]+b.get(7)*a[1]+b.get(8)*a[2]}}class Xc{static dot(a,b){let c=0;for(let d=0;d<a.length;d++)c+=a[d]*b[d];
return c}static scale(a,b){for(let c=0;c<a.length;++c)a[c]*=b}static maxIndex(a){let b=0;for(let c=1;c<a.length;++c)a[c]>a[b]&&(b=c);return b}static get MAX_ITER(){return 20}static get GAMMA(){return 2/Math.sqrt(3)}static hermiteReduce(a){let b=[[1,0,0],[0,1,0],[0,0,1]];var c=a.length;let d=a.map(m=>[...m]),f;for(let m=1;m<c;m++)for(let q=m-1;0<=q;q--){f=Math.round(a[m][q]/a[q][q]);for(var k=0;k<=q;k++)d[m][k]-=f*d[q][k];for(k=0;k<c;k++)b[m][k]-=f*b[q][k]}for(c=0;3>c;c++)a[c]=d[c];return new Oc(b)}static doPSLQ(a,
b){const c=a.length;let d=[];var f=[];for(var k=0;k<c;++k){d[k]=a[k]/Math.sqrt(Xc.dot(a,a));var m=0;for(var q=k;q<c;++q)m+=a[q]**2;f[k]=Math.sqrt(m)}Xc.scale(f,1/f[0]);k=new Oc;a=new Oc;m=[];for(q=0;q<c;q++)m[q]=[];for(q=0;q<c;++q)for(var t=0;t<c-1;++t)m[q][t]=q>t?-d[q]*d[t]/f[t]/f[t+1]:q===t?f[q+1]/f[q]:0;q=Xc.hermiteReduce(m);t=q.clone().inverse().transpose();Oc.VMmult(d,t,d);Oc.mult(q,k,k);Oc.mult(a,t,a);for(f=0;f<Xc.MAX_ITER;++f){t=[m[0][0],m[1][1]];q=0;this.GAMMA**2*Math.abs(t[1])>this.GAMMA**
1*Math.abs(t[0])&&(q=1);let C=t=0,F=0;q<c-2&&(t=m[q+1][q],C=m[q+1][q+1],F=Math.sqrt(t**2+C**2));var w=d[q];d[q]=d[q+1];d[q+1]=w;w=[...m[q]];m[q]=m[q+1];m[q+1]=w;k.swRow(q,q+1);a.swCol(q,q+1);w=Array(2);for(var y=0;3>y;y++)w[y]=[];if(q<c-2){for(y=0;y<c-1;++y)for(let H=0;H<c-1;++H)w[y][H]=y===q&&H===q?t/F:y===q&&H===q+1?-C/F:y===q+1&&H===q?C/F:y===q+1&&H===q+1?t/F:y===H&&H!==q||y===H&&H!==q+1?1:0;m=[[m[0][0]*w[0][0]+m[0][1]*w[1][0],m[0][0]*w[0][1]+m[0][1]*w[1][1]],[m[1][0]*w[0][0]+m[1][1]*w[1][0],m[1][0]*
w[0][1]+m[1][1]*w[1][1]],[m[2][0]*w[0][0]+m[2][1]*w[1][0],m[2][0]*w[0][1]+m[2][1]*w[1][1]]]}q=Xc.hermiteReduce(m);t=q.clone().inverse().transpose();Oc.VMmult(d,t,d);Oc.mult(q,k,k);Oc.mult(a,t,a);q=[d[0],d[1],d[2],m[0][0],m[1][1]];for(t=0;t<q.length;++t)if(Math.abs(q[t])<=10**(-b+5)){a.transpose();for(b=0;b<d.length;++b)d[b]=-Math.abs(d[b]);return a.getRow(Xc.maxIndex(d))}}}}const Wc={},O={drawingstate:{}};O.drawingstate.linecolor="rgb(0,0,255)";O.drawingstate.linecolorraw=[0,0,1];O.drawingstate.pointcolor=
"rgb(0,255,0)";O.drawingstate.pointcolorraw=[0,1,0];O.drawingstate.textcolor="rgb(0,0,0)";O.drawingstate.textcolorraw=[0,0,0];O.drawingstate.alpha=1;O.drawingstate.pointsize=4;O.drawingstate.linesize=1;O.drawingstate.textsize=null;O.drawingstate.matrix={};O.drawingstate.matrix.a=25;O.drawingstate.matrix.b=0;O.drawingstate.matrix.c=0;O.drawingstate.matrix.d=25;O.drawingstate.matrix.tx=250.5;O.drawingstate.matrix.ty=250.5;O.drawingstate.matrix.det=O.drawingstate.matrix.a*O.drawingstate.matrix.d-O.drawingstate.matrix.b*
O.drawingstate.matrix.c;O.drawingstate.matrix.sdet=Math.sqrt(O.drawingstate.matrix.det);O.drawingstate.initialmatrix={};O.drawingstate.initialmatrix.a=O.drawingstate.matrix.a;O.drawingstate.initialmatrix.b=O.drawingstate.matrix.b;O.drawingstate.initialmatrix.c=O.drawingstate.matrix.c;O.drawingstate.initialmatrix.d=O.drawingstate.matrix.d;O.drawingstate.initialmatrix.tx=O.drawingstate.matrix.tx;O.drawingstate.initialmatrix.ty=O.drawingstate.matrix.ty;O.drawingstate.initialmatrix.det=O.drawingstate.matrix.det;
O.drawingstate.initialmatrix.sdet=O.drawingstate.matrix.sdet;O.clone=function(a){if(null===a||"object"!==typeof a)return a;const b=a.constructor();for(const c in a)b[c]=O.clone(a[c]);return b};Wc.backup=O.clone(O.drawingstate);Wc.stack=[];O.clone(O.drawingstate);O.reset=function(){O.drawingstate.matrix.a=O.drawingstate.initialmatrix.a;O.drawingstate.matrix.b=O.drawingstate.initialmatrix.b;O.drawingstate.matrix.c=O.drawingstate.initialmatrix.c;O.drawingstate.matrix.d=O.drawingstate.initialmatrix.d;
O.drawingstate.matrix.tx=O.drawingstate.initialmatrix.tx;O.drawingstate.matrix.ty=O.drawingstate.initialmatrix.ty;O.drawingstate.matrix.det=O.drawingstate.initialmatrix.det;O.drawingstate.matrix.sdet=O.drawingstate.initialmatrix.sdet};O.from=function(a,b,c){a/=c;b/=c;c=O.drawingstate.matrix;return[(a*c.a-b*c.b+c.tx)/pb,(a*c.c-b*c.d-c.ty)/pb]};O.to=function(a,b){const c=O.drawingstate.matrix;a=a*pb-c.tx;b=b*pb+c.ty;return[(a*c.d-b*c.b)/c.det,-(-a*c.c+b*c.a)/c.det,1]};O.toMat=function(){const a=O.drawingstate.matrix;
return h.realMatrix([[a.d,-a.b,-a.tx*a.d-a.ty*a.b],[a.c,-a.a,-a.tx*a.c-a.ty*a.a],[0,0,a.det]])};O.dumpTrafo=function(){function a(c){return Math.round(1E3*c)/1E3}const b=O.drawingstate.matrix;console.log("a:"+a(b.a)+" b:"+a(b.b)+" c:"+a(b.c)+" d:"+a(b.d)+" tx:"+a(b.ty)+" ty:"+a(b.tx))};O.setMat=function(a,b,c,d,f,k){const m=O.drawingstate.matrix;m.a=a;m.b=b;m.c=c;m.d=d;m.tx=f;m.ty=k;m.det=a*d-b*c;m.sdet=Math.sqrt(m.det)};O.scaleAndOrigin=function(a,b,c){O.setMat(a,0,0,a,b,c)};O.visibleRect=function(a,
b,c,d){var f=c-a;const k=b-d;f=gb*k<ib*f?gb/f:ib/k;O.setMat(f,0,0,f,(gb-f*(a+c))/2,(ib-f*(b+d))/2)};O.applyMat=function(a,b,c,d,f,k){const m=O.drawingstate.matrix;O.setMat(m.a*a+m.c*b,m.b*a+m.d*b,m.a*c+m.c*d,m.b*c+m.d*d,m.a*f+m.c*k+m.tx,m.b*f+m.d*k+m.ty)};O.translate=function(a,b){O.applyMat(1,0,0,1,a,b)};O.rotate=function(a){const b=Math.cos(a);a=Math.sin(a);O.applyMat(b,a,-a,b,0,0)};O.scale=function(a){O.applyMat(a,0,0,a,0,0)};O.gsave=function(){Wc.stack.push(O.clone(O.drawingstate))};O.grestore=
function(){0!==Wc.stack.length&&(O.drawingstate=Wc.stack.pop())};O.greset=function(){O.drawingstate=O.clone(Wc.backup);O.drawingstate.matrix.ty-=ib;O.drawingstate.initialmatrix.ty-=ib;Wc.stack=[]};O.createnewbackup=function(){O.drawingstate.initialmatrix.a=O.drawingstate.matrix.a;O.drawingstate.initialmatrix.b=O.drawingstate.matrix.b;O.drawingstate.initialmatrix.c=O.drawingstate.matrix.c;O.drawingstate.initialmatrix.d=O.drawingstate.matrix.d;O.drawingstate.initialmatrix.tx=O.drawingstate.matrix.tx;
O.drawingstate.initialmatrix.ty=O.drawingstate.matrix.ty;O.drawingstate.initialmatrix.det=O.drawingstate.matrix.det;O.drawingstate.initialmatrix.sdet=O.drawingstate.matrix.sdet;Wc.backup=O.clone(O.drawingstate)};O.makecolor=function(a,b,c){a=Math.floor(255*a);b=Math.floor(255*b);c=Math.floor(255*c);return 1===O.drawingstate.alpha?"rgb("+a+","+b+","+c+")":"rgba("+a+","+b+","+c+","+O.drawingstate.alpha+")"};O.setcolor=function(a){const b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;
O.drawingstate.linecolor=O.drawingstate.pointcolor=O.makecolor(b,c,a);O.drawingstate.linecolorraw=O.drawingstate.pointcolorraw=[b,c,a]};O.setlinecolor=function(a){const b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;O.drawingstate.linecolor=O.makecolor(b,c,a);O.drawingstate.linecolorraw=[b,c,a]};O.settextcolor=function(a){const b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;O.drawingstate.textcolor=O.makecolor(b,c,a);O.drawingstate.textcolorraw=[b,
c,a]};O.setpointcolor=function(a){const b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;O.drawingstate.pointcolor=O.makecolor(b,c,a);O.drawingstate.pointcolorraw=[b,c,a]};O.setalpha=function(a){O.drawingstate.alpha=a.value.real;O.drawingstate.linecolor=O.makecolor(O.drawingstate.linecolorraw[0],O.drawingstate.linecolorraw[1],O.drawingstate.linecolorraw[2]);O.drawingstate.pointcolor=O.makecolor(O.drawingstate.pointcolorraw[0],O.drawingstate.pointcolorraw[1],O.drawingstate.pointcolorraw[2]);
O.drawingstate.textcolor=O.makecolor(O.drawingstate.textcolorraw[0],O.drawingstate.textcolorraw[1],O.drawingstate.textcolorraw[2])};O.setpointsize=function(a){O.drawingstate.pointsize=a.value.real};O.setlinesize=function(a){O.drawingstate.linesize=a.value.real};O.settextsize=function(a){O.drawingstate.textsize=a.value.real};const ub={clip:"none",pointColor:[1,0,0],lineColor:[0,0,1],pointSize:5,lineSize:1,alpha:1,overhangLine:1,overhangSeg:1,dimDependent:.7,fontFamily:"sans-serif",textColor:[0,0,0],
textsize:20,noborder:!1,lineHeight:1.45};aa.defaultAppearance&&df(aa.defaultAppearance);var af={};const Af={UL:0,UR:1,LR:2,LL:3},vf=["in","out","good","backup","prover"];let md=new Float64Array(0);const Lc={};vf.forEach(function(a){Lc[a]=md});let Eb=md,zc=md,jc=md,dc,kc,ld;var rc;let Yd,wf=!1;const Bf={toString:function(){return"RefineException"}};let Cf=null;var ra=null;aa.enableTraceLog&&(ra={logLength:Infinity,fullLog:[],currentMouseAndScripts:null,currentMover:null,currentStep:null,currentElement:null,
currentParam:null,labelTracing2:p.wrap("tracing2"),labelTracing4:p.wrap("tracing4"),labelTracingSesq:p.wrap("tracingSesq"),postMouseHooks:[]},"number"===typeof aa.enableTraceLog&&(ra.logLength=aa.enableTraceLog),Mb.getTraceLog=jf,Mb.formatTraceLog=kf,Mb.addTraceHook=ra.postMouseHooks.push.bind(ra.postMouseHooks));gc.stateSize=12;ke.stateSize=24;cd.stateSize=24;let Pb=[];kb._helper={};kb._helper.duplicatePPLL=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return{P:"point",
L:"line"}[a.kind]+" "+a.name+" is duplicate of "+b.name},apply:dd(a,b),holds:function(){return h.projectiveDistMinScal(a.homog,b.homog)<n.epsbig}}};kb._helper.duplicatePsLs=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return{Ps:"point set",Ls:"line set"}[a.kind]+" "+a.name+" is duplicate of "+b.name},apply:dd(a,b),holds:function(){return kb._helper.isSetEq(a.results.value,b.results.value,h.projectiveDistMinScal)}}};kb._helper.duplicateCC=function(a,b){return{getInvolved:function(){return[a,
b]},toString:function(){return"Conic "+a.name+" is duplicate of "+b.name},apply:dd(a,b),holds:function(){return h.conicDist(a.matrix,b.matrix)<n.epsbig}}};kb._helper.duplicateCs=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"Conic set"+a.name+" is duplicate of "+b.name},apply:dd(a,b),holds:function(){return kb._helper.isSetEq(a.results,b.results,h.conicDist)}}};kb._helper.duplicateSS=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"Segment "+
a.name+" is duplicate of "+b.name},apply:dd(a,b),holds:function(){const c=a.startpos;var d=a.endpos;const f=b.startpos,k=b.endpos;let m=h.projectiveDistMinScal(c,f);m+=h.projectiveDistMinScal(d,k);d=h.projectiveDistMinScal(d,f);d+=h.projectiveDistMinScal(c,k);return Math.min(m,d)<n.epsbig}}};kb.P=function(a){E.points.forEach(function(b){a.name!==b.name&&(b=kb._helper.duplicatePPLL(a,b),b.holds()&&Pb.push(b))})};kb.Ps=function(a){E.sets.points.forEach(function(b){a.name!==b.name&&(b=kb._helper.duplicatePsLs(a,
b),b.holds()&&Pb.push(b))})};kb.Ls=function(a){E.sets.lines.forEach(function(b){a.name!==b.name&&(b=kb._helper.duplicatePsLs(a,b),b.holds()&&Pb.push(b))})};kb.Cs=function(a){E.sets.conics.forEach(function(b){a.name!==b.name&&(b=kb._helper.duplicateCs(a,b),b.holds()&&Pb.push(b))})};kb.L=function(a){E.lines.forEach(function(b){a.name!==b.name&&a.kind===b.kind&&(b=kb._helper.duplicatePPLL(a,b),b.holds()&&Pb.push(b))})};kb.S=function(a){E.lines.forEach(function(b){a.name!==b.name&&"S"===b.kind&&(b=kb._helper.duplicateSS(a,
b),b.holds()&&Pb.push(b))})};kb.C=function(a){E.conics.forEach(function(b){a.name!==b.name&&(b=kb._helper.duplicateCC(a,b),b.holds()&&Pb.push(b))})};kb._helper.isSetEq=function(a,b,c){a=a.slice();b=b.slice();if(a.length!==b.length)return!1;if(0===a.length&&0===b.length)return!0;const d=a.shift(),f=b.reduce(function(k,m,q,t){return c(m,d)<c(t[k],d)?q:k},0);return c(b[f],d)<n.epsbig?(b.splice(f,1),kb._helper.isSetEq(a,b,c)):!1};Dc.P=function(a){E.lines.forEach(function(b){b=Te(a,b);b.holds()&&Pb.push(b)});
E.conics.forEach(function(b){b=Ue(a,b);b.holds()&&Pb.push(b)})};Dc.L=function(a){E.points.forEach(function(b){b=Te(b,a);b.holds()&&Pb.push(b)})};Dc.S=Dc.L;Dc.C=function(a){E.points.forEach(function(b){b=Ue(b,a);b.holds()&&Pb.push(b)})};const v={_helper:{},RandomLine:{}};v.RandomLine.kind="L";v.RandomLine.signature=[];v.RandomLine.updatePosition=function(a){a.homog=h.realVector([Math.random()-.5,Math.random()-.5,Math.random()-.5]);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Line")};
v._helper.getRandMove=function(a){a=a.homog;const b=h.getRandComplexVec3(-.05,.05);return{type:"homog",value:h.add(a,b)}};v._helper.getRandPointMove=function(a){a=h.normalizeMax(a.homog);var b=a.value[2],c=n.abs(b).value.real;let d=n.real(0);c<n.eps&&(d=n.getRandComplex(-.05,.05),b=n.real(1));c=h.turnIntoCSList([n.getRandComplex(-.1,.1),n.getRandComplex(-.1,.1),d]);b=h.scalmult(b,c);b=h.add(a,b);return{type:"homog",value:b}};v.FreeLine={};v.FreeLine.kind="L";v.FreeLine.signature=[];v.FreeLine.isMovable=
!0;v.FreeLine.initialize=function(a){a=v._helper.initializeLine(a);Qa(a)};v.FreeLine.getParamForInput=function(a,b,c){"mouse"===c?(a=h.cross(b,h.ez),a=h.cross(a,b)):a="homog"===c?b:h.turnIntoCSList([n.zero,n.zero,n.zero]);return h.normalizeMax(a)};v.FreeLine.getParamFromState=function(a){return Za(3)};v.FreeLine.putParamToState=function(a,b){Qa(b)};v.FreeLine.updatePosition=function(a){const b=Za(3);Qa(b);a.homog=p.withUsage(b,"Line")};v.FreeLine.getRandomMove=v._helper.getRandMove;v.FreeLine.stateSize=
6;v.RandomPoint={};v.RandomPoint.kind="P";v.RandomPoint.signature=[];v.RandomPoint.updatePosition=function(a){a.homog=h.realVector([100*Math.random(),100*Math.random(),100*Math.random()]);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Point")};v.Join={};v.Join.kind="L";v.Join.signature=["P","P"];v.Join.updatePosition=function(a){a.homog=h.cross(E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Line")};v.Segment={};v.Segment.kind=
"S";v.Segment.signature=["P","P"];v.Segment.updatePosition=function(a){const b=E.csnames[a.args[0]],c=E.csnames[a.args[1]];v.Segment.setSegmentPos(a,h.cross(b.homog,c.homog),h.scalmult(c.homog.value[2],b.homog),h.scalmult(b.homog.value[2],c.homog))};v.Segment.setSegmentPos=function(a,b,c,d){b=h.normalizeMax(b);a.homog=p.withUsage(b,"Line");b=h.turnIntoCSList([c,d]);b=h.normalizeMax(b);a.startpos=b.value[0];a.endpos=b.value[1];a.farpoint=h.sub(a.startpos,a.endpos);a.farpoint=h.sub(a.startpos,a.endpos)};
v.Meet={};v.Meet.kind="P";v.Meet.signature=["L","L"];v.Meet.updatePosition=function(a){a.homog=h.cross(E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Point")};v.Meet.visiblecheck=function(a){let b=!0;const c=E.csnames[a.args[0]],d=E.csnames[a.args[1]];"S"===c.kind&&(b=Me(a,c));b&&"S"===d.kind&&(b=Me(a,d));a.isshowing=b};v._helper.midpoint=function(a,b){return h.normalizeMax(h.add(h.scalmult(b.value[2],a),h.scalmult(a.value[2],b)))};
v.Mid={};v.Mid.kind="P";v.Mid.signature=["P","P"];v.Mid.updatePosition=function(a){const b=v._helper.midpoint(E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog);a.homog=p.withUsage(b,"Point")};v.Perp={};v.Perp.kind="L";v.Perp.signature=["L","P"];v.Perp.updatePosition=function(a){var b=E.csnames[a.args[0]].homog;const c=E.csnames[a.args[1]].homog;b=h.turnIntoCSList([b.value[0],b.value[1],n.zero]);a.homog=h.cross(b,c);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Line")};v.Para={};
v.Para.kind="L";v.Para.signature=["L","P"];v.Para.updatePosition=function(a){const b=E.csnames[a.args[1]].homog;a.homog=h.cross(h.cross(h.linfty,E.csnames[a.args[0]].homog),b);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Line")};v.Horizontal={};v.Horizontal.kind="L";v.Horizontal.signature=["P"];v.Horizontal.updatePosition=function(a){a.homog=h.cross(h.ex,E.csnames[a.args[0]].homog);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Line")};v.HorizontalLine={};v.HorizontalLine.kind=
"L";v.HorizontalLine.signature=[];v.HorizontalLine.isMovable=!0;v.HorizontalLine.initialize=function(a){a=v._helper.initializeLine(a);a=h.turnIntoCSList([n.zero,a.value[1],a.value[2]]);a=h.normalizeMax(a);Qa(a)};v.HorizontalLine.getParamForInput=function(a,b,c){if("mouse"===c)b=h.cross(b,h.ex);else if("homog"===c){if(0!==b.value[0].real||0!==b.value[0].imag)b=h.turnIntoCSList([n.zero,b.value[1],b.value[2]])}else b=h.turnIntoCSList([n.zero,n.zero,n.zero]);return h.normalizeMax(b)};v.HorizontalLine.getParamFromState=
function(a){return Za(3)};v.HorizontalLine.putParamToState=function(a,b){Qa(b)};v.HorizontalLine.updatePosition=function(a){const b=Za(3);Qa(b);a.homog=p.withUsage(b,"Line")};v.HorizontalLine.getRandomMove=v._helper.getRandMove;v.HorizontalLine.stateSize=6;v.Vertical={};v.Vertical.kind="L";v.Vertical.signature=["P"];v.Vertical.updatePosition=function(a){a.homog=h.cross(h.ey,E.csnames[a.args[0]].homog);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Line")};v.VerticalLine={};v.VerticalLine.kind=
"L";v.VerticalLine.signature=[];v.VerticalLine.isMovable=!0;v.VerticalLine.initialize=function(a){a=v._helper.initializeLine(a);a=h.turnIntoCSList([a.value[0],n.zero,a.value[2]]);a=h.normalizeMax(a);Qa(a)};v.VerticalLine.getParamForInput=function(a,b,c){if("mouse"===c)b=h.cross(b,h.ey);else if("homog"===c){if(0!==b.value[1].real||0!==b.value[1].imag)b=h.turnIntoCSList([b.value[0],n.zero,b.value[2]])}else b=h.turnIntoCSList([n.zero,n.zero,n.zero]);return h.normalizeMax(b)};v.VerticalLine.getParamFromState=
function(a){return Za(3)};v.VerticalLine.putParamToState=function(a,b){Qa(b)};v.VerticalLine.updatePosition=function(a){const b=Za(3);Qa(b);a.homog=p.withUsage(b,"Line")};v.VerticalLine.getRandomMove=v._helper.getRandMove;v.VerticalLine.stateSize=6;v.LineByFixedAngle={};v.LineByFixedAngle.kind="L";v.LineByFixedAngle.signature=["L","P"];v.LineByFixedAngle.initialize=function(a){var b=n._helper.input(a.angle);const c=n.cos(b);b=n.sin(b);a.rot=h.turnIntoCSList([h.turnIntoCSList([b,c,n.zero]),h.turnIntoCSList([n.neg(c),
b,n.zero]),h.turnIntoCSList([n.zero,n.zero,n.zero])])};v.LineByFixedAngle.updatePosition=function(a){const b=E.csnames[a.args[1]],c=h.productMV(a.rot,E.csnames[a.args[0]].homog);a.homog=h.cross(b.homog,c);a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Line")};v.Through={};v.Through.kind="L";v.Through.signature=["P"];v.Through.isMovable=!0;v.Through.initialize=function(a){a=a.dir?p.wrap(a.dir):h.realVector([a.pos[1],-a.pos[0],0]);Qa(a)};v.Through.getParamForInput=function(a,b,c){a="dir"===
c||"mouse"===c?h.cross(E.csnames[a.args[0]].homog,b):"homog"===c?b:h.turnIntoCSList([n.zero,n.zero,n.zero]);a=h.cross(h.linfty,a);return h.normalizeMax(a)};v.Through.getParamFromState=function(a){return Za(3)};v.Through.putParamToState=function(a,b){Qa(b)};v.Through.updatePosition=function(a){var b=Za(3);Qa(b);b=h.cross(E.csnames[a.args[0]].homog,b);b=h.normalizeMax(b);a.homog=p.withUsage(b,"Line")};v.Through.getRandomMove=v._helper.getRandMove;v.Through.stateSize=6;v.Through.set_angle=function(a,
b){if("number"===b.ctype){var c=n.cos(b);b=n.sin(b);c=h.turnIntoCSList([c,b,n.real(0)]);Qb(a,c,"dir")}};v.Through.set_slope=function(a,b){"number"===b.ctype&&(b=h.turnIntoCSList([n.real(1),b,n.real(0)]),Qb(a,b,"dir"))};v.Free={};v.Free.kind="P";v.Free.signature=[];v.Free.isMovable=!0;v.Free.initialize=function(a){a=v._helper.initializePoint(a);Qa(a)};v.Free.getParamForInput=function(a,b,c){if("mouse"===c&&Vc&&0!==Rb){b=h.normalizeZ(b);a=b.value[0].value.real;c=b.value[1].value.real;const d=Math.round(a/
Rb)*Rb,f=Math.round(c/Rb)*Rb;Math.abs(d-a)<id&&Math.abs(f-c)<id&&(b=h.realVector([d,f,1]))}return h.normalizeMax(b)};v.Free.getParamFromState=function(a){return Za(3)};v.Free.putParamToState=function(a,b){Qa(b)};v.Free.updatePosition=function(a){const b=Za(3);Qa(b);a.homog=p.withUsage(b,"Point")};v.Free.getRandomMove=v._helper.getRandPointMove;v.Free.stateSize=6;v._helper.projectPointToLine=function(a,b){const c=h.turnIntoCSList([b.value[0],b.value[1],n.zero]);a=h.cross(c,a);return h.normalizeMax(h.cross(a,
b))};v.PointOnLine={};v.PointOnLine.kind="P";v.PointOnLine.signature=["L"];v.PointOnLine.isMovable=!0;v.PointOnLine.initialize=function(a){let b=v._helper.initializePoint(a);a=E.csnames[a.args[0]].homog;b=v._helper.projectPointToLine(b,a);b=h.normalizeMax(b);let c=h.cross(h.linfty,b);h.normalizeMax(c);Qa(b);Qa(a);ld=!1};v.PointOnLine.updatePosition=function(a,b){const c=E.csnames[a.args[0]].homog;var d=Za(3);Za(3);if(!b){dc=a.stateIdx;var f=Eb;Eb=jc;b=Za(3);const k=Za(3);Eb=f;f=h.cross(k,c);h._helper.isAlmostZero(f)&&
(f=h.cross(h.linfty,c));b=v._helper.CircleMP(f,b);b=v._helper.IntersectLC(c,b);f=v._helper.pointReflection(f,d);d=je(b[0],b[1],d,f)[0]}d=h.normalizeMax(d);Qa(d);Qa(c);a.homog=p.withUsage(d,"Point")};v.PointOnLine.getParamForInput=function(a,b,c){a=E.csnames[a.args[0]].homog;b=v._helper.projectPointToLine(b,a);"mouse"===c&&Vc&&0!==Rb&&(b=v._helper.snapPointToLine(b,a));return b};v.PointOnLine.getParamFromState=function(a){return Za(3)};v.PointOnLine.putParamToState=function(a,b){return Qa(b)};v.PointOnLine.getRandomMove=
v._helper.getRandPointMove;v.PointOnLine.stateSize=12;v.PointOnCircle={};v.PointOnCircle.kind="P";v.PointOnCircle.signature=["C"];v.PointOnCircle.isMovable=!0;v.PointOnCircle.initialize=function(a){var b=E.csnames[a.args[0]];a=h.normalizeZ(v._helper.initializePoint(a));var c=h.normalizeZ(v._helper.CenterOfCircle(b.matrix)),d=h.sub(a,c);d=h.turnIntoCSList([d.value[1],n.neg(d.value[0]),n.zero]);c=h.cross(a,c);b=v._helper.IntersectLC(c,b.matrix);c=h.projectiveDistMinScal(a,b[0]);h.projectiveDistMinScal(a,
b[1])<c?(a=b[1],b=b[0]):(a=b[0],b=b[1]);Qa(d);Qa(a);Qa(b);ld=!1};v.PointOnCircle.putParamToState=function(a,b){Qa(b)};v.PointOnCircle.getParamFromState=function(a){return Za(3)};v.PointOnCircle.getParamForInput=function(a,b,c){c=h.normalizeZ(v._helper.CenterOfCircle(E.csnames[a.args[0]].matrix));b=h.sub(b,c);dc=a.stateIdx;a=Za(3);const d=h.normalizeZ(Za(3));c=h.sub(d,c);0>n.sub(n.mult(a.value[0],c.value[1]),n.mult(a.value[1],c.value[0])).value.real&&(b=h.neg(b));return h.turnIntoCSList([b.value[1],
n.neg(b.value[0]),n.zero])};v.PointOnCircle.parameterPath=function(a,b,c,d,f){d=h.normalizeAbs(d);f=h.normalizeAbs(f);var k=h.scalproduct(d,f);if(0<=k.value.real)return he(a,b,c,d,f);a=h.turnIntoCSList([n.sub(d.value[1],f.value[1]),n.sub(f.value[0],d.value[0]),n.zero]);k=h.scalproduct(d,a);0>k.value.real&&(a=h.neg(a));0>b?(b=2*b+1,c=b*b,k=.25/(1+c),c=n.complex(2*b*k+.25,(1-c)*k)):(b=2*b-1,c=b*b,k=.25/(1+c),c=n.complex(2*b*k+.75,(1-c)*k));const m=n.sub(n.real(1),c);b=n.mult(c,c);k=n.mult(m,m);c=n.mult(c,
m);d=h.scalmult(k,d);d=h.add(d,h.scalmult(c,a));return d=h.add(d,h.scalmult(b,f))};v.PointOnCircle.updatePosition=function(a){var b=Za(3);Qa(b);var c=E.csnames[a.args[0]];b=h.productMV(c.matrix,b);c=v._helper.IntersectLC(b,c.matrix);c=gc(c[0],c[1]);b=h.normalizeMax(c.value[0]);a.homog=p.withUsage(b,"Point");a.antipodalPoint=c.value[1]};v.PointOnCircle.getRandomMove=v._helper.getRandPointMove;v.PointOnCircle.stateSize=6+gc.stateSize;v.PointOnCircle.get_angle=function(a){var b=v._helper.CenterOfCircle(E.csnames[a.args[0]].matrix);
const c=h._helper.isAlmostFarpoint;if(c(a.homog)||c(b))return A;a=h.normalizeZ(a.homog);b=h.normalizeZ(b);b=h.sub(a,b);b=n.arctan2(b.value[0],b.value[1]);a=n.real(te);b=n.mod(n.add(b,a),a);return p.withUsage(b,"Angle")};v.PointOnCircle.set_angle=function(a,b){if("number"===b.ctype){var c=E.csnames[a.args[0]];let d=v._helper.CenterOfCircle(c.matrix);if(!h._helper.isAlmostFarpoint(d)){d=h.normalizeZ(d);const f=n.cos(b);b=n.sin(b);c=h.turnIntoCSList([n.mult(f,c.radius),n.mult(b,c.radius),n.real(0)]);
Qb(a,h.add(d,c),"homog")}}return A};v.OtherPointOnCircle={};v.OtherPointOnCircle.kind="P";v.OtherPointOnCircle.signature=["P"];v.OtherPointOnCircle.signatureConstraints=function(a){return"PointOnCircle"===E.csnames[a.args[0]].type};v.OtherPointOnCircle.updatePosition=function(a){let b=E.csnames[a.args[0]].antipodalPoint;b=h.normalizeMax(b);a.homog=p.withUsage(b,"Point")};v.PointOnSegment={};v.PointOnSegment.kind="P";v.PointOnSegment.signature=["S"];v.PointOnSegment.isMovable=!0;v.PointOnSegment.initialize=
function(a){const b=v._helper.initializePoint(a);a=v.PointOnSegment.getParamForInput(a,b);wc(a)};v.PointOnSegment.getParamForInput=function(a,b,c){a=E.csnames[a.args[0]];var d=a.homog;"mouse"===c&&Vc&&0!==Rb&&(b=v._helper.snapPointToLine(b,d));c=h.turnIntoCSList([d.value[0],d.value[1],n.zero]);d=h.sub(a.startpos,a.endpos);b=h.crossratio3(d,a.startpos,a.endpos,b,c);0>b.value.real&&(b=n.complex(0,b.value.imag));1<b.value.real&&(b=n.complex(1,b.value.imag));return b};v.PointOnSegment.getParamFromState=
function(a){return bd()};v.PointOnSegment.putParamToState=function(a,b){wc(b)};v.PointOnSegment.updatePosition=function(a){var b=bd();wc(b);var c=E.csnames[a.args[0]];const d=c.startpos;c=h.sub(c.endpos,d);b=h.add(d,h.scalmult(b,c));b=h.normalizeMax(b);a.homog=p.withUsage(b,"Point")};v.PointOnSegment.getRandomMove=v._helper.getRandPointMove;v.PointOnSegment.stateSize=2;v._helper.projectPointToCircle=function(a,b){var c=v._helper.CenterOfCircle(a.matrix);c=h.normalizeMax(c);c=h.normalizeMax(h.cross(b,
c));a=v._helper.IntersectLC(c,a.matrix);c=h.projectiveDistMinScal(b,a[0]);b=h.projectiveDistMinScal(b,a[1]);return c<b?a[0]:a[1]};v.PointOnArc={};v.PointOnArc.kind="P";v.PointOnArc.signature=["C"];v.PointOnArc.signatureConstraints=function(a){return E.csnames[a.args[0]].isArc};v.PointOnArc.isMovable=!0;v.PointOnArc.initialize=function(a){const b=v._helper.initializePoint(a);a=v.PointOnArc.getParamForInput(a,b);Qa(a)};v.PointOnArc.getParamForInput=function(a,b){a=E.csnames[a.args[0]];b=v._helper.projectPointToCircle(a,
b);b=h.normalizeMax(h.crossratio3harm(a.startPoint,a.endPoint,a.viaPoint,b,h.ii));a=n.div(b.value[0],b.value[1]);0>a.value.real&&(b=-1>a.value.real?h.realVector([1,0]):h.realVector([0,1]));return b};v.PointOnArc.getParamFromState=function(a){return Za(2)};v.PointOnArc.putParamToState=function(a,b){Qa(b)};v.PointOnArc.updatePosition=function(a){var b=E.csnames[a.args[0]],c=b.startPoint,d=b.viaPoint;const f=b.endPoint,k=h.ii;var m=h.cross(c,k);d=h.cross(d,k);var q=h.cross(f,k);q=h.turnIntoCSList([m,
q]);m=h.transpose(q);q=h.conjugate(q);m=h.productMM(q,m);d=h.productMV(q,d);m=h.productMV(h.adjoint2(m),d);d=m.value[0];m=m.value[1];q=Za(2);Qa(q);c=h.normalizeMax(h.add(h.scalmult(n.mult(d,q.value[0]),c),h.scalmult(n.mult(m,q.value[1]),f)));b=v._helper.conicOtherIntersection(b.matrix,k,c);a.homog=p.withUsage(b,"Point")};v.PointOnArc.getRandomMove=v._helper.getRandPointMove;v.PointOnArc.stateSize=4;v._helper.CenterOfCircle=function(a){return h.turnIntoCSList([a.value[2].value[0],a.value[2].value[1],
n.neg(a.value[0].value[0])])};v._helper.CenterOfConic=function(a){a=h.adjoint3(a);return{ctype:"list",value:[a.value[2].value[0],a.value[2].value[1],a.value[2].value[2]]}};v.CenterOfConic={};v.CenterOfConic.kind="P";v.CenterOfConic.signature=["C"];v.CenterOfConic.updatePosition=function(a){const b=v._helper.CenterOfConic(E.csnames[a.args[0]].matrix);a.homog=b;a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Point")};v._helper.CircleMP=function(a,b){var c=a.value[0],d=a.value[1];a=n.neg(a.value[2]);
const f=n.zero;c=h.turnIntoCSList([h.turnIntoCSList([a,f,c]),h.turnIntoCSList([f,a,d]),h.turnIntoCSList([c,d,f])]);d=p.mult(p.mult(b,c),b);b=p.mult(p.mult(b,h.fund),b);d=p.mult(d,h.fund);b=p.mult(b,c);return h.sub(d,b)};v.CircleMP={};v.CircleMP.kind="C";v.CircleMP.signature=["P","P"];v.CircleMP.updatePosition=function(a){a.matrix=v._helper.CircleMP(E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog);a.matrix=h.normalizeMax(a.matrix);a.matrix=p.withUsage(a.matrix,"Circle")};v.CircleMr={};v.CircleMr.kind=
"C";v.CircleMr.signature=["P"];v.CircleMr.isMovable=!0;v.CircleMr.initialize=function(a){wc(n.real(a.radius))};v.CircleMr.getParamForInput=function(a,b,c){if("radius"===c)return b;a=E.csnames[a.args[0]].homog;a=h.normalizeZ(a);b=h.normalizeZ(b);b=h.sub(a,b);return b=h.abs(b)};v.CircleMr.getParamFromState=function(a){return bd()};v.CircleMr.putParamToState=function(a,b){wc(b)};v.CircleMr.updatePosition=function(a){const b=bd();wc(b);var c=E.csnames[a.args[0]].homog,d=n.mult(c.value[2],b);d=n.mult(d,
d);if(!n._helper.isFinite(d)&&!n._helper.isNaN(d))return h.fund;c=v._helper.ScaledCircleMrr(c,d);a.matrix=p.withUsage(c,"Circle");a.radius=b};v.CircleMr.getRandomMove=function(a){a=a.radius;return{type:"radius",value:n.abs(a).value.real<n.eps?n.getRandComplex(.05,.1):n.mult(a,n.getRandReal(.95,1.05))}};v.CircleMr.stateSize=2;v.CircleMr.set_radius=function(a,b){"number"===b.ctype&&Qb(a,b,"radius")};v._helper.ScaledCircleMrr=function(a,b){var c=a.value[0];const d=a.value[1];a=n.neg(a.value[2]);a=h.scalmult(a,
h.turnIntoCSList([c,d,a])).value;c=h.turnIntoCSList([c,d]);b=n.sub(h.scalproduct(c,c),b);b=v._helper.buildConicMatrix([a[2],n.zero,a[2],a[0],a[1],b]);return h.normalizeMax(b)};v.Compass={};v.Compass.kind="C";v.Compass.signature=["P","P","P"];v.Compass.updatePosition=function(a){var b=E.csnames[a.args[0]].homog;let c=E.csnames[a.args[1]].homog;var d=E.csnames[a.args[2]].homog;const f=b.value[2],k=c.value[2],m=d.value[2];b=h.scalmult(n.mult(k,m),b);c=h.scalmult(n.mult(f,m),c);d=h.scalmult(n.mult(f,
k),d);b=h.sub(c,b);d=v._helper.ScaledCircleMrr(d,h.scalproduct(b,b));a.matrix=p.withUsage(d,"Circle")};v._helper.getConicType=function(a){if(1E-16>n.abs(h.det(a)).value.real)return"degenerate";let b=n.mult(a.value[0].value[0],a.value[1].value[1]);b=n.sub(b,n.pow(a.value[0].value[1],n.real(2)));b=b.value.real;return 1E-16>Math.abs(b)?"parabola":1E-16<b?"ellipsoid":"hyperbola"};v._helper.ConicBy5=function(a,b,c,d,f,k){a=h.turnIntoCSList([h.cross(c,d)]);const m=h.turnIntoCSList([h.cross(b,f)]);b=h.turnIntoCSList([h.cross(b,
c)]);d=h.turnIntoCSList([h.cross(d,f)]);return v._helper.conicFromTwoDegenerates(a,m,b,d,k)};v._helper.conicFromTwoDegenerates=function(a,b,c,d,f){a=p.mult(h.transpose(b),a);c=p.mult(h.transpose(d),c);a=h.add(a,h.transpose(a));c=h.add(c,h.transpose(c));d=p.mult(p.mult(f,a),f);f=p.mult(p.mult(f,c),f);c=p.mult(d,c);f=p.mult(f,a);return h.sub(c,f)};v.ConicBy5={};v.ConicBy5.kind="C";v.ConicBy5.signature=["P","P","P","P","P"];v.ConicBy5.updatePosition=function(a){const b=v._helper.ConicBy5(a,E.csnames[a.args[0]].homog,
E.csnames[a.args[1]].homog,E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[4]].homog);a.matrix=b;a.matrix=h.normalizeMax(a.matrix);a.matrix=p.withUsage(a.matrix,"Conic")};v.FreeConic={};v.FreeConic.kind="C";v.FreeConic.signature=[];v.FreeConic.initialize=function(a){let b;b=a.pos?v._helper.inputConic(a.pos):h.zeromatrix(n.real(3),n.real(3));v.FreeConic.putParamToState(a,b)};v.FreeConic.getParamForInput=function(a,b,c){return h.normalizeMax(b)};v.FreeConic.getParamFromState=
function(a){return v._helper.buildConicMatrix(Za(6).value)};v.FreeConic.putParamToState=function(a,b){for(a=0;3>a;++a)for(let c=0;c<=a;++c)wc(b.value[a].value[c])};v.FreeConic.updatePosition=function(a){const b=Za(6);Qa(b);a.matrix=v._helper.buildConicMatrix(b.value);a.matrix=h.normalizeMax(a.matrix);a.matrix=p.withUsage(a.matrix,"Conic")};v.FreeConic.set_matrix=function(a,b){h._helper.isNumberMatrixMN(b,3,3)&&Qb(a,h.add(b,h.transpose(b)),"matrix")};v.FreeConic.stateSize=12;v._helper.buildConicMatrix=
function(a){const b=a[1],c=a[2],d=a[3],f=a[4],k=a[5];return h.turnIntoCSList([h.turnIntoCSList([a[0],b,d]),h.turnIntoCSList([b,c,f]),h.turnIntoCSList([d,f,k])])};v._helper.flattenConicMatrix=function(a){return h.turnIntoCSList([a.value[0].value[0],a.value[0].value[1],a.value[1].value[1],a.value[0].value[2],a.value[1].value[2],a.value[2].value[2]])};v._helper.splitDegenConic=function(a){var b=h.adjoint3(a),c=0,d,f=n.abs2(b.value[0].value[0]).value.real;for(d=1;3>d;d++){var k=n.abs2(b.value[d].value[d]).value.real;
k>f&&(c=d,f=k)}d=n.sqrt(n.mult(n.real(-1),b.value[c].value[c]));if(1E-16>n.abs2(d).value.real)return a=h.turnIntoCSList([n.zero,n.zero,n.zero]),[a,a];c=n.real(c+1);k=h.column(b,c);k=h.scaldiv(d,k);d=k.value[0];f=k.value[1];k=k.value[2];d=h.turnIntoCSList([h.turnIntoCSList([n.real(0),k,n.mult(n.real(-1),f)]),h.turnIntoCSList([n.mult(n.real(-1),k),n.real(0),d]),h.turnIntoCSList([f,n.mult(n.real(-1),d),n.real(0)])]);a=h.add(a,d);let m=0;for(d=f=b=0;3>d;d++)for(c=0;3>c;c++)k=n.abs2(a.value[d].value[c]).value.real,
k>f&&(m=d,b=c,f=k);d=a.value[m];a=h.transpose(a);a=a.value[b];d=h.normalizeMax(d);a=h.normalizeMax(a);d=p.withUsage(d,"Line");a=p.withUsage(a,"Line");return[d,a]};v._helper.inputConic=function(a){const b="xx xy yy xz yz zz".split(" ").map(function(c){let d=n._helper.input(a[c]);c[0]!==c[1]&&(d=n.realmult(.5,d));return d});return v._helper.buildConicMatrix(b)};v.SelectConic={};v.SelectConic.kind="C";v.SelectConic.signature=["Cs"];v.SelectConic.initialize=function(a){if(void 0!==a.index)return a.index-
1;const b=v._helper.inputConic(a.pos);a=E.csnames[a.args[0]].results;let c=h.conicDist(b,a[0]),d=0;for(let f=1;f<a.length;++f){const k=h.conicDist(b,a[f]);k<c&&(c=k,d=f)}return d};v.SelectConic.updatePosition=function(a){a.matrix=E.csnames[a.args[0]].results[a.param];a.matrix=h.normalizeMax(a.matrix);a.matrix=p.withUsage(a.matrix,"Conic")};v._helper.ConicBy4p1l=function(a,b,c,d,f,k){var m=h.scalproduct(b,k),q=h.scalproduct(c,k),t=h.scalproduct(d,k);const w=h.scalproduct(f,k),y=h.det3(c,d,f),C=h.det3(b,
c,f),F=h.det3(b,d,f),H=h.det3(b,c,d),R=n.mult;q=n.sqrt(R(R(q,w),R(y,C)));m=n.sqrt(R(R(m,t),R(F,H)));t=h.cross(h.cross(b,d),k);k=h.cross(h.cross(c,f),k);t=h.scalmult(q,t);m=h.scalmult(m,k);k=h.normalizeMax(h.add(t,m));m=h.normalizeMax(h.sub(t,m));m=gc(k,m);k=v._helper.ConicBy5(a,b,c,d,f,m.value[0]);a=v._helper.ConicBy5(a,b,c,d,f,m.value[1]);return[h.normalizeMax(k),h.normalizeMax(a)]};v.ConicBy4p1l={};v.ConicBy4p1l.kind="Cs";v.ConicBy4p1l.signature=["P","P","P","P","L"];v.ConicBy4p1l.updatePosition=
function(a){const b=v._helper.ConicBy4p1l(a,E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog,E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[4]].homog);a.results=b};v.ConicBy4p1l.stateSize=gc.stateSize;v._helper.ConicBy3p2l=function(a,b,c,d,f){function k(U,pa,da,Ba){return n.sub(n.mult(U,Ba),n.mult(pa,da))}var m=h.cross(a,b),q=h.cross(d,f);d=h.cross(d,m);f=h.cross(f,m);m=h.turnIntoCSList([d,f,q]);c=h.productVM(c,h.adjoint3(m));q=h.adjoint3(h.turnIntoCSList([h.scalmult(c.value[0],
d),h.scalmult(c.value[1],f),h.scalmult(c.value[2],q)]));c=h.transpose(q);d=n.mult;f=h.productMV(c,a);a=f.value[0];f=f.value[1];m=h.productMV(c,b);b=m.value[0];m=m.value[1];const t=n.sqrt(d(a,f)),w=n.sqrt(d(b,m));let y;const C=Array(4);for(y=0;4>y;++y){var F=(y&2)-1,H=d(n.real(((y&1)<<1)-1),t),R=d(n.real(F),w),S=k(f,H,m,R),Z=k(b,R,a,H);F=k(a,f,b,m);const U=n.add(n.add(k(b,m,a,f),k(m,R,f,H)),k(R,b,H,a));H=d(S,S);R=d(Z,Z);const pa=d(U,U);let da=d(S,Z);S=d(S,U);Z=d(Z,U);da=n.sub(da,d(n.real(.5),d(F,F)));
F=h.turnIntoCSList([h.turnIntoCSList([H,da,S]),h.turnIntoCSList([da,R,Z]),h.turnIntoCSList([S,Z,pa])]);F=h.productMM(q,h.productMM(F,c));F=h.turnIntoCSList([F.value[0].value[0],F.value[0].value[1],F.value[0].value[2],F.value[1].value[1],F.value[1].value[2],F.value[2].value[2]]);C[y]=F}return C};v.ConicBy3p2l={};v.ConicBy3p2l.kind="Cs";v.ConicBy3p2l.signature=["P","P","P","L","L"];v.ConicBy3p2l.updatePosition=function(a){let b=v._helper.ConicBy3p2l(E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog,
E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[4]].homog);b=Re(b);const c=Array(4);for(let d=0;4>d;++d){const f=b[d].value;c[d]=h.turnIntoCSList([h.turnIntoCSList([f[0],f[1],f[2]]),h.turnIntoCSList([f[1],f[3],f[4]]),h.turnIntoCSList([f[2],f[4],f[5]])])}a.results=c};v.ConicBy3p2l.stateSize=48;v.ConicBy2p3l={};v.ConicBy2p3l.kind="Cs";v.ConicBy2p3l.signature=["P","P","L","L","L"];v.ConicBy2p3l.updatePosition=function(a){let b=v._helper.ConicBy3p2l(E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog,
E.csnames[a.args[4]].homog,E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog);b=Re(b);const c=Array(4);for(let f=0;4>f;++f){var d=b[f].value;d=h.turnIntoCSList([h.turnIntoCSList([d[0],d[1],d[2]]),h.turnIntoCSList([d[1],d[3],d[4]]),h.turnIntoCSList([d[2],d[4],d[5]])]);c[f]=h.normalizeMax(h.adjoint3(d))}a.results=c};v.ConicBy2p3l.stateSize=48;v.ConicBy1p4l={};v.ConicBy1p4l.kind="Cs";v.ConicBy1p4l.signature=["P","L","L","L","L"];v.ConicBy1p4l.updatePosition=function(a){var b=v._helper.ConicBy4p1l(a,
E.csnames[a.args[1]].homog,E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[4]].homog,E.csnames[a.args[0]].homog);let c=b[0];b=b[1];c=h.adjoint3(c);b=h.adjoint3(b);b=[c,b];a.results=b};v.ConicBy1p4l.stateSize=gc.stateSize;v.ConicParabolaPL={};v.ConicParabolaPL.kind="C";v.ConicParabolaPL.signature=["P","L"];v.ConicParabolaPL.updatePosition=function(a){var b=E.csnames[a.args[0]].homog.value,c=E.csnames[a.args[1]].homog.value,d=n.mult,f=n.neg;const k=n.add,m=n.sub,q=b[0],t=b[1];
var w=b[2],y=c[0];b=c[1];c=c[2];const C=d(w,w);var F=d(y,y),H=d(b,b);const R=d(w,c),S=f(w);w=k(F,H);H=d(C,H);F=d(C,F);f=d(f(C),d(y,b));y=d(S,k(d(q,w),d(R,y)));b=d(S,k(d(t,w),d(R,b)));d=m(d(k(d(q,q),d(t,t)),w),d(C,d(c,c)));d=v._helper.buildConicMatrix([H,f,F,y,b,d]);d=h.normalizeMax(d);a.matrix=p.withUsage(d,"Conic")};v.ConicBy2Foci1P={};v.ConicBy2Foci1P.kind="Cs";v.ConicBy2Foci1P.signature=["P","P","P"];v.ConicBy2Foci1P.updatePosition=function(a){var b=E.csnames[a.args[0]].homog;const c=E.csnames[a.args[1]].homog;
var d=E.csnames[a.args[2]].homog,f=h.ii,k=h.jj,m=h.normalizeMax(h.cross(b,d)),q=h.normalizeMax(h.cross(c,d)),t=h.normalizeMax(h.cross(d,f));d=h.normalizeMax(h.cross(d,k));q=v._helper.coHarmonic(t,d,m,q);m=h.normalizeMax(q[0]);q=h.normalizeMax(q[1]);f=h.turnIntoCSList([f]);t=h.turnIntoCSList([k]);d=h.turnIntoCSList([b]);const w=h.turnIntoCSList([c]);k=v._helper.conicFromTwoDegenerates(f,t,d,w,m);k=h.normalizeMax(k);f=v._helper.conicFromTwoDegenerates(f,t,d,w,q);f=h.normalizeMax(f);k=h.normalizeMax(h.adjoint3(k));
f=h.normalizeMax(h.adjoint3(f));"ellipsoid"!==v._helper.getConicType(k)&&(m=k,k=f,f=m);h.almostequals(b,c).value&&(b=n.real(3),f=h.zeromatrix(b,b));a.results=[k,f]};v.ConicBy2Pol1P={};v.ConicBy2Pol1P.kind="C";v.ConicBy2Pol1P.signature=["P","L","P","L","P"];v.ConicBy2Pol1P.updatePosition=function(a){var b=E.csnames[a.args[0]].homog,c=E.csnames[a.args[1]].homog,d=E.csnames[a.args[2]].homog;const f=E.csnames[a.args[3]].homog;var k=E.csnames[a.args[4]].homog;const m=h.scalproduct,q=h.scalmult,t=h.sub;
var w=h.productMM;const y=n.realmult,C=h.transpose;var F=h.turnIntoCSList;const H=t(q(m(c,b),k),q(y(2,m(c,k)),b));var R=t(q(m(f,d),k),q(y(2,m(f,k)),d));const S=F([h.cross(b,k)]);k=F([h.cross(d,k)]);R=w(C(S),F([h.cross(b,R)]));F=w(C(k),F([h.cross(d,H)]));w=w(C(S),k);b=m(b,f);c=m(d,c);d=h.add(q(c,R),q(b,F));d=t(d,q(y(2,n.mult(b,c)),w));d=h.add(d,C(d));d=h.normalizeMax(d);d=p.withUsage(d,"Conic");a.matrix=d};v.ConicBy2Pol1L={};v.ConicBy2Pol1L.kind="C";v.ConicBy2Pol1L.signature=["P","L","P","L","L"];
v.ConicBy2Pol1L.updatePosition=function(a){var b=E.csnames[a.args[0]].homog;const c=E.csnames[a.args[1]].homog,d=E.csnames[a.args[2]].homog,f=E.csnames[a.args[3]].homog,k=E.csnames[a.args[4]].homog;var m=h.scalproduct;const q=h.scalmult,t=h.productMM,w=n.mult,y=h.transpose,C=h.turnIntoCSList,F=m(c,b),H=m(c,d),R=m(f,b),S=m(f,d),Z=m(k,b);m=m(k,d);const U=C([h.sub(q(w(R,m),c),q(w(H,Z),f))]);b=h.add(t(y(C([q(w(R,H),k)])),C([h.sub(h.add(q(n.sub(w(F,m),w(H,Z)),f),q(n.sub(w(S,Z),w(R,m)),c)),q(h.det3(c,f,
k),h.cross(b,d)))])),t(y(U),U));b=h.add(b,y(b));b=h.normalizeMax(b);b=p.withUsage(b,"Conic");a.matrix=b};v._helper.conic1Pol3Inc=function(a,b,c,d,f){const k=h.scalproduct,m=h.scalmult,q=h.productMM;var t=h.cross;const w=n.realmult,y=n.mult,C=h.transpose,F=h.turnIntoCSList,H=h.det3,R=H(a,c,d);var S=F([t(c,f)]);const Z=F([t(a,f)]),U=F([t(c,d)]),pa=k(b,a),da=k(b,c);b=k(b,f);t=F([t(d,h.sub(m(pa,f),m(w(2,b),a)))]);S=m(R,q(C(S),t));a=w(2,n.add(y(H(a,d,f),da),y(R,b)));a=n.sub(y(H(c,d,f),pa),a);S=h.add(S,
m(a,q(C(Z),U)));S=h.add(S,C(S));return S=h.normalizeMax(S)};v.ConicBy1Pol3P={};v.ConicBy1Pol3P.kind="C";v.ConicBy1Pol3P.signature=["P","L","P","P","P"];v.ConicBy1Pol3P.updatePosition=function(a){let b=v._helper.conic1Pol3Inc(E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog,E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[4]].homog);b=p.withUsage(b,"Conic");a.matrix=b};v.ConicBy1Pol3L={};v.ConicBy1Pol3L.kind="C";v.ConicBy1Pol3L.signature=["P","L","L","L","L"];v.ConicBy1Pol3L.updatePosition=
function(a){let b=v._helper.conic1Pol3Inc(E.csnames[a.args[1]].homog,E.csnames[a.args[0]].homog,E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[4]].homog);b=h.normalizeMax(h.adjoint3(b));b=p.withUsage(b,"Conic");a.matrix=b};v.ConicBy1Pol2P1L={};v.ConicBy1Pol2P1L.kind="Cs";v.ConicBy1Pol2P1L.signature=["P","L","P","P","L"];v.ConicBy1Pol2P1L.updatePosition=function(a){var b=E.csnames[a.args[0]].homog,c=E.csnames[a.args[1]].homog,d=E.csnames[a.args[2]].homog,f=E.csnames[a.args[3]].homog,
k=E.csnames[a.args[4]].homog,m=n.add,q=h.turnIntoCSList;const t=h.cross;var w=h.productMM,y=n.mult,C=n.realmult;const F=h.scalmult;var H=h.scalproduct;const R=n.sub,S=h.transpose,Z=H(c,b),U=H(c,d),pa=H(c,f);c=H(k,b);const da=H(k,d);H=H(k,f);k=q([t(b,d)]);b=q([t(b,f)]);d=q([t(d,f)]);f=n.sqrt(y(y(da,H),y(R(y(Z,da),C(2,y(c,U))),R(y(Z,H),C(2,y(c,pa))))));q=w(S(k),b);f=F(f,h.add(q,S(q)));m=F(R(y(Z,y(da,H)),m(y(c,y(U,H)),y(c,y(da,pa)))),q);C=h.add(h.sub(F(pa,k),F(U,b)),F(C(.5,Z),d));m=h.add(m,F(y(c,c),
w(S(d),C)));m=h.add(m,S(m));w=h.normalizeMax(h.add(f,m));y=h.normalizeMax(h.sub(f,m));a.results=cd(w,y).value};v.ConicBy1Pol2P1L.stateSize=cd.stateSize;v.ConicBy1Pol1P2L={};v.ConicBy1Pol1P2L.kind="Cs";v.ConicBy1Pol1P2L.signature=["P","L","P","L","L"];v.ConicBy1Pol1P2L.updatePosition=function(a){var b=E.csnames[a.args[0]].homog,c=E.csnames[a.args[1]].homog;const d=E.csnames[a.args[2]].homog;var f=E.csnames[a.args[3]].homog,k=E.csnames[a.args[4]].homog;const m=n.add,q=h.turnIntoCSList,t=h.cross,w=h.productMM,
y=n.mult,C=n.realmult,F=h.scalmult;var H=h.scalproduct;const R=n.sub,S=h.transpose,Z=H(c,b),U=H(c,d),pa=H(f,b),da=H(f,d),Ba=H(k,b),Oa=H(k,d),ta=y(Z,Z),Ja=y(Z,U);H=y(U,U);const Wa=y(pa,pa),Ra=y(pa,da),Ka=y(da,da),Na=y(Ba,Ba);var cb=y(Ba,Oa),la=y(Oa,Oa),Aa=y(y(ta,Ka),la);Aa=R(Aa,C(2,y(y(Ja,Ra),la)));Aa=R(Aa,C(2,y(y(Ja,Ka),cb)));Aa=m(Aa,C(.5,y(y(H,Wa),la)));Aa=m(Aa,C(3,y(y(H,Ra),cb)));Aa=m(Aa,C(.5,y(y(H,Ka),Na)));cb=y(y(Z,da),Oa);cb=R(cb,y(y(U,pa),Oa));cb=R(cb,y(y(U,da),Ba));cb=y(cb,y(H,Ba));la=R(y(Z,
da),C(2,y(U,pa)));la=y(la,y(H,y(da,Ba)));Aa=w(S(q([c])),q([h.add(h.add(F(Aa,c),F(cb,f)),F(la,k))]));cb=q([f]);Aa=h.add(Aa,F(C(.5,y(y(H,H),Na)),w(S(cb),cb)));Aa=h.add(Aa,F(H,w(S(q([k])),q([h.add(F(R(R(C(2,y(Ja,Ra)),y(ta,Ka)),C(.5,y(H,Wa))),k),F(y(h.det3(c,f,k),R(y(Z,da),y(U,pa))),t(b,d)))]))));Aa=h.add(Aa,S(Aa));b=n.sqrt(y(y(da,Oa),y(R(y(Z,da),C(2,y(U,pa))),R(y(Z,Oa),C(2,y(U,Ba))))));c=w(S(q([c])),q([h.sub(F(R(y(U,m(y(pa,Oa),y(da,Ba))),y(Z,y(da,Oa))),c),F(H,h.add(F(Ba,f),F(pa,k))))]));c=h.add(c,F(y(Z,
H),w(S(q([f])),q([k]))));c=F(b,c);c=h.add(c,S(c));f=h.normalizeMax(h.add(Aa,c));k=h.normalizeMax(h.sub(Aa,c));a.results=cd(f,k).value};v.ConicBy1Pol1P2L.stateSize=cd.stateSize;v._helper.coHarmonic=function(a,b,c,d){const f=h.realVector([100*Math.random(),100*Math.random(),1]);var k=h.det3(f,c,a);const m=h.det3(f,c,b);c=h.det3(f,d,a);d=h.det3(f,d,b);d=n.sqrt(n.mult(d,m));k=n.sqrt(n.mult(c,k));a=p.mult(a,d);k=p.mult(b,k);b=h.add(a,k);a=h.sub(a,k);return[b,a]};v.ConicInSquare={};v.ConicInSquare.kind=
"C";v.ConicInSquare.signature=["P","P","P","P"];v.ConicInSquare.updatePosition=function(a){var b=K.basismap(E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog,E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog),c=n.one;c=v._helper.buildConicMatrix([c,c,c,n.real(-3),c,c]);b=h.adjoint3(b);b=h.productMM(h.productMM(h.transpose(b),c),b);b=h.normalizeMax(b);a.matrix=p.withUsage(b,"Conic")};v.ConicBy5lines={};v.ConicBy5lines.kind="C";v.ConicBy5lines.signature=["L","L","L","L","L"];v.ConicBy5lines.updatePosition=
function(a){var b=v._helper.ConicBy5(a,E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog,E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[4]].homog);b=h.adjoint3(b);a.matrix=b;a.matrix=h.normalizeMax(a.matrix);a.matrix=p.withUsage(a.matrix,"Conic")};v.ConicFromPrincipalDirections={};v.ConicFromPrincipalDirections.kind="C";v.ConicFromPrincipalDirections.signature=["P","P","P"];v.ConicFromPrincipalDirections.updatePosition=function(a){var b=E.csnames[a.args[0]].homog,c=E.csnames[a.args[1]].homog;
const d=E.csnames[a.args[2]].homog;var f=v._helper.pointReflection(b,c),k=h.cross(c,b);b=h.turnIntoCSList([k.value[0],k.value[1],n.zero]);k=h.turnIntoCSList([k]);c=h.turnIntoCSList([h.cross(c,b)]);f=h.turnIntoCSList([h.cross(f,b)]);a.matrix=v._helper.conicFromTwoDegenerates(k,k,c,f,d);a.matrix=h.normalizeMax(a.matrix);a.matrix=p.withUsage(a.matrix,"Conic")};v.CircleBy3={};v.CircleBy3.kind="C";v.CircleBy3.signature=["P","P","P"];v.CircleBy3.updatePosition=function(a){const b=v._helper.ConicBy5(a,E.csnames[a.args[0]].homog,
E.csnames[a.args[1]].homog,h.ii,h.jj,E.csnames[a.args[2]].homog);a.matrix=h.normalizeMax(b);a.matrix=p.withUsage(a.matrix,"Circle")};v.ArcBy3={};v.ArcBy3.kind="C";v.ArcBy3.signature=["P","P","P"];v.ArcBy3.updatePosition=function(a){v.CircleBy3.updatePosition(a);a.startPoint=E.csnames[a.args[0]].homog;a.viaPoint=E.csnames[a.args[1]].homog;a.endPoint=E.csnames[a.args[2]].homog};v.ArcBy3.initialize=function(a){a.startPoint=E.csnames[a.args[0]].homog;a.viaPoint=E.csnames[a.args[1]].homog;a.endPoint=E.csnames[a.args[2]].homog;
a.isArc=!0};v.PolarOfPoint={};v.PolarOfPoint.kind="L";v.PolarOfPoint.signature=["P","C"];v.PolarOfPoint.updatePosition=function(a){let b=p.mult(E.csnames[a.args[1]].matrix,E.csnames[a.args[0]].homog);b=h.normalizeMax(b);a.homog=p.withUsage(b,"Line")};v.PolarOfLine={};v.PolarOfLine.kind="P";v.PolarOfLine.signature=["L","C"];v.PolarOfLine.updatePosition=function(a){var b=E.csnames[a.args[0]];const c=h.adjoint3(E.csnames[a.args[1]].matrix);b=p.mult(c,b.homog);b=h.normalizeMax(b);a.homog=p.withUsage(b,
"Point")};v.AngleBisector={};v.AngleBisector.kind="Ls";v.AngleBisector.signature=["L","L","P"];v.AngleBisector.updatePosition=function(a){var b=E.csnames[a.args[0]].homog;const c=E.csnames[a.args[1]].homog,d=E.csnames[a.args[2]].homog;var f=h.add,k=h.sub;const m=h.abs,q=h.cross,t=h.scalmult,w=h.normalizeMax,y=h._helper.isAlmostZero,C=h.linfty,F=t(m(q(q(C,c),C)),b);b=t(m(q(q(C,b),C)),c);k=k(F,b);f=f(F,b);y(k)&&(k=q(q(q(C,f),C),d));y(f)&&(f=q(q(q(C,k),C),d));a.results=gc(w(k),w(f))};v.AngleBisector.stateSize=
gc.stateSize;v._helper.IntersectLC=function(a,b){var c=n,d=h.crossOperator(a),f=h.transpose(d);b=p.mult(f,p.mult(b,d));f=h.maxIndex(a,n.abs2);let k,m,q;0===f?(f=b.value[1].value[1],k=b.value[1].value[2],m=b.value[2].value[1],q=b.value[2].value[2],a=a.value[0]):1===f?(f=b.value[0].value[0],k=b.value[0].value[2],m=b.value[2].value[0],q=b.value[2].value[2],a=a.value[1]):(f=b.value[0].value[0],k=b.value[0].value[1],m=b.value[1].value[0],q=b.value[1].value[1],a=a.value[2]);c=c.div(c.sqrt(c.sub(c.mult(k,
m),c.mult(f,q))),a);c=h.add(b,h.scalmult(c,d));f=h.maxIndex(c,h.abs2);d=c.value[f];d=h.normalizeMax(d);d=p.withUsage(d,"Point");c=h.transpose(c);f=h.maxIndex(c,h.abs2);c=c.value[f];c=h.normalizeMax(c);c=p.withUsage(c,"Point");return[d,c]};v.IntersectLC={};v.IntersectLC.kind="Ps";v.IntersectLC.signature=["L","C"];v.IntersectLC.updatePosition=function(a){const b=v._helper.IntersectLC(E.csnames[a.args[0]].homog,E.csnames[a.args[1]].matrix);a.results=gc(b[0],b[1])};v.IntersectLC.stateSize=gc.stateSize;
v.OtherIntersectionCL={};v.OtherIntersectionCL.kind="P";v.OtherIntersectionCL.signature=["C","L","P"];v.OtherIntersectionCL.updatePosition=function(a){var b=E.csnames[a.args[2]].homog,c=v._helper.IntersectLC(E.csnames[a.args[1]].homog,E.csnames[a.args[0]].matrix);const d=c[0];c=c[1];const f=h.projectiveDistMinScal(d,b);b=h.projectiveDistMinScal(c,b);a.homog=f<b?c:d;a.homog=h.normalizeMax(a.homog);a.homog=p.withUsage(a.homog,"Point")};v.IntersectCirCir={};v.IntersectCirCir.kind="Ps";v.IntersectCirCir.signature=
["C","C"];v.IntersectCirCir.updatePosition=function(a){var b=E.csnames[a.args[0]].matrix,c=E.csnames[a.args[1]].matrix,d=h.scalmult(c.value[0].value[0],b.value[2]);c=h.scalmult(b.value[0].value[0],c.value[2]);d=h.sub(d,c);d=h.turnIntoCSList([d.value[0],d.value[1],n.realmult(.5,d.value[2])]);d=h.normalizeMax(d);b=v._helper.IntersectLC(d,b);a.results=gc(b[0],b[1])};v.IntersectCirCir.stateSize=gc.stateSize;v.OtherIntersectionCC={};v.OtherIntersectionCC.kind="P";v.OtherIntersectionCC.signature=["C","C",
"P"];v.OtherIntersectionCC.updatePosition=function(a){var b=E.csnames[a.args[0]].matrix,c=E.csnames[a.args[1]].matrix,d=E.csnames[a.args[2]].homog,f=h.scalmult(c.value[0].value[0],b.value[2]);c=h.scalmult(b.value[0].value[0],c.value[2]);f=h.sub(f,c);f=h.turnIntoCSList([f.value[0],f.value[1],n.realmult(.5,f.value[2])]);f=h.normalizeMax(f);f=v._helper.IntersectLC(f,b);b=f[0];f=f[1];c=h.projectiveDistMinScal(b,d);d=h.projectiveDistMinScal(f,d);a.homog=c<d?f:b;a.homog=h.normalizeMax(a.homog);a.homog=
p.withUsage(a.homog,"Point")};v._helper.IntersectConicConic=function(a,b){var c=a.value[0];const d=a.value[1],f=a.value[2];var k=b.value[0],m=b.value[1],q=b.value[2],t=h.det3(c,d,f),w=n.add(n.add(h.det3(c,d,q),h.det3(c,m,f)),h.det3(k,d,f));c=n.add(n.add(h.det3(c,m,q),h.det3(k,d,q)),h.det3(k,m,f));k=h.det3(k,m,q);q=n.abs2(t).value.real;m=n.abs2(k).value.real;q<m&&(q=a,a=b,b=q,q=k,k=t,t=q,q=c,c=w,w=q,q=m);1E-24>q?(t=a,w=b):(w=n.solveCubic(t,w,c,k),c=n.abs2(n.sub(w[0],w[1])).value.real,k=n.abs2(n.sub(w[0],
w[2])).value.real,m=n.abs2(n.sub(w[1],w[2])).value.real,c>k?(t=w[1],w=c>m?w[0]:w[2]):(t=w[2],w=k>m?w[0]:w[1]),t=h.add(h.scalmult(t,a),b),w=h.add(h.scalmult(w,a),b));b=v._helper.splitDegenConic(t);a=b[0];b=b[1];t=v._helper.splitDegenConic(w);c=t[0];w=t[1];t=h.cross(a,c);c=h.cross(b,c);a=h.cross(a,w);b=h.cross(b,w);t=h.normalizeMax(t);c=h.normalizeMax(c);a=h.normalizeMax(a);b=h.normalizeMax(b);t=p.withUsage(t,"Point");c=p.withUsage(c,"Point");a=p.withUsage(a,"Point");b=p.withUsage(b,"Point");return[t,
c,a,b]};v.IntersectConicConic={};v.IntersectConicConic.kind="Ps";v.IntersectConicConic.signature=["C","C"];v.IntersectConicConic.updatePosition=function(a){let b=v._helper.IntersectConicConic(E.csnames[a.args[0]].matrix,E.csnames[a.args[1]].matrix);b=ke(b[0],b[1],b[2],b[3]);a.results=b};v.IntersectConicConic.stateSize=ke.stateSize;v.SelectP={};v.SelectP.kind="P";v.SelectP.signature=["Ps"];v.SelectP.initialize=function(a){if(void 0!==a.index)return a.index-1;const b=E.csnames[a.args[0]].results.value;
a=v._helper.initializePoint(a);let c=h.projectiveDistMinScal(a,b[0]),d=0;for(let f=1;f<b.length;++f){const k=h.projectiveDistMinScal(a,b[f]);k<c&&(c=k,d=f)}return d};v.SelectP.updatePosition=function(a){a.homog=E.csnames[a.args[0]].results.value[a.param]};v.SelectL={};v.SelectL.kind="L";v.SelectL.signature=["Ls"];v.SelectL.initialize=function(a){if(void 0!==a.index)return a.index-1;const b=E.csnames[a.args[0]].results.value;a=v._helper.initializeLine(a);let c=h.projectiveDistMinScal(a,b[0]),d=0;for(let f=
1;f<b.length;++f){const k=h.projectiveDistMinScal(a,b[f]);k<c&&(c=k,d=f)}return d};v.SelectL.updatePosition=function(a){a.homog=E.csnames[a.args[0]].results.value[a.param];a.homog=p.withUsage(a.homog,"Line")};v._helper.moebiusStep=function(a,b,c){const d=n.add,f=n.sub,k=n.mult,m=a.value[0],q=a.value[1];a=a.value[2];const t=b.value[0],w=b.value[1];b=b.value[2];var y=c.value[0],C=c.value[1];const F=c.value[2];c=f(k(b,y),k(t,F));const H=f(k(b,C),k(w,F));y=f(k(m,F),k(a,y));C=f(k(q,F),k(a,C));return[f(k(m,
c),k(q,H)),d(k(q,c),k(m,H)),k(a,c),k(a,H),f(k(t,y),k(w,C)),d(k(w,y),k(t,C)),k(b,y),k(b,C)]};v.TrMoebius={};v.TrMoebius.kind="Mt";v.TrMoebius.signature="PPPPPP".split("");v.TrMoebius.updatePosition=function(a){var b=n.neg;const c=v._helper.moebiusStep(E.csnames[a.args[0]].homog,E.csnames[a.args[2]].homog,E.csnames[a.args[4]].homog);var d=v._helper.moebiusStep(E.csnames[a.args[1]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[5]].homog);d=h.normalizeMax(h.matrix([[d[0],b(d[1]),d[4],b(d[5])],[d[1],
d[0],d[5],d[4]],[d[2],b(d[3]),d[6],b(d[7])],[d[3],d[2],d[7],d[6]]]));b=h.normalizeMax(h.matrix([[c[6],b(c[4])],[c[7],b(c[5])],[b(c[2]),c[0]],[b(c[3]),c[1]]]));b=h.normalizeMax(h.productMM(d,b));a.moebius={anti:!1,ar:b.value[0].value[0],ai:b.value[1].value[0],br:b.value[0].value[1],bi:b.value[1].value[1],cr:b.value[2].value[0],ci:b.value[3].value[0],dr:b.value[2].value[1],di:b.value[3].value[1]};v._helper.moebiusPair(a)};v._helper.moebiusPair=function(a){var b=a.moebius;const c=n.neg,d=b.anti?c:p.identity;
b=h.normalizeMax(h.turnIntoCSList([h.matrix([[c(b.cr),d(b.ci),c(b.dr)],[b.ci,d(b.cr),b.di],[b.ar,c(d(b.ai)),b.br]]),h.matrix([[c(b.ci),c(d(b.cr)),c(b.di)],[c(b.cr),d(b.ci),c(b.dr)],[b.ai,d(b.ar),b.bi]])]));a.mat1=b.value[0];a.mat2=b.value[1]};v._helper.inverseMoebius=function(a){const b=n.neg,c=a.anti?b:p.identity;return{anti:a.anti,ar:a.dr,ai:c(a.di),br:b(a.br),bi:b(c(a.bi)),cr:b(a.cr),ci:b(c(a.ci)),dr:a.ar,di:c(a.ai)}};v.TrInverseMoebius={};v.TrInverseMoebius.kind="Mt";v.TrInverseMoebius.signature=
["Mt"];v.TrInverseMoebius.updatePosition=function(a){a.moebius=v._helper.inverseMoebius(E.csnames[a.args[0]].moebius);v._helper.moebiusPair(a)};v.TrMoebiusP={};v.TrMoebiusP.kind="P";v.TrMoebiusP.signature=["Mt","P"];v.TrMoebiusP.updatePosition=function(a){var b=E.csnames[a.args[0]];const c=E.csnames[a.args[1]].homog,d=h.productMV(b.mat1,c);b=h.productMV(b.mat2,c);a.homog=h.normalizeMax(h.cross(d,b));a.homog=p.withUsage(a.homog,"Point")};v._helper.TrMoebiusP=function(a,b){const c=h.productMV(b.mat1,
a);a=h.productMV(b.mat2,a);return h.normalizeMax(h.cross(c,a))};v.TrMoebiusL={};v.TrMoebiusL.kind="C";v.TrMoebiusL.signature=["Mt","L"];v.TrMoebiusL.updatePosition=function(a){var b=E.csnames[a.args[0]],c=E.csnames[a.args[1]].homog;const d=function(){const m=h.realVector([Math.random()-.5,Math.random()-.5,Math.random()-.5]);return h.normalizeMax(m)};var f=h.cross(d(),c),k=h.cross(d(),c);c=h.cross(d(),c);f=v._helper.TrMoebiusP(f,b);k=v._helper.TrMoebiusP(k,b);b=v._helper.TrMoebiusP(c,b);a.matrix=h.normalizeMax(v._helper.ConicBy5(null,
f,k,b,h.ii,h.jj));a.matrix=p.withUsage(a.matrix,"Circle")};v.TrMoebiusS={};v.TrMoebiusS.kind="C";v.TrMoebiusS.signature=["Mt","S"];v.TrMoebiusS.updatePosition=function(a){var b=E.csnames[a.args[0]],c=E.csnames[a.args[1]],d=c.startpos;c=c.endpos;var f=h.add(d,c);d=v._helper.TrMoebiusP(d,b);f=v._helper.TrMoebiusP(f,b);b=v._helper.TrMoebiusP(c,b);a.startPoint=d;a.viaPoint=f;a.endPoint=b;a.isArc=!0;a.matrix=h.normalizeMax(v._helper.ConicBy5(null,d,f,b,h.ii,h.jj));a.matrix=p.withUsage(a.matrix,"Circle")};
v.TrMoebiusC={};v.TrMoebiusC.kind="C";v.TrMoebiusC.signature=["Mt","C"];v.TrMoebiusC.signatureConstraints=function(a){return"Circle"===E.csnames[a.args[1]].matrix.usage};v.TrMoebiusC.updatePosition=function(a){var b=E.csnames[a.args[0]],c=E.csnames[a.args[1]].matrix,d=function(){const k=h.realVector([Math.random()-.5,Math.random()-.5,Math.random()-.5]);return h.normalizeMax(k)},f=v._helper.IntersectLC(d(),c);d=v._helper.IntersectLC(d(),c);c=f[1];d=d[1];f=v._helper.TrMoebiusP(f[0],b);c=v._helper.TrMoebiusP(c,
b);b=v._helper.TrMoebiusP(d,b);a.matrix=h.normalizeMax(v._helper.ConicBy5(null,f,c,b,h.ii,h.jj));a.matrix=p.withUsage(a.matrix,"Circle")};v.TrMoebiusArc={};v.TrMoebiusArc.kind="C";v.TrMoebiusArc.signature=["Mt","C"];v.TrMoebiusArc.signatureConstraints=function(a){return E.csnames[a.args[1]].isArc};v.TrMoebiusArc.updatePosition=function(a){var b=E.csnames[a.args[0]],c=E.csnames[a.args[1]],d=c.viaPoint;const f=c.endPoint;c=v._helper.TrMoebiusP(c.startPoint,b);d=v._helper.TrMoebiusP(d,b);b=v._helper.TrMoebiusP(f,
b);a.startPoint=c;a.viaPoint=d;a.endPoint=b;a.isArc=!0;a.matrix=h.normalizeMax(v._helper.ConicBy5(null,c,d,b,h.ii,h.jj));a.matrix=p.withUsage(a.matrix,"Circle")};v._helper.trBuildMatrix=function(a,b){const c=b(0);b=b(1);let d=h.productMM(b,h.adjoint3(c));a.matrix=h.normalizeMax(d);d=h.transpose(h.productMM(c,h.adjoint3(b)));a.dualMatrix=h.normalizeMax(d)};v.TrProjection={};v.TrProjection.kind="Tr";v.TrProjection.signature="PPPPPPPP".split("");v.TrProjection.initialize=function(a){a.isEuclidean=0};
v.TrProjection.updatePosition=function(a){v._helper.trBuildMatrix(a,function(b){return K.basismap(E.csnames[a.args[0+b]].homog,E.csnames[a.args[2+b]].homog,E.csnames[a.args[4+b]].homog,E.csnames[a.args[6+b]].homog)})};v.TrAffine={};v.TrAffine.kind="Tr";v.TrAffine.signature="PPPPPP".split("");v.TrAffine.initialize=function(a){a.isEuclidean=0};v.TrAffine.updatePosition=function(a){const b=n.mult,c=h.scalmult,d=h.turnIntoCSList;var f=h.transpose;const k=h.normalizeMax,m=h.productMM,q=h.adjoint3,t=d([E.csnames[a.args[0]].homog,
E.csnames[a.args[2]].homog,E.csnames[a.args[4]].homog]),w=d([E.csnames[a.args[1]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[5]].homog]);var y=f(t);f=f(w);const C=y.value[2].value,F=f.value[2].value,H=[b(C[0],F[2]),b(C[1],F[0]),b(C[2],F[1])];y=q(y).value;a.matrix=k(m(f,d([c(b(H[0],F[1]),y[0]),c(b(H[1],F[2]),y[1]),c(b(H[2],F[0]),y[2])])));y=t.value;a.dualMatrix=k(m(q(w),d([c(b(C[2],H[1]),y[0]),c(b(C[0],H[2]),y[1]),c(b(C[1],H[0]),y[2])])))};v.TrSimilarity={};v.TrSimilarity.kind="Tr";v.TrSimilarity.signature=
["P","P","P","P"];v.TrSimilarity.initialize=function(a){a.isEuclidean=1};v.TrSimilarity.updatePosition=function(a){v._helper.trBuildMatrix(a,function(b){return K.basismap(E.csnames[a.args[0+b]].homog,E.csnames[a.args[2+b]].homog,h.ii,h.jj)})};v.TrTranslation={};v.TrTranslation.kind="Tr";v.TrTranslation.signature=["P","P"];v.TrTranslation.initialize=function(a){a.isEuclidean=1};v.TrTranslation.updatePosition=function(a){var b=E.csnames[a.args[0]].homog,c=E.csnames[a.args[1]].homog,d=h.cross(b,c).value;
b=n.mult(b.value[2],c.value[2]);c=h.turnIntoCSList;const f=n.neg,k=n.zero;d=c([c([b,k,d[1]]),c([k,b,f(d[0])]),c([k,k,b])]);d=h.normalizeMax(d);a.matrix=d;b=f(d.value[0].value[0]);d=c([c([b,k,k]),c([k,b,k]),c([d.value[0].value[2],d.value[1].value[2],b])]);a.dualMatrix=d};v.TrRotationPNumb={};v.TrRotationPNumb.kind="Tr";v.TrRotationPNumb.signature=["P","V"];v.TrRotationPNumb.updatePosition=function(a){var b=E.csnames[a.args[0]].homog.value,c=E.csnames[a.args[1]].value,d=n.mult;const f=n.add,k=n.sub,
m=h.turnIntoCSList,q=h.normalizeMax,t=n.zero;var w=b[0],y=b[1];b=b[2];var C=n.cos(c),F=n.sin(c),H=k(n.real(1),C);c=d(H,w);H=d(H,y);w=d(F,w);y=d(F,y);C=d(C,b);d=d(F,b);F=n.neg(d);a.matrix=q(m([m([C,F,f(c,y)]),m([d,C,k(H,w)]),m([t,t,b])]));a.dualMatrix=q(m([m([C,F,t]),m([d,C,t]),m([k(c,y),f(H,w),b])]))};v.TrReflectionP={};v.TrReflectionP.kind="Tr";v.TrReflectionP.signature=["P"];v.TrReflectionP.initialize=function(a){a.isEuclidean=1};v.TrReflectionP.updatePosition=function(a){var b=E.csnames[a.args[0]].homog.value;
const c=n.realmult(-.5,b[2]),d=n.zero;b=h.turnIntoCSList([h.turnIntoCSList([c,d,b[0]]),h.turnIntoCSList([d,c,b[1]]),h.turnIntoCSList([d,d,n.neg(c)])]);b=h.normalizeMax(b);a.matrix=b;a.dualMatrix=h.transpose(b)};v.TrReflectionL={};v.TrReflectionL.kind="Tr";v.TrReflectionL.signature=["L"];v.TrReflectionL.initialize=function(a){a.isEuclidean=-1};v.TrReflectionL.updatePosition=function(a){var b=n.mult;const c=n.realmult,d=n.zero;var f=E.csnames[a.args[0]].homog.value;const k=f[0],m=f[1];f=f[2];const q=
b(k,k),t=b(m,m),w=c(-.5,n.sub(q,t)),y=b(k,m);b=h.turnIntoCSList([h.turnIntoCSList([n.neg(w),y,b(k,f)]),h.turnIntoCSList([y,w,b(m,f)]),h.turnIntoCSList([d,d,c(-.5,n.add(q,t))])]);b=h.normalizeMax(b);a.matrix=b;a.dualMatrix=h.transpose(b)};v.TrReflectionS={};v.TrReflectionS.kind="Tr";v.TrReflectionS.signature=["S"];v.TrReflectionS.updatePosition=v.TrReflectionL.updatePosition;v.TrReflectionC={};v.TrReflectionC.kind="Mt";v.TrReflectionC.signature=["C"];v.TrReflectionC.signatureConstraints=function(a){return"Circle"===
E.csnames[a.args[0]].matrix.usage};v.TrReflectionC.updatePosition=function(a){const b=E.csnames[a.args[0]].matrix,c=b.value[0].value[2],d=b.value[1].value[2],f=n.neg;a.moebius={anti:!0,ar:c,ai:d,br:b.value[2].value[2],bi:n.zero,cr:f(b.value[0].value[0]),ci:n.zero,dr:f(c),di:d};v._helper.moebiusPair(a)};v.TrInverse={};v.TrInverse.kind="Tr";v.TrInverse.signature=["Tr"];v.TrInverse.initialize=function(a){a.isEuclidean=E.csnames[a.args[0]].isEuclidean};v.TrInverse.updatePosition=function(a){const b=E.csnames[a.args[0]];
a.dualMatrix=h.transpose(b.matrix);a.matrix=h.transpose(b.dualMatrix)};v.TransformC={};v.TransformC.kind="C";v.TransformC.signature=["Tr","C"];v.TransformC.updatePosition=function(a){var b=E.csnames[a.args[0]].dualMatrix;b=h.productMM(h.productMM(b,E.csnames[a.args[1]].matrix),h.transpose(b));b=h.normalizeMax(b);a.matrix=p.withUsage(b,"Conic")};v.TransformArc={};v.TransformArc.kind="C";v.TransformArc.signature=["Tr","C"];v.TransformArc.signatureConstraints=function(a){return E.csnames[a.args[0]].isArc};
v.TransformArc.updatePosition=function(a){var b=E.csnames[a.args[0]].matrix,c=E.csnames[a.args[1]],d=c.viaPoint;const f=c.endPoint;c=h.normalizeMax(h.productMV(b,c.startPoint));d=h.normalizeMax(h.productMV(b,d));b=h.normalizeMax(h.productMV(b,f));a.startPoint=c;a.viaPoint=d;a.endPoint=b;a.isArc=!0;a.matrix=h.normalizeMax(v._helper.ConicBy5(null,c,d,b,h.ii,h.jj));a.matrix=p.withUsage(a.matrix,"Circle")};v.TransformP={};v.TransformP.kind="P";v.TransformP.signature=["Tr","P"];v.TransformP.updatePosition=
function(a){a.homog=h.normalizeMax(h.productMV(E.csnames[a.args[0]].matrix,E.csnames[a.args[1]].homog));a.homog=p.withUsage(a.homog,"Point")};v.TransformL={};v.TransformL.kind="L";v.TransformL.signature=["Tr","L"];v.TransformL.updatePosition=function(a){a.homog=h.normalizeMax(h.productMV(E.csnames[a.args[0]].dualMatrix,E.csnames[a.args[1]].homog));a.homog=p.withUsage(a.homog,"Line")};v.TransformS={};v.TransformS.kind="S";v.TransformS.signature=["Tr","S"];v.TransformS.updatePosition=function(a){const b=
E.csnames[a.args[0]],c=E.csnames[a.args[1]];v.Segment.setSegmentPos(a,h.productMV(b.dualMatrix,c.homog),h.productMV(b.matrix,c.startpos),h.productMV(b.matrix,c.endpos))};v.TransformPolygon={};v.TransformPolygon.kind="Poly";v.TransformPolygon.signature=["Tr","Poly"];v.TransformPolygon.updatePosition=function(a){const b=E.csnames[a.args[0]].matrix;a.vertices=h.turnIntoCSList(E.csnames[a.args[1]].vertices.value.map(function(c){c=h.normalizeMax(h.productMV(b,c));return c=p.withUsage(c,"Point")}))};v.TrComposeTrTr=
{};v.TrComposeTrTr.kind="Tr";v.TrComposeTrTr.signature=["Tr","Tr"];v.TrComposeTrTr.initialize=function(a){a.isEuclidean=E.csnames[a.args[0]].isEuclidean*E.csnames[a.args[1]].isEuclidean};v.TrComposeTrTr.updatePosition=function(a){const b=E.csnames[a.args[0]],c=E.csnames[a.args[1]];a.matrix=h.normalizeMax(h.productMM(c.matrix,b.matrix));a.dualMatrix=h.normalizeMax(h.productMM(c.dualMatrix,b.dualMatrix))};v._helper.composeMtMt=function(a,b,c){function d(C,F,H,R){return m(t(C,F),t(H,R))}function f(C,
F,H,R,S,Z,U,pa){return m(d(C,F,H,R),d(S,Z,U,pa))}function k(C,F,H,R,S,Z,U,pa){return q(d(C,F,H,R),d(S,Z,U,pa))}const m=n.add,q=n.sub,t=n.mult;var w=c.anti?k:f;const y=c.anti?f:k;w=h.normalizeMax(h.turnIntoCSList([y(b.ar,c.ar,b.cr,c.br,b.ai,c.ai,b.ci,c.bi),w(b.ar,c.ai,b.cr,c.bi,b.ai,c.ar,b.ci,c.br),y(b.br,c.ar,b.dr,c.br,b.bi,c.ai,b.di,c.bi),w(b.br,c.ai,b.dr,c.bi,b.bi,c.ar,b.di,c.br),y(b.ar,c.cr,b.cr,c.dr,b.ai,c.ci,b.ci,c.di),w(b.ar,c.ci,b.cr,c.di,b.ai,c.cr,b.ci,c.dr),y(b.br,c.cr,b.dr,c.dr,b.bi,c.ci,
b.di,c.di),w(b.br,c.ci,b.dr,c.di,b.bi,c.cr,b.di,c.dr)])).value;a.moebius={anti:b.anti!==c.anti,ar:w[0],ai:w[1],br:w[2],bi:w[3],cr:w[4],ci:w[5],dr:w[6],di:w[7]};v._helper.moebiusPair(a)};v._helper.euc2moeb=function(a){const b=a.matrix.value;return{anti:0>a.isEuclidean,ar:b[0].value[0],ai:b[1].value[0],br:b[0].value[2],bi:b[1].value[2],cr:n.zero,ci:n.zero,dr:b[2].value[2],di:n.zero}};v.TrComposeMtMt={};v.TrComposeMtMt.kind="Mt";v.TrComposeMtMt.signature=["Mt","Mt"];v.TrComposeMtMt.updatePosition=function(a){v._helper.composeMtMt(a,
E.csnames[a.args[0]].moebius,E.csnames[a.args[1]].moebius)};v.TrComposeTrMt={};v.TrComposeTrMt.kind="Mt";v.TrComposeTrMt.signature=["Tr","Mt"];v.TrComposeTrMt.signatureConstraints=function(a){return!!E.csnames[a.args[0]].isEuclidean};v.TrComposeTrMt.updatePosition=function(a){v._helper.composeMtMt(a,v._helper.euc2moeb(E.csnames[a.args[0]]),E.csnames[a.args[1]].moebius)};v.TrComposeMtTr={};v.TrComposeMtTr.kind="Mt";v.TrComposeMtTr.signature=["Mt","Tr"];v.TrComposeMtTr.signatureConstraints=function(a){return!!E.csnames[a.args[1]].isEuclidean};
v.TrComposeMtTr.updatePosition=function(a){v._helper.composeMtMt(a,E.csnames[a.args[0]].moebius,v._helper.euc2moeb(E.csnames[a.args[1]]))};v._helper.pointReflection=function(a,b){return h.normalizeMax(h.sub(h.scalmult(n.realmult(2,b.value[2]),a),h.scalmult(a.value[2],b)))};v._helper.conicOtherIntersection=function(a,b,c){var d=h.productMV(a,c);a=h.scalproduct(c,d);d=h.scalproduct(b,d);d=n.realmult(-2,d);b=h.scalmult(a,b);c=h.scalmult(d,c);c=h.add(b,c);return c=h.normalizeMax(c)};v.Dist={};v.Dist.kind=
"V";v.Dist.signature=["P","P"];v.Dist.updatePosition=function(a){const b=E.csnames[a.args[1]].homog;a.value=h.abs(h.sub(h.normalizeZ(E.csnames[a.args[0]].homog),h.normalizeZ(b)))};v.Angle={};v.Angle.kind="V";v.Angle.signature=["L","L","P"];v.Angle.initialize=function(a){void 0===a.angle&&(a.angle=.5*Math.PI);wc(n._helper.input(a.angle))};v.Angle.updatePosition=function(a){var b=E.csnames[a.args[1]].homog,c=E.csnames[a.args[2]].homog,d=h.cross(E.csnames[a.args[0]].homog,h.linfty);b=h.cross(b,h.linfty);
c=h.crossratio3(d,b,h.ii,h.jj,c);c=n.mult(n.complex(0,.5),n.log(c));d=(bd().value.real-c.value.real)/Math.PI;b=Math.round(d);!ld&&.01<Math.abs(b-d)&&Hd();c=n.complex(b*Math.PI+c.value.real,c.value.imag);wc(c);a.value=p.withUsage(c,"Angle")};v.Angle.stateSize=2;v.Text={};v.Text.kind="Text";v.Text.signature="**";v.Text.isMovable=!0;v.Text.updatePosition=bc;v.Text.initialize=function(a){a.text=String(a.text);a.pos&&(a.homog=v._helper.initializePoint(a));a.dock&&(a.dock.offset=a.dock.offset&&2===a.dock.offset.length?
h.realVector([+a.dock.offset[0],+a.dock.offset[1]]):h.realVector([0,0]))};v.Text.set_text=function(a,b){a.text=ja(b)};v.Text.getParamForInput=function(a,b,c){return v.Free.getParamForInput(a,b,c)};v.Text.getParamFromState=function(a){return a.homog};v.Text.putParamToState=function(a,b){a.homog=b};v.Calculation={};v.Calculation.kind="Text";v.Calculation.signature="**";v.Calculation.isMovable=!0;v.Calculation.updatePosition=bc;v.Calculation.initialize=function(a){v.Text.initialize(a);a.calculation=
uc(a.text)};v.Calculation.getText=function(a){return ja(L(a.calculation))};v.Calculation.getParamForInput=v.Text.getParamForInput;v.Calculation.getParamFromState=v.Text.getParamFromState;v.Calculation.putParamToState=v.Text.putParamToState;v.Equation={};v.Equation.kind="Text";v.Equation.isMovable=!0;v.Equation.signature="**";v.Equation.updatePosition=bc;v.Equation.initialize=function(a){v.Text.initialize(a);a.calculation=uc(a.text)};v.Equation.getText=function(a){return a.text+" = "+ja(L(a.calculation))};
v.Equation.getParamForInput=v.Text.getParamForInput;v.Equation.getParamFromState=v.Text.getParamFromState;v.Equation.putParamToState=v.Text.putParamToState;v.Evaluate={};v.Evaluate.kind="Text";v.Evaluate.isMovable=!0;v.Evaluate.signature="**";v.Evaluate.updatePosition=bc;v.Evaluate.initialize=function(a){v.Text.initialize(a);a.calculation=uc(a.text)};v.Evaluate.getText=function(a){L(a.calculation);return a.text};v.Evaluate.getParamForInput=v.Text.getParamForInput;v.Evaluate.getParamFromState=v.Text.getParamFromState;
v.Evaluate.putParamToState=v.Text.putParamToState;v.Plot={};v.Plot.kind="Text";v.Plot.isMovable=!0;v.Plot.signature="**";v.Plot.updatePosition=bc;v.Plot.initialize=function(a){v.Text.initialize(a);a.calculation=uc("plot(("+a.text+"))")};v.Plot.getText=function(a){L(a.calculation);return a.text};v.Plot.getParamForInput=v.Text.getParamForInput;v.Plot.getParamFromState=v.Text.getParamFromState;v.Plot.putParamToState=v.Text.putParamToState;v.Button={};v.Button.kind="Text";v.Button.signature="**";v.Button.isMovable=
!0;v.Button.updatePosition=bc;v.Button.initialize=function(a){const b=document.createElement("button");ud(a,"click",b)};v.Button.getParamForInput=v.Text.getParamForInput;v.Button.getParamFromState=v.Text.getParamFromState;v.Button.putParamToState=v.Text.putParamToState;v.Button.set_fillcolor=function(a,b){h._helper.isNumberVecN(b,3)&&(a.fillcolor=b.value.map(function(c){return c.value.real}),a.html.style.backgroundColor=N.makeColor(a.fillcolor,a.fillalpha))};v.Button.set_color=function(a,b){h._helper.isNumberVecN(b,
3)&&(a.color=b.value.map(function(c){return c.value.real}),a.html.style.color=N.makeColor(a.color,a.alpha))};v.ToggleButton={};v.ToggleButton.kind="Text";v.ToggleButton.signature="**";v.ToggleButton.isMovable=!0;v.ToggleButton.updatePosition=bc;v.ToggleButton.initialize=function(a){var b=void 0;void 0===b&&(b="CindyJSid");b+=++$a;const c=document.createElement("input"),d=document.createElement("label");c.setAttribute("id",b);d.setAttribute("for",b);c.setAttribute("type","checkbox");a.pressed&&(c.checked=
!0);a.checkbox=c;ud(a,"change",c,d)};v.ToggleButton.get_text=function(a){return p.string(String(a.text))};v.ToggleButton.set_currenttext=function(a,b){a.html.value=a.text=ja(b)};v.ToggleButton.getParamForInput=v.Text.getParamForInput;v.ToggleButton.getParamFromState=v.Text.getParamFromState;v.ToggleButton.putParamToState=v.Text.putParamToState;v.ToggleButton.set_fillcolor=v.Button.set_fillcolor;v.ToggleButton.set_color=v.Button.set_color;v.ToggleButton.set_text=v.ToggleButton.set_currenttext;v.ToggleButton.get_val=
v.ToggleButton.get_text;v.ToggleButton.set_val=v.ToggleButton.set_currenttext;v.EditableText={};v.EditableText.kind="Text";v.EditableText.isMovable=!0;v.EditableText.signature=[];v.EditableText.updatePosition=bc;v.EditableText.initialize=function(a){const b=document.createElement("input");b.setAttribute("type","text");b.className="CindyJS-editabletext";Wb(a.minwidth)&&(b.style.width=a.minwidth-3+"px");"string"===typeof a.text&&(b.value=a.text);b.addEventListener("keydown",function(c){13===c.keyCode&&
(a.text=a.html.value,b.blur())});b.addEventListener("change",function(c){a.text=a.html.value});ud(a,"change",b)};v.EditableText.getText=function(a){return!1};v.EditableText.getParamForInput=v.Text.getParamForInput;v.EditableText.getParamFromState=v.Text.getParamFromState;v.EditableText.putParamToState=v.Text.putParamToState;v.EditableText.set_fillcolor=v.Button.set_fillcolor;v.EditableText.set_color=v.Button.set_color;v.EditableText.get_currenttext=function(a){return p.string(String(a.html.value))};
v.EditableText.get_text=v.ToggleButton.get_text;v.EditableText.set_currenttext=v.ToggleButton.set_currenttext;v.EditableText.set_text=v.EditableText.set_currenttext;v.EditableText.get_val=v.EditableText.get_text;v.EditableText.set_val=v.EditableText.set_currenttext;v._helper.initializePoint=function(a){let b=0,c=0,d=0;if(a.pos){if("list"===a.pos.ctype&&h.isNumberVector(a.pos))return a.pos;2===a.pos.length&&(b=a.pos[0],c=a.pos[1],d=1);3===a.pos.length&&(b=a.pos[0],c=a.pos[1],d=a.pos[2])}a=h.turnIntoCSList([n._helper.input(b),
n._helper.input(c),n._helper.input(d)]);return a=h.normalizeMax(a)};v._helper.initializeLine=function(a){let b=0,c=0,d=0;if(a.pos){if("list"===a.pos.ctype&&h.isNumberVector(a.pos))return a.pos;3===a.pos.length&&(b=a.pos[0],c=a.pos[1],d=a.pos[2])}a=h.turnIntoCSList([n._helper.input(b),n._helper.input(c),n._helper.input(d)]);return a=h.normalizeMax(a)};v.Poly={};v.Poly.kind="Poly";v.Poly.signature="P*";v.Poly.updatePosition=function(a){a.vertices=h.turnIntoCSList(a.args.map(function(b){return E.csnames[b].homog}))};
let bb=null;v.IFS={};v.IFS.kind="IFS";v.IFS.signature="**";v.IFS.signatureConstraints=function(a){for(let b=0;b<a.args.length;++b){const c=E.csnames[a.args[b]].kind;if("Tr"!==c&&"Mt"!==c)return!1}return 0<a.args.length};v.IFS.initialize=function(a){if(bb)bb.dirty=!0;else if(a=Ob.getBaseDir(),!1!==a){bb={dirty:!1,params:{generation:0}};var b=bb.worker=new Worker(a+"ifs.js");b.onmessage=function(c){bb.img&&"function"===typeof bb.img.close&&bb.img.close();if(!zd){c=c.data;if(c.generation===bb.params.generation){if(c.buffer){bb.canvas||
(bb.canvas=document.createElement("canvas"),bb.ctx=bb.canvas.getContext("2d"));bb.canvas.width=c.width;bb.canvas.height=c.height;var d=new Uint8ClampedArray(c.buffer,c.imgPtr,c.width*c.height*4);d=new ImageData(d,c.width,c.height);bb.ctx.putImageData(d,0,0);bb.img=bb.canvas}else bb.img=c.img;x()}else bb.img=null;c.buffer?b.postMessage({cmd:"next",buffer:c.buffer},[c.buffer]):b.postMessage({cmd:"next"})}};Gc.push(b.terminate.bind(b))}};v.IFS.updatePosition=function(a){bb.dirty=!0};v.IFS.updateParameters=
function(){if(bb.worker){var a={cmd:"init",generation:bb.params.generation,width:Math.round(4*gb),height:Math.round(4*ib)};a.systems=E.ifs.map(function(b){let c=0;var d;const f=b.ifs||[],k=b.args.map(function(w,y){w=f[y]||{};return{prob:w.prob||1,color:w.color||[0,0,0]}});for(d=0;d<k.length;++d)c+=k[d].prob;d=h.realMatrix([[1,0,0],[0,1,0],[0,0,4]]);const m=h.productMM(O.toMat(),d);for(d=0;d<b.args.length;++d){var q=E.csnames[b.args[d]],t=q.kind;const w=k[d];w.kind=t;w.prob/=c;if("Tr"===t)q=h.normalizeMax(h.productMM(h.adjoint3(m),
h.productMM(q.matrix,m))),h._helper.isAlmostReal(q)?w.mat=q.value.map(function(y){return y.value.map(function(C){return C.value.real})}):w.kind="cplx";else if("Mt"===t){t=O.drawingstate.matrix;t={anti:0<t.det,ar:n.real(t.a),ai:n.real(t.c),br:n.real(t.tx),bi:n.real(-t.ty),cr:n.zero,ci:n.zero,dr:n.real(.25),di:n.zero};const y={};v._helper.composeMtMt(y,q.moebius,t);t=v._helper.inverseMoebius(t);v._helper.composeMtMt(y,t,y.moebius);t=y.moebius;t=h.turnIntoCSList([t.ar,t.ai,t.br,t.bi,t.cr,t.ci,t.dr,t.di]);
h._helper.isAlmostReal(t)?(t=t.value,w.moebius={ar:t[0].value.real,ai:t[1].value.real,br:t[2].value.real,bi:t[3].value.real,cr:t[4].value.real,ci:t[5].value.real,dr:t[6].value.real,di:t[7].value.real,sign:q.moebius.anti?-1:1}):w.kind="cplx"}}return{trafos:k}});p.deeplyEqual(a,bb.params)||(++a.generation,bb.img=null,bb.params=a,bb.mat=O.drawingstate.matrix,bb.worker.postMessage(a))}};v.IFS.probSetter=function(a,b,c){"number"===c.ctype&&(b.ifs[a].prob=c.value.real,bb.dirty=!0)};(function(){for(let a=
0;10>a;++a)v.IFS["set_prob"+a]=v.IFS.probSetter.bind(null,a)})();v._helper.snapPointToLine=function(a,b){if(n._helper.isAlmostZero(a.value[2]))return a;var c=v._helper.projectPointToLine(a,b);c=h.normalizeZ(c);const d=c.value[0].value.real;c=c.value[1].value.real;const f=Math.round(d/Rb)*Rb,k=Math.round(c/Rb)*Rb,m=h.realVector([f,k,1]);Math.abs(f-d)<id&&Math.abs(k-c)<id&&n._helper.isAlmostZero(h.scalproduct(b,m))&&(a=v._helper.projectPointToLine(m,b));return a};const Xd={CircleByRadius:"CircleMr",
IntersectionCircleCircle:"IntersectCirCir",IntersectionConicConic:"IntersectConicConic",FreePoint:"Free",Orthogonal:"Perp",Parallel:"Para",Pole:"PolarOfLine",Polar:"PolarOfPoint",Arc:"ArcBy3",EuclideanMid:"Mid",AngularBisector:"AngleBisector",TransformConic:"TransformC",TransformSegment:"TransformS",TrMoebiusSegment:"TrMoebiusS",ReflectCC:"TrMoebiusC",ReflectCL:"TrMoebiusL",ReflectCP:"TrMoebiusP",ReflectCArc:"TrMoebiusArc",ReflectCS:"TrMoebiusS",TrMoebiusCircle:"TrMoebiusC"},uf={CircleMFixedr:function(a){a.pinned=
!0;a.type="CircleMr";return[a]},CircleByFixedRadius:function(a){a.pinned=!0;a.type="CircleMr";return[a]},IntersectionConicLine:function(a){a.args=[a.args[1],a.args[0]];a.type="IntersectLC";return[a]},angleBisector:function(a){const b={name:a.name+"_Intersection",type:"Meet",args:a.args,visible:!1};a.type="AngleBisector";a.args=[a.args[0],a.args[1],b.name];return[b,a]},Transform:function(a){var b=E.csnames[a.args[1]];b={Tr:"Transform",Mt:"TrMoebius"}[E.csnames[a.args[0]].kind]+(b.isArc?"Arc":b.kind);
if(v.hasOwnProperty(b))return a.type=b,[a];console.log(b+" not implemented yet");return[]},TrReflection:function(a){const b="TrReflection"+E.csnames[a.args[0]].kind;if(v.hasOwnProperty(b))return a.type=b,[a];console.log(b+" not implemented yet");return[]},TrCompose:function(a){const b="TrCompose"+a.args.map(function(c){return E.csnames[c].kind}).join("");if(v.hasOwnProperty(b))return a.type=b,[a];console.log(b+" not implemented yet");return[]}},Gf="align alpha angle args arrow arrowposition arrowshape arrowsides arrowsize clip color dashtype drawtrace fillalpha fillcolor filled labeled labelpos name overhang pinned printname radius size text text_fontfamily textbold textitalics textsize tracedim tracelength traceskip tracing type visible".split(" ");
Mb.saveState=function(){return{geometry:me()}};const Yb={};var If=[[],[.2],[.075,.225],[44/45,-56/15,32/9],[19372/6561,-25360/2187,64448/6561,-212/729],[9017/3168,-355/33,46732/5247,49/176,-5103/18656],[35/384,0,500/1113,125/192,-2187/6784,11/84]];var bf=[0,.2,.3,.8,8/9,1,1];var Jf=[35/384,0,500/1113,125/192,-2187/6784,11/84,0];var Kf=[5179/57600,0,7571/16695,.6140625,-92097/339200,187/2100,.025];let lc,Ib=[],xf=[],sf=!1;Yb.tick=function(a){a/=Uc;for(let b=0;b<Uc;b++)Yb.tick1(a),gd+=a,L(wa.simulationstep)};
Yb.tick1=function(a){var b=a;let c=0;for(;0<a&&c<.999*a||0>a&&c>.999*a;)b=Yb.oneRKStep(b),c+=b,b=Math.min(2*b,a-c),b=Math.max(b,1E-16),Yb.restorePosition(),Yb.doCollisions(),Yb.calculateForces(),Yb.moveToFinalPos();return!0};Yb.restorePosition=function(){lc.forEach(function(a){Ha[a.type].restorePos(a,9)})};Yb.doCollisions=function(){lc.forEach(function(a){Ha[a.type].doCollisions(a)})};Yb.calculateForces=function(){lc.forEach(function(a){Ha[a.type].calculateForces(a)})};Yb.moveToFinalPos=function(){lc.forEach(function(a){Ha[a.type].move(a)})};
Yb.oneRKStep=function(a){const b=function(w){lc.forEach(function(y){Ha[y.type].initRK(y,w);Ha[y.type].storePosition(y)})},c=function(w){lc.forEach(function(y){Ha[y.type].setToTimestep(y,bf[w])})},d=function(w){lc.forEach(function(y){Ha[y.type].proceedMotion(y,bf[w],w,If[w])})},f=function(){lc.forEach(function(w){Ha[w.type].resetForces(w)})},k=function(w){lc.forEach(function(y){Ha[y.type].calculateDelta(y,w)})},m=function(w){let y=0;lc.forEach(function(C){Ha[C.type].proceedMotion(C,bf[6],7,Jf);Ha[C.type].savePos(C,
8);Ha[C.type].proceedMotion(C,bf[6],7,Kf);Ha[C.type].savePos(C,9);y+=Ha[C.type].sqDist(C,8,9)});return y=Math.sqrt(y)/a},q=function(w){lc.forEach(function(y){Ha[y.type].recallPosition(y)})};let t=!1;for(;!t;){b(a);for(let w=0;7>w;w++)c(w),d(w),f(),Yb.calculateForces(),k(w);m(a)>Ha.env.errorbound&&a>Ha.env.lowestdeltat?(a/=Ha.env.slowdownfactor,q()):t=!0}return a};const Ha={Mass:{reset:function(a,b){a.vel=[0,0,0];a.pos=[0,0,0,0];a.el=b;"undefined"===typeof a.mass&&(a.mass=1);"undefined"===typeof a.charge&&
(a.charge=0);"undefined"===typeof a.friction&&(a.friction=0);a.lnfrict=0;"undefined"===typeof a.limitspeed&&(a.limitspeed=!1);"undefined"===typeof a.fixed&&(a.fixed=!1);"undefined"===typeof a.radius&&(a.radius=1);a.internalmove=!1;a.fx=0;a.fy=0;a.fz=0;a.vx=a.vx||0;a.vy=a.vy||0;a.vz=a.vz||0;a.mtype=0;a.env=Ha.env;a.deltat=0;a.mx=0;a.my=0;a.mz=0;a.mvx=0;a.mvy=0;a.mvz=0;a.dx=[0,0,0,0,0,0,0,0,0,0];a.dy=[0,0,0,0,0,0,0,0,0,0];a.dz=[0,0,0,0,0,0,0,0,0,0];a.dvx=[0,0,0,0,0,0,0,0,0,0];a.dvy=[0,0,0,0,0,0,0,0,
0,0];a.dvz=[0,0,0,0,0,0,0,0,0,0];a.midx=0;a.midy=0;a.midz=0;a.lx=0;a.ly=0;a.lz=0},resetForces:function(a){a.fx=0;a.fy=0;a.fz=0},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){const c=K.extractPoint(a.el.homog);a.x=c.x;a.y=c.y;a.z=0;a.xo=a.x;a.yo=a.y;a.zo=a.z;a.vxo=a.vx;a.vyo=a.vy;a.vzo=a.vz;a.deltat=b;a.fx=0;a.fy=0;a.fz=0},setVelocity:function(a,b,c,d){d||(d=0);a.vx=b;a.vy=c;a.vz=d},move:function(a){a.pos=[a.x,a.y,1];a.internalmove=!0;qb&&ab.down&&a.el===qb.mover||Qb(a.el,h.realVector(a.pos),
"homog");a.el.sx=a.x;a.el.sy=a.y;a.internalmove=!1},proceedMotion:function(a,b,c,d){if(!a.fixed)for(a.x=a.mx,a.y=a.my,a.z=a.mz,a.vx=a.mvx,a.vy=a.mvy,a.vz=a.mvz,b=0;b<c;b++)a.x+=d[b]*a.dx[b]*a.deltat,a.y+=d[b]*a.dy[b]*a.deltat,a.z+=d[b]*a.dz[b]*a.deltat,a.vx+=d[b]*a.dvx[b]*a.deltat,a.vy+=d[b]*a.dvy[b]*a.deltat,a.vz+=d[b]*a.dvz[b]*a.deltat},calculateForces:function(a){const b=Math.sqrt(a.vx*a.vx+a.vy*a.vy+a.vz*a.vz);a.lnfrict=-Math.log((1-a.friction)*(1-a.env.friction)*(.1<b&&a.limitSpeed?.1/b:1));
a.fx+=-a.vx*a.lnfrict*a.mass;a.fy+=-a.vy*a.lnfrict*a.mass;a.fz+=-a.vz*a.lnfrict*a.mass},calculateDelta:function(a,b){a.dx[b]=a.vx;a.dy[b]=a.vy;a.dz[b]=a.vz;a.dvx[b]=a.fx/a.mass;a.dvy[b]=a.fy/a.mass;a.dvz[b]=a.fz/a.mass},savePos:function(a,b){a.dx[b]=a.x;a.dy[b]=a.y;a.dz[b]=a.z;a.dvx[b]=a.vx;a.dvy[b]=a.vy;a.dvz[b]=a.vz},restorePos:function(a,b){a.fixed||(a.x=a.dx[b],a.y=a.dy[b],a.z=a.dz[b],a.vx=a.dvx[b],a.vy=a.dvy[b],a.vz=a.dvz[b])},sqDist:function(a,b,c){let d=(a.dx[b]-a.dx[c])*(a.dx[b]-a.dx[c]);
d+=(a.dy[b]-a.dy[c])*(a.dy[b]-a.dy[c]);d+=(a.dz[b]-a.dz[c])*(a.dz[b]-a.dz[c]);d+=(a.dvx[b]-a.dvx[c])*(a.dvx[b]-a.dvx[c]);d+=(a.dvy[b]-a.dvy[c])*(a.dvy[b]-a.dvy[c]);return d+=(a.dvz[b]-a.dvz[c])*(a.dvz[b]-a.dvz[c])},kineticEnergy:function(a){return.5*a.mass*(a.vx*a.vx+a.vy*a.vy+a.vz*a.vz)},storePosition:function(a){a.mx=a.x;a.my=a.y;a.mz=a.z;a.mvx=a.vx;a.mvy=a.vy;a.mvz=a.vz},recallPosition:function(a){a.fixed||(a.x=a.mx,a.y=a.my,a.z=a.mz,a.vx=a.mvx,a.vy=a.mvy,a.vz=a.mvz)},doCollisions:function(a){}},
Sun:{reset:function(a,b){a.vel=[0,0,0];a.pos=[0,0,0,0];a.el=b;"undefined"===typeof a.mass&&(a.mass=10);"undefined"===typeof a.friction&&(a.friction=0);a.charge=0;a.x=0;a.y=0;a.z=0},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){b=K.extractPoint(a.el.homog);a.x=b.x;a.y=b.y;a.z=0},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateDelta:function(a,b){},calculateForces:function(a){const b=a.x,c=a.y,d=a.z;for(const m of Ib){const q=
m.behavior.x;var f=m.behavior.y,k=m.behavior.z;const t=Math.sqrt((b-q)*(b-q)+(c-f)*(c-f)+(d-k)*(d-k));f=(c-f)*a.mass*m.behavior.mass/(t*t*t);k=(d-k)*a.mass*m.behavior.mass/(t*t*t);m.behavior.fx+=(b-q)*a.mass*m.behavior.mass/(t*t*t)*m.behavior.mass;m.behavior.fy+=f*m.behavior.mass;m.behavior.fz+=k*m.behavior.mass}},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},
Velocity:{reset:function(a){var b=E.csnames[a.geo[1]];console.log(b);const c=K.extractPoint(b.homog);a=K.extractPoint(E.csnames[a.geo[2]].homog);b=b.behavior;Ha[b.type].setVelocity(b,a.x-c.x,a.y-c.y,0)},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,d){},move:function(a){const b=E.csnames[a.geo[2]];if(!qb||!ab.down||b!==qb.mover){var c=E.csnames[a.geo[1]];a=K.extractPoint(c.homog);c=c.behavior;a=h.realVector([a.x+c.vx,a.y+c.vy,
1]);Qb(b,a,"homog")}},proceedMotion:function(a,b,c,d){},calculateForces:function(a){},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},Gravity:{reset:function(a,b){a.vel=[0,0,0];a.pos=[0,0,0,0];a.el=b;"undefined"===typeof a.strength&&(a.strength=1);a.namea=b.args[0];a.nameb=b.args[1];a.ma=E.csnames[a.namea];a.mb=E.csnames[a.nameb]},
resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateDelta:function(a,b){},calculateForces:function(a){const b=K.extractPoint(a.ma.homog),c=K.extractPoint(a.mb.homog),d=(c.x-b.x)*a.strength;a=(c.y-b.y)*a.strength;for(const f of Ib)f.behavior.fx+=d*f.behavior.mass,f.behavior.fy+=a*f.behavior.mass,f.behavior.fz+=0*f.behavior.mass},savePos:function(a,b){},restorePos:function(a,
b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},Spring:{reset:function(a,b){a.el=b;"undefined"===typeof a.strength&&(a.strength=1);"undefined"===typeof a.amplitude&&(a.amplitude=0);"undefined"===typeof a.phase&&(a.phase=0);"undefined"===typeof a.speed&&(a.speed=1);"undefined"===typeof a.l0&&(a.l0=0);"undefined"===typeof a.stype&&(a.stype=1);"undefined"===typeof a.readOnInit&&(a.readOnInit=!1);a.namea=
b.args[0];a.nameb=b.args[1];a.ma=E.csnames[a.namea];a.mb=E.csnames[a.nameb];b=K.extractPoint(a.ma.homog);const c=K.extractPoint(a.mb.homog);a.l0=Math.sqrt((b.x-c.x)*(b.x-c.x)+(b.y-c.y)*(b.y-c.y));a.env=Ha.env;a.ldiff=0},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateForces:function(a){let b;let c;if(!a.ma.behavior||qb&&ab.down&&a.ma===qb.mover){var d=K.extractPoint(a.ma.homog);
b=d.x;c=d.y}else b=a.ma.behavior.x,c=a.ma.behavior.y;if(!a.mb.behavior||qb&&ab.down&&a.mb===qb.mover){var f=K.extractPoint(a.mb.homog);d=f.x;f=f.y}else d=a.mb.behavior.x,f=a.mb.behavior.y;var k=Math.sqrt((b-d)*(b-d)+(c-f)*(c-f));let m=a.l0;a.ldiff=k-m;const q=a.stype;1===q&&(m=0);let t=0;if(2===q||3===q)t=a.ma.behavior.mass*a.mb.behavior.mass*a.strength;2===q&&(t=-t);let w,y;if(0===k||0!==q&&1!==q)if(a.ma.behavior&&a.mb.behavior&&0!==k){if(k*=k*k,2===q||3===q)w=(b-d)*t/k,y=(c-f)*t/k}else w=y=0;else w=
-(b-d)*a.strength*(k-m)/k*a.env.springstrength,y=-(c-f)*a.strength*(k-m)/k*a.env.springstrength;a.ma.behavior&&(a.ma.behavior.fx+=w,a.ma.behavior.fy+=y);a.mb.behavior&&(a.mb.behavior.fx-=w,a.mb.behavior.fy-=y)},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},det:function(a,b,c,d,f,k){return c*k-f*d+f*b-a*k+a*d-c*b},Bouncer:{reset:function(a,
b){a.el=b;"undefined"===typeof a.xdamp&&(a.xdamp=0);"undefined"===typeof a.ydamp&&(a.ydamp=0);"undefined"===typeof a.motorchanger&&(a.motorchanger=!0);a.namea=b.args[0];a.nameb=b.args[1];a.ma=E.csnames[a.namea];a.mb=E.csnames[a.nameb];b=K.extractPoint(a.ma.homog);const c=K.extractPoint(a.mb.homog);a.x1o=1.01*b.x-.01*c.x;a.y1o=1.01*b.y-.01*c.y;a.x2o=1.01*c.x-.01*b.x;a.y2o=1.01*c.y-.01*b.y;a.env=Ha.env},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){a.deltat=
b},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateForces:function(a){},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){var b=K.extractPoint(a.ma.homog),c=K.extractPoint(a.mb.homog);const d=b.x;b=b.y;const f=c.x;c=c.y;const k=a.x1o,m=a.y1o,q=a.x2o,t=a.y2o;var w=Math.sqrt((d-f)*
(d-f)+(b-c)*(b-c));const y=(d-f)/w;w=(b-c)/w;for(const R of Ib){var C=R.behavior.xo,F=R.behavior.yo,H=R.behavior.x;const S=R.behavior.y;let Z=n.mult(n.complex(k,m),n.complex(f,c)),U=n.mult(n.complex(q,t),n.complex(d,b));Z=n.sub(Z,U);U=n.mult(n.complex(C,F),n.complex(d,b));Z=n.add(Z,U);U=n.mult(n.complex(C,F),n.complex(f,c));Z=n.sub(Z,U);U=n.sub(n.complex(k,m),n.complex(q,t));Z=n.div(Z,U);0>Ha.det(d,b,f,c,H,S)*Ha.det(d,b,f,c,Z.value.real,Z.value.imag)&&0>Ha.det(d,b,H,S,Z.value.real,Z.value.imag)*Ha.det(f,
c,H,S,Z.value.real,Z.value.imag)&&(F=R.behavior.mvx+a.deltat*(-Z.value.real+R.behavior.xo),H=R.behavior.mvy+a.deltat*(-Z.value.imag+R.behavior.yo),C=y*F+w*H,F=w*F-y*H,R.behavior.x=Z.value.real,R.behavior.y=Z.value.imag,R.behavior.vx=y*C*(1-a.xdamp),R.behavior.vy=w*C*(1-a.xdamp),R.behavior.vx+=-w*F*(1-a.ydamp),R.behavior.vy+=y*F*(1-a.ydamp))}a.x1o=d;a.y1o=b;a.x2o=f;a.y2o=c}},Environment:{init:function(a){"undefined"===typeof a.gravity&&(a.gravity=0);"undefined"===typeof a.friction&&(a.friction=0);
"undefined"===typeof a.springstrength&&(a.springstrength=1);"undefined"!==typeof a.accuracy&&(Uc=a.accuracy);"undefined"!==typeof a.deltat&&Ua(a.deltat/.6);"undefined"===typeof a.charges&&(a.charges=!1);"undefined"===typeof a.balls&&(a.balls=!1);"undefined"===typeof a.newton&&(a.newton=!1);"undefined"===typeof a.ballInteractionBoosting&&(a.ballInteractionBoosting=1);Ha.env=a;a.errorbound=.001;a.lowestdeltat=1E-7;a.slowdownfactor=2},reset:function(a){},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,
b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateForces:function(a){let b;let c,d,f,k;let m,q;if(a.newton)for(b=0;b<Ib.length-1;b++){var t=Ib[b];c=t.behavior.x;d=t.behavior.y;for(f=b+1;f<Ib.length;f++){k=Ib[f];var w=k.behavior.x;var y=k.behavior.y;q=Math.sqrt((c-w)*(c-w)+(d-y)*(d-y));w=(c-w)*t.behavior.mass*k.behavior.mass/(q*q*q);y=(d-y)*t.behavior.mass*k.behavior.mass/(q*q*q);t.behavior.fx-=w;t.behavior.fy-=y;k.behavior.fx+=
w;k.behavior.fy+=y}}if(a.charges)for(b=0;b<Ib.length-1;b++)for(t=Ib[b],c=t.behavior.x,d=t.behavior.y,f=b+1;f<Ib.length;f++)k=Ib[f],w=k.behavior.x,y=k.behavior.y,q=Math.sqrt((c-w)*(c-w)+(d-y)*(d-y)),w=(c-w)*t.behavior.charge*k.behavior.charge/(q*q*q),y=(d-y)*t.behavior.charge*k.behavior.charge/(q*q*q),t.behavior.fx+=w,t.behavior.fy+=y,k.behavior.fx-=w,k.behavior.fy-=y;if(a.balls)for(b=0;b<Ib.length-1;b++)if(t=Ib[b],0!==t.behavior.radius)for(c=t.behavior.x,d=t.behavior.y,f=b+1;f<Ib.length;f++)k=Ib[f],
0!==k.behavior.radius&&(w=k.behavior.x,y=k.behavior.y,m=t.behavior.radius+k.behavior.radius,q=Math.sqrt((c-w)*(c-w)+(d-y)*(d-y)),0===a.ballInteractionBoosting?(w=(c-w)/(q*q*q)*(q>m?0:(q-m)*(q-m)),y=(d-y)/(q*q*q)*(q>m?0:(q-m)*(q-m))):1===a.ballInteractionBoosting?(w=(c-w)/(q*q*q*q)*(q>m?0:(q-m)*(q-m)),y=(d-y)/(q*q*q*q)*(q>m?0:(q-m)*(q-m))):(w=(c-w)/(q*q*q*q*q)*(q>m?0:(q-m)*(q-m)),y=(d-y)/(q*q*q*q*q)*(q>m?0:(q-m)*(q-m))),t.behavior.fx+=w,t.behavior.fy+=y,k.behavior.fx-=w,k.behavior.fy-=y);for(b=0;b<
Ib.length;b++)t=Ib[b],t.behavior.fx+=0,t.behavior.fy+=-a.gravity*t.behavior.mass,t.behavior.fz+=0},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}}};return Mb};return V}(),createCindy=CindyJS;
"undefined"!==typeof process&&"undefined"!==typeof module&&"undefined"!==typeof module.exports&&"undefined"===typeof window&&(module.exports=CindyJS);
//# sourceMappingURL=Cindy.js.map

