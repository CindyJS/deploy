/* CindyJS - (C) 2014-2016  The CindyJS Project
 * Mostly licensed under the Apache License 2.0, but subprojects may use different licensing.
 * See https://github.com/CindyJS/CindyJS/tree/1be50a7ec13826fac15537517858f65557a43b5d
 * for corresponding sources and their respective licensing conditions.
 */
/*
 npm.im/iphone-inline-video 2.0.2  npm.im/intervalometer  https://github.com/paulmillr/es6-shim
 @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
   and contributors,  MIT License
 es6-shim: v0.35.4
 see https://github.com/paulmillr/es6-shim/blob/0.35.3/LICENSE
 Details and documentation:
 https://github.com/paulmillr/es6-shim/
 https://github.com/es-shims/es7-shim
 @license es7-shim Copyright 2014 by contributors, MIT License
 see https://github.com/es-shims/es7-shim/blob/master/LICENSE
*/
'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,l,h){b!=Array.prototype&&b!=Object.prototype&&(b[l]=h.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var b=0;return function(l){return $jscomp.SYMBOL_PREFIX+(l||"")+b++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var l=0;return $jscomp.iteratorPrototype(function(){return l<b.length?{done:!1,value:b[l++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.makeIterator=function(b){$jscomp.initSymbolIterator();var l=b[Symbol.iterator];return l?l.call(b):$jscomp.arrayIterator(b)};
$jscomp.polyfill=function(b,l,h,p){if(l){h=$jscomp.global;b=b.split(".");for(p=0;p<b.length-1;p++){var r=b[p];r in h||(h[r]={});h=h[r]}b=b[b.length-1];p=h[b];l=l(p);l!=p&&null!=l&&$jscomp.defineProperty(h,b,{configurable:!0,writable:!0,value:l})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(b){function l(){this.batch_=null}function h(b){return b instanceof r?b:new r(function(g,l){g(b)})}if(b&&!$jscomp.FORCE_POLYFILL_PROMISE)return b;l.prototype.asyncExecute=function(b){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(b);return this};l.prototype.asyncExecuteBatch_=function(){var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})};var p=$jscomp.global.setTimeout;l.prototype.asyncExecuteFunction=function(b){p(b,
0)};l.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var b=this.batch_;this.batch_=[];for(var g=0;g<b.length;++g){var l=b[g];b[g]=null;try{l()}catch(F){this.asyncThrow_(F)}}}this.batch_=null};l.prototype.asyncThrow_=function(b){this.asyncExecuteFunction(function(){throw b;})};var r=function(b){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var g=this.createResolveAndReject_();try{b(g.resolve,g.reject)}catch(J){g.reject(J)}};r.prototype.createResolveAndReject_=
function(){function b(b){return function(h){l||(l=!0,b.call(g,h))}}var g=this,l=!1;return{resolve:b(this.resolveTo_),reject:b(this.reject_)}};r.prototype.resolveTo_=function(b){if(b===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof r)this.settleSameAsPromise_(b);else{a:switch(typeof b){case "object":var g=null!=b;break a;case "function":g=!0;break a;default:g=!1}g?this.resolveToNonPromiseObj_(b):this.fulfill_(b)}};r.prototype.resolveToNonPromiseObj_=function(b){var g=
void 0;try{g=b.then}catch(J){this.reject_(J);return}"function"==typeof g?this.settleSameAsThenable_(g,b):this.fulfill_(b)};r.prototype.reject_=function(b){this.settle_(2,b)};r.prototype.fulfill_=function(b){this.settle_(1,b)};r.prototype.settle_=function(b,g){if(0!=this.state_)throw Error("Cannot settle("+b+", "+g+"): Promise already settled in state"+this.state_);this.state_=b;this.result_=g;this.executeOnSettledCallbacks_()};r.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var b=
0;b<this.onSettledCallbacks_.length;++b)C.asyncExecute(this.onSettledCallbacks_[b]);this.onSettledCallbacks_=null}};var C=new l;r.prototype.settleSameAsPromise_=function(b){var g=this.createResolveAndReject_();b.callWhenSettled_(g.resolve,g.reject)};r.prototype.settleSameAsThenable_=function(b,g){var l=this.createResolveAndReject_();try{b.call(g,l.resolve,l.reject)}catch(F){l.reject(F)}};r.prototype.then=function(b,g){function l(b,g){return"function"==typeof b?function(g){try{h(b(g))}catch(aa){p(aa)}}:
g}var h,p,C=new r(function(b,g){h=b;p=g});this.callWhenSettled_(l(b,h),l(g,p));return C};r.prototype.catch=function(b){return this.then(void 0,b)};r.prototype.callWhenSettled_=function(b,g){function l(){switch(h.state_){case 1:b(h.result_);break;case 2:g(h.result_);break;default:throw Error("Unexpected state: "+h.state_);}}var h=this;null==this.onSettledCallbacks_?C.asyncExecute(l):this.onSettledCallbacks_.push(l)};r.resolve=h;r.reject=function(b){return new r(function(g,l){l(b)})};r.race=function(b){return new r(function(g,
l){for(var p=$jscomp.makeIterator(b),J=p.next();!J.done;J=p.next())h(J.value).callWhenSettled_(g,l)})};r.all=function(b){var g=$jscomp.makeIterator(b),l=g.next();return l.done?h([]):new r(function(b,p){function J(g){return function(l){r[g]=l;F--;0==F&&b(r)}}var r=[],F=0;do r.push(void 0),F++,h(l.value).callWhenSettled_(J(r.length-1),p),l=g.next();while(!l.done)})};return r},"es6","es3");
$jscomp.iteratorFromArray=function(b,l){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var h=0,p={next:function(){if(h<b.length){var r=h++;return{value:l(r,b[r]),done:!1}}p.next=function(){return{done:!0,value:void 0}};return p.next()}};p[Symbol.iterator]=function(){return p};return p};$jscomp.polyfill("Array.prototype.keys",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
$jscomp.polyfill("Number.isNaN",function(b){return b?b:function(b){return"number"===typeof b&&isNaN(b)}},"es6","es3");$jscomp.polyfill("Number.isFinite",function(b){return b?b:function(b){return"number"!==typeof b?!1:!isNaN(b)&&Infinity!==b&&-Infinity!==b}},"es6","es3");$jscomp.polyfill("Math.sign",function(b){return b?b:function(b){b=Number(b);return 0===b||isNaN(b)?b:0<b?1:-1}},"es6","es3");$jscomp.polyfill("Number.EPSILON",function(b){return Math.pow(2,-52)},"es6","es3");
$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6","es3");$jscomp.checkStringArgs=function(b,l,h){if(null==b)throw new TypeError("The 'this' value for String.prototype."+h+" must not be null or undefined");if(l instanceof RegExp)throw new TypeError("First argument to String.prototype."+h+" must not be a regular expression");return b+""};
$jscomp.polyfill("String.prototype.startsWith",function(b){return b?b:function(b,h){var l=$jscomp.checkStringArgs(this,b,"startsWith");b+="";var r=l.length,C=b.length;h=Math.max(0,Math.min(h|0,l.length));for(var I=0;I<C&&h<r;)if(l[h++]!=b[I++])return!1;return I>=C}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(b){return b?b:function(b,h){var l=$jscomp.checkStringArgs(this,b,"endsWith");b+="";void 0===h&&(h=l.length);h=Math.max(0,Math.min(h|0,l.length));for(var r=b.length;0<r&&0<h;)if(l[--h]!=b[--r])return!1;return 0>=r}},"es6","es3");$jscomp.polyfill("Object.is",function(b){return b?b:function(b,h){return b===h?0!==b||1/b===1/h:b!==b&&h!==h}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(b){return b?b:function(b,h){var l=this;l instanceof String&&(l=String(l));var r=l.length;h=h||0;for(0>h&&(h=Math.max(h+r,0));h<r;h++){var C=l[h];if(C===b||Object.is(C,b))return!0}return!1}},"es7","es3");$jscomp.polyfill("String.prototype.includes",function(b){return b?b:function(b,h){return-1!==$jscomp.checkStringArgs(this,b,"includes").indexOf(b,h||0)}},"es6","es3");
$jscomp.polyfill("Array.prototype.values",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b,h){return h})}},"es8","es3");$jscomp.polyfill("Array.from",function(b){return b?b:function(b,h,p){$jscomp.initSymbolIterator();h=null!=h?h:function(b){return b};var l=[],C=b[Symbol.iterator];if("function"==typeof C)for(b=C.call(b);!(C=b.next()).done;)l.push(h.call(p,C.value));else{C=b.length;for(var I=0;I<C;I++)l.push(h.call(p,b[I]))}return l}},"es6","es3");
$jscomp.polyfill("Array.prototype.entries",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b,h){return[b,h]})}},"es6","es3");$jscomp.polyfill("Number.isInteger",function(b){return b?b:function(b){return Number.isFinite(b)?b===Math.floor(b):!1}},"es6","es3");$jscomp.findInternal=function(b,l,h){b instanceof String&&(b=String(b));for(var p=b.length,r=0;r<p;r++){var C=b[r];if(l.call(h,C,r,b))return{i:r,v:C}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,h){return $jscomp.findInternal(this,b,h).v}},"es6","es3");$jscomp.polyfill("Array.prototype.findIndex",function(b){return b?b:function(b,h){return $jscomp.findInternal(this,b,h).i}},"es6","es3");$jscomp.polyfill("Object.getOwnPropertySymbols",function(b){return b?b:function(){return[]}},"es6","es5");
$jscomp.polyfill("Math.expm1",function(b){return b?b:function(b){b=Number(b);if(.25>b&&-.25<b){for(var h=b,l=1,r=b,C=0;C!=r;)h*=b/++l,r=(C=r)+h;return r}return Math.exp(b)-1}},"es6","es3");$jscomp.polyfill("Math.sinh",function(b){if(b)return b;var l=Math.exp;return function(b){b=Number(b);return 0===b?b:(l(b)-l(-b))/2}},"es6","es3");$jscomp.polyfill("Math.cosh",function(b){if(b)return b;var l=Math.exp;return function(b){b=Number(b);return(l(b)+l(-b))/2}},"es6","es3");
$jscomp.polyfill("Math.log1p",function(b){return b?b:function(b){b=Number(b);if(.25>b&&-.25<b){for(var h=b,l=1,r=b,C=0,I=1;C!=r;)h*=b,I*=-1,r=(C=r)+I*h/++l;return r}return Math.log(1+b)}},"es6","es3");$jscomp.polyfill("Math.asinh",function(b){return b?b:function(b){b=Number(b);if(0===b)return b;var h=Math.log(Math.abs(b)+Math.sqrt(b*b+1));return 0>b?-h:h}},"es6","es3");
$jscomp.polyfill("Math.atanh",function(b){if(b)return b;var l=Math.log1p;return function(b){b=Number(b);return(l(b)-l(-b))/2}},"es6","es3");$jscomp.polyfill("Math.tanh",function(b){return b?b:function(b){b=Number(b);if(0===b)return b;var h=Math.exp(-2*Math.abs(b));h=(1-h)/(1+h);return 0>b?-h:h}},"es6","es3");$jscomp.polyfill("Math.acosh",function(b){return b?b:function(b){b=Number(b);return Math.log(b+Math.sqrt(b*b-1))}},"es6","es3");
$jscomp.polyfill("Math.cbrt",function(b){return b?b:function(b){if(0===b)return b;b=Number(b);var h=Math.pow(Math.abs(b),1/3);return 0>b?-h:h}},"es6","es3");$jscomp.polyfill("Math.imul",function(b){return b?b:function(b,h){b=Number(b);h=Number(h);var l=b&65535,r=h&65535;return l*r+((b>>>16&65535)*r+l*(h>>>16&65535)<<16>>>0)|0}},"es6","es3");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var b={},l=Object.create(new $jscomp.global.Proxy(b,{get:function(h,p,r){return h==b&&"q"==p&&r==l}}));return!0===l.q}catch(h){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(b,l){return Object.prototype.hasOwnProperty.call(b,l)};
$jscomp.polyfill("WeakMap",function(b){function l(){if(!b||!Object.seal)return!1;try{var g=Object.seal({}),h=Object.seal({}),l=new b([[g,2],[h,3]]);if(2!=l.get(g)||3!=l.get(h))return!1;l.delete(g);l.set(h,4);return!l.has(g)&&4==l.get(h)}catch(Z){return!1}}function h(b){$jscomp.owns(b,r)||$jscomp.defineProperty(b,r,{value:{}})}function p(b){var g=Object[b];g&&(Object[b]=function(b){h(b);return g(b)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(l())return b;
var r="$jscomp_hidden_"+Math.random();p("freeze");p("preventExtensions");p("seal");var C=0,I=function(b){this.id_=(C+=Math.random()+1).toString();if(b){$jscomp.initSymbol();$jscomp.initSymbolIterator();b=$jscomp.makeIterator(b);for(var g;!(g=b.next()).done;)g=g.value,this.set(g[0],g[1])}};I.prototype.set=function(b,l){h(b);if(!$jscomp.owns(b,r))throw Error("WeakMap key fail: "+b);b[r][this.id_]=l;return this};I.prototype.get=function(b){return $jscomp.owns(b,r)?b[r][this.id_]:void 0};I.prototype.has=
function(b){return $jscomp.owns(b,r)&&$jscomp.owns(b[r],this.id_)};I.prototype.delete=function(b){return $jscomp.owns(b,r)&&$jscomp.owns(b[r],this.id_)?delete b[r][this.id_]:!1};return I},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(b){function l(){if($jscomp.ASSUME_NO_NATIVE_MAP||!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var g=Object.seal({x:4}),h=new b($jscomp.makeIterator([[g,"s"]]));if("s"!=h.get(g)||1!=h.size||h.get({x:4})||h.set({x:4},"t")!=h||2!=h.size)return!1;var l=h.entries(),p=l.next();if(p.done||p.value[0]!=g||"s"!=p.value[1])return!1;p=l.next();return p.done||4!=p.value[0].x||"t"!=p.value[1]||!l.next().done?!1:!0}catch(Aa){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(l())return b;$jscomp.initSymbol();$jscomp.initSymbolIterator();var h=new WeakMap,p=function(b){this.data_={};this.head_=I();this.size=0;if(b){b=$jscomp.makeIterator(b);for(var g;!(g=b.next()).done;)g=g.value,this.set(g[0],g[1])}};p.prototype.set=function(b,g){b=0===b?0:b;var h=r(this,b);h.list||(h.list=this.data_[h.id]=[]);h.entry?h.entry.value=g:(h.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:b,value:g},h.list.push(h.entry),this.head_.previous.next=h.entry,this.head_.previous=h.entry,this.size++);return this};p.prototype.delete=function(b){b=r(this,b);return b.entry&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.data_[b.id],b.entry.previous.next=b.entry.next,b.entry.next.previous=b.entry.previous,b.entry.head=null,this.size--,!0):!1};p.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=I();this.size=0};p.prototype.has=function(b){return!!r(this,b).entry};
p.prototype.get=function(b){return(b=r(this,b).entry)&&b.value};p.prototype.entries=function(){return C(this,function(b){return[b.key,b.value]})};p.prototype.keys=function(){return C(this,function(b){return b.key})};p.prototype.values=function(){return C(this,function(b){return b.value})};p.prototype.forEach=function(b,g){for(var h=this.entries(),l;!(l=h.next()).done;)l=l.value,b.call(g,l[1],l[0],this)};p.prototype[Symbol.iterator]=p.prototype.entries;var r=function(b,l){var p=l&&typeof l;"object"==
p||"function"==p?h.has(l)?p=h.get(l):(p=""+ ++g,h.set(l,p)):p="p_"+l;var r=b.data_[p];if(r&&$jscomp.owns(b.data_,p))for(b=0;b<r.length;b++){var F=r[b];if(l!==l&&F.key!==F.key||l===F.key)return{id:p,list:r,index:b,entry:F}}return{id:p,list:r,index:-1,entry:void 0}},C=function(b,g){var h=b.head_;return $jscomp.iteratorPrototype(function(){if(h){for(;h.head!=b.head_;)h=h.previous;for(;h.next!=h.head;)return h=h.next,{done:!1,value:g(h)};h=null}return{done:!0,value:void 0}})},I=function(){var b={};return b.previous=
b.next=b.head=b},g=0;return p},"es6","es3");
$jscomp.polyfill("Set",function(b){function l(){if($jscomp.ASSUME_NO_NATIVE_SET||!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var h=Object.seal({x:4}),l=new b($jscomp.makeIterator([h]));if(!l.has(h)||1!=l.size||l.add(h)!=l||1!=l.size||l.add({x:4})!=l||2!=l.size)return!1;var C=l.entries(),I=C.next();if(I.done||I.value[0]!=h||I.value[1]!=h)return!1;I=C.next();return I.done||I.value[0]==h||4!=I.value[0].x||I.value[1]!=I.value[0]?!1:C.next().done}catch(g){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(l())return b;$jscomp.initSymbol();$jscomp.initSymbolIterator();var h=function(b){this.map_=new Map;if(b){b=$jscomp.makeIterator(b);for(var h;!(h=b.next()).done;)this.add(h.value)}this.size=this.map_.size};h.prototype.add=function(b){b=0===b?0:b;this.map_.set(b,b);this.size=this.map_.size;return this};h.prototype.delete=function(b){b=this.map_.delete(b);this.size=this.map_.size;return b};h.prototype.clear=
function(){this.map_.clear();this.size=0};h.prototype.has=function(b){return this.map_.has(b)};h.prototype.entries=function(){return this.map_.entries()};h.prototype.values=function(){return this.map_.values()};h.prototype.keys=h.prototype.values;h.prototype[Symbol.iterator]=h.prototype.values;h.prototype.forEach=function(b,h){var l=this;this.map_.forEach(function(p){return b.call(h,p,p,l)})};return h},"es6","es3");
$jscomp.underscoreProtoCanBeSet=function(){var b={a:!0},l={};try{return l.__proto__=b,l.a}catch(h){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(b,l){b.__proto__=l;if(b.__proto__!==l)throw new TypeError(b+" is not extensible");return b}:null;$jscomp.polyfill("Object.setPrototypeOf",function(b){return b||$jscomp.setPrototypeOf},"es6","es5");
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(b,l){for(var h=1;h<arguments.length;h++){var p=arguments[h];if(p)for(var r in p)$jscomp.owns(p,r)&&(b[r]=p[r])}return b};$jscomp.polyfill("Object.assign",function(b){return b||$jscomp.assign},"es6","es3");$jscomp.polyfill("Object.values",function(b){return b?b:function(b){var h=[],l;for(l in b)$jscomp.owns(b,l)&&h.push(b[l]);return h}},"es8","es3");
$jscomp.polyfill("Array.prototype.fill",function(b){return b?b:function(b,h,p){var l=this.length||0;0>h&&(h=Math.max(0,l+h));if(null==p||p>l)p=l;p=Number(p);0>p&&(p=Math.max(0,l+p));for(h=Number(h||0);h<p;h++)this[h]=b;return this}},"es6","es3");
var enableInlineVideo=function(){function b(b,k,g,h){function l(g){p=k(l,h);b(g-(r||g));r=g}var p,r;return{start:function(){p||l(0)},stop:function(){g(p);p=null;r=0}}}function l(b,k,g,h){function l(k){!!b[g]===!!h&&k.stopImmediatePropagation();delete b[g]}return b.addEventListener(k,l,!1),l}function h(b,k,g,h){function l(b){g[k]=b}h&&l(b[k]);Object.defineProperty(b,k,{get:function(){return g[k]},set:l})}function p(b,k,g){g.addEventListener(k,function(){return b.dispatchEvent(new Event(k))})}function r(b,
k){Promise.resolve().then(function(){b.dispatchEvent(new Event(k))})}function C(b){var k=new Audio;return p(b,"play",k),p(b,"playing",k),p(b,"pause",k),k.crossOrigin=b.crossOrigin,k.src=b.src||b.currentSrc||"data:",k}function I(b,g,h){(ja||0)+200<Date.now()&&(b[L]=!0,ja=Date.now());h||(b.currentTime=g);k[++ba%3]=100*g|0}function g(b){this.video.readyState>=this.video.HAVE_FUTURE_DATA?(this.hasAudio||(this.driver.currentTime=this.video.currentTime+b*this.video.playbackRate/1E3,this.video.loop&&this.driver.currentTime>=
this.video.duration&&(this.driver.currentTime=0)),I(this.video,this.driver.currentTime)):this.video.networkState===this.video.NETWORK_IDLE&&0===this.video.buffered.length&&this.video.load();this.video.ended&&(delete this.video[L],this.video.pause(!0))}function J(){var b=this[Ka];return this.webkitDisplayingFullscreen?void this[aa]():("data:"!==b.driver.src&&b.driver.src!==this.src&&(I(this,0,!0),b.driver.src=this.src),void(this.paused&&(b.paused=!1,0===this.buffered.length&&this.load(),b.driver.play(),
b.updater.start(),b.hasAudio||(r(this,"play"),b.video.readyState>=b.video.HAVE_ENOUGH_DATA&&r(this,"playing")))))}function F(b){var k=this[Ka];k.driver.pause();k.updater.stop();this.webkitDisplayingFullscreen&&this[Fa]();k.paused&&!b||(k.paused=!0,k.hasAudio||r(this,"pause"),this.ended&&(this[L]=!0,r(this,"ended")))}function Z(h,l){var p=h[Ka]={};p.paused=!0;p.hasAudio=l;p.video=h;p.updater=b(g.bind(p),requestAnimationFrame,cancelAnimationFrame);l?p.driver=C(h):(h.addEventListener("canplay",function(){h.paused||
r(h,"playing")}),p.driver={src:h.src||h.currentSrc||"data:",muted:!0,paused:!0,pause:function(){p.driver.paused=!0},play:function(){p.driver.paused=!1;p.driver.currentTime>=p.video.duration&&I(h,0)},get ended(){return p.driver.currentTime>=p.video.duration}});h.addEventListener("emptied",function(){var b=!p.driver.src||"data:"===p.driver.src;p.driver.src&&p.driver.src!==h.src&&(I(h,0,!0),p.driver.src=h.src,b?p.driver.play():p.updater.stop())},!1);h.addEventListener("webkitbeginfullscreen",function(){h.paused?
l&&0===p.driver.buffered.length&&p.driver.load():(h.pause(),h[aa]())});l&&(h.addEventListener("webkitendfullscreen",function(){p.driver.currentTime=h.currentTime}),h.addEventListener("seeking",function(){0>k.indexOf(100*h.currentTime|0)&&(p.driver.currentTime=h.currentTime)}))}var ja,Aa="object"==typeof document&&"object-fit"in document.head.style&&!matchMedia("(-webkit-video-playable-inline)").matches,Ka="bfred-it:iphone-inline-video",L="bfred-it:iphone-inline-video:event",aa="bfred-it:iphone-inline-video:nativeplay",
Fa="bfred-it:iphone-inline-video:nativepause",k=[],ba=0;return function(b,k){if(void 0===k&&(k={}),!b[Ka])if(k.everywhere||Aa&&(k.iPad||k.ipad?/iPhone|iPod|iPad/:/iPhone|iPod/).test(navigator.userAgent))!b.paused&&b.webkitDisplayingFullscreen&&b.pause(),Z(b,!b.muted),k=b[Ka],b[aa]=b.play,b[Fa]=b.pause,b.play=J,b.pause=F,h(b,"paused",k.driver),h(b,"muted",k.driver,!0),h(b,"playbackRate",k.driver,!0),h(b,"ended",k.driver),h(b,"loop",k.driver,!0),l(b,"seeking"),l(b,"seeked"),l(b,"timeupdate",L,!1),l(b,
"ended",L,!1),b.classList.add("IIV"),b.muted&&b.autoplay&&b.play(),/iPhone|iPod|iPad/.test(navigator.platform)||console.warn("iphone-inline-video is not guaranteed to work in emulated environments")}}();
(function(){function b(c,e,q){k.biginteger_used=1;null!=c&&("number"==typeof c&&"undefined"==typeof e?this.fromInt(c):"number"==typeof c?this.fromNumber(c,e,q):null==e&&"string"!=typeof c?this.fromString(c,256):this.fromString(c,e))}function l(){return new b(null,void 0,void 0)}function h(c,e,q,b,k,g){for(;0<=--g;){var Ba=e*this[c++]+q[b]+k;k=Math.floor(Ba/67108864);q[b++]=Ba&67108863}return k}function p(c,e,q,b,k,g){var Ba=e&32767;for(e>>=15;0<=--g;){var Ga=this[c]&32767,h=this[c++]>>15,l=e*Ga+h*
Ba;Ga=Ba*Ga+((l&32767)<<15)+q[b]+(k&1073741823);k=(Ga>>>30)+(l>>>15)+e*h+(k>>>30);q[b++]=Ga&1073741823}return k}function r(c,e,q,b,k,g){var Ba=e&16383;for(e>>=14;0<=--g;){var Ga=this[c]&16383,h=this[c++]>>14,l=e*Ga+h*Ba;Ga=Ba*Ga+((l&16383)<<14)+q[b]+k;k=(Ga>>28)+(l>>14)+e*h;q[b++]=Ga&268435455}return k}function C(c,e){c=Ta[c.charCodeAt(e)];return null==c?-1:c}function I(c){var e=l();e.fromInt(c);return e}function g(c){var e=1,q;0!=(q=c>>>16)&&(c=q,e+=16);0!=(q=c>>8)&&(c=q,e+=8);0!=(q=c>>4)&&(c=q,
e+=4);0!=(q=c>>2)&&(c=q,e+=2);0!=c>>1&&(e+=1);return e}function J(c){this.m=c}function F(c){this.m=c;this.mp=c.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<c.DB-15)-1;this.mt2=2*c.t}function Z(c,e){return c&e}function ja(c,e){return c|e}function Aa(c,e){return c^e}function Ka(c,e){return c&~e}function L(){}function aa(c){return c}function Fa(c){this.r2=l();this.q3=l();b.ONE.dlShiftTo(2*c.t,this.r2);this.mu=this.r2.divide(c);this.m=c}var k={use_lines:!0,use_xyz:!1},ba=!1;"undefined"!==
typeof module&&module.exports?(module.exports=k,ba=!0):"undefined"!==typeof document?window.ClipperLib=k:self.ClipperLib=k;if(ba){qa="chrome";var na="Netscape"}else{var qa=navigator.userAgent.toString().toLowerCase();na=navigator.appName}var G=-1!=qa.indexOf("chrome")&&-1==qa.indexOf("chromium")?1:0;ba=-1!=qa.indexOf("chromium")?1:0;var Pa=-1!=qa.indexOf("safari")&&-1==qa.indexOf("chrome")&&-1==qa.indexOf("chromium")?1:0;var tb=-1!=qa.indexOf("firefox")?1:0;qa.indexOf("firefox/17");qa.indexOf("firefox/15");
qa.indexOf("firefox/3");var U=-1!=qa.indexOf("opera")?1:0;qa.indexOf("msie 10");qa.indexOf("msie 9");var vb=-1!=qa.indexOf("msie 8")?1:0;var ub=-1!=qa.indexOf("msie 7")?1:0;qa=-1!=qa.indexOf("msie ")?1:0;k.biginteger_used=null;"Microsoft Internet Explorer"==na?(b.prototype.am=p,na=30):"Netscape"!=na?(b.prototype.am=h,na=26):(b.prototype.am=r,na=28);b.prototype.DB=na;b.prototype.DM=(1<<na)-1;b.prototype.DV=1<<na;b.prototype.FV=Math.pow(2,52);b.prototype.F1=52-na;b.prototype.F2=2*na-52;var Ta=[],La;
na=48;for(La=0;9>=La;++La)Ta[na++]=La;na=97;for(La=10;36>La;++La)Ta[na++]=La;na=65;for(La=10;36>La;++La)Ta[na++]=La;J.prototype.convert=function(c){return 0>c.s||0<=c.compareTo(this.m)?c.mod(this.m):c};J.prototype.revert=function(c){return c};J.prototype.reduce=function(c){c.divRemTo(this.m,null,c)};J.prototype.mulTo=function(c,e,q){c.multiplyTo(e,q);this.reduce(q)};J.prototype.sqrTo=function(c,e){c.squareTo(e);this.reduce(e)};F.prototype.convert=function(c){var e=l();c.abs().dlShiftTo(this.m.t,e);
e.divRemTo(this.m,null,e);0>c.s&&0<e.compareTo(b.ZERO)&&this.m.subTo(e,e);return e};F.prototype.revert=function(c){var e=l();c.copyTo(e);this.reduce(e);return e};F.prototype.reduce=function(c){for(;c.t<=this.mt2;)c[c.t++]=0;for(var e=0;e<this.m.t;++e){var q=c[e]&32767,b=q*this.mpl+((q*this.mph+(c[e]>>15)*this.mpl&this.um)<<15)&c.DM;q=e+this.m.t;for(c[q]+=this.m.am(0,b,c,e,0,this.m.t);c[q]>=c.DV;)c[q]-=c.DV,c[++q]++}c.clamp();c.drShiftTo(this.m.t,c);0<=c.compareTo(this.m)&&c.subTo(this.m,c)};F.prototype.mulTo=
function(c,e,q){c.multiplyTo(e,q);this.reduce(q)};F.prototype.sqrTo=function(c,e){c.squareTo(e);this.reduce(e)};b.prototype.copyTo=function(c){for(var e=this.t-1;0<=e;--e)c[e]=this[e];c.t=this.t;c.s=this.s};b.prototype.fromInt=function(c){this.t=1;this.s=0>c?-1:0;0<c?this[0]=c:-1>c?this[0]=c+this.DV:this.t=0};b.prototype.fromString=function(c,e){if(16==e)e=4;else if(8==e)e=3;else if(256==e)e=8;else if(2==e)e=1;else if(32==e)e=5;else if(4==e)e=2;else{this.fromRadix(c,e);return}this.s=this.t=0;for(var q=
c.length,Ba=!1,k=0;0<=--q;){var g=8==e?c[q]&255:C(c,q);0>g?"-"==c.charAt(q)&&(Ba=!0):(Ba=!1,0==k?this[this.t++]=g:k+e>this.DB?(this[this.t-1]|=(g&(1<<this.DB-k)-1)<<k,this[this.t++]=g>>this.DB-k):this[this.t-1]|=g<<k,k+=e,k>=this.DB&&(k-=this.DB))}8==e&&0!=(c[0]&128)&&(this.s=-1,0<k&&(this[this.t-1]|=(1<<this.DB-k)-1<<k));this.clamp();Ba&&b.ZERO.subTo(this,this)};b.prototype.clamp=function(){for(var c=this.s&this.DM;0<this.t&&this[this.t-1]==c;)--this.t};b.prototype.dlShiftTo=function(c,e){var q;
for(q=this.t-1;0<=q;--q)e[q+c]=this[q];for(q=c-1;0<=q;--q)e[q]=0;e.t=this.t+c;e.s=this.s};b.prototype.drShiftTo=function(c,e){for(var q=c;q<this.t;++q)e[q-c]=this[q];e.t=Math.max(this.t-c,0);e.s=this.s};b.prototype.lShiftTo=function(c,e){var q=c%this.DB,b=this.DB-q,k=(1<<b)-1;c=Math.floor(c/this.DB);var g=this.s<<q&this.DM,h;for(h=this.t-1;0<=h;--h)e[h+c+1]=this[h]>>b|g,g=(this[h]&k)<<q;for(h=c-1;0<=h;--h)e[h]=0;e[c]=g;e.t=this.t+c+1;e.s=this.s;e.clamp()};b.prototype.rShiftTo=function(c,e){e.s=this.s;
var q=Math.floor(c/this.DB);if(q>=this.t)e.t=0;else{c%=this.DB;var b=this.DB-c,k=(1<<c)-1;e[0]=this[q]>>c;for(var g=q+1;g<this.t;++g)e[g-q-1]|=(this[g]&k)<<b,e[g-q]=this[g]>>c;0<c&&(e[this.t-q-1]|=(this.s&k)<<b);e.t=this.t-q;e.clamp()}};b.prototype.subTo=function(c,e){for(var q=0,b=0,k=Math.min(c.t,this.t);q<k;)b+=this[q]-c[q],e[q++]=b&this.DM,b>>=this.DB;if(c.t<this.t){for(b-=c.s;q<this.t;)b+=this[q],e[q++]=b&this.DM,b>>=this.DB;b+=this.s}else{for(b+=this.s;q<c.t;)b-=c[q],e[q++]=b&this.DM,b>>=this.DB;
b-=c.s}e.s=0>b?-1:0;-1>b?e[q++]=this.DV+b:0<b&&(e[q++]=b);e.t=q;e.clamp()};b.prototype.multiplyTo=function(c,e){var q=this.abs(),k=c.abs(),g=q.t;for(e.t=g+k.t;0<=--g;)e[g]=0;for(g=0;g<k.t;++g)e[g+q.t]=q.am(0,k[g],e,g,0,q.t);e.s=0;e.clamp();this.s!=c.s&&b.ZERO.subTo(e,e)};b.prototype.squareTo=function(c){for(var e=this.abs(),q=c.t=2*e.t;0<=--q;)c[q]=0;for(q=0;q<e.t-1;++q){var b=e.am(q,e[q],c,2*q,0,1);(c[q+e.t]+=e.am(q+1,2*e[q],c,2*q+1,b,e.t-q-1))>=e.DV&&(c[q+e.t]-=e.DV,c[q+e.t+1]=1)}0<c.t&&(c[c.t-
1]+=e.am(q,e[q],c,2*q,0,1));c.s=0;c.clamp()};b.prototype.divRemTo=function(c,e,q){var k=c.abs();if(!(0>=k.t)){var h=this.abs();if(h.t<k.t)null!=e&&e.fromInt(0),null!=q&&this.copyTo(q);else{null==q&&(q=l());var ha=l(),p=this.s;c=c.s;var r=this.DB-g(k[k.t-1]);0<r?(k.lShiftTo(r,ha),h.lShiftTo(r,q)):(k.copyTo(ha),h.copyTo(q));k=ha.t;h=ha[k-1];if(0!=h){var F=h*(1<<this.F1)+(1<k?ha[k-2]>>this.F2:0),J=this.FV/F;F=(1<<this.F1)/F;var C=1<<this.F2,I=q.t,G=I-k,U=null==e?l():e;ha.dlShiftTo(G,U);0<=q.compareTo(U)&&
(q[q.t++]=1,q.subTo(U,q));b.ONE.dlShiftTo(k,U);for(U.subTo(ha,ha);ha.t<k;)ha[ha.t++]=0;for(;0<=--G;){var Z=q[--I]==h?this.DM:Math.floor(q[I]*J+(q[I-1]+C)*F);if((q[I]+=ha.am(0,Z,q,G,0,k))<Z)for(ha.dlShiftTo(G,U),q.subTo(U,q);q[I]<--Z;)q.subTo(U,q)}null!=e&&(q.drShiftTo(k,e),p!=c&&b.ZERO.subTo(e,e));q.t=k;q.clamp();0<r&&q.rShiftTo(r,q);0>p&&b.ZERO.subTo(q,q)}}}};b.prototype.invDigit=function(){if(1>this.t)return 0;var c=this[0];if(0==(c&1))return 0;var e=c&3;e=e*(2-(c&15)*e)&15;e=e*(2-(c&255)*e)&255;
e=e*(2-((c&65535)*e&65535))&65535;e=e*(2-c*e%this.DV)%this.DV;return 0<e?this.DV-e:-e};b.prototype.isEven=function(){return 0==(0<this.t?this[0]&1:this.s)};b.prototype.exp=function(c,e){if(4294967295<c||1>c)return b.ONE;var q=l(),k=l(),h=e.convert(this),ha=g(c)-1;for(h.copyTo(q);0<=--ha;)if(e.sqrTo(q,k),0<(c&1<<ha))e.mulTo(k,h,q);else{var p=q;q=k;k=p}return e.revert(q)};b.prototype.toString=function(c){if(0>this.s)return"-"+this.negate().toString(c);if(16==c)c=4;else if(8==c)c=3;else if(2==c)c=1;
else if(32==c)c=5;else if(4==c)c=2;else return this.toRadix(c);var e=(1<<c)-1,q,b=!1,k="",g=this.t,h=this.DB-g*this.DB%c;if(0<g--)for(h<this.DB&&0<(q=this[g]>>h)&&(b=!0,k="0123456789abcdefghijklmnopqrstuvwxyz".charAt(q));0<=g;)h<c?(q=(this[g]&(1<<h)-1)<<c-h,q|=this[--g]>>(h+=this.DB-c)):(q=this[g]>>(h-=c)&e,0>=h&&(h+=this.DB,--g)),0<q&&(b=!0),b&&(k+="0123456789abcdefghijklmnopqrstuvwxyz".charAt(q));return b?k:"0"};b.prototype.negate=function(){var c=l();b.ZERO.subTo(this,c);return c};b.prototype.abs=
function(){return 0>this.s?this.negate():this};b.prototype.compareTo=function(c){var e=this.s-c.s;if(0!=e)return e;var q=this.t;e=q-c.t;if(0!=e)return 0>this.s?-e:e;for(;0<=--q;)if(0!=(e=this[q]-c[q]))return e;return 0};b.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+g(this[this.t-1]^this.s&this.DM)};b.prototype.mod=function(c){var e=l();this.abs().divRemTo(c,null,e);0>this.s&&0<e.compareTo(b.ZERO)&&c.subTo(e,e);return e};b.prototype.modPowInt=function(c,e){e=256>c||e.isEven()?
new J(e):new F(e);return this.exp(c,e)};b.ZERO=I(0);b.ONE=I(1);L.prototype.convert=aa;L.prototype.revert=aa;L.prototype.mulTo=function(c,e,q){c.multiplyTo(e,q)};L.prototype.sqrTo=function(c,e){c.squareTo(e)};Fa.prototype.convert=function(c){if(0>c.s||c.t>2*this.m.t)return c.mod(this.m);if(0>c.compareTo(this.m))return c;var e=l();c.copyTo(e);this.reduce(e);return e};Fa.prototype.revert=function(c){return c};Fa.prototype.reduce=function(c){c.drShiftTo(this.m.t-1,this.r2);c.t>this.m.t+1&&(c.t=this.m.t+
1,c.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>c.compareTo(this.r2);)c.dAddOffset(1,this.m.t+1);for(c.subTo(this.r2,c);0<=c.compareTo(this.m);)c.subTo(this.m,c)};Fa.prototype.mulTo=function(c,e,q){c.multiplyTo(e,q);this.reduce(q)};Fa.prototype.sqrTo=function(c,e){c.squareTo(e);this.reduce(e)};var X=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,
173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,
983,991,997],Ab=67108864/X[X.length-1];b.prototype.chunkSize=function(c){return Math.floor(Math.LN2*this.DB/Math.log(c))};b.prototype.toRadix=function(c){null==c&&(c=10);if(0==this.signum()||2>c||36<c)return"0";var e=this.chunkSize(c);e=Math.pow(c,e);var q=I(e),b=l(),k=l(),g="";for(this.divRemTo(q,b,k);0<b.signum();)g=(e+k.intValue()).toString(c).substr(1)+g,b.divRemTo(q,b,k);return k.intValue().toString(c)+g};b.prototype.fromRadix=function(c,e){this.fromInt(0);null==e&&(e=10);for(var q=this.chunkSize(e),
k=Math.pow(e,q),g=!1,h=0,l=0,p=0;p<c.length;++p){var r=C(c,p);0>r?"-"==c.charAt(p)&&0==this.signum()&&(g=!0):(l=e*l+r,++h>=q&&(this.dMultiply(k),this.dAddOffset(l,0),l=h=0))}0<h&&(this.dMultiply(Math.pow(e,h)),this.dAddOffset(l,0));g&&b.ZERO.subTo(this,this)};b.prototype.fromNumber=function(c,e,q){if("number"==typeof e)if(2>c)this.fromInt(1);else for(this.fromNumber(c,q),this.testBit(c-1)||this.bitwiseTo(b.ONE.shiftLeft(c-1),ja,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,
0),this.bitLength()>c&&this.subTo(b.ONE.shiftLeft(c-1),this);else{q=[];var k=c&7;q.length=(c>>3)+1;e.nextBytes(q);q[0]=0<k?q[0]&(1<<k)-1:0;this.fromString(q,256)}};b.prototype.bitwiseTo=function(c,e,q){var b,k=Math.min(c.t,this.t);for(b=0;b<k;++b)q[b]=e(this[b],c[b]);if(c.t<this.t){var g=c.s&this.DM;for(b=k;b<this.t;++b)q[b]=e(this[b],g);q.t=this.t}else{g=this.s&this.DM;for(b=k;b<c.t;++b)q[b]=e(g,c[b]);q.t=c.t}q.s=e(this.s,c.s);q.clamp()};b.prototype.changeBit=function(c,e){c=b.ONE.shiftLeft(c);this.bitwiseTo(c,
e,c);return c};b.prototype.addTo=function(c,e){for(var q=0,b=0,k=Math.min(c.t,this.t);q<k;)b+=this[q]+c[q],e[q++]=b&this.DM,b>>=this.DB;if(c.t<this.t){for(b+=c.s;q<this.t;)b+=this[q],e[q++]=b&this.DM,b>>=this.DB;b+=this.s}else{for(b+=this.s;q<c.t;)b+=c[q],e[q++]=b&this.DM,b>>=this.DB;b+=c.s}e.s=0>b?-1:0;0<b?e[q++]=b:-1>b&&(e[q++]=this.DV+b);e.t=q;e.clamp()};b.prototype.dMultiply=function(c){this[this.t]=this.am(0,c-1,this,0,0,this.t);++this.t;this.clamp()};b.prototype.dAddOffset=function(c,e){if(0!=
c){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=c;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}};b.prototype.multiplyLowerTo=function(c,e,q){var b=Math.min(this.t+c.t,e);q.s=0;for(q.t=b;0<b;)q[--b]=0;var k;for(k=q.t-this.t;b<k;++b)q[b+this.t]=this.am(0,c[b],q,b,0,this.t);for(k=Math.min(c.t,e);b<k;++b)this.am(0,c[b],q,b,0,e-b);q.clamp()};b.prototype.multiplyUpperTo=function(c,e,q){--e;var b=q.t=this.t+c.t-e;for(q.s=0;0<=--b;)q[b]=0;for(b=Math.max(e-this.t,0);b<c.t;++b)q[this.t+
b-e]=this.am(e-b,c[b],q,0,0,this.t+b-e);q.clamp();q.drShiftTo(1,q)};b.prototype.modInt=function(c){if(0>=c)return 0;var e=this.DV%c,q=0>this.s?c-1:0;if(0<this.t)if(0==e)q=this[0]%c;else for(var b=this.t-1;0<=b;--b)q=(e*q+this[b])%c;return q};b.prototype.millerRabin=function(c){var e=this.subtract(b.ONE),q=e.getLowestSetBit();if(0>=q)return!1;var k=e.shiftRight(q);c=c+1>>1;c>X.length&&(c=X.length);for(var g=l(),h=0;h<c;++h){g.fromInt(X[Math.floor(Math.random()*X.length)]);var p=g.modPow(k,this);if(0!=
p.compareTo(b.ONE)&&0!=p.compareTo(e)){for(var r=1;r++<q&&0!=p.compareTo(e);)if(p=p.modPowInt(2,this),0==p.compareTo(b.ONE))return!1;if(0!=p.compareTo(e))return!1}}return!0};b.prototype.clone=function(){var c=l();this.copyTo(c);return c};b.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]};b.prototype.byteValue=function(){return 0==this.t?this.s:
this[0]<<24>>24};b.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16};b.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1};b.prototype.toByteArray=function(){var c=this.t,e=[];e[0]=this.s;var q=this.DB-c*this.DB%8,b,k=0;if(0<c--)for(q<this.DB&&(b=this[c]>>q)!=(this.s&this.DM)>>q&&(e[k++]=b|this.s<<this.DB-q);0<=c;)if(8>q?(b=(this[c]&(1<<q)-1)<<8-q,b|=this[--c]>>(q+=this.DB-8)):(b=this[c]>>(q-=8)&255,0>=q&&(q+=this.DB,--c)),0!=(b&128)&&(b|=-256),
0==k&&(this.s&128)!=(b&128)&&++k,0<k||b!=this.s)e[k++]=b;return e};b.prototype.equals=function(c){return 0==this.compareTo(c)};b.prototype.min=function(c){return 0>this.compareTo(c)?this:c};b.prototype.max=function(c){return 0<this.compareTo(c)?this:c};b.prototype.and=function(c){var e=l();this.bitwiseTo(c,Z,e);return e};b.prototype.or=function(c){var e=l();this.bitwiseTo(c,ja,e);return e};b.prototype.xor=function(c){var e=l();this.bitwiseTo(c,Aa,e);return e};b.prototype.andNot=function(c){var e=
l();this.bitwiseTo(c,Ka,e);return e};b.prototype.not=function(){for(var c=l(),e=0;e<this.t;++e)c[e]=this.DM&~this[e];c.t=this.t;c.s=~this.s;return c};b.prototype.shiftLeft=function(c){var e=l();0>c?this.rShiftTo(-c,e):this.lShiftTo(c,e);return e};b.prototype.shiftRight=function(c){var e=l();0>c?this.lShiftTo(-c,e):this.rShiftTo(c,e);return e};b.prototype.getLowestSetBit=function(){for(var c=0;c<this.t;++c)if(0!=this[c]){var e=c*this.DB;c=this[c];if(0==c)c=-1;else{var q=0;0==(c&65535)&&(c>>=16,q+=
16);0==(c&255)&&(c>>=8,q+=8);0==(c&15)&&(c>>=4,q+=4);0==(c&3)&&(c>>=2,q+=2);0==(c&1)&&++q;c=q}return e+c}return 0>this.s?this.t*this.DB:-1};b.prototype.bitCount=function(){for(var c=0,e=this.s&this.DM,q=0;q<this.t;++q){for(var b=this[q]^e,k=0;0!=b;)b&=b-1,++k;c+=k}return c};b.prototype.testBit=function(c){var e=Math.floor(c/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<c%this.DB)};b.prototype.setBit=function(c){return this.changeBit(c,ja)};b.prototype.clearBit=function(c){return this.changeBit(c,
Ka)};b.prototype.flipBit=function(c){return this.changeBit(c,Aa)};b.prototype.add=function(c){var e=l();this.addTo(c,e);return e};b.prototype.subtract=function(c){var e=l();this.subTo(c,e);return e};b.prototype.multiply=function(c){var e=l();this.multiplyTo(c,e);return e};b.prototype.divide=function(c){var e=l();this.divRemTo(c,e,null);return e};b.prototype.remainder=function(c){var e=l();this.divRemTo(c,null,e);return e};b.prototype.divideAndRemainder=function(c){var e=l(),q=l();this.divRemTo(c,
e,q);return[e,q]};b.prototype.modPow=function(c,e){var q=c.bitLength(),b=I(1);if(0>=q)return b;var k=18>q?1:48>q?3:144>q?4:768>q?5:6;e=8>q?new J(e):e.isEven()?new Fa(e):new F(e);var h=[],p=3,r=k-1,C=(1<<k)-1;h[1]=e.convert(this);if(1<k)for(q=l(),e.sqrTo(h[1],q);p<=C;)h[p]=l(),e.mulTo(q,h[p-2],h[p]),p+=2;var U=c.t-1,G,Z=!0,L=l();for(q=g(c[U])-1;0<=U;){q>=r?G=c[U]>>q-r&C:(G=(c[U]&(1<<q+1)-1)<<r-q,0<U&&(G|=c[U-1]>>this.DB+q-r));for(p=k;0==(G&1);)G>>=1,--p;0>(q-=p)&&(q+=this.DB,--U);if(Z)h[G].copyTo(b),
Z=!1;else{for(;1<p;)e.sqrTo(b,L),e.sqrTo(L,b),p-=2;0<p?e.sqrTo(b,L):(p=b,b=L,L=p);e.mulTo(L,h[G],b)}for(;0<=U&&0==(c[U]&1<<q);)e.sqrTo(b,L),p=b,b=L,L=p,0>--q&&(q=this.DB-1,--U)}return e.revert(b)};b.prototype.modInverse=function(c){var e=c.isEven();if(this.isEven()&&e||0==c.signum())return b.ZERO;for(var q=c.clone(),k=this.clone(),g=I(1),h=I(0),l=I(0),p=I(1);0!=q.signum();){for(;q.isEven();)q.rShiftTo(1,q),e?(g.isEven()&&h.isEven()||(g.addTo(this,g),h.subTo(c,h)),g.rShiftTo(1,g)):h.isEven()||h.subTo(c,
h),h.rShiftTo(1,h);for(;k.isEven();)k.rShiftTo(1,k),e?(l.isEven()&&p.isEven()||(l.addTo(this,l),p.subTo(c,p)),l.rShiftTo(1,l)):p.isEven()||p.subTo(c,p),p.rShiftTo(1,p);0<=q.compareTo(k)?(q.subTo(k,q),e&&g.subTo(l,g),h.subTo(p,h)):(k.subTo(q,k),e&&l.subTo(g,l),p.subTo(h,p))}if(0!=k.compareTo(b.ONE))return b.ZERO;if(0<=p.compareTo(c))return p.subtract(c);if(0>p.signum())p.addTo(c,p);else return p;return 0>p.signum()?p.add(c):p};b.prototype.pow=function(c){return this.exp(c,new L)};b.prototype.gcd=function(c){var e=
0>this.s?this.negate():this.clone();c=0>c.s?c.negate():c.clone();if(0>e.compareTo(c)){var q=e;e=c;c=q}q=e.getLowestSetBit();var b=c.getLowestSetBit();if(0>b)return e;q<b&&(b=q);for(0<b&&(e.rShiftTo(b,e),c.rShiftTo(b,c));0<e.signum();)0<(q=e.getLowestSetBit())&&e.rShiftTo(q,e),0<(q=c.getLowestSetBit())&&c.rShiftTo(q,c),0<=e.compareTo(c)?(e.subTo(c,e),e.rShiftTo(1,e)):(c.subTo(e,c),c.rShiftTo(1,c));0<b&&c.lShiftTo(b,c);return c};b.prototype.isProbablePrime=function(c){var e,b=this.abs();if(1==b.t&&
b[0]<=X[X.length-1]){for(e=0;e<X.length;++e)if(b[0]==X[e])return!0;return!1}if(b.isEven())return!1;for(e=1;e<X.length;){for(var k=X[e],g=e+1;g<X.length&&k<Ab;)k*=X[g++];for(k=b.modInt(k);e<g;)if(0==k%X[e++])return!1}return b.millerRabin(c)};b.prototype.square=function(){var c=l();this.squareTo(c);return c};b.prototype.IsNegative=function(){return-1==this.compareTo(b.ZERO)?!0:!1};b.op_Equality=function(c,e){return 0==c.compareTo(e)?!0:!1};b.op_Inequality=function(c,e){return 0!=c.compareTo(e)?!0:!1};
b.op_GreaterThan=function(c,e){return 0<c.compareTo(e)?!0:!1};b.op_LessThan=function(c,e){return 0>c.compareTo(e)?!0:!1};b.op_Addition=function(c,e){return(new b(c)).add(new b(e))};b.op_Subtraction=function(c,e){return(new b(c)).subtract(new b(e))};b.Int128Mul=function(c,e){return(new b(c)).multiply(new b(e))};b.op_Division=function(c,e){return c.divide(e)};b.prototype.ToDouble=function(){return parseFloat(this.toString())};na=function(c,e){var b;if("undefined"==typeof Object.getOwnPropertyNames)for(b in e.prototype){if("undefined"==
typeof c.prototype[b]||c.prototype[b]==Object.prototype[b])c.prototype[b]=e.prototype[b]}else for(var k=Object.getOwnPropertyNames(e.prototype),g=0;g<k.length;g++)"undefined"==typeof Object.getOwnPropertyDescriptor(c.prototype,k[g])&&Object.defineProperty(c.prototype,k[g],Object.getOwnPropertyDescriptor(e.prototype,k[g]));for(b in e)"undefined"==typeof c[b]&&(c[b]=e[b]);c.$baseCtor=e};k.Path=function(){return[]};k.Paths=function(){return[]};k.DoublePoint=function(){var c=arguments;this.Y=this.X=0;
1==c.length?(this.X=c[0].X,this.Y=c[0].Y):2==c.length&&(this.X=c[0],this.Y=c[1])};k.DoublePoint0=function(){this.Y=this.X=0};k.DoublePoint1=function(c){this.X=c.X;this.Y=c.Y};k.DoublePoint2=function(c,e){this.X=c;this.Y=e};k.PolyNode=function(){this.m_Parent=null;this.m_polygon=new k.Path;this.m_endtype=this.m_jointype=this.m_Index=0;this.m_Childs=[];this.IsOpen=!1};k.PolyNode.prototype.IsHoleNode=function(){for(var c=!0,e=this.m_Parent;null!==e;)c=!c,e=e.m_Parent;return c};k.PolyNode.prototype.ChildCount=
function(){return this.m_Childs.length};k.PolyNode.prototype.Contour=function(){return this.m_polygon};k.PolyNode.prototype.AddChild=function(c){var e=this.m_Childs.length;this.m_Childs.push(c);c.m_Parent=this;c.m_Index=e};k.PolyNode.prototype.GetNext=function(){return 0<this.m_Childs.length?this.m_Childs[0]:this.GetNextSiblingUp()};k.PolyNode.prototype.GetNextSiblingUp=function(){return null===this.m_Parent?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+
1]};k.PolyNode.prototype.Childs=function(){return this.m_Childs};k.PolyNode.prototype.Parent=function(){return this.m_Parent};k.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()};k.PolyTree=function(){this.m_AllPolys=[];k.PolyNode.call(this)};k.PolyTree.prototype.Clear=function(){for(var c=0,e=this.m_AllPolys.length;c<e;c++)this.m_AllPolys[c]=null;this.m_AllPolys.length=0;this.m_Childs.length=0};k.PolyTree.prototype.GetFirst=function(){return 0<this.m_Childs.length?this.m_Childs[0]:null};
k.PolyTree.prototype.Total=function(){var c=this.m_AllPolys.length;0<c&&this.m_Childs[0]!=this.m_AllPolys[0]&&c--;return c};na(k.PolyTree,k.PolyNode);k.Math_Abs_Int64=k.Math_Abs_Int32=k.Math_Abs_Double=function(c){return Math.abs(c)};k.Math_Max_Int32_Int32=function(c,e){return Math.max(c,e)};k.Cast_Int32=qa||U||Pa?function(c){return c|0}:function(c){return~~c};k.Cast_Int64=G?function(c){return-2147483648>c||2147483647<c?0>c?Math.ceil(c):Math.floor(c):~~c}:tb&&"function"==typeof Number.toInteger?function(c){return Number.toInteger(c)}:
ub||vb?function(c){return parseInt(c,10)}:qa?function(c){return-2147483648>c||2147483647<c?0>c?Math.ceil(c):Math.floor(c):c|0}:function(c){return 0>c?Math.ceil(c):Math.floor(c)};k.Clear=function(c){c.length=0};k.PI=3.141592653589793;k.PI2=6.283185307179586;k.IntPoint=function(){var c=arguments,e=c.length;this.Y=this.X=0;k.use_xyz?(this.Z=0,3==e?(this.X=c[0],this.Y=c[1],this.Z=c[2]):2==e?(this.X=c[0],this.Y=c[1],this.Z=0):1==e?c[0]instanceof k.DoublePoint?(c=c[0],this.X=k.Clipper.Round(c.X),this.Y=
k.Clipper.Round(c.Y),this.Z=0):(c=c[0],"undefined"==typeof c.Z&&(c.Z=0),this.X=c.X,this.Y=c.Y,this.Z=c.Z):this.Z=this.Y=this.X=0):2==e?(this.X=c[0],this.Y=c[1]):1==e?c[0]instanceof k.DoublePoint?(c=c[0],this.X=k.Clipper.Round(c.X),this.Y=k.Clipper.Round(c.Y)):(c=c[0],this.X=c.X,this.Y=c.Y):this.Y=this.X=0};k.IntPoint.op_Equality=function(c,e){return c.X==e.X&&c.Y==e.Y};k.IntPoint.op_Inequality=function(c,e){return c.X!=e.X||c.Y!=e.Y};k.use_xyz?(k.IntPoint0=function(){this.Z=this.Y=this.X=0},k.IntPoint1=
function(c){this.X=c.X;this.Y=c.Y;this.Z=c.Z},k.IntPoint1dp=function(c){this.X=k.Clipper.Round(c.X);this.Y=k.Clipper.Round(c.Y);this.Z=0},k.IntPoint2=function(c,e){this.X=c;this.Y=e;this.Z=0},k.IntPoint3=function(c,e,b){this.X=c;this.Y=e;this.Z=b}):(k.IntPoint0=function(){this.Y=this.X=0},k.IntPoint1=function(c){this.X=c.X;this.Y=c.Y},k.IntPoint1dp=function(c){this.X=k.Clipper.Round(c.X);this.Y=k.Clipper.Round(c.Y)},k.IntPoint2=function(c,e){this.X=c;this.Y=e});k.IntRect=function(){var c=arguments,
e=c.length;4==e?(this.left=c[0],this.top=c[1],this.right=c[2],this.bottom=c[3]):1==e?(this.left=c[0].left,this.top=c[0].top,this.right=c[0].right,this.bottom=c[0].bottom):this.bottom=this.right=this.top=this.left=0};k.IntRect0=function(){this.bottom=this.right=this.top=this.left=0};k.IntRect1=function(c){this.left=c.left;this.top=c.top;this.right=c.right;this.bottom=c.bottom};k.IntRect4=function(c,e,b,k){this.left=c;this.top=e;this.right=b;this.bottom=k};k.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,
ctXor:3};k.PolyType={ptSubject:0,ptClip:1};k.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3};k.JoinType={jtSquare:0,jtRound:1,jtMiter:2};k.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4};k.EdgeSide={esLeft:0,esRight:1};k.Direction={dRightToLeft:0,dLeftToRight:1};k.TEdge=function(){this.Bot=new k.IntPoint;this.Curr=new k.IntPoint;this.Top=new k.IntPoint;this.Delta=new k.IntPoint;this.Dx=0;this.PolyTyp=k.PolyType.ptSubject;this.Side=k.EdgeSide.esLeft;
this.OutIdx=this.WindCnt2=this.WindCnt=this.WindDelta=0;this.PrevInSEL=this.NextInSEL=this.PrevInAEL=this.NextInAEL=this.NextInLML=this.Prev=this.Next=null};k.IntersectNode=function(){this.Edge2=this.Edge1=null;this.Pt=new k.IntPoint};k.MyIntersectNodeSort=function(){};k.MyIntersectNodeSort.Compare=function(c,e){c=e.Pt.Y-c.Pt.Y;return 0<c?1:0>c?-1:0};k.LocalMinima=function(){this.Y=0;this.Next=this.RightBound=this.LeftBound=null};k.Scanbeam=function(){this.Y=0;this.Next=null};k.OutRec=function(){this.Idx=
0;this.IsOpen=this.IsHole=!1;this.PolyNode=this.BottomPt=this.Pts=this.FirstLeft=null};k.OutPt=function(){this.Idx=0;this.Pt=new k.IntPoint;this.Prev=this.Next=null};k.Join=function(){this.OutPt2=this.OutPt1=null;this.OffPt=new k.IntPoint};k.ClipperBase=function(){this.m_CurrentLM=this.m_MinimaList=null;this.m_edges=[];this.PreserveCollinear=this.m_HasOpenPaths=this.m_UseFullRange=!1;this.m_CurrentLM=this.m_MinimaList=null;this.m_HasOpenPaths=this.m_UseFullRange=!1};k.ClipperBase.horizontal=-9007199254740992;
k.ClipperBase.Skip=-2;k.ClipperBase.Unassigned=-1;k.ClipperBase.tolerance=1E-20;k.ClipperBase.loRange=47453132;k.ClipperBase.hiRange=0xfffffffffffff;k.ClipperBase.near_zero=function(c){return c>-k.ClipperBase.tolerance&&c<k.ClipperBase.tolerance};k.ClipperBase.IsHorizontal=function(c){return 0===c.Delta.Y};k.ClipperBase.prototype.PointIsVertex=function(c,e){var b=e;do{if(k.IntPoint.op_Equality(b.Pt,c))return!0;b=b.Next}while(b!=e);return!1};k.ClipperBase.prototype.PointOnLineSegment=function(c,e,
q,k){return k?c.X==e.X&&c.Y==e.Y||c.X==q.X&&c.Y==q.Y||c.X>e.X==c.X<q.X&&c.Y>e.Y==c.Y<q.Y&&b.op_Equality(b.Int128Mul(c.X-e.X,q.Y-e.Y),b.Int128Mul(q.X-e.X,c.Y-e.Y)):c.X==e.X&&c.Y==e.Y||c.X==q.X&&c.Y==q.Y||c.X>e.X==c.X<q.X&&c.Y>e.Y==c.Y<q.Y&&(c.X-e.X)*(q.Y-e.Y)==(q.X-e.X)*(c.Y-e.Y)};k.ClipperBase.prototype.PointOnPolygon=function(c,e,b){for(var q=e;;){if(this.PointOnLineSegment(c,q.Pt,q.Next.Pt,b))return!0;q=q.Next;if(q==e)break}return!1};k.ClipperBase.prototype.SlopesEqual=k.ClipperBase.SlopesEqual=
function(){var c=arguments,e=c.length,q,g;if(3==e)return e=c[0],q=c[1],c[2]?b.op_Equality(b.Int128Mul(e.Delta.Y,q.Delta.X),b.Int128Mul(e.Delta.X,q.Delta.Y)):k.Cast_Int64(e.Delta.Y*q.Delta.X)==k.Cast_Int64(e.Delta.X*q.Delta.Y);if(4==e)return e=c[0],q=c[1],g=c[2],c[3]?b.op_Equality(b.Int128Mul(e.Y-q.Y,q.X-g.X),b.Int128Mul(e.X-q.X,q.Y-g.Y)):0===k.Cast_Int64((e.Y-q.Y)*(q.X-g.X))-k.Cast_Int64((e.X-q.X)*(q.Y-g.Y));e=c[0];q=c[1];g=c[2];var h=c[3];return c[4]?b.op_Equality(b.Int128Mul(e.Y-q.Y,g.X-h.X),b.Int128Mul(e.X-
q.X,g.Y-h.Y)):0===k.Cast_Int64((e.Y-q.Y)*(g.X-h.X))-k.Cast_Int64((e.X-q.X)*(g.Y-h.Y))};k.ClipperBase.SlopesEqual3=function(c,e,q){return q?b.op_Equality(b.Int128Mul(c.Delta.Y,e.Delta.X),b.Int128Mul(c.Delta.X,e.Delta.Y)):k.Cast_Int64(c.Delta.Y*e.Delta.X)==k.Cast_Int64(c.Delta.X*e.Delta.Y)};k.ClipperBase.SlopesEqual4=function(c,e,q,g){return g?b.op_Equality(b.Int128Mul(c.Y-e.Y,e.X-q.X),b.Int128Mul(c.X-e.X,e.Y-q.Y)):0===k.Cast_Int64((c.Y-e.Y)*(e.X-q.X))-k.Cast_Int64((c.X-e.X)*(e.Y-q.Y))};k.ClipperBase.SlopesEqual5=
function(c,e,q,g,h){return h?b.op_Equality(b.Int128Mul(c.Y-e.Y,q.X-g.X),b.Int128Mul(c.X-e.X,q.Y-g.Y)):0===k.Cast_Int64((c.Y-e.Y)*(q.X-g.X))-k.Cast_Int64((c.X-e.X)*(q.Y-g.Y))};k.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var c=0,e=this.m_edges.length;c<e;++c){for(var b=0,g=this.m_edges[c].length;b<g;++b)this.m_edges[c][b]=null;k.Clear(this.m_edges[c])}k.Clear(this.m_edges);this.m_HasOpenPaths=this.m_UseFullRange=!1};k.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;null!==
this.m_MinimaList;){var c=this.m_MinimaList.Next;this.m_MinimaList=null;this.m_MinimaList=c}this.m_CurrentLM=null};k.ClipperBase.prototype.RangeTest=function(c,e){if(e.Value)(c.X>k.ClipperBase.hiRange||c.Y>k.ClipperBase.hiRange||-c.X>k.ClipperBase.hiRange||-c.Y>k.ClipperBase.hiRange)&&k.Error("Coordinate outside allowed range in RangeTest().");else if(c.X>k.ClipperBase.loRange||c.Y>k.ClipperBase.loRange||-c.X>k.ClipperBase.loRange||-c.Y>k.ClipperBase.loRange)e.Value=!0,this.RangeTest(c,e)};k.ClipperBase.prototype.InitEdge=
function(c,e,b,g){c.Next=e;c.Prev=b;c.Curr.X=g.X;c.Curr.Y=g.Y;k.use_xyz&&(c.Curr.Z=g.Z);c.OutIdx=-1};k.ClipperBase.prototype.InitEdge2=function(c,e){c.Curr.Y>=c.Next.Curr.Y?(c.Bot.X=c.Curr.X,c.Bot.Y=c.Curr.Y,k.use_xyz&&(c.Bot.Z=c.Curr.Z),c.Top.X=c.Next.Curr.X,c.Top.Y=c.Next.Curr.Y,k.use_xyz&&(c.Top.Z=c.Next.Curr.Z)):(c.Top.X=c.Curr.X,c.Top.Y=c.Curr.Y,k.use_xyz&&(c.Top.Z=c.Curr.Z),c.Bot.X=c.Next.Curr.X,c.Bot.Y=c.Next.Curr.Y,k.use_xyz&&(c.Bot.Z=c.Next.Curr.Z));this.SetDx(c);c.PolyTyp=e};k.ClipperBase.prototype.FindNextLocMin=
function(c){for(var e;;){for(;k.IntPoint.op_Inequality(c.Bot,c.Prev.Bot)||k.IntPoint.op_Equality(c.Curr,c.Top);)c=c.Next;if(c.Dx!=k.ClipperBase.horizontal&&c.Prev.Dx!=k.ClipperBase.horizontal)break;for(;c.Prev.Dx==k.ClipperBase.horizontal;)c=c.Prev;for(e=c;c.Dx==k.ClipperBase.horizontal;)c=c.Next;if(c.Top.Y!=c.Prev.Bot.Y){e.Prev.Bot.X<c.Bot.X&&(c=e);break}}return c};k.ClipperBase.prototype.ProcessBound=function(c,e){var b,g=c,h;if(g.OutIdx==k.ClipperBase.Skip){c=g;if(e){for(;c.Top.Y==c.Next.Bot.Y;)c=
c.Next;for(;c!=g&&c.Dx==k.ClipperBase.horizontal;)c=c.Prev}else{for(;c.Top.Y==c.Prev.Bot.Y;)c=c.Prev;for(;c!=g&&c.Dx==k.ClipperBase.horizontal;)c=c.Next}c==g?g=e?c.Next:c.Prev:(c=e?g.Next:g.Prev,b=new k.LocalMinima,b.Next=null,b.Y=c.Bot.Y,b.LeftBound=null,b.RightBound=c,c.WindDelta=0,g=this.ProcessBound(c,e),this.InsertLocalMinima(b));return g}c.Dx==k.ClipperBase.horizontal&&(b=e?c.Prev:c.Next,b.OutIdx!=k.ClipperBase.Skip&&(b.Dx==k.ClipperBase.horizontal?b.Bot.X!=c.Bot.X&&b.Top.X!=c.Bot.X&&this.ReverseHorizontal(c):
b.Bot.X!=c.Bot.X&&this.ReverseHorizontal(c)));b=c;if(e){for(;g.Top.Y==g.Next.Bot.Y&&g.Next.OutIdx!=k.ClipperBase.Skip;)g=g.Next;if(g.Dx==k.ClipperBase.horizontal&&g.Next.OutIdx!=k.ClipperBase.Skip){for(h=g;h.Prev.Dx==k.ClipperBase.horizontal;)h=h.Prev;h.Prev.Top.X==g.Next.Top.X?e||(g=h.Prev):h.Prev.Top.X>g.Next.Top.X&&(g=h.Prev)}for(;c!=g;)c.NextInLML=c.Next,c.Dx==k.ClipperBase.horizontal&&c!=b&&c.Bot.X!=c.Prev.Top.X&&this.ReverseHorizontal(c),c=c.Next;c.Dx==k.ClipperBase.horizontal&&c!=b&&c.Bot.X!=
c.Prev.Top.X&&this.ReverseHorizontal(c);g=g.Next}else{for(;g.Top.Y==g.Prev.Bot.Y&&g.Prev.OutIdx!=k.ClipperBase.Skip;)g=g.Prev;if(g.Dx==k.ClipperBase.horizontal&&g.Prev.OutIdx!=k.ClipperBase.Skip){for(h=g;h.Next.Dx==k.ClipperBase.horizontal;)h=h.Next;h.Next.Top.X==g.Prev.Top.X?e||(g=h.Next):h.Next.Top.X>g.Prev.Top.X&&(g=h.Next)}for(;c!=g;)c.NextInLML=c.Prev,c.Dx==k.ClipperBase.horizontal&&c!=b&&c.Bot.X!=c.Next.Top.X&&this.ReverseHorizontal(c),c=c.Prev;c.Dx==k.ClipperBase.horizontal&&c!=b&&c.Bot.X!=
c.Next.Top.X&&this.ReverseHorizontal(c);g=g.Prev}return g};k.ClipperBase.prototype.AddPath=function(c,e,b){k.use_lines?b||e!=k.PolyType.ptClip||k.Error("AddPath: Open paths must be subject."):b||k.Error("AddPath: Open paths have been disabled.");var q=c.length-1;if(b)for(;0<q&&k.IntPoint.op_Equality(c[q],c[0]);)--q;for(;0<q&&k.IntPoint.op_Equality(c[q],c[q-1]);)--q;if(b&&2>q||!b&&1>q)return!1;for(var g=[],h=0;h<=q;h++)g.push(new k.TEdge);var l=!0;g[1].Curr.X=c[1].X;g[1].Curr.Y=c[1].Y;k.use_xyz&&(g[1].Curr.Z=
c[1].Z);var p={Value:this.m_UseFullRange};this.RangeTest(c[0],p);this.m_UseFullRange=p.Value;p.Value=this.m_UseFullRange;this.RangeTest(c[q],p);this.m_UseFullRange=p.Value;this.InitEdge(g[0],g[1],g[q],c[0]);this.InitEdge(g[q],g[0],g[q-1],c[q]);for(h=q-1;1<=h;--h)p.Value=this.m_UseFullRange,this.RangeTest(c[h],p),this.m_UseFullRange=p.Value,this.InitEdge(g[h],g[h+1],g[h-1],c[h]);for(h=c=q=g[0];;)if(c.Curr!=c.Next.Curr||!b&&c.Next==q){if(c.Prev==c.Next)break;else if(b&&k.ClipperBase.SlopesEqual(c.Prev.Curr,
c.Curr,c.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(c.Prev.Curr,c.Curr,c.Next.Curr))){c==q&&(q=c.Next);c=this.RemoveEdge(c);h=c=c.Prev;continue}c=c.Next;if(c==h||!b&&c.Next==q)break}else{if(c==c.Next)break;c==q&&(q=c.Next);h=c=this.RemoveEdge(c)}if(!b&&c==c.Next||b&&c.Prev==c.Next)return!1;b||(this.m_HasOpenPaths=!0,q.Prev.OutIdx=k.ClipperBase.Skip);c=q;do this.InitEdge2(c,e),c=c.Next,l&&c.Curr.Y!=q.Curr.Y&&(l=!1);while(c!=q);if(l){if(b)return!1;c.Prev.OutIdx=
k.ClipperBase.Skip;c.Prev.Bot.X<c.Prev.Top.X&&this.ReverseHorizontal(c.Prev);e=new k.LocalMinima;e.Next=null;e.Y=c.Bot.Y;e.LeftBound=null;e.RightBound=c;e.RightBound.Side=k.EdgeSide.esRight;for(e.RightBound.WindDelta=0;c.Next.OutIdx!=k.ClipperBase.Skip;)c.NextInLML=c.Next,c.Bot.X!=c.Prev.Top.X&&this.ReverseHorizontal(c),c=c.Next;this.InsertLocalMinima(e);this.m_edges.push(g);return!0}this.m_edges.push(g);l=null;for(k.IntPoint.op_Equality(c.Prev.Bot,c.Prev.Top)&&(c=c.Next);;){c=this.FindNextLocMin(c);
if(c==l)break;else null==l&&(l=c);e=new k.LocalMinima;e.Next=null;e.Y=c.Bot.Y;c.Dx<c.Prev.Dx?(e.LeftBound=c.Prev,e.RightBound=c,g=!1):(e.LeftBound=c,e.RightBound=c.Prev,g=!0);e.LeftBound.Side=k.EdgeSide.esLeft;e.RightBound.Side=k.EdgeSide.esRight;e.LeftBound.WindDelta=b?e.LeftBound.Next==e.RightBound?-1:1:0;e.RightBound.WindDelta=-e.LeftBound.WindDelta;c=this.ProcessBound(e.LeftBound,g);c.OutIdx==k.ClipperBase.Skip&&(c=this.ProcessBound(c,g));q=this.ProcessBound(e.RightBound,!g);q.OutIdx==k.ClipperBase.Skip&&
(q=this.ProcessBound(q,!g));e.LeftBound.OutIdx==k.ClipperBase.Skip?e.LeftBound=null:e.RightBound.OutIdx==k.ClipperBase.Skip&&(e.RightBound=null);this.InsertLocalMinima(e);g||(c=q)}return!0};k.ClipperBase.prototype.AddPaths=function(c,e,b){for(var q=!1,k=0,g=c.length;k<g;++k)this.AddPath(c[k],e,b)&&(q=!0);return q};k.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(c,e,b){return k.IntPoint.op_Equality(c,b)||k.IntPoint.op_Equality(c,e)||k.IntPoint.op_Equality(b,e)?!1:c.X!=b.X?e.X>c.X==e.X<b.X:e.Y>
c.Y==e.Y<b.Y};k.ClipperBase.prototype.RemoveEdge=function(c){c.Prev.Next=c.Next;c.Next.Prev=c.Prev;var e=c.Next;c.Prev=null;return e};k.ClipperBase.prototype.SetDx=function(c){c.Delta.X=c.Top.X-c.Bot.X;c.Delta.Y=c.Top.Y-c.Bot.Y;c.Dx=0===c.Delta.Y?k.ClipperBase.horizontal:c.Delta.X/c.Delta.Y};k.ClipperBase.prototype.InsertLocalMinima=function(c){if(null===this.m_MinimaList)this.m_MinimaList=c;else if(c.Y>=this.m_MinimaList.Y)c.Next=this.m_MinimaList,this.m_MinimaList=c;else{for(var e=this.m_MinimaList;null!==
e.Next&&c.Y<e.Next.Y;)e=e.Next;c.Next=e.Next;e.Next=c}};k.ClipperBase.prototype.PopLocalMinima=function(){null!==this.m_CurrentLM&&(this.m_CurrentLM=this.m_CurrentLM.Next)};k.ClipperBase.prototype.ReverseHorizontal=function(c){var e=c.Top.X;c.Top.X=c.Bot.X;c.Bot.X=e;k.use_xyz&&(e=c.Top.Z,c.Top.Z=c.Bot.Z,c.Bot.Z=e)};k.ClipperBase.prototype.Reset=function(){this.m_CurrentLM=this.m_MinimaList;if(null!=this.m_CurrentLM)for(var c=this.m_MinimaList;null!=c;){var e=c.LeftBound;null!=e&&(e.Curr.X=e.Bot.X,
e.Curr.Y=e.Bot.Y,k.use_xyz&&(e.Curr.Z=e.Bot.Z),e.Side=k.EdgeSide.esLeft,e.OutIdx=k.ClipperBase.Unassigned);e=c.RightBound;null!=e&&(e.Curr.X=e.Bot.X,e.Curr.Y=e.Bot.Y,k.use_xyz&&(e.Curr.Z=e.Bot.Z),e.Side=k.EdgeSide.esRight,e.OutIdx=k.ClipperBase.Unassigned);c=c.Next}};k.Clipper=function(c){"undefined"==typeof c&&(c=0);this.m_PolyOuts=null;this.m_ClipType=k.ClipType.ctIntersection;this.m_IntersectNodeComparer=this.m_IntersectList=this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;this.m_ExecuteLocked=
!1;this.m_SubjFillType=this.m_ClipFillType=k.PolyFillType.pftEvenOdd;this.m_GhostJoins=this.m_Joins=null;this.StrictlySimple=this.ReverseSolution=this.m_UsingPolyTree=!1;k.ClipperBase.call(this);this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;this.m_IntersectList=[];this.m_IntersectNodeComparer=k.MyIntersectNodeSort.Compare;this.m_UsingPolyTree=this.m_ExecuteLocked=!1;this.m_PolyOuts=[];this.m_Joins=[];this.m_GhostJoins=[];this.ReverseSolution=0!==(1&c);this.StrictlySimple=0!==(2&c);this.PreserveCollinear=
0!==(4&c);k.use_xyz&&(this.ZFillFunction=null)};k.Clipper.ioReverseSolution=1;k.Clipper.ioStrictlySimple=2;k.Clipper.ioPreserveCollinear=4;k.Clipper.prototype.Clear=function(){0!==this.m_edges.length&&(this.DisposeAllPolyPts(),k.ClipperBase.prototype.Clear.call(this))};k.Clipper.prototype.DisposeScanbeamList=function(){for(;null!==this.m_Scanbeam;){var c=this.m_Scanbeam.Next;this.m_Scanbeam=null;this.m_Scanbeam=c}};k.Clipper.prototype.Reset=function(){k.ClipperBase.prototype.Reset.call(this);this.m_SortedEdges=
this.m_ActiveEdges=this.m_Scanbeam=null;for(var c=this.m_MinimaList;null!==c;)this.InsertScanbeam(c.Y),c=c.Next};k.Clipper.prototype.InsertScanbeam=function(c){if(null===this.m_Scanbeam)this.m_Scanbeam=new k.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=c;else if(c>this.m_Scanbeam.Y){var e=new k.Scanbeam;e.Y=c;e.Next=this.m_Scanbeam;this.m_Scanbeam=e}else{for(var b=this.m_Scanbeam;null!==b.Next&&c<=b.Next.Y;)b=b.Next;c!=b.Y&&(e=new k.Scanbeam,e.Y=c,e.Next=b.Next,b.Next=e)}};k.Clipper.prototype.Execute=
function(){var c=arguments,e=c.length,b=c[1]instanceof k.PolyTree;if(4!=e||b){if(4==e&&b){e=c[0];var g=c[1];b=c[2];c=c[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0;this.m_SubjFillType=b;this.m_ClipFillType=c;this.m_ClipType=e;this.m_UsingPolyTree=!0;try{(h=this.ExecuteInternal())&&this.BuildResult2(g)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return h}if(2==e&&!b||2==e&&b)return e=c[0],g=c[1],this.Execute(e,g,k.PolyFillType.pftEvenOdd,k.PolyFillType.pftEvenOdd)}else{e=
c[0];g=c[1];b=c[2];c=c[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&k.Error("Error: PolyTree struct is need for open path clipping.");this.m_ExecuteLocked=!0;k.Clear(g);this.m_SubjFillType=b;this.m_ClipFillType=c;this.m_ClipType=e;this.m_UsingPolyTree=!1;try{var h=this.ExecuteInternal();h&&this.BuildResult(g)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return h}};k.Clipper.prototype.FixHoleLinkage=function(c){if(null!==c.FirstLeft&&(c.IsHole==c.FirstLeft.IsHole||null===c.FirstLeft.Pts)){for(var e=
c.FirstLeft;null!==e&&(e.IsHole==c.IsHole||null===e.Pts);)e=e.FirstLeft;c.FirstLeft=e}};k.Clipper.prototype.ExecuteInternal=function(){try{this.Reset();if(null===this.m_CurrentLM)return!1;var c=this.PopScanbeam();do{this.InsertLocalMinimaIntoAEL(c);k.Clear(this.m_GhostJoins);this.ProcessHorizontals(!1);if(null===this.m_Scanbeam)break;var e=this.PopScanbeam();if(!this.ProcessIntersections(e))return!1;this.ProcessEdgesAtTopOfScanbeam(e);c=e}while(null!==this.m_Scanbeam||null!==this.m_CurrentLM);c=0;
for(var b=this.m_PolyOuts.length;c<b;c++){var g=this.m_PolyOuts[c];null===g.Pts||g.IsOpen||(g.IsHole^this.ReverseSolution)==0<this.Area(g)&&this.ReversePolyPtLinks(g.Pts)}this.JoinCommonEdges();c=0;for(b=this.m_PolyOuts.length;c<b;c++)g=this.m_PolyOuts[c],null===g.Pts||g.IsOpen||this.FixupOutPolygon(g);this.StrictlySimple&&this.DoSimplePolygons();return!0}finally{k.Clear(this.m_Joins),k.Clear(this.m_GhostJoins)}};k.Clipper.prototype.PopScanbeam=function(){var c=this.m_Scanbeam.Y;this.m_Scanbeam=this.m_Scanbeam.Next;
return c};k.Clipper.prototype.DisposeAllPolyPts=function(){for(var c=0,e=this.m_PolyOuts.length;c<e;++c)this.DisposeOutRec(c);k.Clear(this.m_PolyOuts)};k.Clipper.prototype.DisposeOutRec=function(c){this.m_PolyOuts[c].Pts=null;this.m_PolyOuts[c]=null};k.Clipper.prototype.AddJoin=function(c,e,b){var q=new k.Join;q.OutPt1=c;q.OutPt2=e;q.OffPt.X=b.X;q.OffPt.Y=b.Y;k.use_xyz&&(q.OffPt.Z=b.Z);this.m_Joins.push(q)};k.Clipper.prototype.AddGhostJoin=function(c,e){var b=new k.Join;b.OutPt1=c;b.OffPt.X=e.X;b.OffPt.Y=
e.Y;k.use_xyz&&(b.OffPt.Z=e.Z);this.m_GhostJoins.push(b)};k.Clipper.prototype.SetZ=function(c,e,b){null!==this.ZFillFunction&&0==c.Z&&null!==this.ZFillFunction&&(k.IntPoint.op_Equality(c,e.Bot)?c.Z=e.Bot.Z:k.IntPoint.op_Equality(c,e.Top)?c.Z=e.Top.Z:k.IntPoint.op_Equality(c,b.Bot)?c.Z=b.Bot.Z:k.IntPoint.op_Equality(c,b.Top)?c.Z=b.Top.Z:this.ZFillFunction(e.Bot,e.Top,b.Bot,b.Top,c))};k.Clipper.prototype.InsertLocalMinimaIntoAEL=function(c){for(;null!==this.m_CurrentLM&&this.m_CurrentLM.Y==c;){var e=
this.m_CurrentLM.LeftBound,b=this.m_CurrentLM.RightBound;this.PopLocalMinima();var g=null;null===e?(this.InsertEdgeIntoAEL(b,null),this.SetWindingCount(b),this.IsContributing(b)&&(g=this.AddOutPt(b,b.Bot))):(null==b?(this.InsertEdgeIntoAEL(e,null),this.SetWindingCount(e),this.IsContributing(e)&&(g=this.AddOutPt(e,e.Bot))):(this.InsertEdgeIntoAEL(e,null),this.InsertEdgeIntoAEL(b,e),this.SetWindingCount(e),b.WindCnt=e.WindCnt,b.WindCnt2=e.WindCnt2,this.IsContributing(e)&&(g=this.AddLocalMinPoly(e,b,
e.Bot))),this.InsertScanbeam(e.Top.Y));null!=b&&(k.ClipperBase.IsHorizontal(b)?this.AddEdgeToSEL(b):this.InsertScanbeam(b.Top.Y));if(null!=e&&null!=b){if(null!==g&&k.ClipperBase.IsHorizontal(b)&&0<this.m_GhostJoins.length&&0!==b.WindDelta)for(var h=0,l=this.m_GhostJoins.length;h<l;h++){var p=this.m_GhostJoins[h];this.HorzSegmentsOverlap(p.OutPt1.Pt.X,p.OffPt.X,b.Bot.X,b.Top.X)&&this.AddJoin(p.OutPt1,g,p.OffPt)}0<=e.OutIdx&&null!==e.PrevInAEL&&e.PrevInAEL.Curr.X==e.Bot.X&&0<=e.PrevInAEL.OutIdx&&k.ClipperBase.SlopesEqual(e.PrevInAEL,
e,this.m_UseFullRange)&&0!==e.WindDelta&&0!==e.PrevInAEL.WindDelta&&(h=this.AddOutPt(e.PrevInAEL,e.Bot),this.AddJoin(g,h,e.Top));if(e.NextInAEL!=b&&(0<=b.OutIdx&&0<=b.PrevInAEL.OutIdx&&k.ClipperBase.SlopesEqual(b.PrevInAEL,b,this.m_UseFullRange)&&0!==b.WindDelta&&0!==b.PrevInAEL.WindDelta&&(h=this.AddOutPt(b.PrevInAEL,b.Bot),this.AddJoin(g,h,b.Top)),g=e.NextInAEL,null!==g))for(;g!=b;)this.IntersectEdges(b,g,e.Curr,!1),g=g.NextInAEL}}};k.Clipper.prototype.InsertEdgeIntoAEL=function(c,e){if(null===
this.m_ActiveEdges)c.PrevInAEL=null,c.NextInAEL=null,this.m_ActiveEdges=c;else if(null===e&&this.E2InsertsBeforeE1(this.m_ActiveEdges,c))c.PrevInAEL=null,c.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges=this.m_ActiveEdges.PrevInAEL=c;else{for(null===e&&(e=this.m_ActiveEdges);null!==e.NextInAEL&&!this.E2InsertsBeforeE1(e.NextInAEL,c);)e=e.NextInAEL;c.NextInAEL=e.NextInAEL;null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=c);c.PrevInAEL=e;e.NextInAEL=c}};k.Clipper.prototype.E2InsertsBeforeE1=function(c,e){return e.Curr.X==
c.Curr.X?e.Top.Y>c.Top.Y?e.Top.X<k.Clipper.TopX(c,e.Top.Y):c.Top.X>k.Clipper.TopX(e,c.Top.Y):e.Curr.X<c.Curr.X};k.Clipper.prototype.IsEvenOddFillType=function(c){return c.PolyTyp==k.PolyType.ptSubject?this.m_SubjFillType==k.PolyFillType.pftEvenOdd:this.m_ClipFillType==k.PolyFillType.pftEvenOdd};k.Clipper.prototype.IsEvenOddAltFillType=function(c){return c.PolyTyp==k.PolyType.ptSubject?this.m_ClipFillType==k.PolyFillType.pftEvenOdd:this.m_SubjFillType==k.PolyFillType.pftEvenOdd};k.Clipper.prototype.IsContributing=
function(c){var e,b;c.PolyTyp==k.PolyType.ptSubject?(e=this.m_SubjFillType,b=this.m_ClipFillType):(e=this.m_ClipFillType,b=this.m_SubjFillType);switch(e){case k.PolyFillType.pftEvenOdd:if(0===c.WindDelta&&1!=c.WindCnt)return!1;break;case k.PolyFillType.pftNonZero:if(1!=Math.abs(c.WindCnt))return!1;break;case k.PolyFillType.pftPositive:if(1!=c.WindCnt)return!1;break;default:if(-1!=c.WindCnt)return!1}switch(this.m_ClipType){case k.ClipType.ctIntersection:switch(b){case k.PolyFillType.pftEvenOdd:case k.PolyFillType.pftNonZero:return 0!==
c.WindCnt2;case k.PolyFillType.pftPositive:return 0<c.WindCnt2;default:return 0>c.WindCnt2}case k.ClipType.ctUnion:switch(b){case k.PolyFillType.pftEvenOdd:case k.PolyFillType.pftNonZero:return 0===c.WindCnt2;case k.PolyFillType.pftPositive:return 0>=c.WindCnt2;default:return 0<=c.WindCnt2}case k.ClipType.ctDifference:if(c.PolyTyp==k.PolyType.ptSubject)switch(b){case k.PolyFillType.pftEvenOdd:case k.PolyFillType.pftNonZero:return 0===c.WindCnt2;case k.PolyFillType.pftPositive:return 0>=c.WindCnt2;
default:return 0<=c.WindCnt2}else switch(b){case k.PolyFillType.pftEvenOdd:case k.PolyFillType.pftNonZero:return 0!==c.WindCnt2;case k.PolyFillType.pftPositive:return 0<c.WindCnt2;default:return 0>c.WindCnt2}case k.ClipType.ctXor:if(0===c.WindDelta)switch(b){case k.PolyFillType.pftEvenOdd:case k.PolyFillType.pftNonZero:return 0===c.WindCnt2;case k.PolyFillType.pftPositive:return 0>=c.WindCnt2;default:return 0<=c.WindCnt2}}return!0};k.Clipper.prototype.SetWindingCount=function(c){for(var e=c.PrevInAEL;null!==
e&&(e.PolyTyp!=c.PolyTyp||0===e.WindDelta);)e=e.PrevInAEL;if(null===e)c.WindCnt=0===c.WindDelta?1:c.WindDelta,c.WindCnt2=0,e=this.m_ActiveEdges;else{if(0===c.WindDelta&&this.m_ClipType!=k.ClipType.ctUnion)c.WindCnt=1;else if(this.IsEvenOddFillType(c))if(0===c.WindDelta){for(var b=!0,g=e.PrevInAEL;null!==g;)g.PolyTyp==e.PolyTyp&&0!==g.WindDelta&&(b=!b),g=g.PrevInAEL;c.WindCnt=b?0:1}else c.WindCnt=c.WindDelta;else c.WindCnt=0>e.WindCnt*e.WindDelta?1<Math.abs(e.WindCnt)?0>e.WindDelta*c.WindDelta?e.WindCnt:
e.WindCnt+c.WindDelta:0===c.WindDelta?1:c.WindDelta:0===c.WindDelta?0>e.WindCnt?e.WindCnt-1:e.WindCnt+1:0>e.WindDelta*c.WindDelta?e.WindCnt:e.WindCnt+c.WindDelta;c.WindCnt2=e.WindCnt2;e=e.NextInAEL}if(this.IsEvenOddAltFillType(c))for(;e!=c;)0!==e.WindDelta&&(c.WindCnt2=0===c.WindCnt2?1:0),e=e.NextInAEL;else for(;e!=c;)c.WindCnt2+=e.WindDelta,e=e.NextInAEL};k.Clipper.prototype.AddEdgeToSEL=function(c){null===this.m_SortedEdges?(this.m_SortedEdges=c,c.PrevInSEL=null,c.NextInSEL=null):(c.NextInSEL=this.m_SortedEdges,
c.PrevInSEL=null,this.m_SortedEdges=this.m_SortedEdges.PrevInSEL=c)};k.Clipper.prototype.CopyAELToSEL=function(){var c=this.m_ActiveEdges;for(this.m_SortedEdges=c;null!==c;)c.PrevInSEL=c.PrevInAEL,c=c.NextInSEL=c.NextInAEL};k.Clipper.prototype.SwapPositionsInAEL=function(c,e){if(c.NextInAEL!=c.PrevInAEL&&e.NextInAEL!=e.PrevInAEL){if(c.NextInAEL==e){var b=e.NextInAEL;null!==b&&(b.PrevInAEL=c);var k=c.PrevInAEL;null!==k&&(k.NextInAEL=e);e.PrevInAEL=k;e.NextInAEL=c;c.PrevInAEL=e;c.NextInAEL=b}else e.NextInAEL==
c?(b=c.NextInAEL,null!==b&&(b.PrevInAEL=e),k=e.PrevInAEL,null!==k&&(k.NextInAEL=c),c.PrevInAEL=k,c.NextInAEL=e,e.PrevInAEL=c,e.NextInAEL=b):(b=c.NextInAEL,k=c.PrevInAEL,c.NextInAEL=e.NextInAEL,null!==c.NextInAEL&&(c.NextInAEL.PrevInAEL=c),c.PrevInAEL=e.PrevInAEL,null!==c.PrevInAEL&&(c.PrevInAEL.NextInAEL=c),e.NextInAEL=b,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=e),e.PrevInAEL=k,null!==e.PrevInAEL&&(e.PrevInAEL.NextInAEL=e));null===c.PrevInAEL?this.m_ActiveEdges=c:null===e.PrevInAEL&&(this.m_ActiveEdges=
e)}};k.Clipper.prototype.SwapPositionsInSEL=function(c,e){if(null!==c.NextInSEL||null!==c.PrevInSEL)if(null!==e.NextInSEL||null!==e.PrevInSEL){if(c.NextInSEL==e){var b=e.NextInSEL;null!==b&&(b.PrevInSEL=c);var k=c.PrevInSEL;null!==k&&(k.NextInSEL=e);e.PrevInSEL=k;e.NextInSEL=c;c.PrevInSEL=e;c.NextInSEL=b}else e.NextInSEL==c?(b=c.NextInSEL,null!==b&&(b.PrevInSEL=e),k=e.PrevInSEL,null!==k&&(k.NextInSEL=c),c.PrevInSEL=k,c.NextInSEL=e,e.PrevInSEL=c,e.NextInSEL=b):(b=c.NextInSEL,k=c.PrevInSEL,c.NextInSEL=
e.NextInSEL,null!==c.NextInSEL&&(c.NextInSEL.PrevInSEL=c),c.PrevInSEL=e.PrevInSEL,null!==c.PrevInSEL&&(c.PrevInSEL.NextInSEL=c),e.NextInSEL=b,null!==e.NextInSEL&&(e.NextInSEL.PrevInSEL=e),e.PrevInSEL=k,null!==e.PrevInSEL&&(e.PrevInSEL.NextInSEL=e));null===c.PrevInSEL?this.m_SortedEdges=c:null===e.PrevInSEL&&(this.m_SortedEdges=e)}};k.Clipper.prototype.AddLocalMaxPoly=function(c,e,b){this.AddOutPt(c,b);0==e.WindDelta&&this.AddOutPt(e,b);c.OutIdx==e.OutIdx?(c.OutIdx=-1,e.OutIdx=-1):c.OutIdx<e.OutIdx?
this.AppendPolygon(c,e):this.AppendPolygon(e,c)};k.Clipper.prototype.AddLocalMinPoly=function(c,e,b){var q,g;k.ClipperBase.IsHorizontal(e)||c.Dx>e.Dx?(q=this.AddOutPt(c,b),e.OutIdx=c.OutIdx,c.Side=k.EdgeSide.esLeft,e.Side=k.EdgeSide.esRight,g=c,c=g.PrevInAEL==e?e.PrevInAEL:g.PrevInAEL):(q=this.AddOutPt(e,b),c.OutIdx=e.OutIdx,c.Side=k.EdgeSide.esRight,e.Side=k.EdgeSide.esLeft,g=e,c=g.PrevInAEL==c?c.PrevInAEL:g.PrevInAEL);null!==c&&0<=c.OutIdx&&k.Clipper.TopX(c,b.Y)==k.Clipper.TopX(g,b.Y)&&k.ClipperBase.SlopesEqual(g,
c,this.m_UseFullRange)&&0!==g.WindDelta&&0!==c.WindDelta&&(b=this.AddOutPt(c,b),this.AddJoin(q,b,g.Top));return q};k.Clipper.prototype.CreateOutRec=function(){var c=new k.OutRec;c.Idx=-1;c.IsHole=!1;c.IsOpen=!1;c.FirstLeft=null;c.Pts=null;c.BottomPt=null;c.PolyNode=null;this.m_PolyOuts.push(c);c.Idx=this.m_PolyOuts.length-1;return c};k.Clipper.prototype.AddOutPt=function(c,e){var b=c.Side==k.EdgeSide.esLeft;if(0>c.OutIdx){var g=this.CreateOutRec();g.IsOpen=0===c.WindDelta;var h=new k.OutPt;g.Pts=
h;h.Idx=g.Idx;h.Pt.X=e.X;h.Pt.Y=e.Y;k.use_xyz&&(h.Pt.Z=e.Z);h.Next=h;h.Prev=h;g.IsOpen||this.SetHoleState(c,g);c.OutIdx=g.Idx}else{g=this.m_PolyOuts[c.OutIdx];c=g.Pts;if(b&&k.IntPoint.op_Equality(e,c.Pt))return c;if(!b&&k.IntPoint.op_Equality(e,c.Prev.Pt))return c.Prev;h=new k.OutPt;h.Idx=g.Idx;h.Pt.X=e.X;h.Pt.Y=e.Y;k.use_xyz&&(h.Pt.Z=e.Z);h.Next=c;h.Prev=c.Prev;h.Prev.Next=h;c.Prev=h;b&&(g.Pts=h)}return h};k.Clipper.prototype.SwapPoints=function(c,e){var b=new k.IntPoint(c.Value);c.Value.X=e.Value.X;
c.Value.Y=e.Value.Y;k.use_xyz&&(c.Value.Z=e.Value.Z);e.Value.X=b.X;e.Value.Y=b.Y;k.use_xyz&&(e.Value.Z=b.Z)};k.Clipper.prototype.HorzSegmentsOverlap=function(c,e,b,k){var q;c>e&&(q=c,c=e,e=q);b>k&&(q=b,b=k,k=q);return c<k&&b<e};k.Clipper.prototype.SetHoleState=function(c,e){var b=!1;for(c=c.PrevInAEL;null!==c;)0<=c.OutIdx&&0!=c.WindDelta&&(b=!b,null===e.FirstLeft&&(e.FirstLeft=this.m_PolyOuts[c.OutIdx])),c=c.PrevInAEL;b&&(e.IsHole=!0)};k.Clipper.prototype.GetDx=function(c,e){return c.Y==e.Y?k.ClipperBase.horizontal:
(e.X-c.X)/(e.Y-c.Y)};k.Clipper.prototype.FirstIsBottomPt=function(c,e){for(var b=c.Prev;k.IntPoint.op_Equality(b.Pt,c.Pt)&&b!=c;)b=b.Prev;var g=Math.abs(this.GetDx(c.Pt,b.Pt));for(b=c.Next;k.IntPoint.op_Equality(b.Pt,c.Pt)&&b!=c;)b=b.Next;c=Math.abs(this.GetDx(c.Pt,b.Pt));for(b=e.Prev;k.IntPoint.op_Equality(b.Pt,e.Pt)&&b!=e;)b=b.Prev;var h=Math.abs(this.GetDx(e.Pt,b.Pt));for(b=e.Next;k.IntPoint.op_Equality(b.Pt,e.Pt)&&b!=e;)b=b.Next;b=Math.abs(this.GetDx(e.Pt,b.Pt));return g>=h&&g>=b||c>=h&&c>=b};
k.Clipper.prototype.GetBottomPt=function(c){for(var e=null,b=c.Next;b!=c;)b.Pt.Y>c.Pt.Y?(c=b,e=null):b.Pt.Y==c.Pt.Y&&b.Pt.X<=c.Pt.X&&(b.Pt.X<c.Pt.X?(e=null,c=b):b.Next!=c&&b.Prev!=c&&(e=b)),b=b.Next;if(null!==e)for(;e!=b;)for(this.FirstIsBottomPt(b,e)||(c=e),e=e.Next;k.IntPoint.op_Inequality(e.Pt,c.Pt);)e=e.Next;return c};k.Clipper.prototype.GetLowermostRec=function(c,e){null===c.BottomPt&&(c.BottomPt=this.GetBottomPt(c.Pts));null===e.BottomPt&&(e.BottomPt=this.GetBottomPt(e.Pts));var b=c.BottomPt,
k=e.BottomPt;return b.Pt.Y>k.Pt.Y?c:b.Pt.Y<k.Pt.Y?e:b.Pt.X<k.Pt.X?c:b.Pt.X>k.Pt.X?e:b.Next==b?e:k.Next==k?c:this.FirstIsBottomPt(b,k)?c:e};k.Clipper.prototype.Param1RightOfParam2=function(c,e){do if(c=c.FirstLeft,c==e)return!0;while(null!==c);return!1};k.Clipper.prototype.GetOutRec=function(c){for(c=this.m_PolyOuts[c];c!=this.m_PolyOuts[c.Idx];)c=this.m_PolyOuts[c.Idx];return c};k.Clipper.prototype.AppendPolygon=function(c,e){var b=this.m_PolyOuts[c.OutIdx],g=this.m_PolyOuts[e.OutIdx];var h=this.Param1RightOfParam2(b,
g)?g:this.Param1RightOfParam2(g,b)?b:this.GetLowermostRec(b,g);var l=b.Pts,p=l.Prev,r=g.Pts,F=r.Prev;c.Side==k.EdgeSide.esLeft?(e.Side==k.EdgeSide.esLeft?(this.ReversePolyPtLinks(r),r.Next=l,l.Prev=r,p.Next=F,F.Prev=p,b.Pts=F):(F.Next=l,l.Prev=F,r.Prev=p,p.Next=r,b.Pts=r),l=k.EdgeSide.esLeft):(e.Side==k.EdgeSide.esRight?(this.ReversePolyPtLinks(r),p.Next=F,F.Prev=p,r.Next=l,l.Prev=r):(p.Next=r,r.Prev=p,l.Prev=F,F.Next=l),l=k.EdgeSide.esRight);b.BottomPt=null;h==g&&(g.FirstLeft!=b&&(b.FirstLeft=g.FirstLeft),
b.IsHole=g.IsHole);g.Pts=null;g.BottomPt=null;g.FirstLeft=b;h=c.OutIdx;p=e.OutIdx;c.OutIdx=-1;e.OutIdx=-1;for(r=this.m_ActiveEdges;null!==r;){if(r.OutIdx==p){r.OutIdx=h;r.Side=l;break}r=r.NextInAEL}g.Idx=b.Idx};k.Clipper.prototype.ReversePolyPtLinks=function(c){if(null!==c){var e=c;do{var b=e.Next;e.Next=e.Prev;e=e.Prev=b}while(e!=c)}};k.Clipper.SwapSides=function(c,e){var b=c.Side;c.Side=e.Side;e.Side=b};k.Clipper.SwapPolyIndexes=function(c,e){var b=c.OutIdx;c.OutIdx=e.OutIdx;e.OutIdx=b};k.Clipper.prototype.IntersectEdges=
function(c,e,b){var q=0<=c.OutIdx,g=0<=e.OutIdx;k.use_xyz&&this.SetZ(b,c,e);if(!k.use_lines||0!==c.WindDelta&&0!==e.WindDelta){if(c.PolyTyp==e.PolyTyp)if(this.IsEvenOddFillType(c)){var h=c.WindCnt;c.WindCnt=e.WindCnt;e.WindCnt=h}else c.WindCnt=0===c.WindCnt+e.WindDelta?-c.WindCnt:c.WindCnt+e.WindDelta,e.WindCnt=0===e.WindCnt-c.WindDelta?-e.WindCnt:e.WindCnt-c.WindDelta;else this.IsEvenOddFillType(e)?c.WindCnt2=0===c.WindCnt2?1:0:c.WindCnt2+=e.WindDelta,this.IsEvenOddFillType(c)?e.WindCnt2=0===e.WindCnt2?
1:0:e.WindCnt2-=c.WindDelta;var l,p,r;c.PolyTyp==k.PolyType.ptSubject?(l=this.m_SubjFillType,r=this.m_ClipFillType):(l=this.m_ClipFillType,r=this.m_SubjFillType);e.PolyTyp==k.PolyType.ptSubject?(p=this.m_SubjFillType,h=this.m_ClipFillType):(p=this.m_ClipFillType,h=this.m_SubjFillType);switch(l){case k.PolyFillType.pftPositive:l=c.WindCnt;break;case k.PolyFillType.pftNegative:l=-c.WindCnt;break;default:l=Math.abs(c.WindCnt)}switch(p){case k.PolyFillType.pftPositive:p=e.WindCnt;break;case k.PolyFillType.pftNegative:p=
-e.WindCnt;break;default:p=Math.abs(e.WindCnt)}if(q&&g)0!=l&&1!=l||0!=p&&1!=p||c.PolyTyp!=e.PolyTyp&&this.m_ClipType!=k.ClipType.ctXor?this.AddLocalMaxPoly(c,e,b):(this.AddOutPt(c,b),this.AddOutPt(e,b),k.Clipper.SwapSides(c,e),k.Clipper.SwapPolyIndexes(c,e));else if(q){if(0===p||1==p)this.AddOutPt(c,b),k.Clipper.SwapSides(c,e),k.Clipper.SwapPolyIndexes(c,e)}else if(g){if(0===l||1==l)this.AddOutPt(e,b),k.Clipper.SwapSides(c,e),k.Clipper.SwapPolyIndexes(c,e)}else if(!(0!=l&&1!=l||0!=p&&1!=p)){switch(r){case k.PolyFillType.pftPositive:q=
c.WindCnt2;break;case k.PolyFillType.pftNegative:q=-c.WindCnt2;break;default:q=Math.abs(c.WindCnt2)}switch(h){case k.PolyFillType.pftPositive:g=e.WindCnt2;break;case k.PolyFillType.pftNegative:g=-e.WindCnt2;break;default:g=Math.abs(e.WindCnt2)}if(c.PolyTyp!=e.PolyTyp)this.AddLocalMinPoly(c,e,b);else if(1==l&&1==p)switch(this.m_ClipType){case k.ClipType.ctIntersection:0<q&&0<g&&this.AddLocalMinPoly(c,e,b);break;case k.ClipType.ctUnion:0>=q&&0>=g&&this.AddLocalMinPoly(c,e,b);break;case k.ClipType.ctDifference:(c.PolyTyp==
k.PolyType.ptClip&&0<q&&0<g||c.PolyTyp==k.PolyType.ptSubject&&0>=q&&0>=g)&&this.AddLocalMinPoly(c,e,b);break;case k.ClipType.ctXor:this.AddLocalMinPoly(c,e,b)}else k.Clipper.SwapSides(c,e)}}else if(0!=c.WindDelta||0!=e.WindDelta)c.PolyTyp==e.PolyTyp&&c.WindDelta!=e.WindDelta&&this.m_ClipType==k.ClipType.ctUnion?0===c.WindDelta?g&&(this.AddOutPt(c,b),q&&(c.OutIdx=-1)):q&&(this.AddOutPt(e,b),g&&(e.OutIdx=-1)):c.PolyTyp!=e.PolyTyp&&(0!==c.WindDelta||1!=Math.abs(e.WindCnt)||this.m_ClipType==k.ClipType.ctUnion&&
0!==e.WindCnt2?0!==e.WindDelta||1!=Math.abs(c.WindCnt)||this.m_ClipType==k.ClipType.ctUnion&&0!==c.WindCnt2||(this.AddOutPt(e,b),g&&(e.OutIdx=-1)):(this.AddOutPt(c,b),q&&(c.OutIdx=-1)))};k.Clipper.prototype.DeleteFromAEL=function(c){var e=c.PrevInAEL,b=c.NextInAEL;if(null!==e||null!==b||c==this.m_ActiveEdges)null!==e?e.NextInAEL=b:this.m_ActiveEdges=b,null!==b&&(b.PrevInAEL=e),c.NextInAEL=null,c.PrevInAEL=null};k.Clipper.prototype.DeleteFromSEL=function(c){var e=c.PrevInSEL,b=c.NextInSEL;if(null!==
e||null!==b||c==this.m_SortedEdges)null!==e?e.NextInSEL=b:this.m_SortedEdges=b,null!==b&&(b.PrevInSEL=e),c.NextInSEL=null,c.PrevInSEL=null};k.Clipper.prototype.UpdateEdgeIntoAEL=function(c){null===c.NextInLML&&k.Error("UpdateEdgeIntoAEL: invalid call");var e=c.PrevInAEL,b=c.NextInAEL;c.NextInLML.OutIdx=c.OutIdx;null!==e?e.NextInAEL=c.NextInLML:this.m_ActiveEdges=c.NextInLML;null!==b&&(b.PrevInAEL=c.NextInLML);c.NextInLML.Side=c.Side;c.NextInLML.WindDelta=c.WindDelta;c.NextInLML.WindCnt=c.WindCnt;
c.NextInLML.WindCnt2=c.WindCnt2;c=c.NextInLML;c.Curr.X=c.Bot.X;c.Curr.Y=c.Bot.Y;k.use_xyz&&(c.Curr.Z=c.Bot.Z);c.PrevInAEL=e;c.NextInAEL=b;k.ClipperBase.IsHorizontal(c)||this.InsertScanbeam(c.Top.Y);return c};k.Clipper.prototype.ProcessHorizontals=function(c){for(var e=this.m_SortedEdges;null!==e;)this.DeleteFromSEL(e),this.ProcessHorizontal(e,c),e=this.m_SortedEdges};k.Clipper.prototype.GetHorzDirection=function(c,e){c.Bot.X<c.Top.X?(e.Left=c.Bot.X,e.Right=c.Top.X,e.Dir=k.Direction.dLeftToRight):
(e.Left=c.Top.X,e.Right=c.Bot.X,e.Dir=k.Direction.dRightToLeft)};k.Clipper.prototype.ProcessHorizontal=function(c,e){var b={Dir:null,Left:null,Right:null};this.GetHorzDirection(c,b);for(var g=b.Dir,h=b.Left,l=b.Right,p=c,r=null;null!==p.NextInLML&&k.ClipperBase.IsHorizontal(p.NextInLML);)p=p.NextInLML;for(null===p.NextInLML&&(r=this.GetMaximaPair(p));;){for(var F=c==p,J=this.GetNextInAEL(c,g);null!==J&&!(J.Curr.X==c.Top.X&&null!==c.NextInLML&&J.Dx<c.NextInLML.Dx);){b=this.GetNextInAEL(J,g);if(g==
k.Direction.dLeftToRight&&J.Curr.X<=l||g==k.Direction.dRightToLeft&&J.Curr.X>=h){if(J==r&&F){if(0<=c.OutIdx){g=this.AddOutPt(c,c.Top);for(b=this.m_SortedEdges;null!==b;)0<=b.OutIdx&&this.HorzSegmentsOverlap(c.Bot.X,c.Top.X,b.Bot.X,b.Top.X)&&(h=this.AddOutPt(b,b.Bot),this.AddJoin(h,g,b.Top)),b=b.NextInSEL;this.AddGhostJoin(g,c.Bot);this.AddLocalMaxPoly(c,r,c.Top)}this.DeleteFromAEL(c);this.DeleteFromAEL(r);return}if(g==k.Direction.dLeftToRight){var C=new k.IntPoint(J.Curr.X,c.Curr.Y);this.IntersectEdges(c,
J,C)}else C=new k.IntPoint(J.Curr.X,c.Curr.Y),this.IntersectEdges(J,c,C);this.SwapPositionsInAEL(c,J)}else if(g==k.Direction.dLeftToRight&&J.Curr.X>=l||g==k.Direction.dRightToLeft&&J.Curr.X<=h)break;J=b}if(null!==c.NextInLML&&k.ClipperBase.IsHorizontal(c.NextInLML))c=this.UpdateEdgeIntoAEL(c),0<=c.OutIdx&&this.AddOutPt(c,c.Bot),b={Dir:g,Left:h,Right:l},this.GetHorzDirection(c,b),g=b.Dir,h=b.Left,l=b.Right;else break}null!==c.NextInLML?0<=c.OutIdx?(g=this.AddOutPt(c,c.Top),e&&this.AddGhostJoin(g,c.Bot),
c=this.UpdateEdgeIntoAEL(c),0!==c.WindDelta&&(r=c.PrevInAEL,b=c.NextInAEL,null!==r&&r.Curr.X==c.Bot.X&&r.Curr.Y==c.Bot.Y&&0!==r.WindDelta&&0<=r.OutIdx&&r.Curr.Y>r.Top.Y&&k.ClipperBase.SlopesEqual(c,r,this.m_UseFullRange)?(h=this.AddOutPt(r,c.Bot),this.AddJoin(g,h,c.Top)):null!==b&&b.Curr.X==c.Bot.X&&b.Curr.Y==c.Bot.Y&&0!==b.WindDelta&&0<=b.OutIdx&&b.Curr.Y>b.Top.Y&&k.ClipperBase.SlopesEqual(c,b,this.m_UseFullRange)&&(h=this.AddOutPt(b,c.Bot),this.AddJoin(g,h,c.Top)))):this.UpdateEdgeIntoAEL(c):(0<=
c.OutIdx&&this.AddOutPt(c,c.Top),this.DeleteFromAEL(c))};k.Clipper.prototype.GetNextInAEL=function(c,b){return b==k.Direction.dLeftToRight?c.NextInAEL:c.PrevInAEL};k.Clipper.prototype.IsMinima=function(c){return null!==c&&c.Prev.NextInLML!=c&&c.Next.NextInLML!=c};k.Clipper.prototype.IsMaxima=function(c,b){return null!==c&&c.Top.Y==b&&null===c.NextInLML};k.Clipper.prototype.IsIntermediate=function(c,b){return c.Top.Y==b&&null!==c.NextInLML};k.Clipper.prototype.GetMaximaPair=function(c){var b=null;
k.IntPoint.op_Equality(c.Next.Top,c.Top)&&null===c.Next.NextInLML?b=c.Next:k.IntPoint.op_Equality(c.Prev.Top,c.Top)&&null===c.Prev.NextInLML&&(b=c.Prev);return null===b||-2!=b.OutIdx&&(b.NextInAEL!=b.PrevInAEL||k.ClipperBase.IsHorizontal(b))?b:null};k.Clipper.prototype.ProcessIntersections=function(c){if(null==this.m_ActiveEdges)return!0;try{this.BuildIntersectList(c);if(0==this.m_IntersectList.length)return!0;if(1==this.m_IntersectList.length||this.FixupIntersectionOrder())this.ProcessIntersectList();
else return!1}catch(e){this.m_SortedEdges=null,this.m_IntersectList.length=0,k.Error("ProcessIntersections error")}this.m_SortedEdges=null;return!0};k.Clipper.prototype.BuildIntersectList=function(c){if(null!==this.m_ActiveEdges){var b=this.m_ActiveEdges;for(this.m_SortedEdges=b;null!==b;)b.PrevInSEL=b.PrevInAEL,b.NextInSEL=b.NextInAEL,b.Curr.X=k.Clipper.TopX(b,c),b=b.NextInAEL;for(var q=!0;q&&null!==this.m_SortedEdges;){q=!1;for(b=this.m_SortedEdges;null!==b.NextInSEL;){c=b.NextInSEL;var g=new k.IntPoint;
b.Curr.X>c.Curr.X?(this.IntersectPoint(b,c,g),q=new k.IntersectNode,q.Edge1=b,q.Edge2=c,q.Pt.X=g.X,q.Pt.Y=g.Y,k.use_xyz&&(q.Pt.Z=g.Z),this.m_IntersectList.push(q),this.SwapPositionsInSEL(b,c),q=!0):b=c}if(null!==b.PrevInSEL)b.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null}};k.Clipper.prototype.EdgesAdjacent=function(c){return c.Edge1.NextInSEL==c.Edge2||c.Edge1.PrevInSEL==c.Edge2};k.Clipper.IntersectNodeSort=function(c,b){return b.Pt.Y-c.Pt.Y};k.Clipper.prototype.FixupIntersectionOrder=
function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer);this.CopyAELToSEL();for(var c=this.m_IntersectList.length,b=0;b<c;b++){if(!this.EdgesAdjacent(this.m_IntersectList[b])){for(var k=b+1;k<c&&!this.EdgesAdjacent(this.m_IntersectList[k]);)k++;if(k==c)return!1;var g=this.m_IntersectList[b];this.m_IntersectList[b]=this.m_IntersectList[k];this.m_IntersectList[k]=g}this.SwapPositionsInSEL(this.m_IntersectList[b].Edge1,this.m_IntersectList[b].Edge2)}return!0};k.Clipper.prototype.ProcessIntersectList=
function(){for(var c=0,b=this.m_IntersectList.length;c<b;c++){var k=this.m_IntersectList[c];this.IntersectEdges(k.Edge1,k.Edge2,k.Pt);this.SwapPositionsInAEL(k.Edge1,k.Edge2)}this.m_IntersectList.length=0};G=function(c){return 0>c?Math.ceil(c-.5):Math.round(c)};tb=function(c){return 0>c?Math.ceil(c-.5):Math.floor(c+.5)};U=function(c){return 0>c?-Math.round(Math.abs(c)):Math.round(c)};vb=function(c){if(0>c)return c-=.5,-2147483648>c?Math.ceil(c):c|0;c+=.5;return 2147483647<c?Math.floor(c):c|0};k.Clipper.Round=
qa?G:ba?U:Pa?vb:tb;k.Clipper.TopX=function(c,b){return b==c.Top.Y?c.Top.X:c.Bot.X+k.Clipper.Round(c.Dx*(b-c.Bot.Y))};k.Clipper.prototype.IntersectPoint=function(c,b,g){g.X=0;g.Y=0;var e,q;if(c.Dx==b.Dx)g.Y=c.Curr.Y,g.X=k.Clipper.TopX(c,g.Y);else{if(0===c.Delta.X)g.X=c.Bot.X,k.ClipperBase.IsHorizontal(b)?g.Y=b.Bot.Y:(q=b.Bot.Y-b.Bot.X/b.Dx,g.Y=k.Clipper.Round(g.X/b.Dx+q));else if(0===b.Delta.X)g.X=b.Bot.X,k.ClipperBase.IsHorizontal(c)?g.Y=c.Bot.Y:(e=c.Bot.Y-c.Bot.X/c.Dx,g.Y=k.Clipper.Round(g.X/c.Dx+
e));else{e=c.Bot.X-c.Bot.Y*c.Dx;q=b.Bot.X-b.Bot.Y*b.Dx;var h=(q-e)/(c.Dx-b.Dx);g.Y=k.Clipper.Round(h);g.X=Math.abs(c.Dx)<Math.abs(b.Dx)?k.Clipper.Round(c.Dx*h+e):k.Clipper.Round(b.Dx*h+q)}if(g.Y<c.Top.Y||g.Y<b.Top.Y){if(c.Top.Y>b.Top.Y)return g.Y=c.Top.Y,g.X=k.Clipper.TopX(b,c.Top.Y),g.X<c.Top.X;g.Y=b.Top.Y;g.X=Math.abs(c.Dx)<Math.abs(b.Dx)?k.Clipper.TopX(c,g.Y):k.Clipper.TopX(b,g.Y)}g.Y>c.Curr.Y&&(g.Y=c.Curr.Y,g.X=Math.abs(c.Dx)>Math.abs(b.Dx)?k.Clipper.TopX(b,g.Y):k.Clipper.TopX(c,g.Y))}};k.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=
function(c){for(var b=this.m_ActiveEdges;null!==b;){var g=this.IsMaxima(b,c);g&&(g=this.GetMaximaPair(b),g=null===g||!k.ClipperBase.IsHorizontal(g));if(g){var h=b.PrevInAEL;this.DoMaxima(b);b=null===h?this.m_ActiveEdges:h.NextInAEL}else{this.IsIntermediate(b,c)&&k.ClipperBase.IsHorizontal(b.NextInLML)?(b=this.UpdateEdgeIntoAEL(b),0<=b.OutIdx&&this.AddOutPt(b,b.Bot),this.AddEdgeToSEL(b)):(b.Curr.X=k.Clipper.TopX(b,c),b.Curr.Y=c);if(this.StrictlySimple&&(h=b.PrevInAEL,0<=b.OutIdx&&0!==b.WindDelta&&
null!==h&&0<=h.OutIdx&&h.Curr.X==b.Curr.X&&0!==h.WindDelta)){var l=new k.IntPoint(b.Curr);k.use_xyz&&this.SetZ(l,h,b);g=this.AddOutPt(h,l);h=this.AddOutPt(b,l);this.AddJoin(g,h,l)}b=b.NextInAEL}}this.ProcessHorizontals(!0);for(b=this.m_ActiveEdges;null!==b;)this.IsIntermediate(b,c)&&(g=null,0<=b.OutIdx&&(g=this.AddOutPt(b,b.Top)),b=this.UpdateEdgeIntoAEL(b),h=b.PrevInAEL,l=b.NextInAEL,null!==h&&h.Curr.X==b.Bot.X&&h.Curr.Y==b.Bot.Y&&null!==g&&0<=h.OutIdx&&h.Curr.Y>h.Top.Y&&k.ClipperBase.SlopesEqual(b,
h,this.m_UseFullRange)&&0!==b.WindDelta&&0!==h.WindDelta?(h=this.AddOutPt(h,b.Bot),this.AddJoin(g,h,b.Top)):null!==l&&l.Curr.X==b.Bot.X&&l.Curr.Y==b.Bot.Y&&null!==g&&0<=l.OutIdx&&l.Curr.Y>l.Top.Y&&k.ClipperBase.SlopesEqual(b,l,this.m_UseFullRange)&&0!==b.WindDelta&&0!==l.WindDelta&&(h=this.AddOutPt(l,b.Bot),this.AddJoin(g,h,b.Top))),b=b.NextInAEL};k.Clipper.prototype.DoMaxima=function(c){var b=this.GetMaximaPair(c);if(null===b)0<=c.OutIdx&&this.AddOutPt(c,c.Top),this.DeleteFromAEL(c);else{for(var g=
c.NextInAEL;null!==g&&g!=b;)this.IntersectEdges(c,g,c.Top),this.SwapPositionsInAEL(c,g),g=c.NextInAEL;-1==c.OutIdx&&-1==b.OutIdx?(this.DeleteFromAEL(c),this.DeleteFromAEL(b)):0<=c.OutIdx&&0<=b.OutIdx?(0<=c.OutIdx&&this.AddLocalMaxPoly(c,b,c.Top),this.DeleteFromAEL(c),this.DeleteFromAEL(b)):k.use_lines&&0===c.WindDelta?(0<=c.OutIdx&&(this.AddOutPt(c,c.Top),c.OutIdx=-1),this.DeleteFromAEL(c),0<=b.OutIdx&&(this.AddOutPt(b,c.Top),b.OutIdx=-1),this.DeleteFromAEL(b)):k.Error("DoMaxima error")}};k.Clipper.ReversePaths=
function(c){for(var b=0,k=c.length;b<k;b++)c[b].reverse()};k.Clipper.Orientation=function(c){return 0<=k.Clipper.Area(c)};k.Clipper.prototype.PointCount=function(c){if(null===c)return 0;var b=0,k=c;do b++,k=k.Next;while(k!=c);return b};k.Clipper.prototype.BuildResult=function(c){k.Clear(c);for(var b=0,g=this.m_PolyOuts.length;b<g;b++){var h=this.m_PolyOuts[b];if(null!==h.Pts){h=h.Pts.Prev;var l=this.PointCount(h);if(!(2>l)){for(var p=Array(l),r=0;r<l;r++)p[r]=h.Pt,h=h.Prev;c.push(p)}}}};k.Clipper.prototype.BuildResult2=
function(c){c.Clear();for(var b=0,g=this.m_PolyOuts.length;b<g;b++){var h=this.m_PolyOuts[b],l=this.PointCount(h.Pts);if(!(h.IsOpen&&2>l||!h.IsOpen&&3>l)){this.FixHoleLinkage(h);var p=new k.PolyNode;c.m_AllPolys.push(p);h.PolyNode=p;p.m_polygon.length=l;h=h.Pts.Prev;for(var r=0;r<l;r++)p.m_polygon[r]=h.Pt,h=h.Prev}}b=0;for(g=this.m_PolyOuts.length;b<g;b++)h=this.m_PolyOuts[b],null!==h.PolyNode&&(h.IsOpen?(h.PolyNode.IsOpen=!0,c.AddChild(h.PolyNode)):null!==h.FirstLeft&&null!=h.FirstLeft.PolyNode?
h.FirstLeft.PolyNode.AddChild(h.PolyNode):c.AddChild(h.PolyNode))};k.Clipper.prototype.FixupOutPolygon=function(c){var b=null;c.BottomPt=null;for(var g=c.Pts;;){if(g.Prev==g||g.Prev==g.Next){c.Pts=null;return}if(k.IntPoint.op_Equality(g.Pt,g.Next.Pt)||k.IntPoint.op_Equality(g.Pt,g.Prev.Pt)||k.ClipperBase.SlopesEqual(g.Prev.Pt,g.Pt,g.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(g.Prev.Pt,g.Pt,g.Next.Pt)))b=null,g.Prev.Next=g.Next,g=g.Next.Prev=g.Prev;else if(g==
b)break;else null===b&&(b=g),g=g.Next}c.Pts=g};k.Clipper.prototype.DupOutPt=function(c,b){var e=new k.OutPt;e.Pt.X=c.Pt.X;e.Pt.Y=c.Pt.Y;k.use_xyz&&(e.Pt.Z=c.Pt.Z);e.Idx=c.Idx;b?(e.Next=c.Next,e.Prev=c,c.Next.Prev=e,c.Next=e):(e.Prev=c.Prev,e.Next=c,c.Prev.Next=e,c.Prev=e);return e};k.Clipper.prototype.GetOverlap=function(c,b,k,g,h){c<b?k<g?(h.Left=Math.max(c,k),h.Right=Math.min(b,g)):(h.Left=Math.max(c,g),h.Right=Math.min(b,k)):k<g?(h.Left=Math.max(b,k),h.Right=Math.min(c,g)):(h.Left=Math.max(b,g),
h.Right=Math.min(c,k));return h.Left<h.Right};k.Clipper.prototype.JoinHorz=function(c,b,g,h,l,p){var e=c.Pt.X>b.Pt.X?k.Direction.dRightToLeft:k.Direction.dLeftToRight;h=g.Pt.X>h.Pt.X?k.Direction.dRightToLeft:k.Direction.dLeftToRight;if(e==h)return!1;if(e==k.Direction.dLeftToRight){for(;c.Next.Pt.X<=l.X&&c.Next.Pt.X>=c.Pt.X&&c.Next.Pt.Y==l.Y;)c=c.Next;p&&c.Pt.X!=l.X&&(c=c.Next);b=this.DupOutPt(c,!p);k.IntPoint.op_Inequality(b.Pt,l)&&(c=b,c.Pt.X=l.X,c.Pt.Y=l.Y,k.use_xyz&&(c.Pt.Z=l.Z),b=this.DupOutPt(c,
!p))}else{for(;c.Next.Pt.X>=l.X&&c.Next.Pt.X<=c.Pt.X&&c.Next.Pt.Y==l.Y;)c=c.Next;p||c.Pt.X==l.X||(c=c.Next);b=this.DupOutPt(c,p);k.IntPoint.op_Inequality(b.Pt,l)&&(c=b,c.Pt.X=l.X,c.Pt.Y=l.Y,k.use_xyz&&(c.Pt.Z=l.Z),b=this.DupOutPt(c,p))}if(h==k.Direction.dLeftToRight){for(;g.Next.Pt.X<=l.X&&g.Next.Pt.X>=g.Pt.X&&g.Next.Pt.Y==l.Y;)g=g.Next;p&&g.Pt.X!=l.X&&(g=g.Next);h=this.DupOutPt(g,!p);k.IntPoint.op_Inequality(h.Pt,l)&&(g=h,g.Pt.X=l.X,g.Pt.Y=l.Y,k.use_xyz&&(g.Pt.Z=l.Z),h=this.DupOutPt(g,!p))}else{for(;g.Next.Pt.X>=
l.X&&g.Next.Pt.X<=g.Pt.X&&g.Next.Pt.Y==l.Y;)g=g.Next;p||g.Pt.X==l.X||(g=g.Next);h=this.DupOutPt(g,p);k.IntPoint.op_Inequality(h.Pt,l)&&(g=h,g.Pt.X=l.X,g.Pt.Y=l.Y,k.use_xyz&&(g.Pt.Z=l.Z),h=this.DupOutPt(g,p))}e==k.Direction.dLeftToRight==p?(c.Prev=g,g.Next=c,b.Next=h,h.Prev=b):(c.Next=g,g.Prev=c,b.Prev=h,h.Next=b);return!0};k.Clipper.prototype.JoinPoints=function(c,b,g){var e=c.OutPt1,h;new k.OutPt;var q=c.OutPt2,l;new k.OutPt;if((l=c.OutPt1.Pt.Y==c.OffPt.Y)&&k.IntPoint.op_Equality(c.OffPt,c.OutPt1.Pt)&&
k.IntPoint.op_Equality(c.OffPt,c.OutPt2.Pt)){if(b!=g)return!1;for(h=c.OutPt1.Next;h!=e&&k.IntPoint.op_Equality(h.Pt,c.OffPt);)h=h.Next;h=h.Pt.Y>c.OffPt.Y;for(l=c.OutPt2.Next;l!=q&&k.IntPoint.op_Equality(l.Pt,c.OffPt);)l=l.Next;if(h==l.Pt.Y>c.OffPt.Y)return!1;h?(h=this.DupOutPt(e,!1),l=this.DupOutPt(q,!0),e.Prev=q,q.Next=e,h.Next=l,l.Prev=h):(h=this.DupOutPt(e,!0),l=this.DupOutPt(q,!1),e.Next=q,q.Prev=e,h.Prev=l,l.Next=h);c.OutPt1=e;c.OutPt2=h;return!0}if(l){for(h=e;e.Prev.Pt.Y==e.Pt.Y&&e.Prev!=h&&
e.Prev!=q;)e=e.Prev;for(;h.Next.Pt.Y==h.Pt.Y&&h.Next!=e&&h.Next!=q;)h=h.Next;if(h.Next==e||h.Next==q)return!1;for(l=q;q.Prev.Pt.Y==q.Pt.Y&&q.Prev!=l&&q.Prev!=h;)q=q.Prev;for(;l.Next.Pt.Y==l.Pt.Y&&l.Next!=q&&l.Next!=e;)l=l.Next;if(l.Next==q||l.Next==e)return!1;g={Left:null,Right:null};if(!this.GetOverlap(e.Pt.X,h.Pt.X,q.Pt.X,l.Pt.X,g))return!1;b=g.Left;var p=g.Right;g=new k.IntPoint;e.Pt.X>=b&&e.Pt.X<=p?(g.X=e.Pt.X,g.Y=e.Pt.Y,k.use_xyz&&(g.Z=e.Pt.Z),b=e.Pt.X>h.Pt.X):q.Pt.X>=b&&q.Pt.X<=p?(g.X=q.Pt.X,
g.Y=q.Pt.Y,k.use_xyz&&(g.Z=q.Pt.Z),b=q.Pt.X>l.Pt.X):h.Pt.X>=b&&h.Pt.X<=p?(g.X=h.Pt.X,g.Y=h.Pt.Y,k.use_xyz&&(g.Z=h.Pt.Z),b=h.Pt.X>e.Pt.X):(g.X=l.Pt.X,g.Y=l.Pt.Y,k.use_xyz&&(g.Z=l.Pt.Z),b=l.Pt.X>q.Pt.X);c.OutPt1=e;c.OutPt2=q;return this.JoinHorz(e,h,q,l,g,b)}for(h=e.Next;k.IntPoint.op_Equality(h.Pt,e.Pt)&&h!=e;)h=h.Next;if(p=h.Pt.Y>e.Pt.Y||!k.ClipperBase.SlopesEqual(e.Pt,h.Pt,c.OffPt,this.m_UseFullRange)){for(h=e.Prev;k.IntPoint.op_Equality(h.Pt,e.Pt)&&h!=e;)h=h.Prev;if(h.Pt.Y>e.Pt.Y||!k.ClipperBase.SlopesEqual(e.Pt,
h.Pt,c.OffPt,this.m_UseFullRange))return!1}for(l=q.Next;k.IntPoint.op_Equality(l.Pt,q.Pt)&&l!=q;)l=l.Next;var r=l.Pt.Y>q.Pt.Y||!k.ClipperBase.SlopesEqual(q.Pt,l.Pt,c.OffPt,this.m_UseFullRange);if(r){for(l=q.Prev;k.IntPoint.op_Equality(l.Pt,q.Pt)&&l!=q;)l=l.Prev;if(l.Pt.Y>q.Pt.Y||!k.ClipperBase.SlopesEqual(q.Pt,l.Pt,c.OffPt,this.m_UseFullRange))return!1}if(h==e||l==q||h==l||b==g&&p==r)return!1;p?(h=this.DupOutPt(e,!1),l=this.DupOutPt(q,!0),e.Prev=q,q.Next=e,h.Next=l,l.Prev=h):(h=this.DupOutPt(e,!0),
l=this.DupOutPt(q,!1),e.Next=q,q.Prev=e,h.Prev=l,l.Next=h);c.OutPt1=e;c.OutPt2=h;return!0};k.Clipper.GetBounds=function(c){for(var b=0,g=c.length;b<g&&0==c[b].length;)b++;if(b==g)return new k.IntRect(0,0,0,0);var h=new k.IntRect;h.left=c[b][0].X;h.right=h.left;h.top=c[b][0].Y;for(h.bottom=h.top;b<g;b++)for(var l=0,p=c[b].length;l<p;l++)c[b][l].X<h.left?h.left=c[b][l].X:c[b][l].X>h.right&&(h.right=c[b][l].X),c[b][l].Y<h.top?h.top=c[b][l].Y:c[b][l].Y>h.bottom&&(h.bottom=c[b][l].Y);return h};k.Clipper.prototype.GetBounds2=
function(c){var b=c,g=new k.IntRect;g.left=c.Pt.X;g.right=c.Pt.X;g.top=c.Pt.Y;g.bottom=c.Pt.Y;for(c=c.Next;c!=b;)c.Pt.X<g.left&&(g.left=c.Pt.X),c.Pt.X>g.right&&(g.right=c.Pt.X),c.Pt.Y<g.top&&(g.top=c.Pt.Y),c.Pt.Y>g.bottom&&(g.bottom=c.Pt.Y),c=c.Next;return g};k.Clipper.PointInPolygon=function(c,b){var e=0,g=b.length;if(3>g)return 0;for(var k=b[0],h=1;h<=g;++h){var l=h==g?b[0]:b[h];if(l.Y==c.Y&&(l.X==c.X||k.Y==c.Y&&l.X>c.X==k.X<c.X))return-1;if(k.Y<c.Y!=l.Y<c.Y)if(k.X>=c.X)if(l.X>c.X)e=1-e;else{var p=
(k.X-c.X)*(l.Y-c.Y)-(l.X-c.X)*(k.Y-c.Y);if(0==p)return-1;0<p==l.Y>k.Y&&(e=1-e)}else if(l.X>c.X){p=(k.X-c.X)*(l.Y-c.Y)-(l.X-c.X)*(k.Y-c.Y);if(0==p)return-1;0<p==l.Y>k.Y&&(e=1-e)}k=l}return e};k.Clipper.prototype.PointInPolygon=function(c,b){var e=0,g=b,k=c.X;c=c.Y;var h=b.Pt.X,l=b.Pt.Y;do{b=b.Next;var p=b.Pt.X,r=b.Pt.Y;if(r==c&&(p==k||l==c&&p>k==h<k))return-1;if(l<c!=r<c)if(h>=k)if(p>k)e=1-e;else{h=(h-k)*(r-c)-(p-k)*(l-c);if(0==h)return-1;0<h==r>l&&(e=1-e)}else if(p>k){h=(h-k)*(r-c)-(p-k)*(l-c);if(0==
h)return-1;0<h==r>l&&(e=1-e)}h=p;l=r}while(g!=b);return e};k.Clipper.prototype.Poly2ContainsPoly1=function(c,b){var e=c;do{var g=this.PointInPolygon(e.Pt,b);if(0<=g)return 0<g;e=e.Next}while(e!=c);return!0};k.Clipper.prototype.FixupFirstLefts1=function(c,b){for(var e=0,g=this.m_PolyOuts.length;e<g;e++){var k=this.m_PolyOuts[e];null!=k.Pts&&null!=k.FirstLeft&&this.ParseFirstLeft(k.FirstLeft)==c&&this.Poly2ContainsPoly1(k.Pts,b.Pts)&&(k.FirstLeft=b)}};k.Clipper.prototype.FixupFirstLefts2=function(c,
b){for(var e=0,g=this.m_PolyOuts,k=g.length,h=g[e];e<k;e++,h=g[e])h.FirstLeft==c&&(h.FirstLeft=b)};k.Clipper.ParseFirstLeft=function(c){for(;null!=c&&null==c.Pts;)c=c.FirstLeft;return c};k.Clipper.prototype.JoinCommonEdges=function(){for(var c=0,b=this.m_Joins.length;c<b;c++){var g=this.m_Joins[c],h=this.GetOutRec(g.OutPt1.Idx),l=this.GetOutRec(g.OutPt2.Idx);if(null!=h.Pts&&null!=l.Pts){var p=h==l?h:this.Param1RightOfParam2(h,l)?l:this.Param1RightOfParam2(l,h)?h:this.GetLowermostRec(h,l);if(this.JoinPoints(g,
h,l))if(h==l){h.Pts=g.OutPt1;h.BottomPt=null;l=this.CreateOutRec();l.Pts=g.OutPt2;this.UpdateOutPtIdxs(l);if(this.m_UsingPolyTree){p=0;for(var r=this.m_PolyOuts.length;p<r-1;p++){var F=this.m_PolyOuts[p];null!=F.Pts&&k.Clipper.ParseFirstLeft(F.FirstLeft)==h&&F.IsHole!=h.IsHole&&this.Poly2ContainsPoly1(F.Pts,g.OutPt2)&&(F.FirstLeft=l)}}this.Poly2ContainsPoly1(l.Pts,h.Pts)?(l.IsHole=!h.IsHole,l.FirstLeft=h,this.m_UsingPolyTree&&this.FixupFirstLefts2(l,h),(l.IsHole^this.ReverseSolution)==0<this.Area(l)&&
this.ReversePolyPtLinks(l.Pts)):this.Poly2ContainsPoly1(h.Pts,l.Pts)?(l.IsHole=h.IsHole,h.IsHole=!l.IsHole,l.FirstLeft=h.FirstLeft,h.FirstLeft=l,this.m_UsingPolyTree&&this.FixupFirstLefts2(h,l),(h.IsHole^this.ReverseSolution)==0<this.Area(h)&&this.ReversePolyPtLinks(h.Pts)):(l.IsHole=h.IsHole,l.FirstLeft=h.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(h,l))}else l.Pts=null,l.BottomPt=null,l.Idx=h.Idx,h.IsHole=p.IsHole,p==l&&(h.FirstLeft=l.FirstLeft),l.FirstLeft=h,this.m_UsingPolyTree&&this.FixupFirstLefts2(l,
h)}}};k.Clipper.prototype.UpdateOutPtIdxs=function(c){var b=c.Pts;do b.Idx=c.Idx,b=b.Prev;while(b!=c.Pts)};k.Clipper.prototype.DoSimplePolygons=function(){for(var c=0;c<this.m_PolyOuts.length;){var b=this.m_PolyOuts[c++],g=b.Pts;if(null!=g&&!b.IsOpen){do{for(var h=g.Next;h!=b.Pts;){if(k.IntPoint.op_Equality(g.Pt,h.Pt)&&h.Next!=g&&h.Prev!=g){var l=g.Prev,p=h.Prev;g.Prev=p;p.Next=g;h.Prev=l;l.Next=h;b.Pts=g;l=this.CreateOutRec();l.Pts=h;this.UpdateOutPtIdxs(l);this.Poly2ContainsPoly1(l.Pts,b.Pts)?(l.IsHole=
!b.IsHole,l.FirstLeft=b,this.m_UsingPolyTree&&this.FixupFirstLefts2(l,b)):this.Poly2ContainsPoly1(b.Pts,l.Pts)?(l.IsHole=b.IsHole,b.IsHole=!l.IsHole,l.FirstLeft=b.FirstLeft,b.FirstLeft=l,this.m_UsingPolyTree&&this.FixupFirstLefts2(b,l)):(l.IsHole=b.IsHole,l.FirstLeft=b.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(b,l));h=g}h=h.Next}g=g.Next}while(g!=b.Pts)}}};k.Clipper.Area=function(c){var b=c.length;if(3>b)return 0;for(var g=0,k=0,h=b-1;k<b;++k)g+=(c[h].X+c[k].X)*(c[h].Y-c[k].Y),h=k;return.5*
-g};k.Clipper.prototype.Area=function(c){var b=c.Pts;if(null==b)return 0;var g=0;do g+=(b.Prev.Pt.X+b.Pt.X)*(b.Prev.Pt.Y-b.Pt.Y),b=b.Next;while(b!=c.Pts);return.5*g};k.Clipper.SimplifyPolygon=function(c,b){var e=[],g=new k.Clipper(0);g.StrictlySimple=!0;g.AddPath(c,k.PolyType.ptSubject,!0);g.Execute(k.ClipType.ctUnion,e,b,b);return e};k.Clipper.SimplifyPolygons=function(c,b){"undefined"==typeof b&&(b=k.PolyFillType.pftEvenOdd);var e=[],g=new k.Clipper(0);g.StrictlySimple=!0;g.AddPaths(c,k.PolyType.ptSubject,
!0);g.Execute(k.ClipType.ctUnion,e,b,b);return e};k.Clipper.DistanceSqrd=function(c,b){var e=c.X-b.X;c=c.Y-b.Y;return e*e+c*c};k.Clipper.DistanceFromLineSqrd=function(c,b,g){var e=b.Y-g.Y;g=g.X-b.X;b=e*b.X+g*b.Y;b=e*c.X+g*c.Y-b;return b*b/(e*e+g*g)};k.Clipper.SlopesNearCollinear=function(c,b,g,h){return Math.abs(c.X-b.X)>Math.abs(c.Y-b.Y)?c.X>b.X==c.X<g.X?k.Clipper.DistanceFromLineSqrd(c,b,g)<h:b.X>c.X==b.X<g.X?k.Clipper.DistanceFromLineSqrd(b,c,g)<h:k.Clipper.DistanceFromLineSqrd(g,c,b)<h:c.Y>b.Y==
c.Y<g.Y?k.Clipper.DistanceFromLineSqrd(c,b,g)<h:b.Y>c.Y==b.Y<g.Y?k.Clipper.DistanceFromLineSqrd(b,c,g)<h:k.Clipper.DistanceFromLineSqrd(g,c,b)<h};k.Clipper.PointsAreClose=function(c,b,g){var e=c.X-b.X;c=c.Y-b.Y;return e*e+c*c<=g};k.Clipper.ExcludeOp=function(c){var b=c.Prev;b.Next=c.Next;c.Next.Prev=b;b.Idx=0;return b};k.Clipper.CleanPolygon=function(c,b){"undefined"==typeof b&&(b=1.415);var e=c.length;if(0==e)return[];for(var g=Array(e),h=0;h<e;++h)g[h]=new k.OutPt;for(h=0;h<e;++h)g[h].Pt=c[h],g[h].Next=
g[(h+1)%e],g[h].Next.Prev=g[h],g[h].Idx=0;h=b*b;for(g=g[0];0==g.Idx&&g.Next!=g.Prev;)k.Clipper.PointsAreClose(g.Pt,g.Prev.Pt,h)?(g=k.Clipper.ExcludeOp(g),e--):k.Clipper.PointsAreClose(g.Prev.Pt,g.Next.Pt,h)?(k.Clipper.ExcludeOp(g.Next),g=k.Clipper.ExcludeOp(g),e-=2):k.Clipper.SlopesNearCollinear(g.Prev.Pt,g.Pt,g.Next.Pt,h)?(g=k.Clipper.ExcludeOp(g),e--):(g.Idx=1,g=g.Next);3>e&&(e=0);c=Array(e);for(h=0;h<e;++h)c[h]=new k.IntPoint(g.Pt),g=g.Next;return c};k.Clipper.CleanPolygons=function(c,b){for(var e=
Array(c.length),g=0,h=c.length;g<h;g++)e[g]=k.Clipper.CleanPolygon(c[g],b);return e};k.Clipper.Minkowski=function(c,b,g,h){h=h?1:0;var e=c.length,l=b.length,q=[];if(g)for(g=0;g<l;g++){for(var p=Array(e),r=0,F=c.length,J=c[r];r<F;r++,J=c[r])p[r]=new k.IntPoint(b[g].X+J.X,b[g].Y+J.Y);q.push(p)}else for(g=0;g<l;g++){p=Array(e);r=0;F=c.length;for(J=c[r];r<F;r++,J=c[r])p[r]=new k.IntPoint(b[g].X-J.X,b[g].Y-J.Y);q.push(p)}c=[];for(g=0;g<l-1+h;g++)for(r=0;r<e;r++)b=[],b.push(q[g%l][r%e]),b.push(q[(g+1)%
l][r%e]),b.push(q[(g+1)%l][(r+1)%e]),b.push(q[g%l][(r+1)%e]),k.Clipper.Orientation(b)||b.reverse(),c.push(b);return c};k.Clipper.MinkowskiSum=function(c,b,g){if(b[0]instanceof Array){q=b;b=new k.Paths;for(var e=new k.Clipper,h=0;h<q.length;++h){var l=k.Clipper.Minkowski(c,q[h],!0,g);e.AddPaths(l,k.PolyType.ptSubject,!0);g&&(l=k.Clipper.TranslatePath(q[h],c[0]),e.AddPath(l,k.PolyType.ptClip,!0))}e.Execute(k.ClipType.ctUnion,b,k.PolyFillType.pftNonZero,k.PolyFillType.pftNonZero);return b}var q=k.Clipper.Minkowski(c,
b,!0,g);e=new k.Clipper;e.AddPaths(q,k.PolyType.ptSubject,!0);e.Execute(k.ClipType.ctUnion,q,k.PolyFillType.pftNonZero,k.PolyFillType.pftNonZero);return q};k.Clipper.TranslatePath=function(c,b){for(var e=new k.Path,g=0;g<c.length;g++)e.push(new k.IntPoint(c[g].X+b.X,c[g].Y+b.Y));return e};k.Clipper.MinkowskiDiff=function(c,b){c=k.Clipper.Minkowski(c,b,!1,!0);b=new k.Clipper;b.AddPaths(c,k.PolyType.ptSubject,!0);b.Execute(k.ClipType.ctUnion,c,k.PolyFillType.pftNonZero,k.PolyFillType.pftNonZero);return c};
k.Clipper.PolyTreeToPaths=function(c){var b=[];k.Clipper.AddPolyNodeToPaths(c,k.Clipper.NodeType.ntAny,b);return b};k.Clipper.AddPolyNodeToPaths=function(c,b,g){var e=!0;switch(b){case k.Clipper.NodeType.ntOpen:return;case k.Clipper.NodeType.ntClosed:e=!c.IsOpen}0<c.m_polygon.length&&e&&g.push(c.m_polygon);e=0;c=c.Childs();for(var h=c.length,l=c[e];e<h;e++,l=c[e])k.Clipper.AddPolyNodeToPaths(l,b,g)};k.Clipper.OpenPathsFromPolyTree=function(c){for(var b=new k.Paths,g=0,h=c.ChildCount();g<h;g++)c.Childs()[g].IsOpen&&
b.push(c.Childs()[g].m_polygon);return b};k.Clipper.ClosedPathsFromPolyTree=function(c){var b=new k.Paths;k.Clipper.AddPolyNodeToPaths(c,k.Clipper.NodeType.ntClosed,b);return b};na(k.Clipper,k.ClipperBase);k.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2};k.ClipperOffset=function(c,b){"undefined"==typeof c&&(c=2);"undefined"==typeof b&&(b=k.ClipperOffset.def_arc_tolerance);this.m_destPolys=new k.Paths;this.m_srcPoly=new k.Path;this.m_destPoly=new k.Path;this.m_normals=[];this.m_StepsPerRad=this.m_miterLim=
this.m_cos=this.m_sin=this.m_sinA=this.m_delta=0;this.m_lowest=new k.IntPoint;this.m_polyNodes=new k.PolyNode;this.MiterLimit=c;this.ArcTolerance=b;this.m_lowest.X=-1};k.ClipperOffset.two_pi=6.28318530717959;k.ClipperOffset.def_arc_tolerance=.25;k.ClipperOffset.prototype.Clear=function(){k.Clear(this.m_polyNodes.Childs());this.m_lowest.X=-1};k.ClipperOffset.Round=k.Clipper.Round;k.ClipperOffset.prototype.AddPath=function(c,b,g){var e=c.length-1;if(!(0>e)){var h=new k.PolyNode;h.m_jointype=b;h.m_endtype=
g;if(g==k.EndType.etClosedLine||g==k.EndType.etClosedPolygon)for(;0<e&&k.IntPoint.op_Equality(c[0],c[e]);)e--;h.m_polygon.push(c[0]);var l=0;b=0;for(var q=1;q<=e;q++)k.IntPoint.op_Inequality(h.m_polygon[l],c[q])&&(l++,h.m_polygon.push(c[q]),c[q].Y>h.m_polygon[b].Y||c[q].Y==h.m_polygon[b].Y&&c[q].X<h.m_polygon[b].X)&&(b=l);if(!(g==k.EndType.etClosedPolygon&&2>l)&&(this.m_polyNodes.AddChild(h),g==k.EndType.etClosedPolygon))if(0>this.m_lowest.X)this.m_lowest=new k.IntPoint(this.m_polyNodes.ChildCount()-
1,b);else if(c=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y],h.m_polygon[b].Y>c.Y||h.m_polygon[b].Y==c.Y&&h.m_polygon[b].X<c.X)this.m_lowest=new k.IntPoint(this.m_polyNodes.ChildCount()-1,b)}};k.ClipperOffset.prototype.AddPaths=function(c,b,g){for(var e=0,k=c.length;e<k;e++)this.AddPath(c[e],b,g)};k.ClipperOffset.prototype.FixOrientations=function(){if(0<=this.m_lowest.X&&!k.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var c=0;c<this.m_polyNodes.ChildCount();c++){var b=
this.m_polyNodes.Childs()[c];(b.m_endtype==k.EndType.etClosedPolygon||b.m_endtype==k.EndType.etClosedLine&&k.Clipper.Orientation(b.m_polygon))&&b.m_polygon.reverse()}else for(c=0;c<this.m_polyNodes.ChildCount();c++)b=this.m_polyNodes.Childs()[c],b.m_endtype!=k.EndType.etClosedLine||k.Clipper.Orientation(b.m_polygon)||b.m_polygon.reverse()};k.ClipperOffset.GetUnitNormal=function(c,b){var e=b.X-c.X;c=b.Y-c.Y;if(0==e&&0==c)return new k.DoublePoint(0,0);b=1/Math.sqrt(e*e+c*c);return new k.DoublePoint(c*
b,-(e*b))};k.ClipperOffset.prototype.DoOffset=function(c){this.m_destPolys=[];this.m_delta=c;if(k.ClipperBase.near_zero(c))for(var b=0;b<this.m_polyNodes.ChildCount();b++){var g=this.m_polyNodes.Childs()[b];g.m_endtype==k.EndType.etClosedPolygon&&this.m_destPolys.push(g.m_polygon)}else{this.m_miterLim=2<this.MiterLimit?2/(this.MiterLimit*this.MiterLimit):.5;var h=3.14159265358979/Math.acos(1-(0>=this.ArcTolerance?k.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(c)*k.ClipperOffset.def_arc_tolerance?
Math.abs(c)*k.ClipperOffset.def_arc_tolerance:this.ArcTolerance)/Math.abs(c));this.m_sin=Math.sin(k.ClipperOffset.two_pi/h);this.m_cos=Math.cos(k.ClipperOffset.two_pi/h);this.m_StepsPerRad=h/k.ClipperOffset.two_pi;0>c&&(this.m_sin=-this.m_sin);for(b=0;b<this.m_polyNodes.ChildCount();b++){g=this.m_polyNodes.Childs()[b];this.m_srcPoly=g.m_polygon;var l=this.m_srcPoly.length;if(!(0==l||0>=c&&(3>l||g.m_endtype!=k.EndType.etClosedPolygon))){this.m_destPoly=[];if(1==l)if(g.m_jointype==k.JoinType.jtRound){g=
1;l=0;for(var p=1;p<=h;p++){this.m_destPoly.push(new k.IntPoint(k.ClipperOffset.Round(this.m_srcPoly[0].X+g*c),k.ClipperOffset.Round(this.m_srcPoly[0].Y+l*c)));var r=g;g=g*this.m_cos-this.m_sin*l;l=r*this.m_sin+l*this.m_cos}}else for(l=g=-1,p=0;4>p;++p)this.m_destPoly.push(new k.IntPoint(k.ClipperOffset.Round(this.m_srcPoly[0].X+g*c),k.ClipperOffset.Round(this.m_srcPoly[0].Y+l*c))),0>g?g=1:0>l?l=1:g=-1;else{for(p=this.m_normals.length=0;p<l-1;p++)this.m_normals.push(k.ClipperOffset.GetUnitNormal(this.m_srcPoly[p],
this.m_srcPoly[p+1]));g.m_endtype==k.EndType.etClosedLine||g.m_endtype==k.EndType.etClosedPolygon?this.m_normals.push(k.ClipperOffset.GetUnitNormal(this.m_srcPoly[l-1],this.m_srcPoly[0])):this.m_normals.push(new k.DoublePoint(this.m_normals[l-2]));if(g.m_endtype==k.EndType.etClosedPolygon)for(r=l-1,p=0;p<l;p++)r=this.OffsetPoint(p,r,g.m_jointype);else if(g.m_endtype==k.EndType.etClosedLine){r=l-1;for(p=0;p<l;p++)r=this.OffsetPoint(p,r,g.m_jointype);this.m_destPolys.push(this.m_destPoly);this.m_destPoly=
[];r=this.m_normals[l-1];for(p=l-1;0<p;p--)this.m_normals[p]=new k.DoublePoint(-this.m_normals[p-1].X,-this.m_normals[p-1].Y);this.m_normals[0]=new k.DoublePoint(-r.X,-r.Y);r=0;for(p=l-1;0<=p;p--)r=this.OffsetPoint(p,r,g.m_jointype)}else{r=0;for(p=1;p<l-1;++p)r=this.OffsetPoint(p,r,g.m_jointype);g.m_endtype==k.EndType.etOpenButt?(p=l-1,r=new k.IntPoint(k.ClipperOffset.Round(this.m_srcPoly[p].X+this.m_normals[p].X*c),k.ClipperOffset.Round(this.m_srcPoly[p].Y+this.m_normals[p].Y*c)),this.m_destPoly.push(r),
r=new k.IntPoint(k.ClipperOffset.Round(this.m_srcPoly[p].X-this.m_normals[p].X*c),k.ClipperOffset.Round(this.m_srcPoly[p].Y-this.m_normals[p].Y*c)),this.m_destPoly.push(r)):(p=l-1,r=l-2,this.m_sinA=0,this.m_normals[p]=new k.DoublePoint(-this.m_normals[p].X,-this.m_normals[p].Y),g.m_endtype==k.EndType.etOpenSquare?this.DoSquare(p,r):this.DoRound(p,r));for(p=l-1;0<p;p--)this.m_normals[p]=new k.DoublePoint(-this.m_normals[p-1].X,-this.m_normals[p-1].Y);this.m_normals[0]=new k.DoublePoint(-this.m_normals[1].X,
-this.m_normals[1].Y);r=l-1;for(p=r-1;0<p;--p)r=this.OffsetPoint(p,r,g.m_jointype);g.m_endtype==k.EndType.etOpenButt?(r=new k.IntPoint(k.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*c),k.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*c)),this.m_destPoly.push(r),r=new k.IntPoint(k.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*c),k.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*c)),this.m_destPoly.push(r)):(this.m_sinA=0,g.m_endtype==k.EndType.etOpenSquare?
this.DoSquare(0,1):this.DoRound(0,1))}}this.m_destPolys.push(this.m_destPoly)}}}};k.ClipperOffset.prototype.Execute=function(){var c=arguments;if(c[0]instanceof k.PolyTree)if(b=c[0],g=c[1],b.Clear(),this.FixOrientations(),this.DoOffset(g),c=new k.Clipper(0),c.AddPaths(this.m_destPolys,k.PolyType.ptSubject,!0),0<g)c.Execute(k.ClipType.ctUnion,b,k.PolyFillType.pftPositive,k.PolyFillType.pftPositive);else if(g=k.Clipper.GetBounds(this.m_destPolys),h=new k.Path,h.push(new k.IntPoint(g.left-10,g.bottom+
10)),h.push(new k.IntPoint(g.right+10,g.bottom+10)),h.push(new k.IntPoint(g.right+10,g.top-10)),h.push(new k.IntPoint(g.left-10,g.top-10)),c.AddPath(h,k.PolyType.ptSubject,!0),c.ReverseSolution=!0,c.Execute(k.ClipType.ctUnion,b,k.PolyFillType.pftNegative,k.PolyFillType.pftNegative),1==b.ChildCount()&&0<b.Childs()[0].ChildCount())for(c=b.Childs()[0],b.Childs()[0]=c.Childs()[0],b.Childs()[0].m_Parent=b,g=1;g<c.ChildCount();g++)b.AddChild(c.Childs()[g]);else b.Clear();else{var b=c[0],g=c[1];k.Clear(b);
this.FixOrientations();this.DoOffset(g);c=new k.Clipper(0);c.AddPaths(this.m_destPolys,k.PolyType.ptSubject,!0);if(0<g)c.Execute(k.ClipType.ctUnion,b,k.PolyFillType.pftPositive,k.PolyFillType.pftPositive);else{g=k.Clipper.GetBounds(this.m_destPolys);var h=new k.Path;h.push(new k.IntPoint(g.left-10,g.bottom+10));h.push(new k.IntPoint(g.right+10,g.bottom+10));h.push(new k.IntPoint(g.right+10,g.top-10));h.push(new k.IntPoint(g.left-10,g.top-10));c.AddPath(h,k.PolyType.ptSubject,!0);c.ReverseSolution=
!0;c.Execute(k.ClipType.ctUnion,b,k.PolyFillType.pftNegative,k.PolyFillType.pftNegative);0<b.length&&b.splice(0,1)}}};k.ClipperOffset.prototype.OffsetPoint=function(c,b,g){this.m_sinA=this.m_normals[b].X*this.m_normals[c].Y-this.m_normals[c].X*this.m_normals[b].Y;if(1>Math.abs(this.m_sinA*this.m_delta)){if(0<this.m_normals[b].X*this.m_normals[c].X+this.m_normals[c].Y*this.m_normals[b].Y)return this.m_destPoly.push(new k.IntPoint(k.ClipperOffset.Round(this.m_srcPoly[c].X+this.m_normals[b].X*this.m_delta),
k.ClipperOffset.Round(this.m_srcPoly[c].Y+this.m_normals[b].Y*this.m_delta))),b}else 1<this.m_sinA?this.m_sinA=1:-1>this.m_sinA&&(this.m_sinA=-1);if(0>this.m_sinA*this.m_delta)this.m_destPoly.push(new k.IntPoint(k.ClipperOffset.Round(this.m_srcPoly[c].X+this.m_normals[b].X*this.m_delta),k.ClipperOffset.Round(this.m_srcPoly[c].Y+this.m_normals[b].Y*this.m_delta))),this.m_destPoly.push(new k.IntPoint(this.m_srcPoly[c])),this.m_destPoly.push(new k.IntPoint(k.ClipperOffset.Round(this.m_srcPoly[c].X+this.m_normals[c].X*
this.m_delta),k.ClipperOffset.Round(this.m_srcPoly[c].Y+this.m_normals[c].Y*this.m_delta)));else switch(g){case k.JoinType.jtMiter:g=1+(this.m_normals[c].X*this.m_normals[b].X+this.m_normals[c].Y*this.m_normals[b].Y);g>=this.m_miterLim?this.DoMiter(c,b,g):this.DoSquare(c,b);break;case k.JoinType.jtSquare:this.DoSquare(c,b);break;case k.JoinType.jtRound:this.DoRound(c,b)}return c};k.ClipperOffset.prototype.DoSquare=function(c,b){var g=Math.tan(Math.atan2(this.m_sinA,this.m_normals[b].X*this.m_normals[c].X+
this.m_normals[b].Y*this.m_normals[c].Y)/4);this.m_destPoly.push(new k.IntPoint(k.ClipperOffset.Round(this.m_srcPoly[c].X+this.m_delta*(this.m_normals[b].X-this.m_normals[b].Y*g)),k.ClipperOffset.Round(this.m_srcPoly[c].Y+this.m_delta*(this.m_normals[b].Y+this.m_normals[b].X*g))));this.m_destPoly.push(new k.IntPoint(k.ClipperOffset.Round(this.m_srcPoly[c].X+this.m_delta*(this.m_normals[c].X+this.m_normals[c].Y*g)),k.ClipperOffset.Round(this.m_srcPoly[c].Y+this.m_delta*(this.m_normals[c].Y-this.m_normals[c].X*
g))))};k.ClipperOffset.prototype.DoMiter=function(c,b,g){g=this.m_delta/g;this.m_destPoly.push(new k.IntPoint(k.ClipperOffset.Round(this.m_srcPoly[c].X+(this.m_normals[b].X+this.m_normals[c].X)*g),k.ClipperOffset.Round(this.m_srcPoly[c].Y+(this.m_normals[b].Y+this.m_normals[c].Y)*g)))};k.ClipperOffset.prototype.DoRound=function(c,b){var g=Math.max(k.Cast_Int32(k.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(Math.atan2(this.m_sinA,this.m_normals[b].X*this.m_normals[c].X+this.m_normals[b].Y*this.m_normals[c].Y)))),
1),e=this.m_normals[b].X;b=this.m_normals[b].Y;for(var h,l=0;l<g;++l)this.m_destPoly.push(new k.IntPoint(k.ClipperOffset.Round(this.m_srcPoly[c].X+e*this.m_delta),k.ClipperOffset.Round(this.m_srcPoly[c].Y+b*this.m_delta))),h=e,e=e*this.m_cos-this.m_sin*b,b=h*this.m_sin+b*this.m_cos;this.m_destPoly.push(new k.IntPoint(k.ClipperOffset.Round(this.m_srcPoly[c].X+this.m_normals[c].X*this.m_delta),k.ClipperOffset.Round(this.m_srcPoly[c].Y+this.m_normals[c].Y*this.m_delta)))};k.Error=function(c){try{throw Error(c);
}catch(e){alert(e.message)}};k.JS={};k.JS.AreaOfPolygon=function(c,b){b||(b=1);return k.Clipper.Area(c)/(b*b)};k.JS.AreaOfPolygons=function(c,b){b||(b=1);for(var g=0,e=0;e<c.length;e++)g+=k.Clipper.Area(c[e]);return g/(b*b)};k.JS.BoundsOfPath=function(c,b){return k.JS.BoundsOfPaths([c],b)};k.JS.BoundsOfPaths=function(c,b){b||(b=1);c=k.Clipper.GetBounds(c);c.left/=b;c.bottom/=b;c.right/=b;c.top/=b;return c};k.JS.Clean=function(c,b){if(!(c instanceof Array))return[];var g=c[0]instanceof Array;c=k.JS.Clone(c);
if("number"!=typeof b||null===b)return k.Error("Delta is not a number in Clean()."),c;if(0===c.length||1==c.length&&0===c[0].length||0>b)return c;g||(c=[c]);for(var e=c.length,h,l,p,r,F,J,C,I=[],U=0;U<e;U++)if(l=c[U],h=l.length,0!==h)if(3>h)p=l,I.push(p);else{p=l;r=b*b;F=l[0];for(C=J=1;C<h;C++)(l[C].X-F.X)*(l[C].X-F.X)+(l[C].Y-F.Y)*(l[C].Y-F.Y)<=r||(p[J]=l[C],F=l[C],J++);F=l[J-1];(l[0].X-F.X)*(l[0].X-F.X)+(l[0].Y-F.Y)*(l[0].Y-F.Y)<=r&&J--;J<h&&p.splice(J,h-J);p.length&&I.push(p)}!g&&I.length?I=I[0]:
g||0!==I.length?g&&0===I.length&&(I=[[]]):I=[];return I};k.JS.Clone=function(c){if(!(c instanceof Array)||0===c.length)return[];if(1==c.length&&0===c[0].length)return[[]];var b=c[0]instanceof Array;b||(c=[c]);var g=c.length,h,k,l=Array(g);for(h=0;h<g;h++){var p=c[h].length;var r=Array(p);for(k=0;k<p;k++)r[k]={X:c[h][k].X,Y:c[h][k].Y};l[h]=r}b||(l=l[0]);return l};k.JS.Lighten=function(c,b){if(!(c instanceof Array))return[];if("number"!=typeof b||null===b)return k.Error("Tolerance is not a number in Lighten()."),
k.JS.Clone(c);if(0===c.length||1==c.length&&0===c[0].length||0>b)return k.JS.Clone(c);c[0]instanceof Array||(c=[c]);var g,e,h,l,p,r=c.length,F=b*b,J=[];for(b=0;b<r;b++)if(e=c[b],l=e.length,0!=l){for(h=0;1E6>h;h++){var C=[];l=e.length;e[l-1].X!=e[0].X||e[l-1].Y!=e[0].Y?(p=1,e.push({X:e[0].X,Y:e[0].Y}),l=e.length):p=0;var I=[];for(g=0;g<l-2;g++){var U=e[g];var G=e[g+1];var Z=e[g+2];var L=U.X;var ja=U.Y;U=Z.X-L;var Aa=Z.Y-ja;if(0!==U||0!==Aa){var aa=((G.X-L)*U+(G.Y-ja)*Aa)/(U*U+Aa*Aa);1<aa?(L=Z.X,ja=
Z.Y):0<aa&&(L+=U*aa,ja+=Aa*aa)}U=G.X-L;Aa=G.Y-ja;Z=U*U+Aa*Aa;Z<=F&&(I[g+1]=1,g++)}C.push({X:e[0].X,Y:e[0].Y});for(g=1;g<l-1;g++)I[g]||C.push({X:e[g].X,Y:e[g].Y});C.push({X:e[l-1].X,Y:e[l-1].Y});p&&e.pop();if(I.length)e=C;else break}l=C.length;C[l-1].X==C[0].X&&C[l-1].Y==C[0].Y&&C.pop();2<C.length&&J.push(C)}c[0]instanceof Array||(J=J[0]);"undefined"==typeof J&&(J=[[]]);return J};k.JS.PerimeterOfPath=function(c,b,g){if("undefined"==typeof c)return 0;var e=Math.sqrt,h=0,k=c.length;if(2>k)return 0;for(b&&
(c[k]=c[0],k++);--k;){var l=c[k];var q=l.X;l=l.Y;var p=c[k-1];var r=p.X;p=p.Y;h+=e((q-r)*(q-r)+(l-p)*(l-p))}b&&c.pop();return h/g};k.JS.PerimeterOfPaths=function(c,b,g){g||(g=1);for(var e=0,h=0;h<c.length;h++)e+=k.JS.PerimeterOfPath(c[h],b,g);return e};k.JS.ScaleDownPath=function(c,b){var g;b||(b=1);for(g=c.length;g--;){var e=c[g];e.X/=b;e.Y/=b}};k.JS.ScaleDownPaths=function(c,b){var g,e;b||(b=1);for(g=c.length;g--;)for(e=c[g].length;e--;){var h=c[g][e];h.X/=b;h.Y/=b}};k.JS.ScaleUpPath=function(c,
b){var g,e=Math.round;b||(b=1);for(g=c.length;g--;){var h=c[g];h.X=e(h.X*b);h.Y=e(h.Y*b)}};k.JS.ScaleUpPaths=function(c,b){var g,e,h=Math.round;b||(b=1);for(g=c.length;g--;)for(e=c[g].length;e--;){var k=c[g][e];k.X=h(k.X*b);k.Y=h(k.Y*b)}};k.ExPolygons=function(){return[]};k.ExPolygon=function(){this.holes=this.outer=null};k.JS.AddOuterPolyNodeToExPolygons=function(c,b){var g=new k.ExPolygon;g.outer=c.Contour();c=c.Childs();var e=c.length;g.holes=Array(e);var h,l;for(h=0;h<e;h++){var p=c[h];g.holes[h]=
p.Contour();var r=0;var F=p.Childs();for(l=F.length;r<l;r++)p=F[r],k.JS.AddOuterPolyNodeToExPolygons(p,b)}b.push(g)};k.JS.ExPolygonsToPaths=function(c){var b,g,h=new k.Paths;var l=0;for(b=c.length;l<b;l++){h.push(c[l].outer);var p=0;for(g=c[l].holes.length;p<g;p++)h.push(c[l].holes[p])}return h};k.JS.PolyTreeToExPolygons=function(c){var b=new k.ExPolygons,g;var h=0;var l=c.Childs();for(g=l.length;h<g;h++)c=l[h],k.JS.AddOuterPolyNodeToExPolygons(c,b);return b}})();
(function(b,l){"function"===typeof define&&define.amd?define(l):"object"===typeof exports?module.exports=l():b.returnExports=l()})(this,function(){var b=Function.call.bind(Function.apply),l=Function.call.bind(Function.call),h=Array.isArray,p=Object.keys,r=function(c){try{return c(),!1}catch(V){return!0}},C=function(c){try{return c()}catch(V){return!1}},I=function(c){return function(){return!b(c,this,arguments)}}(r),g=function(){return!r(function(){return Object.defineProperty({},"x",{get:function(){}})})},
J=!!Object.defineProperty&&g(),F="foo"===function(){}.name,Z=Function.call.bind(Array.prototype.forEach),ja=Function.call.bind(Array.prototype.reduce),Aa=Function.call.bind(Array.prototype.filter),Ka=Function.call.bind(Array.prototype.some),L=function(c,b,f,g){!g&&b in c||(J?Object.defineProperty(c,b,{configurable:!0,enumerable:!1,writable:!0,value:f}):c[b]=f)},aa=function(c,b,f){Z(p(b),function(g){L(c,g,b[g],!!f)})},Fa=Function.call.bind(Object.prototype.toString),k="function"===typeof/abc/?function(c){return"function"===
typeof c&&"[object Function]"===Fa(c)}:function(c){return"function"===typeof c},ba={getter:function(c,b,f){if(!J)throw new TypeError("getters require true ES5 support");Object.defineProperty(c,b,{configurable:!0,enumerable:!1,get:f})},proxy:function(c,b,f){if(!J)throw new TypeError("getters require true ES5 support");var g=Object.getOwnPropertyDescriptor(c,b);Object.defineProperty(f,b,{configurable:g.configurable,enumerable:g.enumerable,get:function(){return c[b]},set:function(f){c[b]=f}})},redefine:function(c,
b,f){if(J){var g=Object.getOwnPropertyDescriptor(c,b);g.value=f;Object.defineProperty(c,b,g)}else c[b]=f},defineByDescriptor:function(c,b,f){J?Object.defineProperty(c,b,f):"value"in f&&(c[b]=f.value)},preserveToString:function(c,b){b&&k(b.toString)&&L(c,"toString",b.toString.bind(b),!0)}},na=Object.create||function(c,b){var f=function(){};f.prototype=c;var g=new f;"undefined"!==typeof b&&p(b).forEach(function(c){ba.defineByDescriptor(g,c,b[c])});return g},qa=function(c,b){return Object.setPrototypeOf?
C(function(){var f=function ya(b){b=new c(b);Object.setPrototypeOf(b,ya.prototype);return b};Object.setPrototypeOf(f,c);f.prototype=na(c.prototype,{constructor:{value:f}});return b(f)}):!1},G=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof global)return global;throw Error("unable to locate global object");}(),Pa=G.isFinite,tb=Function.call.bind(String.prototype.indexOf),U=Function.apply.bind(Array.prototype.indexOf),vb=Function.call.bind(Array.prototype.concat),
ub=Function.call.bind(String.prototype.slice),Ta=Function.call.bind(Array.prototype.push),La=Function.apply.bind(Array.prototype.push),X=Function.call.bind(Array.prototype.shift),Ab=Math.max,c=Math.min,e=Math.floor,q=Math.abs,Ba=Math.exp,Ga=Math.log,ha=Math.sqrt,hc=Function.call.bind(Object.prototype.hasOwnProperty),Qb=function(){},Ca=G.Map,$c=Ca&&Ca.prototype["delete"],ca=Ca&&Ca.prototype.get,zb=Ca&&Ca.prototype.has,ic=Ca&&Ca.prototype.set,ka=G.Symbol||{},jc=ka.species||"@@species",Qa=Number.isNaN||
function(c){return c!==c},Cc=Number.isFinite||function(c){return"number"===typeof c&&Pa(c)},Rb=k(Math.sign)?Math.sign:function(c){c=Number(c);return 0===c||Qa(c)?c:0>c?-1:1},Bb=function(c){c=Number(c);return-1>c||Qa(c)?NaN:0===c||Infinity===c?c:-1===c?-Infinity:0===1+c-1?c:c*(Ga(1+c)/(1+c-1))},ad=function(c){return"[object Arguments]"===Fa(c)},Cd=function(c){return null!==c&&"object"===typeof c&&"number"===typeof c.length&&0<=c.length&&"[object Array]"!==Fa(c)&&"[object Function]"===Fa(c.callee)},
Dc=ad(arguments)?ad:Cd,za={primitive:function(c){return null===c||"function"!==typeof c&&"object"!==typeof c},string:function(c){return"[object String]"===Fa(c)},regex:function(c){return"[object RegExp]"===Fa(c)},symbol:function(c){return"function"===typeof G.Symbol&&"symbol"===typeof c}},Q=function(c,b,f){var g=c[b];L(c,b,f,!0);ba.preserveToString(c[b],g)},kc="function"===typeof ka&&"function"===typeof ka["for"]&&za.symbol(ka()),$a=za.symbol(ka.iterator)?ka.iterator:"_es6-shim iterator_";G.Set&&
"function"===typeof(new G.Set)["@@iterator"]&&($a="@@iterator");G.Reflect||L(G,"Reflect",{},!0);var Cb=G.Reflect,Ec=String,Fc="undefined"!==typeof document&&document?document.all:null,mb=null==Fc?function(c){return null==c}:function(c){return null==c&&c!==Fc},y={Call:function(c,f){var g=2<arguments.length?arguments[2]:[];if(!y.IsCallable(c))throw new TypeError(c+" is not a function");return b(c,f,g)},RequireObjectCoercible:function(c,b){if(mb(c))throw new TypeError(b||"Cannot call method on "+c);
return c},TypeIsObject:function(c){return void 0===c||null===c||!0===c||!1===c?!1:"function"===typeof c||"object"===typeof c||c===Fc},ToObject:function(c,b){return Object(y.RequireObjectCoercible(c,b))},IsCallable:k,IsConstructor:function(c){return y.IsCallable(c)},ToInt32:function(c){return y.ToNumber(c)>>0},ToUint32:function(c){return y.ToNumber(c)>>>0},ToNumber:function(c){if("[object Symbol]"===Fa(c))throw new TypeError("Cannot convert a Symbol value to a number");return+c},ToInteger:function(c){c=
y.ToNumber(c);return Qa(c)?0:0!==c&&Cc(c)?(0<c?1:-1)*e(q(c)):c},ToLength:function(c){c=y.ToInteger(c);return 0>=c?0:c>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:c},SameValue:function(c,b){return c===b?0===c?1/c===1/b:!0:Qa(c)&&Qa(b)},SameValueZero:function(c,b){return c===b||Qa(c)&&Qa(b)},IsIterable:function(c){return y.TypeIsObject(c)&&("undefined"!==typeof c[$a]||Dc(c))},GetIterator:function(c){if(Dc(c))return new Ma(c,"value");var b=y.GetMethod(c,$a);if(!y.IsCallable(b))throw new TypeError("value is not an iterable");
c=y.Call(b,c);if(!y.TypeIsObject(c))throw new TypeError("bad iterator");return c},GetMethod:function(c,b){c=y.ToObject(c)[b];if(!mb(c)){if(!y.IsCallable(c))throw new TypeError("Method not callable: "+b);return c}},IteratorComplete:function(c){return!!c.done},IteratorClose:function(c,b){var f=y.GetMethod(c,"return");if(void 0!==f){try{var g=y.Call(f,c)}catch(ya){var e=ya}if(!b){if(e)throw e;if(!y.TypeIsObject(g))throw new TypeError("Iterator's return method returned a non-object.");}}},IteratorNext:function(c){var b=
1<arguments.length?c.next(arguments[1]):c.next();if(!y.TypeIsObject(b))throw new TypeError("bad iterator");return b},IteratorStep:function(c){c=y.IteratorNext(c);return y.IteratorComplete(c)?!1:c},Construct:function(c,b,f,g){f="undefined"===typeof f?c:f;if(!g&&Cb.construct)return Cb.construct(c,b,f);g=f.prototype;y.TypeIsObject(g)||(g=Object.prototype);g=na(g);c=y.Call(c,g,b);return y.TypeIsObject(c)?c:g},SpeciesConstructor:function(c,b){c=c.constructor;if(void 0===c)return b;if(!y.TypeIsObject(c))throw new TypeError("Bad constructor");
c=c[jc];if(mb(c))return b;if(!y.IsConstructor(c))throw new TypeError("Bad @@species");return c},CreateHTML:function(c,b,f,g){c=y.ToString(c);var e="<"+b;""!==f&&(g=y.ToString(g).replace(/"/g,"&quot;"),e+=" "+f+'="'+g+'"');return e+">"+c+"</"+b+">"},IsRegExp:function(c){if(!y.TypeIsObject(c))return!1;var b=c[ka.match];return"undefined"!==typeof b?!!b:za.regex(c)},ToString:function(c){return Ec(c)}};if(J&&kc){var Xb=function(c){if(za.symbol(ka[c]))return ka[c];var b=ka["for"]("Symbol."+c);Object.defineProperty(ka,
c,{configurable:!1,enumerable:!1,writable:!1,value:b});return b};if(!za.symbol(ka.search)){var Dd=Xb("search"),Yb=String.prototype.search;L(RegExp.prototype,Dd,function(c){return y.Call(Yb,c,[this])});Q(String.prototype,"search",function(c){var b=y.RequireObjectCoercible(this);if(!mb(c)){var f=y.GetMethod(c,Dd);if("undefined"!==typeof f)return y.Call(f,c,[b])}return y.Call(Yb,b,[y.ToString(c)])})}if(!za.symbol(ka.replace)){var bd=Xb("replace"),Ua=String.prototype.replace;L(RegExp.prototype,bd,function(c,
b){return y.Call(Ua,c,[this,b])});Q(String.prototype,"replace",function(c,b){var f=y.RequireObjectCoercible(this);if(!mb(c)){var g=y.GetMethod(c,bd);if("undefined"!==typeof g)return y.Call(g,c,[f,b])}return y.Call(Ua,f,[y.ToString(c),b])})}if(!za.symbol(ka.split)){var Db=Xb("split"),cd=String.prototype.split;L(RegExp.prototype,Db,function(c,b){return y.Call(cd,c,[this,b])});Q(String.prototype,"split",function(c,b){var f=y.RequireObjectCoercible(this);if(!mb(c)){var g=y.GetMethod(c,Db);if("undefined"!==
typeof g)return y.Call(g,c,[f,b])}return y.Call(cd,f,[y.ToString(c),b])})}var ta=za.symbol(ka.match),Tb=ta&&function(){var c={};c[ka.match]=function(){return 42};return 42!=="a".match(c)}();if(!ta||Tb){var lc=Xb("match"),dd=String.prototype.match;L(RegExp.prototype,lc,function(c){return y.Call(dd,c,[this])});Q(String.prototype,"match",function(c){var b=y.RequireObjectCoercible(this);if(!mb(c)){var f=y.GetMethod(c,lc);if("undefined"!==typeof f)return y.Call(f,c,[b])}return y.Call(dd,b,[y.ToString(c)])})}}var ed=
function(c,b,f){ba.preserveToString(b,c);Object.setPrototypeOf&&Object.setPrototypeOf(c,b);J?Z(Object.getOwnPropertyNames(c),function(g){g in Qb||f[g]||ba.proxy(c,g,b)}):Z(Object.keys(c),function(g){g in Qb||f[g]||(b[g]=c[g])});b.prototype=c.prototype;ba.redefine(c.prototype,"constructor",b)},mc=function(){return this},x=function(c){J&&!hc(c,jc)&&ba.getter(c,jc,mc)},D=function(c,b){b=b||function(){return this};L(c,$a,b);!c[$a]&&za.symbol($a)&&(c[$a]=b)},P=function(c,b,f){J?Object.defineProperty(c,
b,{configurable:!0,enumerable:!0,writable:!0,value:f}):c[b]=f;if(!y.SameValue(c[b],f))throw new TypeError("property is nonconfigurable");},fb=function(c,b,f,g){if(!y.TypeIsObject(c))throw new TypeError("Constructor requires `new`: "+b.name);c=b.prototype;y.TypeIsObject(c)||(c=f);f=na(c);for(var e in g)hc(g,e)&&L(f,e,g[e],!0);return f};if(String.fromCodePoint&&1!==String.fromCodePoint.length){var he=String.fromCodePoint;Q(String,"fromCodePoint",function(c){return y.Call(he,this,arguments)})}var ra=
{fromCodePoint:function(c){for(var b=[],f,g=0,e=arguments.length;g<e;g++){f=Number(arguments[g]);if(!y.SameValue(f,y.ToInteger(f))||0>f||1114111<f)throw new RangeError("Invalid code point "+f);65536>f?Ta(b,String.fromCharCode(f)):(f-=65536,Ta(b,String.fromCharCode((f>>10)+55296)),Ta(b,String.fromCharCode(f%1024+56320)))}return b.join("")},raw:function(c){var b=y.ToObject(c,"bad callSite");b=y.ToObject(b.raw,"bad raw value");var f=y.ToLength(b.length);if(0>=f)return"";for(var g=[],e=0,h;e<f;){h=y.ToString(e);
h=y.ToString(b[h]);Ta(g,h);if(e+1>=f)break;h=e+1<arguments.length?arguments[e+1]:"";h=y.ToString(h);Ta(g,h);e+=1}return g.join("")}};String.raw&&"xy"!==String.raw({raw:{0:"x",1:"y",length:2}})&&Q(String,"raw",ra.raw);aa(String,ra);var Ed=function E(c,b){if(1>b)return"";if(b%2)return E(c,b-1)+c;c=E(c,b/2);return c+c},Eb={repeat:function(c){var b=y.ToString(y.RequireObjectCoercible(this));c=y.ToInteger(c);if(0>c||Infinity<=c)throw new RangeError("repeat count must be less than infinity and not overflow maximum string size");
return Ed(b,c)},startsWith:function(c){var b=y.ToString(y.RequireObjectCoercible(this));if(y.IsRegExp(c))throw new TypeError('Cannot call method "startsWith" with a regex');var f=y.ToString(c),g;1<arguments.length&&(g=arguments[1]);g=Ab(y.ToInteger(g),0);return ub(b,g,g+f.length)===f},endsWith:function(b){var f=y.ToString(y.RequireObjectCoercible(this));if(y.IsRegExp(b))throw new TypeError('Cannot call method "endsWith" with a regex');var g=y.ToString(b),e=f.length,h;1<arguments.length&&(h=arguments[1]);
h="undefined"===typeof h?e:y.ToInteger(h);e=c(Ab(h,0),e);return ub(f,e-g.length,e)===g},includes:function(c){if(y.IsRegExp(c))throw new TypeError('"includes" does not accept a RegExp');var b=y.ToString(c),f;1<arguments.length&&(f=arguments[1]);return-1!==tb(this,b,f)},codePointAt:function(c){var b=y.ToString(y.RequireObjectCoercible(this)),f=y.ToInteger(c),g=b.length;if(0<=f&&f<g){c=b.charCodeAt(f);if(55296>c||56319<c||f+1===g)return c;b=b.charCodeAt(f+1);return 56320>b||57343<b?c:1024*(c-55296)+
(b-56320)+65536}}};String.prototype.includes&&!1!=="a".includes("a",Infinity)&&Q(String.prototype,"includes",Eb.includes);if(String.prototype.startsWith&&String.prototype.endsWith){var Fd=r(function(){return"/a/".startsWith(/a/)}),ie=C(function(){return!1==="abc".startsWith("a",Infinity)});Fd&&ie||(Q(String.prototype,"startsWith",Eb.startsWith),Q(String.prototype,"endsWith",Eb.endsWith))}kc&&(C(function(){var c=/a/;c[ka.match]=!1;return"/a/".startsWith(c)})||Q(String.prototype,"startsWith",Eb.startsWith),
C(function(){var c=/a/;c[ka.match]=!1;return"/a/".endsWith(c)})||Q(String.prototype,"endsWith",Eb.endsWith),C(function(){var c=/a/;c[ka.match]=!1;return"/a/".includes(c)})||Q(String.prototype,"includes",Eb.includes));aa(String.prototype,Eb);var je=/(^[\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]+)|([\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]+$)/g,
nc=function(){return y.ToString(y.RequireObjectCoercible(this)).replace(je,"")},Gd=/[\u0085\u200b\ufffe]/g,Fb=/^[-+]0x[0-9a-f]+$/i;L(String.prototype,"trim",nc,!0);var Gb=function(c){return{value:c,done:0===arguments.length}},Gc=function(c){y.RequireObjectCoercible(c);this._s=y.ToString(c);this._i=0};Gc.prototype.next=function(){var c=this._s,b=this._i;if("undefined"===typeof c||b>=c.length)return this._s=void 0,Gb();var f=c.charCodeAt(b);55296>f||56319<f||b+1===c.length?f=1:(f=c.charCodeAt(b+1),
f=56320>f||57343<f?1:2);this._i=b+f;return Gb(c.substr(b,f))};D(Gc.prototype);D(String.prototype,function(){return new Gc(this)});var Hb={from:function(c){var b;1<arguments.length&&(b=arguments[1]);var f;if("undefined"===typeof b)var g=!1;else{if(!y.IsCallable(b))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(f=arguments[2]);g=!0}var e;if("undefined"!==typeof(Dc(c)||y.GetMethod(c,$a))){var h=y.IsConstructor(this)?Object(new this):[];var k=
y.GetIterator(c);for(e=0;;){var m=y.IteratorStep(k);if(!1===m)break;m=m.value;try{g&&(m="undefined"===typeof f?b(m,e):l(b,f,m,e)),h[e]=m}catch(gd){throw y.IteratorClose(k,!0),gd;}e+=1}k=e}else for(m=y.ToObject(c),k=y.ToLength(m.length),h=y.IsConstructor(this)?Object(new this(k)):Array(k),e=0;e<k;++e){var p=m[e];g&&(p="undefined"===typeof f?b(p,e):l(b,f,p,e));P(h,e,p)}h.length=k;return h},of:function(){for(var c=arguments.length,b=h(this)||!y.IsCallable(this)?Array(c):y.Construct(this,[c]),f=0;f<c;++f)P(b,
f,arguments[f]);b.length=c;return b}};aa(Array,Hb);x(Array);var Ma=function(c,b){this.i=0;this.array=c;this.kind=b};aa(Ma.prototype,{next:function(){var c=this.i,b=this.array;if(!(this instanceof Ma))throw new TypeError("Not an ArrayIterator");if("undefined"!==typeof b)for(var f=y.ToLength(b.length);c<f;){f=this.kind;var g;"key"===f?g=c:"value"===f?g=b[c]:"entry"===f&&(g=[c,b[c]]);this.i=c+1;return Gb(g)}this.array=void 0;return Gb()}});D(Ma.prototype);Array.of===Hb.of||function(){var c=function(c){this.length=
c};c.prototype=[];var b=Array.of.apply(c,[1,2]);return b instanceof c&&2===b.length}()||Q(Array,"of",Hb.of);var Ib={copyWithin:function(b,f){var g=y.ToObject(this),e=y.ToLength(g.length),h=y.ToInteger(b),k=y.ToInteger(f);h=0>h?Ab(e+h,0):c(h,e);k=0>k?Ab(e+k,0):c(k,e);var m;2<arguments.length&&(m=arguments[2]);m="undefined"===typeof m?e:y.ToInteger(m);m=0>m?Ab(e+m,0):c(m,e);e=c(m-k,e-h);m=1;k<h&&h<k+e&&(m=-1,k+=e-1,h+=e-1);for(;0<e;)k in g?g[h]=g[k]:delete g[h],k+=m,h+=m,--e;return g},fill:function(b){var f;
1<arguments.length&&(f=arguments[1]);var g;2<arguments.length&&(g=arguments[2]);var e=y.ToObject(this),h=y.ToLength(e.length);f=y.ToInteger("undefined"===typeof f?0:f);g=y.ToInteger("undefined"===typeof g?h:g);f=0>f?Ab(h+f,0):c(f,h);for(g=0>g?h+g:g;f<h&&f<g;++f)e[f]=b;return e},find:function(c){var b=y.ToObject(this),f=y.ToLength(b.length);if(!y.IsCallable(c))throw new TypeError("Array#find: predicate must be a function");for(var g=1<arguments.length?arguments[1]:null,e=0,h;e<f;e++)if(h=b[e],g){if(l(c,
g,h,e,b))return h}else if(c(h,e,b))return h},findIndex:function(c){var b=y.ToObject(this),f=y.ToLength(b.length);if(!y.IsCallable(c))throw new TypeError("Array#findIndex: predicate must be a function");for(var g=1<arguments.length?arguments[1]:null,e=0;e<f;e++)if(g){if(l(c,g,b[e],e,b))return e}else if(c(b[e],e,b))return e;return-1},keys:function(){return new Ma(this,"key")},values:function(){return new Ma(this,"value")},entries:function(){return new Ma(this,"entry")}};Array.prototype.keys&&!y.IsCallable([1].keys().next)&&
delete Array.prototype.keys;Array.prototype.entries&&!y.IsCallable([1].entries().next)&&delete Array.prototype.entries;Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[$a]&&(aa(Array.prototype,{values:Array.prototype[$a]}),za.symbol(ka.unscopables)&&(Array.prototype[ka.unscopables].values=!0));if(F&&Array.prototype.values&&"values"!==Array.prototype.values.name){var hd=Array.prototype.values;Q(Array.prototype,"values",function(){return y.Call(hd,this,arguments)});
L(Array.prototype,$a,Array.prototype.values,!0)}aa(Array.prototype,Ib);0>1/[!0].indexOf(!0,-0)&&L(Array.prototype,"indexOf",function(c){var b=U(this,arguments);return 0===b&&0>1/b?0:b},!0);D(Array.prototype,function(){return this.values()});Object.getPrototypeOf&&D(Object.getPrototypeOf([].values()));var Id=function(){return C(function(){return 0===Array.from({length:-1}).length})}(),Jd=function(){var c=Array.from([0].entries());return 1===c.length&&h(c[0])&&0===c[0][0]&&0===c[0][1]}();Id&&Jd||Q(Array,
"from",Hb.from);if(!function(){return C(function(){return Array.from([0],void 0)})}()){var Jc=Array.from;Q(Array,"from",function(c){return 1<arguments.length&&"undefined"!==typeof arguments[1]?y.Call(Jc,this,arguments):l(Jc,this,c)})}var Ub=-(Math.pow(2,32)-1),Jb=function(c,b){var f={length:Ub};f[b?(f.length>>>0)-1:0]=!0;return C(function(){l(c,f,function(){throw new RangeError("should not reach here");},[]);return!0})};if(!Jb(Array.prototype.forEach)){var Kd=Array.prototype.forEach;Q(Array.prototype,
"forEach",function(c){return y.Call(Kd,0<=this.length?this:[],arguments)},!0)}if(!Jb(Array.prototype.map)){var Zb=Array.prototype.map;Q(Array.prototype,"map",function(c){return y.Call(Zb,0<=this.length?this:[],arguments)},!0)}if(!Jb(Array.prototype.filter)){var Kc=Array.prototype.filter;Q(Array.prototype,"filter",function(c){return y.Call(Kc,0<=this.length?this:[],arguments)},!0)}if(!Jb(Array.prototype.some)){var ke=Array.prototype.some;Q(Array.prototype,"some",function(c){return y.Call(ke,0<=this.length?
this:[],arguments)},!0)}if(!Jb(Array.prototype.every)){var le=Array.prototype.every;Q(Array.prototype,"every",function(c){return y.Call(le,0<=this.length?this:[],arguments)},!0)}if(!Jb(Array.prototype.reduce)){var Ld=Array.prototype.reduce;Q(Array.prototype,"reduce",function(c){return y.Call(Ld,0<=this.length?this:[],arguments)},!0)}if(!Jb(Array.prototype.reduceRight,!0)){var Md=Array.prototype.reduceRight;Q(Array.prototype,"reduceRight",function(c){return y.Call(Md,0<=this.length?this:[],arguments)},
!0)}var $b=8!==Number("0o10"),Nd=2!==Number("0b10"),Od=Ka("\u0085\u200b\ufffe",function(c){return 0===Number(c+0+c)});if($b||Nd||Od){var pb=Number,Va=/^0b[01]+$/i,id=/^0o[0-7]+$/i,Lc=Va.test.bind(Va),me=id.test.bind(id),Pd=function(c){if("function"===typeof c.valueOf){var b=c.valueOf();if(za.primitive(b))return b}if("function"===typeof c.toString&&(b=c.toString(),za.primitive(b)))return b;throw new TypeError("No default value");},jd=Gd.test.bind(Gd),Qd=Fb.test.bind(Fb),Mc=function(){var c=function(b){var f=
0<arguments.length?za.primitive(b)?b:Pd(b,"number"):0;if("string"===typeof f)if(f=y.Call(nc,f),Lc(f))f=parseInt(ub(f,2),2);else if(me(f))f=parseInt(ub(f,2),8);else if(jd(f)||Qd(f))f=NaN;var g=this,e=C(function(){pb.prototype.valueOf.call(g);return!0});return g instanceof c&&!e?new pb(f):pb(f)};return c}();ed(pb,Mc,{});aa(Mc,{NaN:pb.NaN,MAX_VALUE:pb.MAX_VALUE,MIN_VALUE:pb.MIN_VALUE,NEGATIVE_INFINITY:pb.NEGATIVE_INFINITY,POSITIVE_INFINITY:pb.POSITIVE_INFINITY});Number=Mc;ba.redefine(G,"Number",Mc)}var Rd=
Math.pow(2,53)-1;aa(Number,{MAX_SAFE_INTEGER:Rd,MIN_SAFE_INTEGER:-Rd,EPSILON:2.220446049250313E-16,parseInt:G.parseInt,parseFloat:G.parseFloat,isFinite:Cc,isInteger:function(c){return Cc(c)&&y.ToInteger(c)===c},isSafeInteger:function(c){return Number.isInteger(c)&&q(c)<=Number.MAX_SAFE_INTEGER},isNaN:Qa});L(Number,"parseInt",G.parseInt,Number.parseInt!==G.parseInt);1===[,1].find(function(){return!0})&&Q(Array.prototype,"find",Ib.find);0!==[,1].findIndex(function(){return!0})&&Q(Array.prototype,"findIndex",
Ib.findIndex);var wb=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable),Nc=function(c,b){J&&wb(c,b)&&Object.defineProperty(c,b,{enumerable:!1})},ac=function(){var c=Number(this),b=arguments.length,f=b-c;f=Array(0>f?0:f);for(var g=c;g<b;++g)f[g-c]=arguments[g];return f},oc=function(c){return function(b,f){b[f]=c[f];return b}},Sd=function(c,b){var f=p(Object(b)),g;y.IsCallable(Object.getOwnPropertySymbols)&&(g=Aa(Object.getOwnPropertySymbols(Object(b)),wb(b)));return ja(vb(f,g||
[]),oc(b),c)},Td={assign:function(c,b){var f=y.ToObject(c,"Cannot convert undefined or null to object");return ja(y.Call(ac,1,arguments),Sd,f)},is:function(c,b){return y.SameValue(c,b)}};Object.assign&&Object.preventExtensions&&function(){var c=Object.preventExtensions({1:2});try{Object.assign(c,"xy")}catch(t){return"y"===c[1]}}()&&Q(Object,"assign",Td.assign);aa(Object,Td);if(J){var Ra={setPrototypeOf:function(c,b){var f=function(c,b){if(!y.TypeIsObject(c))throw new TypeError("cannot set prototype on a non-object");
if(null!==b&&!y.TypeIsObject(b))throw new TypeError("can only set prototype to an object or null"+b);l(g,c,b);return c};try{var g=c.getOwnPropertyDescriptor(c.prototype,b).set;l(g,{},null)}catch(ya){if(c.prototype!=={}[b])return;g=function(c){this[b]=c};f.polyfill=f(f({},null),c.prototype)instanceof c}return f}(Object,"__proto__")};aa(Object,Ra)}Object.setPrototypeOf&&Object.getPrototypeOf&&null!==Object.getPrototypeOf(Object.setPrototypeOf({},null))&&null===Object.getPrototypeOf(Object.create(null))&&
function(){var c=Object.create(null),b=Object.getPrototypeOf,f=Object.setPrototypeOf;Object.getPrototypeOf=function(f){f=b(f);return f===c?null:f};Object.setPrototypeOf=function(b,g){return f(b,null===g?c:g)};Object.setPrototypeOf.polyfill=!1}();if(r(function(){return Object.keys("foo")})){var Ud=Object.keys;Q(Object,"keys",function(c){return Ud(y.ToObject(c))});p=Object.keys}if(r(function(){return Object.keys(/a/g)})){var Vd=Object.keys;Q(Object,"keys",function(c){if(za.regex(c)){var b=[],f;for(f in c)hc(c,
f)&&Ta(b,f);return b}return Vd(c)});p=Object.keys}if(Object.getOwnPropertyNames&&r(function(){return Object.getOwnPropertyNames("foo")})){var Wd="object"===typeof window?Object.getOwnPropertyNames(window):[],Xd=Object.getOwnPropertyNames;Q(Object,"getOwnPropertyNames",function(c){c=y.ToObject(c);if("[object Window]"===Fa(c))try{return Xd(c)}catch(t){return vb([],Wd)}return Xd(c)})}if(Object.getOwnPropertyDescriptor&&r(function(){return Object.getOwnPropertyDescriptor("foo","bar")})){var ne=Object.getOwnPropertyDescriptor;
Q(Object,"getOwnPropertyDescriptor",function(c,b){return ne(y.ToObject(c),b)})}if(Object.seal&&r(function(){return Object.seal("foo")})){var bc=Object.seal;Q(Object,"seal",function(c){return y.TypeIsObject(c)?bc(c):c})}if(Object.isSealed&&r(function(){return Object.isSealed("foo")})){var da=Object.isSealed;Q(Object,"isSealed",function(c){return y.TypeIsObject(c)?da(c):!0})}if(Object.freeze&&r(function(){return Object.freeze("foo")})){var qb=Object.freeze;Q(Object,"freeze",function(c){return y.TypeIsObject(c)?
qb(c):c})}if(Object.isFrozen&&r(function(){return Object.isFrozen("foo")})){var Y=Object.isFrozen;Q(Object,"isFrozen",function(c){return y.TypeIsObject(c)?Y(c):!0})}if(Object.preventExtensions&&r(function(){return Object.preventExtensions("foo")})){var gb=Object.preventExtensions;Q(Object,"preventExtensions",function(c){return y.TypeIsObject(c)?gb(c):c})}if(Object.isExtensible&&r(function(){return Object.isExtensible("foo")})){var kd=Object.isExtensible;Q(Object,"isExtensible",function(c){return y.TypeIsObject(c)?
kd(c):!1})}if(Object.getPrototypeOf&&r(function(){return Object.getPrototypeOf("foo")})){var ld=Object.getPrototypeOf;Q(Object,"getPrototypeOf",function(c){return ld(y.ToObject(c))})}var oe=J&&function(){var c=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return c&&y.IsCallable(c.get)}();J&&!oe&&ba.getter(RegExp.prototype,"flags",function(){if(!y.TypeIsObject(this))throw new TypeError("Method called on incompatible type: must be an object.");var c="";this.global&&(c+="g");this.ignoreCase&&
(c+="i");this.multiline&&(c+="m");this.unicode&&(c+="u");this.sticky&&(c+="y");return c});var Yd=J&&C(function(){return"/a/i"===String(new RegExp(/a/g,"i"))}),pc=kc&&J&&function(){var c=/./;c[ka.match]=!1;return RegExp(c)===c}(),oa=C(function(){return"/abc/"===RegExp.prototype.toString.call({source:"abc"})}),Kb=oa&&C(function(){return"/a/b"===RegExp.prototype.toString.call({source:"a",flags:"b"})});if(!oa||!Kb){var md=RegExp.prototype.toString;L(RegExp.prototype,"toString",function(){var c=y.RequireObjectCoercible(this);
if(za.regex(c))return l(md,c);var b=Ec(c.source);c=Ec(c.flags);return"/"+b+"/"+c},!0);ba.preserveToString(RegExp.prototype.toString,md)}if(J&&(!Yd||pc)){var qc=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get,nd=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{},Zd=function(){return this.source},$d=y.IsCallable(nd.get)?nd.get:Zd,Oc=RegExp,ab=function(){return function M(c,b){var f=y.IsRegExp(c);return this instanceof M||!f||"undefined"!==typeof b||c.constructor!==M?za.regex(c)?
(f=y.Call($d,c),c="undefined"===typeof b?y.Call(qc,c):b,new M(f,c)):new Oc(c,b):c}}();ed(Oc,ab,{$input:!0});RegExp=ab;ba.redefine(G,"RegExp",ab)}if(J){var od={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};Z(p(od),function(c){c in RegExp&&!(od[c]in RegExp)&&ba.getter(RegExp,od[c],function(){return RegExp[c]})})}x(RegExp);var Pc=1/Number.EPSILON,Qc=Math.pow(2,-23),pe=Math.pow(2,127)*(2-Qc),pd=Math.pow(2,-126),Lb=Math.E,Da=Math.LOG2E,Na=Math.LOG10E,S=Number.prototype.clz;
delete Number.prototype.clz;var wa={acosh:function(c){var b=Number(c);if(Qa(b)||1>c)return NaN;if(1===b)return 0;if(Infinity===b)return b;c=1/(b*b);if(2>b)return Bb(b-1+ha(1-c)*b);b/=2;return Bb(b+ha(1-c)*b-1)+1/Da},asinh:function(c){var b=Number(c);if(0===b||!Pa(b))return b;c=q(b);var f=c*c;b=Rb(b);return 1>c?b*Bb(c+f/(ha(f+1)+1)):b*(Bb(c/2+ha(1+1/f)*c/2-1)+1/Da)},atanh:function(c){c=Number(c);if(0===c)return c;if(-1===c)return-Infinity;if(1===c)return Infinity;if(Qa(c)||-1>c||1<c)return NaN;var b=
q(c);return Rb(c)*Bb(2*b/(1-b))/2},cbrt:function(c){c=Number(c);if(0===c)return c;var b=0>c;b&&(c=-c);if(Infinity===c)var f=Infinity;else f=Ba(Ga(c)/3),f=(c/(f*f)+2*f)/3;return b?-f:f},clz32:function(c){c=y.ToUint32(Number(c));return 0===c?32:S?y.Call(S,c):31-e(Ga(c+.5)*Da)},cosh:function(c){c=Number(c);if(0===c)return 1;if(Qa(c))return NaN;if(!Pa(c))return Infinity;c=Ba(q(c)-1);return Lb/2*(c+1/(c*Lb*Lb))},expm1:function(c){c=Number(c);if(-Infinity===c)return-1;if(!Pa(c)||0===c)return c;if(.5<q(c))return Ba(c)-
1;for(var b=c,f=0,g=1;f+b!==f;)f+=b,g+=1,b*=c/g;return f},hypot:function(c,b){for(var f=0,g=0,e=0;e<arguments.length;++e){var h=q(Number(arguments[e]));g<h?(f*=g/h*(g/h),f+=1,g=h):f+=0<h?h/g*(h/g):h}return Infinity===g?Infinity:g*ha(f)},log2:function(c){return Ga(c)*Da},log10:function(c){return Ga(c)*Na},log1p:Bb,sign:Rb,sinh:function(c){c=Number(c);if(!Pa(c)||0===c)return c;var b=q(c);if(1>b)return b=Math.expm1(b),Rb(c)*b*(1+1/(b+1))/2;b=Ba(b-1);return Rb(c)*(b-1/(b*Lb*Lb))*(Lb/2)},tanh:function(c){c=
Number(c);return Qa(c)||0===c?c:20<=c?1:-20>=c?-1:(Math.expm1(c)-Math.expm1(-c))/(Ba(c)+Ba(-c))},trunc:function(c){c=Number(c);return 0>c?-e(-c):e(c)},imul:function(c,b){c=y.ToUint32(c);b=y.ToUint32(b);var f=c&65535,g=b&65535;return f*g+((c>>>16&65535)*g+f*(b>>>16&65535)<<16>>>0)|0},fround:function(c){var b=Number(c);if(0===b||Infinity===b||-Infinity===b||Qa(b))return b;c=Rb(b);b=q(b);if(b<pd)return c*(b/pd/Qc+Pc-Pc)*pd*Qc;var f=(1+Qc/Number.EPSILON)*b;b=f-(f-b);return b>pe||Qa(b)?Infinity*c:c*b}};
aa(Math,wa);L(Math,"sinh",wa.sinh,Infinity===Math.sinh(710));L(Math,"cosh",wa.cosh,Infinity===Math.cosh(710));L(Math,"log1p",wa.log1p,-1E-17!==Math.log1p(-1E-17));L(Math,"asinh",wa.asinh,Math.asinh(-1E7)!==-Math.asinh(1E7));L(Math,"asinh",wa.asinh,Infinity===Math.asinh(1E300));L(Math,"atanh",wa.atanh,0===Math.atanh(1E-300));L(Math,"tanh",wa.tanh,-2E-17!==Math.tanh(-2E-17));L(Math,"acosh",wa.acosh,Infinity===Math.acosh(Number.MAX_VALUE));L(Math,"acosh",wa.acosh,!(8>q(1-Math.acosh(1+Number.EPSILON)/
Math.sqrt(2*Number.EPSILON))/Number.EPSILON));L(Math,"cbrt",wa.cbrt,!(8>q(1-Math.cbrt(1E-300)/1E-100)/Number.EPSILON));L(Math,"sinh",wa.sinh,-2E-17!==Math.sinh(-2E-17));var rc=Math.expm1(10);L(Math,"expm1",wa.expm1,22025.465794806718<rc||22025.465794806718>rc);var sc=Math.round,ae=0===Math.round(.5-Number.EPSILON/4)&&1===Math.round(-.5+Number.EPSILON/3.99),qd=[Pc+1,2*Pc-1].every(function(c){return Math.round(c)===c});L(Math,"round",function(c){var b=e(c);return.5>c-b?b:-1===b?-0:b+1},!ae||!qd);ba.preserveToString(Math.round,
sc);var tc=Math.imul;-5!==Math.imul(4294967295,5)&&(Math.imul=wa.imul,ba.preserveToString(Math.imul,tc));2!==Math.imul.length&&Q(Math,"imul",function(c,b){return y.Call(tc,Math,arguments)});var vc=function(){var c=G.setTimeout;if("function"===typeof c||"object"===typeof c){y.IsPromise=function(c){return y.TypeIsObject(c)&&"undefined"!==typeof c._promise?!0:!1};var b=function(c){if(!y.IsConstructor(c))throw new TypeError("Bad promise constructor");var b=this;b.resolve=void 0;b.reject=void 0;b.promise=
new c(function(c,f){if(void 0!==b.resolve||void 0!==b.reject)throw new TypeError("Bad Promise implementation!");b.resolve=c;b.reject=f});if(!y.IsCallable(b.resolve)||!y.IsCallable(b.reject))throw new TypeError("Bad promise constructor");},f;"undefined"!==typeof window&&y.IsCallable(window.postMessage)&&(f=function(){var c=[];window.addEventListener("message",function(b){b.source===window&&"zero-timeout-message"===b.data&&(b.stopPropagation(),0!==c.length&&X(c)())},!0);return function(b){Ta(c,b);window.postMessage("zero-timeout-message",
"*")}});var g=function(){var c=G.Promise,b=c&&c.resolve&&c.resolve();return b&&function(c){return b.then(c)}},e=y.IsCallable(G.setImmediate)?G.setImmediate:"object"===typeof process&&process.nextTick?process.nextTick:g()||(y.IsCallable(f)?f():function(b){c(b,0)}),h=function(c){return c},k=function(c){throw c;},m={},p=function(c,b,f){e(function(){if(b===m)c(f);else{try{var g=c(f);var e=b.resolve}catch(rd){g=rd,e=b.reject}e(g)}})},q=function(c,b){var f=c._promise,g=f.reactionLength;if(0<g&&(p(f.fulfillReactionHandler0,
f.reactionCapability0,b),f.fulfillReactionHandler0=void 0,f.rejectReactions0=void 0,f.reactionCapability0=void 0,1<g))for(var e=1,h=0;e<g;e++,h+=3)p(f[h+0],f[h+2],b),c[h+0]=void 0,c[h+1]=void 0,c[h+2]=void 0;f.result=b;f.state=1;f.reactionLength=0},r=function(c,b){var f=c._promise,g=f.reactionLength;if(0<g&&(p(f.rejectReactionHandler0,f.reactionCapability0,b),f.fulfillReactionHandler0=void 0,f.rejectReactions0=void 0,f.reactionCapability0=void 0,1<g))for(var e=1,h=0;e<g;e++,h+=3)p(f[h+1],f[h+2],b),
c[h+0]=void 0,c[h+1]=void 0,c[h+2]=void 0;f.result=b;f.state=2;f.reactionLength=0},u=function(c){var b=!1;return{resolve:function(f){if(!b){b=!0;if(f===c)return r(c,new TypeError("Self resolution"));if(!y.TypeIsObject(f))return q(c,f);try{var g=f.then}catch(be){return r(c,be)}if(!y.IsCallable(g))return q(c,f);e(function(){var b=g,e=u(c),h=e.resolve;e=e.reject;try{v(b,f,h,e)}catch(se){e(se)}})}},reject:function(f){if(!b)return b=!0,r(c,f)}}},v=function(c,b,f,g){c===J?l(c,b,f,g,m):l(c,b,f,g)},F=function(){var c=
function(b){if(!(this instanceof c))throw new TypeError('Constructor Promise requires "new"');if(this&&this._promise)throw new TypeError("Bad construction");if(!y.IsCallable(b))throw new TypeError("not a valid resolver");var f=fb(this,c,x,{_promise:{result:void 0,state:0,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}}),g=u(f),e=g.reject;try{b(g.resolve,e)}catch(rd){e(rd)}return f};return c}();var x=F.prototype;var z=function(c,b,f,g){var e=
!1;return function(h){e||(e=!0,b[c]=h,0===--g.count&&(h=f.resolve,h(b)))}};aa(F,{all:function(c){if(!y.TypeIsObject(this))throw new TypeError("Promise is not object");var f=new b(this),g;try{var e=y.GetIterator(c);c=g={iterator:e,done:!1};for(var h=c.iterator,k=[],m={count:1},l,p,q=0;;){try{l=y.IteratorStep(h);if(!1===l){c.done=!0;break}p=l.value}catch(ud){throw c.done=!0,ud;}k[q]=void 0;var t=this.resolve(p),r=z(q,k,f,m);m.count+=1;v(t.then,t,r,f.reject);q+=1}if(0===--m.count){var u=f.resolve;u(k)}return f.promise}catch(ud){h=
ud;if(g&&!g.done)try{y.IteratorClose(e,!0)}catch(Mb){h=Mb}e=f.reject;e(h);return f.promise}},race:function(c){if(!y.TypeIsObject(this))throw new TypeError("Promise is not object");var f=new b(this),g;try{var e=y.GetIterator(c);c=g={iterator:e,done:!1};for(var h=c.iterator,k,m,l;;){try{k=y.IteratorStep(h);if(!1===k){c.done=!0;break}m=k.value}catch(uc){throw c.done=!0,uc;}l=this.resolve(m);v(l.then,l,f.resolve,f.reject)}return f.promise}catch(uc){h=uc;if(g&&!g.done)try{y.IteratorClose(e,!0)}catch(te){h=
te}e=f.reject;e(h);return f.promise}},reject:function(c){if(!y.TypeIsObject(this))throw new TypeError("Bad promise constructor");var f=new b(this),g=f.reject;g(c);return f.promise},resolve:function(c){if(!y.TypeIsObject(this))throw new TypeError("Bad promise constructor");if(y.IsPromise(c)&&c.constructor===this)return c;var f=new b(this),g=f.resolve;g(c);return f.promise}});aa(x,{"catch":function(c){return this.then(null,c)},then:function(c,f){if(!y.IsPromise(this))throw new TypeError("not a promise");
var g=y.SpeciesConstructor(this,F);g=2<arguments.length&&arguments[2]===m&&g===F?m:new b(g);var e=y.IsCallable(c)?c:h,l=y.IsCallable(f)?f:k,q=this._promise;if(0===q.state){if(0===q.reactionLength)q.fulfillReactionHandler0=e,q.rejectReactionHandler0=l,q.reactionCapability0=g;else{var t=3*(q.reactionLength-1);q[t+0]=e;q[t+1]=l;q[t+2]=g}q.reactionLength+=1}else if(1===q.state)q=q.result,p(e,g,q);else if(2===q.state)q=q.result,p(l,g,q);else throw new TypeError("unexpected Promise state");return g.promise}});
m=new b(F);var J=x.then;return F}}();G.Promise&&(delete G.Promise.accept,delete G.Promise.defer,delete G.Promise.prototype.chain);if("function"===typeof vc){aa(G,{Promise:vc});var ve=qa(G.Promise,function(c){return c.resolve(42).then(function(){})instanceof c}),Rc=!r(function(){return G.Promise.reject(42).then(null,5).then(null,Qb)}),Sa=r(function(){return G.Promise.call(3,Qb)}),vd=function(c){var b=c.resolve(5);b.constructor={};c=c.resolve(b);try{c.then(null,Qb).then(null,Qb)}catch(E){return!0}return b===
c}(G.Promise),wc=J&&function(){var c=0,b=Object.defineProperty({},"then",{get:function(){c+=1}});Promise.resolve(b);return 1===c}(),Nb=function E(c){var b=new Promise(c);c(3,function(){});this.then=b.then;this.constructor=E};Nb.prototype=Promise.prototype;Nb.all=Promise.all;var xc=C(function(){return!!Nb.all([1,2])});ve&&Rc&&Sa&&!vd&&wc&&!xc||(Promise=vc,Q(G,"Promise",vc));if(1!==Promise.all.length){var Sc=Promise.all;Q(Promise,"all",function(c){return y.Call(Sc,this,arguments)})}if(1!==Promise.race.length){var Tc=
Promise.race;Q(Promise,"race",function(c){return y.Call(Tc,this,arguments)})}if(1!==Promise.resolve.length){var sa=Promise.resolve;Q(Promise,"resolve",function(c){return y.Call(sa,this,arguments)})}if(1!==Promise.reject.length){var pa=Promise.reject;Q(Promise,"reject",function(c){return y.Call(pa,this,arguments)})}Nc(Promise,"all");Nc(Promise,"race");Nc(Promise,"resolve");Nc(Promise,"reject");x(Promise)}var cc=function(c){var b=p(ja(c,function(c,b){c[b]=!0;return c},{}));return c.join(":")===b.join(":")},
Wa=cc(["z","a","bb"]),Ja=cc(["z",1,"a","3",2]);if(J){var z=function(c,b){return b||Wa?mb(c)?"^"+y.ToString(c):"string"===typeof c?"$"+c:"number"===typeof c?Ja?c:"n"+c:"boolean"===typeof c?"b"+c:null:null},ia=function(){return Object.create?Object.create(null):{}},la=function(c,b,f){if(h(f)||za.string(f))Z(f,function(c){if(!y.TypeIsObject(c))throw new TypeError("Iterator value "+c+" is not an entry object");b.set(c[0],c[1])});else if(f instanceof c)l(c.prototype.forEach,f,function(c,f){b.set(f,c)});
else{if(!mb(f)){var g=b.set;if(!y.IsCallable(g))throw new TypeError("bad map");var e=y.GetIterator(f)}if("undefined"!==typeof e)for(;;){c=y.IteratorStep(e);if(!1===c)break;c=c.value;try{if(!y.TypeIsObject(c))throw new TypeError("Iterator value "+c+" is not an entry object");l(g,b,c[0],c[1])}catch(Hc){throw y.IteratorClose(e,!0),Hc;}}}},u=function(c,b,f){if(h(f)||za.string(f))Z(f,function(c){b.add(c)});else if(f instanceof c)l(c.prototype.forEach,f,function(c){b.add(c)});else{if(!mb(f)){var g=b.add;
if(!y.IsCallable(g))throw new TypeError("bad set");var e=y.GetIterator(f)}if("undefined"!==typeof e)for(;;){c=y.IteratorStep(e);if(!1===c)break;c=c.value;try{l(g,b,c)}catch(Hc){throw y.IteratorClose(e,!0),Hc;}}}},bb={Map:function(){var c={},b=function(c,b){this.key=c;this.value=b;this.prev=this.next=null};b.prototype.isRemoved=function(){return this.key===c};var f=function(c,b){if(!y.TypeIsObject(c)||!c._es6map)throw new TypeError("Method Map.prototype."+b+" called on incompatible receiver "+y.ToString(c));
},g=function(c,b){f(c,"[[MapIterator]]");this.i=this.head=c._head;this.kind=b};g.prototype={isMapIterator:!0,next:function(){if(!this.isMapIterator)throw new TypeError("Not a MapIterator");var c=this.i,b=this.kind,f=this.head;if("undefined"===typeof this.i)return Gb();for(;c.isRemoved()&&c!==f;)c=c.prev;for(;c.next!==f;)if(c=c.next,!c.isRemoved())return b="key"===b?c.key:"value"===b?c.value:[c.key,c.value],this.i=c,Gb(b);this.i=void 0;return Gb()}};D(g.prototype);var e=function Ic(){if(!(this instanceof
Ic))throw new TypeError('Constructor Map requires "new"');if(this&&this._es6map)throw new TypeError("Bad construction");var c=fb(this,Ic,h,{_es6map:!0,_head:null,_map:Ca?new Ca:null,_size:0,_storage:ia()}),f=new b(null,null);f.next=f.prev=f;c._head=f;0<arguments.length&&la(Ic,c,arguments[0]);return c};var h=e.prototype;ba.getter(h,"size",function(){if("undefined"===typeof this._size)throw new TypeError("size method called on incompatible Map");return this._size});aa(h,{get:function(c){f(this,"get");
var b=z(c,!0);if(null!==b){if(c=this._storage[b])return c.value}else if(this._map){if(c=ca.call(this._map,c))return c.value}else for(var g=b=this._head;(g=g.next)!==b;)if(y.SameValueZero(g.key,c))return g.value},has:function(c){f(this,"has");var b=z(c,!0);if(null!==b)return"undefined"!==typeof this._storage[b];if(this._map)return zb.call(this._map,c);for(var g=b=this._head;(g=g.next)!==b;)if(y.SameValueZero(g.key,c))return!0;return!1},set:function(c,g){f(this,"set");var e=this._head,h=e,k=z(c,!0);
if(null!==k){if("undefined"!==typeof this._storage[k])return this._storage[k].value=g,this;var m=this._storage[k]=new b(c,g);h=e.prev}else this._map&&(zb.call(this._map,c)?ca.call(this._map,c).value=g:(m=new b(c,g),ic.call(this._map,c,m),h=e.prev));for(;(h=h.next)!==e;)if(y.SameValueZero(h.key,c))return h.value=g,this;m=m||new b(c,g);y.SameValue(-0,c)&&(m.key=0);m.next=this._head;m.prev=this._head.prev;m.prev.next=m;m.next.prev=m;this._size+=1;return this},"delete":function(b){f(this,"delete");var g=
this._head,e=g,h=z(b,!0);if(null!==h){if("undefined"===typeof this._storage[h])return!1;e=this._storage[h].prev;delete this._storage[h]}else if(this._map){if(!zb.call(this._map,b))return!1;e=ca.call(this._map,b).prev;$c.call(this._map,b)}for(;(e=e.next)!==g;)if(y.SameValueZero(e.key,b))return e.key=c,e.value=c,e.prev.next=e.next,e.next.prev=e.prev,--this._size,!0;return!1},clear:function(){f(this,"clear");this._map=Ca?new Ca:null;this._size=0;this._storage=ia();for(var b=this._head,g,e=b.next;(g=
e)!==b;)g.key=c,g.value=c,e=g.next,g.next=g.prev=b;b.next=b.prev=b},keys:function(){f(this,"keys");return new g(this,"key")},values:function(){f(this,"values");return new g(this,"value")},entries:function(){f(this,"entries");return new g(this,"key+value")},forEach:function(c){f(this,"forEach");for(var b=1<arguments.length?arguments[1]:null,g=this.entries(),e=g.next();!e.done;e=g.next())b?l(c,b,e.value[1],e.value[0],this):c(e.value[1],e.value[0],this)}});D(h,h.entries);return e}(),Set:function(){var c=
function(c,b){if(!y.TypeIsObject(c)||!c._es6set||"undefined"===typeof c._storage)throw new TypeError("Set.prototype."+b+" called on incompatible receiver "+y.ToString(c));},b=function fd(){if(!(this instanceof fd))throw new TypeError('Constructor Set requires "new"');if(this&&this._es6set)throw new TypeError("Bad construction");var c=fb(this,fd,f,{_es6set:!0,"[[SetData]]":null,_storage:ia()});if(!c._es6set)throw new TypeError("bad set");0<arguments.length&&u(fd,c,arguments[0]);return c};var f=b.prototype;
var g=function(c){if(!c["[[SetData]]"]){var b=new bb.Map;c["[[SetData]]"]=b;Z(p(c._storage),function(c){if("^null"===c)c=null;else if("^undefined"!==c){var f=c.charAt(0);c="$"===f?ub(c,1):"n"===f?+ub(c,1):"b"===f?"btrue"===c:+c}else c=void 0;b.set(c,c)});c["[[SetData]]"]=b}c._storage=null};ba.getter(b.prototype,"size",function(){c(this,"size");if(this._storage)return p(this._storage).length;g(this);return this["[[SetData]]"].size});aa(b.prototype,{has:function(b){c(this,"has");var f;if(this._storage&&
null!==(f=z(b)))return!!this._storage[f];g(this);return this["[[SetData]]"].has(b)},add:function(b){c(this,"add");var f;if(this._storage&&null!==(f=z(b)))return this._storage[f]=!0,this;g(this);this["[[SetData]]"].set(b,b);return this},"delete":function(b){c(this,"delete");var f;if(this._storage&&null!==(f=z(b)))return b=hc(this._storage,f),delete this._storage[f]&&b;g(this);return this["[[SetData]]"]["delete"](b)},clear:function(){c(this,"clear");this._storage&&(this._storage=ia());this["[[SetData]]"]&&
this["[[SetData]]"].clear()},values:function(){c(this,"values");g(this);return new e(this["[[SetData]]"].values())},entries:function(){c(this,"entries");g(this);return new e(this["[[SetData]]"].entries())},forEach:function(b){c(this,"forEach");var f=1<arguments.length?arguments[1]:null,e=this;g(e);this["[[SetData]]"].forEach(function(c,g){f?l(b,f,g,g,e):b(g,g,e)})}});L(b.prototype,"keys",b.prototype.values,!0);D(b.prototype,b.prototype.values);var e=function(c){this.it=c};e.prototype={isSetIterator:!0,
next:function(){if(!this.isSetIterator)throw new TypeError("Not a SetIterator");return this.it.next()}};D(e.prototype);return b}()};G.Set&&!Set.prototype["delete"]&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys)&&(G.Set=bb.Set);if(G.Map||G.Set){C(function(){return 2===(new Map([[1,2]])).get(1)})||(G.Map=function t(){if(!(this instanceof t))throw new TypeError('Constructor Map requires "new"');var c=new Ca;0<arguments.length&&la(t,c,arguments[0]);delete c.constructor;
Object.setPrototypeOf(c,G.Map.prototype);return c},G.Map.prototype=na(Ca.prototype),L(G.Map.prototype,"constructor",G.Map,!0),ba.preserveToString(G.Map,Ca));var Uc=new Map,Vc=function(){var c=new Map([[1,0],[2,0],[3,0],[4,0]]);c.set(-0,c);return c.get(0)===c&&c.get(-0)===c&&c.has(0)&&c.has(-0)}(),rb=Uc.set(1,2)===Uc;Vc&&rb||Q(Map.prototype,"set",function(c,b){l(ic,this,0===c?0:c,b);return this});Vc||(aa(Map.prototype,{get:function(c){return l(ca,this,0===c?0:c)},has:function(c){return l(zb,this,0===
c?0:c)}},!0),ba.preserveToString(Map.prototype.get,ca),ba.preserveToString(Map.prototype.has,zb));var yc=new Set,dc=Set.prototype["delete"]&&Set.prototype.add&&Set.prototype.has&&function(c){c["delete"](0);c.add(-0);return!c.has(0)}(yc),ce=yc.add(1)===yc;if(!dc||!ce){var ec=Set.prototype.add;Set.prototype.add=function(c){l(ec,this,0===c?0:c);return this};ba.preserveToString(Set.prototype.add,ec)}if(!dc){var xb=Set.prototype.has;Set.prototype.has=function(c){return l(xb,this,0===c?0:c)};ba.preserveToString(Set.prototype.has,
xb);var zc=Set.prototype["delete"];Set.prototype["delete"]=function(c){return l(zc,this,0===c?0:c)};ba.preserveToString(Set.prototype["delete"],zc)}var Ha=qa(G.Map,function(c){var b=new c([]);b.set(42,42);return b instanceof c}),wd=Object.setPrototypeOf&&!Ha;try{var Ac=!(G.Map()instanceof G.Map)}catch(V){Ac=V instanceof TypeError}if(0!==G.Map.length||wd||!Ac)G.Map=function t(){if(!(this instanceof t))throw new TypeError('Constructor Map requires "new"');var c=new Ca;0<arguments.length&&la(t,c,arguments[0]);
delete c.constructor;Object.setPrototypeOf(c,t.prototype);return c},G.Map.prototype=Ca.prototype,L(G.Map.prototype,"constructor",G.Map,!0),ba.preserveToString(G.Map,Ca);var ea=qa(G.Set,function(c){var b=new c([]);b.add(42,42);return b instanceof c}),ua=Object.setPrototypeOf&&!ea;try{var xd=!(G.Set()instanceof G.Set)}catch(V){xd=V instanceof TypeError}if(0!==G.Set.length||ua||!xd){var Wc=G.Set;G.Set=function t(){if(!(this instanceof t))throw new TypeError('Constructor Set requires "new"');var c=new Wc;
0<arguments.length&&u(t,c,arguments[0]);delete c.constructor;Object.setPrototypeOf(c,t.prototype);return c};G.Set.prototype=Wc.prototype;L(G.Set.prototype,"constructor",G.Set,!0);ba.preserveToString(G.Set,Wc)}var Xa=new G.Map,yb=!C(function(){return Xa.keys().next().done});("function"!==typeof G.Map.prototype.clear||0!==(new G.Set).size||0!==Xa.size||"function"!==typeof G.Map.prototype.keys||"function"!==typeof G.Set.prototype.keys||"function"!==typeof G.Map.prototype.forEach||"function"!==typeof G.Set.prototype.forEach||
I(G.Map)||I(G.Set)||"function"!==typeof Xa.keys().next||yb||!Ha)&&aa(G,{Map:bb.Map,Set:bb.Set},!0);G.Set.prototype.keys!==G.Set.prototype.values&&L(G.Set.prototype,"keys",G.Set.prototype.values,!0);D(Object.getPrototypeOf((new G.Map).keys()));D(Object.getPrototypeOf((new G.Set).keys()));if(F&&"has"!==G.Set.prototype.has.name){var Vb=G.Set.prototype.has;Q(G.Set.prototype,"has",function(c){return l(Vb,this,c)})}}aa(G,bb);x(G.Map);x(G.Set)}var cb=function(c){if(!y.TypeIsObject(c))throw new TypeError("target must be an object");
},Ya={apply:function(){return y.Call(y.Call,null,arguments)},construct:function(c,b){if(!y.IsConstructor(c))throw new TypeError("First argument must be a constructor.");var f=2<arguments.length?arguments[2]:c;if(!y.IsConstructor(f))throw new TypeError("new.target must be a constructor.");return y.Construct(c,b,f,"internal")},deleteProperty:function(c,b){cb(c);if(J){var f=Object.getOwnPropertyDescriptor(c,b);if(f&&!f.configurable)return!1}return delete c[b]},has:function(c,b){cb(c);return b in c}};
Object.getOwnPropertyNames&&Object.assign(Ya,{ownKeys:function(c){cb(c);var b=Object.getOwnPropertyNames(c);y.IsCallable(Object.getOwnPropertySymbols)&&La(b,Object.getOwnPropertySymbols(c));return b}});Object.preventExtensions&&Object.assign(Ya,{isExtensible:function(c){cb(c);return Object.isExtensible(c)},preventExtensions:function(c){cb(c);return!r(function(){return Object.preventExtensions(c)})}});if(J){var de=function(c,b,f){var g=Object.getOwnPropertyDescriptor(c,b);if(!g)return c=Object.getPrototypeOf(c),
null===c?void 0:de(c,b,f);if("value"in g)return g.value;if(g.get)return y.Call(g.get,f)},m=function(c,b,f,g){var e=Object.getOwnPropertyDescriptor(c,b);if(!e){c=Object.getPrototypeOf(c);if(null!==c)return m(c,b,f,g);e={value:void 0,writable:!0,enumerable:!0,configurable:!0}}return"value"in e?e.writable&&y.TypeIsObject(g)?Object.getOwnPropertyDescriptor(g,b)?Cb.defineProperty(g,b,{value:f}):Cb.defineProperty(g,b,{value:f,writable:!0,enumerable:!0,configurable:!0}):!1:e.set?(l(e.set,g,f),!0):!1};Object.assign(Ya,
{defineProperty:function(c,b,f){cb(c);return!r(function(){return Object.defineProperty(c,b,f)})},getOwnPropertyDescriptor:function(c,b){cb(c);return Object.getOwnPropertyDescriptor(c,b)},get:function(c,b){cb(c);return de(c,b,2<arguments.length?arguments[2]:c)},set:function(c,b,f){cb(c);return m(c,b,f,3<arguments.length?arguments[3]:c)}})}if(Object.getPrototypeOf){var yd=Object.getPrototypeOf;Ya.getPrototypeOf=function(c){cb(c);return yd(c)}}Object.setPrototypeOf&&Ya.getPrototypeOf&&Object.assign(Ya,
{setPrototypeOf:function(c,b){cb(c);if(null!==b&&!y.TypeIsObject(b))throw new TypeError("proto must be an object or null");if(b===Cb.getPrototypeOf(c))return!0;if(Cb.isExtensible&&!Cb.isExtensible(c))return!1;var f;a:{for(f=b;f;){if(c===f){f=!0;break a}f=Ya.getPrototypeOf(f)}f=!1}if(f)return!1;Object.setPrototypeOf(c,b);return!0}});var we=function(c,b){y.IsCallable(G.Reflect[c])?C(function(){G.Reflect[c](1);G.Reflect[c](NaN);G.Reflect[c](!0);return!0})&&Q(G.Reflect,c,b):L(G.Reflect,c,b)};Object.keys(Ya).forEach(function(c){we(c,
Ya[c])});var Bc=G.Reflect.getPrototypeOf;F&&Bc&&"getPrototypeOf"!==Bc.name&&Q(G.Reflect,"getPrototypeOf",function(c){return l(Bc,G.Reflect,c)});G.Reflect.setPrototypeOf&&C(function(){G.Reflect.setPrototypeOf(1,{});return!0})&&Q(G.Reflect,"setPrototypeOf",Ya.setPrototypeOf);G.Reflect.defineProperty&&(C(function(){var c=!G.Reflect.defineProperty(1,"test",{value:1}),b="function"!==typeof Object.preventExtensions||!G.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return c&&b})||Q(G.Reflect,
"defineProperty",Ya.defineProperty));G.Reflect.construct&&(C(function(){var c=function(){};return G.Reflect.construct(function(){},[],c)instanceof c})||Q(G.Reflect,"construct",Ya.construct));if("Invalid Date"!==String(new Date(NaN))){var xe=Date.prototype.toString;Q(Date.prototype,"toString",function(){var c=+this;return c!==c?"Invalid Date":y.Call(xe,this)})}var ee={anchor:function(c){return y.CreateHTML(this,"a","name",c)},big:function(){return y.CreateHTML(this,"big","","")},blink:function(){return y.CreateHTML(this,
"blink","","")},bold:function(){return y.CreateHTML(this,"b","","")},fixed:function(){return y.CreateHTML(this,"tt","","")},fontcolor:function(c){return y.CreateHTML(this,"font","color",c)},fontsize:function(c){return y.CreateHTML(this,"font","size",c)},italics:function(){return y.CreateHTML(this,"i","","")},link:function(c){return y.CreateHTML(this,"a","href",c)},small:function(){return y.CreateHTML(this,"small","","")},strike:function(){return y.CreateHTML(this,"strike","","")},sub:function(){return y.CreateHTML(this,
"sub","","")},sup:function(){return y.CreateHTML(this,"sup","","")}};Z(Object.keys(ee),function(c){var b=String.prototype[c];if(y.IsCallable(b)){b=l(b,"",' " ');var f=vb([],b.match(/"/g)).length;b=b!==b.toLowerCase()||2<f}else b=!0;b&&Q(String.prototype,c,ee[c])});var f=function(){if(!kc)return!1;var c="object"===typeof JSON&&"function"===typeof JSON.stringify?JSON.stringify:null;if(!c)return!1;if("undefined"!==typeof c(ka())||"[null]"!==c([ka()]))return!0;var b={a:ka()};b[ka()]=!0;return"{}"!==c(b)?
!0:!1}(),ib=C(function(){return kc?"{}"===JSON.stringify(Object(ka()))&&"[{}]"===JSON.stringify([Object(ka())]):!0});if(f||!ib){var v=JSON.stringify;Q(JSON,"stringify",function(c){if("symbol"!==typeof c){var b;1<arguments.length&&(b=arguments[1]);var f=[c];if(h(b))f.push(b);else{var g=y.IsCallable(b)?b:null;f.push(function(c,b){c=g?l(g,this,c,b):b;if("symbol"!==typeof c)return za.symbol(c)?oc({})(c):c})}2<arguments.length&&f.push(arguments[2]);return v.apply(this,f)}})}return G});
(function t$jscomp$0(b,l,h){function r(g,J){if(!l[g]){if(!b[g]){var F="function"==typeof require&&require;if(!J&&F)return F(g,!0);if(C)return C(g,!0);J=Error("Cannot find module '"+g+"'");throw J.code="MODULE_NOT_FOUND",J;}J=l[g]={exports:{}};b[g][0].call(J.exports,function(h){var l=b[g][1][h];return r(l?l:h)},J,J.exports,t$jscomp$0,b,l,h)}return l[g].exports}for(var C="function"==typeof require&&require,I=0;I<h.length;I++)r(h[I]);return r})({1:[function(b,l,h){var p=b("./Array.prototype");l.exports=
{prototype:p,shim:function(){p.shim()}}},{"./Array.prototype":3}],2:[function(b,l,h){l.exports=b("array-includes")},{"array-includes":14}],3:[function(b,l,h){var p=b("./Array.prototype.includes");l.exports={includes:p,shim:function(){p.shim()}}},{"./Array.prototype.includes":2}],4:[function(b,l,h){var p=b("object.getownpropertydescriptors"),r=b("object.entries"),C=b("object.values");l.exports={entries:r,getOwnPropertyDescriptors:p,shim:function(){p.shim();r.shim();C.shim()},values:C}},{"object.entries":38,
"object.getownpropertydescriptors":64,"object.values":89}],5:[function(b,l,h){var p=b("./String.prototype");l.exports={prototype:p,shim:function(){p.shim()}}},{"./String.prototype":7}],6:[function(b,l,h){l.exports=b("string-at")},{"string-at":114}],7:[function(b,l,h){var p=b("./String.prototype.at"),r=b("./String.prototype.padStart"),C=b("./String.prototype.padEnd"),I=b("./String.prototype.trimLeft"),g=b("./String.prototype.trimRight");l.exports={at:p,padStart:r,padEnd:C,trimLeft:I,trimRight:g,shim:function(){p.shim();
r.shim();C.shim();I.shim();g.shim()}}},{"./String.prototype.at":6,"./String.prototype.padEnd":8,"./String.prototype.padStart":9,"./String.prototype.trimLeft":10,"./String.prototype.trimRight":11}],8:[function(b,l,h){l.exports=b("string.prototype.padend")},{"string.prototype.padend":137}],9:[function(b,l,h){l.exports=b("string.prototype.padstart")},{"string.prototype.padstart":162}],10:[function(b,l,h){l.exports=b("string.prototype.trimleft")},{"string.prototype.trimleft":187}],11:[function(b,l,h){l.exports=
b("string.prototype.trimright")},{"string.prototype.trimright":197}],12:[function(b,l,h){var p=b("./Array"),r=b("./Object"),C=b("./String");l.exports={Array:p,Object:r,String:C,shim:function(){p.shim();r.shim();C.shim()}}},{"./Array":1,"./Object":4,"./String":5}],13:[function(b,l,h){(function(h){var p=b("es-abstract/es6"),C=Number.isNaN||function(b){return b!==b},I=Number.isFinite||function(b){return"number"===typeof b&&h.isFinite(b)},g=Array.prototype.indexOf;l.exports=function(b){var h=1<arguments.length?
p.ToInteger(arguments[1]):0;if(g&&!C(b)&&I(h)&&"undefined"!==typeof b)return-1<g.apply(this,arguments);var l=p.ToObject(this),r=p.ToLength(l.length);if(0===r)return!1;for(h=0<=h?h:Math.max(0,r+h);h<r;){if(p.SameValueZero(b,l[h]))return!0;h+=1}return!1}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"es-abstract/es6":17}],14:[function(b,l,h){h=b("define-properties");var p=b("es-abstract/es6"),r=b("./implementation"),C=b("./polyfill"),
I=C();b=b("./shim");var g=Array.prototype.slice,J=function(b,h){p.RequireObjectCoercible(b);return I.apply(b,g.call(arguments,1))};h(J,{implementation:r,getPolyfill:C,shim:b});l.exports=J},{"./implementation":13,"./polyfill":35,"./shim":36,"define-properties":15,"es-abstract/es6":17}],15:[function(b,l,h){var p=b("object-keys"),r=b("foreach");$jscomp.initSymbol();$jscomp.initSymbol();var C="function"===typeof Symbol&&"symbol"===typeof Symbol(),I=Object.prototype.toString;b=function(){var b={};try{Object.defineProperty(b,
"x",{enumerable:!1,value:b});for(var g in b)return!1;return b.x===b}catch(Z){return!1}};var g=Object.defineProperty&&b();b=function(b,h){var l=2<arguments.length?arguments[2]:{},F=p(h);C&&(F=F.concat(Object.getOwnPropertySymbols(h)));r(F,function(p){var r=h[p],F=l[p];if(!(p in b)||"function"===typeof F&&"[object Function]"===I.call(F)&&F())g?Object.defineProperty(b,p,{configurable:!0,enumerable:!1,value:r,writable:!0}):b[p]=r})};b.supportsDescriptors=!!g;l.exports=b},{foreach:26,"object-keys":33}],
16:[function(b,l,h){var p=Number.isNaN||function(b){return b!==b},r=b("./helpers/isFinite"),C=b("./helpers/sign"),I=b("./helpers/mod");h=b("is-callable");b={ToPrimitive:b("es-to-primitive/es5"),ToBoolean:function(b){return!!b},ToNumber:function(b){return Number(b)},ToInteger:function(b){b=this.ToNumber(b);return p(b)?0:0!==b&&r(b)?C(b)*Math.floor(Math.abs(b)):b},ToInt32:function(b){return this.ToNumber(b)>>0},ToUint32:function(b){return this.ToNumber(b)>>>0},ToUint16:function(b){b=this.ToNumber(b);
if(p(b)||0===b||!r(b))return 0;b=C(b)*Math.floor(Math.abs(b));return I(b,65536)},ToString:function(b){return String(b)},ToObject:function(b){this.CheckObjectCoercible(b);return Object(b)},CheckObjectCoercible:function(b,h){if(null==b)throw new TypeError(h||"Cannot call method on "+b);return b},IsCallable:h,SameValue:function(b,h){return b===h?0===b?1/b===1/h:!0:p(b)&&p(h)}};l.exports=b},{"./helpers/isFinite":19,"./helpers/mod":21,"./helpers/sign":22,"es-to-primitive/es5":23,"is-callable":29}],17:[function(b,
l,h){var p=Object.prototype.toString;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator;$jscomp.initSymbol();var C=r?Symbol.prototype.toString:p,I=Number.isNaN||function(b){return b!==b},g=b("./helpers/isFinite"),J=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1;h=b("./helpers/assign");var F=b("./helpers/sign"),Z=b("./helpers/mod"),ja=b("./helpers/isPrimitive"),Aa=b("es-to-primitive/es6"),Ka=parseInt,L=b("function-bind"),
aa=L.call(Function.call,String.prototype.slice),Fa=L.call(Function.call,RegExp.prototype.test,/^0b[01]+$/i),k=L.call(Function.call,RegExp.prototype.test,/^0o[0-7]+$/i),ba=L.call(Function.call,RegExp.prototype.test,/[\u0085\u200b\ufffe]/g),na=L.call(Function.call,RegExp.prototype.test,/^[\-\+]0x[0-9a-f]+$/i),qa=/(^[\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]+)|([\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]+$)/g,
G=L.call(Function.call,String.prototype.replace),Pa=b("./es5"),tb=b("is-regex");b=h(h({},Pa),{Call:function(b,g){var h=2<arguments.length?arguments[2]:[];if(!this.IsCallable(b))throw new TypeError(b+" is not a function");return b.apply(g,h)},ToPrimitive:Aa,ToNumber:function(b){b=ja(b)?b:Aa(b,"number");if("symbol"===typeof b)throw new TypeError("Cannot convert a Symbol value to a number");if("string"===typeof b){if(Fa(b))return this.ToNumber(Ka(aa(b,2),2));if(k(b))return this.ToNumber(Ka(aa(b,2),8));
if(ba(b)||na(b))return NaN;var g=G(b,qa,"");if(g!==b)return this.ToNumber(g)}return Number(b)},ToInt16:function(b){b=this.ToUint16(b);return 32768<=b?b-65536:b},ToInt8:function(b){b=this.ToUint8(b);return 128<=b?b-256:b},ToUint8:function(b){b=this.ToNumber(b);if(I(b)||0===b||!g(b))return 0;b=F(b)*Math.floor(Math.abs(b));return Z(b,256)},ToUint8Clamp:function(b){var g=this.ToNumber(b);if(I(g)||0>=g)return 0;if(255<=g)return 255;b=Math.floor(b);return b+.5<g?b+1:g<b+.5?b:0!==b%2?b+1:b},ToString:function(b){if("symbol"===
typeof b)throw new TypeError("Cannot convert a Symbol value to a string");return String(b)},ToObject:function(b){this.RequireObjectCoercible(b);return Object(b)},ToPropertyKey:function(b){b=this.ToPrimitive(b,String);return"symbol"===typeof b?C.call(b):this.ToString(b)},ToLength:function(b){b=this.ToInteger(b);return 0>=b?0:b>J?J:b},CanonicalNumericIndexString:function(b){if("[object String]"!==p.call(b))throw new TypeError("must be a string");if("-0"===b)return-0;var g=this.ToNumber(b);if(this.SameValue(this.ToString(g),
b))return g},RequireObjectCoercible:Pa.CheckObjectCoercible,IsArray:Array.isArray||function(b){return"[object Array]"===p.call(b)},IsConstructor:function(b){return this.IsCallable(b)},IsExtensible:function(b){return Object.preventExtensions?ja(b)?!1:Object.isExtensible(b):!0},IsInteger:function(b){if("number"!==typeof b||I(b)||!g(b))return!1;b=Math.abs(b);return Math.floor(b)===b},IsPropertyKey:function(b){return"string"===typeof b||"symbol"===typeof b},IsRegExp:function(b){if(!b||"object"!==typeof b)return!1;
if(r){$jscomp.initSymbol();var g=RegExp[Symbol.match];if("undefined"!==typeof g)return Pa.ToBoolean(g)}return tb(b)},SameValueZero:function(b,g){return b===g||I(b)&&I(g)}});delete b.CheckObjectCoercible;l.exports=b},{"./es5":16,"./helpers/assign":18,"./helpers/isFinite":19,"./helpers/isPrimitive":20,"./helpers/mod":21,"./helpers/sign":22,"es-to-primitive/es6":24,"function-bind":28,"is-regex":31}],18:[function(b,l,h){var p=Object.prototype.hasOwnProperty;l.exports=Object.assign||function(b,h){for(var l in h)p.call(h,
l)&&(b[l]=h[l]);return b}},{}],19:[function(b,l,h){var p=Number.isNaN||function(b){return b!==b};l.exports=Number.isFinite||function(b){return"number"===typeof b&&!p(b)&&Infinity!==b&&-Infinity!==b}},{}],20:[function(b,l,h){l.exports=function(b){return null===b||"function"!==typeof b&&"object"!==typeof b}},{}],21:[function(b,l,h){l.exports=function(b,h){b%=h;return Math.floor(0<=b?b:b+h)}},{}],22:[function(b,l,h){l.exports=function(b){return 0<=b?1:-1}},{}],23:[function(b,l,h){var p=Object.prototype.toString,
r=b("./helpers/isPrimitive"),C=b("is-callable"),I={"[[DefaultValue]]":function(b,h){h=h||("[object Date]"===p.call(b)?String:Number);if(h===String||h===Number){h=h===String?["toString","valueOf"]:["valueOf","toString"];var g;for(g=0;g<h.length;++g)if(C(b[h[g]])){var l=b[h[g]]();if(r(l))return l}throw new TypeError("No default value");}throw new TypeError("invalid [[DefaultValue]] hint supplied");}};l.exports=function(b,h){return r(b)?b:I["[[DefaultValue]]"](b,h)}},{"./helpers/isPrimitive":25,"is-callable":29}],
24:[function(b,l,h){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var p="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator,r=b("./helpers/isPrimitive"),C=b("is-callable"),I=b("is-date-object"),g=b("is-symbol");l.exports=function(b,h){if(r(b))return b;var l="default";1<arguments.length&&(h===String?l="string":h===Number&&(l="number"));if(p)if($jscomp.initSymbol(),Symbol.toPrimitive){$jscomp.initSymbol();var F=Symbol.toPrimitive;var J=b[F];if(null!==J&&"undefined"!==
typeof J){if(!C(J))throw new TypeError(J+" returned for property "+F+" of object "+b+" is not a function");F=J}else F=void 0}else g(b)&&($jscomp.initSymbol(),F=Symbol.prototype.valueOf);if("undefined"!==typeof F){l=F.call(b,l);if(r(l))return l;throw new TypeError("unable to convert exotic object to primitive");}"default"===l&&(I(b)||g(b))&&(l="string");a:{l="default"===l?"number":l;if("undefined"===typeof b||null===b)throw new TypeError("Cannot call method on "+b);if("string"!==typeof l||"number"!==
l&&"string"!==l)throw new TypeError('hint must be "string" or "number"');l="string"===l?["toString","valueOf"]:["valueOf","toString"];for(F=0;F<l.length;++F)if(J=b[l[F]],C(J)&&(J=J.call(b),r(J)))break a;throw new TypeError("No default value");}return J}},{"./helpers/isPrimitive":25,"is-callable":29,"is-date-object":30,"is-symbol":32}],25:[function(b,l,h){arguments[4][20][0].apply(h,arguments)},{dup:20}],26:[function(b,l,h){var p=Object.prototype.hasOwnProperty,r=Object.prototype.toString;l.exports=
function(b,h,g){if("[object Function]"!==r.call(h))throw new TypeError("iterator must be a function");var l=b.length;if(l===+l)for(var F=0;F<l;F++)h.call(g,b[F],F,b);else for(F in b)p.call(b,F)&&h.call(g,b[F],F,b)}},{}],27:[function(b,l,h){var p=Array.prototype.slice,r=Object.prototype.toString;l.exports=function(b){var h=this;if("function"!==typeof h||"[object Function]"!==r.call(h))throw new TypeError("Function.prototype.bind called on incompatible "+h);for(var g=p.call(arguments,1),l,F=Math.max(0,
h.length-g.length),C=[],ja=0;ja<F;ja++)C.push("$"+ja);l=Function("binder","return function ("+C.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof l){var r=h.apply(this,g.concat(p.call(arguments)));return Object(r)===r?r:this}return h.apply(b,g.concat(p.call(arguments)))});h.prototype&&(F=function(){},F.prototype=h.prototype,l.prototype=new F,F.prototype=null);return l}},{}],28:[function(b,l,h){b=b("./implementation");l.exports=Function.prototype.bind||b},{"./implementation":27}],
29:[function(b,l,h){var p=Function.prototype.toString,r=/^\s*class /,C=function(b){try{var g=p.call(b).replace(/\/\/.*\n/g,"").replace(/\/\*[.\s\S]*\*\//g,"").replace(/\n/gm," ").replace(/ {2}/g," ");return r.test(g)}catch(Z){return!1}},I=Object.prototype.toString;$jscomp.initSymbol();$jscomp.initSymbol();var g="function"===typeof Symbol&&"symbol"===typeof Symbol.toStringTag;l.exports=function(b){if(!b||"function"!==typeof b&&"object"!==typeof b)return!1;if(g){try{if(C(b))var h=!1;else p.call(b),
h=!0}catch(Z){h=!1}return h}if(C(b))return!1;b=I.call(b);return"[object Function]"===b||"[object GeneratorFunction]"===b}},{}],30:[function(b,l,h){var p=Date.prototype.getDay,r=Object.prototype.toString;$jscomp.initSymbol();$jscomp.initSymbol();var C="function"===typeof Symbol&&"symbol"===typeof Symbol.toStringTag;l.exports=function(b){if("object"!==typeof b||null===b)return!1;if(C)try{p.call(b);var g=!0}catch(J){g=!1}else g="[object Date]"===r.call(b);return g}},{}],31:[function(b,l,h){var p=RegExp.prototype.exec,
r=Object.prototype.toString;$jscomp.initSymbol();$jscomp.initSymbol();var C="function"===typeof Symbol&&"symbol"===typeof Symbol.toStringTag;l.exports=function(b){if("object"!==typeof b)return!1;if(C)try{p.call(b);var g=!0}catch(J){g=!1}else g="[object RegExp]"===r.call(b);return g}},{}],32:[function(b,l,h){var p=Object.prototype.toString;$jscomp.initSymbol();$jscomp.initSymbol();if("function"===typeof Symbol&&"symbol"===typeof Symbol()){$jscomp.initSymbol();var r=Symbol.prototype.toString,C=/^Symbol\(.*\)$/;
l.exports=function(b){if("symbol"===typeof b)return!0;if("[object Symbol]"!==p.call(b))return!1;try{var g="symbol"!==typeof b.valueOf()?!1:C.test(r.call(b));return g}catch(J){return!1}}}else l.exports=function(b){return!1}},{}],33:[function(b,l,h){var p=Object.prototype.hasOwnProperty,r=Object.prototype.toString,C=Array.prototype.slice,I=b("./isArguments"),g=!{toString:null}.propertyIsEnumerable("toString"),J=function(){}.propertyIsEnumerable("prototype"),F="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),
Z=function(b){var g=b.constructor;return g&&g.prototype===b},ja={$console:!0,$frame:!0,$frameElement:!0,$frames:!0,$parent:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},Aa=function(){if("undefined"===typeof window)return!1;for(var b in window)try{if(!ja["$"+b]&&p.call(window,b)&&null!==window[b]&&"object"===typeof window[b])try{Z(window[b])}catch(aa){return!0}}catch(aa){return!0}return!1}(),Ka=function(b){var h=null!==b&&"object"===typeof b,l="[object Function]"===r.call(b),k=
I(b),C=h&&"[object String]"===r.call(b),L=[];if(!h&&!l&&!k)throw new TypeError("Object.keys called on a non-object");h=J&&l;if(C&&0<b.length&&!p.call(b,0))for(C=0;C<b.length;++C)L.push(String(C));if(k&&0<b.length)for(k=0;k<b.length;++k)L.push(String(k));else for(var ja in b)h&&"prototype"===ja||!p.call(b,ja)||L.push(String(ja));if(g){if("undefined"!==typeof window&&Aa)try{var G=Z(b)}catch(Pa){G=!1}else G=Z(b);for(k=0;k<F.length;++k)G&&"constructor"===F[k]||!p.call(b,F[k])||L.push(F[k])}return L};
Ka.shim=function(){if(Object.keys){if(!function(){return 2===(Object.keys(arguments)||"").length}(1,2)){var b=Object.keys;Object.keys=function(g){return I(g)?b(C.call(g)):b(g)}}}else Object.keys=Ka;return Object.keys||Ka};l.exports=Ka},{"./isArguments":34}],34:[function(b,l,h){var p=Object.prototype.toString;l.exports=function(b){var h=p.call(b),l="[object Arguments]"===h;l||(l="[object Array]"!==h&&null!==b&&"object"===typeof b&&"number"===typeof b.length&&0<=b.length&&"[object Function]"===p.call(b.callee));
return l}},{}],35:[function(b,l,h){var p=b("./implementation");l.exports=function(){return Array.prototype.includes||p}},{"./implementation":13}],36:[function(b,l,h){var p=b("define-properties"),r=b("./polyfill");l.exports=function(){var b=r();Array.prototype.includes!==b&&p(Array.prototype,{includes:b});return b}},{"./polyfill":35,"define-properties":15}],37:[function(b,l,h){var p=b("es-abstract/es7"),r=b("has"),C=b("function-bind").call(Function.call,Object.prototype.propertyIsEnumerable);l.exports=
function(b){b=p.RequireObjectCoercible(b);var g=[],h;for(h in b)r(b,h)&&C(b,h)&&g.push([h,b[h]]);return g}},{"es-abstract/es7":42,"function-bind":53,has:54}],38:[function(b,l,h){h=b("define-properties");var p=b("./implementation"),r=b("./polyfill");b=b("./shim");h(p,{getPolyfill:r,implementation:p,shim:b});l.exports=p},{"./implementation":37,"./polyfill":61,"./shim":62,"define-properties":39}],39:[function(b,l,h){arguments[4][15][0].apply(h,arguments)},{dup:15,foreach:51,"object-keys":59}],40:[function(b,
l,h){arguments[4][16][0].apply(h,arguments)},{"./helpers/isFinite":44,"./helpers/mod":46,"./helpers/sign":47,dup:16,"es-to-primitive/es5":48,"is-callable":55}],41:[function(b,l,h){arguments[4][17][0].apply(h,arguments)},{"./es5":40,"./helpers/assign":43,"./helpers/isFinite":44,"./helpers/isPrimitive":45,"./helpers/mod":46,"./helpers/sign":47,dup:17,"es-to-primitive/es6":49,"function-bind":53,"is-regex":57}],42:[function(b,l,h){h=b("./es6");b=b("./helpers/assign")(h,{SameValueNonNumber:function(b,
h){if("number"===typeof b||typeof b!==typeof h)throw new TypeError("SameValueNonNumber requires two non-number values of the same type.");return this.SameValue(b,h)}});l.exports=b},{"./es6":41,"./helpers/assign":43}],43:[function(b,l,h){arguments[4][18][0].apply(h,arguments)},{dup:18}],44:[function(b,l,h){arguments[4][19][0].apply(h,arguments)},{dup:19}],45:[function(b,l,h){arguments[4][20][0].apply(h,arguments)},{dup:20}],46:[function(b,l,h){arguments[4][21][0].apply(h,arguments)},{dup:21}],47:[function(b,
l,h){arguments[4][22][0].apply(h,arguments)},{dup:22}],48:[function(b,l,h){arguments[4][23][0].apply(h,arguments)},{"./helpers/isPrimitive":50,dup:23,"is-callable":55}],49:[function(b,l,h){arguments[4][24][0].apply(h,arguments)},{"./helpers/isPrimitive":50,dup:24,"is-callable":55,"is-date-object":56,"is-symbol":58}],50:[function(b,l,h){arguments[4][20][0].apply(h,arguments)},{dup:20}],51:[function(b,l,h){arguments[4][26][0].apply(h,arguments)},{dup:26}],52:[function(b,l,h){arguments[4][27][0].apply(h,
arguments)},{dup:27}],53:[function(b,l,h){arguments[4][28][0].apply(h,arguments)},{"./implementation":52,dup:28}],54:[function(b,l,h){b=b("function-bind");l.exports=b.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":53}],55:[function(b,l,h){arguments[4][29][0].apply(h,arguments)},{dup:29}],56:[function(b,l,h){arguments[4][30][0].apply(h,arguments)},{dup:30}],57:[function(b,l,h){arguments[4][31][0].apply(h,arguments)},{dup:31}],58:[function(b,l,h){arguments[4][32][0].apply(h,arguments)},
{dup:32}],59:[function(b,l,h){arguments[4][33][0].apply(h,arguments)},{"./isArguments":60,dup:33}],60:[function(b,l,h){arguments[4][34][0].apply(h,arguments)},{dup:34}],61:[function(b,l,h){var p=b("./implementation");l.exports=function(){return"function"===typeof Object.entries?Object.entries:p}},{"./implementation":37}],62:[function(b,l,h){var p=b("./polyfill"),r=b("define-properties");l.exports=function(){var b=p();r(Object,{entries:b},{entries:function(){return Object.entries!==b}});return b}},
{"./polyfill":61,"define-properties":39}],63:[function(b,l,h){var p=b("es-abstract/es7"),r=Object.defineProperty,C=Object.getOwnPropertyDescriptor,I=Object.getOwnPropertyNames,g=Object.getOwnPropertySymbols,J=Function.call.bind(Array.prototype.concat),F=Function.call.bind(Array.prototype.reduce),Z=g?function(b){return J(I(b),g(b))}:I,ja=p.IsCallable(C)&&p.IsCallable(I);l.exports=function(b){p.RequireObjectCoercible(b);if(!ja)throw new TypeError("getOwnPropertyDescriptors requires Object.getOwnPropertyDescriptor");
var g=p.ToObject(b);return F(Z(g),function(b,h){var l=C(g,h);r&&h in b?r(b,h,{configurable:!0,enumerable:!0,value:l,writable:!0}):b[h]=l;return b},{})}},{"es-abstract/es7":68}],64:[function(b,l,h){arguments[4][38][0].apply(h,arguments)},{"./implementation":63,"./polyfill":86,"./shim":87,"define-properties":65,dup:38}],65:[function(b,l,h){arguments[4][15][0].apply(h,arguments)},{dup:15,foreach:77,"object-keys":84}],66:[function(b,l,h){arguments[4][16][0].apply(h,arguments)},{"./helpers/isFinite":70,
"./helpers/mod":72,"./helpers/sign":73,dup:16,"es-to-primitive/es5":74,"is-callable":80}],67:[function(b,l,h){arguments[4][17][0].apply(h,arguments)},{"./es5":66,"./helpers/assign":69,"./helpers/isFinite":70,"./helpers/isPrimitive":71,"./helpers/mod":72,"./helpers/sign":73,dup:17,"es-to-primitive/es6":75,"function-bind":79,"is-regex":82}],68:[function(b,l,h){arguments[4][42][0].apply(h,arguments)},{"./es6":67,"./helpers/assign":69,dup:42}],69:[function(b,l,h){arguments[4][18][0].apply(h,arguments)},
{dup:18}],70:[function(b,l,h){arguments[4][19][0].apply(h,arguments)},{dup:19}],71:[function(b,l,h){arguments[4][20][0].apply(h,arguments)},{dup:20}],72:[function(b,l,h){arguments[4][21][0].apply(h,arguments)},{dup:21}],73:[function(b,l,h){arguments[4][22][0].apply(h,arguments)},{dup:22}],74:[function(b,l,h){arguments[4][23][0].apply(h,arguments)},{"./helpers/isPrimitive":76,dup:23,"is-callable":80}],75:[function(b,l,h){arguments[4][24][0].apply(h,arguments)},{"./helpers/isPrimitive":76,dup:24,"is-callable":80,
"is-date-object":81,"is-symbol":83}],76:[function(b,l,h){arguments[4][20][0].apply(h,arguments)},{dup:20}],77:[function(b,l,h){arguments[4][26][0].apply(h,arguments)},{dup:26}],78:[function(b,l,h){arguments[4][27][0].apply(h,arguments)},{dup:27}],79:[function(b,l,h){arguments[4][28][0].apply(h,arguments)},{"./implementation":78,dup:28}],80:[function(b,l,h){arguments[4][29][0].apply(h,arguments)},{dup:29}],81:[function(b,l,h){arguments[4][30][0].apply(h,arguments)},{dup:30}],82:[function(b,l,h){arguments[4][31][0].apply(h,
arguments)},{dup:31}],83:[function(b,l,h){arguments[4][32][0].apply(h,arguments)},{dup:32}],84:[function(b,l,h){arguments[4][33][0].apply(h,arguments)},{"./isArguments":85,dup:33}],85:[function(b,l,h){arguments[4][34][0].apply(h,arguments)},{dup:34}],86:[function(b,l,h){var p=b("./implementation");l.exports=function(){return"function"===typeof Object.getOwnPropertyDescriptors?Object.getOwnPropertyDescriptors:p}},{"./implementation":63}],87:[function(b,l,h){var p=b("./polyfill"),r=b("define-properties");
l.exports=function(){var b=p();r(Object,{getOwnPropertyDescriptors:b},{getOwnPropertyDescriptors:function(){return Object.getOwnPropertyDescriptors!==b}});return b}},{"./polyfill":86,"define-properties":65}],88:[function(b,l,h){var p=b("es-abstract/es7"),r=b("has"),C=b("function-bind").call(Function.call,Object.prototype.propertyIsEnumerable);l.exports=function(b){b=p.RequireObjectCoercible(b);var g=[],h;for(h in b)r(b,h)&&C(b,h)&&g.push(b[h]);return g}},{"es-abstract/es7":93,"function-bind":104,
has:105}],89:[function(b,l,h){arguments[4][38][0].apply(h,arguments)},{"./implementation":88,"./polyfill":112,"./shim":113,"define-properties":90,dup:38}],90:[function(b,l,h){arguments[4][15][0].apply(h,arguments)},{dup:15,foreach:102,"object-keys":110}],91:[function(b,l,h){arguments[4][16][0].apply(h,arguments)},{"./helpers/isFinite":95,"./helpers/mod":97,"./helpers/sign":98,dup:16,"es-to-primitive/es5":99,"is-callable":106}],92:[function(b,l,h){arguments[4][17][0].apply(h,arguments)},{"./es5":91,
"./helpers/assign":94,"./helpers/isFinite":95,"./helpers/isPrimitive":96,"./helpers/mod":97,"./helpers/sign":98,dup:17,"es-to-primitive/es6":100,"function-bind":104,"is-regex":108}],93:[function(b,l,h){arguments[4][42][0].apply(h,arguments)},{"./es6":92,"./helpers/assign":94,dup:42}],94:[function(b,l,h){arguments[4][18][0].apply(h,arguments)},{dup:18}],95:[function(b,l,h){arguments[4][19][0].apply(h,arguments)},{dup:19}],96:[function(b,l,h){arguments[4][20][0].apply(h,arguments)},{dup:20}],97:[function(b,
l,h){arguments[4][21][0].apply(h,arguments)},{dup:21}],98:[function(b,l,h){arguments[4][22][0].apply(h,arguments)},{dup:22}],99:[function(b,l,h){arguments[4][23][0].apply(h,arguments)},{"./helpers/isPrimitive":101,dup:23,"is-callable":106}],100:[function(b,l,h){arguments[4][24][0].apply(h,arguments)},{"./helpers/isPrimitive":101,dup:24,"is-callable":106,"is-date-object":107,"is-symbol":109}],101:[function(b,l,h){arguments[4][20][0].apply(h,arguments)},{dup:20}],102:[function(b,l,h){arguments[4][26][0].apply(h,
arguments)},{dup:26}],103:[function(b,l,h){arguments[4][27][0].apply(h,arguments)},{dup:27}],104:[function(b,l,h){arguments[4][28][0].apply(h,arguments)},{"./implementation":103,dup:28}],105:[function(b,l,h){arguments[4][54][0].apply(h,arguments)},{dup:54,"function-bind":104}],106:[function(b,l,h){arguments[4][29][0].apply(h,arguments)},{dup:29}],107:[function(b,l,h){arguments[4][30][0].apply(h,arguments)},{dup:30}],108:[function(b,l,h){arguments[4][31][0].apply(h,arguments)},{dup:31}],109:[function(b,
l,h){arguments[4][32][0].apply(h,arguments)},{dup:32}],110:[function(b,l,h){arguments[4][33][0].apply(h,arguments)},{"./isArguments":111,dup:33}],111:[function(b,l,h){arguments[4][34][0].apply(h,arguments)},{dup:34}],112:[function(b,l,h){var p=b("./implementation");l.exports=function(){return"function"===typeof Object.values?Object.values:p}},{"./implementation":88}],113:[function(b,l,h){var p=b("./polyfill"),r=b("define-properties");l.exports=function(){var b=p();r(Object,{values:b},{values:function(){return Object.values!==
b}});return b}},{"./polyfill":112,"define-properties":90}],114:[function(b,l,h){var p=b("define-properties"),r=b("es-abstract/es7"),C=function(b){r.RequireObjectCoercible(this);var g=r.ToObject(this);g=r.ToString(g);b=r.ToInteger(b);var h=g.length;if(0>b||b>=h)return"";var l=g.charCodeAt(b),p=b+1,C=1;55296<=l&&56319>=l&&h>p&&(h=g.charCodeAt(p),56320<=h&&57343>=h&&(C=2));return g.slice(b,b+C)};b=b("function-bind").call(Function.call,C);p(b,{method:C,shim:function(){p(String.prototype,{at:C});return String.prototype.at}});
l.exports=b},{"define-properties":115,"es-abstract/es7":118,"function-bind":129}],115:[function(b,l,h){arguments[4][15][0].apply(h,arguments)},{dup:15,foreach:127,"object-keys":134}],116:[function(b,l,h){arguments[4][16][0].apply(h,arguments)},{"./helpers/isFinite":120,"./helpers/mod":122,"./helpers/sign":123,dup:16,"es-to-primitive/es5":124,"is-callable":130}],117:[function(b,l,h){arguments[4][17][0].apply(h,arguments)},{"./es5":116,"./helpers/assign":119,"./helpers/isFinite":120,"./helpers/isPrimitive":121,
"./helpers/mod":122,"./helpers/sign":123,dup:17,"es-to-primitive/es6":125,"function-bind":129,"is-regex":132}],118:[function(b,l,h){arguments[4][42][0].apply(h,arguments)},{"./es6":117,"./helpers/assign":119,dup:42}],119:[function(b,l,h){arguments[4][18][0].apply(h,arguments)},{dup:18}],120:[function(b,l,h){arguments[4][19][0].apply(h,arguments)},{dup:19}],121:[function(b,l,h){arguments[4][20][0].apply(h,arguments)},{dup:20}],122:[function(b,l,h){arguments[4][21][0].apply(h,arguments)},{dup:21}],
123:[function(b,l,h){arguments[4][22][0].apply(h,arguments)},{dup:22}],124:[function(b,l,h){arguments[4][23][0].apply(h,arguments)},{"./helpers/isPrimitive":126,dup:23,"is-callable":130}],125:[function(b,l,h){arguments[4][24][0].apply(h,arguments)},{"./helpers/isPrimitive":126,dup:24,"is-callable":130,"is-date-object":131,"is-symbol":133}],126:[function(b,l,h){arguments[4][20][0].apply(h,arguments)},{dup:20}],127:[function(b,l,h){arguments[4][26][0].apply(h,arguments)},{dup:26}],128:[function(b,l,
h){arguments[4][27][0].apply(h,arguments)},{dup:27}],129:[function(b,l,h){arguments[4][28][0].apply(h,arguments)},{"./implementation":128,dup:28}],130:[function(b,l,h){arguments[4][29][0].apply(h,arguments)},{dup:29}],131:[function(b,l,h){arguments[4][30][0].apply(h,arguments)},{dup:30}],132:[function(b,l,h){arguments[4][31][0].apply(h,arguments)},{dup:31}],133:[function(b,l,h){arguments[4][32][0].apply(h,arguments)},{dup:32}],134:[function(b,l,h){arguments[4][33][0].apply(h,arguments)},{"./isArguments":135,
dup:33}],135:[function(b,l,h){arguments[4][34][0].apply(h,arguments)},{dup:34}],136:[function(b,l,h){h=b("function-bind");var p=b("es-abstract/es7"),r=h.call(Function.call,String.prototype.slice);l.exports=function(b){var h=p.RequireObjectCoercible(this);h=p.ToString(h);var g=p.ToLength(h.length),l;1<arguments.length&&(l=arguments[1]);l="undefined"===typeof l?"":p.ToString(l);""===l&&(l=" ");var F=p.ToLength(b);if(F<=g)return h;for(g=F-g;l.length<g;){F=l.length;var C=g-F;l+=F>C?r(l,0,C):l}l=l.length>
g?r(l,0,g):l;return h+l}},{"es-abstract/es7":141,"function-bind":152}],137:[function(b,l,h){var p=b("function-bind");h=b("define-properties");var r=b("es-abstract/es7"),C=b("./implementation"),I=b("./polyfill");b=b("./shim");var g=p.call(Function.apply,C);p=function(b,h){r.RequireObjectCoercible(b);var l=[h];2<arguments.length&&l.push(arguments[2]);return g(b,l)};h(p,{getPolyfill:I,implementation:C,shim:b});l.exports=p},{"./implementation":136,"./polyfill":159,"./shim":160,"define-properties":138,
"es-abstract/es7":141,"function-bind":152}],138:[function(b,l,h){arguments[4][15][0].apply(h,arguments)},{dup:15,foreach:150,"object-keys":157}],139:[function(b,l,h){arguments[4][16][0].apply(h,arguments)},{"./helpers/isFinite":143,"./helpers/mod":145,"./helpers/sign":146,dup:16,"es-to-primitive/es5":147,"is-callable":153}],140:[function(b,l,h){arguments[4][17][0].apply(h,arguments)},{"./es5":139,"./helpers/assign":142,"./helpers/isFinite":143,"./helpers/isPrimitive":144,"./helpers/mod":145,"./helpers/sign":146,
dup:17,"es-to-primitive/es6":148,"function-bind":152,"is-regex":155}],141:[function(b,l,h){arguments[4][42][0].apply(h,arguments)},{"./es6":140,"./helpers/assign":142,dup:42}],142:[function(b,l,h){arguments[4][18][0].apply(h,arguments)},{dup:18}],143:[function(b,l,h){arguments[4][19][0].apply(h,arguments)},{dup:19}],144:[function(b,l,h){arguments[4][20][0].apply(h,arguments)},{dup:20}],145:[function(b,l,h){arguments[4][21][0].apply(h,arguments)},{dup:21}],146:[function(b,l,h){arguments[4][22][0].apply(h,
arguments)},{dup:22}],147:[function(b,l,h){arguments[4][23][0].apply(h,arguments)},{"./helpers/isPrimitive":149,dup:23,"is-callable":153}],148:[function(b,l,h){arguments[4][24][0].apply(h,arguments)},{"./helpers/isPrimitive":149,dup:24,"is-callable":153,"is-date-object":154,"is-symbol":156}],149:[function(b,l,h){arguments[4][20][0].apply(h,arguments)},{dup:20}],150:[function(b,l,h){arguments[4][26][0].apply(h,arguments)},{dup:26}],151:[function(b,l,h){arguments[4][27][0].apply(h,arguments)},{dup:27}],
152:[function(b,l,h){arguments[4][28][0].apply(h,arguments)},{"./implementation":151,dup:28}],153:[function(b,l,h){arguments[4][29][0].apply(h,arguments)},{dup:29}],154:[function(b,l,h){arguments[4][30][0].apply(h,arguments)},{dup:30}],155:[function(b,l,h){arguments[4][31][0].apply(h,arguments)},{dup:31}],156:[function(b,l,h){arguments[4][32][0].apply(h,arguments)},{dup:32}],157:[function(b,l,h){arguments[4][33][0].apply(h,arguments)},{"./isArguments":158,dup:33}],158:[function(b,l,h){arguments[4][34][0].apply(h,
arguments)},{dup:34}],159:[function(b,l,h){var p=b("./implementation");l.exports=function(){return"function"===typeof String.prototype.padEnd?String.prototype.padEnd:p}},{"./implementation":136}],160:[function(b,l,h){var p=b("./polyfill"),r=b("define-properties");l.exports=function(){var b=p();r(String.prototype,{padEnd:b},{padEnd:function(){return String.prototype.padEnd!==b}});return b}},{"./polyfill":159,"define-properties":138}],161:[function(b,l,h){h=b("function-bind");var p=b("es-abstract/es7"),
r=h.call(Function.call,String.prototype.slice);l.exports=function(b){var h=p.RequireObjectCoercible(this);h=p.ToString(h);var g=p.ToLength(h.length),l;1<arguments.length&&(l=arguments[1]);l="undefined"===typeof l?"":p.ToString(l);""===l&&(l=" ");var F=p.ToLength(b);if(F<=g)return h;for(g=F-g;l.length<g;){F=l.length;var C=g-F;l+=F>C?r(l,0,C):l}return(l.length>g?r(l,0,g):l)+h}},{"es-abstract/es7":166,"function-bind":177}],162:[function(b,l,h){var p=b("function-bind");h=b("define-properties");var r=
b("es-abstract/es7"),C=b("./implementation"),I=b("./polyfill");b=b("./shim");var g=p.call(Function.apply,C);p=function(b,h){r.RequireObjectCoercible(b);var l=[h];2<arguments.length&&l.push(arguments[2]);return g(b,l)};h(p,{getPolyfill:I,implementation:C,shim:b});l.exports=p},{"./implementation":161,"./polyfill":184,"./shim":185,"define-properties":163,"es-abstract/es7":166,"function-bind":177}],163:[function(b,l,h){arguments[4][15][0].apply(h,arguments)},{dup:15,foreach:175,"object-keys":182}],164:[function(b,
l,h){arguments[4][16][0].apply(h,arguments)},{"./helpers/isFinite":168,"./helpers/mod":170,"./helpers/sign":171,dup:16,"es-to-primitive/es5":172,"is-callable":178}],165:[function(b,l,h){arguments[4][17][0].apply(h,arguments)},{"./es5":164,"./helpers/assign":167,"./helpers/isFinite":168,"./helpers/isPrimitive":169,"./helpers/mod":170,"./helpers/sign":171,dup:17,"es-to-primitive/es6":173,"function-bind":177,"is-regex":180}],166:[function(b,l,h){arguments[4][42][0].apply(h,arguments)},{"./es6":165,"./helpers/assign":167,
dup:42}],167:[function(b,l,h){arguments[4][18][0].apply(h,arguments)},{dup:18}],168:[function(b,l,h){arguments[4][19][0].apply(h,arguments)},{dup:19}],169:[function(b,l,h){arguments[4][20][0].apply(h,arguments)},{dup:20}],170:[function(b,l,h){arguments[4][21][0].apply(h,arguments)},{dup:21}],171:[function(b,l,h){arguments[4][22][0].apply(h,arguments)},{dup:22}],172:[function(b,l,h){arguments[4][23][0].apply(h,arguments)},{"./helpers/isPrimitive":174,dup:23,"is-callable":178}],173:[function(b,l,h){arguments[4][24][0].apply(h,
arguments)},{"./helpers/isPrimitive":174,dup:24,"is-callable":178,"is-date-object":179,"is-symbol":181}],174:[function(b,l,h){arguments[4][20][0].apply(h,arguments)},{dup:20}],175:[function(b,l,h){arguments[4][26][0].apply(h,arguments)},{dup:26}],176:[function(b,l,h){arguments[4][27][0].apply(h,arguments)},{dup:27}],177:[function(b,l,h){arguments[4][28][0].apply(h,arguments)},{"./implementation":176,dup:28}],178:[function(b,l,h){arguments[4][29][0].apply(h,arguments)},{dup:29}],179:[function(b,l,
h){arguments[4][30][0].apply(h,arguments)},{dup:30}],180:[function(b,l,h){arguments[4][31][0].apply(h,arguments)},{dup:31}],181:[function(b,l,h){arguments[4][32][0].apply(h,arguments)},{dup:32}],182:[function(b,l,h){arguments[4][33][0].apply(h,arguments)},{"./isArguments":183,dup:33}],183:[function(b,l,h){arguments[4][34][0].apply(h,arguments)},{dup:34}],184:[function(b,l,h){var p=b("./implementation");l.exports=function(){return"function"===typeof String.prototype.padStart?String.prototype.padStart:
p}},{"./implementation":161}],185:[function(b,l,h){var p=b("./polyfill"),r=b("define-properties");l.exports=function(){var b=p();r(String.prototype,{padStart:b},{padStart:function(){return String.prototype.padStart!==b}});return b}},{"./polyfill":184,"define-properties":163}],186:[function(b,l,h){var p=b("function-bind").call(Function.call,String.prototype.replace),r=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]*/;
l.exports=function(){return p(this,r,"")}},{"function-bind":191}],187:[function(b,l,h){var p=b("function-bind");h=b("define-properties");var r=b("./implementation"),C=b("./polyfill");b=b("./shim");p=p.call(Function.call,C());h(p,{getPolyfill:C,implementation:r,shim:b});l.exports=p},{"./implementation":186,"./polyfill":194,"./shim":195,"define-properties":188,"function-bind":191}],188:[function(b,l,h){arguments[4][15][0].apply(h,arguments)},{dup:15,foreach:189,"object-keys":192}],189:[function(b,l,
h){arguments[4][26][0].apply(h,arguments)},{dup:26}],190:[function(b,l,h){arguments[4][27][0].apply(h,arguments)},{dup:27}],191:[function(b,l,h){arguments[4][28][0].apply(h,arguments)},{"./implementation":190,dup:28}],192:[function(b,l,h){arguments[4][33][0].apply(h,arguments)},{"./isArguments":193,dup:33}],193:[function(b,l,h){arguments[4][34][0].apply(h,arguments)},{dup:34}],194:[function(b,l,h){var p=b("./implementation");l.exports=function(){return String.prototype.trimLeft&&"\u200b"==="\u200b".trimLeft()?
String.prototype.trimLeft:p}},{"./implementation":186}],195:[function(b,l,h){var p=b("define-properties"),r=b("./polyfill");l.exports=function(){var b=r();p(String.prototype,{trimLeft:b},{trimLeft:function(){return String.prototype.trimLeft!==b}});return b}},{"./polyfill":194,"define-properties":188}],196:[function(b,l,h){var p=b("function-bind").call(Function.call,String.prototype.replace),r=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]*$/;
l.exports=function(){return p(this,r,"")}},{"function-bind":201}],197:[function(b,l,h){arguments[4][187][0].apply(h,arguments)},{"./implementation":196,"./polyfill":204,"./shim":205,"define-properties":198,dup:187,"function-bind":201}],198:[function(b,l,h){arguments[4][15][0].apply(h,arguments)},{dup:15,foreach:199,"object-keys":202}],199:[function(b,l,h){arguments[4][26][0].apply(h,arguments)},{dup:26}],200:[function(b,l,h){arguments[4][27][0].apply(h,arguments)},{dup:27}],201:[function(b,l,h){arguments[4][28][0].apply(h,
arguments)},{"./implementation":200,dup:28}],202:[function(b,l,h){arguments[4][33][0].apply(h,arguments)},{"./isArguments":203,dup:33}],203:[function(b,l,h){arguments[4][34][0].apply(h,arguments)},{dup:34}],204:[function(b,l,h){var p=b("./implementation");l.exports=function(){return String.prototype.trimRight&&"\u200b"==="\u200b".trimRight()?String.prototype.trimRight:p}},{"./implementation":196}],205:[function(b,l,h){var p=b("define-properties"),r=b("./polyfill");l.exports=function(){var b=r();p(String.prototype,
{trimRight:b},{trimRight:function(){return String.prototype.trimRight!==b}});return b}},{"./polyfill":204,"define-properties":198}],206:[function(b,l,h){l.exports=b("./es7-shim").shim()},{"./es7-shim":12}]},{},[206]);
var CindyJS=function(){function b(b){if(0===h)return console.error("Waiting for "+b+" after we finished waiting."),function(){};0>h&&(h=0);++h;return function(){--h;0>h&&console.error("Wait count mismatch: "+b);if(0===h)for(var g=0,l=p.length;g<l;)p[g++].startup()}}function l(b){var g=l.newInstance(b);0>=h?g.startup():!1!==b.autostart&&p.push(g);return g}var h=-1,p=[];Math.sign||(Math.sign=function(b){return(0<b)-(0>b)||+b});"undefined"===typeof document||"undefined"===typeof window||"undefined"===
typeof document.addEventListener||"undefined"!==typeof window.cindyDontWait&&!0===window.cindyDontWait||document.addEventListener("DOMContentLoaded",b("DOMContentLoaded"));var r=null,C=null,I={};l.getBaseDir=function(){if(null!==r)return r;for(var b=document.getElementsByTagName("script"),g=0;g<b.length;++g){var h=b[g],l=h.src;if(l){var p=/Cindy\.js$/.exec(l);if(p)return r=l.substr(0,p.index),console.log("Will load extensions from "+r),C=h,r}}console.error("Could not find <script> tag for Cindy.js");
return r=C=!1};l.addNewScript=function(b,g){g||console.error.bind(console);var h=l.getBaseDir();if(!1===h)return!1;g=document.createElement("script");g.src=h+b;b=C.nextSibling;h=C.parentElement;b?h.insertBefore(g,b):h.appendChild(g);return g};l.loadScript=function(b,g,h,p){for(var r=String(b).split("."),F=window;r.length&&"object"===typeof F&&null!==F;)F=F[r.shift()];if(F&&!r.length)return h(),!0;p||(p=console.error.bind(console));r=I[b];if(!r){r=l.addNewScript(g,p);if(!1===r)return p("Can't load additional components."),
!1;I[b]=r}r.addEventListener("load",h);r.addEventListener("error",p);return null};l._autoLoadingPlugin={};l.autoLoadPlugin=function(b,g,h){if(l._pluginRegistry[b])return h(),!0;var p=l._autoLoadingPlugin[b];if(!p){g||(g=b+"-plugin.js");p=l._autoLoadingPlugin[b]=[];b=l.addNewScript(g);if(!1===b)return!1;b.addEventListener("error",console.error.bind(console))}p.push(h);return null};var g={ctype:"undefined"};l.waitFor=b;l._pluginRegistry={};l.instances=[];l.registerPlugin=function(b,g,h){if(1!==b)return console.error("Plugin API version "+
b+" not supported"),!1;l._pluginRegistry[g]=h;(l._autoLoadingPlugin[g]||[]).forEach(function(b){b()})};var J=0;l.dumpState=function(b){b=l.instances[b||0].saveState();console.log(JSON.stringify(b))};l.debugState=function(b){l.instances.map(function(b){var g=b.config;g=JSON.parse(JSON.stringify(g));var h=b.saveState();console.log(JSON.stringify(h));for(var l in h)g[l]=h[l];b.shutdown();return g}).forEach(function(b){l(b)})};l.newInstance=function(b){function h(){pa.width=ia=pa.clientWidth;pa.height=
la=pa.clientHeight;sa=1;if(Sc||Tc)sa=Math.max(Sc?Sc/pa.width:0,Tc?Tc/pa.height:0),ia=sa*pa.clientWidth,la=sa*pa.clientHeight;z.setTransform(1/sa,0,0,1/sa,0,0);A.setMat(25,0,0,25,250.5,250.5);if(cc)for(var a=0;a<cc.length;a++){var d=cc[a],c=Object.keys(d)[0];"scale"===c&&(Rc=d.scale,A[c](d.scale));if("translate"===c)A[c](d.translate[0],d.translate[1]);"scaleAndOrigin"===c&&(Rc=d[c][0]/25,A[c].apply(null,d[c]));"visibleRect"===c&&(A[c].apply(null,d[c]),Rc=A.drawingstate.initialmatrix.a/25)}A.createnewbackup();
A.greset();a=1;"undefined"!==typeof window&&window.devicePixelRatio&&(a=window.devicePixelRatio);d=z.webkitBackingStorePixelRatio||z.mozBackingStorePixelRatio||z.msBackingStorePixelRatio||z.oBackingStorePixelRatio||z.backingStorePixelRatio||1;a!==d&&(a/=d,pa.width=ia*a,pa.height=la*a,z.scale(a,a))}function l(a){if("canvas"!==a.tagName.toLowerCase()){var d=a;for(pa=document.createElement("canvas");d.firstChild;)d.removeChild(d.firstChild)}else{pa=a;d=document.createElement("div");var c=null,b=null;
Array.prototype.slice.call(pa.attributes).forEach(function(a){"width"===a.name?c=a.value:"height"===a.name?b=a.value:d.setAttributeNodeNS(pa.removeAttributeNode(a))});null===c||d.style.width||(d.style.width=c+"px");null===b||d.style.height||(d.style.height=b+"px");pa.parentNode.replaceChild(d,pa)}d.classList.add("CindyJS-widget");a=pa.style;a.position="absolute";a.border="none";a.margin=a.padding=a.left=a.top="0px";a.width=a.height="100%";a="static";window.getComputedStyle&&(a=window.getComputedStyle(d).getPropertyValue("position"),
a=String(a||"static"));"static"===a&&(d.style.position="relative");d.appendChild(pa);return pa}function p(){var a=b.cinderella;if(!a||!a.version)return!1;for(var d=0;d<arguments.length;++d){var c=a.version[d],H=arguments[d];if(c!==H)return typeof c===typeof H&&c<H}return!1}function r(){wd=!0;if(0===Ac){if(b.exclusive)for(f=Da.instances.length;0<f;)Da.instances[--f].shutdown();void 0!==b.csconsole&&(Na=b.csconsole);Na=null===Na?new La:!0===Na?new ub:"string"===typeof Na?new Ta(Na):"object"===typeof Na&&
"function"===typeof Na.appendChild?new Ta(Na):new La;Ja=[100,100];var a=null;cc=b.transform;if(b.ports&&0<b.ports.length){f=b.ports[0];(a=f.element)||(a=document.getElementById(f.id));a=l(a);var d=a.parentNode.style;"window"===f.fill?(d.width="100vw",d.height="100vh"):"parent"===f.fill?(d.width="100%",d.height="100%"):f.width&&f.height&&(d.width=f.width+"px",d.height=f.height+"px");f.virtualwidth&&(Sc=f.virtualwidth);f.virtualheight&&(Tc=f.virtualheight);f.background&&(a.style.backgroundColor=f.background);
void 0!==f.transform&&(cc=f.transform);Wa(f.grid)&&0<f.grid&&(Sa=f.grid);Wa(f.tgrid)&&0<f.tgrid&&(vd=f.tgrid);f.snap&&(wc=!0);f.snapdistance&&Number.isFinite(f.snapdistance)&&(Nb=Math.max(f.snapdistance,0));f.axes&&(xc=!0)}a||(a=b.canvas,a||"undefined"===typeof document||(a=document.getElementById(b.canvasname))&&(a=l(a)));a&&(pa=a,z=a.getContext("2d"),h(),z.setLineDash||(z.setLineDash=function(){}),(b.animation?b.animation.controls:b.animcontrols)&&F(b),b.animation&&Wa(b.animation.speed)&&(void 0===
b.animation.accuracy&&p(2,9,1875)?I(.5*b.animation.speed):I(b.animation.speed)),b.animation&&Wa(b.animation.accuracy)&&(tc=b.animation.accuracy));b.statusbar&&(gd="string"===typeof b.statusbar?document.getElementById(b.statusbar):b.statusbar);var c=b.scripts,H=null;"string"===typeof c&&c.search(/\*/)&&(H=c);"object"!==typeof c&&(c=null);"move keydown keyup keytyped keytype mousedown mouseup mousedrag mousemove mouseclick multidown multiup multidrag init tick draw simulationstep simulationstart simulationstop ondrop".split(" ").forEach(function(a){if(null!==
c&&c[a])var d=c[a];else{d=a+"script";if(b[d])d=document.getElementById(b[d]);else if(H){if(d=document.getElementById(H.replace(/\*/,a)),!d)return}else return;d=d.text}d=fb(d,!1);"error"===d.ctype?console.error("Error compiling "+a+" script: "+d.message):S[a]=he(d,a)});p(2,9,1888)&&!S.keydown&&(S.keydown=S.keytyped,S.keytyped=S.keytype,S.keytype=void 0);Wa(b.grid)&&0<b.grid&&(Sa=b.grid);b.snap&&(wc=!0);b.snapdistance&&Number.isFinite(b.snapdistance)&&(Nb=Math.max(b.snapdistance,0));u={};var f=0;bb=
{};b.geometry||(b.geometry=[]);le(b.geometry);b.behavior||(b.behavior=[]);"function"===typeof Lb&&Lb(b.behavior);for(var e in b.images)f=C(b.images[e],!1),f!==g&&(bb[e]=f);for(var k in b.videos)e=C(b.videos[k],!0),e!==g&&(bb[k]=e);Ha.canvas=a;if(b.oninit)b.oninit(Ha);Da.instances.push(Ha);b.use&&b.use.forEach(function(a){t.use$1([v.wrap(a)],{})});Mb.convexhull3d$1&&ba("QuickHull3D","QuickHull3D.js");(Mb.colorplot$1||Mb.colorplot$2||Mb.colorplot$3||Mb.colorplot$4)&&ba("CindyGL","CindyGL.js");(Mb.playtone$1||
Mb.playmelody$1)&&ba("midi","midi-plugin.js");na()}}function C(a,d){if("string"===typeof a){if(d){var c=document.createElement("video");c.preload="auto";c.loop=!0;c.setAttribute("playsinline","");enableInlineVideo(c)}else c=new Image;c.src=a}else c=a;if(!c.tagName)return console.error("Not a valid image element",c),g;var b={img:c,width:NaN,height:NaN,ready:!0,live:!1,generation:0,whenReady:k};a=c.tagName.toLowerCase();var f=[];if("img"===a)c.complete?(b.width=c.width,b.height=c.height):(b.ready=!1,
c.addEventListener("load",function(){b.width=c.width;b.height=c.height;b.ready=!0;b.whenReady=k;f.forEach(k);q()}),b.whenReady=f.push.bind(f));else if("video"===a)b.live=!0,c.readyState>=c.HAVE_METADATA?(b.width=c.videoWidth,b.height=c.videoHeight):(b.ready=!1,c.addEventListener("loadedmetadata",function(){b.width=c.videoWidth;b.height=c.videoHeight;b.ready=!0;b.whenReady=k;f.forEach(k);q()}),b.whenReady=f.push.bind(f));else if("canvas"===a)b.width=c.width,b.height=c.height;else return console.error("Not a valid image element",
a,c),g;return{ctype:"image",value:b}}function F(a){function d(a,d){var c=document.createElement("button"),b=document.createElement("img");c.appendChild(b);m.appendChild(c);dc(b,a);c.addEventListener("click",d);rb[a]=function(a){a?c.classList.add("CindyJS-active"):c.classList.remove("CindyJS-active")}}function c(a){if(l){var d=h.getBoundingClientRect();I(e*(a.clientX-d.left-h.clientLeft+.5)/d.width+f)}}var b=document.createElement("div");b.className="CindyJS-animcontrols";pa.parentNode.appendChild(b);
var f=0,g=1,e=1;a.animation&&a.animation.speedRange&&Wa(a.animation.speedRange[0])&&Wa(a.animation.speedRange[1])&&(f=a.animation.speedRange[0],g=a.animation.speedRange[1],e=g-f);var h=document.createElement("div");h.className="CindyJS-animspeed";b.appendChild(h);var k=document.createElement("div");h.appendChild(k);X(h,"mousedown",function(a){l=!0;c(a)});X(h,"mousemove",c);X(pa.parentNode,"mouseup",function(a){l=!1},!0);var m=document.createElement("div");m.className="CindyJS-animbuttons";b.appendChild(m);
d("play",G);d("pause",Pa);d("stop",tb);rb.stop(!0);yc=function(a){a=(a-f)/e;a=Math.max(0,Math.min(1,a));a=.1*Math.round(1E3*a);k.style.width=a+"%"};var l=!1}function I(a){ae=a;yc&&yc(a)}function k(a){return a()}function ba(a,d,c){var B=null;b.plugins&&(B=b.plugins[a]);B||(B=Da._pluginRegistry[a]);B?t.use$1([v.wrap(a)],{}):(++ce,Da.autoLoadPlugin(a,d,function(){t.use$1([v.wrap(a)],{});na(c)}))}function na(a){0===--ce&&(a?q():(x(S.init),(b.animation||b).autoplay&&G(),Ha.canvas&&Ab(Ha.canvas,b)))}function qa(){null!==
ec&&(Ea.set(ec.state),Object.keys(ec.speeds).forEach(function(a){var d=u.csnames[a];"undefined"!==typeof d.behavior&&(a=ec.speeds[a],d.behavior.vx=a[0],d.behavior.vy=a[1],d.behavior.vz=a[2],d.behavior.fx=0,d.behavior.fy=0,d.behavior.fz=0)}),Vd())}function G(){if(!wa){if(rc){var a=Ob.backup;a.set(Ea);for(var d={},c=0;c<u.points.length;c++){var b=u.points[c];"undefined"!==typeof b.behavior&&(d[b.name]=[b.behavior.vx,b.behavior.vy,b.behavior.vz])}ec={state:a,speeds:d};sc=0;rc=!1;rb.stop(!1)}else rb.pause(!1);
qd=Date.now();rb.play(!0);"function"===typeof Lb&&ze&&pd();wa=!0;x(S.simulationstart);q()}}function Pa(){wa&&(rb.play(!1),rb.pause(!0),wa=!1)}function tb(){rc||(wa?(x(S.simulationstop),wa=!1,rb.play(!1)):rb.pause(!1),rb.stop(!0),rc=!0,qa())}function U(){if(!zc){zc=!0;for(var a=Da.instances.length;0<a;)if(Da.instances[--a]===Ha){Da.instances.splice(a,1);break}for(a=xb.length;0<a;)try{xb[--a]()}catch(d){console.error(d)}}}function vb(a){this.in=function(a,c){console.log(a);c?this.append(this.createTextNode("span",
"blue",a)):this.append(this.createTextNode("p","blue",a))};this.out=function(a,c){console.log(a);c?this.append(this.createTextNode("span","red",a)):this.append(this.createTextNode("p","red",a))};this.err=function(a,c){console.log(a);c?this.append(this.createTextNode("span","red",a)):this.append(this.createTextNode("p","red",a))};this.createTextNode=function(a,c,b){return"undefined"!==typeof document?(a=document.createElement(a),a.appendChild(document.createTextNode(b)),a.style.color=c,a):b+"\n"}}
function ub(){var a=this,d=document.createElement("div");d.innerHTML='<div id="console" style="border-top: 1px solid #333333; bottom: 0px; position: absolute; width: 100%;"><div id="log" style="height: 150px; overflow-y: auto;"></div><input id="cmd" type="text" style="box-sizing: border-box; height: 30px; width: 100%;"></div>';document.body.appendChild(d);var c=document.getElementById("cmd");var b=document.getElementById("log");c.onkeydown=function(d){13===d.keyCode&&""!==c.value&&(a.in(c.value),
d=t.parse$1([v.wrap(c.value)],[]),d=x(d),console.log(ca(d)),"undefined"!==d.ctype&&Na.out(ca(d)),c.value="",b.scrollTop=b.scrollHeight)};this.append=function(a){b.appendChild(a)};this.clear=function(){b.innerHTML=""}}function Ta(a){var d=a;"string"===typeof a&&(d=document.getElementById(a));this.append=function(a){d.appendChild(a)};this.clear=function(){d.innerHTML=""}}function La(){this.append=function(a){};this.clear=function(){}}function X(a,d,c,b){void 0===b&&(b=!1);xb.push(function(){a.removeEventListener(d,
c,b)});a.addEventListener(d,c,b)}function Ab(a,d){function c(d,c){for(var b=0;b<d.changedTouches.length;b++){var B=d.changedTouches[b],H=R(B.identifier);if(c||yb[H]){var f=a.getBoundingClientRect();B=A.to(B.clientX-f.left-a.clientLeft+.5,B.clientY-f.top-a.clientTop+.5);yb[H]=[B[0],B[1]]}}q()}function b(d){var c=a.getBoundingClientRect();d=A.to(d.clientX-c.left-a.clientLeft+.5,d.clientY-c.top-a.clientTop+.5);ea.prevx=ea.x;ea.prevy=ea.y;ea.x=d[0];ea.y=d[1];Ja[0]=ea.x;Ja[1]=ea.y;q()}function R(a){if(Vb.hasOwnProperty(a))return Vb[a];
var d=Object.values(Vb);d=d.sort(function(a,d){return a-d});var c=!1,b;for(b in d)!c&&d[b]>(b|0)+1&&(Vb[a]=(b|0)+1,c=!0);c||(Vb[a]=d.length+1);return Vb[a]}function ma(a){var d=a.changedTouches;c(a,!1);for(var b=0;b<a.changedTouches.length;b++)Xa=R(a.changedTouches[b].identifier),Qb(Xa),delete Vb[a.changedTouches[b].identifier];b=!1;for(var B=0;B<d.length;B++)d[B].identifier===n&&(b=!0);b&&(n=-1,ea.down=!1,ua=void 0,x(S.mouseup),Ib("mouseup"),l||x(S.mouseclick),q(),a.preventDefault())}var k=null,
m=null,l=!1;"undefined"!==typeof MutationObserver&&(k=MutationObserver);k||"undefined"===typeof WebKitMutationObserver||(k=WebKitMutationObserver);k?(k=new k(function(d){document.body.contains(a)||U()}),k.observe(document.documentElement,{childList:!0,subtree:!0}),xb.push(function(){k.disconnect()})):(X(a,"DOMNodeRemovedFromDocument",U),X(a,"DOMNodeRemoved",U));if(!0===d.keylistener)X(document,"keydown",function(a){ha(a,S.keydown);return!1}),X(document,"keyup",function(a){ha(a,S.keyup);return!1}),
X(document,"keypress",function(a){ha(a,S.keytyped);return!1});else if(S.keydown||S.keyup||S.keytyped)a.setAttribute("tabindex","0"),X(a,"mousedown",function(){a.focus()}),X(a,"keydown",function(a){9!==a.keyCode&&(ha(a,S.keydown),S.keytyped||a.preventDefault())}),X(a,"keyup",function(a){ha(a,S.keyup);a.preventDefault()}),X(a,"keypress",function(a){9!==a.keyCode&&(ha(a,S.keytyped),a.preventDefault())});X(a,"mousedown",function(a){m=a;l=!1;ea.button=a.which;b(a);hc(0);x(S.mousedown);Ib("mousedown");
ea.down=!0;a.preventDefault()});X(a,"mouseup",function(a){ea.down=!1;ua=void 0;x(S.mouseup);Qb(0);Ib("mouseup");delete yb[0];q();a.preventDefault()});X(a,"mousemove",function(a){b(a);ea.down?(m&&(2<Math.abs(m.clientX-a.clientX)||2<Math.abs(m.clientY-a.clientY))&&(l=!0),x(S.mousedrag),yb[0]&&(Xa=0,x(S.multidrag),Xa=0)):x(S.mousemove);Ib("mousemove");a.preventDefault()});X(a,"click",function(a){b(a);l||x(S.mouseclick);a.preventDefault()});X(a,"dragenter",function(a){a.preventDefault()});X(a,"dragover",
function(a){a.preventDefault()});X(a,"drop",function(d){function c(a,d){function c(){e.readyState===XMLHttpRequest.DONE&&(200!==e.status?(console.error("GET request for "+a+" failed: "+(e.responseText||"(no error message)")),R(d,g)):B(d,e.responseText))}var f=a.replace(/[?#][^]*/,"");f=f.replace(/[^]*\/([^\/])/,"$1");h[d]={type:"",name:f};var e=new XMLHttpRequest;e.onreadystatechange=function(){if(e.readyState===XMLHttpRequest.DONE)if(200!==e.status)console.error("HEAD request for "+a+" failed: "+
(e.responseText||"(no error message)")),R(d,g);else{var B=e.getResponseHeader("Content-Type");h[d].type=B;/^image\//.test(B)?H(d,a):b(B)?(e=new XMLHttpRequest,e.onreadystatechange=c,e.open("GET",a),e.send()):R(d,g)}};e.open("HEAD",a);e.send()}function b(a){a=a.replace(/;[^]*/,"");return/^text\//.test(a)?1:"application/json"===a?2:0}function B(a,d){switch(b(h[a].type)){case 1:R(a,v.string(d));break;case 2:try{var c=JSON.parse(d);var B=v.wrapJSON(c)}catch(Ue){console.error(Ue),B=g}R(a,B);break;default:R(a,
g)}}function H(a,d){var c=new Image,b=!1;c.onload=function(){b||(b=!0,R(a,C(c,!1)))};c.onerror=function(d){b||(b=!0,console.error(d),R(a,g))};c.src=d}function R(a,d,c){ma[a]=f.turnIntoCSList([d,v.string(c||d.ctype),v.string(h[a].type),v.string(h[a].name)]);0===--k&&(a=l,Uc=f.turnIntoCSList(ma),Vc=a,x(S.ondrop),Vc=Uc=g,q())}d.preventDefault();var e=d.dataTransfer,h=e.files,ma=Array(h.length),k=h.length,m=d.currentTarget.getBoundingClientRect(),l=f.realVector(A.to(d.clientX-m.left-a.clientLeft+.5,d.clientY-
m.top-a.clientTop+.5));if(0<h.length)Array.prototype.forEach.call(h,function(a,d){var c=new FileReader;b(a.type)?(c.onload=function(){B(d,c.result)},c.readAsText(a)):/^image\//.test(a.type)?(c.onload=function(){H(d,c.result)},c.readAsDataURL(a)):(console.log("Unknown MIME type: "+a.type),R(d,g))});else if(d=e.getData("text/uri-list"))d=d.split("\n").filter(function(a){return!/^\s*(#|$)/.test(a)}),k=d.length,ma=Array(k),h=Array(k),d.forEach(c)});var n=-1;X(a,"touchstart",function(a){c(a,!0);for(var d=
0;d<a.changedTouches.length;d++)hc(R(a.changedTouches[d].identifier));-1===n&&(d=a.changedTouches,0!==d.length&&(n=d[0].identifier,b(a.targetTouches[0]),x(S.mousedown),ea.down=!0,m=a.targetTouches[0],l=!1,Ib("mousedown"),a.preventDefault()))},!1);X(a,"touchmove",function(a){c(a,!1);for(var d=0;d<a.changedTouches.length;d++)Xa=R(a.changedTouches[d].identifier),x(S.multidrag),Xa=0;d=a.changedTouches;for(var B=!1,H=0;H<d.length;H++)d[H].identifier===n&&(B=!0);B&&(b(a.targetTouches[0]),ea.down?(m&&(2<
Math.abs(m.clientX-a.targetTouches[0].clientX)||2<Math.abs(m.clientY-a.targetTouches[0].clientY))&&(l=!0),Xa=R(n),x(S.mousedrag)):x(S.mousemove),Ib("mousemove"),a.preventDefault())},!0);X(a,"touchend",ma,!1);"undefined"!==typeof document&&document.body&&X(document.body,"touchcancel",ma,!1);"undefined"!==typeof window&&X(window,"resize",function(){cb(function(){h();q()})},!1);e(a.parentNode);q()}function c(a,d){var c=document.createElement("div");c.setAttribute("style",d);a.appendChild(c);return c}
function e(a){function d(){H.scrollLeft=H.scrollTop=f.scrollLeft=f.scrollTop=1E5}function b(){if(g!==a.clientWidth||e!==a.clientHeight)g=a.clientWidth,e=a.clientHeight,k||(k=!0,cb(function(){k=!1;h();q()}));d()}if("undefined"!==typeof document){var H=c(a,"position: absolute; transition: 0s; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;");c(H,"position: absolute; transition: 0s; left: 0; top: 0; width: 100000px; height: 100000px");var f=c(a,"position: absolute; transition: 0s; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;");
c(f,"position: absolute; transition: 0s; left: 0; top: 0; width: 200%; height: 200%");d();var g=a.clientWidth,e=a.clientHeight,k=!1;H.addEventListener("scroll",b);f.addEventListener("scroll",b)}}function q(){Ya||(Ya=cb(Ba))}function Ba(){Ya=null;if(!zc){if(wa){var a=Date.now(),d=Math.min(50,a-qd)*ae*ve;qd=a;a=sc+d;ze&&"undefined"!==typeof Za&&Za.tick(d);sc=a;wa&&x(S.tick)}Ga();wa&&q()}}function Ga(){A.reset();z.save();z.clearRect(0,0,ia,la);var a=A.drawingstate.matrix,d,c;if(0!==Sa){z.beginPath();
z.strokeStyle="rgba(0,0,0,0.1)";z.lineWidth=1;z.lineCap="butt";var b=Sa*a.a;for(d=Math.ceil(-a.tx/b);(c=d*b+a.tx)<ia;){if(d||!xc)z.moveTo(c,0),z.lineTo(c,la);d++}for(d=Math.floor(a.ty/b);(c=d*b-a.ty)<la;){if(d||!xc)z.moveTo(0,c),z.lineTo(ia,c);d++}z.stroke()}if(0!==vd){z.beginPath();z.strokeStyle="rgba(0,0,0,0.1)";z.lineWidth=1;z.lineCap="butt";b=vd*a.a;var g=Math.sqrt(3);var e=a.ty/g;var h=(la+a.ty)/g;for(d=Math.ceil(-(a.tx+h)/b);(c=d*b+a.tx)+e<ia;)z.moveTo(c+e,0),z.lineTo(c+h,la),d++;for(d=Math.ceil(-(a.tx-
e)/b);(c=d*b+a.tx)-h<ia;)z.moveTo(c-e,0),z.lineTo(c-h,la),d++;b*=.5*g;for(d=Math.floor(a.ty/b);(c=d*b-a.ty)<la;){if(d||!xc)z.moveTo(0,c),z.lineTo(ia,c);d++}z.stroke()}xc&&(z.beginPath(),z.strokeStyle="rgba(0,0,0,0.2)",z.lineWidth=3,z.lineCap="butt",z.lineJoin="miter",z.miterLimit=10,z.beginPath(),z.moveTo(0,-a.ty),z.lineTo(ia-6,-a.ty),z.moveTo(ia-13,-5-a.ty),z.lineTo(ia-3,-a.ty),z.lineTo(ia-13,5-a.ty),z.moveTo(a.tx,la),z.lineTo(a.tx,6),z.moveTo(a.tx-5,13),z.lineTo(a.tx,3),z.lineTo(a.tx+5,13),z.stroke());
Td();A.greset();Rd();for(a=0;a<u.polygons.length;a++)b=u.polygons[a],b.isshowing&&!1!==b.visible&&(e={color:b.color,alpha:b.alpha,fillcolor:b.fillcolor,fillalpha:b.fillalpha,size:b.size,lineJoin:v.string("miter"),fillrule:v.string(b.fillrule)},E.drawpolygon([b.vertices],e,"D",!0));for(a=0;a<u.conics.length;a++)u.conics[a].isArc?(b=u.conics[a],b.isshowing&&!1!==b.visible&&(e={},e.color=b.color,e.alpha=b.alpha,e.size=b.size,E.drawarc(b,e,b.filled?"F":"D"))):(b=u.conics[a],b.isshowing&&!1!==b.visible&&
(e={},e.color=b.color,e.alpha=b.alpha,e.size=b.size,E.drawconic(b.matrix,e)));for(a=0;a<u.lines.length;a++)a:if(b=u.lines[a],b.isshowing&&!1!==b.visible&&f._helper.isAlmostReal(b.homog))if("S"===b.kind)e={overhang:b.overhang,dashtype:b.dashtype,size:b.size,color:b.color,alpha:b.alpha,arrow:b.arrow,arrowsize:b.arrowsize,arrowposition:b.arrowposition,arrowshape:b.arrowshape,arrowsides:b.arrowsides},0<=m.mult(b.startpos.value[2],m.conjugate(b.endpos.value[2])).value.real?(t.draw$2([b.startpos,b.endpos],
e),b.labeled&&!b.tmp&&(e=b.printname||b.name||"S",h=f.scalmult(m.real(Math.sign(b.startpos.value[2].value.real)*Math.sign(b.endpos.value[2].value.real)),f.cross(b.startpos,b.endpos)),h={x:h.value[0].value.real,y:h.value[1].value.real},d=Math.sqrt(h.x*h.x+h.y*h.y),h={x:8*h.x/d-3,y:8*h.y/d-3},h=b.labelpos||h,d=w.makeColor(va.textColor),c=n._helper.midpoint(n._helper.midpoint(b.startpos,b.endpos),b.endpos),Qd(b,e,c,h,d))):(w.handleModifs(e,w.lineModifs),w.drawRaySegment(b.startpos,b.endpos));else if("end"===
b.clip.value&&"Join"===b.type)d=u.csnames[b.args[0]],e=u.csnames[b.args[1]],t.draw$2([d.homog,e.homog],{overhang:b.overhang,dashtype:b.dashtype,size:b.size,color:b.color,alpha:b.alpha});else{if("inci"===b.clip.value){d=[1E6,0];e=[-1E6,0];c=[1E6,0];h=[-1E6,0];for(g=0;g<b.incidences.length;g++){var k=u.csnames[b.incidences[g]].homog,l=k.value[0],Ia=k.value[1],p=k.value[2];m._helper.isAlmostZero(p)||(l=m.div(l,p),Ia=m.div(Ia,p),m._helper.isAlmostReal(l)&&m._helper.isAlmostReal(Ia)&&(l.value.real<d[0]&&
(d=[l.value.real,k]),l.value.real>e[0]&&(e=[l.value.real,k]),Ia.value.real<c[0]&&(c=[Ia.value.real,k]),Ia.value.real>h[0]&&(h=[Ia.value.real,k])))}e[0]-d[0]>h[0]-c[0]?(d=d[1],e=e[1]):(d=c[1],e=h[1]);if(d!==e){t.draw$2([d,e],{dashtype:b.dashtype,size:b.size,color:b.color,alpha:b.alpha,overhang:b.overhang});break a}}t.draw$1([b.homog],{dashtype:b.dashtype,size:b.size,color:b.color,alpha:b.alpha})}for(a=0;a<u.points.length;a++)if(b=u.points[a],b.isshowing&&!1!==b.visible&&f._helper.isAlmostReal(b.homog)&&
(e=b.color,b.behavior&&(e=b.color),t.draw$1([b.homog],{size:b.size,color:e,alpha:b.alpha,noborder:b.noborder,border:b.border}),b.labeled&&!b.tmp)){h=b.printname||b.name||"P";d=b.labelpos||{x:3,y:3};c=w.makeColor(va.textColor);if(!0===b.noborder.value||!1===b.border.value)c=e;Qd(b,h,b.homog,d,c)}for(a=0;a<u.texts.length;a++)Mc(u.texts[a]);if(u.ifs.length){if(fa.dirty||!v.deeplyEqual(fa.mat,A.drawingstate.matrix))n.IFS.updateParameters(),fa.dirty=!1;fa.img&&z.drawImage(fa.img,0,0,ia,la)}z.restore()}
function ha(a,d){a=window.event?event:a;a=a.charCode?a.charCode:a.keyCode;xd=String.fromCharCode(a);Wc=a;x(d);q()}function hc(a){Xa=a;0===a&&(yb[0]=Ja);x(S.multidown);Xa=0}function Qb(a){Xa=a;x(S.multiup);delete yb[a];Xa=0}function Ca(a){var d=a.value;a=d[0].value;var b=d[1].value;d=d[2].value;return f.turnIntoCSList([a[0],m.add(a[1],b[0]),m.add(a[2],d[0]),b[1],m.add(b[2],d[1]),d[2]])}function $c(a){var d=!0;return function(b,c){d&&(console.error("Operator "+a+" is not supported yet."),d=!1);return g}}
function ca(a){if("undefined"===typeof a)return"_??_";if(null===a)return"_???_";if("undefined"===a.ctype)return"___";if("number"===a.ctype)return m.niceprint(a);if("string"===a.ctype||"boolean"===a.ctype)return a.value;if("list"===a.ctype){for(var d="[",b=0;b<a.value.length;b++)d+=ca(x(a.value[b])),b!==a.value.length-1&&(d+=", ");return d+"]"}return"dict"===a.ctype?ib.niceprint(a):"function"===a.ctype?"FUNCTION":"infix"===a.ctype?"INFIX":"modifier"===a.ctype?a.key+"->"+ca(a.value):"shape"===a.ctype?
a.type:"error"===a.ctype?"Error: "+a.message:"variable"===a.ctype?ca(M.getvar(a.name)):"geo"===a.ctype?a.value.name:"image"===a.ctype?"IMAGE":"_?_"}function zb(a,d){d="undefined"===a[0].ctype;var b="undefined"===a[1].ctype,c=x(a[1]);if(d||b)return g;"variable"===a[0].ctype?M.setvar(a[0].name,c):"infix"===a[0].ctype?"_"===a[0].oper?E.assigntake(a[0],c):ra("Can't use infix expression as lvalue"):"field"===a[0].ctype?E.assigndot(a[0],c):"userdata"===a[0].ctype?E.assigncolon(a[0],c):"function"===a[0].ctype&&
"genList"===a[0].oper?"list"===c.ctype?E.assignlist(a[0].args,c.value):ra("Expected list in rhs of assignment"):ra("Left hand side of assignment is not a recognized lvalue");return c}function ic(a,d){d=x(a[0]);a=x(a[1]);if(d.ctype===a.ctype){if("number"===d.ctype)return v.bool(d.value.real===a.value.real&&d.value.imag===a.value.imag);if("string"===d.ctype||"boolean"===d.ctype)return v.bool(d.value===a.value);if("list"===d.ctype)return f.equals(d,a);if("geo"===d.ctype)return v.bool(d.value===a.value)}return{ctype:"boolean",
value:!1}}function ka(a,d){return v.not(ic(a,d))}function jc(a,d){d=D(a[0]);a=D(a[1]);return"number"===d.ctype&&"number"===a.ctype?{ctype:"boolean",value:m._helper.isAlmostEqual(d,a)}:"string"===d.ctype&&"string"===a.ctype||"boolean"===d.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:d.value===a.value}:"list"===d.ctype&&"list"===a.ctype?f.almostequals(d,a):{ctype:"boolean",value:!1}}function Qa(a,d){d=D(a[0]);a=D(a[1]);return"boolean"===d.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:d.value&&
a.value}:g}function Cc(a,d){d=D(a[0]);a=D(a[1]);return"boolean"===d.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:d.value||a.value}:g}function Rb(a,d){d=a[0];"void"!==d.ctype&&(d=D(d));a=D(a[1]);var b=v.add(d,a);"Angle"===d.usage&&"Angle"===a.usage&&(b=v.withUsage(b,"Angle"));return b}function Bb(a,d){d=a[0];"void"!==d.ctype&&(d=D(d));a=D(a[1]);var b=v.sub(d,a);"Angle"===d.usage&&"Angle"===a.usage&&(b=v.withUsage(b,"Angle"));return b}function ad(a,d){d=D(a[0]);a=D(a[1]);var b=v.mult(d,a);"Angle"!==
d.usage||a.usage?"Angle"!==a.usage||d.usage||(b=v.withUsage(b,"Angle")):b=v.withUsage(b,"Angle");return b}function Cd(a,d){d=D(a[0]);a=D(a[1]);"number"===a.ctype&&m._helper.isZero(a)&&ra("WARNING: Division by zero!");var b=v.div(d,a);"Angle"!==d.usage||a.usage?"Angle"!==a.usage||d.usage||(b=v.withUsage(b,"Angle")):b=v.withUsage(b,"Angle");return b}function Dc(a,d){d=D(a[0]);a=D(a[1]);return"number"===d.ctype&&"number"===a.ctype?m.pow(d,a):g}function za(a,d){d=P(a[0]);a=P(a[1]);if(d!==g&&a!==g){var b=
f.cross(d,a);"Point"===d.usage&&"Point"===a.usage&&(b=v.withUsage(b,"Line"));"Line"===d.usage&&"Line"===a.usage&&(b=v.withUsage(b,"Point"));return b}return g}function Q(a){var d=a.length;if(0===d)return[];if(1===d)return[0];if(2===d)return a[0][0]+a[1][1]<=a[0][1]+a[1][0]?[0,1]:[1,0];if(4<d)return kc(a);for(var b=fd[d],c=Number.POSITIVE_INFINITY,f=b[0],g=0;g<b.length;++g){for(var e=b[g],h=0,k=0;k<d;++k)h+=a[k][e[k]];h<c&&(c=h,f=e)}return f}function kc(a){function d(){return{matched:-1,prev:-1,start:-1,
cost:0,used:!1,leaf:!1}}function b(a){for(var d=0;d<g;++d)0<l[a][d]||m[d].used||(m[d].used=!0,b(m[d].matched))}function c(a){for(var d=0;d<g;++d)0<l[d][a]||k[d].used||(k[d].used=!0,c(k[d].matched))}var f=Math.abs,g=a.length,e,h,k=Array(g),m=Array(g),l=Array(g);for(e=0;e<g;++e)l[e]=Array(g);for(e=0;e<g;++e)for(k[e]=d(),m[e]=d(),k[e].cost=a[e][0],h=1;h<g;++h)k[e].cost>a[e][h]&&(k[e].cost=a[e][h]);for(;;){for(e=0;e<g;++e)for(h=0;h<g;++h)l[e][h]=a[e][h]-k[e].cost-m[h].cost,l[e][h]<1E-14*(f(a[e][h])+f(k[e].cost)+
f(m[h].cost))&&(l[e][h]=0);for(e=0;e<g;++e)k[e].matched=m[e].matched=-1;for(var n=0;;){for(e=0;e<g;++e)k[e].used=k[e].leaf=m[e].used=m[e].leaf=!1,-1===k[e].matched&&(k[e].start=e,k[e].used=k[e].leaf=!0,k[e].prev=-1);for(var p=!1,q=!1;!q;){for(e=0;e<g;++e)if(k[e].leaf)for(k[e].leaf=!1,h=0;h<g;++h)if(!(m[h].used||0<l[e][h])&&k[e].matched!==h&&(m[h].prev=e,m[h].start=k[e].start,m[h].used=m[h].leaf=!0,-1===m[h].matched)){k[m[h].start].prev=h;p=!0;break}if(p)break;q=!0;for(h=0;h<g;++h)m[h].leaf&&(m[h].leaf=
!1,e=m[h].matched,k[e].used||(k[e].prev=h,k[e].start=m[h].start,k[e].used=k[e].leaf=!0,q=!1))}if(!p)break;for(p=0;p<g;++p)if(-1===k[p].matched&&-1!==k[p].prev){h=k[p].prev;do e=m[h].prev,m[h].matched=e,k[e].matched=h,h=k[e].prev;while(e!==p);++n}}if(n===g)break;for(e=0;e<g;++e)k[e].used=k[e].leaf=m[e].used=m[e].leaf=!1;for(e=0;e<g;++e)-1===k[e].matched&&b(e);for(h=0;h<g;++h)-1===m[h].matched&&c(h);for(e=0;e<g;++e)-1===k[e].matched||k[e].used||m[k[e].matched].used||(k[e].used=!0);n=Number.POSITIVE_INFINITY;
for(e=0;e<g;++e)if(!k[e].used)for(h=0;h<g;++h)m[h].used||n>l[e][h]&&(n=l[e][h]);for(e=0;e<g;++e)k[e].used||(k[e].cost+=n),m[e].used&&(m[e].cost-=n)}a=Array(g);for(e=0;e<g;++e)h=k[e].matched,a[e]=h;return a}function $a(a,d){d=x(a[0]);a=D(a[1]);"string"!==d.ctype&&(d=f.asList(d));if("number"===a.ctype){a=Math.floor(a.value.real);0>a&&(a=d.value.length+a+1);if(0<a&&a<d.value.length+1)return"list"===d.ctype?d.value[a-1]:{ctype:"string",value:d.value.charAt(a-1)};ra("WARNING: Index out of range!");return g}if("list"===
a.ctype){for(var b=[],c=0;c<a.value.length;c++){var e=D(a.value[c]);b[c]=$a([d,e],[])}return f.turnIntoCSList(b)}return g}function Cb(a,d){d=x(a[0]);a=x(a[1]);if("shape"===d.ctype&&"shape"===a.ctype)return E.shapeconcat(d,a);d=f.asList(d);a=f.asList(a);return"list"===d.ctype&&"list"===a.ctype?f.concat(d,a):g}function Ec(a,d){d=x(a[0]);a=x(a[1]);return"list"===d.ctype&&"list"===a.ctype?f.set(f.common(d,a)):"shape"===d.ctype&&"shape"===a.ctype?E.shapecommon(d,a):g}function Fc(a,d){d=x(a[0]);a=x(a[1]);
return"list"===d.ctype&&"list"===a.ctype?f.remove(d,a):"shape"===d.ctype&&"shape"===a.ctype?E.shaperemove(d,a):g}function mb(a,d){d=x(a[0]);a=x(a[1]);return"list"===d.ctype?f.append(d,a):g}function y(a,d){d=x(a[0]);a=x(a[1]);return"list"===a.ctype?f.prepend(d,a):g}function Xb(a,d){a|=0;d|=0;if(0===a&&0===d)return 0;for(;0!==d;){var b=a;a=d;d=b%d|0}return a}function Dd(a){return 1===a?0:1}function Yb(a,d,b){var c=d*d-4*a*b;0<=c?(c=Math.sqrt(c),0<d&&(c=-c),d=[[c-d,2*a],[2*b,c-d]]):d=null;if(null===
d)return null;a=d[0][0]/d[0][1];d=d[1][0]/d[1][1];return d<a?[d,a]:[a,d]}function bd(a,d,b,c,f,g,e,h){h=void 0===h?0:h;if(-1!==d.indexOf("\n")){var B=Infinity,H=-Infinity,R=Infinity,k=-Infinity;d.split("\n").forEach(function(d){d=bd(a,d,b,c,f,g);B>d.left&&(B=d.left);H<d.right&&(H=d.right);R>d.top&&(R=d.top);k<d.bottom&&(k=d.bottom);c+=e});return{left:B,right:H,top:R,bottom:k}}var ma=a.measureText(d);h?(a.save(),a.translate(b,c),a.rotate(-h),a.fillText(d,-ma.width*f,0),a.restore()):a.fillText(d,b-
ma.width*f,c);return{left:b-ma.width*f,right:b+ma.width*(1-f),top:c-.84*g,bottom:c+.36*g}}function Ua(a){return"image"===a.ctype?a.value:"string"===a.ctype&&bb.hasOwnProperty(a.value)?bb[a.value].value:null}function Db(a,d,b,c,f){var B=[];if(a.readPixels)B=a.readPixels(d,b,c,f);else{if(a.img.getContext){var H=a.img.getContext("2d");var g=H.getImageData(d,b,c,f).data}else try{td||(td=document.createElement("canvas")),td.width=c,td.height=f,H=td.getContext("2d"),H.drawImage(a.img,d,b,c,f,0,0,c,f),g=
H.getImageData(0,0,c,f).data}catch(Ia){console.log(Ia)}for(var e in g)B.push(g[e]/255)}return B}function cd(a){return a.replace(/[^A-Za-z0-9 \u0080-\uffff]/ig,"\\$&")}function ta(a,d,b){var c=a;d&&(c=c+" at "+d.row+":"+d.col);b&&(c=c+": \u2018"+b+"\u2019");c=Error(c);c.name="CindyScriptParseError";c.description=a;c.location=d;c.text=b;return c}function Tb(a){this.input=a;this.re=new RegExp(Ge,"g");for(var d=[],b=a.indexOf("\n")+1;b;)d.push(b),b=a.indexOf("\n",b)+1;d.push(a.length);this.bols=d;this.bol=
this.pos=0;this.line=1}function lc(a){var d=a[a.length-2],b=a[a.length-3],c=a[a.length-1];if(b){if(b.isSuperscript&&d.precedence<=b.precedence)throw ta("Operator not allowed after superscript",d.start,d.text);if(c){if(!d.op.infix)throw ta("Operator may not be used infix",d.start,d.text);}else if(!d.op.postfix)throw ta("Operator may not be used postfix",d.start,d.text);}else if(c){if(!d.op.prefix)throw ta("Operator may not be used prefix",d.start,d.text);}else if(!d.op.bare)throw ta("Operator without operands",
d.start,d.text);d.ctype="infix";d.oper=d.op.sym;d.args=[b,c];a.splice(a.length-3,3,d)}function dd(a,d,b,c){a.length&1||a.push(null);for(b=hb[b];3<=a.length&&a[a.length-2].precedence<=b.precedence;)lc(a);a.push({op:b,precedence:b.precedence+(b.rassoc?1:0),start:d.start,end:d.end,text:d.text,rawtext:d.rawtext});b="";for(var B=d.text,H=0;H<B.length;++H)b+="0123456789+-".charAt(c.indexOf(B.charAt(H)));d.ctype="number";d.value={real:+b,imag:0};a.push(d);lc(a)}function ed(a,d){var b=[];a:for(;;){var c=
a.next();switch(c.toktype){case "OP":var f=hb[c.text];"_"!==f.sym||!b.length||b.length&1||"OP"!==b[b.length-1].toktype||":="!==b[b.length-1].op.sym||(b.pop(),f=hb[":=_"],c.text=f.sym);c.op=f;c.precedence=f.precedence;for(b.length&1||b.push(null);3<=b.length&&b[b.length-2].precedence<=c.precedence;)lc(b);f.rassoc&&c.precedence++;b.push(c);break;case "ID":c.ctype="variable";c.name=c.text;if(b.length&1)throw ta("Missing operator",c.start,c.text);b.push(c);break;case "NUM":c.ctype="number";c.value={real:+c.text,
imag:0};if(b.length&1)throw ta("Missing operator",c.start,c.text);b.push(c);break;case "STR":c.ctype="string";c.value=c.raw.substring(1,c.raw.length-1);if(b.length&1)throw ta("Missing operator",c.start,c.text);b.push(c);break;case "SUB":dd(b,c,"_","\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089\u208a\u208b");break;case "SUP":dd(b,c,"^","\u2070\u00b9\u00b2\u00b3\u2074\u2075\u2076\u2077\u2078\u2079\u207a\u207b");b[b.length-1].isSuperscript=!0;break;case "BRA":f="[](){}||".indexOf(c.text);
if(c.text===d||f&1)break a;f="[](){}||".charAt(f+1);var g=ed(a,f),e=g.closedBy;if(e.text!==f)throw ta("Opening "+c.text+" at "+c.start.row+":"+c.start.col+" closed by "+(e.text||"EOF")+" at "+e.start.row+":"+e.start.col);e=c.text+e.text;f=[];if(g=g.expr){for(;g&&"infix"===g.ctype&&","===g.oper;)f.push(g.args[0]),g=g.args[1];f.push(g)}if(b.length&1){if("{}"===e)throw ta("{\u2026} reserved for future use",c.start);g=b[b.length-1];if("variable"!==g.ctype)throw ta("Function name must be an identifier",
g.start);if(2<b.length&&b[b.length-2].precedence<be)throw ta("Function call in indexing construct must be enclosed in parentheses",c.start);g.ctype="function";c=g.args=[];e=g.modifs={};for(var h=0;h<f.length;++h){var k=f[h];if(k&&"infix"===k.ctype&&"->"===k.oper){var m=k.args[0];if("variable"!==m.ctype)throw ta("Modifier name must be an identifier",k.start);e[m.name]=k.args[1]}else c.push(k)}g.oper=g.name.toLowerCase()+"$"+g.args.length}else if("||"===e)if(1===f.length)b.push({ctype:"function",oper:"abs_infix",
args:f,modifs:{}});else if(2===f.length)b.push({ctype:"function",oper:"dist_infix",args:f,modifs:{}});else throw ta("Don't support |\u2026| with "+f.length+" arguments",c.start);else{if("{}"===e)throw ta("{\u2026} reserved for future use",c.start);"[]"!==e&&1===f.length?b.push({ctype:"paren",args:f}):0===f.length?b.push({ctype:"list",value:[]}):b.push({ctype:"function",oper:"genList",args:f,modifs:{}})}break;case "EOF":break a}}for(b.length&1||b.push(null);3<=b.length;)lc(b);return{expr:b[0],closedBy:c}}
function mc(a){this.usedFunctions={};this.usedVariables={}}function x(a){if(void 0===a)return g;if("infix"===a.ctype)return a.impl(a.args,{},a);if("variable"===a.ctype)return x(M.getvar(a.name));if("function"===a.ctype)return zd.push(a),a=E.evaluate(a.oper,a.args,a.modifs),zd.pop(),a;if("void"===a.ctype)return g;if("field"===a.ctype){var d=x(a.obj);return"geo"===d.ctype?ya.getField(d.value,a.key):"list"===d.ctype?f.getField(d,a.key):g}return"userdata"===a.ctype?(d=x(a.obj),a=ca(x(a.key)),"_?_"===
a&&(a=void 0),"geo"===d.ctype?ya.getuserData(d.value,a):"list"===d.ctype||"string"===d.ctype?ya.getuserData(d,a):g):a}function D(a){a=x(a);if("geo"===a.ctype){var d=a.value;if("P"===d.kind)return ya.getField(d,"xy");if("V"===d.kind)return d.value}return a}function P(a){a=x(a);if("geo"===a.ctype){var d=a.value;if("P"===d.kind||"L"===d.kind)return ya.getField(d,"homog")}return f._helper.isNumberVecN(a,3)?a:f._helper.isNumberVecN(a,2)?(d=f.turnIntoCSList([a.value[0],a.value[1],m.real(1)]),a.usage&&(d=
v.withUsage(d,a.usage)),d):g}function fb(a){var d=new mc;d.usedFunctions=Mb;d.infixmap=V;a=d.parse(a);for(var b in d.usedVariables)M.create(b);return a}function he(a,d){return{ctype:"infix",args:[],impl:function(){zd=[{oper:d}];var b=x(a);zd=[];return b}}}function ra(a){Na.err(a+zd.map(function(a){return"\n  at "+a.oper}).join("\n"))}function Ed(){this._path=[];this._defs=["<defs>"];this._imgcache=[];this._body=[];this._saveStack=[""];this._clipIndex=0;this._stroke=this._fill="#000";this._strokeOpacity=
this._fillOpacity=null;this.height=this.width=0;this.lineWidth=1;this.lineCap="butt";this.lineJoin="miter";this.miterLimit=10;this.globalAlpha=1}function Eb(){this._body=[];this._yPos=this._xPos=NaN;this._extGState={Af255:"<< /ca 1 >>",As255:"<< /CA 1 >>"};this._objects=[["%PDF-1.4\n"]];this._offset=this._objects[0][0].length;this._nextIndex=5;this._imgcache=[];this._xobjects={};this._pathUsed=-1;this._fillAlpha=this._strokeAlpha=this._globalAlpha=1;this.height=this.width=0;this.lineWidth=1;this.lineCap=
"butt";this.lineJoin="miter";this.miterLimit=10}function Fd(a,d){var b=a.width,c=a.height,f=document.createElement("canvas");f.setAttribute("width",b);f.setAttribute("height",c);f.setAttribute("style","display:none;");var g=Ha.canvas;g.parentNode.insertBefore(f,g.nextSibling);try{return f.getContext("2d").drawImage(a,0,0,b,c),f.toDataURL(d||"image/png")}finally{f.parentNode.removeChild(f)}}function ie(a){a=a.replace(/[^ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/]+/g,"");var d=
new Uint8Array(3*a.length>>2),b,c;for(c=b=0;b+3<a.length;b+=4){var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(b));var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(b+1));var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(b+2));var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(b+3));d[c++]=f<<2|g>>4;d[c++]=g<<4|e>>2;d[c++]=e<<6|h}switch(a.length-
b){case 0:break;case 2:f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(b));g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(b+1));d[c++]=f<<2|g>>4;break;case 3:f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(b));g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(b+1));e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(b+
2));d[c++]=f<<2|g>>4;d[c++]=g<<4|e>>2;break;default:throw Error("Malformed Base64 input: "+(a.length-b)+" chars left: "+a.substr(b));}if(c!==d.length)throw Error("Failed assertion: "+c+" should be "+d.length);return d}function je(a){function d(d){return(a[d]<<24|a[d+1]<<16|a[d+2]<<8|a[d+3])>>>0}if(57>a.length)throw Error("Too short to be a PNG file");if(2303741511!==d(0)||218765834!==d(4))throw Error("PNG signature missing");for(var b=[],c=8;c<a.length;){if(c+12>a.length)throw Error("Incomplete chunk at offset 0x"+
c.toString(16));var f=d(c);if(2147483648<=f)throw Error("Chunk too long");var g=c+12+f;if(g>a.length)throw Error("Incomplete chunk at offset 0x"+c.toString(16));var e=a.subarray(c+4,c+8);e=String.fromCharCode.apply(String,e);b.push({len:f,type:e,data:a.subarray(c+8,c+8+f),crc:d(c+8+f)});c=g}return b}function nc(a,d){var b;if(b=/^rgba\(([0-9.]+), *([0-9.]+), *([0-9.]+), *([0-9.]+)\)$/.exec(a))d(+b[1],+b[2],+b[3],+b[4]);else if(b=/^rgb\(([0-9.]+), *([0-9.]+), *([0-9.]+)\)$/.exec(a))d(+b[1],+b[2],+b[3],
1);else throw Error("Can't handle color style "+a);}function Gd(a){var d=1;Object.keys(bb).forEach(function(b){var c=bb[b].value.img;if(void 0===c.cachedDataURL&&c.src)if("data:"===c.src.substr(0,5))c.cachedDataURL=c.src;else{++d;c.cachedDataURL=null;var B=new XMLHttpRequest;B.responseType="blob";B.onreadystatechange=function(){if(B.readyState===XMLHttpRequest.DONE)if(200===B.status){var b=new FileReader;b.onloadend=function(){c.cachedDataURL=b.result;console.log("Cached data for image "+c.src);0===
--d&&a()};b.readAsDataURL(B.response)}else console.error("Failed to load "+c.src+": "+B.statusText),0===--d&&a()};B.open("GET",c.src,!0);B.send()}});0===--d&&a()}function Fb(a,d,b){for(b||(b="0");a.length<d;)a=b+a;return a}function Gb(){null!==Ad&&(window.URL.revokeObjectURL(Ad),Ad=null)}function Gc(a){Gd(function(){var d=z;try{z=new a;z.width=ia;z.height=la;Ga();var b=z.toBlob();Ad=window.URL.createObjectURL(b);Je(Ad)}finally{z=d}})}function Hb(a){var d=null,b=1E6;console.log("getElementAtMouse");
for(var c=0;c<u.gslp.length;c++){var g=u.gslp[c];if(!g.pinned&&!1!==g.visible&&!0!==g.tmp){var e=A.drawingstate.matrix.sdet;if("P"===g.kind){var h=f.normalizeZ(g.homog);if(!f._helper.isAlmostReal(h))continue;var k=h.value[0].value.real-a.x;var l=h.value[1].value.real-a.y;var n=Math.sqrt(k*k+l*l);g.narrow&n>20/e&&(n=1E4)}else if("C"===g.kind)l=u.csnames[g.args[0]],n=0,"undefined"!==typeof g.radius&&(n=g.radius.value.real),k=m.div(l.homog.value[0],l.homog.value[2]).value.real,l=m.div(l.homog.value[1],
l.homog.value[2]).value.real,k-=a.x,l-=a.y,n=Math.sqrt(k*k+l*l)-n,l=k=0,0>n&&(n=-n),n+=30/e;else if("L"===g.kind||"S"===g.kind)k=g.homog,n=m,l=n.add(n.mult(k.value[0],n.conjugate(k.value[0])),n.mult(k.value[1],n.conjugate(k.value[1]))),l=f.scaldiv(n.sqrt(l),k),n=l.value[0].value.real*a.x+l.value[1].value.real*a.y+l.value[2].value.real,k=l.value[0].value.real*n,l=l.value[1].value.real*n,0>n&&(n=-n),n+=1;if(n<b+.2/e){b=n;d=g;var p={x:k,y:l}}}}return null===d?null:{mover:d,offset:p,prev:{x:a.x,y:a.y}}}
function Ma(){return"P"+Ve++}function Ib(a){var d=K[Ae].actions;d[Xc].event===a&&d[Xc].do()&&(q(),Xc===d.length-1?(db=[],Xc=Pb=0):Xc++)}function hd(a){return a&&.5>Math.abs(a.offset.x)&&.5>Math.abs(a.offset.y)&&!a.mover.tmp}function Id(a){return hd(a)&&"P"===a.mover.kind}function Jd(a){return hd(a)&&("L"===a.mover.kind||"S"===a.mover.kind)}function Jc(a){ua={mover:a,offset:{x:0,y:0},prev:{x:ea.x,y:ea.y}}}function Ub(){var a=Hb(ea);Id(a)?db[Pb]=a.mover:(db[Pb]={type:"Free",name:Ma(),labeled:!0,pos:[Ja[0],
Ja[1],1]},Va(db[Pb]));Pb++}function Jb(){var a=Hb(ea);return Jd(a)?(db[Pb]=a.mover,Pb++,!0):!1}function Kd(){var a=Hb(ea),d;(d=Jd(a))||(d=hd(a)&&"C"===a.mover.kind);return d?(db[Pb]=a.mover,Pb++,!0):!1}function Zb(){var a=Hb(ea);if(Id(a))for(Bd.args[1]=a.mover.name,a=0;a<u.gslp.length;a++){var d=u.gslp[a];!0===d.tmp&&Lc(d.name)}else for(a=0;a<u.gslp.length;a++)d=u.gslp[a],!0===d.tmp&&(d.tmp=!1)}function Kc(a){var d={type:"Free",name:Ma(),labeled:!0,pos:[Ja[0],Ja[1],1],tmp:!0};d=Va(d);Bd=Va({type:a,
name:Ma(),labeled:!0,args:[db[0].name,d.name]});Jc(d)}function ke(a){for(var d in a)null!==a[d]&&(va[d]=a[d])}function le(a){Object.keys(n).forEach(function(a){var d=n[a];wb(d.signature||"_helper"===a,a+" has no signature");void 0!==d.updatePosition&&void 0===d.stateSize&&(d.stateSize=0)});u.gslp=[];u.csnames={};u.points=[];u.lines=[];u.conics=[];u.texts=[];u.free=[];u.polygons=[];u.ifs=[];u.sets={points:[],lines:[],conics:[]};a.forEach(id);$d()}function Ld(a){"undefined"===typeof a.tracedim&&(a.tracedim=
1);"undefined"===typeof a.tracelength&&(a.tracelength=100);"undefined"===typeof a.traceskip&&(a.traceskip=1);a._traces=Array(a.tracelength);a._traces_index=0;a._traces_tick=0}function Md(a){void 0===a.size&&(a.size=va.pointSize);a.size=m.real(a.size);!a.movable||a.pinned?(a.color=f.realVector(a.color||va.pointColor),a.color=f.scalmult(m.real(va.dimDependent),a.color)):a.color=f.realVector(a.color||va.pointColor);void 0===a.alpha&&(a.alpha=va.alpha);a.alpha=m.real(a.alpha);"boolean"!==typeof a.noborder&&
(a.noborder=va.noborder);a.noborder=v.bool(a.noborder);"boolean"!==typeof a.border&&(a.border=!va.noborder);a.border=v.bool(a.border);a.drawtrace&&Ld(a)}function $b(a){void 0===a.size&&(a.size=va.lineSize);a.size=m.real(a.size);a.color=f.realVector(a.color||va.lineColor);void 0===a.alpha&&(a.alpha=va.alpha);a.alpha=m.real(a.alpha);a.clip=v.string(a.clip||va.clip);void 0===a.overhang&&(a.overhang=va.overhangLine);a.overhang=m.real(a.overhang);a.dashtype&&(a.dashtype=v.wrap(a.dashtype))}function Nd(a){void 0===
a.overhang&&(a.overhang=va.overhangSeg);a.arrow&&(a.arrow=v.bool(a.arrow));a.arrowsize&&(a.arrowsize=m.real(a.arrowsize));a.arrowposition&&(a.arrowposition=m.real(a.arrowposition));a.arrowshape&&(a.arrowshape=v.string(a.arrowshape));a.arrowsides&&(a.arrowsides=v.string(a.arrowsides));$b(a);a.clip=v.string("end")}function Od(a){a.size=void 0!==a.textsize?a.textsize:void 0!==a.size?a.size:va.textsize;a.size=m.real(+a.size)}function pb(a){a.filled=void 0!==a.filled?v.bool(a.filled):v.bool(!0);a.fillcolor=
void 0===a.fillcolor?g:f.realVector(a.fillcolor);void 0===a.fillalpha&&(a.fillalpha=0);a.fillalpha=m.real(a.fillalpha);$b(a)}function Va(a,d){a=id(a);$d();return"boolean"===typeof d&&d&&a.Duplicate?(d=a.Duplicate,console.log("duplication detected: removing "+a.name+" (type "+a.kind+") (duplicate of "+d.name+")."),Lc(a.name),d):a}function id(a){if(void 0!==u.csnames[a.name]){console.log("Element name '"+a.name+"' already exists");var d=u.csnames[a.name];n[d.type].isMovable&&"P"===n[d.type].kind&&Ra(d,
a.pos,"homog");return d}for(;Yc.hasOwnProperty(a.type);)a.type=Yc[a.type];if(d=Be[a.type]){var b=d(a),c=null;for(d=0;d<b.length;++d)c=Va(b[d]);return c}var f=n[a.type];b=!1;if(!f)return console.error(a),console.error("Operation "+a.type+" not implemented yet"),null;if("**"!==f.signature)if(!Array.isArray(f.signature)&&"*"===f.signature.charAt(1))b=!0,a.args.forEach(function(d){if(u.csnames[d].kind!==f.signature.charAt(0))return console.error("Not all elements in set are of same type: "+a.name+" expects "+
f.signature+" but "+d+" is of kind "+u.csnames[d].kind),"undefined"!==typeof window&&window.alert("Not all elements in set are of same type: "+a.name),null});else if(f.signature.length!==(a.args?a.args.length:0))return console.error("Wrong number of arguments for "+a.name+" of type "+a.type),"undefined"!==typeof window&&window.alert("Wrong number of arguments for "+a.name),null;if(a.args)for(d=0;d<a.args.length;++d){if(!u.csnames.hasOwnProperty(a.args[d]))return console.log("Dropping "+a.name+" due to missing argument "+
a.args[d]),null;if("**"!==f.signature&&!b&&(c=u.csnames[a.args[d]].kind,f.signature[d]!==c&&("S"!==c||"L"!==f.signature[d])))return window.alert("Wrong argument kind "+c+" as argument "+d+" to element "+a.name+" of type "+a.type),null}f.signatureConstraints&&!f.signatureConstraints(a)&&window.alert("signature constraints violated for element "+a.name);u.gslp.push(a);u.csnames[a.name]=a;d=jb.length;a.kind=f.kind;a.stateIdx=d;d+=f.stateSize;a.incidences=[];a.isshowing=!0;a.movable=!1;f.isMovable&&(a.movable=
!0,u.free.push(a));"P"===a.kind&&(u.points.push(a),Md(a));"L"===a.kind&&(u.lines.push(a),$b(a));"C"===a.kind&&(u.conics.push(a),$b(a));"S"===a.kind&&(u.lines.push(a),Nd(a));"Text"===a.kind&&(u.texts.push(a),Od(a));"Poly"===a.kind&&(u.polygons.push(a),pb(a));"IFS"===a.kind&&u.ifs.push(a);/^[P|L|S|C]s$/.test(a.kind)&&u.sets[{P:"points",L:"lines",S:"lines",C:"conics"}[a.kind[0]]].push(a);Nc(d);Ea=sb=jb;fc=!0;f.initialize&&(eb=kb=a.stateIdx,a.param=f.initialize(a),wb(kb===a.stateIdx+f.stateSize,"State fully initialized"));
eb=kb=a.stateIdx;f.updatePosition(a,!1);wb(eb===a.stateIdx+f.stateSize,"State fully consumed");wb(kb===a.stateIdx+f.stateSize,"State fully updated");fc=!1;Ea=Ob.in;Ea.set(jb);sb=Ob.out;jd(a,f);fe={};try{oa(a),Kb(a)}catch(ma){console.error(ma)}return u.csnames[a.name]}function Lc(a){if(u.csnames.hasOwnProperty(a)){var d={};Object.keys(u.csnames).forEach(function(a){var b=u.csnames[a];b.hasOwnProperty("args")&&b.args.forEach(function(b){d.hasOwnProperty(b)||(d[b]={});d[b][a]=!0})});var b=function(a,
c){c[a]=!0;if(!d.hasOwnProperty(a))return c;for(var B in d[a])c[B]||b(B,c);return c};a=b(a,{});me(a)}else console.log("removeElement: name "+a+"does not exist.")}function me(a){var d=Object.keys(a),b=function(a,d){return function(d){return a[d.name]?!1:!0}},c={};d.forEach(function(d){u.csnames[d].incidences.forEach(function(d){c[d]||(u.csnames[d].incidences=u.csnames[d].incidences.filter(function(d){return!a[d]}),c[d]=!0)})});"conics free gslp ifs lines points polygons texts".split(" ").map(function(d){u[d]=
u[d].filter(b(a,d))});for(var f in u.sets)u.sets[f]=u.sets[f].filter(b(a,"set of "+f));d.forEach(function(a){delete u.csnames[a]});fe={}}function Pd(a,d){var b=u.csnames[d.args[0]].homog,c=u.csnames[d.args[1]].homog;d=a.homog;a=m.div(b.value[0],b.value[2]);b=m.div(b.value[1],b.value[2]);var f=m.div(c.value[0],c.value[2]);c=m.div(c.value[1],c.value[2]);var g=m.div(d.value[0],d.value[2]);d=m.div(d.value[1],d.value[2]);return m._helper.isAlmostReal(a)&&m._helper.isAlmostReal(b)&&m._helper.isAlmostReal(f)&&
m._helper.isAlmostReal(c)&&m._helper.isAlmostReal(g)&&m._helper.isAlmostReal(d)?(a=a.value.real,b=b.value.real,f=f.value.real,c=c.value.real,g=g.value.real,d=d.value.real,a=Math.sqrt((a-f)*(a-f)+(b-c)*(b-c))-Math.sqrt((a-g)*(a-g)+(b-d)*(b-d))-Math.sqrt((f-g)*(f-g)+(c-d)*(c-d)),1E-15>a*a):!1}function jd(a,d){a.isshowing=!0;if(a.args)for(var b=0;b<a.args.length;b++)if(!u.csnames[a.args[b]].isshowing){a.isshowing=!1;return}d.visiblecheck&&d.visiblecheck(a)}function Qd(a,d,b,c,f){var B=a.textsize||va.textsize,
H=!0===a.textbold,g=!0===a.textitalics,e=a.text_fontfamily||va.fontFamily,h=c.x*c.x+c.y*c.y,R=1;0<h&&(R=1+a.size.value.real/Math.sqrt(h));a=a.alpha||m.real(va.alpha);E.drawtext([b,v.wrap(d)],{x_offset:v.wrap(R*c.x),y_offset:v.wrap(R*c.y),size:v.wrap(B),bold:v.wrap(H),italics:v.wrap(g),family:v.wrap(e),color:f,alpha:a})}function Mc(a){a._bbox=null;if(a.isshowing&&!1!==a.visible){var d={size:a.size},b=a.homog,c=a.text,f=n[a.type].getText;c=f?f(a):c.replace(/@[$#]"([^"\\]|\\.)*"/g,function(a){try{var d=
JSON.parse(a.substring(2));var b=u.csnames[d];if(!b)return"?"}catch($e){return"?"}switch(a.charAt(1)){case "$":return b.printname||d;case "#":return"V"!==b.kind?"?":ca(b.value)}});f=null;if(a.html){var g=a._textCache||{text:!1},e=a.html,h=e.parentNode,k=h.parentNode;f=function(d,b,c,B,f){b/=sa;c/=sa;f=w.bold+w.italics+Math.round(f/sa*10)/10+"px "+w.family;g.invisible&&k.style.removeProperty("display");if(d!==g.text||f!==g.font||b!==g.x||c!==g.y||B!==g.align){f!==g.font&&(e.style.font=f,e.style.lineHeight=
va.lineHeight);d!==g.text&&!1!==d&&!1===Fe(e,d,f)&&(d=!1);k.style.left=b+"px";k.style.top=c+"px";if(B||h.style.transform)h.style.transform="translateX("+-100*B+"%)";a._textCache={text:d,font:f,x:b,y:c,align:B}}}}c=v.string(c);a.dock&&(a.dock.to?b=u.csnames[a.dock.to].homog:Ke.hasOwnProperty(a.dock.corner)&&(b=t.screenbounds$0([],{}),b=b.value[Ke[a.dock.corner]]),d.offset=a.dock.offset);a.align&&(d.align=v.string(a.align));b&&(a._bbox=E.drawtext([b,c],d,f))}else a.html&&(a.html.parentNode.parentNode.style.display=
"none",a._textCache={invisible:!0})}function Rd(){function a(){var a=h++/b._traces.length,d=b._traces[e];d&&(a*=c*a*a,t.draw$1([d],{size:m.real(f),color:b.color,alpha:m.real(a)}));f*=g}for(var d=0;d<u.points.length;d++){var b=u.points[d];if(b.drawtrace){b._traces_tick===b.traceskip?(b._traces[b._traces_index]=b.homog,b._traces_index=(b._traces_index+1)%b._traces.length,b._traces_tick=0):b._traces_tick++;var c=b.alpha.value.real,f=b.size.value.real,g=1;1!==b.tracedim&&(f*=b.tracedim,g=Math.pow(b.tracedim,
-1/b._traces.length));var e,h=0;for(e=b._traces_index;e<b._traces.length;++e)a();for(e=0;e<b._traces_index;++e)a()}}}function wb(a,d){d="Assertion failed: "+d;if(!a)throw console.log(d),U(),"undefined"!==typeof alert&&alert(d),Error(d);}function Nc(a){if(a!==jb.length){var d,b=Ce.length;if(gc.length<a*b){var c=2*a;gc=new Float64Array(b*c)}else c=gc.length/b|0;for(d=0;d<b;++d)Ob[Ce[d]]=gc.subarray(d*c,d*c+a);a=jb;Ea=Ob.in;sb=Ob.out;jb=Ob.good;jb.set(a)}}function ac(){jb.set(Ea);nb=!1;Wd(!1);for(var a=
jb.length,d=Math.abs,b=0;b<a;b+=2)d(jb[b])>1E12*d(jb[b+1])&&(jb[b+1]=0)}function oc(){if(Zc)nb=!0;else throw Le;}function Sd(a,d,b,c,f){return v.add(c,v.mult(b,v.sub(f,c)))}function Td(){N&&(N.currentMouseAndScripts=[]);De=!0;if(ua){var a=ua.mover,d=f.realVector([ea.x+ua.offset.x,ea.y+ua.offset.y,1]);Ud(a,d,"mouse");ua.prev.x=ea.x;ua.prev.y=ea.y}x(S.move);x(S.draw);nb||ac();De=!1;N&&(N.fullLog.push(f.turnIntoCSList([f.turnIntoCSList(N.currentMouseAndScripts)])),N.length>N.logLength&&N.splice(0,N.length-
N.logLength),N.currentMouseAndScripts=null,N.postMouseHooks.forEach(function(a){a()}))}function Ra(a,d,b){Ud(a,d,b);De||nb||ac()}function Ud(a,d,b){N&&N.currentMouseAndScripts&&(N.currentMover=[]);a===Me?(Ea.set(jb),nb=!1):(Me=a,ac());sb.set(Ea);var c=1E4;var B=fe[a.name];if(!B){var g={},e=0;B=[];g[a.name]=a;for(var h=u.gslp,k=0;k<h.length;++k){var l=h[k],p=l.args;if(p)for(var q=0;q<p.length;++q)g.hasOwnProperty(p[q])&&(g[l.name]=l,B[e++]=l)}fe[a.name]=B}g=-1;e=.9;var r;h=n[a.type];k=h.parameterPath||
Sd;eb=a.stateIdx;l=h.getParamFromState(a);eb=kb=a.stateIdx;p=h.getParamForInput(a,d,b);for(q=g+e;g!==q;){var t=q*q,w=.5/(1+t);w=m.complex(2*q*w+.5,(1-t)*w);Zc=g+.5*e<=g||0===c;0===c&&console.log("tracing limit Reached");t=!1;N&&N.currentMouseAndScripts&&(N.currentStep=[]);try{eb=kb=a.stateIdx;var x=k(a,q,w,l,p);N&&(N.currentParam=x);w=sb;sb=Ea;h.putParamToState(a,x);sb=w;kb=a.stateIdx;N&&(N.currentElement=a);h.updatePosition(a,!0);wb(eb===a.stateIdx+h.stateSize,"State fully consumed");wb(kb===a.stateIdx+
h.stateSize,"State fully updated");for(r=0;r<B.length;++r){var z=B[r];var A=n[z.type];eb=kb=z.stateIdx;N&&(N.currentElement=z);A.updatePosition(z,!1);wb(eb===z.stateIdx+A.stateSize,"State fully consumed");wb(kb===z.stateIdx+A.stateSize,"State fully updated")}N&&(N.currentElement=null);g=q;e*=1.25;q+=e;1<=q&&(q=1);sb=Ea;Ea=w}catch(Ie){if(Ie!==Le)throw Ie;e*=.5;q=g+e;--c;t=!0}N&&N.currentMouseAndScripts&&(N.currentMover.push(f.turnIntoCSList([f.turnIntoCSList(N.currentStep),v.wrap(t),v.wrap(g),v.wrap(q),
v.wrap(N.currentParam)])),N.currentStep=null,N.currentParam=null)}Wd(nb);for(r=0;r<B.length;++r)z=B[r],A=n[z.type],jd(z,A);N&&N.currentMouseAndScripts&&(N.currentMouseAndScripts.push(f.turnIntoCSList([f.turnIntoCSList(N.currentMover),v.wrap(nb),v.wrap(a.name),d,v.wrap(b),l,p])),N.currentMover=null)}function Vd(){ac();Zc=!0;for(var a=u.gslp,d=0;d<a.length;d++){var b=a[d],c=n[b.type];eb=kb=b.stateIdx;c.updatePosition(b,!1);jd(b,c)}a=sb;sb=Ea;Ea=a;ac()}function Wd(a){var d=b.tracingStateReport;"string"===
typeof d&&(document.getElementById(d).textContent=a?"BAD":"GOOD")}function Xd(){return f.turnIntoCSList(N.fullLog.slice())}function ne(a){var d=JSON.stringify(N.fullLog);a=new Blob([d],{type:a?"application/octet-stream":"application/json"});return window.URL.createObjectURL(a)}function bc(){var a=eb;eb+=2;return m.complex(Ea[a],Ea[a+1])}function da(a){for(var d=Array(a),b=0;b<a;++b)d[b]=bc();return f.turnIntoCSList(d)}function qb(a){sb[kb]=a.value.real;sb[kb+1]=a.value.imag;kb+=2}function Y(a){for(var d=
0,b=a.value.length;d<b;++d)qb(a.value[d])}function gb(a,d){var b=da(3),c=da(3);a=kd(a,d,b,c);Y(a[0]);Y(a[1]);return f.turnIntoCSList(a)}function kd(a,d,b,c){if(fc)return[a,d];var B=f.projectiveDistMinScal(b,a),H=f.projectiveDistMinScal(b,d),e=f.projectiveDistMinScal(c,a),h=f.projectiveDistMinScal(c,d),k=f.projectiveDistMinScal(b,c),m=f.projectiveDistMinScal(a,d),l=B+h,n=H+e;if(l>n){var p=[d,a];l=n}else p=[a,d];n=function(){};if(N&&N.currentStep){var q=[N.labelTracing2,v.wrap(N.currentElement.name),
f.turnIntoCSList(p),f.turnIntoCSList([b,c]),f.realMatrix([[B,H],[e,h]]),v.wrap(l),v.wrap(k),v.wrap(m),g];N.currentStep.push(f.turnIntoCSList(q));n=function(a){N.hasOwnProperty(a)||(N[a]=v.wrap(a));q[q.length-1]=N[a]}}f._helper.isNaN(a)||f._helper.isNaN(d)?(n("Tracing failed due to NaNs."),nb=!0):k>3*l&&m>3*l?n("Normal case, everything all right."):1E-5>m?1E-5>k?n("Staying inside singularity."):(n("Moved into singularity."),nb=!0):1E-5>k?n("Moved out of singularity."):(Zc?n("Reached refinement limit, giving up."):
n("Need to refine."),oc());return p}function ld(a,d,b,c){var B=da(3),H=da(3),g=da(3),e=da(3);a=oe(a,d,b,c,B,H,g,e);Y(a[0]);Y(a[1]);Y(a[2]);Y(a[3]);return f.turnIntoCSList(a)}function oe(a,d,b,c,e,h,k,m){var B=function(){};e=[e,h,k,m];a=[a,d,b,c];if(fc)return a;h=0;c=Array(4);for(b=0;4>b;b++)for(c[b]=Array(4),m=0;4>m;m++)k=f.projectiveDistMinScal(e[b],a[m]),c[b][m]=k;k=Q(c);d=Array(4);for(b=0;4>b;++b)d[b]=a[k[b]],h+=c[b][k[b]];var H=1*h,R=Infinity,l=Infinity;for(b=0;4>b;b++){if(f._helper.isNaN(a[b]))return B("Tracing failed due to NaNs."),
nb=!0,d;for(m=b+1;4>m;m++)k=f.projectiveDistMinScal(e[b],e[m]),R>k&&(R=k),k=f.projectiveDistMinScal(d[b],d[m]),l>k&&(l=k)}if(N&&N.currentStep){var ma=[N.labelTracing4,v.wrap(N.currentElement.name),f.turnIntoCSList(d),f.turnIntoCSList(e),f.realMatrix(c),v.wrap(h),v.wrap(R),v.wrap(l),g];N.currentStep.push(f.turnIntoCSList(ma));B=function(a){N.hasOwnProperty(a)||(N[a]=v.wrap(a));ma[ma.length-1]=N[a]}}R>H&&l>H||(1E-5>l?1E-5>R?B("Staying inside singularity."):(B("Moved into singularity."),nb=!0):1E-5>
R?B("Moved out of singularity."):(Zc?B("Reached refinement limit, giving up."):B("Need to refine."),oc()));return d}function Yd(a){var d=a.length,b,c;if(fc){for(b=0;b<d;++b)eb+=2*a[b].value.length,Y(a[b]);return a}var e=Array(d),h=Array(d),k=Array(d),m=99,l=99,n=Array(d);for(b=0;b<d;++b)e[b]=da(a[b].value.length),h[b]=f.normSquared(e[b]).value.real,k[b]=f.normSquared(a[b]).value.real,n[b]=Array(d);for(b=0;b<d;++b){for(c=0;c<d;++c){var p=f.sesquilinearproduct(e[b],a[c]).value;p=(p.real*p.real+p.imag*
p.imag)/(h[b]*k[c]);n[b][c]=1-p}for(c=b+1;c<d;++c)p=f.sesquilinearproduct(e[b],e[c]).value,p=(p.real*p.real+p.imag*p.imag)/(h[b]*h[c]),m>1-p&&(m=1-p),p=f.sesquilinearproduct(a[b],a[c]).value,p=(p.real*p.real+p.imag*p.imag)/(k[b]*k[c]),l>1-p&&(l=1-p)}p=Q(n);c=Array(d);h=0;k=!1;for(b=0;b<d;++b){h+=n[b][p[b]];var q=c[b]=a[p[b]];Y(q);k|=f._helper.isNaN(q)}k|=isNaN(h);a=function(){};if(N&&N.currentStep){var r=[N.labelTracingSesq,v.wrap(N.currentElement.name),f.turnIntoCSList(c),f.turnIntoCSList(e),f.realMatrix(n),
v.wrap(h),v.wrap(m),v.wrap(l),g];N.currentStep.push(f.turnIntoCSList(r));a=function(a){N.hasOwnProperty(a)||(N[a]=v.wrap(a));r[r.length-1]=N[a]}}k?(a("Tracing failed due to NaNs."),nb=!0):m>3*h&&l>3*h?a("Normal case, everything all right."):1E-5>l?1E-5>m?a("Staying inside singularity."):(a("Moved into singularity."),nb=!0):1E-5>m?a("Moved out of singularity."):(Zc?a("Reached refinement limit, giving up."):a("Need to refine."),oc());return c}function pc(a,d){a=n._helper.flattenConicMatrix(a);d=n._helper.flattenConicMatrix(d);
var b=da(6),c=da(6);d=kd(a,d,b,c);Y(d[0]);Y(d[1]);a=n._helper.buildConicMatrix(d[0].value);d=n._helper.buildConicMatrix(d[1].value);return f.turnIntoCSList([a,d])}function oa(a){if(oa.hasOwnProperty(a.kind))oa[a.kind](a)}function Kb(a){Kb.hasOwnProperty(a.kind)&&(a.incidences=[],Kb[a.kind](a))}function md(a,d){return function(){a.incidences.push(d.name);d.incidences.push(a.name)}}function qc(a,d){return function(){a.Duplicate=d}}function nd(a,d){return{getInvolved:function(){return[a,d]},toString:function(){return"point "+
a.name+" incident line "+d.name},apply:md(a,d),holds:function(){var b=f.scaldiv(f.abs(a.homog),a.homog),c=f.scaldiv(f.abs(d.homog),d.homog);return m.abs(f.scalproduct(b,c)).value.real<m.epsbig}}}function Zd(a,d){return{getInvolved:function(){return[a,d]},toString:function(){return"point "+a.name+" incident conic "+d.name},apply:md(a,d),holds:function(){var b=v.mult(d.matrix,a.homog);b=v.mult(a.homog,b);b=m.abs(b);return b.value.real<m.epsbig}}}function $d(){if(0!==Oa.length){Ob.prover.set(Ea);var a,
d=function(){a={};Oa.forEach(function(d){var c;d.getInvolved().forEach(function(d){a[d.name]||(a[d.name]=!0,c=b(d,{}),c.forEach(function(d){a[d]=!0}))})})},b=function(a,d){a.incidences.forEach(function(a){d[a]||(d[a]=!0,b(u.csnames[a],d))});return Object.keys(d)};d();var c=function(a){return a.holds()};Object.keys(a).forEach(function(d){d=u.csnames[d].args;"undefined"!==typeof d&&d.forEach(function(d){a[d]=!0})});for(var f,g=0;3>g;g++){for(var e in a){var h=u.csnames[e];!h.pinned&&n[h.type].isMovable&&
(f=n[h.type].getRandomMove(h),Ra(h,f.value,f.type),Oa=Oa.filter(c))}d()}Ea.set(Ob.prover);Vd();for(d=0;d<Oa.length;++d)Oa[d].apply();Oa=[]}}function Oc(a,d,c){var B=document.createElement("div"),f=document.createElement("img");f.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAPoCAQAAAC1v1zVAAAAGklEQVR42u3BMQEAAADCoPVPbQ0PoAAAgHcDC7gAAVI8ZnwAAAAASUVORK5CYII=";B.className="CindyJS-baseline";B.appendChild(f);f=document.createElement("div");f.className="CindyJS-button";B.appendChild(f);for(var g=
2;g<arguments.length;++g)f.appendChild(arguments[g]);pa.parentNode.appendChild(B);a.html=arguments[arguments.length-1];Wa(a.fillalpha)||(a.fillalpha=1);a.fillcolor&&(a.html.style.backgroundColor=w.makeColor(a.fillcolor,a.fillalpha));Wa(a.alpha)||(a.alpha=1);a.color&&(a.html.style.color=w.makeColor(a.color,a.alpha));B=q;if(a.script){var e=fb(a.script);B=function(){x(e);q()}}c.addEventListener(d,B);!b.keylistener&&(S.keydown||S.keyup||S.keytyped)&&(c.addEventListener("keydown",function(a){9!==a.keyCode&&
ha(a,S.keydown)}),c.addEventListener("keyup",function(a){ha(a,S.keyup)}),c.addEventListener("keypress",function(a){9!==a.keyCode&&ha(a,S.keytyped)}));n.Text.initialize(a)}function ab(){}function od(a){if(!/^Select/.test(a.type)&&!n[a.type].isMovable)return null;var d=v.unwrap,b=m.add;switch(a.kind){case "P":case "L":case "Text":return d(a.homog);case "C":return a=a.matrix.value,{xx:d(a[0].value[0]),yy:d(a[1].value[1]),zz:d(a[2].value[2]),xy:d(b(a[0].value[1],a[1].value[0])),xz:d(b(a[0].value[2],a[2].value[0])),
yz:d(b(a[1].value[2],a[2].value[1]))};default:return null}}function Pc(a){var d={};d.offset=v.unwrap(a.offset);a.to&&(d.to=a.to);a.corner&&(d.corner=a.corner);return d}function Qc(a){var d={},b={pinned:!1,movable:!0};"P"===a.kind&&Md(b);"L"===a.kind&&$b(b);"C"===a.kind&&$b(b);"S"===a.kind&&Nd(b);"Text"===a.kind&&Od(b);"Poly"===a.kind&&pb(b);We.forEach(function(c){if(a.hasOwnProperty(c)){var B=v.unwrap(a[c]),f=v.unwrap(b[c]);null!==B&&void 0!==B&&B!==f&&JSON.stringify(B)!==JSON.stringify(f)&&(d[c]=
B)}});if("P"===a.kind&&(!a.movable||a.pinned)&&d.color){var c=m.real(1/va.dimDependent);d.color=v.unwrap(f.scalmult(c,a.color))}if(c=od(a))d.pos=c;a.dock&&(d.dock=Pc(a.dock));return d}function pe(){var a=[];u.gslp.forEach(function(d){d.tmp||a.push(Qc(d))});return a}function pd(){lb.forEach(function(a){var d=(a.geo||[]).map(function(a){return u.csnames[a]});T[a.type].reset(a,d[0],d)})}function Lb(a){ze=0!==a.length;lb=[];xa=[];Ee=[];T.Environment.init({});a.forEach(function(a){a.behavior?(a.name&&
(a.behavior.geo=[a.name]),a=a.behavior,a.gravity&&(a.gravity=-a.gravity)):d=a.geo;var d=(a.geo||[]).map(function(a){return u.csnames[a]}),b=d[0],c=T[a.type];c?(c.init&&c.init(a,b,d),b&&(b.behavior=a,"Mass"===a.type?xa.push(b):"Spring"===a.type&&Ee.push(b)),lb.push(a)):(console.error(a),console.error("Behavior "+a.type+" not implemented yet"))})}var Da=this,Na,S={},wa=!1,rc=!0,sc=0,ae=.5,qd=0,tc=10,vc=5/360,ve=.32/vc/1E3*2,Rc=1,Sa=0,vd=0,wc=!1,Nb=.2,xc=!1,Sc=0,Tc=0,sa=1,pa,cc,Wa=Number.isFinite||function(a){return"number"===
typeof a&&isFinite(a)},Ja,z,ia,la,u,bb,Uc=g,Vc=g,rb={play:ab,pause:ab,stop:ab},yc=null,dc=function(a,d){var b=[];dc=function(a,d){b.push({img:a,id:d})};dc(a,d);var c=Da.getBaseDir()+"images/Icons.svg",f=new XMLHttpRequest;f.onreadystatechange=function(){if(f.readyState===XMLHttpRequest.DONE)if(200!==f.status)console.error("Failed to load CindyJS Icons.svg from "+c+": "+f.statusText);else{var a=f.responseXML,d=a.documentElement,B={},H;for(H=d.firstChild;H;H=g){var g=H.nextSibling;H.nodeType===Node.ELEMENT_NODE&&
"http://www.w3.org/2000/svg"===H.namespaceURI&&"g"===H.localName.toLowerCase()&&(d.removeChild(H),H.setAttribute("style","display:inline"),B[H.getAttribute("id")]=H)}var e=new XMLSerializer;dc=function(b,c){if(B.hasOwnProperty(c)){c=B[c];d.appendChild(c);try{var f=e.serializeToString(a)}finally{d.removeChild(c)}b.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(f)}};b.forEach(function(a){dc(a.img,a.id)});b=null}};f.responseType="document";f.open("GET",c);f.send()},ce=1,ec=null,xb=[],zc=
!1,Ha={config:b,startup:r,shutdown:U,evokeCS:function(a){a=fb(a,!1);x(a);q()},play:G,pause:Pa,stop:tb,evalcs:function(a){return x(fb(a,!1))},parse:function(a){return fb(a)},niceprint:ca,canvas:null},wd=!1,Ac=0;b.use&&b.use.forEach(function(a){var d=null;b.plugins&&(d=b.plugins[a]);d||(d=Da._pluginRegistry[a]);d||(++Ac,console.log("Loading script for plugin "+a),Da.loadScript(a+"-plugin",a+"-plugin.js",function(){console.log("Successfully loaded plugin "+a);0===--Ac&&wd&&r()},function(){console.error("Failed to auto-load plugin "+
a);0===--Ac&&wd&&r()}))});ub.prototype=new vb;Ta.prototype=new vb;La.prototype=new vb;var ea={},ua,xd="",Wc=0,Xa=0,yb={},Vb={};var cb=b.isNode?process.nextTick:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,0)};var Ya=null,de=[0,8,7,441,"g1be50a7"],m={_helper:{}};m._helper.roundingfactor=1E4;m._helper.angleroundingfactor=10;m._helper.niceround=function(a,
d){return Math.round(a*d)/d};m.niceprint=function(a,d){d=d||m._helper.roundingfactor;if("Angle"===a.usage)return m._helper.niceangle(a);var b=m._helper.niceround(a.value.real,d);a=m._helper.niceround(a.value.imag,d);return 0===a?""+b:0<a?""+b+" + i*"+a:""+b+" - i*"+-a};var yd=b.angleUnit||"\u00b0",we=yd.replace(/\s+/g,""),Bc=2*Math.PI,xe=1/Bc,ee={rad:Bc,"\u00b0":360,deg:360,degree:360,gra:400,grad:400,turn:1,cyc:1,rev:1,rot:1,"\u03c0":2,pi:2,quad:4};m._helper.niceangle=function(a){var d=ee[we];if(!d)return m.niceprint(v.withUsage(a,
null));if("function"===typeof d)return d(a);a=m.niceprint(m.realmult(d*xe,a),200<d?m._helper.angleroundingfactor:null);return-1===a.indexOf("i*")?a+yd:"("+a+")"+yd};m.complex=function(a,d){return{ctype:"number",value:{real:a,imag:d}}};m.real=function(a){return{ctype:"number",value:{real:a,imag:0}}};m.zero=m.real(0);m.one=m.real(1);m.infinity=m.complex(Infinity,Infinity);m.nan=m.complex(NaN,NaN);m._helper.input=function(a){return"object"===typeof a?m.complex(+a.r,+a.i):m.real(+a)};m.argmax=function(a,
d){return a.value.real*a.value.real+a.value.imag*a.value.imag<d.value.real*d.value.real+d.value.imag*d.value.imag?d:a};m.max=function(a,d){return{ctype:"number",value:{real:Math.max(a.value.real,d.value.real),imag:Math.max(a.value.imag,d.value.imag)}}};m.min=function(a,d){return{ctype:"number",value:{real:Math.min(a.value.real,d.value.real),imag:Math.min(a.value.imag,d.value.imag)}}};m.add=function(a,d){return{ctype:"number",value:{real:a.value.real+d.value.real,imag:a.value.imag+d.value.imag}}};
m.sub=function(a,d){return{ctype:"number",value:{real:a.value.real-d.value.real,imag:a.value.imag-d.value.imag}}};m.neg=function(a){return{ctype:"number",value:{real:-a.value.real,imag:-a.value.imag}}};m.re=function(a){return{ctype:"number",value:{real:a.value.real,imag:0}}};m.im=function(a){return{ctype:"number",value:{real:a.value.imag,imag:0}}};m.conjugate=function(a){return{ctype:"number",value:{real:a.value.real,imag:-a.value.imag}}};m.round=function(a){return{ctype:"number",value:{real:Math.round(a.value.real),
imag:Math.round(a.value.imag)}}};m.ceil=function(a){return{ctype:"number",value:{real:Math.ceil(a.value.real),imag:Math.ceil(a.value.imag)}}};m.floor=function(a){return{ctype:"number",value:{real:Math.floor(a.value.real),imag:Math.floor(a.value.imag)}}};m.mult=function(a,d){return{ctype:"number",value:{real:a.value.real*d.value.real-a.value.imag*d.value.imag,imag:a.value.real*d.value.imag+a.value.imag*d.value.real}}};m.realmult=function(a,d){return{ctype:"number",value:{real:a*d.value.real,imag:a*
d.value.imag}}};m.multiMult=function(a){var d=a[0];if("number"!==d.ctype)return g;for(var b=1;b<a.length;b++){if("number"!==a[b].ctype)return g;d=m.mult(d,a[b])}return d};m.abs2=function(a){return{ctype:"number",value:{real:a.value.real*a.value.real+a.value.imag*a.value.imag,imag:0}}};m.abs=function(a){return m.sqrt(m.abs2(a))};m.inv=function(a){var d=a.value.real*a.value.real+a.value.imag*a.value.imag;return{ctype:"number",value:{real:a.value.real/d,imag:-a.value.imag/d}}};m.div=function(a,d){var b=
a.value.real;a=a.value.imag;var c=d.value.real;d=d.value.imag;var f=c*c+d*d;return{ctype:"number",value:{real:(b*c+a*d)/f,imag:(a*c-b*d)/f}}};m.eps=1E-10;m.epsbig=1E-6;m.snap=function(a){var d=a.value.real;a=a.value.imag;Math.floor(d+m.eps)!==Math.floor(d-m.eps)&&(d=Math.round(d));Math.floor(a+m.eps)!==Math.floor(a-m.eps)&&(a=Math.round(a));return{ctype:"number",value:{real:d,imag:a}}};m.exp=function(a){var d=Math.exp(a.value.real);return{ctype:"number",value:{real:d*Math.cos(a.value.imag),imag:d*
Math.sin(a.value.imag)}}};m.cos=function(a){var d=a.value.real;a=a.value.imag;var b=Math.exp(a),c=b*Math.sin(-d),f=b*Math.cos(-d);b=Math.exp(-a);return{ctype:"number",value:{real:(f+b*Math.cos(d))/2,imag:(c+b*Math.sin(d))/2}}};m.sin=function(a){var d=a.value.real;a=a.value.imag;var b=Math.exp(a),c=b*Math.sin(-d),f=b*Math.cos(-d);b=Math.exp(-a);return{ctype:"number",value:{real:-(c-b*Math.sin(d))/2,imag:(f-b*Math.cos(d))/2}}};m.tan=function(a){var d=m.sin(a);a=m.cos(a);return m.div(d,a)};m.arccos=
function(a){var d=m.mult(a,m.neg(a));d=m.sqrt(m.add(m.real(1),d));a=m.add(m.mult(a,m.complex(0,1)),d);a=m.add(m.mult(m.log(a),m.complex(0,1)),m.real(.5*Math.PI));return v.withUsage(a,"Angle")};m.arcsin=function(a){var d=m.mult(a,m.neg(a));d=m.sqrt(m.add(m.real(1),d));a=m.add(m.mult(a,m.complex(0,1)),d);a=m.mult(m.log(a),m.complex(0,-1));return v.withUsage(a,"Angle")};m.arctan=function(a){var d=m.log(m.add(m.mult(a,m.complex(0,-1)),m.real(1)));a=m.log(m.add(m.mult(a,m.complex(0,1)),m.real(1)));d=m.mult(m.sub(d,
a),m.complex(0,.5));return v.withUsage(d,"Angle")};m.arctan2=function(a,d){if(void 0===d)var b=m.real(Math.atan2(a.value.imag,a.value.real));else m._helper.isReal(a)&&m._helper.isReal(d)?b=m.real(Math.atan2(d.value.real,a.value.real)):(b=m.add(a,m.mult(m.complex(0,1),d)),a=m.sqrt(m.add(m.mult(a,a),m.mult(d,d))),b=m.mult(m.complex(0,-1),m.log(m.div(b,a))));return v.withUsage(b,"Angle")};m.sqrt=function(a){var d=a.value.real,b=a.value.imag;a=Math.sqrt(Math.sqrt(d*d+b*b));d=Math.atan2(b,d);return{ctype:"number",
value:{real:a*Math.cos(d/2),imag:a*Math.sin(d/2)}}};m.powRealExponent=function(a,d){var b=a.value.real,c=a.value.imag;a=Math.pow(Math.sqrt(b*b+c*c),d);b=Math.atan2(c,b);return{ctype:"number",value:{real:a*Math.cos(b*d),imag:a*Math.sin(b*d)}}};m.log=function(a){var d=a.value.real;a=a.value.imag;var b=Math.sqrt(d*d+a*a),c=Math.atan2(a,d);0>a&&(c+=2*Math.PI);0===a&&0>d&&(c=Math.PI);c>Math.PI&&(c-=2*Math.PI);return m.snap({ctype:"number",value:{real:Math.log(b),imag:c}})};m.pow=function(a,d){return m._helper.isZero(d)?
m.one:m._helper.isZero(a)?m.zero:m._helper.isReal(d)?m.powRealExponent(a,d.value.real):m.exp(m.mult(m.log(a),d))};m.mod=function(a,d){var b=a.value.real,c=d.value.real;a=a.value.imag;d=d.value.imag;b-=Math.floor(b/c)*c;a-=Math.floor(a/d)*d;0===c&&(b=0);0===d&&(a=0);return m.snap({ctype:"number",value:{real:b,imag:a}})};m._helper.seed="NO";m._helper.seedrandom=function(a){a-=Math.floor(a);m._helper.seed=.8*a+.1};m._helper.rand=function(){if("NO"===m._helper.seed)return Math.random();var a=m._helper.seed;
a=1E3*Math.sin(1E3*a);a-=Math.floor(a);return m._helper.seed=a};m._helper.randnormal=function(){var a=m._helper.rand(),d=m._helper.rand();return Math.sqrt(-2*Math.log(a))*Math.cos(2*Math.PI*d)};m._helper.isEqual=function(a,d){return a.value.real===d.value.real&&a.value.imag===d.value.imag};m._helper.isLessThan=function(a,d){return a.value.real<d.value.real||a.value.real===d.value.real&&a.value.imag<d.value.imag};m._helper.compare=function(a,d){return m._helper.isLessThan(a,d)?-1:m._helper.isEqual(a,
d)?0:1};m._helper.isAlmostEqual=function(a,d,b){var c=m.eps;"undefined"!==typeof b&&(c=b);b=a.value.real-d.value.real;a=a.value.imag-d.value.imag;return b<c&&b>-c&&a<c&&a>-c};m._helper.isZero=function(a){return 0===a.value.real&&0===a.value.imag};m._helper.isAlmostZero=function(a){var d=a.value.real;a=a.value.imag;return d<m.eps&&d>-m.eps&&a<m.eps&&a>-m.eps};m._helper.isReal=function(a){return 0===a.value.imag};m._helper.isAlmostReal=function(a){a=a.value.imag;return a<m.epsbig&&a>-m.epsbig};m._helper.isNaN=
function(a){return isNaN(a.value.real)||isNaN(a.value.imag)};m._helper.isFinite=function(a){return isFinite(a.value.real)&&isFinite(a.value.imag)};m._helper.isAlmostImag=function(a){a=a.value.real;return a<m.epsbig&&a>-m.epsbig};m._helper.z3a=m.complex(-.5,.5*Math.sqrt(3));m._helper.z3b=m.complex(-.5,-.5*Math.sqrt(3));m._helper.cub1={ctype:"list",value:[m.one,m.one,m.one]};m._helper.cub2={ctype:"list",value:[m._helper.z3a,m.one,m._helper.z3b]};m._helper.cub3={ctype:"list",value:[m._helper.z3b,m.one,
m._helper.z3a]};m.solveCubic=function(a,d,b,c){a=m._helper.solveCubicHelper(a,d,b,c);return[f.scalproduct(m._helper.cub1,a),f.scalproduct(m._helper.cub2,a),f.scalproduct(m._helper.cub3,a)]};m._helper.solveCubicHelper=function(a,d,b,c){var B=a.value.real;a=a.value.imag;var g=d.value.real;d=d.value.imag;var H=b.value.real,e=b.value.imag,h=c.value.real,k=c.value.imag,l=B*H-a*e;b=B*e+a*H;c=4*l-(g*g-d*d);var n=4*b-2*g*d,p=B*g-a*d,q=B*d+a*g,r=c*H-n*e-18*(p*h-q*k);n=c*e+n*H-18*(p*k+q*h);c=27*(B*B-a*a);var t=
54*a*B,u=c*h-t*k,v=c*k+t*h,w=g*g-d*d,x=2*g*d,z=w*g-x*d,A=w*d+x*g,y=u+4*z;t=v+4*A;c=27*(r*H-n*e+y*h-t*k);n=27*(r*e+n*H+y*k+t*h);y=Math.sqrt(Math.sqrt(c*c+n*n));t=Math.atan2(n,c);n=y*Math.sin(t/2);c=y*Math.cos(t/2);z=-2*z+9*(p*H-q*e)-u+(c*B-n*a);A=-2*A+9*(p*e+q*H)-v+(c*a+n*B);c=Math.exp(Math.log(Math.sqrt(z*z+A*A))/3);H=Math.atan2(A,z);t=c*Math.sin(H/3);n=c*Math.cos(H/3);c*=c;H*=2;l=2*w-6*l;b=2*x-6*b;x=-1.5874010519681996*(g*n-d*t);g=-1.5874010519681996*(g*t+d*n);d=1.2599210498948732*c*Math.cos(H/3);
H=1.2599210498948732*c*Math.sin(H/3);c=4.762203155904599*(n*B-t*a);n=4.762203155904599*(n*a+t*B);B=c*c+n*n;t=(-l*n+b*c)/B;l=(l*c+b*n)/B;b=t;t=(-x*n+g*c)/B;x=(x*c+g*n)/B;g=t;t=(-d*n+H*c)/B;d=(d*c+H*n)/B;H=t;return f.turnIntoCSList([m.complex(l,b),m.complex(x,g),m.complex(d,H)])};m._helper.getRangeRand=function(a,d){return Math.random()*(d-a)+a};m.getRandReal=function(a,d){a=m._helper.getRangeRand(a,d);return m.real(a)};m.getRandComplex=function(a,d){var b=m._helper.getRangeRand(a,d);a=m._helper.getRangeRand(a,
d);return m.complex(b,a)};var f={_helper:{},turnIntoCSList:function(a){return{ctype:"list",value:a}}};f.EMPTY=f.turnIntoCSList([]);f.asList=function(a){return"list"===a.ctype?a:"number"===a.ctype||"boolean"===a.ctype||"geo"===a.ctype?f.turnIntoCSList([a]):f.EMPTY};f.realVector=function(a){for(var d=[],b=0;b<a.length;b++)d[b]={ctype:"number",value:{real:a[b],imag:0}};return{ctype:"list",value:d}};f._helper.unitvector=function(a,d){a=f.zerovector(a);a.value[Math.floor(d.value.real-1)]=m.real(1);return a};
f.idMatrix=function(a){for(var d=f.zeromatrix(a,a),b=m.real(1),c=0;c<a.value.real;c++)d.value[c].value[c]=b;return d};f._helper.flippedidMatrix=function(a){for(var d=f.zeromatrix(a,a),b=m.real(1),c=0;c<a.value.real;c++)d.value[c].value[a.value.real-c-1]=b;return d};f.println=function(a){for(var d=[],b=0;b<a.value.length;b++)if("number"===a.value[b].ctype)d[b]=m.niceprint(a.value[b]);else if("list"===a.value[b].ctype)f.println(a.value[b]);else return g;"number"===a.value[0].ctype&&console.log(d)};
f.matrix=function(a){return f.turnIntoCSList(a.map(f.turnIntoCSList))};f.realMatrix=function(a){for(var d=a.length,b=Array(d),c=0;c<d;c++)b[c]=f.realVector(a[c]);return f.turnIntoCSList(b)};f.ex=f.realVector([1,0,0]);f.ey=f.realVector([0,1,0]);f.ez=f.realVector([0,0,1]);f.linfty=f.realVector([0,0,1]);f.ii=f.turnIntoCSList([m.complex(1,0),m.complex(0,1),m.complex(0,0)]);f.jj=f.turnIntoCSList([m.complex(1,0),m.complex(0,-1),m.complex(0,0)]);f.fundDual=f.realMatrix([[1,0,0],[0,1,0],[0,0,0]]);f.fund=
f.realMatrix([[0,0,0],[0,0,0],[0,0,1]]);f.sequence=function(a,d){var b=[],c=0;for(a=Math.round(a.value.real);a<Math.round(d.value.real)+1;a++)b[c]={ctype:"number",value:{real:a,imag:0}},c++;return{ctype:"list",value:b}};f.pairs=function(a){for(var d=[],b=0;b<a.value.length-1;b++)for(var c=b+1;c<a.value.length;c++)d.push({ctype:"list",value:[a.value[b],a.value[c]]});return{ctype:"list",value:d}};f.triples=function(a){for(var d=[],b=0;b<a.value.length-2;b++)for(var c=b+1;c<a.value.length-1;c++)for(var f=
c+1;f<a.value.length;f++)d.push({ctype:"list",value:[a.value[b],a.value[c],a.value[f]]});return{ctype:"list",value:d}};f.cycle=function(a){for(var d=[],b=0;b<a.value.length-1;b++)d[b]={ctype:"list",value:[a.value[b],a.value[b+1]]};d.push({ctype:"list",value:[a.value[a.value.length-1],a.value[0]]});return{ctype:"list",value:d}};f.consecutive=function(a){for(var d=[],b=0;b<a.value.length-1;b++)d[b]={ctype:"list",value:[a.value[b],a.value[b+1]]};return{ctype:"list",value:d}};f.reverse=function(a){for(var d=
Array(a.value.length),b=a.value.length-1,c=0;0<=b;b--,c++)d[c]=a.value[b];return{ctype:"list",value:d}};f.directproduct=function(a,d){for(var b=[],c=0;c<a.value.length;c++)for(var f=0;f<d.value.length;f++)b.push({ctype:"list",value:[a.value[c],d.value[f]]});return{ctype:"list",value:b}};f.concat=function(a,d){for(var b=[],c=0;c<a.value.length;c++)b.push(a.value[c]);for(a=0;a<d.value.length;a++)b.push(d.value[a]);return{ctype:"list",value:b}};f.prepend=function(a,d){var b=[];b[0]=a;for(a=0;a<d.value.length;a++)b[a+
1]=d.value[a];return{ctype:"list",value:b}};f.append=function(a,d){for(var b=[],c=0;c<a.value.length;c++)b[c]=a.value[c];b.push(d);return{ctype:"list",value:b}};f.contains=function(a,d){for(var b=0;b<a.value.length;b++)if(E.equals(a.value[b],d).value)return{ctype:"boolean",value:!0};return{ctype:"boolean",value:!1}};f.common=function(a,d){for(var b=[],c=0,f=0;f<a.value.length;f++){for(var g=!1,e=a.value[f],h=0;h<d.value.length;h++)g=g||E.equals(e,d.value[h]).value;g&&(b[c]=a.value[f],c++)}return{ctype:"list",
value:b}};f.remove=function(a,d){for(var b=[],c=0,f=0;f<a.value.length;f++){for(var g=!1,e=a.value[f],h=0;h<d.value.length;h++)g=g||E.equals(e,d.value[h]).value;g||(b[c]=a.value[f],c++)}return{ctype:"list",value:b}};f.sort1=function(a){a=a.value.slice();a.sort(v.compare);return f.turnIntoCSList(a)};f._helper.isEqual=function(a,d){return f.equals(a,d).value};f._helper.isLessThan=function(a,d){for(var b=a.value.length,c=d.value.length,f=0;!(f>=b||f>=c)&&v.isEqual(a.value[f],d.value[f]);)f++;return f===
b&&f<c?!0:f===c&&f<b||f===b&&f===c?!1:v.isLessThan(a.value[f],d.value[f])};f._helper.compare=function(a,d){return f._helper.isLessThan(a,d)?-1:f._helper.isEqual(a,d)?0:1};f.equals=function(a,d){if(a.value.length!==d.value.length)return{ctype:"boolean",value:!1};for(var b=!0,c=0;c<a.value.length;c++){var g=a.value[c],e=d.value[c];b="list"===g.ctype&&"list"===e.ctype?b&&f.equals(g,e).value:b&&ic([g,e],[]).value}return{ctype:"boolean",value:b}};f.almostequals=function(a,d){if(a.value.length!==d.value.length)return{ctype:"boolean",
value:!1};for(var b=!0,c=0;c<a.value.length;c++){var g=a.value[c],e=d.value[c];b="list"===g.ctype&&"list"===e.ctype?b&&f.almostequals(g,e).value:b&&jc([g,e],[]).value}return{ctype:"boolean",value:b}};f._helper.isAlmostReal=function(a){for(var d=!0,b=0;b<a.value.length;b++){var c=a.value[b];d="list"===c.ctype?d&&f._helper.isAlmostReal(c):d&&m._helper.isAlmostReal(c)}return d};f._helper.isAlmostZero=function(a){for(var d=0;d<a.value.length;d++){var b=a.value[d];if("list"===b.ctype){if(!f._helper.isAlmostZero(b))return!1}else if(!m._helper.isAlmostZero(b))return!1}return!0};
f._helper.isNaN=function(a){for(var d=!1,b=0;b<a.value.length;b++){var c=a.value[b];d="list"===c.ctype?d||f._helper.isNaN(c):d||m._helper.isNaN(c)}return d};f.set=function(a){var d=[],b=0;a=a.value.slice();a.sort(v.compare);for(var c=0;c<a.length;c++)0!==c&&ic([d[d.length-1],a[c]],[]).value||(d[b]=a[c],b++);return{ctype:"list",value:d}};f.maxval=function(a){for(var d=m.zero,b=0;b<a.value.length;b++){var c=a.value[b];"number"===c.ctype&&(d=m.argmax(d,c));"list"===c.ctype&&(d=m.argmax(d,f.maxval(c)))}return d};
f.maxIndex=function(a,d,b){var c=0;void 0!==b&&(c=b);b=c;for(var B=d(a.value[c]).value.real;c<a.value.length;++c){var f=d(a.value[c]).value.real;f>B&&(b=c,B=f)}return b};f.normalizeMax=function(a){var d=m.inv(f.maxval(a));return m._helper.isFinite(d)?f.scalmult(d,a):a};f.normalizeZ=function(a){var d=m.inv(a.value[2]);return f.scalmult(d,a)};f.dehom=function(a){a=a.value.slice();var d=a.length-1,b=m.inv(a[d]);a.length=d;for(var c=0;c<d;++c)a[c]=m.mult(b,a[c]);return f.turnIntoCSList(a)};f.normalizeAbs=
function(a){var d=m.inv(f.abs(a));return f.scalmult(d,a)};f.max=function(a,d){if(a.value.length!==d.value.length)return g;for(var b=[],c=0;c<a.value.length;c++)b[c]=v.max(a.value[c],d.value[c]);return{ctype:"list",value:b}};f.min=function(a,d){if(a.value.length!==d.value.length)return g;for(var b=[],c=0;c<a.value.length;c++)b[c]=v.min(a.value[c],d.value[c]);return{ctype:"list",value:b}};f.scaldiv=function(a,d){if("number"!==a.ctype)return g;for(var b=[],c=0;c<d.value.length;c++){var e=d.value[c];
b[c]="number"===e.ctype?v.div(e,a):"list"===e.ctype?f.scaldiv(a,e):g}return{ctype:"list",value:b}};f.scalmult=function(a,d){if("number"!==a.ctype)return g;for(var b=[],c=0;c<d.value.length;c++){var e=d.value[c];b[c]="number"===e.ctype?v.mult(e,a):"list"===e.ctype?f.scalmult(a,e):g}return{ctype:"list",value:b}};f.add=function(a,d){if(a.value.length!==d.value.length)return g;for(var b=[],c=0;c<a.value.length;c++){var e=a.value[c],h=d.value[c];b[c]="number"===e.ctype&&"number"===h.ctype?v.add(e,h):"list"===
e.ctype&&"list"===h.ctype?f.add(e,h):g}return{ctype:"list",value:b}};f.sub=function(a,d){if(a.value.length!==d.value.length)return g;for(var b=[],c=0;c<a.value.length;c++){var e=a.value[c],h=d.value[c];b[c]="number"===e.ctype&&"number"===h.ctype?m.sub(e,h):"list"===e.ctype&&"list"===h.ctype?f.sub(e,h):g}return{ctype:"list",value:b}};f.abs2=function(a){for(var d=0,b=0;b<a.value.length;b++){var c=a.value[b];if("number"===c.ctype)d+=m.abs2(c).value.real;else if("list"===c.ctype)d+=f.abs2(c).value.real;
else return g}return{ctype:"number",value:{real:d,imag:0}}};f.abs=function(a){return m.sqrt(f.abs2(a))};f.normalizeMaxXX=function(a){for(var d=-1E4,b=m.real(1),c=0;c<a.value.length;c++){var g=m.abs(a.value[c]);g.value.real>d&&(b=a.value[c],d=g.value.real)}return f.scaldiv(b,a)};f.recursive=function(a,d){for(var b=[],c=0;c<a.value.length;c++){var e=D(a.value[c]);b[c]="number"===e.ctype?m[d](e):"list"===e.ctype?f[d](e):g}return{ctype:"list",value:b}};f.re=function(a){return f.recursive(a,"re")};f.neg=
function(a){return f.recursive(a,"neg")};f.im=function(a){return f.recursive(a,"im")};f.conjugate=function(a){return f.recursive(a,"conjugate")};f.transjugate=function(a){return f.transpose(f.conjugate(a))};f.round=function(a){return f.recursive(a,"round")};f.ceil=function(a){return f.recursive(a,"ceil")};f.floor=function(a){return f.recursive(a,"floor")};f._helper.colNumb=function(a){if("list"!==a.ctype)return-1;for(var d=-1,b=0;b<a.value.length;b++){if("list"!==a.value[b].ctype)return-1;if(0===
b)d=a.value[b].value.length;else if(d!==a.value[b].value.length)return-1}return d};f._helper.isNumberVecN=function(a,d){if("list"!==a.ctype||a.value.length!==d)return!1;for(d=0;d<a.value.length;d++)if("number"!==a.value[d].ctype)return!1;return!0};f.isNumberVector=function(a){if("list"!==a.ctype)return{ctype:"boolean",value:!1};for(var d=0;d<a.value.length;d++)if("number"!==a.value[d].ctype)return{ctype:"boolean",value:!1};return{ctype:"boolean",value:!0}};f.isNumberVectorN=function(a,d){if("list"!==
a.ctype)return{ctype:"boolean",value:!1};if(a.value)for(d=0;d<a.value.length;d++)if("number"!==a.value[d].ctype)return{ctype:"boolean",value:!1};return{ctype:"boolean",value:!0}};f.isNumberMatrix=function(a){if(-1===f._helper.colNumb(a))return{ctype:"boolean",value:!1};for(var d=0;d<a.value.length;d++)if(!f.isNumberVector(a.value[d]).value)return{ctype:"boolean",value:!1};return{ctype:"boolean",value:!0}};f._helper.isNumberMatrixMN=function(a,d,b){return f.isNumberMatrix(a).value&&a.value.length===
d&&a.value[0].value.length===b};f.scalproduct=function(a,d){if(a.value.length!==d.value.length)return g;for(var b={ctype:"number",value:{real:0,imag:0}},c=0;c<d.value.length;c++){var f=a.value[c],e=d.value[c];if("number"===f.ctype&&"number"===e.ctype)b=m.add(m.mult(f,e),b);else return g}return b};f.sesquilinearproduct=function(a,d){if(a.value.length!==d.value.length)return g;for(var b=0,c=0,f=0;f<d.value.length;f++){var e=a.value[f].value,h=d.value[f].value;b+=e.real*h.real+e.imag*h.imag;c+=e.real*
h.imag-e.imag*h.real}return m.complex(b,c)};f.normSquared=function(a){for(var d=0,b=0;b<a.value.length;b++){var c=a.value[b].value;d+=c.real*c.real+c.imag*c.imag}return m.real(d)};f.productMV=function(a,d){if(a.value[0].value.length!==d.value.length)return g;for(var b=[],c=0;c<a.value.length;c++){for(var e={ctype:"number",value:{real:0,imag:0}},h=a.value[c],k=0;k<d.value.length;k++){var l=h.value[k],n=d.value[k];if("number"===l.ctype&&"number"===n.ctype)e=m.add(m.mult(l,n),e);else return g}b[c]=e}return f.turnIntoCSList(b)};
f.productVM=function(a,d){if(a.value.length!==d.value.length)return g;for(var b=[],c=0;c<d.value[0].value.length;c++){for(var e={ctype:"number",value:{real:0,imag:0}},h=0;h<a.value.length;h++){var k=a.value[h],l=d.value[h].value[c];if("number"===k.ctype&&"number"===l.ctype)e=m.add(m.mult(k,l),e);else return g}b[c]=e}return f.turnIntoCSList(b)};f.productMM=function(a,d){if(a.value[0].value.length!==d.value.length)return g;for(var b=[],c=0;c<a.value.length;c++){var e=f.productVM(a.value[c],d);b[c]=
e}return f.turnIntoCSList(b)};f.mult=function(a,d){return a.value.length===d.value.length&&f.isNumberVector(a).value&&f.isNumberVector(d).value?f.scalproduct(a,d):f.isNumberMatrix(a).value&&d.value.length===a.value[0].value.length&&f.isNumberVector(d).value?f.productMV(a,d):f.isNumberMatrix(d).value&&a.value.length===d.value.length&&f.isNumberVector(a).value?f.productVM(a,d):f.isNumberMatrix(a).value&&f.isNumberMatrix(d).value&&d.value.length===a.value[0].value.length?f.productMM(a,d):g};f.projectiveDistMinScal=
function(a,d){var b=f.abs(a),c=f.abs(d);if(0===b.value.real||0===c.value.real)return 0;var g=f.conjugate(d);g=f.scalproduct(a,g);g=m._helper.isAlmostZero(g)?m.real(1):m.div(g,m.abs(g));a=f.scaldiv(b,a);d=f.scaldiv(c,d);d=f.scalmult(g,d);c=f.abs(f.add(a,d));d=f.abs(f.sub(a,d));return Math.min(c.value.real,d.value.real)};f.conicDist=function(a,d){a=Ca(a);d=Ca(d);return f.projectiveDistMinScal(a,d)};f.crossOperator=function(a){var d=a.value[0],b=a.value[1];a=a.value[2];return f.turnIntoCSList([f.turnIntoCSList([m.zero,
m.neg(a),b]),f.turnIntoCSList([a,m.zero,m.neg(d)]),f.turnIntoCSList([m.neg(b),d,m.zero])])};f.cross=function(a,d){var b=m.sub(m.mult(a.value[1],d.value[2]),m.mult(a.value[2],d.value[1])),c=m.sub(m.mult(a.value[2],d.value[0]),m.mult(a.value[0],d.value[2]));a=m.sub(m.mult(a.value[0],d.value[1]),m.mult(a.value[1],d.value[0]));return f.turnIntoCSList([b,c,a])};f.crossratio3harm=function(a,d,b,c,g){var B=f.det3(a,b,g),e=f.det3(d,c,g);a=f.det3(a,c,g);d=f.det3(d,b,g);B=m.mult(B,e);e=m.mult(a,d);return f.turnIntoCSList([B,
e])};f.crossratio3=function(a,d,b,c,g){a=f.crossratio3harm(a,d,b,c,g);return m.div(a.value[0],a.value[1])};f.veronese=function(a){var d=m.mult(a.value[0],a.value[0]),b=m.mult(a.value[1],a.value[1]),c=m.mult(a.value[2],a.value[2]),g=m.mult(a.value[0],a.value[1]),e=m.mult(a.value[0],a.value[2]);a=m.mult(a.value[1],a.value[2]);return f.turnIntoSCList([d,b,c,g,e,a])};f.matrixFromVeronese=function(a){var d=a.value[0],b=a.value[1],c=a.value[2],g=m.realmult(.5,a.value[3]),e=m.realmult(.5,a.value[4]);a=m.realmult(.5,
a.value[5]);return f.turnIntoCSList([f.turnIntoCSList([d,g,e]),f.turnIntoCSList([g,b,a]),f.turnIntoCSList([e,a,c])])};f.det2=function(a,d){var b=m.mult(a.value[0],d.value[1]);return b=m.sub(b,m.mult(a.value[1],d.value[0]))};f.det3=function(a,d,b){return m.complex(a.value[0].value.real*d.value[1].value.real*b.value[2].value.real-a.value[0].value.imag*d.value[1].value.imag*b.value[2].value.real-a.value[0].value.imag*d.value[1].value.real*b.value[2].value.imag-a.value[0].value.real*d.value[1].value.imag*
b.value[2].value.imag+a.value[2].value.real*d.value[0].value.real*b.value[1].value.real-a.value[2].value.imag*d.value[0].value.imag*b.value[1].value.real-a.value[2].value.imag*d.value[0].value.real*b.value[1].value.imag-a.value[2].value.real*d.value[0].value.imag*b.value[1].value.imag+a.value[1].value.real*d.value[2].value.real*b.value[0].value.real-a.value[1].value.imag*d.value[2].value.imag*b.value[0].value.real-a.value[1].value.imag*d.value[2].value.real*b.value[0].value.imag-a.value[1].value.real*
d.value[2].value.imag*b.value[0].value.imag-a.value[0].value.real*d.value[2].value.real*b.value[1].value.real+a.value[0].value.imag*d.value[2].value.imag*b.value[1].value.real+a.value[0].value.imag*d.value[2].value.real*b.value[1].value.imag+a.value[0].value.real*d.value[2].value.imag*b.value[1].value.imag-a.value[2].value.real*d.value[1].value.real*b.value[0].value.real+a.value[2].value.imag*d.value[1].value.imag*b.value[0].value.real+a.value[2].value.imag*d.value[1].value.real*b.value[0].value.imag+
a.value[2].value.real*d.value[1].value.imag*b.value[0].value.imag-a.value[1].value.real*d.value[0].value.real*b.value[2].value.real+a.value[1].value.imag*d.value[0].value.imag*b.value[2].value.real+a.value[1].value.imag*d.value[0].value.real*b.value[2].value.imag+a.value[1].value.real*d.value[0].value.imag*b.value[2].value.imag,-a.value[0].value.imag*d.value[1].value.imag*b.value[2].value.imag+a.value[0].value.imag*d.value[1].value.real*b.value[2].value.real+a.value[0].value.real*d.value[1].value.real*
b.value[2].value.imag+a.value[0].value.real*d.value[1].value.imag*b.value[2].value.real-a.value[2].value.imag*d.value[0].value.imag*b.value[1].value.imag+a.value[2].value.imag*d.value[0].value.real*b.value[1].value.real+a.value[2].value.real*d.value[0].value.real*b.value[1].value.imag+a.value[2].value.real*d.value[0].value.imag*b.value[1].value.real-a.value[1].value.imag*d.value[2].value.imag*b.value[0].value.imag+a.value[1].value.imag*d.value[2].value.real*b.value[0].value.real+a.value[1].value.real*
d.value[2].value.real*b.value[0].value.imag+a.value[1].value.real*d.value[2].value.imag*b.value[0].value.real+a.value[0].value.imag*d.value[2].value.imag*b.value[1].value.imag-a.value[0].value.imag*d.value[2].value.real*b.value[1].value.real-a.value[0].value.real*d.value[2].value.real*b.value[1].value.imag-a.value[0].value.real*d.value[2].value.imag*b.value[1].value.real+a.value[2].value.imag*d.value[1].value.imag*b.value[0].value.imag-a.value[2].value.imag*d.value[1].value.real*b.value[0].value.real-
a.value[2].value.real*d.value[1].value.real*b.value[0].value.imag-a.value[2].value.real*d.value[1].value.imag*b.value[0].value.real+a.value[1].value.imag*d.value[0].value.imag*b.value[2].value.imag-a.value[1].value.imag*d.value[0].value.real*b.value[2].value.real-a.value[1].value.real*d.value[0].value.real*b.value[2].value.imag-a.value[1].value.real*d.value[0].value.imag*b.value[2].value.real)};f.det4m=function(a){var d=a.value,b=d[0].value,c=b[0].value,f=+c.real,g=+c.imag;c=b[1].value;var e=+c.real,
h=+c.imag;c=b[2].value;var k=+c.real,l=+c.imag;c=b[3].value;var n=+c.real,p=+c.imag;b=d[1].value;c=b[0].value;var q=+c.real,r=+c.imag;c=b[1].value;var t=+c.real,u=+c.imag;c=b[2].value;var v=+c.real,w=+c.imag;c=b[3].value;b=+c.real;c=+c.imag;a=f*t-g*u-e*q+h*r;var x=f*u+g*t-e*r-h*q,z=f*v-g*w-k*q+l*r,A=f*w+g*v-k*r-l*q,y=f*b-g*c-n*q+p*r,C=f*c+g*b-n*r-p*q,D=e*v-h*w-k*t+l*u,E=e*w+h*v-k*u-l*t,F=e*b-h*c-n*t+p*u,G=e*c+h*b-n*u-p*t,J=k*b-l*c-n*v+p*w,I=k*c+l*b-n*w-p*v;b=d[2].value;c=b[0].value;f=+c.real;g=+c.imag;
c=b[1].value;e=+c.real;h=+c.imag;c=b[2].value;k=+c.real;l=+c.imag;c=b[3].value;n=+c.real;p=+c.imag;b=d[3].value;c=b[0].value;q=+c.real;r=+c.imag;c=b[1].value;t=+c.real;u=+c.imag;c=b[2].value;v=+c.real;w=+c.imag;c=b[3].value;b=+c.real;c=+c.imag;d=f*t-g*u-e*q+h*r;var K=f*u+g*t-e*r-h*q,L=f*v-g*w-k*q+l*r,M=f*w+g*v-k*r-l*q,O=f*b-g*c-n*q+p*r;f=f*c+g*b-n*r-p*q;g=e*v-h*w-k*t+l*u;q=e*w+h*v-k*u-l*t;r=e*b-h*c-n*t+p*u;e=e*c+h*b-n*u-p*t;h=k*b-l*c-n*v+p*w;k=k*c+l*b-n*w-p*v;return m.complex(a*h-x*k-z*r+A*e+y*g-
C*q+D*O-E*f-F*L+G*M+J*d-I*K,a*k+x*h-z*e-A*r+y*q+C*g+D*f+E*O-F*M-G*L+J*K+I*d)};f.eucangle=function(a,d){var b=f.cross(a,f.linfty);a=f.cross(d,f.linfty);d=f.det3(f.ez,b,f.ii);b=f.det3(f.ez,b,f.jj);var c=f.det3(f.ez,a,f.ii);a=f.det3(f.ez,a,f.jj);d=m.div(m.mult(d,a),m.mult(c,b));d=m.log(d);return d=m.mult(d,m.complex(0,.5))};f.zerovector=function(a){a=Math.floor(a.value.real);for(var d=Array(a),b=0;b<a;b++)d[b]=0;return f.realVector(d)};f.zeromatrix=function(a,d){a=Math.floor(a.value.real);for(var b=
Array(a),c=0;c<a;c++)b[c]=f.zerovector(d);return f.turnIntoCSList(b)};f.vandermonde=function(a){for(var d=a.value.length,b=f.zeromatrix(d,d),c=0;c<d;c++)for(var g=0;g<d;g++)b.value[c].value[g]=m.pow(a.value[c],m.real(g-1));return b};f.transpose=function(a){for(var d=[],b=a.value[0].value.length,c=a.value.length,g=0;g<b;g++){for(var e=[],h=0;h<c;h++)e[h]=a.value[h].value[g];d[g]=f.turnIntoCSList(e)}return f.turnIntoCSList(d)};f.column=function(a,d){var b=[],c=a.value.length;d=Math.floor(d.value.real-
1);for(var g=0;g<c;g++)b[g]=a.value[g].value[d];return f.turnIntoCSList(b)};f.row=function(a,d){var b=[],c=a.value[0].value.length;d=Math.floor(d.value.real-1);for(var g=0;g<c;g++)b[g]=a.value[d].value[g];return f.turnIntoCSList(b)};f.adjoint2=function(a){var d=a.value[0].value[0],b=a.value[1].value[0],c=Array(2);c[0]=f.turnIntoCSList([a.value[1].value[1],m.neg(a.value[0].value[1])]);c[1]=f.turnIntoCSList([m.neg(b),d]);return c=f.turnIntoCSList(c)};f.adjoint3=function(a){var d=a.value[0].value;var b=
d[0].value;var c=b.real;var f=b.imag;b=d[1].value;var g=b.real;var e=b.imag;b=d[2].value;var h=b.real;var k=b.imag;d=a.value[1].value;b=d[0].value;var m=b.real;var l=b.imag;b=d[1].value;var n=b.real;var p=b.imag;b=d[2].value;var q=b.real;var r=b.imag;d=a.value[2].value;b=d[0].value;a=b.real;var t=b.imag;b=d[1].value;var u=b.real;var v=b.imag;b=d[2].value;d=b.real;b=b.imag;return{ctype:"list",value:[{ctype:"list",value:[{ctype:"number",value:{real:n*d-q*u-p*b+r*v,imag:n*b-q*v-u*r+d*p}},{ctype:"number",
value:{real:-g*d+h*u+e*b-k*v,imag:-g*b+h*v+u*k-d*e}},{ctype:"number",value:{real:g*q-h*n-e*r+k*p,imag:g*r-h*p-n*k+q*e}}]},{ctype:"list",value:[{ctype:"number",value:{real:-m*d+q*a+l*b-r*t,imag:-m*b+q*t+a*r-d*l}},{ctype:"number",value:{real:c*d-h*a-f*b+k*t,imag:c*b-h*t-a*k+d*f}},{ctype:"number",value:{real:-c*q+h*m+f*r-k*l,imag:-c*r+h*l+m*k-q*f}}]},{ctype:"list",value:[{ctype:"number",value:{real:m*u-n*a-l*v+p*t,imag:m*v-n*t-a*p+u*l}},{ctype:"number",value:{real:-c*u+g*a+f*v-e*t,imag:-c*v+g*t+a*e-
u*f}},{ctype:"number",value:{real:c*n-g*m-f*p+e*l,imag:c*p-g*l-m*e+n*f}}]}]}};f.inverse=function(a){var d=a.value.length;if(d!==a.value[0].value.length)return console.log("Inverse works only for square matrices"),g;if(2===d)return f.scaldiv(f.det(a),f.adjoint2(a));if(3===d)return f.scaldiv(f.det(a),f.adjoint3(a));d=f.LUdecomp(a);a=a.value.length;var b=m.real(0),c=m.real(1),e=f.zerovector(m.real(a));e.value[0]=c;for(var h=Array(a),k=0;k<a;k++)h[k]=f._helper.LUsolve(d,e),e.value[k]=b,e.value[k+1]=c;
h=f.turnIntoCSList(h);return h=f.transpose(h)};f.linearsolve=function(a,d){return 2===a.value.length?f.linearsolveCramer2(a,d):3===a.value.length?f.linearsolveCramer3(a,d):f.LUsolve(a,d)};f.getDiag=function(a){if(a.value.length!==a.value[0].value.length)return g;for(var d=Array(a.value.length),b=0;b<a.value.length;b++)d[b]=a.value[b].value[b];return f.turnIntoCSList(d)};f.getSubDiag=function(a){if(a.value.length!==a.value[0].value.length)return g;for(var d=Array(a.value.length-1),b=0;b<a.value.length-
1;b++)d[b]=a.value[b+1].value[b];return f.turnIntoCSList(d)};f.eig2=function(a){var d=m.add(a.value[0].value[0],a.value[1].value[1]);a=f.det2(a.value[0],a.value[1]);var b=m.mult(d,d),c=d=m.mult(d,m.real(.5));a=m.sqrt(m.sub(m.div(b,m.real(4)),a));d=m.add(d,a);c=m.sub(c,a);return f.turnIntoCSList([d,c])};f.eig=function(a,d){var b=d||!0,c=a,g=m.real(c.value.length);d=g.value.real;m.real(0);c=f._helper.QRIteration(c)[0];c=f.getDiag(c);c=f.sort1(c);g=f.idMatrix(g,g);var e=Array(d);e=f.turnIntoCSList(e);
if(b){var h,k=0,l=!1;for(b=0;b<d;b++){if(l)var n=p.value[k];else{var p=c.value[b];p=f.sub(a,f.scalmult(p,g));p=f.nullSpace(p);n=p.value[0];void 0!==n&&(h=n)}void 0===n&&(n=h);1E-8>f.abs(n).value.real&&0===k&&(n=f._helper.inverseIteration(a,c.value[b]));e.value[b]=f._helper.isAlmostZeroVec(n)?n:f.scaldiv(f.abs(n),n);b<d-1&&((l=1E-6>m.abs(m.sub(c.value[b],c.value[b+1])).value.real)?k++:k=0)}e=f.transpose(e)}return f.turnIntoCSList([c,e])};f._helper.isNormalMatrix=function(a){return 1E-10>f.abs(f.sub(a,
f.transjugate(a))).value.real};f._helper.QRIteration=function(a,d){var b=m.real(a.value.length),c=b.value.real,g=b.value.real;m.real(0);f.idMatrix(b,b);var e=f.zeromatrix(b,b);b=f.idMatrix(b,b);var h=d?d:2500,k=0,l=Array(g);for(d=0;d<h;d++){var n=f._helper.getBlock(a,[g-2,g-1],[g-2,g-1]);var p=f.eig2(n);n=p.value[0];p=p.value[1];f.abs(n);f.abs(p);var q=a.value[g-1].value[g-1];var r=m.abs(m.sub(q,n)).value.real;q=m.abs(m.sub(q,p)).value.real;p=r<q?n:p;n=f.idMatrix(m.real(g),m.real(g));p=f.scalmult(p,
n);n=f.QRdecomp(f.sub(a,p));a=v.mult(n.R,n.Q);a=f.add(a,p);n.Q=f._helper.buildBlockMatrix(n.Q,f.idMatrix(m.real(k),m.real(k)));b=v.mult(b,n.Q);if(1E-48>m.abs2(a.value[a.value.length-1].value[a.value[0].value.length-2]).value.real&&1<g){l[c-k-1]=a.value[g-1].value[g-1];for(d=0;d<g;d++)e.value[g-1].value[d]=a.value[g-1].value[d],e.value[d].value[g-1]=a.value[d].value[g-1];a=f._helper.getBlock(a,[0,g-2],[0,g-2]);k++;g--}if(1===g){e.value[0].value[0]=a.value[0].value[0];break}if(f._helper.isUpperTriangular(a)){for(d=
0;d<g;d++)e.value[d].value[d]=a.value[d].value[d];break}}return[e,b]};f.rank=function(a,d){return f.RRQRdecomp(a,d).rank};f._helper.isAlmostZeroVec=function(a){for(var d=a.value.length,b=0;b<d;b++)if(!m._helper.isAlmostZero(a.value[b]))return!1;return!0};f._helper.isLowerTriangular=function(a){for(var d=a.value.length,b=a.value[0].value.length,c=0;c<d;c++)for(var f=c+1;f<b;f++)if(!m._helper.isAlmostZero(a.value[c].value[f]))return!1;return!0};f._helper.isUpperTriangular=function(a){return f._helper.isLowerTriangular(f.transpose(a))};
f._helper.isAlmostId=function(a){var d=a.value.length,b=m.real(d);if(d!==a.value[0].value.length)return!1;a=f.sub(a,f.idMatrix(b),b);for(b=0;b<d;b++)for(var c=0;c<d;c++)if(1E-16<m.abs(a.value[b].value[c]).value.real)return!1;return!0};f.nullSpace=function(a,d){var b=a.value.length;d=f.RRQRdecomp(f.transjugate(a),d);a=f.transpose(d.Q);d=b-d.rank.value.real;var c=Array(d);a.value.reverse();for(var g,e=0;e<d;e++)g=a.value[e],c[e]=f.scaldiv(f.abs(g),g);c=f.turnIntoCSList(c);return 0<c.value.length?c:
f.turnIntoCSList([f.zerovector(m.real(b))])};f._helper.isAlmostDiagonal=function(a){var d=a.value.length;m.real(d);m.real(0);if(d!==a.value[0].value.length)return!1;for(var b=0;b<d;b++)for(var c=0;c<d;c++)if(b!==c&&1E-16<m.abs(a.value[b].value[c]).value.real)return!1;return!0};f._helper.inverseIteration=function(a,d){console.log("warning: code untested");for(var b=a.value.length,c=Array(b),g=0;g<b;g++)c[g]=2*Math.random()-.5;c=f.realVector(c);b=f.idMatrix(m.real(b),m.real(b));d=m.add(d,m.real(.1*
Math.random()-.5));for(g=0;100>g;g++)c=f.scaldiv(f.abs(c),c),c=f.LUsolve(f.sub(a,f.scalmult(d,b)),JSON.parse(JSON.stringify(c)));return f.scaldiv(f.abs(c),c)};f._helper.toHessenberg=function(a){var d=JSON.parse(JSON.stringify(a)),b=d.value.length,c=m.real(b-1),g=m.real(b);m.real(1);if(f._helper.isUpperTriangular(d))return[f.idMatrix(c,c),a];a=f.idMatrix(g,g);for(g=1;g<b-1;g++){var e=f.column(d,m.real(g));e.value=e.value.splice(g);var h=f.abs2(e).value.real;1E-16<h&&(e=f._helper.getHouseHolder(e),
a=v.mult(a,e),d=v.mult(v.mult(e,d),e));c.value.real--}return[a,d]};f._helper.swapEl=function(a,d,b){if("[object Array]"===Object.prototype.toString.call(a)){var c=a[d];a[d]=a[b];a[b]=c}else"list"===a.ctype&&(c=a.value[d],a.value[d]=a.value[b],a.value[b]=c)};f.RRQRdecomp=function(a,d){var b=Math.sqrt(m.eps);void 0!==d&&(b=.1*d.value.real);d=b*b;var c;b=a.value.length;var g=m.real(b),e=m.real(1),h=f._helper.unitvector(m.real(a.value.length),e),k=f.idMatrix(g,g),l=JSON.parse(JSON.stringify(a)),n=f.transpose(a);
a=Array(b);for(c=0;c<b;c++)a[c]=f.abs2(n.value[c]);a=f.turnIntoCSList(a);n=Array(b);for(c=0;c<b;c++)n[c]=c;c=f.maxIndex(a,m.abs);for(var p=a.value[c],q=0,r=0;1E-16<m.abs2(p).value.real;r++){q++;f._helper.swapColumn(l,r,c);f._helper.swapEl(a,r,c);f._helper.swapEl(n,r,c);c=f._helper.getBlock(l,[r],[r]);c=f.column(c,e);p=f.abs2(c).value.real;1E-8<p&&(c=f._helper.getHouseHolder(c),c=f._helper.buildBlockMatrix(f.idMatrix(m.real(r),m.real(r)),c),k=v.mult(k,f.transjugate(c)),l=v.mult(c,l));for(c=r+1;c<b;c++)a.value[c]=
m.sub(a.value[c],m.mult(l.value[r].value[c],m.conjugate(l.value[r].value[c])));c=f.maxIndex(a,m.abs2,r+1);p=a.value[c];if(r+2===b){m.abs(p).value.real>d&&q++;break}g=m.sub(g,e);h.value=h.value.splice(0,h.value.length-1)}return{Q:k,R:l,P:f.turnIntoCSList(n),rank:m.real(q)}};f._helper.getHouseHolder=function(a){var d=m.real(a.value.length);if(1E-16>f.abs2(a))return f.idMatrix(d,d);var b=m.real(1),c=f._helper.unitvector(m.real(a.value.length),b);var g=f._helper.QRgetAlpha(a,0);g=f.sub(a,f.scalmult(g,
c));g=f.scaldiv(f.abs(g),g);a=m.div(f.sesquilinearproduct(a,g),f.sesquilinearproduct(g,a));d=f.idMatrix(d,d);return d=f.sub(d,f.scalmult(m.add(b,a),f._helper.transposeMult(g,f.conjugate(g))))};f._helper.reOrderbyPivots=function(a,d){var b=a.value.length.length;a=f.transpose(a);b=Array(b);for(var c=0;c<d.length;c++)b[d[c]]=a.value[c];b=f.turnIntoCSList(b);return f.transpose(b)};f.QRdecomp=function(a){var d=a.value.length,b=m.real(d);if(f._helper.isUpperTriangular(a))return{Q:f.idMatrix(b,b),R:a};var c=
m.real(1),g=f._helper.unitvector(m.real(a.value.length),c),e=f.idMatrix(b,b);a=JSON.parse(JSON.stringify(a));for(var h=0;;h++){var k=f._helper.getBlock(a,[h],[h]);k=f.column(k,c);var l=f.abs2(k).value.real;1E-8<l&&(k=f._helper.getHouseHolder(k),k=f._helper.buildBlockMatrix(f.idMatrix(m.real(h),m.real(h)),k),e=v.mult(e,f.transjugate(k)),a=v.mult(k,a));if(h+2===d)break;b=m.sub(b,c);g.value=g.value.splice(0,g.value.length-1)}return{Q:e,R:a}};f._helper.swapColumn=function(a,d,b){for(var c,f=0;f<a.value.length;f++)c=
a.value[f].value[d],a.value[f].value[d]=a.value[f].value[b],a.value[f].value[b]=c};f._helper.buildBlockMatrix=function(a,d){if(0===a.value.length)return d;if(0===d.value.length)return a;var b=a.value.length,c=a.value[0].value.length,g=c+d.value[0].value.length;g=f.zeromatrix(m.real(b+d.value.length),m.real(g));for(var e=0;e<a.value.length;e++)for(var h=0;h<a.value[0].value.length;h++)g.value[e].value[h]=a.value[e].value[h];for(a=0;a<d.value.length;a++)for(e=0;e<d.value[0].value.length;e++)g.value[b+
a].value[c+e]=d.value[a].value[e];return g};f._helper.getBlock=function(a,d,b){a=JSON.parse(JSON.stringify(a));var c=d[0],f=b[0];d=void 0===d[1]?a.value.length:d[1];b=void 0===b[1]?a.value[0].value.length:b[1];d++;b++;a.value=a.value.slice(c,d);for(c=0;c<a.value.length;c++)a.value[c].value=a.value[c].value.slice(f,b);return a};f._helper.setBlock=function(a,d,b){a=JSON.parse(JSON.stringify(a));var c=b[0];b=b[1];for(var f=d.value.length,B=d.value[0].value.length,g=0;g<f;g++)for(var e=0;e<B;e++)a.value[c+
g].value[b+e]=d.value[g].value[e];return a};f._helper.transposeMult=function(a,d){if(a.value.length!==d.value.length)return g;for(var b=a.value.length,c=Array(b),e=0;e<b;e++)c[e]=f.scalmult(a.value[e],d);return f.turnIntoCSList(c)};f._helper.QRgetAlpha=function(a,d){return 0>a.value[d].value.real?f.abs(a):m.neg(f.abs(a))};f.LUdecomp=function(a){a=JSON.parse(JSON.stringify(a));var d,b,c=0,f=a.value.length,g=f-1,e=Array(f);for(b=0;b<f;++b){var h=b;var k=a.value[b];var l=m.abs(k.value[b]).value.real;
for(d=b+1;d<f;++d){var n=m.abs(a.value[d].value[b]);l<n.value.real&&(l=n.value.real,h=d)}l<m.eps&&console.log("Warning: singular matrix!");e[b]=h;h!==b&&(a.value[b]=a.value[h],a.value[h]=k,k=a.value[b],c++);d=k.value[b];for(n=b+1;n<f;++n)a.value[n].value[b]=m.div(a.value[n].value[b],d);for(n=b+1;n<f;++n){h=a.value[n];for(d=b+1;d<g;++d)h.value[d]=m.sub(h.value[d],m.mult(h.value[b],k.value[d])),++d,h.value[d]=m.sub(h.value[d],m.mult(h.value[b],k.value[d]));d===g&&(h.value[d]=m.sub(h.value[d],m.mult(h.value[b],
k.value[d])))}}return{LU:a,P:e,TransPos:c}};f.LUsolve=function(a,d){a=f.LUdecomp(a);return f._helper.LUsolve(a,d)};f._helper.LUsolve=function(a,d){var b=JSON.parse(JSON.stringify(d));d=a.LU;var c=d.value.length,f=JSON.parse(JSON.stringify(b)),g=a.P;for(a=c-1;-1!==a;--a)f.value[a]=b.value[a];for(a=0;a<c;++a){b=g[a];if(g[a]!==a){var e=f.value[a];f.value[a]=f.value[b];f.value[b]=e}e=d.value[a];for(b=0;b<a;++b)f.value[a]=m.sub(f.value[a],m.mult(f.value[b],e.value[b]))}for(a=c-1;0<=a;--a){e=d.value[a];
for(b=a+1;b<c;++b)f.value[a]=m.sub(f.value[a],m.mult(f.value[b],e.value[b]));f.value[a]=m.div(f.value[a],e.value[a])}return f};f.linearsolveCramer2=function(a,d){var b=f.column(a,m.real(1)),c=f.column(a,m.real(2));a=f.det2(b,c);m._helper.isZero(a)&&console.log("A is not regular!");c=f.det2(d,c);c=m.div(c,a);d=f.det2(b,d);d=m.div(d,a);return f.turnIntoCSList([c,d])};f.linearsolveCramer3=function(a,d){var b=f.column(a,m.real(1)),c=f.column(a,m.real(2)),g=f.column(a,m.real(3));a=f.det3(b,c,g);m._helper.isZero(a)&&
console.log("A is not regular!");var e=f.det3(d,c,g);g=f.det3(b,d,g);d=f.det3(b,c,d);d=f.turnIntoCSList([e,g,d]);return d=f.scaldiv(a,d)};f.linearsolveCGNR=function(a,d){var b=f.transpose(a);a=v.mult(b,a);d=v.mult(b,d);return f.linearsolveCG(a,d)};f.linearsolveCG=function(a,d){var b;var c=d;var g=d=f.sub(d,v.mult(a,d));for(var e=Math.ceil(1.2*a.value.length),h=0;h<e;){h++;var k=v.mult(a,g);var l=b=f.scalproduct(d,d);b=m.div(b,f.scalproduct(g,k));c=f.add(c,v.mult(b,g));d=f.sub(d,v.mult(b,k));if(f.abs(d).value.real<
m.eps)break;b=f.scalproduct(d,d);b=m.div(b,l);g=f.add(d,v.mult(b,g))}h>=e&&console.log("CG did not converge");return c};f.det=function(a){if(1===a.value.length)return a.value[0].value[0];if(2===a.value.length)return f.det2(a.value[0],a.value[1]);if(3===a.value.length)return f.det3(a.value[0],a.value[1],a.value[2]);if(4===a.value.length)return f.det4m(a);var d=a.value.length,b=m.real(1),c,g=JSON.parse(JSON.stringify(a));for(a=0;a<d-1;a++){var e=a;for(c=a+1;c<d;c++)m.abs(g.value[c].value[a]).value.real>
m.abs(g.value[e].value[a]).value.real&&(e=c);e!==a&&(c=g.value[e],g.value[e]=g.value[a],g.value[a]=c,b=m.neg(b));var h=g.value[a];for(c=a+1;c<d;c++){var k=g.value[c];var l=m.div(k.value[a],h.value[a]);for(e=a+1;e<d-1;e+=2){var n=e+1;k.value[e]=m.sub(k.value[e],m.mult(h.value[e],l));k.value[n]=m.sub(k.value[n],m.mult(h.value[n],l))}e!==d&&(k.value[e]=m.sub(k.value[e],m.mult(h.value[e],l)))}if(m._helper.isZero(h.value[a]))return m.real(0);b=m.mult(b,h.value[a])}return m.mult(b,g.value[a].value[a])};
f.LUdet=function(a){a=f.LUdecomp(a);for(var d=a.LU,b=d.value.length,c=d.value[0].value[0],g=1;g<b;g++)c=m.mult(c,d.value[g].value[g]);1===a.TransPos%2&&(c=m.neg(c));return c};f.getField=function(a,d){if("homog"===d){if(f._helper.isNumberVecN(a,3))return a;if(f._helper.isNumberVecN(a,2))return f.turnIntoCSList([a.value[0],a.value[1],m.real(1)])}if("xy"===d){if(f._helper.isNumberVecN(a,2))return a;if(f._helper.isNumberVecN(a,3))return f.turnIntoCSList([m.div(a.value[0],a.value[2]),m.div(a.value[1],
a.value[2])])}if("x"===d&&f.isNumberVector(a)){var b=a.value.length;if(0<b&&3!==b)return a.value[0];if(3===b)return"Point"===a.usage?m.div(a.value[0],a.value[2]):a.value[0]}if("y"===d&&f.isNumberVector(a)){b=a.value.length;if(1<b&&3!==b)return a.value[1];if(3===b)return"Point"===a.usage?m.div(a.value[1],a.value[2]):a.value[1]}return"z"===d&&f.isNumberVector(a)&&(b=a.value.length,2<b)?a.value[2]:g};f.nil=f.turnIntoCSList([]);f.ofGeos=function(a){return f.turnIntoCSList(a.map(function(a){return{ctype:"geo",
value:a}}))};f._helper.isAlmostFarpoint=function(a){a=f.normalizeMax(a).value[2];return m.abs(a).value.real<m.eps};f.getRandRealVec3=function(a,d){var b=m.getRandReal;return f.turnIntoCSList([b(a,d),b(a,d),b(a,d)])};f.getRandComplexVec3=function(a,d){var b=m.getRandComplex;return f.turnIntoCSList([b(a,d),b(a,d),b(a,d)])};var ib={key:function(a){if("string"===a.ctype)return"s"+a.value.length+":"+a.value+";";if("number"===a.ctype)return"n"+a.value.real+","+a.value.imag+";";if("list"===a.ctype)return"l"+
a.value.length+":"+a.value.map(ib.key).join(",")+";";if("boolean"===a.ctype)return"b"+a.value+";";if("dict"===a.ctype)return a=Object.keys(a.value).sort(),"d"+a.length+":"+a.join(",")+";";"undefined"!==a.ctype&&Na.err("Bad dictionary key: "+ca(a));return"undef"},create:function(){return{ctype:"dict",value:{}}},clone:function(a){var d=ib.create(),b;for(b in a.value)a.value.hasOwnProperty(b)&&(d.value[b]=a.value[b]);return d},put:function(a,d,b){a.value[ib.key(d)]={key:d,value:b}},get:function(a,d,
b){return(a=a.value[ib.key(d)])?a.value:b},niceprint:function(a){return"{"+Object.keys(a.value).sort().map(function(d){d=a.value[d];return ca(d.key)+":"+ca(d.value)}).join(", ")+"}"}},v={_helper:{},order:{undefined:0,boolean:1,number:2,term:3,atomic:4,variable:5,geo:6,string:7,list:8},string:function(a){return{ctype:"string",value:a}},bool:function(a){return{ctype:"boolean",value:a}},not:function(a){return v.bool(!a.value)},isLessThan:function(a,d){return-1===v.compare(a,d)},isEqual:function(a,d){return 0===
v.compare(a,d)},compareResults:function(a,d){return v.compare(a.result,d.result)},compare:function(a,d){if(a.ctype!==d.ctype)return v.order[a.ctype]-v.order[d.ctype];if("number"===a.ctype)return m._helper.compare(a,d);if("list"===a.ctype)return f._helper.compare(a,d);if("geo"===a.ctype)return a.value.name===d.value.name?0:a.value.name<d.value.name?-1:1;if("string"===a.ctype)return a.value===d.value?0:a.value<d.value?-1:1;if("boolean"===a.ctype)return a.value===d.value?0:!1===a.value?-1:1},add:function(a,
d){return"void"===a.ctype&&"number"===d.ctype||"void"===a.ctype&&"list"===d.ctype?d:"number"===a.ctype&&"number"===d.ctype?m.add(a,d):"string"===a.ctype||"string"===d.ctype?{ctype:"string",value:ca(a)+ca(d)}:"list"===a.ctype&&"list"===d.ctype?f.add(a,d):g},sub:function(a,d){return"void"===a.ctype&&"number"===d.ctype?m.neg(d):"void"===a.ctype&&"list"===d.ctype?f.neg(d):"number"===a.ctype&&"number"===d.ctype?m.sub(a,d):"list"===a.ctype&&"list"===d.ctype?f.sub(a,d):g},mult:function(a,d){return"number"===
a.ctype&&"number"===d.ctype?m.mult(a,d):"number"===a.ctype&&"list"===d.ctype?f.scalmult(a,d):"list"===a.ctype&&"number"===d.ctype?f.scalmult(d,a):"list"===a.ctype&&"list"===d.ctype?f.mult(a,d):g},div:function(a,d){return"number"===a.ctype&&"number"===d.ctype?m.div(a,d):"list"===a.ctype&&"number"===d.ctype?f.scaldiv(d,a):g},max:function(a,d){return"number"===a.ctype&&"number"===d.ctype?m.max(a,d):"list"===a.ctype&&"list"===d.ctype?f.max(a,d):g},min:function(a,d){return"number"===a.ctype&&"number"===
d.ctype?m.min(a,d):"list"===a.ctype&&"list"===d.ctype?f.min(a,d):g},wrap:function(a){if("number"===typeof a)return m.real(a);if("object"===typeof a&&void 0!==a.length){for(var d=[],b=0;b<a.length;b++)d[b]=v.wrap(a[b]);return f.turnIntoCSList(d)}return"string"===typeof a?{ctype:"string",value:a}:"boolean"===typeof a?{ctype:"boolean",value:a}:g},unwrap:function(a){if("object"!==typeof a||null===a)return a;if(Array.isArray(a))return a.map(v.unwrap);switch(a.ctype){case "string":case "boolean":return a.value;
case "number":return 0===a.value.imag?a.value.real:{r:a.value.real,i:a.value.imag};case "list":return a.value.map(v.unwrap);default:return null}},withUsage:function(a,d){return{ctype:a.ctype,value:a.value,usage:d}},wrapJSON:function(a){switch(typeof a){case "number":return m.real(a);case "string":return v.string(a);case "boolean":return v.bool(a);case "object":if(null===a)return g;if(Array.isArray(a))return f.turnIntoCSList(a.map(v.wrapJSON));var d=ib.create(),b;for(b in a)ib.put(d,v.string(b),v.wrapJSON(a[b]));
return d;default:return console.log("Failed to convert "+typeof a+" to CindyJS data type"),g}},identity:function(a){return a},deeplyEqual:function(a,d){if("object"!==typeof a||"object"!==typeof d||null===a||null===d)return a===d;var b=0,c;for(c in a)if(++b,!(c in d&&v.deeplyEqual(a[c],d[c])))return!1;for(c in d)--b;return 0===b},DeepCloneJSON:function(a){var d;var b=Array.isArray(a)?[]:{};for(d in a){var c=a[d];b[d]="object"===typeof c&&null!==c?v.DeepCloneJSON(c):c}return b}},Sb={},V={};V[":"]=$c(":");
V["\u00b0"]=function(a,d){d=D(a[0]);return"number"===d.ctype&&"void"===a[1].ctype?v.withUsage(m.realmult(Math.PI/180,d),"Angle"):g};V._=$a;V["^"]=Dc;V["\u221a"]=function(a,d){return"void"===a[0].ctype?t.sqrt$1([a[1]],d):g};V["*"]=ad;V["\u00d7"]=za;V["/"]=Cd;V["+"]=Rb;V["-"]=Bb;V["!"]=function(a,d){d=D(a[1]);return"void"===a[0].ctype&&"boolean"===d.ctype?{ctype:"boolean",value:!d.value}:g};V["=="]=ic;V["~="]=jc;V["~<"]=function(a,d){d=D(a[0]);a=D(a[1]);return"number"===d.ctype&&"number"===a.ctype&&
m._helper.isAlmostReal(d)&&m._helper.isAlmostReal(a)?{ctype:"boolean",value:d.value.real-a.value.real<=-m.eps}:g};V["~>"]=function(a,d){d=D(a[0]);a=D(a[1]);return"number"===d.ctype&&"number"===a.ctype&&m._helper.isAlmostReal(d)&&m._helper.isAlmostReal(a)?{ctype:"boolean",value:d.value.real-a.value.real>=m.eps}:g};V["=:="]=$c("=:=");V[">="]=function(a,d){d=D(a[0]);a=D(a[1]);return"number"===d.ctype&&"number"===a.ctype&&m._helper.isAlmostReal(d)&&m._helper.isAlmostReal(a)?{ctype:"boolean",value:d.value.real>=
a.value.real}:"string"===d.ctype&&"string"===a.ctype?{ctype:"boolean",value:d.value>=a.value}:g};V["<="]=function(a,d){d=D(a[0]);a=D(a[1]);return"number"===d.ctype&&"number"===a.ctype&&m._helper.isAlmostReal(d)&&m._helper.isAlmostReal(a)?{ctype:"boolean",value:d.value.real<=a.value.real}:"string"===d.ctype&&"string"===a.ctype?{ctype:"boolean",value:d.value<=a.value}:g};V["~>="]=function(a,d){d=D(a[0]);a=D(a[1]);return"number"===d.ctype&&"number"===a.ctype&&m._helper.isAlmostReal(d)&&m._helper.isAlmostReal(a)?
{ctype:"boolean",value:d.value.real-a.value.real>-m.eps}:g};V["~<="]=function(a,d){d=D(a[0]);a=D(a[1]);return"number"===d.ctype&&"number"===a.ctype&&m._helper.isAlmostReal(d)&&m._helper.isAlmostReal(a)?{ctype:"boolean",value:d.value.real-a.value.real<m.eps}:g};V[">"]=function(a,d){d=D(a[0]);a=D(a[1]);return"number"===d.ctype&&"number"===a.ctype&&m._helper.isAlmostReal(d)&&m._helper.isAlmostReal(a)?{ctype:"boolean",value:d.value.real>a.value.real}:"string"===d.ctype&&"string"===a.ctype?{ctype:"boolean",
value:d.value>a.value}:g};V["<"]=function(a,d){d=D(a[0]);a=D(a[1]);return"number"===d.ctype&&"number"===a.ctype&&m._helper.isAlmostReal(d)&&m._helper.isAlmostReal(a)?{ctype:"boolean",value:d.value.real<a.value.real}:"string"===d.ctype&&"string"===a.ctype?{ctype:"boolean",value:d.value<a.value}:g};V["<>"]=ka;V["\u2208"]=function(a,d){d=x(a[0]);a=x(a[1]);return"list"===a.ctype?f.contains(a,d):g};V["\u2209"]=function(a,d){d=x(a[0]);a=x(a[1]);return"list"===a.ctype?v.not(f.contains(a,d)):g};V["&"]=Qa;
V["%"]=Cc;V["!="]=ka;V["~!="]=function(a,d){return v.not(jc(a,d))};V[".."]=function(a,d){d=x(a[0]);a=x(a[1]);return"number"===d.ctype&&"number"===a.ctype?f.sequence(d,a):g};V["++"]=Cb;V["--"]=Fc;V["~~"]=Ec;V[":>"]=mb;V["<:"]=y;V["="]=zb;V[":="]=function(a,d,b){d="undefined"===a[1].ctype;if("undefined"===a[0].ctype||d)return g;if("function"===a[0].ctype){d=a[0].oper;var c=a[0].args,f=a[1],B=1;if(Sb.hasOwnProperty(d)){B=Sb[d];if(B.definer===b)return g;B=B.generation+1}Sb[d]={oper:d,body:f,arglist:c,
definer:b,generation:B}}"variable"===a[0].ctype&&M.setvar(a[0].name,a[1]);return g};V[":=_"]=function(a,d){if("void"!==a[1].ctype)return g;"function"===a[0].ctype&&delete Sb[a[0].oper];return g};V["::="]=$c("::=");V[";"]=function(a,d){d="void"===a[0].ctype;var b="void"===a[1].ctype;if(d&&b)return g;if(!d&&b)return x(a[0]);d||b||x(a[0]);return b?g:x(a[1])};var t={},E={evaluate:function(a,d,b){if(Sb.hasOwnProperty(a)){a=Sb[a];if(void 0===a)d=g;else{var c=[];for(b=0;b<a.arglist.length;b++)c[b]=x(d[b]);
for(b=0;b<a.arglist.length;b++)M.newvar(a.arglist[b].name),M.setvar(a.arglist[b].name,c[b]);M.pushVstack("*");d=x(a.body);M.cleanVstack();for(b=0;b<a.arglist.length;b++)M.removevar(a.arglist[b].name)}return d}if(c=t[a])return c(d,b);var f=a.lastIndexOf("$");if(-1!==f&&(f=a.substr(0,f),c=t[f]))return c(d,b);Na.err("Called undefined function "+f+" (as "+a+")");return g},equals:function(a,d){return"number"===a.ctype&&"number"===d.ctype?{ctype:"boolean",value:a.value.real===d.value.real&&a.value.imag===
d.value.imag}:"string"===a.ctype&&"string"===d.ctype||"boolean"===a.ctype&&"boolean"===d.ctype?{ctype:"boolean",value:a.value===d.value}:"list"===a.ctype&&"list"===d.ctype?f.equals(a,d):"geo"===a.ctype&&"geo"===d.ctype?{ctype:"boolean",value:a.value===d.value}:{ctype:"boolean",value:!1}}},M={};M.vars=function(){var a={pi:m.real(Math.PI),"\u03c0":m.real(Math.PI),i:m.complex(0,1),"true":v.bool(!0),"false":v.bool(!1),"#":g,nil:f.turnIntoCSList([]),newline:v.string("\n"),tab:v.string("\t")},d=[],b;for(b in a)d[b]=
[a[b]];return d}();M.isVariable=function(a){return this.vars.hasOwnProperty(a)};M.create=function(a){if(this.vars.hasOwnProperty(a))return this.vars[a];var d=[null];return this.vars[a]=d};M.newvar=function(a){a=this.vars[a];a.push(g);return a};M.removevar=function(a){var d=this.vars[a];0===d.length&&console.error("Removing non-existing "+a);d.pop();0===d.length&&console.warn("Removing last "+a)};M.setvar=function(a,d){var b=this.vars[a];0===b.length&&console.error("Setting non-existing variable "+
a);void 0===d&&(console.error("Setting variable "+a+" to undefined value"),d=g);"undefined"===d.ctype?b[b.length-1]=d:(a=d,null===a&&(a=g),b[b.length-1]=a)};M.undefinedWarning={};M.getvar=function(a){var d=this.vars[a]||[];0===d.length&&console.error("Getting non-existing variable "+a);d=d[d.length-1];if(null===d){if(u.csnames.hasOwnProperty(a))return{ctype:"geo",value:u.csnames[a]};console&&console.log&&void 0===this.undefinedWarning[a]&&(this.undefinedWarning[a]=!0,console.log("Warning: Accessing undefined variable: "+
a));return g}return d};M.dump=function(a){var d=this.vars[a];console.log("*** Dump "+a);for(a=0;a<d.length;a++)console.log(a+":> "+ca(d[a]))};M.vstack=[];M.pushVstack=function(a){this.vstack.push(a)};M.popVstack=function(){this.vstack.pop()};M.cleanVstack=function(){for(var a=this.vstack;0<a.length&&"*"!==a[a.length-1];)this.removevar(a[a.length-1]),a.pop();0<a.length&&a.pop()};var ya={generalFields:{color:"color",colorhsb:"",size:"size",alpha:"alpha",fillcolor:"fillcolor",fillalpha:"fillalpha",isshowing:"isshowing",
visible:"visible",name:"name",caption:"caption",trace:"",tracelength:"",selected:"",labeled:"labeled",labelled:"labeled"},getGeoField:function(a,d){return"undefined"!==typeof u.csnames[a]?ya.getField(u.csnames[a],d):g},setGeoField:function(a,d,b){return"undefined"!==typeof u.csnames[a]?ya.setField(u.csnames[a],d,b):g},getField:function(a,d){if("P"===a.kind){if("xy"===d)return a=f.dehom(a.homog),v.withUsage(a,"Point");if("homog"===d)return v.withUsage(a.homog,"Point");if("x"===d)return m.div(a.homog.value[0],
a.homog.value[2]);if("y"===d)return m.div(a.homog.value[1],a.homog.value[2]);if("narrow"===d)return v.wrap(a.narrow)}if("L"===a.kind||"S"===a.kind){if("homog"===d)return v.withUsage(a.homog,"Line");if("angle"===d)return a=f.eucangle(f.ey,a.homog),v.withUsage(a,"Angle");if("slope"===d)return m.neg(m.div(a.homog.value[0],a.homog.value[1]))}if("Tr"===a.kind&&"matrix"===d)return a.matrix;if("C"===a.kind){if("radius"===d){var b=a.matrix;a=b.value[0].value[0];var c=b.value[0].value[2];d=b.value[1].value[2];
b=b.value[2].value[2];m.mult(a,a);c=m.div(c,a);d=m.div(d,a);a=m.div(b,a);return a=m.sqrt(m.sub(m.add(m.mult(c,c),m.mult(d,d)),a))}if("size"===d)return a.size;if("matrix"===d)return a.matrix;if("center"===d)return a=n._helper.CenterOfConic(a.matrix),a=f.dehom(a),v.withUsage(a,"Point");if("dualMatrix"===d)return f.normalizeMax(f.adjoint3(a.matrix));if("narrow"===d)return v.wrap(a.narrow)}if("Text"===a.kind){if("pressed"===d)return a.checkbox?v.bool(a.checkbox.checked):v.bool(!1);if("xy"===d)return a=
f.dehom(a.homog),v.withUsage(a,"Point");if("homog"===d)return v.withUsage(a.homog,"Point");if("x"===d)return m.div(a.homog.value[0],a.homog.value[2]);if("y"===d)return m.div(a.homog.value[1],a.homog.value[2])}if("trace"===d)return v.bool(!!a.drawtrace);if("pinned"===d)return v.bool(!!a.pinned);if(ya.generalFields[d])return(a=a[ya.generalFields[d]])&&a.ctype?a:"object"!==typeof a?v.wrap(a):g;if(a.behavior){if("mass"===d&&"Mass"===a.behavior.type)return m.real(a.behavior.mass);if("radius"===d&&"Mass"===
a.behavior.type)return m.real(a.behavior.radius);if("charge"===d&&"Mass"===a.behavior.type)return m.real(a.behavior.charge);if("friction"===d&&"Mass"===a.behavior.type)return m.real(a.behavior.friction);if("vx"===d&&"Mass"===a.behavior.type)return m.real(a.behavior.vx);if("vy"===d&&"Mass"===a.behavior.type)return m.real(a.behavior.vy);if("v"===d&&"Mass"===a.behavior.type)return f.realVector([a.behavior.vx,a.behavior.vy]);if("fx"===d&&"Mass"===a.behavior.type)return m.real(a.behavior.fx);if("fy"===
d&&"Mass"===a.behavior.type)return m.real(a.behavior.fy);if("f"===d&&"Mass"===a.behavior.type)return f.realVector([a.behavior.fx,a.behavior.fy]);if("ldiff"===d&&"Spring"===a.behavior.type)return m.real(a.behavior.ldiff)}d=n[a.type]["get_"+d];return"function"===typeof d?d(a):g},setField:function(a,d,b){"color"===d&&f._helper.isNumberVecN(b,3)&&(a.color=b);"size"===d&&"number"===b.ctype&&(a.size=b);"alpha"===d&&"number"===b.ctype&&(a.alpha=b);"fillcolor"===d&&f._helper.isNumberVecN(b,3)&&(a.fillcolor=
b);"fillalpha"===d&&"number"===b.ctype&&(a.fillalpha=b);"visible"===d&&"boolean"===b.ctype&&(a.visible=b.value);"pinned"===d&&"boolean"===b.ctype&&(a.pinned=b.value);"labeled"!==d&&"labelled"!==d||"boolean"!==b.ctype||(a.labeled=b.value);"printlabel"===d&&(a.printname=ca(b));"trace"===d&&"boolean"===b.ctype&&(b.value&&!a.drawtrace?(a.drawtrace=!0,Ld(a)):a.drawtrace=b.value);"P"===a.kind&&a.movable&&("xy"===d&&f._helper.isNumberVecN(b,2)&&Ra(a,f.turnIntoCSList([b.value[0],b.value[1],m.real(1)]),"homog"),
"xy"===d&&f._helper.isNumberVecN(b,3)&&Ra(a,b,"homog"),"x"===d&&"number"===b.ctype&&Ra(a,f.turnIntoCSList([m.mult(b,a.homog.value[2]),a.homog.value[1],a.homog.value[2]]),"homog"),"y"===d&&"number"===b.ctype&&Ra(a,f.turnIntoCSList([a.homog.value[0],m.mult(b,a.homog.value[2]),a.homog.value[2]]),"homog"),"homog"===d&&f._helper.isNumberVecN(b,3)&&Ra(a,b,"homog"));"homog"===d&&"L"===a.kind&&a.movable&&f._helper.isNumberVecN(b,3)&&Ra(a,b,"homog");"Text"===a.kind&&("pressed"===d&&"boolean"===b.ctype&&a.checkbox&&
(a.checkbox.checked=b.value),a.movable&&("xy"===d?f._helper.isNumberVecN(b,2)?a.homog=f.turnIntoCSList([b.value[0],b.value[1],m.real(1)]):f._helper.isNumberVecN(b,3)&&(a.homog=b):"homog"===d&&f._helper.isNumberVecN(b,3)?a.homog=b:"x"===d&&"number"===b.ctype?a.homog=f.turnIntoCSList([m.mult(b,a.homog.value[2]),a.homog.value[1],a.homog.value[2]]):"y"===d&&"number"===b.ctype&&(a.homog=f.turnIntoCSList([a.homog.value[0],m.mult(b,a.homog.value[2]),a.homog.value[2]]))));a.behavior&&("mass"===d&&"Mass"===
a.behavior.type&&"number"===b.ctype&&(a.behavior.mass=b.value.real),"mass"===d&&"Sun"===a.behavior.type&&"number"===b.ctype&&(a.behavior.mass=b.value.real),"friction"===d&&"Mass"===a.behavior.type&&"number"===b.ctype&&(a.behavior.friction=b.value.real),"charge"===d&&"Mass"===a.behavior.type&&"number"===b.ctype&&(a.behavior.charge=b.value.real),"radius"===d&&"Mass"===a.behavior.type&&"number"===b.ctype&&(a.behavior.radius=b.value.real),"vx"===d&&"Mass"===a.behavior.type&&"number"===b.ctype&&(a.behavior.vx=
b.value.real),"vy"===d&&"Mass"===a.behavior.type&&"number"===b.ctype&&(a.behavior.vy=b.value.real),"v"===d&&"Mass"===a.behavior.type&&f._helper.isNumberVecN(b,2)&&(a.behavior.vx=b.value[0].value.real,a.behavior.vy=b.value[1].value.real));"narrow"===d&&["P","C"].includes(a.kind)&&("boolean"===b.ctype&&(a.narrow=b.value),"number"===b.ctype&&m._helper.isAlmostReal(b)&&(a.narrow=b.value.real));d=n[a.type]["set_"+d];if("function"===typeof d)return d(a,b)},getuserData:function(a,d){var b;a.userData&&a.userData[d]&&
(b=a.userData[d]);return b&&b.ctype?b:"object"!==typeof b?v.wrap(b):g},setuserData:function(a,d,b){a.userData||(a.userData={});a.userData[d]=b}};t.version$0=function(a,d){a=["CindyJS"].concat(de);return f.turnIntoCSList(a.map(v.wrap))};t.clearconsole$0=function(a,d){Na.clear()};t.err$1=function(a,d){d="";"variable"===a[0].ctype?(d=a[0].name,a=M.getvar(a[0].name)):a=a[0];a=d+" ===> "+ca(x(a));ra(a);return g};t.errc$1=function(a,d){"variable"===a[0].ctype?(d=x(M.getvar(a[0].name)),console.log(a[0].name+
" ===> "+ca(d))):(d=x(a[0]),console.log(" ===> "+ca(d)));return g};t.print$1=function(a,d){Na.out(ca(x(a[0])),!0);return g};t.println$1=function(a,d){Na.out(ca(x(a[0])));return g};t.assert$2=function(a,d){var b=x(a[0]);if("boolean"===b.ctype){if(!1===b.value)return t.println$1([a[1]],d)}else ra("Condition for assert is not boolean");return g};t.dump$1=function(a,d){console.log(JSON.stringify(a[0]));return g};t.repeat$2=function(a,d){return t.repeat$3([a[0],null,a[1]],d)};t.repeat$3=function(a,d){var b=
D(a[0]),c="#";null!==a[1]&&"variable"===a[1].ctype&&(c=a[1].name);if("number"!==b.ctype)return g;b=Math.round(b.value.real);var f=1,e=1,h=b+1,k=!1,l=!1,m=!1;if(void 0!==d.start){var n=x(d.start);"number"===n.ctype&&(k=!0,e=n.value.real)}void 0!==d.step&&(n=x(d.step),"number"===n.ctype&&(m=!0,f=n.value.real));void 0!==d.stop&&(n=x(d.stop),"number"===n.ctype&&(l=!0,h=n.value.real));!k||l||m||(h=f*b+e);k||!l||m||(e=-f*(b-1)+h,h+=f);k||l||!m||(h=f*b+e);k&&l&&!m&&(f=(h-e)/(b-1),h+=f);k&&!l&&m&&(h=f*b+
e);!k&&l&&m&&(e=-f*(b-1)+h,h+=f);k&&l&&m&&(h+=f);(e<=h&&0<f||e>=h&&0>f)&&k&&l&&m&&(b=Math.floor((h-e)/f));M.newvar(c);d=g;for(h=0;h<b;h++)M.setvar(c,{ctype:"number",value:{real:h*f+e,imag:0}}),d=x(a[2]);M.removevar(c);return d};t.while$2=function(a,d){d=a[1];a=a[0];for(var b=x(a),c=g;"list"!==b.ctype&&b.value;)c=x(d),b=x(a);return c};t.apply$2=function(a,d){return t.apply$3([a[0],null,a[1]],d)};t.apply$3=function(a,d){var b=D(a[0]);if("list"!==b.ctype)return g;d="#";null!==a[1]&&"variable"===a[1].ctype&&
(d=a[1].name);b=b.value;var c=[];M.newvar(d);for(var f=0;f<b.length;f++)M.setvar(d,b[f]),c[f]=x(a[2]);M.removevar(d);return{ctype:"list",value:c}};t.forall$2=function(a,d){return t.forall$3([a[0],null,a[1]],d)};t.forall$3=function(a,d){var b=D(a[0]);if("list"!==b.ctype)return g;d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);b=b.value;M.newvar(d);for(var c,f=0;f<b.length;f++)M.setvar(d,b[f]),c=x(a[2]);M.removevar(d);return c};t.select$2=function(a,d){return t.select$3([a[0],null,a[1]],d)};
t.select$3=function(a,d){var b=D(a[0]);if("list"!==b.ctype)return g;d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);b=b.value;var c=[];M.newvar(d);for(var f=0,e=0;e<b.length;e++){M.setvar(d,b[e]);var h=x(a[2]);"boolean"===h.ctype&&!0===h.value&&(c[f]=b[e],f++)}M.removevar(d);return{ctype:"list",value:c}};t.flatten$1=function(a,d){function b(a,d){return-1===d||"list"!==a.ctype?a:[].concat.apply([],a.value.map(function(a){return b(a,d-1)}))}a=D(a[0]);if("list"!==a.ctype)return a;d=d.levels;
void 0===d?d=1:(d=x(d),d="number"===d.ctype?d.value.real:"string"===d.ctype&&"all"===d.value?-2:1);return{ctype:"list",value:b(a,d)}};t.createvar$1=function(a,d){"variable"===a[0].ctype&&M.newvar(a[0].name);return g};t.local=function(a,d){for(d=0;d<a.length;d++)"variable"===a[d].ctype&&M.newvar(a[d].name);return g};t.removevar$1=function(a,d){d=x(a[0]);"variable"===a[0].ctype&&M.removevar(a[0].name);return d};t.release=function(a,d){if(0===a.length)return g;d=x(a[a.length-1]);for(var b=0;b<a.length;b++)"variable"===
a[b].ctype&&M.removevar(a[b].name);return d};t.regional=function(a,d){for(d=0;d<a.length;d++)if("variable"===a[d].ctype){var b=a[d].name;M.newvar(b);M.pushVstack(b)}return g};t.genList=function(a,d){return f.turnIntoCSList(a.map(x))};E.assigntake=function(a,d){var b=a.args[0],c=x(b);a=D(a.args[1]);var e=g;if("list"===c.ctype||"string"===c.ctype)a=Math.floor(a.value.real),0>a&&(a=c.value.length+a+1),0<a&&a<=c.value.length&&("list"===c.ctype?(e=c.value.slice(),e[a-1]=x(d),e=f.turnIntoCSList(e),c.userData&&
(e.userData=c.userData)):(c=c.value,c=c.substring(0,a-1)+ca(x(d))+c.substring(a,c.length),e=v.string(c)));zb([b,e])};E.assigndot=function(a,d){var b=x(a.obj);a=a.key;"geo"===b.ctype&&a&&ya.setField(b.value,a,D(d));return g};E.assigncolon=function(a,d){var b=a.obj,c=x(b);a=ca(x(a.key));"_?_"===a&&(a=void 0);if("geo"===c.ctype&&a)ya.setuserData(c.value,a,D(d));else if("list"===c.ctype||"string"===c.ctype&&a){var f={},e;for(e in c)f[e]=c[e];if(f.userData){c={};for(var h in f.userData)c[h]=f.userData[h];
f.userData=c}else f.userData={};f.userData[a]=D(d);zb([b,f])}else a?console.log("User data can only be assigned to geo objects and lists."):console.log("Key is undefined");return g};t.keys$1=function(a,d){d=x(a[0]);var b=d.ctype;return"geo"===b||"list"===b?(a=[],(d="geo"===b?d.value.userData:d.userData)&&(a=Object.keys(d).map(v.string)),f.turnIntoCSList(a)):g};E.assignlist=function(a,d){var b=a.length,c=d.length;c<b&&(b=c);for(c=0;c<b;c++)zb([a[c],d[c]],[])};t.if$2=function(a,d){return t.if$3(a,d)};
t.if$3=function(a,d){d=D(a[0]);if("boolean"===d.ctype){if(!0===d.value)return x(a[1]);if(3===a.length)return x(a[2])}else ra("Condition for if is not boolean");return g};t.and$2=Qa;t.or$2=Cc;t.xor$2=function(a,d){d=D(a[0]);a=D(a[1]);return"boolean"===d.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:d.value!==a.value}:g};t.not$1=function(a,d){a=D(a[0]);return"boolean"===a.ctype?{ctype:"boolean",value:!a.value}:g};E.genericListMathGen=function(a,d,b){t[a+"$1"]=function(a,c){a=x(a[0]);if("list"!==
a.ctype)return g;a=a.value;if(0===a.length)return b;c=a[0];for(var f=1;f<a.length;f++)c=d(c,a[f]);return c};var c=a+"$3";t[a+"$2"]=function(a,d){return t[c]([a[0],null,a[1]])};t[c]=function(a,c){c=D(a[0]);if("list"!==c.ctype)return g;c=c.value;if(0===c.length)return b;var f="#";null!==a[1]&&"variable"===a[1].ctype&&(f=a[1].name);M.newvar(f);M.setvar(f,c[0]);for(var e=x(a[2]),B=1;B<c.length;B++){M.setvar(f,c[B]);var h=x(a[2]);e=d(e,h)}M.removevar(f);return e}};E.genericListMathGen("product",v.mult,
m.real(1));E.genericListMathGen("sum",v.add,m.real(0));E.genericListMathGen("max",v.max,g);E.genericListMathGen("min",v.min,g);t.max$2=function(a,d){d=D(a[0]);if("list"===d.ctype)return t.max$3([d,null,a[1]]);a=D(a[1]);return t.max$1([f.turnIntoCSList([d,a])])};t.min$2=function(a,d){d=D(a[0]);if("list"===d.ctype)return t.min$3([d,null,a[1]]);a=D(a[1]);return t.min$1([f.turnIntoCSList([d,a])])};t.add$2=Rb;t.sub$2=Bb;t.mult$2=ad;t.div$2=Cd;t.mod$2=function(a,d){d=D(a[0]);a=D(a[1]);return"number"===
d.ctype&&"number"===a.ctype?m.mod(d,a):g};t.pow$2=Dc;t.exp$1=function(a,d){a=D(a[0]);return"number"===a.ctype?m.exp(a):g};t.sin$1=function(a,d){a=D(a[0]);return"number"===a.ctype?m.sin(a):g};t.sqrt$1=function(a,d){a=D(a[0]);return"number"===a.ctype?m.sqrt(a):g};E.laguerre=function(a,d,b){if("list"!==a.ctype)return g;var c=a.value.length-1,f;for(f=0;f<=c;f++)if("number"!==a.value[f].ctype)return g;if("number"!==d.ctype)return g;for(var e=[1,.3141,.5926,.5358,.9793,.2385,.6264,.3383,.2795,.0288],B,
h,k,l=1;l<=b;l++){h=k=m.zero;B=a.value[c];for(f=c-1;0<=f;f--)k=m.add(h,m.mult(k,d)),h=m.add(B,m.mult(h,d)),B=m.add(a.value[f],m.mult(B,d));if(m._helper.isLessThan(m.abs(B),m.real(1E-14)))break;f=m.div(h,B);h=m.mult(f,f);B=m.sub(h,m.div(m.mult(m.real(2),k),B));k=m.sqrt(m.mult(m.real(c-1),m.sub(m.mult(m.real(c),B),h)));B=m.add(f,k);f=m.sub(f,k);m._helper.isLessThan(m.abs(B),m.abs(f))&&(B=f);f=m._helper.isLessThan(m.real(1E-14),m.abs(B))?m.div(m.real(c),B):m.mult(m.add(m.abs(d),m.one),m.complex(Math.cos(l),
Math.sin(l)));if(m._helper.isLessThan(m.abs(f),m.real(1E-14)))break;0===l%20&&l<b-19&&(f=m.mult(f,m.real(e[Math.floor(l/20)])));d=m.sub(d,f)}return d};E.quadratic_roots=function(a){if("list"!==a.ctype)return g;var d=a.value[2],b=a.value[1];a=a.value[0];if(m._helper.isZero(a))return[m.zero,m.neg(m.div(b,d))];var c=m.sqrt(m.sub(m.mult(b,b),m.mult(m.real(4),m.mult(d,a))));0<=m.re(b)&&(c=m.neg(c));return[m.div(m.sub(c,b),m.mult(m.real(2),d)),m.div(m.mult(m.real(2),a),m.sub(c,b))]};E.roots=function(a){var d=
[],b=a,c=a.value.length-1;if(0>=c)return f.turnIntoCSList([]);if(m._helper.isZero(a.value[c]))return d=E.roots(f.turnIntoCSList(a.value.slice(0,c))),f.append(d,m.infinity);if(1===c)d[0]=m.neg(m.div(a.value[0],a.value[1]));else if(2===c)d=E.quadratic_roots(a);else{for(var g=0;g<c-2;g++){d[g]=E.laguerre(a,m.zero,200);d[g]=E.laguerre(b,d[g],1);var e=[];e[c-g]=a.value[c-g];for(var h=c-g;0<h;h--)e[h-1]=m.add(a.value[h-1],m.mult(e[h],d[g]));e.shift();a=f.turnIntoCSList(e)}a=E.quadratic_roots(a);d[c-2]=
a[0];d[c-1]=a[1]}return f.turnIntoCSList(d)};t.roots$1=function(a,d){a=D(a[0]);if("list"===a.ctype){for(d=0;d<a.value.length;d++)if("number"!==a.value[d].ctype)return g;a=E.roots(a);return f.sort1(a)}return g};t.autodiff$3=function(a,d){d="x";if("function"===a[0].ctype){var b=Sb[a[0].oper].body;d=a[0].args[0].name}else if("function"===typeof a[0].impl)b=a[0];else return ra("could not parse function"),g;var c=D(a[1]);a=D(a[2]);if(1>a.value.real)return ra("grade cant be < 1"),g;a=m.add(a,m.real(1));
return W.autodiff(b,d,c,a)};t.cos$1=function(a,d){a=D(a[0]);return"number"===a.ctype?m.cos(a):g};t.tan$1=function(a,d){a=D(a[0]);return"number"===a.ctype?m.tan(a):g};t.arccos$1=function(a,d){a=D(a[0]);return"number"===a.ctype?m.arccos(a):g};t.arcsin$1=function(a,d){a=D(a[0]);return"number"===a.ctype?m.arcsin(a):g};t.arctan$1=function(a,d){a=D(a[0]);return"number"===a.ctype?m.arctan(a):g};t.arctan2$2=function(a,d){d=D(a[0]);a=D(a[1]);return"number"===d.ctype&&"number"===a.ctype?m.arctan2(d,a):g};t.arctan2$1=
function(a,d){a=D(a[0]);if("list"===a.ctype&&2===a.value.length){if(a=a.value,"number"===a[0].ctype&&"number"===a[1].ctype)return t.arctan2$2(a,d)}else if("number"===a.ctype)return m.arctan2(a);return g};t.log$1=function(a,d){a=D(a[0]);return"number"===a.ctype?m.log(a):g};E.recursiveGen=function(a){var d=m[a],b=f[a];t[a+"$1"]=function(a,c){a=D(a[0]);return"number"===a.ctype?d(a):"list"===a.ctype?b(a):g}};E.recursiveGen("im");E.recursiveGen("re");E.recursiveGen("conjugate");E.recursiveGen("round");
E.recursiveGen("ceil");E.recursiveGen("floor");E.recursiveGen("abs");t.abs_infix=t.abs$1;t.random$0=function(a,d){return m.real(m._helper.rand())};t.random$1=function(a,d){a=D(a[0]);return"number"===a.ctype?m.complex(a.value.real*m._helper.rand(),a.value.imag*m._helper.rand()):g};t.seedrandom$1=function(a,d){a=D(a[0]);"number"===a.ctype&&m._helper.seedrandom(a.value.real);return g};t.randomnormal$0=function(a,d){return m.real(m._helper.randnormal())};t.randominteger$1=function(a,d){d=D(a[0]);return"number"===
d.ctype?(a=d.value.real|0,d=d.value.imag|0,a=a*m._helper.rand()|0,d=d*m._helper.rand()|0,m.complex(a,d)):g};t.randomint$1=t.randominteger$1;t.randombool$0=function(a,d){return.5<m._helper.rand()?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};t.isreal$1=function(a,d){a=x(a[0]);return"number"===a.ctype&&m._helper.isAlmostReal(a)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};t.isinteger$1=function(a,d){a=x(a[0]);return"number"===a.ctype&&m._helper.isAlmostReal(a)&&a.value.real===Math.floor(a.value.real)?
{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};t.iseven$1=function(a,d){a=x(a[0]);return"number"===a.ctype&&m._helper.isAlmostReal(a)&&a.value.real/2===Math.floor(a.value.real/2)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};t.isodd$1=function(a,d){a=x(a[0]);return"number"===a.ctype&&m._helper.isAlmostReal(a)&&(a.value.real-1)/2===Math.floor((a.value.real-1)/2)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};t.iscomplex$1=function(a,d){return"number"===x(a[0]).ctype?{ctype:"boolean",
value:!0}:{ctype:"boolean",value:!1}};t.isstring$1=function(a,d){return"string"===x(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};t.islist$1=function(a,d){return"list"===x(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};t.ismatrix$1=function(a,d){a=x(a[0]);return-1!==f._helper.colNumb(a)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};t.iscircle$1=function(a,d){a=x(a[0]);return"geo"===a.ctype&&"C"===a.value.kind&&"Circle"===a.value.matrix.usage?{ctype:"boolean",
value:!0}:{ctype:"boolean",value:!1}};t.isconic$1=function(a,d){a=x(a[0]);return"geo"===a.ctype&&"C"===a.value.kind?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};t.isline$1=function(a,d){a=x(a[0]);return"geo"===a.ctype&&"L"===a.value.kind?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};t.ispoint$1=function(a,d){a=x(a[0]);return"geo"===a.ctype&&"P"===a.value.kind?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};t.isgeometric$1=function(a,d){return"geo"===x(a[0]).ctype?{ctype:"boolean",
value:!0}:{ctype:"boolean",value:!1}};t.isnumbermatrix$1=function(a,d){a=x(a[0]);return f.isNumberMatrix(a)};t.isnumbervector$1=function(a,d){a=x(a[0]);return f.isNumberVector(a)};t.issun$1=function(a,d){a=x(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Sun"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};t.ismass$1=function(a,d){a=x(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Mass"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",
value:!1}};t.isspring$1=function(a,d){a=x(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Spring"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};t.isbouncer$1=function(a,d){a=x(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Bouncer"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};t.isundefined$1=function(a,d){return"undefined"===x(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};var Hc={ArcBy3:"Arc",
CenterOfConic:"Center",ConicBy1p4l:"Conic1P4L",ConicBy4p1l:"Conic4P1L",ConicBy5lines:"Conic5L",ConicBy2Foci1P:"ConicFoci",ConicFromPrincipalDirections:"ConicPrincipleDirs",Free:"FreePoint",PolarOfLine:"PolarLine",PolarOfPoint:"PolarPoint",PointOnSegment:"PointOnLine",Button:"Text",ToggleButton:"Text",TrReflectionL:"TrReflection",TrReflectionP:"TrReflection",TrReflectionC:"TrReflection",TrTranslation:"TrProjection",TrSimilarity:"TrProjection",TrAffine:"TrProjection",TransformP:"Transform",TransformL:"Transform",
TransformSegment:"Transform",TransformS:"Transform",TransformPolygon:"Transform",TransformArc:"Transform",TransformConic:"Transform",TransformC:"Transform",TrMoebiusP:"Transform",TrMoebiusL:"Transform",TrMoebiusSegment:"Transform",TrMoebiusS:"Transform",TrMoebiusPolygon:"Transform",TrMoebiusArc:"Transform",TrMoebiusCircle:"Transform",TrMoebiusC:"Transform",TrInverseMoebius:"TrInverse",Perp:"Orthogonal",Para:"Parallel",AngleBisector:"AngularBisector",IntersectLC:"IntersectionConicLine",IntersectCirCir:"IntersectionCircleCircle",
OtherPointOnCircle:"PointOnCircle"};t.algorithm$1=function(a,d){a=x(a[0]);if("geo"===a.ctype){a=a.value;var b=a.type;d=D(d.compatibility);"string"===d.ctype&&/^cinderella$/i.test(d.value)&&(/^Select/.test(b)&&(a=u.csnames[a.args[0]],b=a.type),Hc.hasOwnProperty(b)?b=Hc[b]:"CircleMr"===b&&(b=a.pinned?"CircleByFixedRadius":"CircleByRadius"));return v.string(b)}return g};t.inputs$1=function(a,d){a=x(a[0]);if("geo"===a.ctype){a=a.value;d=a.type;var b=[];a.args&&(b=a.args.map(function(a){return{ctype:"geo",
value:u.csnames[a]}}));if(/^Select/.test(d)||n[d].isMovable)switch(a.kind){case "P":case "L":b.push(a.homog);break;case "C":b.push(a.matrix)}return f.turnIntoCSList(b)}return g};t.moveto$2=function(a,d){d=x(a[0]);a=D(a[1]);"geo"===d.ctype&&(d=d.value,f._helper.isNumberVecN(a,2)?ya.setField(d,"xy",a):f._helper.isNumberVecN(a,3)&&ya.setField(d,"homog",a));return g};t.continuefromhere$0=function(a,d){ac();return g};t.matrixrowcolumn$1=function(a,d){a=x(a[0]);return-1!==f._helper.colNumb(a)?f.realVector([a.value.length,
a.value[0].value.length]):g};t.rowmatrix$1=function(a,d){a=x(a[0]);return"list"===a.ctype?f.turnIntoCSList([a]):g};t.columnmatrix$1=function(a,d){a=x(a[0]);return"list"===a.ctype?f.turnIntoCSList(a.value.map(function(a){return f.turnIntoCSList([a])})):g};t.submatrix$3=function(a,d){d=x(a[0]);var b=x(a[1]);a=x(a[2]);if("list"===d.ctype&&"number"===b.ctype&&"number"===a.ctype){var c=Math.round(b.value.real);a=Math.round(a.value.real);d=d.value.slice();0<a&&a<=d.length&&d.splice(a-1,1);var e=!0;d=d.map(function(a){if("list"!==
a.ctype)e=!1;else return a=a.value.slice(),0<c&&c<=a.length&&a.splice(c-1,1),f.turnIntoCSList(a)});return e?f.turnIntoCSList(d):g}return g};t.complex$1=function(a,d){var b=D(a[0]);if("list"===b.ctype&&f.isNumberVector(b)){if(2===b.value.length)return a=b.value[0],d=b.value[1],m.complex(a.value.real-d.value.imag,d.value.real+a.value.imag);if(3===b.value.length)return a=b.value[0],d=b.value[1],b=b.value[2],a=m.div(a,b),d=m.div(d,b),m.complex(a.value.real-d.value.imag,d.value.real+a.value.imag)}return g};
t.gauss$1=function(a,d){a=D(a[0]);return"number"===a.ctype?f.realVector([a.value.real,a.value.imag]):g};t.cross$2=za;t.crossratio$4=function(a,d){d=x(a[0]);var b=x(a[1]),c=x(a[2]);a=x(a[3]);var e=P(d),h=P(b),k=P(c),l=P(a);return e!==g&&h!==g&&k!==g&&l!==g?f.crossratio3(e,h,k,l,f.ii):"number"===d.ctype&&"number"===b.ctype&&"number"===c.ctype&&"number"===a.ctype?m.div(m.mult(m.sub(d,c),m.sub(b,a)),m.mult(m.sub(d,a),m.sub(b,c))):g};t.para$2=function(a,d){d=D(a[0]);var b=D(a[1]);a=P(d);var c=P(b);if(d!==
g&&b!==g){b=b.usage;var e=a,h=c;if("Line"===d.usage||"Point"===b)e=c,h=a;d=f.cross(f.cross(f.linfty,h),e);return v.withUsage(d,"Line")}return g};t.perp$2=function(a,d){d=D(a[0]);var b=D(a[1]);a=P(d);var c=P(b);if(d!==g&&b!==g){var e=b.usage||c.usage;b=a;var h=c;if("Line"===(d.usage||a.usage)||"Point"===e)b=c,h=a;d=f.turnIntoCSList([h.value[0],h.value[1],m.zero]);d=f.cross(d,b);return v.withUsage(d,"Line")}return g};t.perp$1=function(a,d){a=D(a[0]);return f._helper.isNumberVecN(a,2)?f.turnIntoCSList([m.neg(a.value[1]),
a.value[0]]):g};t.parallel$2=t.para$2;t.perpendicular$2=t.perp$2;t.perpendicular$1=t.perp$1;t.meet$2=function(a,d){d=P(a[0]);a=P(a[1]);return d!==g&&a!==g?(a=f.cross(d,a),v.withUsage(a,"Point")):g};t.join$2=function(a,d){d=P(a[0]);a=P(a[1]);return d!==g&&a!==g?(a=f.cross(d,a),v.withUsage(a,"Line")):g};t.dist$2=function(a,d){d=D(a[0]);a=D(a[1]);a=Bb([d,a],[]);return t.abs$1([a],[])};t.dist_infix=t.dist$2;t.point$1=function(a,d){a=x(a[0]);return f._helper.isNumberVecN(a,3)||f._helper.isNumberVecN(a,
2)?v.withUsage(a,"Point"):a};t.line$1=function(a,d){a=x(a[0]);return f._helper.isNumberVecN(a,3)?v.withUsage(a,"Line"):a};t.det$3=function(a,d){d=P(a[0]);var b=P(a[1]);a=P(a[2]);if(d!==g&&b!==g&&a!==g)return f.det3(d,b,a)};t.det$1=function(a,d){a=D(a[0]);return"list"===a.ctype&&(d=f._helper.colNumb(a),-1!==d&&d===a.value.length)?f.det(a):g};t.eig$1=function(a,d){a=D(a[0]);return"list"===a.ctype&&(d=f._helper.colNumb(a),-1!==d&&d===a.value.length)?f.eig(a):g};t.eigenvalues$1=function(a,d){a=D(a[0]);
return"list"===a.ctype&&(d=f._helper.colNumb(a),-1!==d&&d===a.value.length)?f.eig(a,!1).value[0]:g};t.rank$1=function(a,d){a=D(a[0]);if("list"===a.ctype){var b=f._helper.colNumb(a);if(-1!==b&&b===a.value.length)return f.rank(a,d.precision)}return g};t.kernel$1=function(a,d){a=D(a[0]);if("list"===a.ctype){var b=f._helper.colNumb(a);if(-1!==b&&b===a.value.length)return d=f.nullSpace(a,d.precision),f.transpose(d)}return g};t.eigenvectors$1=function(a,d){a=D(a[0]);return"list"===a.ctype&&(d=f._helper.colNumb(a),
-1!==d&&d===a.value.length)?f.eig(a).value[1]:g};t.area$3=function(a,d){d=P(a[0]);var b=P(a[1]);a=P(a[2]);if(d!==g&&b!==g&&a!==g){var c=d.value[2],e=b.value[2],h=a.value[2];if(!m._helper.isAlmostZero(c)&&!m._helper.isAlmostZero(e)&&!m._helper.isAlmostZero(h))return d=f.scaldiv(c,d),b=f.scaldiv(e,b),a=f.scaldiv(h,a),d=f.det3(d,b,a),m.realmult(.5,d)}return g};t.inverse$1=function(a,d){a=D(a[0]);return"list"===a.ctype&&(d=f._helper.colNumb(a),-1!==d&&d===a.value.length)?f.inverse(a):g};t.linearsolve$2=
function(a,d){d=D(a[0]);a=D(a[1]);if("list"===d.ctype){var b=f._helper.colNumb(d);if(-1!==b&&b===d.value.length&&f._helper.isNumberVecN(a,b))return f.linearsolve(d,a)}return g};var fd=[[[]],[[0]],[[0,1],[1,0]],[[0,1,2],[0,2,1],[1,0,2],[1,2,0],[2,0,1],[2,1,0]],[[0,1,2,3],[0,1,3,2],[0,2,1,3],[0,2,3,1],[0,3,1,2],[0,3,2,1],[1,0,2,3],[1,0,3,2],[1,2,0,3],[1,2,3,0],[1,3,0,2],[1,3,2,0],[2,0,1,3],[2,0,3,1],[2,1,0,3],[2,1,3,0],[2,3,0,1],[2,3,1,0],[3,0,1,2],[3,0,2,1],[3,1,0,2],[3,1,2,0],[3,2,0,1],[3,2,1,0]]];
t.mincostmatching$1=function(a,d){var b=x(a[0]);if(f.isNumberMatrix(b).value){a=b.value.length;d=f._helper.colNumb(b);var c=a<d?d:a,e,h,k=Array(c);for(e=0;e<c;++e)for(k[e]=Array(c),h=0;h<c;++h)k[e][h]=e<a&&h<d?b.value[e].value[h].value.real:0;b=Q(k);c=Array(a);for(e=0;e<a;++e)h=b[e],c[e]=h<d?m.real(h+1):m.real(0);return f.turnIntoCSList(c)}return g};t.take$2=$a;t.length$1=function(a,d){a=x(a[0]);return"list"===a.ctype||"string"===a.ctype?m.real(a.value.length):g};t.pairs$1=function(a,d){a=x(a[0]);
return"list"===a.ctype?f.pairs(a):g};t.triples$1=function(a,d){a=x(a[0]);return"list"===a.ctype?f.triples(a):g};t.cycle$1=function(a,d){a=x(a[0]);return"list"===a.ctype?f.cycle(a):g};t.consecutive$1=function(a,d){a=x(a[0]);return"list"===a.ctype?f.consecutive(a):g};t.reverse$1=function(a,d){a=x(a[0]);return"list"===a.ctype?f.reverse(a):g};t.directproduct$2=function(a,d){d=x(a[0]);a=x(a[1]);return"list"===d.ctype&&"list"===a.ctype?f.directproduct(d,a):g};t.concat$2=Cb;t.common$2=Ec;t.remove$2=Fc;t.append$2=
mb;t.prepend$2=y;t.contains$2=function(a,d){d=x(a[0]);a=x(a[1]);return"list"===d.ctype?f.contains(d,a):g};t.sort$2=function(a,d){return t.sort$3([a[0],null,a[1]],d)};t.sort$3=function(a,d){var b=D(a[0]);if("list"!==b.ctype)return g;d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);b=b.value;var c=[];M.newvar(d);var f;for(f=0;f<b.length;f++)M.setvar(d,b[f]),c[f]={val:b[f],result:x(a[2])};M.removevar(d);c.sort(v.compareResults);a=[];for(f=0;f<b.length;f++)a[f]=c[f].val;return{ctype:"list",value:a}};
t.sort$1=function(a,d){a=x(a[0]);return"list"===a.ctype?f.sort1(a):g};t.set$1=function(a,d){a=x(a[0]);return"list"===a.ctype?f.set(a):g};t.combinations$2=function(a,d){function b(a,d){a===e?q.push(f.turnIntoCSList(r.slice())):d<h&&(r[a]=c.value[d],b(a+1,d+1),b(a,d+1))}var c=x(a[0]);a=x(a[1]);if("number"===a.ctype){var e=a.value.real|0;if("number"===c.ctype){var h=c.value.real|0;h-e<e&&(e=h-e);if(0>e)return m.real(0);if(0===e)return m.real(1);if(1===e)return c;for(var k=d=a=1;k<=e;++k){var l=h-e+k|
0,n=k|0,p=Xb(l,n)|0;l=l/p|0;n=n/p|0;p=Xb(a,n)|0;a=a/p|0;n=n/p|0;p=Xb(l,d)|0;l=l/p|0;d=d/p|0;a=a*l|0;d=d*n|0}return m.real(a/d)}if("list"===c.ctype){h=c.value.length;if(0>e||e>h)return f.turnIntoCSList([]);if(0===e)return f.turnIntoCSList([f.turnIntoCSList([])]);if(e===h)return f.turnIntoCSList([c]);var q=[];var r=Array(e);b(0,0);return f.turnIntoCSList(q)}}return g};t.zeromatrix$2=function(a,d){d=D(a[0]);a=D(a[1]);return"number"===d.ctype&&"number"===a.ctype?f.zeromatrix(d,a):g};t.zerovector$1=function(a,
d){a=D(a[0]);return"number"===a.ctype?f.zerovector(a):g};t.transpose$1=function(a,d){a=D(a[0]);return"list"===a.ctype&&-1!==f._helper.colNumb(a)?f.transpose(a):g};t.row$2=function(a,d){d=D(a[0]);a=D(a[1]);return"number"===a.ctype&&"list"===d.ctype&&-1!==f._helper.colNumb(d)?f.row(d,a):g};t.column$2=function(a,d){d=D(a[0]);a=D(a[1]);return"number"===a.ctype&&"list"===d.ctype&&-1!==f._helper.colNumb(d)?f.column(d,a):g};t.dict$0=function(a,d){a=ib.create();for(var b in d)d.hasOwnProperty(b)&&ib.put(a,
v.string(b),x(d[b]));return a};t.put$3=function(a,d){d=x(a[0]);var b=x(a[1]);a=x(a[2]);return"dict"===d.ctype?(d=ib.clone(d),ib.put(d,b,a),d):g};t.get$2=function(a,d){d=x(a[0]);a=x(a[1]);return"dict"===d.ctype?ib.get(d,a,g):g};t.red$1=function(a,d){a=x(a[0]);return"number"===a.ctype?f.realVector([Math.min(1,Math.max(0,a.value.real)),0,0]):g};t.green$1=function(a,d){a=x(a[0]);return"number"===a.ctype?f.realVector([0,Math.min(1,Math.max(0,a.value.real)),0]):g};t.blue$1=function(a,d){a=x(a[0]);return"number"===
a.ctype?f.realVector([0,0,Math.min(1,Math.max(0,a.value.real))]):g};t.gray$1=function(a,d){a=x(a[0]);return"number"===a.ctype?(a=Math.min(1,Math.max(0,a.value.real)),f.realVector([a,a,a])):g};t.grey$1=t.gray$1;E.HSVtoRGB=function(a,d,b){a&&void 0===d&&void 0===b&&(d=a.s,b=a.v,a=a.h);var c=Math.floor(6*a);var g=6*a-c;a=b*(1-d);var e=b*(1-g*d);d=b*(1-(1-g)*d);switch(c%6){case 0:var h=b;var B=d;var k=a;break;case 1:h=e;B=b;k=a;break;case 2:h=a;B=b;k=d;break;case 3:h=a;B=e;k=b;break;case 4:h=d;B=a;k=
b;break;case 5:h=b,B=a,k=e}return f.realVector([h,B,k])};t.hue$1=function(a,d){a=x(a[0]);return"number"===a.ctype?(a=a.value.real,a-=Math.floor(a),E.HSVtoRGB(a,1,1)):g};E.shapeconvert=function(a){if("circle"===a.type){var d=a.value.value[0];d=v.div(d,d.value[2]);var b=d.value[0].value.real,c=d.value[1].value.real;a=a.value.value[1].value.real;var f=Array(125);var g=2*Math.PI/125;for(d=0;125>d;d++)f[d]={X:b+Math.cos(d*g)*a,Y:c+Math.sin(d*g)*a};return[f]}if("polygon"===a.type){b=[];for(d=0;d<a.value.length;d++){c=
a.value[d];f=[];for(g=0;g<c.length;g++)f[g]={X:c[g].X,Y:c[g].Y};b[d]=f}return b}};E.shapeop=function(a,d,b){a=E.shapeconvert(a);var c=E.shapeconvert(d);ClipperLib.JS.ScaleUpPaths(a,1E3);ClipperLib.JS.ScaleUpPaths(c,1E3);d=new ClipperLib.Clipper;d.AddPaths(a,ClipperLib.PolyType.ptSubject,!0);d.AddPaths(c,ClipperLib.PolyType.ptClip,!0);c=a=ClipperLib.PolyFillType.pftNonZero;var f=new ClipperLib.Paths;d.Execute(b,f,a,c);ClipperLib.JS.ScaleDownPaths(f,1E3);return{ctype:"shape",type:"polygon",value:f}};
E.shapecommon=function(a,d){return E.shapeop(a,d,ClipperLib.ClipType.ctIntersection)};E.shaperemove=function(a,d){return E.shapeop(a,d,ClipperLib.ClipType.ctDifference)};E.shapeconcat=function(a,d){return E.shapeop(a,d,ClipperLib.ClipType.ctUnion)};t.key$0=function(a,d){return{ctype:"string",value:xd}};t.keycode$0=function(a,d){return m.real(Wc)};t.mouse$0=function(a,d){return d.id?(a=x(d.id),"number"===a.ctype&&(a=a.value.real,yb[a])?f.realVector(yb[a]):g):f.realVector(Ja)};t.mover$0=function(a,
d){return ua&&ua.mover?{ctype:"geo",value:ua.mover}:g};t.multiid$0=function(a,d){return m.real(Xa)};t.multiidlist$0=function(a,d){a=[];for(var b in yb)a.push(b);return f.realVector(a)};t.translate$1=function(a,d){a=D(a[0]);"list"===a.ctype&&f.isNumberVector(a)&&2===a.value.length&&A.translate(a.value[0].value.real,a.value[1].value.real);return g};t.rotate$1=function(a,d){a=D(a[0]);"number"===a.ctype&&A.rotate(a.value.real);return g};t.scale$1=function(a,d){a=D(a[0]);"number"===a.ctype&&A.scale(a.value.real);
return g};t.greset$0=function(a,d){a=Wb.stack.length;A.greset();for(d=0;d<a;d++)z.restore();return g};t.gsave$0=function(a,d){A.gsave();z.save();return g};t.grestore$0=function(a,d){A.grestore();z.restore();return g};t.color$1=function(a,d){a=D(a[0]);"list"===a.ctype&&f.isNumberVector(a).value&&A.setcolor(a);return g};t.linecolor$1=function(a,d){a=D(a[0]);"list"===a.ctype&&f.isNumberVector(a).value&&A.setlinecolor(a);return g};t.pointcolor$1=function(a,d){a=D(a[0]);"list"===a.ctype&&f.isNumberVector(a).value&&
A.setpointcolor(a);return g};t.alpha$1=function(a,d){a=D(a[0]);"number"===a.ctype&&A.setalpha(a);return g};t.pointsize$1=function(a,d){a=D(a[0]);"number"===a.ctype&&A.setpointsize(a);return g};t.linesize$1=function(a,d){a=D(a[0]);"number"===a.ctype&&A.setlinesize(a);return g};t.textsize$1=function(a,d){a=D(a[0]);"number"===a.ctype&&A.settextsize(a);return g};t.playanimation$0=function(a,d){G();return g};t.pauseanimation$0=function(a,d){Pa();return g};t.stopanimation$0=function(a,d){tb();return g};
t.text$1=function(a,d){a=D(a[0]);return v.string(ca(a))};t.replace$3=function(a,d){var b=x(a[0]);d=x(a[1]);a=x(a[2]);if("string"===b.ctype&&"string"===d.ctype&&"string"===a.ctype)return b=b.value,d=d.value.replace(/[^A-Za-z0-9]/g,"\\$&"),a=a.value.replace(/\$/g,"$$$$"),b=b.replace(new RegExp(d,"g"),a),{ctype:"string",value:b}};t.replace$2=function(a,d){function b(a,d,b){var f="";c=k=-1;for(var g=0;g<d.length;g++){var e=d[g][0],h=a.indexOf(e,b);-1!==h&&(-1===k?(f=e,k=h,c=g):h<k&&(f=e,k=h,c=g))}return f}
var c;d=x(a[0]);var f=x(a[1]);if("string"===d.ctype&&"list"===f.ctype){a=d.value;d=[];for(var e=0;e<f.value.length;e++){var h=f.value[e];"list"===h.ctype&&2===h.value.length&&"string"===h.value[0].ctype&&"string"===h.value[1].ctype&&(d[d.length]=[h.value[0].value,h.value[1].value])}var k=-1;for(f=b(a,d,0);-1!==k;)a=a.substring(0,k)+d[c][1]+a.substring(k+f.length,a.length),f=k+d[c][1].length,f=b(a,d,f);return{ctype:"string",value:a}}return g};t.substring$3=function(a,d){d=x(a[0]);var b=D(a[1]);a=D(a[2]);
return"string"===d.ctype&&"number"===b.ctype&&"number"===a.ctype?{ctype:"string",value:d.value.substring(Math.floor(b.value.real),Math.floor(a.value.real))}:g};t.tokenize$2=function(a,d){var b=x(a[0]);a=x(a[1]);if("string"===b.ctype&&"string"===a.ctype)return t.tokenize$2([b,f.turnIntoCSList([a])],d);if("string"===b.ctype&&"list"===a.ctype){b=b.value;if(0===a.value.length){a=!0;if(void 0!==d.autoconvert){var c=x(d.autoconvert);"boolean"===c.ctype&&(a=c.value)}return a&&""!==b&&(a=Number(b),!isNaN(a))?
m.real(a):v.string(b)}c=a.value[0];var e=f.turnIntoCSList(a.value.slice(1));b=b.split(c.value);return f.turnIntoCSList(b.map(function(a){return t.tokenize$2([v.string(a),e],d)}))}return g};t.indexof$2=function(a,d){d=x(a[0]);a=x(a[1]);return"string"===d.ctype&&"string"===a.ctype?(a=d.value.indexOf(a.value),m.real(a+1)):g};t.indexof$3=function(a,d){d=x(a[0]);var b=x(a[1]);a=x(a[2]);return"string"===d.ctype&&"string"===b.ctype&&"number"===a.ctype?(a=d.value.indexOf(b.value,Math.round(a.value.real)-
1),m.real(a+1)):g};t.parse$1=function(a,d){a=x(a[0]);return"string"===a.ctype?(a=fb(a.value),x(a)):g};t.unicode$1=function(a,d){a=x(a[0]);var b=16;d.base&&(d=x(d.base),"number"===d.ctype&&(b=d.value.real));if("string"===a.ctype)d=parseInt(a.value,b);else if("number"===a.ctype)d=a.value.real;else return g;"undefined"!==typeof String.fromCodePoint?d=String.fromCodePoint(d):65535>=d?d=String.fromCharCode(d):(d-=65536,d=String.fromCharCode((d>>10)+55296,(d&1023)+56320));return v.string(d)};t.international$1=
function(a,d){return t.international$2([a[0],null],d)};t.international$2=function(a,d){d=x(a[0]);if("string"!==d.ctype)return g;var c=(b.translations||{})[b.language||"en"]||{};if(!c.hasOwnProperty(d.value))return d;var f=c[d.value];if("string"===typeof f)return v.string(f);if(null===a[1])return d;a=x(a[1]);a="number"===a.ctype?a.value.real:0;a=(c._pluralFormFunction||Dd)(a);return a<f.length?v.string(f[a]):d};t.currentlanguage$0=function(a,d){return v.string(b.language||"en")};E.basismap=function(a,
d,b,c){var g=f.turnIntoCSList([a,d,b]);g=f.adjoint3(f.transpose(g));c=v.mult(g,c);g=f.turnIntoCSList([v.mult(c.value[0],a),v.mult(c.value[1],d),v.mult(c.value[2],b)]);return f.transpose(g)};t.map$8=function(a,d){d=P(a[0]);var b=P(a[1]),c=P(a[2]),e=P(a[3]),h=P(a[4]),k=P(a[5]),l=P(a[6]);a=P(a[7]);return h!==g&&k!==g&&l!==g&&a!==g&&d!==g&&b!==g&&c!==g&&e!==g?(a=E.basismap(h,k,l,a),d=E.basismap(d,b,c,e),d=v.mult(a,f.adjoint3(d)),f.normalizeMax(d)):g};t.map$6=function(a,b){b=P(a[0]);var d=P(a[1]),c=P(a[2]),
e=f.realVector([0,0,1]),h=f.cross,k=h(h(c,h(e,h(b,d))),h(d,h(e,h(b,c)))),l=P(a[3]),m=P(a[4]);a=P(a[5]);e=h(h(a,h(e,h(l,m))),h(m,h(e,h(l,a))));return l!==g&&m!==g&&a!==g&&e!==g&&b!==g&&d!==g&&c!==g&&k!==g?(l=E.basismap(l,m,a,e),b=E.basismap(b,d,c,k),b=v.mult(l,f.adjoint3(b)),f.normalizeMax(b)):g};t.map$4=function(a,b){b=f.ii;var d=f.jj,c=P(a[0]),e=P(a[1]),h=P(a[2]);a=P(a[3]);return h!==g&&a!==g&&c!==g&&e!==g?(a=E.basismap(h,a,b,d),b=E.basismap(c,e,b,d),b=v.mult(a,f.adjoint3(b)),f.normalizeMax(b)):
g};t.map$2=function(a,b){b=f.ii;var d=f.jj,c=P(a[0]),e=v.add(f.realVector([1,0,0]),c);a=P(a[1]);var h=v.add(f.realVector([1,0,0]),a);return a!==g&&h!==g&&c!==g&&e!==g?(a=E.basismap(a,h,b,d),b=E.basismap(c,e,b,d),b=v.mult(a,f.adjoint3(b)),f.normalizeMax(b)):g};t.pointreflect$1=function(a,b){b=f.ii;var d=f.jj;a=P(a[0]);var c=v.add(f.realVector([1,0,0]),a),e=v.add(f.realVector([-1,0,0]),a);return e!==g&&a!==g&&c!==g?(e=E.basismap(a,e,b,d),b=E.basismap(a,c,b,d),b=v.mult(e,f.adjoint3(b)),f.normalizeMax(b)):
g};t.linereflect$1=function(a,b){b=f.ii;var d=f.jj;a=P(a[0]);var c=f.realVector([Math.random(),Math.random(),Math.random()]),e=f.realVector([Math.random(),Math.random(),Math.random()]);c=f.cross(c,a);e=f.cross(e,a);return a!==g&&c!==g?(a=E.basismap(c,e,b,d),b=E.basismap(c,e,d,b),b=v.mult(a,f.adjoint3(b)),f.normalizeMax(b)):g};E.extractPointVec=function(a){var b={ok:!1};if("geo"===a.ctype){var c=a.value;if("P"===c.kind)return b.x=ya.getField(c,"x"),b.y=ya.getField(c,"y"),b.z=m.real(1),b.ok=!0,b}if("list"!==
a.ctype)return b;var f=a.value;if(2===f.length&&(a=f[0],c=f[1],"number"===a.ctype&&"number"===c.ctype))return b.x=a,b.y=c,b.z=m.real(1),b.ok=!0,b;3===f.length&&(a=f[0],c=f[1],f=f[2],"number"===a.ctype&&"number"===c.ctype&&"number"===f.ctype&&(b.x=m.div(a,f),b.y=m.div(c,f),b.z=m.real(1),b.ok=!0));return b};t.polygon$1=function(a,b){a=x(a[0]);if("list"===a.ctype){b=[];for(var d=0;d<a.value.length;d++){var c=E.extractPoint(a.value[d]);if(!c.ok)return g;b[d]={X:c.x,Y:c.y}}return{ctype:"shape",type:"polygon",
value:[b]}}return g};t.circle$2=function(a,b){b=D(a[0]);a=D(a[1]);b=E.extractPointVec(b);if(!b.ok||"number"!==a.ctype)return g;b=f.turnIntoCSList([b.x,b.y,b.z]);return{ctype:"shape",type:"circle",value:f.turnIntoCSList([b,a])}};t.screen$0=function(a,b){var d=A.drawingstate.initialmatrix;a=function(a,b){a-=d.tx;b+=d.ty;return{X:(a*d.d-b*d.b)/d.det,Y:-(-a*d.c+b*d.a)/d.det}};return{ctype:"shape",type:"polygon",value:[[a(0,0),a(ia,0),a(ia,la),a(0,la)]]}};t.halfplane$2=function(a,b){b=D(a[0]);a=D(a[1]);
var d=P(b),c=P(a);if(b!==g&&a!==g){var e=a.usage;a=d;var h=c;if("Line"===b.usage||"Point"===e)a=c,h=d;b=f.turnIntoCSList([h.value[0],h.value[1],m.zero]);b=f.cross(b,a);h=f.cross(h,b);h=v.div(h,h.value[2]);a=v.div(a,a.value[2]);a=f.sub(a,h);b=f.abs(a);a=v.div(a,b);b=h.value[0].value.real;h=h.value[1].value.real;d=1E3*a.value[0].value.real;a=1E3*a.value[1].value.real;return{ctype:"shape",type:"polygon",value:[[{X:b+a/2,Y:h-d/2},{X:b+a/2+d,Y:h-d/2+a},{X:b-a/2+d,Y:h+d/2+a},{X:b-a/2,Y:h+d/2}]]}}return g};
t.element$1=function(a,b){a=x(a[0]);return"string"===a.ctype&&u.csnames.hasOwnProperty(a.value)?{ctype:"geo",value:u.csnames[a.value]}:g};E.all$1=function(a,b){a=x(a[0]);return"geo"===a.ctype&&a.value.incidences?f.ofGeos(a.value.incidences.map(function(a){return u.csnames[a]}).filter(b)):f.nil};t.allpoints$0=function(a,b){return f.ofGeos(u.points)};t.allpoints$1=function(a,b){return E.all$1(a,function(a){return"P"===a.kind})};t.allmasses$0=function(a,b){return f.ofGeos(xa)};t.allmasses$1=function(a,
b){return E.all$1(a,function(a){return"P"===a.kind&&a.behavior&&"Mass"===a.behavior.type})};t.allsprings$0=function(a,b){return f.ofGeos(Ee)};t.allsprings$1=function(a,b){return E.all$1(a,function(a){return"S"===a.kind&&a.behavior&&"Spring"===a.behavior.type})};t.alllines$0=function(a,b){return f.ofGeos(u.lines)};t.alllines$1=function(a,b){return E.all$1(a,function(a){return"L"===a.kind||"S"===a.kind})};t.allsegments$0=function(a,b){return f.ofGeos(u.lines.filter(function(a){return"S"===a.kind}))};
t.allsegments$1=function(a,b){return E.all$1(a,function(a){return"S"===a.kind})};t.allconics$0=function(a,b){return f.ofGeos(u.conics)};t.allconics$1=function(a,b){return E.all$1(a,function(a){return"C"===a.kind})};t.allcircles$0=function(a,b){return f.ofGeos(u.conics.filter(function(a){return"Circle"===a.matrix.usage}))};t.allcircles$1=function(a,b){return E.all$1(a,function(a){return"C"===a.kind&&"Circle"===a.matrix.usage})};t.allelements$0=function(a,b){return f.ofGeos(u.gslp)};t.allelements$1=
function(a,b){return E.all$1(a,function(a){return!0})};t.elementsatmouse$0=function(a,b){var d=f.realVector([Ja[0],Ja[1],1]),c=function(a){if(m._helper.isAlmostZero(a.value[2]))return Infinity;a=f.normalizeZ(a);return f.abs(f.sub(a,d)).value.real},g=function(a){a=f.turnIntoCSList([a.value[0],a.value[1],m.zero]);return f.normalizeMax(f.cross(d,a))},e=function(a){var b=v.mult(a.matrix,d);b=g(b);a=n._helper.IntersectLC(b,a.matrix).map(function(a){return c(a)});return.5>Math.min(a[0],a[1])};a=u.points.filter(function(a){return.5>
c(a.homog)});b=u.lines.filter(function(a){var b=g(a.homog);b=f.normalizeMax(f.cross(a.homog,b));if((b=.5>c(b))&&"S"===a.kind){var e=a.homog;e=f.turnIntoCSList([e.value[0],e.value[1],m.zero]);a=f.crossratio3(a.farpoint,a.startpos,a.endpos,d,e).value.real;if(0>a||1<a)b=!1}return b});var h=u.conics.filter(function(a){var b=e(a);if(b&&a.isArc){var c=f.crossratio3harm(a.startPoint,a.endPoint,a.viaPoint,d,f.ii);a=c.value[0];c=c.value[1];m._helper.isAlmostZero(a)?(a=m.div(a,c),c=m.real(1)):(c=m.div(c,a),
a=m.real(1));var g=f.abs(f.turnIntoCSList([c,a]));a=m.div(a,g);c=m.div(c,g);c=m.mult(c,a);0>a.value.real&&(c=m.neg(c));0>c.value.real&&(b=!1)}return b});a=a.concat(b,h);return f.ofGeos(a)};t.incidences$1=t.allelements$1;t.createpoint$2=function(a,b){b=x(a[0]);a=P(a[1]);return"string"!==b.ctype?(ra("Name must be a string"),g):"list"!==a.ctype&&f.isNumberVector(a)?(ra("Position must be a number vector"),g):{ctype:"geo",value:Va({name:b.value,type:"Free",labeled:!0,pos:a},!0)}};t.create$3=function(a,
b){var d=x(a[0]),c=x(a[1]),e=x(a[2]);a={};for(var h in b)a[h]=D(b[h]);if("string"===d.ctype)h=d.value;else{if("list"!==d.ctype)return ra("Names must be a string or a list of strings"),g;if(1!==d.value.length){h=v.string(d.value.map(function(a){return a.value}).join("__"));e=t.create$3([h,c,e],a);var k=[];if(e!==g)for(c=v.string(e.value.kind.replace(/^(.*)s$/,"Select$1")),e=f.turnIntoCSList([v.string(e.value.name)]),b=0;b<d.value.length;++b)a.index=m.real(b+1),k.push(t.create$3([d.value[b],c,e],a));
return f.turnIntoCSList(k)}if("string"!==d.value[0].ctype)return ra("Element of names list must be a string"),g;h=d.value[0].value}if("string"!==c.ctype)return ra("Type must be a string"),g;if("list"!==e.ctype)return ra("Arguments must be a list"),g;if(!n.hasOwnProperty(c.value)&&!Yc.hasOwnProperty(c.value)&&!Be.hasOwnProperty(c.value))return ra("Invalid geometric operation: '"+c.value+"'"),g;d=[];var l=null;for(b=0;b<e.value.length;b++){var p=e.value[b];if("string"===p.ctype)d.push(p.value);else if("geo"===
p.ctype)d.push(p.value.name);else if(l=P(p),l===g)return ra("Unknown argument type"),g}e={name:h,type:c.value,labeled:!0};l&&(e.pos=l);0<d.length&&(e.args=d);for(k in a)e[k]=v.unwrap(a[k]);return{ctype:"geo",value:Va(e,!0)}};t.create$2=function(a,b){function d(a){function b(a){u.csnames[a]||(d=a)}var d=!1,c;if("P"===a)for(c=0;26>c&!d;c++)8!==c&&9!==c&&b(String.fromCharCode(65+c));else if("L"===a||"S"===a)for(c=0;26>c&!d;c++)8!==c&&9!==c&&b(String.fromCharCode(97+c));for(c=0;!d;c++)b(a+c);return d}
var c=x(a[0]);a=x(a[1]);var e={};for(h in b)e[h]=D(b[h]);if(!n.hasOwnProperty(c.value)&&!Yc.hasOwnProperty(c.value)&&!Be.hasOwnProperty(c.value))return ra("Invalid geometric operation: '"+c.value+"'"),g;for(;Yc.hasOwnProperty(c.value);)c.value=Yc[c.value];var h=n[c.value];b=v.string(d(h.kind));if(a.value.length>h.signature.length){var k="Operation "+c.value+" requieres only "+h.signature.length+" argument"+(1===h.signature.length?"":"s")+" ("+a.value.length+" argument"+(1===a.value.length?"":"s")+
" given) to create "+b.value+". Ignoring the last arguments.";if(!e.pos){var l=P(a.value[a.value.length-1]);l!==g&&(k+=" Use the last argument as modifier `pos`.",e.pos=l)}ra(k);a=f.turnIntoCSList(a.value.slice(0,h.signature.length))}h=t.create$3([b,c,a],e);if(h!==g&&"s"===h.value.kind[1]&&h.value.results){c=v.string("Select"+h.value.kind[0]);a=f.turnIntoCSList([v.string(h.value.name)]);if(e.pos)return b=v.string(d(h.value.kind[0])),t.create$3([b,c,a],e);k=[];for(l=0;l<h.value.results.value.length;l++)e.index=
m.real(l+1),b=v.string(d(h.value.kind[0])),k.push(t.create$3([b,c,a],e));return f.turnIntoCSList(k)}h.isDuplicate&&delete h.isDuplicate;return h};t.javascript$1=function(a,b){a=x(a[0]);"string"===a.ctype&&(new Function(a.value)).call(Ha);return g};t.use$1=function(a,d){function c(a,b,d){t[a.toLowerCase()+"$"+b]=d}a=x(a[0]);if("string"===a.ctype){a=a.value;var f;b.plugins&&(f=b.plugins[a]);f||(f=Da._pluginRegistry[a]);if(f)return f({instance:Ha,config:b,nada:g,evaluate:x,extractPoint:E.extractPoint,
evaluateAndVal:D,defineFunction:c,addShutdownHook:xb.push.bind(xb),addAutoCleaningEventListener:X,getVariable:M.getvar.bind(M),getInitialMatrix:function(){return A.drawingstate.initialmatrix},setTextRenderer:function(a,b){re=a;b&&(Fe=b)},getImage:function(a,b){"string"===typeof a&&(a=v.string(a));a=Ua(a);if(!a)return null;!b&&a.cdyUpdate&&a.cdyUpdate();return a},getMyfunction:function(a){return Sb.hasOwnProperty(a)?Sb[a]:null}}),{ctype:"boolean",value:!0};ra("Plugin "+a+" not found");return{ctype:"boolean",
value:!1}}return g};t.format$2=function(a,b){function d(a,d){a=a.toFixed(k);do{var c=a;a=a.substring(0,a.length-1)}while(d&&""!==a&&"-"!==a&&+a===+c);d=""+c;b.delimiter&&"string"===b.delimiter.ctype&&(d=d.replace(".",b.delimiter.value));return d}function c(a,b){if("number"===a.ctype){var f=d(a.value.real,e);var g=d(a.value.imag,e);a=Math.abs(a.value.imag)<Math.pow(10,-b)?f:"-"===g.substring(0,1)?f+" - i*"+g.substring(1):f+" + i*"+g;return{ctype:"string",value:a}}return"list"===a.ctype?{ctype:"list",
value:a.value.map(c)}:{ctype:"string",value:ca(a).toString()}}var f=D(a[0]);a=D(a[1]);var e=!0;if(b.truncate){var h=x(b.truncate);"boolean"===h.ctype&&(e=h.value)}if(("number"===f.ctype||"list"===f.ctype)&&"number"===a.ctype){var k=Math.max(0,Math.min(20,Math.round(a.value.real)));return c(f,k)}return g};Date.now||(Date.now=function(){return(new Date).getTime()});var Ic=0;t.timestamp$0=function(a,b){return m.real(Date.now())};t.seconds$0=function(a,b){return m.real((Date.now()-Ic)/1E3)};t.resetclock$0=
function(a,b){Ic=Date.now();return g};t.time$0=function(a,b){a=new Date;return f.realVector([a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()])};t.date$0=function(a,b){a=new Date;return f.realVector([a.getFullYear(),a.getMonth()+1,a.getDate()])};t.simulationtime$0=function(a,b){return m.real(sc*vc)};t.settimeout$2=function(a,b){function d(){x(c);q()}b=x(a[0]);var c=a[1];"number"===b.ctype&&"undefined"!==typeof window&&window.setTimeout(d,1E3*b.value.real);return g};E.formatForWebGL=
function(a){return a.toFixed(10)};t.generateWebGL$2=function(a,b){var d=E.formatForWebGL;b=a[0];a=x(a[1]);console.log(a);if("list"!==a.ctype)return g;for(var c=[],f=0;f<a.value.length;f++)"string"===a.value[f].ctype&&c.push(a.value[f].value);console.log("***********");console.log(c);a=E.plotvars(b);console.log(a);-1===a.indexOf("a")&&-1===a.indexOf("b")&&-1===a.indexOf("c")&&-1===a.indexOf("d")&&-1===a.indexOf("e")&&-1===a.indexOf("f")&&(b=D(b));if("number"===b.ctype)return{ctype:"string",value:"vec2("+
d(b.value.real)+","+d(b.value.imag)+")"};if("variable"===b.ctype)return{ctype:"string",value:b.name};if("string"===b.ctype||"void"===b.ctype)return b;if(2===b.args.length&&("infix"===b.ctype||"function"===b.ctype)){d=t.compileToWebGL$1([b.args[0]],{});a=t.compileToWebGL$1([b.args[1]],{});if("+"===b.oper||"add"===b.oper)return void 0===d.value||"void"===d.ctype?{ctype:"string",value:a.value}:{ctype:"string",value:"addc("+d.value+","+a.value+")"};if("*"===b.oper||"mult"===b.oper)return{ctype:"string",
value:"multc("+d.value+","+a.value+")"};if("/"===b.oper||"div"===b.oper)return{ctype:"string",value:"divc("+d.value+","+a.value+")"};if("-"===b.oper||"sub"===b.oper)return void 0===d.value||"void"===d.ctype?{ctype:"string",value:"negc("+a.value+")"}:{ctype:"string",value:"subc("+d.value+","+a.value+")"};if("^"===b.oper||"pow"===b.oper)return{ctype:"string",value:"powc("+d.value+","+a.value+")"}}if("function"===b.ctype&&1===b.args.length){d=t.compileToWebGL$1([b.args[0]],{});if("sin$1"===b.oper)return{ctype:"string",
value:"sinc("+d.value+")"};if("cos$1"===b.oper)return{ctype:"string",value:"cosc("+d.value+")"};if("tan$1"===b.oper)return{ctype:"string",value:"tanc("+d.value+")"};if("exp$1"===b.oper)return{ctype:"string",value:"expc("+d.value+")"};if("log$1"===b.oper)return{ctype:"string",value:"logc("+d.value+")"};if("arctan$1"===b.oper)return{ctype:"string",value:"arctanc("+d.value+")"};if("arcsin$1"===b.oper)return{ctype:"string",value:"arcsinc("+d.value+")"};if("arccos$1"===b.oper)return{ctype:"string",value:"arccosc("+
d.value+")"};if("sqrt$1"===b.oper)return{ctype:"string",value:"sqrtc("+d.value+")"}}return g};t.compileToWebGL$1=function(a,b){b=E.formatForWebGL;a=a[0];var d=E.plotvars(a);-1===d.indexOf("a")&&-1===d.indexOf("b")&&-1===d.indexOf("c")&&-1===d.indexOf("d")&&-1===d.indexOf("e")&&-1===d.indexOf("f")&&(a=D(a));if("number"===a.ctype)return{ctype:"string",value:"vec2("+b(a.value.real)+","+b(a.value.imag)+")"};if("variable"===a.ctype)return{ctype:"string",value:a.name};if("string"===a.ctype||"void"===a.ctype)return a;
if(2===a.args.length&&("infix"===a.ctype||"function"===a.ctype)){b=t.compileToWebGL$1([a.args[0]],{});d=t.compileToWebGL$1([a.args[1]],{});if("+"===a.oper||"add"===a.oper)return void 0===b.value||"void"===b.ctype?{ctype:"string",value:d.value}:{ctype:"string",value:"addc("+b.value+","+d.value+")"};if("*"===a.oper||"mult"===a.oper)return{ctype:"string",value:"multc("+b.value+","+d.value+")"};if("/"===a.oper||"div"===a.oper)return{ctype:"string",value:"divc("+b.value+","+d.value+")"};if("-"===a.oper||
"sub"===a.oper)return void 0===b.value||"void"===b.ctype?{ctype:"string",value:"negc("+d.value+")"}:{ctype:"string",value:"subc("+b.value+","+d.value+")"};if("^"===a.oper||"pow"===a.oper)return{ctype:"string",value:"powc("+b.value+","+d.value+")"}}if("function"===a.ctype&&1===a.args.length){b=t.compileToWebGL$1([a.args[0]],{});if("sin$1"===a.oper)return{ctype:"string",value:"sinc("+b.value+")"};if("cos$1"===a.oper)return{ctype:"string",value:"cosc("+b.value+")"};if("tan$1"===a.oper)return{ctype:"string",
value:"tanc("+b.value+")"};if("exp$1"===a.oper)return{ctype:"string",value:"expc("+b.value+")"};if("log$1"===a.oper)return{ctype:"string",value:"logc("+b.value+")"};if("arctan$1"===a.oper)return{ctype:"string",value:"arctanc("+b.value+")"};if("arcsin$1"===a.oper)return{ctype:"string",value:"arcsinc("+b.value+")"};if("arccos$1"===a.oper)return{ctype:"string$1",value:"arccosc("+b.value+")"};if("sqrt$1"===a.oper)return{ctype:"string",value:"sqrtc("+b.value+")"}}return g};t.setsimulationspeed$1=function(a,
b){a=D(a[0]);"number"===a.ctype&&I(a.value.real);return g};t.setsimulationaccuracy$1=function(a,b){a=D(a[0]);"number"===a.ctype&&"undefined"!==typeof T&&"undefined"!==typeof T.env&&(T.env.accuracy=Math.max(1,a.value.real|0));return g};t.setsimulationquality$1=function(a,b){a=D(a[0]);"number"===a.ctype&&"undefined"!==typeof T&&"undefined"!==typeof T.env&&(a=a.value.real,0===a&&(T.env.errorbound=.01,T.env.lowestdeltat=1E-5,T.env.slowdownfactor=2),1===a&&(T.env.errorbound=.001,T.env.lowestdeltat=1E-7,
T.env.slowdownfactor=2),2===a&&(T.env.errorbound=1E-5,T.env.lowestdeltat=1E-10,T.env.slowdownfactor=4),3===a&&(T.env.errorbound=1E-6,T.env.lowestdeltat=1E-12,T.env.slowdownfactor=4));return g};var Hd=null,gd=null;t.createtool$3=function(a,b){var d="left",c="top",f=null;if(b.space){var e=x(b.space);"number"===e.ctype&&(f=e.value.real/2)}var h=null;b.toolbar&&(e=x(b.toolbar),"string"===e.ctype&&((h=document.getElementById(e.value))||console.warn("Element #"+e.value+" not found")));if(!h){if(b.reference&&
(e=x(b.reference),"string"===e.ctype))switch(e.value){case "UR":d="right";break;case "LL":c="bottom";break;case "LR":d="right",c="bottom"}h=document.createElement("div");h.className="CindyJS-toolbar";pa.parentNode.appendChild(h);e=x(a[1]);var k=x(a[2]);"number"===e.ctype&&(h.style[d]=e.value.real+"px");"number"===k.ctype&&(h.style[c]=k.value.real+"px");null!==f&&(h.style.margin=-f+"px")}a=x(a[0]);if("string"===a.ctype)a=[[a.value]];else if("list"===a.ctype)a=a.value.map(function(a){return"string"===
a.ctype?[a.value]:"list"===a.ctype?a.value.map(function(a){return"string"===a.ctype?a.value:null}):[null]});else return ra("Name must be a string or a list of strings"),g;if(b.flipped&&(e=x(b.flipped),"boolean"===e.ctype&&e.value)){ra("Flipping");var l=0;b=a.length;a.forEach(function(a){a.length>l&&(l=a.length)});e=[];for(k=0;k<l;++k){e[k]=[];for(var m=0;m<b;++m)e[k][m]=a[m][k]||null}a=e}"bottom"===c&&a.reverse();a.forEach(function(a){"right"===d&&a.reverse();var b=document.createElement("div");h.appendChild(b);
a.forEach(function(a){function d(){Hd&&Hd.classList.remove("CindyJS-active");Hd=g;g.classList.add("CindyJS-active");Ae=a;var b=K[Ae].actions;gd&&(gd.textContent=b[0].tooltip||"");db=[];Xc=Pb=0}K.hasOwnProperty(a)||(ra("Tool '"+a+"' not implemented yet."),a=null);if(null===a){var c=document.createElement("span");c.className="CindyJS-spacer";b.appendChild(c)}else{var g=document.createElement("button");c=document.createElement("img");c.src=Da.getBaseDir()+"images/"+a+".png";g.appendChild(c);g.addEventListener("click",
d);Hd||d();null!==f&&(g.style.margin=f+"px");b.appendChild(g)}})});return g};t.dropped$0=function(){return Uc};t.droppoint$0=function(){return Vc};t.parsecsv$1=function(a,b){var d=!0,c=D(b.autoconvert);"boolean"===c.ctype&&(d=c.value);c=null;b=D(b.delimiter);"string"===b.ctype&&/^[^"\r\n]$/.test(b.value)&&(c=b.value);a=D(a[0]);if("string"!==a.ctype)return ra("CSV data is not a string"),g;a=a.value;b='(?:"((?:[^"]+|"")*)"|([^]*?))(\r\n|(,)|[\r\n]|$)';c&&(c=c.replace(/[^A-Za-z0-9]/g,"\\$&").replace(/\$/g,
"$$$$"),b=b.replace(/,/g,c));b=new RegExp(b,"g");c=[];for(var e=[],h=null;b.lastIndex<a.length;){var k=b.exec(a),l=k[2];"string"===typeof k[1]&&(l=k[1].replace(/""/g,'"'));l=d?/^[Tt]rue$/.test(l)?v.bool(!0):/^[Ff]alse$/.test(l)?v.bool(!1):/^[\-+]?([0-9]+(\.[0-9]*)?|\.[0-9]+|Infinity)$/.test(l)?m.real(Number(l)):v.string(l):v.string(l);c.push(l);k[4]&&b.lastIndex===a.length&&(c.push(v.string("")),k={});if(!k[4]){null===h&&(h=c.length);if(h<c.length)for(h=c.length,k=0;k<e.length;++k)for(l=e[k].length;l<
h;++l)e[k][l]=g;else if(h>c.length)for(k=c.length;k<h;++k)c[k]=g;e.push(c);c=[]}}return f.turnIntoCSList(e.map(f.turnIntoCSList))};t.load$2=function(a,b){return t.load$3([a[0],null,a[1]],b)};t.load$3=function(a,b){function d(){if(e.readyState===XMLHttpRequest.DONE){if(200===e.status)var b=v.string(String(e.responseText));else ra("Failed to load "+f+": "+e.statusText),b=g;M.newvar(c);M.setvar(c,b);x(a[2]);M.removevar(c);q()}}var c="#";null!==a[1]&&"variable"===a[1].ctype&&(c=a[1].name);b=D(a[0]);var f=
null,e=null;"string"===b.ctype&&/^https?:\/\//.test(b.value)&&(f=b.value);return null!==f?(e=new XMLHttpRequest,e.onreadystatechange=d,e.open("GET",f),e.send(),v.bool(!0)):g};t.removeelement$1=function(a,b){a=x(a[0]);"geo"===a.ctype?Lc(a.value.name):console.log("argument of removeelement is undefined or not of type <geo>")};E.extractPoint=function(a){var b={ok:!1};if("geo"===a.ctype){var c=a.value;if("P"===c.kind)return b.x=ya.getField(c,"x").value.real,b.y=ya.getField(c,"y").value.real,b.ok=!0,b}if("list"!==
a.ctype)return b;var f=a.value;if(2===f.length&&(a=f[0],c=f[1],"number"===a.ctype&&"number"===c.ctype))return b.x=a.value.real,b.y=c.value.real,b.ok=!0,b;3===f.length&&(a=f[0],c=f[1],f=f[2],"number"===a.ctype&&"number"===c.ctype&&"number"===f.ctype&&(a=m.div(a,f),c=m.div(c,f),b.x=a.value.real,b.y=c.value.real,b.ok=!0));return b};t.draw$1=function(a,b){a=D(a[0]);if("shape"===a.ctype)E.drawshape(a,b);else if("Line"===a.usage)w.handleModifs(b,w.lineModifs),w.drawline(a);else{var d=E.extractPoint(a);
if(!d.ok){if("undefined"!==typeof a.value&&2===a.value.length)return t.draw$2(a.value,b);return}null!==b&&w.handleModifs(b,w.pointModifs);w.drawpoint(d)}return g};t.draw$2=function(a,b){var d=D(a[0]);a=D(a[1]);d=E.extractPoint(d);a=E.extractPoint(a);if(!d.ok||!a.ok)return g;null!==b&&w.handleModifs(b,w.lineModifs);w.drawsegcore(d,a);return g};t.drawcircle$2=function(a,b){return E.drawcircle(a,b,"D")};E.arcHelper=function(a){var b={};b.startPoint=P(a[0]);b.viaPoint=P(a[1]);b.endPoint=P(a[2]);return b};
t.fillcircle$2=function(a,b){return E.drawcircle(a,b,"F")};t.drawarc$3=function(a,b){a=E.arcHelper(a);return E.drawarc(a,b,"D")};t.fillarc$3=function(a,b){a=E.arcHelper(a);return E.drawarc(a,b,"F")};E.drawarc=function(a,b,c){var d=a.startPoint,e=a.viaPoint;a=a.endPoint;if(!f._helper.isAlmostReal(f.turnIntoCSList([d,e,a])))return g;w.handleModifs(b,w.conicModifs);w.preDrawCurve();b=f.det3(d,e,a);if(1E-12<Math.abs(b.value.real)){b=n._helper.ConicBy5(null,d,e,a,f.ii,f.jj);var h=n._helper.CenterOfConic(b);
h=f.normalizeMax(h);b=m.real(0);var k=f.turnIntoCSList([f.turnIntoCSList([h.value[2],b,m.neg(h.value[0])]),f.turnIntoCSList([b,h.value[2],m.neg(h.value[1])]),f.turnIntoCSList([b,b,h.value[2]])]);b=f.normalizeZ(v.mult(k,d));f.normalizeZ(v.mult(k,e));k=f.normalizeZ(v.mult(k,a));b=-Math.atan2(b.value[1].value.real,b.value[0].value.real);k=-Math.atan2(k.value[1].value.real,k.value[0].value.real);h=f.normalizeZ(h);d=f.normalizeZ(d);e=f.normalizeZ(e);a=f.normalizeZ(a);var B=f.abs(f.sub(d,h)),l=[h.value[0].value.real,
h.value[1].value.real];h=A.drawingstate.matrix;var p=l[0]*h.a-l[1]*h.b+h.tx;l=l[0]*h.c-l[1]*h.d-h.ty;d=0<f.det3(d,e,a).value.real;z.save();z.beginPath();z.translate(p,l);z.arc(0,0,B.value.real*h.sdet,b,k,d);"F"===c&&(z.fillStyle=w.lineColor,z.closePath(),z.fill());"D"===c&&z.stroke();z.restore()}else{if("D"!==c)return g;c=E.extractPoint(d);b=E.extractPoint(e);k=E.extractPoint(a);if(!c.ok||!b.ok||!k.ok)return g;B=(c.x-k.x)*(c.x-k.x)+(c.y-k.y)*(c.y-k.y);h=(k.x-b.x)*(k.x-b.x)+(k.y-b.y)*(k.y-b.y);if(1E-12>
(c.x-b.x)*(c.x-b.x)+(c.y-b.y)*(c.y-b.y)||1E-12>B||1E-12>h)return g;0>f.crossratio3(d,a,e,f.cross(f.cross(d,e),f.linfty),f.ii).value.real?w.drawsegcore(c,k):w.drawRaySegment(d,a)}return g};E.drawcircle=function(a,b,c){var d=D(a[0]);a=D(a[1]);var f=E.extractPoint(d);if(!f.ok||"number"!==a.ctype||!m._helper.isAlmostReal(a))return g;d=A.drawingstate.matrix;var e=f.x*d.a-f.y*d.b+d.tx;f=f.x*d.c-f.y*d.d-d.ty;w.handleModifs(b,w.conicModifs);w.preDrawCurve();z.lineJoin="miter";z.beginPath();z.arc(e,f,Math.abs(a.value.real)*
d.sdet,0,2*Math.PI);z.closePath();"D"===c&&z.stroke();"F"===c&&(z.fillStyle=w.lineColor,z.fill());"C"===c&&z.clip();return g};t.drawconic$1=function(a,b){a=D(a[0]);if("list"!==a.ctype||3!==a.value.length&&6!==a.value.length)return console.error("could not parse conic"),g;if(6===a.value.length){for(var d=0;6>d;d++)if("number"!==a.value[d].ctype)return console.error("could not parse conic"),g;var c=m.real(.5);d=a.value[0];var e=a.value[2];e=m.mult(e,c);var h=a.value[1],k=a.value[3];k=m.mult(k,c);var l=
a.value[4];l=m.mult(l,c);a=a.value[5];a=f.turnIntoCSList([f.turnIntoCSList([d,e,k]),f.turnIntoCSList([e,h,l]),f.turnIntoCSList([k,l,a])])}else{if(!f.isNumberMatrix(a).value||3!==a.value.length||3!==a.value[0].value.length)return g;d=f.transpose(a);f.equals(a,d).value||(a=f.add(d,a))}return E.drawconic(a,b)};E.drawconic=function(a,b){function d(a,b){a=(l*a+m*b+n)*a+(p*b+q)*b+r;return 0<=a?1:0>a?-1:NaN}function c(a){K.next=a;a.prev=K;return K=a}function g(a,b,c,f){return{a:a,b1:b,b2:c,vertical:!0,index:f,
sign:function(b){return d(a,b)},mkp:function(b){return{x:a,y:b}},sol:Yb(p,m*a+q,(l*a+n)*a+r),discr:function(){return Yb(C,-2*v,t)},tpt:function(a){return{x:a,y:-.5*(m*a+q)/p}}}}function e(a,b,c,f){return{a:a,b1:b,b2:c,vertical:!1,index:f,sign:function(b){return d(b,a)},mkp:function(b){return{x:b,y:a}},sol:Yb(l,m*a+n,(p*a+q)*a+r),discr:function(){return Yb(C,-2*y,x)},tpt:function(a){return{x:-.5*(m*a+n)/l,y:a}}}}function h(a){var b=Math.min(a.b1,a.b2),d=Math.max(a.b1,a.b2),f=a.sign(b),g=a.sign(d);
if(!isFinite(f*g))return!1;var e=a.sol;if(f!==g){if(null===e)return!1;var h=.5*(e[0]+e[1]);h>b&&h<d?(b=a.sign(h),h=e[b===g?0:1]):(f=.5*(b+d),h=e[Math.abs(f-e[0])<Math.abs(f-e[1])?0:1]);I.push(c(a.mkp(h)))}else{if(null===e){if(0>=D)return!0;e=a.discr();if(null===e)return!0;a=a.tpt(e[a.index]);a.x>=E&&a.x<=G&&a.y>=F&&a.y<=J&&c(a);return!0}h=.5*(e[0]+e[1]);if(!(h>b&&h<d))return!0;b=a.sign(h);if(b===f||isNaN(b))return!0;a.b1>a.b2&&(e=[e[1],e[0]]);I.push(c(a.mkp(e[0])));I.push(c(a.mkp(e[1])))}return!0}
function k(a,b,d,c,f){var g=b-c,e=d-a,h=a*c-b*d,B=v*g+y*e+C*h;if(1E-14>Math.abs(B))return z.lineTo(d,c);var H=(t*g+u*e+v*h)/B;g=(u*g+x*e+y*h)/B;if(!isFinite(H)||!isFinite(g)||.04>Math.abs(a*g+H*c+d*b-d*g-H*b-a*c))return z.lineTo(d,c);do if(!(10<f)){h=.5*(a+d);e=.5*(b+c);var R=H-h;B=g-e;if(!(.04>R*R+B*B)){var ma=l*R*R+m*R*B+p*B*B,ye=2*l*R*h+m*(R*e+B*h)+2*p*B*e+n*R+q*B,He=(l*h+m*e+n)*h+(p*e+q)*e+r,Ia=Yb(ma,ye,He);Ia||(Ia=[-.5*ye/ma,-2*He/ye]);if(0<Ia[0])Ia=Ia[0];else if(0<=Ia[1])Ia=Ia[1];else break;
R=h+Ia*R;B=e+Ia*B;h=R-.5*(H+h);e=B-.5*(g+e);if(!(.04>h*h+e*e)){k(a,b,R,B,f+1);k(R,B,d,c,f+1);return}}}while(0);z.quadraticCurveTo(H,g,d,c)}w.handleModifs(b,w.conicModifs);if(0!==w.lsize&&(w.preDrawCurve(),a=f.normalizeMax(a),f._helper.isAlmostReal(a))){b=A.toMat();a=f.mult(f.transpose(b),a);a=f.mult(a,b);a=f.normalizeMax(a);var l=a.value[0].value[0].value.real,m=2*a.value[0].value[1].value.real,n=2*a.value[0].value[2].value.real,p=a.value[1].value[1].value.real,q=2*a.value[1].value[2].value.real,
r=a.value[2].value[2].value.real,t=4*r*p-q*q,u=q*n-2*r*m,v=q*m-2*p*n,x=4*r*l-n*n,y=n*m-2*q*l,C=4*p*l-m*m,D=C;a=p*x+m*u+l*t-r*C;0>a&&(l=-l,m=-m,n=-n,p=-p,q=-q,r=-r,a=-a);a=w.lsize;var E=-a,F=-a,G=ia+a,J=la+a,I=[],K=a={};if(h(g(E,F,J,0))&&h(e(J,E,G,1))&&h(g(G,J,F,1))&&h(e(F,G,E,0))&&K!==a){K.next=a.next;a.next.prev=K;z.beginPath();if(0===I.length){var L=K;z.moveTo(L.x,L.y);do{var M=L.next;k(L.x,L.y,M.x,M.y,0);L=M}while(L!==K);z.closePath()}b=1===d(E,F)?0:1;if(4===I.length){var O=0;for(a=0;2>a;++a){L=
I[a];M=I[a+2];var N=M.x-L.x;L=M.y-L.y;L=(l*N+m*L)*N+p*L*L;Math.abs(L)>Math.abs(O)&&(O=L)}if(isNaN(O))return;0<=O&&(b=1-b)}for(a=b;a<I.length;a+=2)for(L=I[a],b=I[(a+1)%I.length],z.moveTo(L.x,L.y),M=L.next;L!==b;M=(L=M).next)k(L.x,L.y,M.x,M.y,0);z.stroke()}}};t.drawall$1=function(a,b){a=x(a[0]);if("list"===a.ctype)for(w.handleModifs(b,w.pointAndLineModifs),b=0;b<a.value.length;b++)t.draw$1([a.value[b]],null);return g};t.connect$1=function(a,b){return E.drawpolygon(a,b,"D",!1)};t.drawpoly$1=function(a,
b){return E.drawpolygon(a,b,"D",!0)};t.fillpoly$1=function(a,b){return E.drawpolygon(a,b,"F",!0)};t.drawpolygon$1=function(a,b){return E.drawpolygon(a,b,"D",!0)};t.fillpolygon$1=function(a,b){return E.drawpolygon(a,b,"F",!0)};E.drawpolygon=function(a,b,c,f){function d(){for(var a=k.value,b=0;b<a.length;b++){var d=a[b],c;for(c=0;c<d.length;c++){var f=d[c],e=f.X*h.a-f.Y*h.b+h.tx;f=f.X*h.c-f.Y*h.d-h.ty;0===c?z.moveTo(e,f):z.lineTo(e,f)}z.closePath()}}function e(){var a;for(a=0;a<k.value.length;a++){var b=
E.extractPoint(k.value[a]);if(!b.ok)return;var d=b.x*h.a-b.y*h.b+h.tx;b=b.x*h.c-b.y*h.d-h.ty;0===a?z.moveTo(d,b):z.lineTo(d,b)}f&&z.closePath()}w.handleModifs(b,f?w.conicModifs:w.lineModifs);w.preDrawCurve();var h=A.drawingstate.matrix,k=x(a[0]);z.beginPath();"list"===k.ctype&&e();"shape"===k.ctype&&d();"D"===c&&(w.fillColor&&(z.fillStyle=w.fillColor,z.fill(w.fillrule)),z.stroke());"F"===c&&(z.fillStyle=w.lineColor,z.fill(w.fillrule));"C"===c&&z.clip();return g};var re=bd,Fe=function(a,b,c){if(-1!==
b.indexOf("\n"))for(b=b.split("\n"),a.textContent=b[0],c=1;c<b.length;++c)a.appendChild(document.createElement("br")),a.appendChild(document.createTextNode(b[c]));else a.textContent=b};E.drawtext=function(a,b,c){var d=D(a[0]);a=x(a[1]);var f=E.extractPoint(d);if(!f.ok)return null;w.handleModifs(b,w.textModifs);b=A.drawingstate.textsize;null===b&&(b=va.textsize);null!==w.size&&(b=w.size);z.fillStyle=w.textColor;var e=A.drawingstate.matrix;d=f.x*e.a-f.y*e.b+e.tx+w.xOffset;f=f.x*e.c-f.y*e.d-e.ty-w.yOffset;
a=ca(a);Da._pluginRegistry.katex||"string"!==typeof a||3<=a.split("$").length&&ba("katex","katex-plugin.js",!0);z.font=w.bold+w.italics+Math.round(10*b)/10+"px "+w.family;return c?c(a,d,f,w.align,b):re(z,a,d,f,w.align,b,b*va.lineHeight,w.angle)};t.drawtext$2=function(a,b){E.drawtext(a,b,null);return g};t.drawtable$2=function(a,b){var d=D(a[0]);a=D(a[1]);var c=E.extractPoint(d);if(!c.ok||"list"!==a.ctype)return g;d=a.value;a=d.length;var e=-1,h;for(h=0;h<a;++h)"list"===d[h].ctype&&d[h].value.length>
e&&(e=d[h].value.length);-1===e?(d=d.map(function(a){return[a]}),e=1):d=d.map(function(a){return f.asList(a).value});var k=100,l=null,m=!0,n=A.drawingstate.textcolor;w.handleModifs(b,{size:!0,color:function(a){f._helper.isNumberVecN(a,3)&&(n=w.makeColor([a.value[0].value.real,a.value[1].value.real,a.value[2].value.real]))},alpha:!0,bold:!0,italics:!0,family:!0,align:!0,x_offset:!0,y_offset:!0,offset:!0,width:function(a){"number"===a.ctype&&(k=a.value.real)},height:function(a){"number"===a.ctype&&
(l=a.value.real)},border:function(a){"boolean"===a.ctype&&(m=a.value)}});h=A.drawingstate.textsize;null===h&&(h=va.textsize);null!==w.size&&(h=w.size);null===l&&(l=1.6*h);z.font=w.bold+w.italics+Math.round(10*h)/10+"px "+w.family;h=A.drawingstate.matrix;var p=e*k,q=a*l;b=c.x*h.a-c.y*h.b+h.tx+w.xOffset;var r=c.x*h.c-c.y*h.d-h.ty-w.yOffset-q;if(m){w.preDrawCurve();z.strokeStyle=w.lineColor;z.beginPath();for(h=1;h<a;++h)z.moveTo(b,r+h*l),z.lineTo(b+p,r+h*l);for(c=1;c<e;++c)z.moveTo(b+c*k,r),z.lineTo(b+
c*k,r+q);z.stroke();z.lineWidth=w.lsize+1;z.beginPath();z.rect(b,r,p,q);z.stroke()}b+=w.align*k+(1-2*w.align)*l*.3;r+=.7*l;z.fillStyle=n;for(h=0;h<a;++h)for(c=0;c<e;++c)p=ca(d[h][c]),re(z,p,b+c*k,r+h*l,w.align);return g};E.drawshape=function(a,b){return"polygon"===a.type?E.drawpolygon([a],b,"D",1):"circle"===a.type?E.drawcircle([a.value.value[0],a.value.value[1]],b,"D"):g};E.fillshape=function(a,b){return"polygon"===a.type?E.drawpolygon([a],b,"F",1):"circle"===a.type?E.drawcircle([a.value.value[0],
a.value.value[1]],b,"F"):g};E.clipshape=function(a,b){return"polygon"===a.type?E.drawpolygon([a],b,"C",1):"circle"===a.type?E.drawcircle([a.value.value[0],a.value.value[1]],b,"C"):g};t.fill$1=function(a,b){a=x(a[0]);return"shape"===a.ctype?E.fillshape(a,b):g};t.clip$1=function(a,b){var d=x(a[0]);return"shape"===d.ctype?E.clipshape(d,b):"list"===d.ctype?(a=t.polygon$1(a,[]),t.clip$1([a],[])):g};t.plot$1=function(a,b){return t.plot$2([a[0],null],b)};t.plot$2=function(a,b){function c(a){return"number"===
a.ctype&&m._helper.isAlmostReal(a)}function d(a,b,c,d,f){l++;b=+b.value.real;f=+d.value.real;d=b*y.a-f*y.b+y.tx;b=b*y.c-f*y.d-y.ty;a=+a.value.real;f=+c.value.real;c=a*y.a-f*y.b+y.tx;a=a*y.c-f*y.d-y.ty;n?(z.lineTo(c,a),z.lineTo(d,b)):(z.beginPath(),z.moveTo(c,a),z.lineTo(d,b),n=!0)}function e(a,b,f,g,B){var l=c(f),H=c(g);if(.001>B)!h&&n&&(z.stroke(),n=!1);else if(l||H){var p=m.real((a.value.real+b.value.real)/2);M.setvar(v,p);var q=x(u),R=c(q);if(l&&H&&R){var ma=f.value.real;H=q.value.real;R=g.value.real;
if(l=1>Math.abs(ma+R-2*H)/k){var r=m.real((a.value.real+p.value.real)/2);M.setvar(v,r);r=x(u);var t=m.real((p.value.real+b.value.real)/2);M.setvar(v,t);t=x(u);ma=Math.abs(ma+H-2*r.value.real)/k;H=Math.abs(H+R-2*t.value.real)/k;l=l&&1>ma&&1>H}l?(d(a,p,f,q,B/2),d(p,b,q,g,B/2)):(e(a,p,f,q,B/2),e(p,b,q,g,B/2))}else e(a,p,f,q,B/2),e(p,b,q,g,B/2)}}var h=!1,k=.2/Rc,l=0,n=!1,p=-10,q=10,r=.1,t=1E3,u=a[0];if(null!==a[1]&&"variable"===a[1].ctype)var v=a[1].name;else a=E.plotvars(u),v="#",-1!==a.indexOf("t")&&
(v="t"),-1!==a.indexOf("z")&&(v="z"),-1!==a.indexOf("y")&&(v="y"),-1!==a.indexOf("x")&&(v="x");M.newvar(v);var y=A.drawingstate.matrix;w.handleModifs(b,{color:!0,alpha:!0,size:!0,dashpattern:!0,dashtype:!0,dashing:!0,lineCap:!0,lineJoin:!0,miterLimit:!0,connect:function(a){"boolean"===a.ctype&&(h=a.value)},start:function(a){"number"===a.ctype&&(p=a.value.real)},stop:function(a){"number"===a.ctype&&(q=a.value.real)},steps:function(a){"number"===a.ctype&&(t=a.value.real)}});z.strokeStyle=w.lineColor;
z.lineWidth=w.lsize;n=!1;b=m.real(14.32);M.setvar(v,b);var C=x(u);if("number"!==C.ctype){if(f.isNumberVector(C).value&&2===C.value.length){n=!1;r=(q-p)/t;for(b=p;b<q;b+=r){M.setvar(v,m.real(b));var D=x(u);if(f.isNumberVector(D).value&&2===D.value.length){var F=+D.value[0].value.real;D=+D.value[1].value.real;a=F*y.a-D*y.b+y.tx;F=F*y.c-D*y.d-y.ty;n?z.lineTo(a,F):(z.beginPath(),z.moveTo(a,F),n=!0)}}z.stroke();M.removevar(v)}return g}for(a=p;a<q+r;a+=r)b=m.real(a),M.setvar(v,b),C=x(u),b.value.real>p&&
e(F,b,D,C,r),F=b,D=C;M.removevar(v);n&&z.stroke();return g};t.plotX$1=function(a,b){a=a[0];var c=E.plotvars(a);b="#";-1!==c.indexOf("t")&&(b="t");-1!==c.indexOf("z")&&(b="z");-1!==c.indexOf("y")&&(b="y");-1!==c.indexOf("x")&&(b="x");M.newvar(b);c=A.drawingstate.matrix;z.fillStyle=A.drawingstate.linecolor;z.lineWidth=1;z.lineCap=w.lineCap;z.lineJoin=w.lineJoin;z.miterLimit=w.miterLimit;for(var d=!1,f=-10;10>f;f+=.01){M.setvar(b,m.real(f));var e=x(a);if("number"===e.ctype){var h=+e.value.real;e=f*c.a-
h*c.b+c.tx;h=f*c.c-h*c.d-c.ty;d?z.lineTo(e,h):(z.beginPath(),z.moveTo(e,h),d=!0)}}z.stroke();M.removevar(b);return g};E.plotvars=function(a){function b(a,b){var c={},d;for(d=a.length-1;0<=d;--d)c[a[d]]=a[d];for(d=b.length-1;0<=d;--d)c[b[d]]=b[d];a=[];for(var f in c)c.hasOwnProperty(f)&&a.push(c[f]);return a}function c(a,b){for(var c=0;c<a.length;c++)a[c]===b&&(a.splice(c,1),c--);return a}var f;if("variable"===a.ctype)return[a.name];if("infix"===a.ctype){var e=E.plotvars(a.args[0]);a=E.plotvars(a.args[1]);
return b(e,a)}if("list"===a.ctype){var g=a.value;var h=[];for(f=0;f<g.length;f++)e=E.plotvars(g[f]),h=b(h,e);return h}if("function"===a.ctype){g=a.args;h=[];for(f=0;f<g.length;f++)e=E.plotvars(g[f]),h=b(h,e);"apply"!==a.oper&&"select"!==a.oper&&"forall"!==a.oper&&"sum"!==a.oper&&"product"!==a.oper&&"repeat"!==a.oper&&"min"!==a.oper&&"max"!==a.oper&&"sort"!==a.oper||"variable"!==a.args[1].ctype||(h=c(h,a.args[1].name));return h}return[]};t.clrscr$0=function(a,b){"undefined"!==typeof ia&&"undefined"!==
typeof la&&z.clearRect(0,0,ia,la);return g};t.repaint$0=function(a,b){q();return g};t.screenbounds$0=function(a,b){a=v.withUsage(f.realVector(A.to(0,0)),"Point");b=v.withUsage(f.realVector(A.to(pa.clientWidth,0)),"Point");var c=v.withUsage(f.realVector(A.to(pa.clientWidth,pa.clientHeight)),"Point"),d=v.withUsage(f.realVector(A.to(0,pa.clientHeight)),"Point");return f.turnIntoCSList([a,b,c,d])};t.createimage$3=function(a,b){b=x(a[0]);var c=D(a[1]);a=D(a[2]);if("number"!==c.ctype||"number"!==a.ctype||
"string"!==b.ctype)return g;var d=document.createElement("canvas");d.id=b.value;d.width=c.value.real;d.height=a.value.real;d.style.display="none";document.body.appendChild(d);bb[b.value]=C(d,!1);return g};t.clearimage$1=function(a,b){a=x(a[0]);if("string"!==a.ctype&&"image"!==a.ctype)return g;a=Ua(a);if(!a)return g;b=a.img;if("undefined"===typeof b||null===b)return g;var c=a.width,d=a.height;b.getContext("2d").clearRect(0,0,c,d);a.generation++;return g};t.canvas$4=function(a,b){var c=D(a[0]),d=D(a[1]);
b=x(a[2]);a=a[3];var f=E.extractPoint(c),e=E.extractPoint(d);if(!f.ok||!e.ok||"string"!==b.ctype&&"image"!==b.ctype)return g;b=Ua(b);if(!b||!b.img.getContext)return g;d=b.img;var h=b.width;c=b.height;var k=e.x-f.x,l=e.y-f.y,m=f.x-l*c/h,n=f.y+k*c/h;l=e.x-l*c/h;k=e.y+k*c/h;e=A.from(f.x,f.y,1);m=A.from(m,n,1);l=A.from(l,k,1);f=e[0]*sa;n=e[1]*sa;k=m[0]*sa;var p=m[1]*sa,q=l[0]*sa,r=l[1]*sa;m=h*(n-p)/((f-k)*(n-r)-(f-q)*(n-p));h=h*(f-k)/((n-p)*(f-q)-(n-r)*(f-k));l=-m*f-h*n;e=(c*(n-r)-c*(n-p))/((f-k)*(n-
r)-(f-q)*(n-p));k=(c*(f-q)-c*(f-k))/((n-p)*(f-q)-(n-r)*(f-k));c=c-e*f-k*n;d=d.getContext("2d");f=z;z=d;z.save();z.transform(m,e,h,k,l,c);b.generation++;x(a);z.restore();z=f};t.canvas$5=function(a,b){var c=D(a[0]),d=D(a[1]),f=D(a[2]);b=x(a[3]);a=a[4];c=E.extractPoint(c);var e=E.extractPoint(d),h=E.extractPoint(f);if(!c.ok||!e.ok||!h.ok||"string"!==b.ctype&&"image"!==b.ctype)return g;b=Ua(b);if(!b||!b.img.getContext)return g;f=b.img;var k=b.width;d=b.height;var l=A.from(c.x,c.y,1),m=A.from(e.x,e.y,
1);e=A.from(h.x,h.y,1);c=l[0]*sa;h=l[1]*sa;var n=m[0]*sa,p=m[1]*sa,q=e[0]*sa,r=e[1]*sa;e=((0-k)*(h-r)-0*(h-p))/((c-n)*(h-r)-(c-q)*(h-p));k=((0-k)*(c-q)-0*(c-n))/((h-p)*(c-q)-(h-r)*(c-n));m=-(e*c)-k*h;l=((d-d)*(h-r)-(d-0)*(h-p))/((c-n)*(h-r)-(c-q)*(h-p));n=((d-d)*(c-q)-(d-0)*(c-n))/((h-p)*(c-q)-(h-r)*(c-n));d=d-l*c-n*h;f=f.getContext("2d");c=z;z=f;z.save();z.transform(e,l,k,n,m,d);b.generation++;x(a);z.restore();z=c};t.screenresolution$0=function(a,b){return m.real(A.drawingstate.matrix.a)};t.layer$1=
function(a,b){};t.imagesize$1=function(a,b){return(a=Ua(D(a[0])))?f.realVector([+a.width,+a.height]):g};t.imageready$1=function(a,b){a=Ua(D(a[0]));return v.bool(!(!a||!a.ready))};t.drawimage$2=function(a,b){function c(){var a=1,c=1,d=1,k=1,B=0,l=1,m=E.extractPoint(e);if(!m.ok)return g;h=Ua(h);if(!h)return g;z.save();if(void 0!==b.angle){var n=x(b.angle);"number"===n.ctype&&(B=n.value.real)}void 0!==b.rotation&&(n=x(b.rotation),"number"===n.ctype&&(B=n.value.real));void 0!==b.scale&&(n=D(b.scale),
"number"===n.ctype&&(c=a=n.value.real),f.isNumberVector(n).value&&2===n.value.length&&(a=n.value[0].value.real,c=n.value[1].value.real));void 0!==b.scalex&&(n=x(b.scalex),"number"===n.ctype&&(a=n.value.real));void 0!==b.scaley&&(n=x(b.scaley),"number"===n.ctype&&(c=n.value.real));void 0!==b.flipx&&(n=x(b.flipx),"boolean"===n.ctype&&n.value&&(d=-1));void 0!==b.flipy&&(n=x(b.flipy),"boolean"===n.ctype&&n.value&&(k=-1));void 0!==b.alpha&&(n=x(b.alpha),"number"===n.ctype&&(l=n.value.real));z.imageSmoothingEnabled=
!0;void 0!==b.interpolate&&(n=x(b.interpolate),"boolean"===n.ctype&&(z.imageSmoothingEnabled=n.value));var H=A.drawingstate.matrix,p=A.drawingstate.initialmatrix,q=h.width,R=h.height;n=m.x*H.a-m.y*H.b+H.tx;var r=m.x*H.c-m.y*H.d-H.ty,ma=(m.x+1)*H.a-m.y*H.b+H.tx-n;H=(m.x+1)*H.c-m.y*H.d-H.ty-r;var t=(m.x+1)*p.a-m.y*p.b+p.tx-(m.x*p.a-m.y*p.b+p.tx);p=(m.x+1)*p.c-m.y*p.d-p.ty-(m.x*p.c-m.y*p.d-p.ty);m=Math.sqrt(ma*ma+H*H)/Math.sqrt(t*t+p*p);ma=-Math.atan2(ma,H)+Math.atan2(t,p);H=A.drawingstate.matrix.sdet/
72;a*=H;c*=H;1!==l&&(z.globalAlpha=l);z.translate(n,r);z.scale(a*d*m,c*k*m);z.rotate(B+ma);z.translate(-n,-r);z.translate(-q/2,-R/2);a=h;a.drawTo?a.drawTo(z,n,r):z.drawImage(a.img,n,r);z.globalAlpha=1;z.restore()}function d(){var a=1,c=1,d=1,f=1,B=E.extractPoint(e),m=E.extractPoint(k);if(!B.ok||!m.ok)return g;h=Ua(h);if(!h)return g;var n=h.width,H=h.height;if(0===l){var p={};p.x=B.x-(m.y-B.y);p.y=B.y+(m.x-B.x);f=H/n}else if(p=E.extractPoint(l),!B.ok)return g;z.save();if(void 0!==b.alpha){var q=x(b.alpha);
"number"===q.ctype&&(a=q.value.real)}void 0!==b.aspect&&(q=x(b.aspect),"number"===q.ctype&&(f=q.value.real));void 0!==b.flipx&&(q=x(b.flipx),"boolean"===q.ctype&&q.value&&(c=-1));void 0!==b.flipy&&(q=x(b.flipy),"boolean"===q.ctype&&q.value&&(d=-1));z.imageSmoothingEnabled=!0;void 0!==b.interpolate&&(q=x(b.interpolate),"boolean"===q.ctype&&(z.imageSmoothingEnabled=q.value));q=A.drawingstate.matrix;1!==a&&(z.globalAlpha=a);a=B.x*q.a-B.y*q.b+q.tx;B=B.x*q.c-B.y*q.d-q.ty;z.transform(m.x*q.a-m.y*q.b+q.tx-
a,m.x*q.c-m.y*q.d-q.ty-B,p.x*q.a-p.y*q.b+q.tx-a,p.x*q.c-p.y*q.d-q.ty-B,a,B);z.scale(1/n,-1/H*f);z.translate(n/2,-H/2);z.scale(c,d);z.translate(-n/2,H/2);z.translate(0,-H);c=h;c.drawTo?c.drawTo(z,0,0):z.drawImage(c.img,0,0);z.globalAlpha=1;z.restore()}if(2===a.length){var e=D(a[0]);var h=D(a[1]);return c()}if(3===a.length){e=D(a[0]);var k=D(a[1]);var l=0;h=D(a[2]);return d()}return 4===a.length?(e=D(a[0]),k=D(a[1]),l=D(a[2]),h=D(a[3]),d()):g};t.drawimage$3=t.drawimage$2;t.drawimage$4=t.drawimage$2;
t.allimages$0=function(){var a=[];Object.keys(bb).forEach(function(b){a.push({ctype:"string",value:b})});return f.turnIntoCSList(a)};var sd={};t.cameravideo$0=function(a,b){function c(a){return{video:{width:a,advanced:[{width:{max:a,min:a}},{width:{ideal:a}}]},audio:!1}}a=!0;var d={};void 0!==b.resolution&&(b=x(b.resolution),"string"===b.ctype&&"maximal"===b.value?a=!0:"number"===b.ctype?(a=!1,d=c(b.value.real)):f._helper.isNumberVecN(b,2)&&(a=!1,d=c(b.value[0].value.real),b=b.value[1].value.real,
10>b||!Number.isInteger(b)?(d.video.aspectRatio=b,d.video.advanced[0].aspectRatio={min:b,max:b},d.video.advanced[1].aspectRatio={ideal:b}):(d.video.height=b,d.video.advanced[0].height={min:b,max:b},d.video.advanced[1].height={ideal:b})));a&&(d=[320,640,1024,1280,1920,2560],d=d.map(function(a){return{width:{min:a}}}),d={video:{width:16E3,height:9E3,advanced:d},audio:!1});a=JSON.stringify(d);if(sd[a])return sd[a];b=null;var e=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia;e?b=function(a,
b){navigator.mediaDevices.getUserMedia(d).then(a,b)}:(e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)&&(b=function(a,b){e.call(navigator,d,a,b)});if(!b)return console.warn("getUserMedia call not supported"),sd[a]=g;var h=document.createElement("video");h.autoplay=!0;sd[a]=C(h,!0);console.log("Opening stream.");b(function(a){h.srcObject=a;h.setAttribute("autoplay","");h.setAttribute("muted","");h.setAttribute("playsinline","");h.play();h.addEventListener("loadeddata",
G)},function(a){console.error("Could not get user video:",String(a),a)});return sd[a]};t.playvideo$1=function(a,b){a=Ua(D(a[0]));a.live&&a.img.play&&a.img.play();return g};t.pausevideo$1=function(a,b){a=Ua(D(a[0]));a.live&&a.img.pause&&a.img.pause();return g};var td;t.imagergba$3=function(a,b){b=Ua(D(a[0]));var c=D(a[1]);a=D(a[2]);if(!b||"number"!==c.ctype||"number"!==a.ctype||!b.ready)return g;c=Math.round(c.value.real);a=Math.round(a.value.real);if(!Wa(c)||!Wa(a))return g;a=Db(b,c,a,1,1);return f.realVector([255*
a[0],255*a[1],255*a[2],a[3]])};t.imagergb$3=t.imagergba$3;t.imagergba$4=function(a,b){var c=Ua(D(a[2]));if(!c||!c.ready)return g;var d=c.width,e=c.height,h=P(a[0]),k=P(a[1]),l=P(f.realVector([0,e,1]));d=P(f.realVector([d,e,1]));if(h===g||k===g||m===g)return g;m=f.ii;e=f.jj;l=E.basismap(l,d,m,e);h=E.basismap(h,k,e,m);var m=P(a[3]);e=E.extractPoint(v.mult(l,v.mult(f.adjoint3(h),m)));if(e.ok)if(a=c.width,h=c.height,k=!0,l=!1,void 0!==b.interpolate&&(m=x(b.interpolate),"boolean"===m.ctype&&(k=m.value)),
void 0!==b.repeat&&(m=x(b.repeat),"boolean"===m.ctype&&(l=m.value)),k&&(e.x-=.5,e.y-=.5),l&&(e.x=(e.x%a+a)%a,e.y=(e.y%h+h)%h),m=Math.floor(e.x),d=Math.floor(e.y),Wa(m)&&Wa(d)){b=[0,0,0,0];if(k){k=e.x-m;e=e.y-d;var n=Db(c,m,d,2,2);if(l){if(m===a-1||d===h-1){l=Db(c,(m+1)%a,d,1,1);var p=Db(c,m,(d+1)%h,1,1);c=Db(c,(m+1)%a,(d+1)%h,1,1);n=n.slice(0,4).concat(l,p,c)}}else{if(-1===m||m===a-1)k=Math.round(k);if(-1===d||d===h-1)e=Math.round(e)}for(c=0;4>c;c++)b[c]=(1-e)*((1-k)*n[c]+k*n[c+4])+e*((1-k)*n[c+8]+
k*n[c+12])}else b=Db(c,m,d,1,1);c=f.realVector(b)}else c=g;else c=g;return c};t.imagergb$4=function(a,b){a=t.imagergba$4(a,b);return a===g?g:f.turnIntoCSList(a.value.slice(0,3))};t.readpixels$1=function(a,b){a=Ua(D(a[0]));a=Db(a,0,0,a.width,a.height);b=[];for(var c=0;c+3<a.length;c+=4)b.push(f.turnIntoCSList([m.real(a[c+0]),m.real(a[c+1]),m.real(a[c+2]),m.real(a[c+3])]));return f.turnIntoCSList(b)};"use strict";var Re=[{key:[":"],field:["."],deg:["\u00b0"],take:["_"]},{functionCall:!0},{rassoc:!0,
pow:["^"],sqrt:["\u221a"]},{mul:["*","\u2062","\u22c5","\u00b7"],cross:["\u00d7"],div:["/","\u00f7","\u2215","\u2236"]},{add:["+"],sub:["-","\u2212"],neg:["!","\u00ac"]},{seq:[".."]},{eq:["==","\u225f"],ne:["!=","<>","\u2260"],lt:["<"],gt:[">"],le:["<=","\u2264","\u2266"],ge:[">=","\u2265","\u2267"],aeq:["~=","\u2248"],ane:["~!=","\u2249"],alt:["~<","\u2a89"],agt:["~>","\u2a8a"],ale:["~<=","\u2a85"],age:["~>=","\u2a86"],"in":["\u2208"],nin:["\u2209"]},{and:["&","\u2227"],or:["%","\u2228"]},{rassoc:!0,
prepend:["<:"]},{concat:["++","\u222a"],remove:["--","\u2216"],common:["~~","\u2229"],append:[":>"]},{rassoc:!0,assign:["="],define:[":="],undefine:[":=_"],bdefine:["::="]},{seq:[";"]},{modif:["->","\u2192"]},{rassoc:!0,list:[","]}],Se=["+","-"],Qe=["!","\u221a"],Ne=["\u00b0",":=_"],Oe=[";",","],qe=[],hb={},be;(function(){var a=0;Re.forEach(function(b){a+=2;var c=!!b.rassoc;b.functionCall&&(be=a);for(var d in b){var f=b[d];if("boolean"!==typeof f)for(var e={name:d,sym:f[0],symbols:f,rassoc:c,precedence:a,
prefix:!1,postfix:!1,infix:!0,bare:!1},g=0;g<f.length;++g){var h=f[g];if(hb.hasOwnProperty(h))throw Error("Duplicate operator: "+h);hb[h]=e;qe.push(h)}}});Se.forEach(function(a){hb[a].prefix=!0});Qe.forEach(function(a){hb[a].prefix=!0;hb[a].infix=!1});Ne.forEach(function(a){hb[a].postfix=!0;hb[a].infix=!1});Oe.forEach(function(a){hb[a].prefix=!0;hb[a].postfix=!0;hb[a].infix=!0;hb[a].bare=!0})})();qe.sort(function(a,b){return b.length-a.length});var rd="(?:[0-9](?: [0-9])*(?: \\.(?! \\.)(?: [0-9])*)?|\\.(?: [0-9])+)(?: [Ee](?: [+-])?(?: [0-9])+)?".replace(/ /g,
"[ \t]*"),Pe="(?:[\u207a\u207b] )?[\u2070\u00b9\u00b2\u00b3\u2074\u2075\u2076\u2077\u2078\u2079](?: [\u2070\u00b9\u00b2\u00b3\u2074\u2075\u2076\u2077\u2078\u2079])*".replace(/ /g,"[ \t]*"),se="(?:[\u208a\u208b] )?[\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089](?: [\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089])*".replace(/ /g,"[ \t]*"),uc=function(a,b,c){var d,f=0,e="(?:[",g=b.length;for(d=0;d<g;++d){var h=b.charCodeAt(d);55296<=h?(e+="]|"+b.charAt(d)+"[",f=56320):(e+=
String.fromCharCode(h=f=a[h-32]+f),f+=a[b.charCodeAt(++d)-32],f!==h&&(f!==h+1&&(e+="-"),e+=String.fromCharCode(f)))}return e+"]|["+c+"][\udc00-\udfff])"}([2,0,106,3,4,1,6,5,7,11,17,8,12,21,9,22,30,10,15,24,25,16,13,42,46,14,18,19,29,37,27,28,35,26,32,36,40,43,47,53,20,48,50,56,33,34,39,51,52,55,63,64,65,68,85,23,31,38,45,49,105,59,66,69,72,88,102,114,117,128,157,191,41,44,54,60,67,70,71,73,74,75,76,80,81,82,83,84,86,87,89,93,94,98,99,107,108,116,122,130,132,134,138,160,165,185,195,196,255,268,277,
310,332,339,362,365,390,449,457,470,512,513,541,568,582,619,673,726,768,820,921,991,1164,2684,6581,8453,11171,20949],"T4(4I!)!'!&/ 0 \u0096')2$+! !\u0083$ %## !(!   ! ; u \u0086.\u0088 =#!+YoA& 87C% } !5%+%) #!*! <0a,!4B1%'!&-'!1!$!33`HsG$!;!+.52'(#%#- & !$#$!*!9%  2%H''%#- & % % %B# !H *+   - & % $$!;!5%3!,(#%#- & % $$!X%  5!:! '$  #$% ! %$%$ $)W!G(   / 2$!> &%C(   / . $$!L! %5%;(   D#!*!* 4'&*$W + !#&]F %6&]% !#% !#!(# &   ! !#% # %1!#$ !/#L!S( @?$\u00817-!*''#$!$%+ ',6!:= !&!#7 \u0090 ##& ! ##D ##B ##& ! ##9 K ##^Y2*V#'$\u009d#5 4&p((+, #2*2*2,  5OC!'!Uy.D !&_)0J<#$,E'4Q/1Pv!|8:&K<9%)E>@7 )@\u0080# #$%1gT\u008e#'#=#'#( ! ! ! 0#P & !$  &$##'',&  &d!9!*,b!'!#. !$$(! ! ! # 1##&$'!G%\u00a58 8 \u0084(#$%6= !&!#Q+!*/1& & & & & & & &t!\u0097%E$&%'V(  z #&D${:Aj2\u0099\u00a6q\u00a9E\u00a4UZ#\u008d$2)%-8*0#_J+#b#M#(S1   # /0O2[R'$! !6>)/A?+8<!*$ .)$ D3  (-/$!$[ !$%#$#! !4 #1+ 6'#'#'1& & 7 .)c0\u00a86/'I\u00a7\u0093#\\N&6$&! . , $ ! % % \u007fM\u0092;R#Gh)d$ \u0085=4(4,a$'#'#'# \ud800!) 4 : % 9#6@\u0082\u0094?$IIX*5 ((=)<#@'(\ud801!f~N.Of\u008f1-)(\ud802!'#! E %$!#/)/10^: %)-)4nQ(%T!5#   AZ?$?C( >?G)-):9*\ud803!`KJ9J\ud804#PriL3>@7M$!6F2#/! !C* 3V& ! # 9 .+8N(#%#- & % $$!;!6$\ud805eF-% !\u008987#=F-!k7x4\ud806\u0087RB!\u0095K\ud808!\u00a2\ud809e\u008a\ud80d!8\ud811!\u009c\ud81a!\u009b+0c<;F*#BH&:\ud81b\u00a0U,!l,\ud82c!%\ud82f!\"&,$++.\ud835!w m %#!#%## ) ! & S ##( & > # $ !$& \u0091#3 3 0 3 0 3 0 3 0 3 (\ud83a!\u008b\ud83b\u0098# A % !#! . # ! !(!'! ! !   % !#! ! ! ! ! % !## & # # ! . 5&  $ 5\ud869!\u009f7\u008c\ud86d!\u00a1,g\ud86e!<#\u00a3\ud873!\u009e\ud87e!\u009a",
"\ud80c\ud840-\ud868\ud86a-\ud86c\ud86f-\ud872"),te=("#(?: [1-9])?|(?:'|"+uc+")(?: (?:[0-9']|"+uc+"))*").replace(/ /g,"[ \t]*"),Ge=["([ \t\n\r]+)|(//.*)|(/\\*)","("+rd+")","("+qe.map(cd).join("|")+")","("+"[](){}||".split("").map(cd).join("|")+")","("+se+")","("+Pe+")","("+te+")",'("[^"]*")|($)'].join("|"),Te=new RegExp("[ \t]*".replace(/\*$/,"+"),"g"),ue="ANY WS COMMENT START_COMMENT NUM OP BRA SUB SUP ID STR EOF".split(" ");(function(){var a=(new RegExp(Ge,"g")).exec("");if(a.hasOwnProperty(ue.length))throw Error("RE has more groups than expected");
if(!a.hasOwnProperty(ue.length-1))throw Error("RE has fewer groups than expected");})();Tb.prototype.advanceBy=function(a){this.advanceTo(this.pos+a)};Tb.prototype.advanceTo=function(a){for(this.pos=a;this.bols[0]<=a;)this.bol=this.bols.shift(),this.line++};Tb.prototype.curPos=function(){return{row:this.line,col:this.pos-this.bol,pos:this.pos}};Tb.prototype.nextInternal=function(){var a=this.re.exec(this.input);if(a.index!==this.pos)throw ta("Invalid token",this.curPos(),this.input.substring(this.pos,
a.index));var b=this.curPos();this.advanceBy(a[0].length);var c=this.curPos(),f;for(f=1;null==a[f];++f);return{start:b,end:c,raw:a[0],text:a[0].replace(Te,""),toktype:ue[f]}};Tb.prototype.next=function(){do{var a=this.nextInternal();if("START_COMMENT"===a.toktype){var b=/\*\/|\/\*/g;b.lastIndex=a.start.pos+2;for(var c=1,f;0<c;)if(f=b.exec(this.input))"/*"===f[0]?++c:--c;else throw ta("Unterminated comment",a.start,a.text);this.re.lastIndex=b.lastIndex;this.advanceTo(b.lastIndex);a.end=this.curPos();
a.raw=this.input.substring(a.start.pos,a.end.pos);a.text=a.raw;a.toktype="COMMENT"}}while("WS"===a.toktype||"COMMENT"===a.toktype);return a};var ud={ctype:"void"};mc.prototype.postprocess=function(a){if(null===a)return ud;if(a){if("infix"===a.ctype)if(":="===a.oper){var b=a.args[0];if("function"===b.ctype)b.args.forEach(function(b){if(null===b||"variable"!==b.ctype)throw ta("Function argument must be an identifier",b.start||a.start);});else if("variable"!==b.ctype)throw ta(a.oper+" can only be used to define functions or variables",
a.start);}else if(","===a.oper)throw ta("comma may only be used to delimit list elements",a.start);a.args&&(a.args=a.args.map(this.postprocess,this));if(a.modifs)for(var c in a.modifs)a.modifs[c]=this.postprocess(a.modifs[c]);if("paren"===a.ctype)return a.args[0];if("infix"===a.ctype){if("."===a.oper){if(!a.args[1]||"variable"!==a.args[1].ctype)throw ta("Field name must be identifier",a.start,a.text);a.ctype="field";a.obj=a.args[0];a.key=a.args[1].name;delete a.args}if(":"===a.oper){if(!a.args[1])throw ta("Data key undefined",
a.start,a.text);a.ctype="userdata";a.obj=a.args[0];a.key=a.args[1];delete a.args}this.infixmap&&(a.impl=this.infixmap[a.oper])}else"variable"===a.ctype?this.usedVariables[a.name]=!0:"function"===a.ctype&&(this.usedFunctions[a.oper]=!0)}if("infix"===a.ctype)return{ctype:"infix",oper:String(a.oper),args:[a.args[0],a.args[1]],impl:a.impl};if("variable"===a.ctype)return{ctype:"variable",name:String(a.name)};if("number"===a.ctype)return{ctype:"number",value:{real:+a.value.real,imag:+a.value.imag}};if("string"===
a.ctype)return{ctype:"string",value:String(a.value)};if("list"===a.ctype)return{ctype:"list",value:a.value};if("function"===a.ctype)return{ctype:"function",oper:String(a.oper),args:a.args,modifs:a.modifs};if("field"===a.ctype)return{ctype:"field",obj:a.obj,key:String(a.key)};if("userdata"===a.ctype)return{ctype:"userdata",obj:a.obj,key:a.key};throw Error("Unsupported AST node of type "+a.ctype);};mc.prototype.parse=function(a){try{var b=ed(new Tb(a));if("EOF"!==b.closedBy.toktype)throw ta("Closing bracket never opened.",
b.closedBy.start,b.closedBy.text);return this.postprocess(b.expr)}catch(B){return B.ctype="error",B}};"undefined"!==typeof process&&"undefined"!==typeof module&&"undefined"!==typeof module.exports&&"undefined"===typeof window&&(module.exports.Parser=mc,module.exports.Tokenizer=Tb,module.exports.unicodeLetters=uc,module.exports.parse=function(a){return(new mc).parse(a)});var Mb={},zd=[],O={lines:{},audioCtx:null,getAudioContext:function(){if(this.audioCtx)return this.audioCtx;window.AudioContext||
window.webkitAudioContext?this.audioCtx=new (window.AudioContext||window.webkitAudioContext):console.warn("Web Audio API not supported in this browser");return this.audioCtx},handleModif:function(a,b,c){if(void 0!==a){if(a=x(a),a.ctype===b){if("number"===a.ctype)return a.value.real;if("list"===a.ctype){b=a.value;a=[];for(c=0;c<b.length;c++)a[c]=b[c].value.real;return a}return a.value}}else return c},handleLineModif:function(a,b){return void 0!==a?(a=x(a),ca(a)):b},getBufferNode:function(a,b){var c=
this.getAudioContext();if(b*c.sampleRate>a.length){for(var d=[],f=0,e=0;f<c.sampleRate*b;f++,e++)e>a.length&&(e=0),d[f]=a[e];a=d}b=new Float32Array(a);a=c.createBuffer(1,b.length,c.sampleRate);a.copyToChannel(b,0);c=c.createBufferSource();c.buffer=a;return c},createMonoOscillator:function(a,b){var c=this.getAudioContext().createOscillator();if(0!==b){var d=new Float32Array(2),f=new Float32Array(2);d[1]=Math.sin(b);f[1]=Math.cos(b);b=this.getAudioContext().createPeriodicWave(d,f,{disableNormalization:!0});
c.setPeriodicWave(b)}else c.type="sine";c.mono=!0;c.frequency.value=a;return c},createWaveOscillator:function(a,b,c){for(var d=this.getAudioContext().createOscillator(),f=new Float32Array(b.length+1),e=new Float32Array(b.length+1),g=0;g<b.length;g++)e[g+1]=b[g]*Math.cos(c[g]),f[g+1]=b[g]*Math.sin(c[g]);b=this.getAudioContext().createPeriodicWave(f,e,{disableNormalization:!0});d.setPeriodicWave(b);d.frequency.value=a;return d},cleanup:function(){for(var a in this.lines)if("sin"===this.lines[a].lineType)if(this.lines[a].oscNodes.every(function(a){return!a.oscNode.isplaying}))delete this.lines[a];
else for(var b=0;b<this.lines[a].oscNodes.length;b++)this.lines[a].oscNodes[b]&&!this.lines[a].oscNodes[b].oscNode.isplaying&&delete this.lines[a].oscNodes[b]},registerInput:function(a){a.cnt?a.cnt++:a.cnt=1},deregisterInput:function(a){a.cnt&&a.cnt--},hasRegisteredInput:function(a){return a.cnt&&0!==a.cnt},playOscillator:function(a,b,c,f,e,g){var d=this.getAudioContext(),h=d.createGain();h.gain.value=0;a.connect(h);h.connect(b);O.registerInput(b);a.start(0);a.isplaying=!0;a.onended=function(){this.isplaying=
!1;h.disconnect();O.deregisterInput(b);O.hasRegisteredInput(b)||(b.disconnect(),b.panNode&&b.panNode.disconnect());O.cleanup()};h.gain.linearRampToValueAtTime(c,d.currentTime+f);0<=e&&(h.gain.setValueAtTime(c,d.currentTime+f+e),h.gain.linearRampToValueAtTime(0,d.currentTime+f+e+g),this.triggerStop(a,e+f+g));return{oscNode:a,gainNode:h}},softStop:function(a,b){var c=this.getAudioContext();a.gainNode.gain.cancelScheduledValues(c.currentTime);a.gainNode.gain.setValueAtTime(a.gainNode.gain.value,c.currentTime);
a.gainNode.gain.linearRampToValueAtTime(0,c.currentTime+b);this.triggerStop(a.oscNode,b)},extendDuration:function(a,b,c){var d=this.getAudioContext();a.gainNode.gain.cancelScheduledValues(d.currentTime);a.gainNode.gain.setValueAtTime(a.gainNode.gain.value,d.currentTime);a.gainNode.gain.setValueAtTime(a.gainNode.gain.value,d.currentTime+b);a.gainNode.gain.linearRampToValueAtTime(0,d.currentTime+b+c);this.triggerStop(a.oscNode,b+c)},triggerStop:function(a,b){a.timeoutId&&clearTimeout(a.timeoutId);a.timeoutId=
setTimeout(function(){a.stop(0)},1E3*b+10)}},ob=function(a){this.audioCtx=a;this.lineType="sin";this.oscNodes=[]};ob.prototype.handleModif=function(a,b,c,f){if("phaseshift"===b)f=this.handlePhaseshiftModif(a.phaseshift,this.harmonics.length);else if(void 0!==a[b]&&(a=x(a[b]),a.ctype===c))if("number"===a.ctype)f=a.value.real;else if("list"===a.ctype){c=a.value;a=[];for(f=0;f<c.length;f++)a[f]=c[f].value.real;f=a}else f=a.value;return this[b]=f};ob.prototype.handlePhaseshiftModif=function(a,b){this.phaseshift=
Array(b).fill(0);if(void 0!==a)if(a=x(a),"list"===a.ctype)for(b=a.value,a=0;a<b.length;a++)this.phaseshift[a]=b[a].value.real;else if("number"===a.ctype)for(var c=0;c<b;c++)this.phaseshift[c]=(c+1)*a.value.real;return this.phaseshift};ob.prototype.cleanparameters=function(a){this.partials.length<this.harmonics.length&&(this.partials=Array(this.harmonics.length).fill(1),a.partials&&console.warn("Ignore partials because the given length does not match with the length of harmonics"));this.phaseshift.length<
this.harmonics.length&&(this.phaseshift=Array(this.harmonics.length).fill(0),a.phaseshift&&console.warn("Ignore phaseshift because the given length does not match with the length of harmonics"));this.precompute&=this.partials.every(function(a){return 1E-8>Math.abs(a-1)});0<this.damp&&(this.duration=Math.min(this.duration,6/this.damp))};ob.prototype.panit=function(){0===this.pan||this.masterGain.panNode||(this.masterGain.disconnect(this.audioCtx.destination),this.masterGain.panNode=this.audioCtx.createStereoPanner(),
this.masterGain.connect(this.masterGain.panNode),this.masterGain.panNode.connect(this.audioCtx.destination));this.masterGain.panNode&&(this.masterGain.panNode.pan.value=this.pan)};ob.prototype.dampit=function(){this.masterGain.gain.cancelScheduledValues(this.audioCtx.currentTime);this.masterGain.gain.setValueAtTime(this.masterGain.gain.value,this.audioCtx.currentTime);0<this.damp?this.masterGain.gain.setTargetAtTime(0,this.audioCtx.currentTime+this.attack,1/this.damp):0>this.damp&&this.masterGain.gain.setTargetAtTime(1,
this.audioCtx.currentTime+this.attack,-this.damp)};ob.prototype.startOscillators=function(){if(this.precompute)this.oscNodes[0]=O.playOscillator(O.createWaveOscillator(this.freq,this.harmonics,this.phaseshift),this.masterGain,1,this.attack,this.duration,this.release);else for(var a=0;a<this.harmonics.length;a++)this.oscNodes[a]=O.playOscillator(O.createMonoOscillator(this.partials[a]*(a+1)*this.freq,this.phaseshift[a]),this.masterGain,this.harmonics[a],this.attack,this.duration,this.release)};ob.prototype.stopOscillators=
function(){for(var a in this.oscNodes)O.softStop(this.oscNodes[a],this.release),delete this.oscNodes[a]};ob.prototype.stop=function(){this.stopOscillators()};ob.prototype.updateFrequencyAndGain=function(){if(this.precompute)this.harmonicsdidnotchange()&&this.oscNodes[0]&&this.oscNodes[0].oscNode.isplaying&&!this.oscNodes[0].oscNode.mono?(this.oscNodes[0].oscNode.frequency.value=this.freq,O.extendDuration(this.oscNodes[0],this.duration,this.release)):(this.stopOscillators(),this.startOscillators());
else{for(var a=0;a<this.harmonics.length;a++)0<this.harmonics[a]&&(this.oscNodes[a]&&this.oscNodes[a].oscNode.isplaying&&this.oscNodes[a].oscNode.mono?(this.oscNodes[a].oscNode.frequency.value=this.partials[a]*(a+1)*this.freq,this.oscNodes[a].gainNode.gain.value=this.harmonics[a],O.extendDuration(this.oscNodes[a],this.duration,this.release)):(this.oscNodes[a]&&this.oscNodes[a].oscNode.isplaying&&!this.oscNodes[a].oscNode.mono&&O.softStop(this.oscNodes[a],this.release),this.oscNodes[a]=O.playOscillator(O.createMonoOscillator(this.partials[a]*
(a+1)*this.freq,this.phaseshift[a]),this.masterGain,this.harmonics[a],this.attack,this.duration,this.release)));for(var b in this.oscNodes)this.harmonics[b]||(O.softStop(this.oscNodes[b],this.release),delete this.oscNodes[b])}};ob.prototype.generateNewMasterGain=function(a){this.masterGain=this.audioCtx.createGain();this.masterGain.connect(this.audioCtx.destination);this.masterGain.gain.value=a};ob.prototype.harmonicsdidnotchange=function(){if(this.lastharmonics){var a=1&this.lastharmonics.length===
this.harmonics.length;for(var b in this.harmonics)a&&(a&=this.harmonics[b]===this.lastharmonics[b])}else a=!1;return a};ob.prototype.evokeplaysin=function(a,b,c){this.cleanparameters(c);if(0===this.duration)return this.stop(),g;a||b&&0!==this.damp?(b&&!a&&this.stopOscillators(),this.generateNewMasterGain(this.amp),this.startOscillators()):(this.masterGain||this.generateNewMasterGain(this.amp),this.updateFrequencyAndGain());this.panit();this.dampit();this.lastharmonics=this.harmonics};t.stopsound$0=
function(){if(O.audioCtx){for(var a in O.lines)O.lines[a].stop(),delete O.lines[a];O.audioCtx.close();O.audioCtx=null}};t.playsin$1=function(a,b){var c=O.getAudioContext(),d=O.handleLineModif(b.line,"0"),f=!1;O.lines[d]&&"sin"===O.lines[d].lineType||(O.lines[d]&&O.lines[d].stop(),O.lines[d]=new ob(c),f=!0);c=O.lines[d];c.freq=x(a[0]).value.real;c.handleModif(b,"amp","number",.5);c.handleModif(b,"damp","number",0);c.handleModif(b,"duration","number",O.handleModif(b.stop,"number",1));c.handleModif(b,
"harmonics","list",[1]);c.handleModif(b,"partials","list",[1]);c.handleModif(b,"attack","number",.01);c.handleModif(b,"release","number",.01);c.handleModif(b,"pan","number",0);c.handleModif(b,"precompute","boolean",!1);c.handleModif(b,"phaseshift","phaseshift",Array(c.harmonics.length).fill(0));a=O.handleModif(b.restart,"boolean",!0);c.evokeplaysin(f,a,b);return g};t.playsin$0=function(a,b){if(void 0!==b.line&&(a=O.handleLineModif(b.line,"0"),a=O.lines[a])){a.handleModif(b,"freq","number",a.freq);
a.handleModif(b,"amp","number",a.amp);a.handleModif(b,"damp","number",a.damp);a.handleModif(b,"duration","number",O.handleModif(b.stop,"number",a.duration));a.handleModif(b,"harmonics","list",a.harmonics);a.handleModif(b,"partials","list",a.partials);a.handleModif(b,"attack","number",a.attack);a.handleModif(b,"release","number",a.release);a.handleModif(b,"pan","number",a.pan);a.handleModif(b,"precompute","boolean",a.precompute);a.handleModif(b,"phaseshift","phaseshift",a.phaseshift);var c=O.handleModif(b.restart,
"boolean",!1);a.evokeplaysin(!1,c,b)}return g};t.playfunction$1=function(a,b){var c=O.getAudioContext(),d=a[0];a=function(a){var b=[];for(b.push(a);0!==b.length;){a=b.pop();if("variable"===a.ctype&&x(a)===g&&["x","y","t"].includes(a.name))return a.name;if(a.args)for(var c in a.args)b.push(a.args[c])}return g}(d);a!==g&&M.newvar(a);var f=O.handleLineModif(b.line,"0"),e=O.handleModif(b.start,"number",0),h=O.handleModif(b.amp,"number",.5),k=O.handleModif(b.damp,"number",0);O.handleModif(b.stop,"number",
1);var l=O.handleModif(b.duration,"number",1),n=O.handleModif(b.attack,"number",.01),p=O.handleModif(b.release,"number",.01),q=O.handleModif(b.export,"boolean",!1),r=O.handleModif(b.silent,"boolean",!1);b=[];for(var t=0;t<c.sampleRate*l;t++){a!==g&&M.setvar(a,m.real(t/c.sampleRate));var u=x(d);b[t]=u.value.real*h*Math.exp(-k*t/c.sampleRate)}r||(O.lines[f]&&"function"===O.lines[f].lineType?(d=O.lines[f],d.masterGain.gain.linearRampToValueAtTime(0,c.currentTime+p),d.bufferNode.stop(c.currentTime+p),
d.bufferNode=O.getBufferNode(b,l),d.bufferNode.connect(d.masterGain),d.bufferNode.start(e+p),d.masterGain.gain.linearRampToValueAtTime(h,c.currentTime+p+n)):(O.lines[f]&&O.lines[f].stop(),O.lines[f]={lineType:"function",bufferNode:O.getBufferNode(b,l),masterGain:c.createGain(),stop:function(){this.bufferNode.stop()}},l=O.lines[f],l.masterGain.gain.value=0,l.masterGain.connect(c.destination),l.bufferNode.connect(l.masterGain),l.bufferNode.start(e),l.masterGain.gain.linearRampToValueAtTime(h,c.currentTime+
n)));a!==g&&M.removevar(a);return q?b:g};t.playwave$1=function(a,b){var c=O.getAudioContext(),d=x(a[0]),f=O.handleLineModif(b.line,"0");a=O.handleModif(b.amp,"number",.5);O.handleModif(b.damp,"number",0);var e=O.handleModif(b.duration,"number",1),h=O.handleModif(b.attack,"number",.01),k=O.handleModif(b.release,"number",.01);b=O.handleModif(b.start,"number",0);if("list"!==d.ctype)return g;O.lines[f]&&"wave"===O.lines[f].lineType?(f=O.lines[f],f.masterGain.gain.linearRampToValueAtTime(0,c.currentTime+
k),f.bufferNode.stop(c.currentTime+k),f.bufferNode=O.getBufferNode(v.unwrap(d),e),f.bufferNode.connect(f.masterGain),f.bufferNode.start(b+k),f.masterGain.gain.linearRampToValueAtTime(a,c.currentTime+k+h)):(O.lines[f]&&O.lines[f].stop(),O.lines[f]={lineType:"wave",bufferNode:O.getBufferNode(v.unwrap(d),e),masterGain:c.createGain(),stop:function(){this.bufferNode.stop()}},d=O.lines[f],d.masterGain.gain.value=0,d.masterGain.connect(c.destination),d.bufferNode.connect(d.masterGain),d.bufferNode.start(0),
d.masterGain.gain.linearRampToValueAtTime(a,c.currentTime+h));return g};var W={printArr:function(a){for(var b=a.value.length,c=[],f=[],e=!1,g=0;g<b;g++)c[g]=a.value[g].value.real,f[g]=a.value[g].value.imag,0!==f[g]&&(e=!0);console.log(c);e&&console.log(f)},zero:function(a){for(var b=[],c=m.real(0),e=0;e<a.value.real;e++)b[e]=c;return f.turnIntoCSList(b)},number:function(a,b){b=W.zero(b);b.value[0]=a;return b},variable:function(a,b){b=W.zero(b);b.value[0]=a;b.value[1]=m.real(1);return b},add:function(a,
b){return f.add(a,b)},sub:function(a,b){return f.sub(a,b)},mult:function(a,b){if(a.value.length!==b.value.length)return console.error("dims don't fit return nada"),g;for(var c=a.value.length,d=W.zero(m.real(c)),f=m.real(0),e=0;e<c;e++){for(var h=0;h<=e;h++)f=m.add(f,m.mult(a.value[h],b.value[e-h]));d.value[e]=f;f=m.real(0)}return d},pow:function(a,b){if(0>b.value.real||b.value.real!==Math.floor(b.value.real))return W.root(a,b);for(var c=a,d=1;d<b.value.real;d++)c=W.mult(c,a);return c},root:function(a,
b){var c=m.real(0),d=m.real(1),f=m.add(d,b),e=a.value.length,g=W.zero(m.real(e));g.value[0]=m.pow(a.value[0],b);var h=c;for(b=1;b<e;b++){var k=m.real(b);for(var l=1;l<=b;l++){var n=m.mult(f,m.real(l));n=m.div(n,k);n=m.sub(n,d);n=m.mult(n,a.value[l]);n=m.mult(n,g.value[b-l]);h=m.add(h,n)}h=m.div(h,a.value[0]);g.value[b]=h;h=c}return g},findFirstNoneZero:function(a,b,c){for(var d=Infinity,f=Infinity,e=c;e<a.value.length;e++)if(1E-12<m.abs2(a.value[e]).value.real){d=e;break}for(a=c;a<b.value.length;a++)if(1E-12<
m.abs2(b.value[a]).value.real){f=a;break}return[d,f]},div:function(a,b){if(a.value.length!==b.value.length)return console.log("dims don't fit - return nada"),g;for(var c=a.value.length,d=m.real(0),f=W.zero(m.real(c)),e=d,h,k=0;k<c;k++){h=W.findFirstNoneZero(a,b,k);k<h[0]&&h[0]===h[1]&&Infinity!==h[0]&&(a.value.splice(k,h[0]),b.value.splice(k,h[0]),f.value.splice(k,h[0]),c-=h[0]);h=a.value[k];for(var l=0;l<k;l++)e=m.add(e,m.mult(f.value[l],b.value[k-l]));h=m.sub(h,e);h=m.div(h,b.value[0]);f.value[k]=
h;e=d}return f},exp:function(a){var b=m.real(0),c=a.value.length,f=W.zero(m.real(c)),e=b;f.value[0]=m.exp(a.value[0]);for(var g=1;g<c;g++){for(var h=1;h<=g;h++){var k=m.mult(m.real(h),a.value[h]);k=m.mult(k,f.value[g-h]);e=m.add(e,k)}f.value[g]=m.div(e,m.real(g));e=b}return f},log:function(a){var b=m.real(0),c=a.value.length,f=W.zero(m.real(c));f.value[0]=m.log(a.value[0]);for(var e=b,g,h,k=1;k<c;k++){g=a.value[k];for(var l=1;l<k;l++)h=m.mult(m.real(l),f.value[l]),h=m.mult(h,a.value[k-l]),e=m.add(e,
h);e=m.div(e,m.real(k));g=m.sub(g,e);g=m.div(g,a.value[0]);f.value[k]=g;e=b}return f},sincos:function(a){var b=m.real(0),c=a.value.length,f=W.zero(m.real(c)),e=W.zero(m.real(c));f.value[0]=m.sin(a.value[0]);e.value[0]=m.cos(a.value[0]);for(var g=b,h=b,k,l,n,p=1;p<c;p++){n=m.real(p);for(var q=1;q<=p;q++)l=m.mult(m.real(q),a.value[q]),k=m.mult(l,e.value[p-q]),l=m.mult(l,f.value[p-q]),h=m.add(h,k),g=m.add(g,l);h=m.div(h,n);g=m.div(g,m.neg(n));f.value[p]=h;e.value[p]=g;g=h=b}W.sinsave=f;W.cossave=e;return[f,
e]},sin:function(a){return W.sincos(a)[0]},cos:function(a){return W.sincos(a)[1]},faculty:function(a){var b=[];b[0]=m.real(1);for(var c=1,e=1;e<=a.value.real;e++)c*=e,b[e]=m.real(c);return b=f.turnIntoCSList(b)},diff:function(a,b,c,f){if("variable"===a.ctype)var d=a.name!==b?W.number(x(a),f):W.variable(c,f);else if("number"===a.ctype)d=W.number(a,f);else{if("infix"===a.ctype){if("*"===a.oper)return W.mult(W.diff(a.args[0],b,c,f),W.diff(a.args[1],b,c,f));if("^"===a.oper)return W.pow(W.diff(a.args[0],
b,c,f),W.diff(a.args[1],b,c,f).value[0]);if("/"===a.oper)return W.div(W.diff(a.args[0],b,c,f),W.diff(a.args[1],b,c,f));if("+"===a.oper)return W.add(W.diff(a.args[0],b,c,f),W.diff(a.args[1],b,c,f));if("-"===a.oper)return W.sub(W.diff(a.args[0],b,c,f),W.diff(a.args[1],b,c,f));console.log("infix not found",a.oper);return g}if("function"===a.ctype){if("exp$1"===a.oper)return W.exp(W.diff(a.args[0],b,c,f));if("log$1"===a.oper)return W.log(W.diff(a.args[0],b,c,f));if("sin$1"===a.oper)return W.sin(W.diff(a.args[0],
b,c,f));if("cos$1"===a.oper)return W.cos(W.diff(a.args[0],b,c,f))}else return console.log("ctype not found",a.ctype),g}return d},adevaluate:function(a,b,c,f){a=W.diff(a,b,c,f);f=W.faculty(f);for(b=2;b<a.value.length;b++)a.value[b]=m.mult(a.value[b],f.value[b]);return a},autodiff:function(a,b,c,e){for(var d=[],g=c.value.length,h,k=0;k<g;k++)h=W.adevaluate(a,b,c.value[k],e),d[k]=h;return d=f.turnIntoCSList(d)}},w={handleModifs:function(a,b){w.dashing&&w.unSetDash();w.colorraw=null;w.fillcolorraw=null;
w.fillrule="nonzero";w.size=null;0>=w.psize&&(w.psize=0);0>=w.lsize&&(w.lsize=0);w.overhang=1;w.dashing=!1;w.isArrow=!1;w.arrowSides="==>";w.arrowposition=1;w.headlen=10;w.arrowShape=w.arrowShapes.line;w.alpha=A.drawingstate.alpha;w.fillalpha=0;w.bold="";w.italics="";w.family="sans-serif";w.align=0;w.angle=0;w.xOffset=0;w.yOffset=0;w.lineCap="round";w.lineJoin="round";w.miterLimit=10;w.noborder=!1;var c,d;for(c in a){var f=a[c];f&&((d=b[c])?(!0===d&&(d=w.modifHandlers[c]),d(x(f))):console.log("Modifier not supported: "+
c))}null!==w.size?w.psize=w.lsize=w.size:(w.psize=A.drawingstate.pointsize,w.lsize=A.drawingstate.linesize);w.dashing&&w.dashing(w.lsize);null!==w.colorraw?w.pointColor=w.lineColor=w.textColor=w.makeColor(w.colorraw):1===w.alpha?(w.pointColor=A.drawingstate.pointcolor,w.lineColor=A.drawingstate.linecolor,w.textColor=A.drawingstate.textcolor):(w.pointColor=w.makeColor(A.drawingstate.pointcolorraw),w.lineColor=w.makeColor(A.drawingstate.linecolorraw),w.textColor=w.makeColor(A.drawingstate.textcolorraw));
w.black=1===w.alpha?"rgb(0,0,0)":"rgba(0,0,0,"+w.alpha+")";w.fillColor=w.fillcolorraw&&0<w.fillalpha?w.makeColor(w.fillcolorraw,w.fillalpha):null},modifHandlers:{size:function(a){"number"===a.ctype&&(w.size=a.value.real,0>w.size&&(w.size=0),1E3<w.size&&(w.size=1E3))},color:function(a){f.isNumberVector(a).value&&3===a.value.length&&(w.colorraw=[a.value[0].value.real,a.value[1].value.real,a.value[2].value.real])},fillcolor:function(a){f.isNumberVector(a).value&&3===a.value.length&&(w.fillcolorraw=[a.value[0].value.real,
a.value[1].value.real,a.value[2].value.real])},alpha:function(a){"number"===a.ctype&&(w.alpha=a.value.real)},fillalpha:function(a){"number"===a.ctype&&(w.fillalpha=a.value.real)},dashpattern:function(a){if("list"===a.ctype){for(var b=[],c=0,f=0;c<a.value.length;c++)"number"===a.value[c].ctype&&(b[f++]=a.value[c].value.real);w.dashing=w.setDash.bind(null,b)}},dashtype:function(a){if("number"===a.ctype)a=Math.floor(a.value.real);else if("string"===a.ctype)a=a.value;else return;if(a=w.dashTypes[a])w.dashing=
w.setDash.bind(null,a)},dashing:function(a){"number"===a.ctype&&(a=Math.floor(a.value.real),w.dashing=w.setDash.bind(null,[2*a,a]))},overhang:function(a){"number"===a.ctype&&(w.overhang=w.overhang*a.value.real+(1-w.overhang)*(1-a.value.real))},arrow:function(a){"boolean"===a.ctype?w.isArrow=a.value:console.error("arrow needs to be of type boolean")},arrowshape:function(a){"string"!==a.ctype?console.error("arrowshape needs to be of type string"):w.arrowShapes.hasOwnProperty(a.value)?(w.arrowShape=
w.arrowShapes[a.value],w.isArrow=!0,w.arrowShape.deprecated&&(console.log("arrowshape "+a.value+" is deprecated, use "+w.arrowShape.deprecated+" instead."),w.arrowShape.deprecated=null)):(a=Object.keys(w.arrowShapes),a.sort(),a=a.join(", "),console.error("arrowshape needs to be one of "+a))},arrowsides:function(a){"string"!==a.ctype?console.error("arrowsides is not of type string"):"==>"!==a.value&&"<==>"!==a.value&&"<=="!==a.value?console.error("arrowsides is unknows"):(w.arrowSides=a.value,w.isArrow=
!0)},arrowposition:function(a){"number"!==a.ctype?console.error("arrowposition is not of type number"):0>a.value.real?console.error("arrowposition has to be positive"):1<a.value.real?w.overhang=w.overhang*a.value.real+(1-w.overhang)*(1-a.value.real):(w.arrowposition=a.value.real,w.isArrow=!0)},arrowsize:function(a){"number"!==a.ctype?console.error("arrowsize is not of type number"):0>a.value.real?console.error("arrowsize has to be positive"):w.headlen*=a.value.real},bold:function(a){"boolean"===a.ctype&&
a.value&&(w.bold="bold ")},italics:function(a){"boolean"===a.ctype&&a.value&&(w.italics="italic ")},family:function(a){"string"===a.ctype&&(w.family=a.value)},align:function(a){"string"===a.ctype&&(a=a.value,"left"===a&&(w.align=0),"right"===a&&(w.align=1),"mid"===a||"center"===a)&&(w.align=.5)},angle:function(a){"number"===a.ctype&&(w.angle=a.value.real)},x_offset:function(a){"number"===a.ctype&&(w.xOffset=a.value.real)},y_offset:function(a){"number"===a.ctype&&(w.yOffset=a.value.real)},offset:function(a){"list"===
a.ctype&&2===a.value.length&&"number"===a.value[0].ctype&&"number"===a.value[1].ctype&&(w.xOffset=a.value[0].value.real,w.yOffset=a.value[1].value.real)},lineCap:function(a){"string"!==a.ctype||"round"!==a.value&&"square"!==a.value&&"butt"!==a.value||(w.lineCap=a.value)},lineJoin:function(a){"string"!==a.ctype||"round"!==a.value&&"bevel"!==a.value&&"miter"!==a.value||(w.lineJoin=a.value)},fillrule:function(a){"string"!==a.ctype||"nonzero"!==a.value&&"evenodd"!==a.value||(w.fillrule=a.value)},miterLimit:function(a){"number"===
a.ctype&&0<a.value.real&&(w.miterLimit=Math.round(a.value.real))},noborder:function(a){"boolean"===a.ctype?w.noborder=a.value:console.error("noborder needs to be of type boolean")},border:function(a){"boolean"===a.ctype?w.noborder=!a.value:console.error("border needs to be of type boolean")}},lineModifs:{size:!0,color:!0,alpha:!0,dashpattern:!0,dashtype:!0,dashing:!0,overhang:!0,arrow:!0,arrowshape:!0,arrowsides:!0,arrowposition:!0,arrowsize:!0,lineCap:!0,lineJoin:!0,miterLimit:!0},pointModifs:{size:!0,
color:!0,alpha:!0,noborder:!0,border:!0}};w.pointAndLineModifs=w.lineModifs;w.conicModifs={size:!0,color:!0,alpha:!0,dashing:!0,dashpattern:!0,dashtype:!0,fillcolor:!0,fillrule:!0,fillalpha:!0,lineCap:!0,lineJoin:!0,miterLimit:!0};w.textModifs={size:!0,color:!0,alpha:!0,bold:!0,italics:!0,family:!0,align:!0,angle:!0,x_offset:!0,y_offset:!0,offset:!0};w.makeColor=function(a,b){void 0===b&&(b=w.alpha);return"rgba("+Math.floor(255*a[0])+","+Math.floor(255*a[1])+","+Math.floor(255*a[2])+","+b+")"};w.preDrawCurve=
function(){z.lineWidth=w.lsize;z.lineCap=w.lineCap;z.lineJoin=w.lineJoin;z.mozFillRule=w.fillrule;z.fillrule=w.fillrule;z.miterLimit=w.miterLimit;z.strokeStyle=w.lineColor};w.arrowShapes={"default":{close:!1,fill:!1,ratio:1,deprecated:"line"},line:{close:!1,fill:!1,ratio:1},empty:{close:!0,fill:!1,ratio:1},hollow:{close:!0,fill:!1,ratio:1,deprecated:"empty"},full:{close:!0,fill:!0,ratio:1},jet:{close:!0,fill:!0,ratio:1.5},delta:{close:!0,fill:!0,ratio:1.5,deprecated:"jet"}};w.clipSegment=function(a,
b){var c=b.x-a.x,d=b.y-a.y,f=w.clipLineCore(-d,c,a.x*b.y-b.x*a.y);if(2!==f.length)return[];var e=f[0];f=f[1];var g=1/(c*c+d*d),h=((e.x-a.x)*c+(e.y-a.y)*d)*g;c=((f.x-a.x)*c+(f.y-a.y)*d)*g;0>h&&(e=a);1<h&&(e=b);0>c&&(f=a);1<c&&(f=b);return e===f?[]:[e,f]};w.drawsegcore=function(a,b){function c(a,b,c,d){var f=a-d*m+.5*n,e=b-d*n-.5*m,g=a-d*m-.5*n;d=b-d*n+.5*m;z.beginPath();w.arrowShape.fill&&(z.lineWidth=w.lsize/2);z.moveTo(f,e);z.lineTo(a,b);z.lineTo(g,d);w.arrowShape.close&&(z.fillStyle=w.lineColor,
z.lineTo(a-c*m,b-c*n),z.closePath(),w.arrowShape.fill&&z.fill());z.stroke()}var d=A.drawingstate.matrix,f=a.x*d.a-a.y*d.b+d.tx,e=a.x*d.c-a.y*d.d-d.ty,g=b.x*d.a-b.y*d.b+d.tx,h=b.x*d.c-b.y*d.d-d.ty,k=w.overhang,l=1-k;b=k*f+l*g;d=k*e+l*h;a=k*g+l*f;k=k*h+l*e;if(0>b||b>ia||0>d||d>la||0>a||a>ia||0>k||k>la){k=w.clipSegment({x:b,y:d},{x:a,y:k});if(2!==k.length||.01>w.lsize)return;b=k[0].x;d=k[0].y;a=k[1].x;k=k[1].y}w.preDrawCurve();if(!w.isArrow||f===e&&g===h).01>w.lsize||(z.beginPath(),z.moveTo(b,d),z.lineTo(a,
k),z.stroke());else{f=g-f;e=h-e;g=w.headlen/Math.sqrt(f*f+e*e);var m=f*g,n=e*g;h=w.arrowposition;l=1-h;f=h*b+l*a;e=h*d+l*k;g=h*a+l*b;h=h*k+l*d;l=w.arrowSides;z.beginPath();w.arrowShape.close?("<==>"===l||"<=="===l?(1>w.arrowposition&&(z.moveTo(b,d),z.lineTo(f,e)),z.moveTo(f+m,e+n)):z.moveTo(b,d),"==>"===l||"<==>"===l?(z.lineTo(g-m,h-n),1>w.arrowposition&&(z.moveTo(g,h),z.lineTo(a,k))):z.lineTo(a,k)):(z.moveTo(b,d),z.lineTo(a,k));z.stroke();"==>"!==l&&"<==>"!==l||c(g,h,1,w.arrowShape.ratio);"<=="!==
l&&"<==>"!==l||c(f,e,-1,-w.arrowShape.ratio)}};w.drawpoint=function(a){var b=A.drawingstate.matrix,c=a.x*b.a-a.y*b.b+b.tx;a=a.x*b.c-a.y*b.d-b.ty;z.lineWidth=.3*w.psize;z.beginPath();z.arc(c,a,w.psize,0,2*Math.PI);z.fillStyle=w.pointColor;z.fill();w.noborder||(z.beginPath(),z.arc(c,a,1.15*w.psize,0,2*Math.PI),z.fillStyle=w.black,z.strokeStyle=w.black,z.stroke())};w.clipLineCore=function(a,b,c){var d=Math.SQRT1_2*w.lsize,f=0-d,e=ia+d,g=0-d;d=la+d;var h=0>f*a+g*b+c,k=0>e*a+g*b+c,l=0>f*a+d*b+c,m=0>e*
a+d*b+c,B=[];h!==k&&B.push({x:(-c-b*g)/a,y:g});k!==m&&B.push({x:e,y:(-c-a*e)/b});l!==m&&B.push({x:(-c-b*d)/a,y:d});h!==l&&B.push({x:f,y:(-c-a*f)/b});return B};w.clipLine=function(a){a=f.normalizeMax(f.productVM(a,A.toMat()));return w.clipLineCore(a.value[0].value.real,a.value[1].value.real,a.value[2].value.real)};w.drawline=function(a){f._helper.isAlmostReal(a)&&(a=w.clipLine(a),2===a.length&&.01<=w.lsize&&(w.preDrawCurve(),z.beginPath(),z.moveTo(a[0].x,a[0].y),z.lineTo(a[1].x,a[1].y),z.stroke()))};
w.drawRaySegment=function(a,b){a=E.extractPoint(a);b=E.extractPoint(b);if(a.ok&&b.ok){var c=a.x-b.x,d=a.y-b.y,f=25E3/A.drawingstate.matrix.sdet/Math.sqrt(c*c+d*d);c*=f;d*=f;w.drawsegcore(a,{x:a.x+c,y:a.y+d});w.drawsegcore(b,{x:b.x-c,y:b.y-d})}};w.dashTypes={solid:[],dashed:[10,10],tightdash:[10,4],dotted:[1,3],dashdot:[10,5,1,5],"dashvalue.solid":[],"dashvalue.dashed":[10,10],"dashvalue.tightdash":[10,4],"dashvalue.dotted":[1,3],"dashvalue.dashdot":[10,5,1,5],0:[],1:[10,10],2:[10,4],3:[1,3],4:[10,
5,1,5]};w.setDash=function(a,b){b=Math.sqrt(b);a=a.slice();for(var c=0;c<a.length;c++)a[c]*=b;z.webkitLineDash=a;z.setLineDash(a);z.mozDash=a};w.unSetDash=function(){z.webkitLineDash=[];z.setLineDash([]);z.mozDash=[]};Ed.prototype={set fillStyle(a){var b=this;nc(a,function(a,c,d,f){b._fill="#"+Fb(a.toString(16),2)+Fb(c.toString(16),2)+Fb(d.toString(16),2);b._fillOpacity=255===f?null:f})},set strokeStyle(a){var b=this;nc(a,function(a,c,d,f){b._stroke="#"+Fb(a.toString(16),2)+Fb(c.toString(16),2)+Fb(d.toString(16),
2);b._strokeOpacity=255===f?null:f})},clearRect:function(){},beginPath:function(){this._path=[]},_pathcmd:function(){this._path.push.apply(this._path,arguments)},closePath:function(){this._pathcmd("Z")},moveTo:function(a,b){this._pathcmd("M",a,b)},lineTo:function(a,b){this._pathcmd("L",a,b)},bezierCurveTo:function(a,b,c,f,e,g){this._pathcmd("C",a,b,c,f,e,g)},quadraticCurveTo:function(a,b,c,f){this._pathcmd("Q",a,b,c,f)},arc:function(a,b,c,f,e,g){var d=c*Math.cos(f)+a,h=c*Math.sin(f)+b,k=c*Math.cos(e)+
a,l=c*Math.sin(e)+b;e=g?f-e:e-f;e>=2*Math.PI?this._pathcmd(this._path.length?"L":"M",d,h,"A",c,c,0,0,g?1:0,a-c*Math.cos(f),b-c*Math.sin(f),"A",c,c,0,0,g?1:0,d,h):this._pathcmd(this._path.length?"L":"M",d,h,"A",c,c,0,e>Math.PI?1:0,g?1:0,k,l)},rect:function(a,b,c,f){this._pathcmd("M",a,b,"h",c,"v",f,"h",-c,"z")},_cmd:function(a){1!==this.globalAlpha?(this._body.push('<g opacity="'+this.globalAlpha+'">'),this._body.push(a),this._body.push("</g>")):this._body.push(a)},_attrs:function(a){var b="",c;for(c in a)null!==
a[c]&&(b+=" "+c+'="'+a[c]+'"');return b},fill:function(){this._cmd("<path"+this._attrs({d:this._path.join(" "),fill:this._fill,"fill-opacity":this._fillOpacity})+"/>")},stroke:function(){this._cmd("<path"+this._attrs({d:this._path.join(" "),stroke:this._stroke,"stroke-opacity":this._strokeOpacity,"stroke-width":this.lineWidth,"stroke-linecap":this.lineCap,"stroke-linejoin":this.lineJoin,"stroke-miterlimit":"miter"===this.lineJoin?this.miterLimit:null})+"/>")},clip:function(){++this._clipIndex;this._body.push('<clipPath id="clip'+
this._clipIndex+'"><path d="'+this._path.join(" ")+'"/></clipPath>','<g clip-path="url(#clip'+this._clipIndex+')">');this._saveStack[this._saveStack.length-1]+="</g>"},save:function(){this._saveStack.push("")},restore:function(){this._body.push(this._saveStack.pop());0===this._saveStack.length&&this._saveStack.push("")},_transform:function(a){this._body.push('<g transform="'+a+'">');this._saveStack[this._saveStack.length-1]+="</g>"},translate:function(a,b){this._transform("translate("+a+" "+b+")")},
rotate:function(a){this._transform("rotate("+Math.PI/180*a+")")},scale:function(a,b){this._transform("scale("+a+" "+b+")")},transform:function(a,b,c,f,e,g){this._transform("matrix("+[a,b,c,f,e,g].join(" ")+")")},drawImage:function(a,b,c){if(3!==arguments.length)throw Error("SvgWriterContext only supports 3-argument version of drawImage");var d=this._imgcache.indexOf(a);if(-1===d){d=this._imgcache.length;var f=a.cachedDataURL?a.cachedDataURL:Fd(a);this._defs.push('<image id="img'+d+'" x="0" y="0" width="'+
a.width+'" height="'+a.height+'" xlink:href="'+f+'"/>');this._imgcache.push(a)}this._cmd('<use x="'+b+'" y="'+c+'" xlink:href="#img'+d+'"/>')},toBlob:function(){for(;1<this._saveStack.length||""!==this._saveStack[0];)this.restore();var a='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="'+this.width+'px" height="'+this.height+'px">\n'+this._defs.join("\n")+'\n</defs>\n<g stroke="none" fill="none">\n'+
this._body.join("\n")+"\n</g>\n</svg>\n";return new Blob([a],{type:"image/svg+xml"})}};Eb.prototype={_cmd:function(){this._body.push(Array.prototype.join.call(arguments," "))},_setAlpha:function(a,b,c){var d=Math.round(255*a*this._globalAlpha);b+=d;this._extGState[b]="<< /"+c+" "+d/255+" >>";this._cmd("/"+b,"gs");return a},set globalAlpha(a){this._globalAlpha=a;this._setAlpha(this._strokeAlpha,"As","CA");this._setAlpha(this._fillAlpha,"Af","ca")},set fillStyle(a){var b=this;nc(a,function(a,c,d,f){b._cmd(a/
255,c/255,d/255,"rg");b._setAlpha(b._fillAlpha=f,"Af","ca")})},set strokeStyle(a){var b=this;nc(a,function(a,c,d,f){b._cmd(a/255,c/255,d/255,"RG");b._setAlpha(b._strokeAlpha=f,"As","CA")})},set lineWidth(a){this._cmd(a,"w")},set lineCap(a){this._cmd({butt:0,round:1,square:2}[a],"J")},set lineJoin(a){this._cmd({miter:0,round:1,bevel:2}[a],"j")},set miterLimit(a){this._cmd(a,"M")},clearRect:function(){},beginPath:function(){this._pathUsed=!1},closePath:function(){this._cmd("h")},moveTo:function(a,b){this._cmd(this._xPos=
a,this._yPos=-b,"m")},lineTo:function(a,b){this._cmd(this._xPos=a,this._yPos=-b,"l")},bezierCurveTo:function(a,b,c,f,e,g){this._cmd(a,-b,c,-f,this._xPos=e,this._yPos=-g,"c")},quadraticCurveTo:function(a,b,c,f){this.bezierCurveTo((2*a+this._xPos)/3,(2*b-this._yPos)/3,(c+2*a)/3,(f+2*b)/3,c,f)},_kappa:.5522847498307935,arc:function(a,b,c,f,e,g){if(0===f&&e===2*Math.PI)f=this._kappa*c,this.moveTo(a+c,b),this.bezierCurveTo(a+c,b+f,a+f,b+c,a,b+c),this.bezierCurveTo(a-f,b+c,a-c,b+f,a-c,b),this.bezierCurveTo(a-
c,b-f,a-f,b-c,a,b-c),this.bezierCurveTo(a+f,b-c,a+c,b-f,a+c,b);else throw Error("PdfWriterContext.arc only supports full circles");},rect:function(a,b,c,f){this._cmd(a,-b,c,-f,"re")},_usePath:function(a){if(this._pathUsed){var b=this._body[this._pathUsed],c={"S + f":"B","f + S":"B","W n + S":"W S","W n + f":"W f","S + W n":"W S","f + W n":"W f","B + W n":"W B","W S + f":"W B","W f + S":"W B"}[b+" + "+a];if(!c)throw Error("Don't know how to combine '"+b+"' and '"+a+"'");this._body.splice(this._pathUsed,
1);a=c}this._pathUsed=this._body.length;this._cmd(a)},fill:function(){this._usePath("f")},stroke:function(){this._usePath("S")},clip:function(){this._usePath("W n")},save:function(){this._cmd("q")},restore:function(){this._cmd("Q")},translate:function(a,b){this.transform(1,0,0,1,a,b)},rotate:function(a){var b=Math.cos(a);a=Math.sin(a);this.transform(b,a,-a,b,0,0)},scale:function(a,b){this.transform(a,0,0,b,0,0)},transform:function(a,b,c,f,e,g){this._cmd(a,-b,-c,f,e,-g,"cm")},_png:function(a){if("data:image/png;base64,"!==
a.substr(0,22))return{error:"Not a base64-encoded PNG file"};a=ie(a.substr(22));var b=je(a);console.log("PNG chunks:",b.map(function(a){return a.type}));if("IHDR"!==b[0].type)throw Error("Image does not start with an IHDR");var c=b[0].data;a=(c[0]<<24|c[1]<<16|c[2]<<8|c[3])>>>0;var f=(c[4]<<24|c[5]<<16|c[6]<<8|c[7])>>>0,e=c[8],g=c[9],h=0===(g&2),k=0!==(g&4),l=c[10],m=c[11];c=c[12];if(0!==l)throw Error("Unsupported PNG compression method: "+l);if(0!==m)throw Error("Unsupported PNG filter method: "+
m);if(0!==c)return{error:"Interlaced image not supported"};if(0!==(g&1))return{error:"Indexed PNG image not supported"};m=null;g=h?1:3;l=b.filter(function(a){return"IDAT"===a.type}).map(function(a){return a.data});if(k){k=window.pako;m=new k.Inflate;for(b=0;b<l.length;++b)m.push(l[b],b+1===l.length);if(m.err)throw Error(m.err);m=m.result;c=e>>>3;if(m.length!==f*(a*(g+1)*c+1))throw Error("Data length mismatch");var n=g*c;l=new Uint8Array(f*(a*n+1));for(var p=new Uint8Array(f*(a*c+1)),q=0,r=0,t=0,u=
0;u<f;++u){l[r++]=p[t++]=m[q++];for(var v=0;v<a;++v){for(b=0;b<n;++b)l[r++]=m[q++];for(b=0;b<c;++b)p[t++]=m[q++]}}if(q!==m.length||r!==l.length||t!==p.length)throw Error("Seems we garbled our index computation somehow");p=k.deflate(p);m=this._strm({Type:"/XObject",Subtype:"/Image",Width:a,Height:f,ColorSpace:"/DeviceGray",BitsPerComponent:e,Filter:"/FlateDecode",DecodeParms:this._dict({Predictor:15,Colors:1,BitsPerComponent:e,Columns:a})},p).ref;l=[k.deflate(l)]}var w=0;l.forEach(function(a){w+=a.length});
return this._obj([this._dict({Type:"/XObject",Subtype:"/Image",Name:"/img"+this._imgcache.length,Width:a,Height:f,ColorSpace:h?"/DeviceGray":"/DeviceRGB",SMask:m,BitsPerComponent:e,Length:w,Filter:"/FlateDecode",DecodeParms:this._dict({Predictor:15,Colors:g,BitsPerComponent:e,Columns:a})}),"\nstream\n"].concat(l,["\nendstream"]))},drawImage:function(a,b,c){if(3!==arguments.length)throw Error("PdfWriterContext only supports 3-argument version of drawImage");var d=this._imgcache.indexOf(a);if(-1===
d){d=this._imgcache.length;this._imgcache.push(a);var f=this._png(a.cachedDataURL||"");f.hasOwnProperty("error")&&(f=this._png(Fd(a)));if(f.hasOwnProperty("error"))throw Error(f.error);this._xobjects["img"+d]=f.ref}this._cmd("q");this._setAlpha(1,"Af","ca");this._cmd(a.width,0,0,a.height,b,-c-a.height,"cm");this._cmd("/img"+d,"Do");this._cmd("Q")},_dict:function(a){var b="<<",c;for(c in a)b+=" /"+c+" "+a[c];return b+" >>"},_obj:function(a,b){b||(b=this._nextIndex++);Array.isArray(a)||(a=[this._dict(a)]);
a.index=b;a.ref=b+" 0 R";a.offset=this._offset;var c=0;a.unshift(b+" 0 obj\n");a.push("\nendobj\n");for(b=0;b<a.length;++b)c+=a[b].length;this._offset+=c;this._objects.push(a);return a},_strm:function(a,b,c){a.Length=b.length;return this._obj([this._dict(a),"\nstream\n",b,"\nendstream"],c)},toBlob:function(){var a="["+[0,-this.height,this.width,0].join(" ")+"]";this._obj({Type:"/Catalog",Pages:"2 0 R"},1);this._obj({Type:"/Pages",Kids:"[3 0 R]",Count:1},2);this._obj({Type:"/Page",Parent:"2 0 R",MediaBox:a,
Contents:"4 0 R",Resources:this._dict({ProcSet:"[/PDF /Text /ImageB /ImageC /ImageI]",XObject:this._dict(this._xobjects),ExtGState:this._dict(this._extGState)})},3);var b=this._body.join("\n"),c=new Uint8Array(b.length);for(a=0;a<b.length;++a)c[a]=b.charCodeAt(a)&255;b=window.pako.deflate(c);this._strm({Filter:"/FlateDecode"},b,4);b=this._objects;var f=[];for(a=1;a<b.length;++a)f[b[a].index]=b[a];c="xref\n0 "+f.length+"\n";for(a=0;a<f.length;++a)c=f[a]?c+(Fb(String(f[a].offset),10)+" 00000 n \n"):
c+"0000000000 65535 f \n";a="trailer\n"+this._dict({Size:f.length,Root:"1 0 R"})+"\nstartxref\n"+this._offset+"\n%%EOF\n";b=Array.prototype.concat.apply([],b);b.push(c,a);return new Blob(b,{type:"application/pdf"})}};var Ad=null;xb.push(Gb);Ha.exportSVG=function(){Gc(Ed)};Ha.exportPDF=function(){Da.loadScript("pako","pako.min.js",function(){Gc(Eb)})};Ha.exportPNG=function(){Je(z.canvas.toDataURL())};var Je=function(a){var b=document.createElement("a");document.body.appendChild(b);b.style="display: none";
b.href=a;b.download="CindyJSExport";b.click();setTimeout(function(){document.body.removeChild(b);Gb()},100)},Ae="Move",Bd,db=[],Pb=0,Ve=0,Xc=0,K={Delete:{}};K.Delete.actions=[];K.Delete.actions[0]={};K.Delete.actions[0].event="mousedown";K.Delete.actions[0].tooltip="...";K.Delete.actions[0].do=function(){ua=Hb(ea);null!==ua&&Lc(ua.mover.name);return!0};K.Move={};K.Move.actions=[];K.Move.actions[0]={};K.Move.actions[0].event="mousedown";K.Move.actions[0].tooltip="Move free elements by dragging the mouse";
K.Move.actions[0].do=function(){for(var a=ea,b=null,c=1E6,e,g=0;g<u.free.length;g++){var h=u.free[g];if(!h.pinned&&!1!==h.visible&&!0!==h.tmp){var k=A.drawingstate.matrix.sdet;if("P"===h.kind){var l=f.normalizeZ(h.homog);if(!f._helper.isAlmostReal(l))continue;var n=l.value[0].value.real-a.x;l=l.value[1].value.real-a.y;var p=Math.sqrt(n*n+l*l);if(h.narrow&&p>("number"===typeof h.narrow?h.narrow:20)/k)continue}else if("C"===h.kind){l=f.normalizeZ(u.csnames[h.args[0]].homog);n=h.radius;if(!f._helper.isAlmostReal(l)||
!m._helper.isAlmostReal(n))continue;p=l.value[0].value.real;var q=l.value[1].value.real;l=a.x-p;var r=a.y-q,t=Math.sqrt(l*l+r*r);if(0===t)continue;q+=r/t*n.value.real;n=p+l/t*n.value.real-a.x;l=q-a.y;p=Math.sqrt(n*n+l*l);p+=30/k;if(h.narrow&&p>(("number"===typeof h.narrow?h.narrow:20)+30)/k)continue}else if("L"===h.kind)n=h.homog,p=m,l=p.add(p.mult(n.value[0],p.conjugate(n.value[0])),p.mult(n.value[1],p.conjugate(n.value[1]))),l=f.scaldiv(p.sqrt(l),n),p=l.value[0].value.real*a.x+l.value[1].value.real*
a.y+l.value[2].value.real,n=-l.value[0].value.real*p,l=-l.value[1].value.real*p,0>p&&(p=-p),p+=25/k;else if("Text"===h.kind){if(!h.homog||h.dock||!h._bbox)continue;l=A.from(a.x,a.y,1);n=Math.max(0,l[0]-h._bbox.right,h._bbox.left-l[0]);l=Math.max(0,l[1]-h._bbox.bottom,h._bbox.top-l[1]);p=Math.sqrt(n*n+l*l);if(20<p)continue;p/=k;l=f.normalizeZ(h.homog);if(!f._helper.isAlmostReal(l))continue;n=l.value[0].value.real-a.x;l=l.value[1].value.real-a.y}else continue;p<c+.2/k&&(c=p,b=h,e={x:n,y:l})}}console.log("Moving "+
(b?b.name:"nothing"));ua=null===b?null:{mover:b,offset:e,prev:{x:a.x,y:a.y}};return!0};K.Point={};K.Point.actions=[];K.Point.actions[0]={};K.Point.actions[0].event="mousedown";K.Point.actions[0].tooltip="Add a single point with the mouse";K.Point.actions[0].do=function(){Va({type:"Free",name:Ma(),labeled:!0,pos:[Ja[0],Ja[1],1]});return!0};K.Mid={};K.Mid.actions=[];K.Mid.actions[0]={};K.Mid.actions[0].event="mousedown";K.Mid.actions[0].tooltip="Construct two points and their midpoint by dragging";
K.Mid.actions[0].do=function(){Ub();return!0};K.Mid.actions[1]={};K.Mid.actions[1].event="mousemove";K.Mid.actions[1].do=function(){Kc("Mid");return!0};K.Mid.actions[2]={};K.Mid.actions[2].event="mouseup";K.Mid.actions[2].do=function(){Zb();return!0};K.Circle={};K.Circle.actions=[];K.Circle.actions[0]={};K.Circle.actions[0].event="mousedown";K.Circle.actions[0].tooltip="Construct two points and a circle by dragging the mouse";K.Circle.actions[0].do=function(){Ub();return!0};K.Circle.actions[1]={};
K.Circle.actions[1].event="mousemove";K.Circle.actions[1].do=function(){Kc("CircleMP");return!0};K.Circle.actions[2]={};K.Circle.actions[2].event="mouseup";K.Circle.actions[2].do=function(){Zb();return!0};K.Compass={};K.Compass.actions=[];K.Compass.actions[0]={};K.Compass.actions[0].event="mousedown";K.Compass.actions[0].tooltip="...";K.Compass.actions[0].do=function(){Ub();return!0};K.Compass.actions[1]={};K.Compass.actions[1].event="mousedown";K.Compass.actions[1].tooltip="...";K.Compass.actions[1].do=
function(){Ub();return!0};K.Compass.actions[2]={};K.Compass.actions[2].event="mousedown";K.Compass.actions[2].tooltip="...";K.Compass.actions[2].do=function(){Ub();Va({type:"Compass",name:Ma(),labeled:!0,args:[db[0].name,db[1].name,db[2].name]});return!0};K.Line={};K.Line.actions=[];K.Line.actions[0]={};K.Line.actions[0].event="mousedown";K.Line.actions[0].tooltip="Construct two points and their connecting line by dragging the mouse";K.Line.actions[0].do=function(){Ub();return!0};K.Line.actions[1]=
{};K.Line.actions[1].event="mousemove";K.Line.actions[1].do=function(){Kc("Join");return!0};K.Line.actions[2]={};K.Line.actions[2].event="mouseup";K.Line.actions[2].do=function(){Zb();return!0};K.Segment={};K.Segment.actions=[];K.Segment.actions[0]={};K.Segment.actions[0].event="mousedown";K.Segment.actions[0].tooltip="Draw a segment by dragging the mouse";K.Segment.actions[0].do=function(){Ub();return!0};K.Segment.actions[1]={};K.Segment.actions[1].event="mousemove";K.Segment.actions[1].do=function(){Kc("Segment");
return!0};K.Segment.actions[2]={};K.Segment.actions[2].event="mouseup";K.Segment.actions[2].do=function(){Zb();return!0};K.Parallel={};K.Parallel.actions=[];K.Parallel.actions[0]={};K.Parallel.actions[0].event="mousedown";K.Parallel.actions[0].tooltip="Construct a parallel line by dragging a line";K.Parallel.actions[0].do=function(){return Jb()};K.Parallel.actions[1]={};K.Parallel.actions[1].event="mousemove";K.Parallel.actions[1].do=function(){var a={type:"Free",name:Ma(),labeled:!0,pos:[Ja[0],Ja[1],
1],tmp:!0};a=Va(a);Bd=Va({type:"Para",name:Ma(),labeled:!0,args:[db[0].name,a.name]});Jc(a);return!0};K.Parallel.actions[2]={};K.Parallel.actions[2].event="mouseup";K.Parallel.actions[2].do=function(){Zb();return!0};K.Orthogonal={};K.Orthogonal.actions=[];K.Orthogonal.actions[0]={};K.Orthogonal.actions[0].event="mousedown";K.Orthogonal.actions[0].tooltip="Construct a orthogonal line by dragging a line";K.Orthogonal.actions[0].do=function(){if(Jb()){var a={type:"Free",name:Ma(),labeled:!0,pos:[Ja[0],
Ja[1],1],tmp:!0};a=Va(a);Bd=Va({type:"Perp",name:Ma(),labeled:!0,args:[db[0].name,a.name]});Jc(a);return!0}return!1};K.Orthogonal.actions[1]={};K.Orthogonal.actions[1].event="mouseup";K.Orthogonal.actions[1].do=function(){Zb();return!0};K.Intersection={};K.Intersection.actions=[];K.Intersection.actions[0]={};K.Intersection.actions[0].event="mousedown";K.Intersection.actions[0].tooltip="Select two elements to define their intersection";K.Intersection.actions[0].do=function(){return Kd()};K.Intersection.actions[1]=
{};K.Intersection.actions[1].event="mousedown";K.Intersection.actions[1].do=function(){return Kd()?(Bd=Va({type:"Meet",name:Ma(),labeled:!0,args:[db[0].name,db[1].name]}),!0):!1};var Wb={},A={drawingstate:{}};A.drawingstate.linecolor="rgb(0,0,255)";A.drawingstate.linecolorraw=[0,0,1];A.drawingstate.pointcolor="rgb(0,255,0)";A.drawingstate.pointcolorraw=[0,1,0];A.drawingstate.textcolor="rgb(0,0,0)";A.drawingstate.textcolorraw=[0,0,0];A.drawingstate.alpha=1;A.drawingstate.pointsize=4;A.drawingstate.linesize=
1;A.drawingstate.textsize=null;A.drawingstate.matrix={};A.drawingstate.matrix.a=25;A.drawingstate.matrix.b=0;A.drawingstate.matrix.c=0;A.drawingstate.matrix.d=25;A.drawingstate.matrix.tx=250.5;A.drawingstate.matrix.ty=250.5;A.drawingstate.matrix.det=A.drawingstate.matrix.a*A.drawingstate.matrix.d-A.drawingstate.matrix.b*A.drawingstate.matrix.c;A.drawingstate.matrix.sdet=Math.sqrt(A.drawingstate.matrix.det);A.drawingstate.initialmatrix={};A.drawingstate.initialmatrix.a=A.drawingstate.matrix.a;A.drawingstate.initialmatrix.b=
A.drawingstate.matrix.b;A.drawingstate.initialmatrix.c=A.drawingstate.matrix.c;A.drawingstate.initialmatrix.d=A.drawingstate.matrix.d;A.drawingstate.initialmatrix.tx=A.drawingstate.matrix.tx;A.drawingstate.initialmatrix.ty=A.drawingstate.matrix.ty;A.drawingstate.initialmatrix.det=A.drawingstate.matrix.det;A.drawingstate.initialmatrix.sdet=A.drawingstate.matrix.sdet;A.clone=function(a){if(null===a||"object"!==typeof a)return a;var b=a.constructor(),c;for(c in a)b[c]=A.clone(a[c]);return b};Wb.backup=
A.clone(A.drawingstate);Wb.stack=[];A.clone(A.drawingstate);A.reset=function(){A.drawingstate.matrix.a=A.drawingstate.initialmatrix.a;A.drawingstate.matrix.b=A.drawingstate.initialmatrix.b;A.drawingstate.matrix.c=A.drawingstate.initialmatrix.c;A.drawingstate.matrix.d=A.drawingstate.initialmatrix.d;A.drawingstate.matrix.tx=A.drawingstate.initialmatrix.tx;A.drawingstate.matrix.ty=A.drawingstate.initialmatrix.ty;A.drawingstate.matrix.det=A.drawingstate.initialmatrix.det;A.drawingstate.matrix.sdet=A.drawingstate.initialmatrix.sdet};
A.from=function(a,b,c){a/=c;b/=c;c=A.drawingstate.matrix;return[(a*c.a-b*c.b+c.tx)/sa,(a*c.c-b*c.d-c.ty)/sa]};A.to=function(a,b){var c=A.drawingstate.matrix;a=a*sa-c.tx;b=b*sa+c.ty;return[(a*c.d-b*c.b)/c.det,-(-a*c.c+b*c.a)/c.det,1]};A.toMat=function(){var a=A.drawingstate.matrix;return f.realMatrix([[a.d,-a.b,-a.tx*a.d-a.ty*a.b],[a.c,-a.a,-a.tx*a.c-a.ty*a.a],[0,0,a.det]])};A.dumpTrafo=function(){function a(a){return Math.round(1E3*a)/1E3}var b=A.drawingstate.matrix;console.log("a:"+a(b.a)+" b:"+
a(b.b)+" c:"+a(b.c)+" d:"+a(b.d)+" tx:"+a(b.ty)+" ty:"+a(b.tx))};A.setMat=function(a,b,c,f,e,g){var d=A.drawingstate.matrix;d.a=a;d.b=b;d.c=c;d.d=f;d.tx=e;d.ty=g;d.det=a*f-b*c;d.sdet=Math.sqrt(d.det)};A.scaleAndOrigin=function(a,b,c){A.setMat(a,0,0,a,b,c)};A.visibleRect=function(a,b,c,f){var d=c-a,e=b-f;d=ia*e<la*d?ia/d:la/e;A.setMat(d,0,0,d,(ia-d*(a+c))/2,(la-d*(b+f))/2)};A.applyMat=function(a,b,c,f,e,g){var d=A.drawingstate.matrix;A.setMat(d.a*a+d.c*b,d.b*a+d.d*b,d.a*c+d.c*f,d.b*c+d.d*f,d.a*e+d.c*
g+d.tx,d.b*e+d.d*g+d.ty)};A.translate=function(a,b){A.applyMat(1,0,0,1,a,b)};A.rotate=function(a){var b=Math.cos(a);a=Math.sin(a);A.applyMat(b,a,-a,b,0,0)};A.scale=function(a){A.applyMat(a,0,0,a,0,0)};A.gsave=function(){Wb.stack.push(A.clone(A.drawingstate))};A.grestore=function(){0!==Wb.stack.length&&(A.drawingstate=Wb.stack.pop())};A.greset=function(){A.drawingstate=A.clone(Wb.backup);A.drawingstate.matrix.ty-=la;A.drawingstate.initialmatrix.ty-=la;Wb.stack=[]};A.createnewbackup=function(){A.drawingstate.initialmatrix.a=
A.drawingstate.matrix.a;A.drawingstate.initialmatrix.b=A.drawingstate.matrix.b;A.drawingstate.initialmatrix.c=A.drawingstate.matrix.c;A.drawingstate.initialmatrix.d=A.drawingstate.matrix.d;A.drawingstate.initialmatrix.tx=A.drawingstate.matrix.tx;A.drawingstate.initialmatrix.ty=A.drawingstate.matrix.ty;A.drawingstate.initialmatrix.det=A.drawingstate.matrix.det;A.drawingstate.initialmatrix.sdet=A.drawingstate.matrix.sdet;Wb.backup=A.clone(A.drawingstate)};A.makecolor=function(a,b,c){a=Math.floor(255*
a);b=Math.floor(255*b);c=Math.floor(255*c);return 1===A.drawingstate.alpha?"rgb("+a+","+b+","+c+")":"rgba("+a+","+b+","+c+","+A.drawingstate.alpha+")"};A.setcolor=function(a){var b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;A.drawingstate.linecolor=A.drawingstate.pointcolor=A.makecolor(b,c,a);A.drawingstate.linecolorraw=A.drawingstate.pointcolorraw=[b,c,a]};A.setlinecolor=function(a){var b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;A.drawingstate.linecolor=
A.makecolor(b,c,a);A.drawingstate.linecolorraw=[b,c,a]};A.settextcolor=function(a){var b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;A.drawingstate.textcolor=A.makecolor(b,c,a);A.drawingstate.textcolorraw=[b,c,a]};A.setpointcolor=function(a){var b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;A.drawingstate.pointcolor=A.makecolor(b,c,a);A.drawingstate.pointcolorraw=[b,c,a]};A.setalpha=function(a){A.drawingstate.alpha=a.value.real;A.drawingstate.linecolor=
A.makecolor(A.drawingstate.linecolorraw[0],A.drawingstate.linecolorraw[1],A.drawingstate.linecolorraw[2]);A.drawingstate.pointcolor=A.makecolor(A.drawingstate.pointcolorraw[0],A.drawingstate.pointcolorraw[1],A.drawingstate.pointcolorraw[2]);A.drawingstate.textcolor=A.makecolor(A.drawingstate.textcolorraw[0],A.drawingstate.textcolorraw[1],A.drawingstate.textcolorraw[2])};A.setpointsize=function(a){A.drawingstate.pointsize=a.value.real};A.setlinesize=function(a){A.drawingstate.linesize=a.value.real};
A.settextsize=function(a){A.drawingstate.textsize=a.value.real};var va={clip:"none",pointColor:[1,0,0],lineColor:[0,0,1],pointSize:5,lineSize:1,alpha:1,overhangLine:1,overhangSeg:1,dimDependent:.7,fontFamily:"sans-serif",textColor:[0,0,0],textsize:20,noborder:!1,lineHeight:1.45};b.defaultAppearance&&ke(b.defaultAppearance);var fe={},Ke={UL:0,UR:1,LR:2,LL:3},Ce=["in","out","good","backup","prover"],gc=new Float64Array(0),Ob={};Ce.forEach(function(a){Ob[a]=gc});var Ea=gc,sb=gc,jb=gc,eb,kb,fc,nb,Zc,
De=!1,Le={toString:function(){return"RefineException"}},Me=null,N=null;b.enableTraceLog&&(N={logLength:Infinity,fullLog:[],currentMouseAndScripts:null,currentMover:null,currentStep:null,currentElement:null,currentParam:null,labelTracing2:v.wrap("tracing2"),labelTracing4:v.wrap("tracing4"),labelTracingSesq:v.wrap("tracingSesq"),postMouseHooks:[]},"number"===typeof b.enableTraceLog&&(N.logLength=b.enableTraceLog),Ha.getTraceLog=Xd,Ha.formatTraceLog=ne,Ha.addTraceHook=N.postMouseHooks.push.bind(N.postMouseHooks));
gb.stateSize=12;ld.stateSize=24;pc.stateSize=24;var Oa=[];oa._helper={};oa._helper.duplicatePPLL=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return{P:"point",L:"line"}[a.kind]+" "+a.name+" is duplicate of "+b.name},apply:qc(a,b),holds:function(){return f.projectiveDistMinScal(a.homog,b.homog)<m.epsbig}}};oa._helper.duplicatePsLs=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return{Ps:"point set",Ls:"line set"}[a.kind]+" "+a.name+" is duplicate of "+
b.name},apply:qc(a,b),holds:function(){return oa._helper.isSetEq(a.results.value,b.results.value,f.projectiveDistMinScal)}}};oa._helper.duplicateCC=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"Conic "+a.name+" is duplicate of "+b.name},apply:qc(a,b),holds:function(){return f.conicDist(a.matrix,b.matrix)<m.epsbig}}};oa._helper.duplicateCs=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"Conic set"+a.name+" is duplicate of "+
b.name},apply:qc(a,b),holds:function(){return oa._helper.isSetEq(a.results,b.results,f.conicDist)}}};oa._helper.duplicateSS=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"Segment "+a.name+" is duplicate of "+b.name},apply:qc(a,b),holds:function(){var c=a.startpos,d=a.endpos,e=b.startpos,g=b.endpos,h=f.projectiveDistMinScal(c,e);h+=f.projectiveDistMinScal(d,g);d=f.projectiveDistMinScal(d,e);d+=f.projectiveDistMinScal(c,g);return Math.min(h,d)<m.epsbig}}};oa.P=function(a){u.points.forEach(function(b){a.name!==
b.name&&(b=oa._helper.duplicatePPLL(a,b),b.holds()&&Oa.push(b))})};oa.Ps=function(a){u.sets.points.forEach(function(b){a.name!==b.name&&(b=oa._helper.duplicatePsLs(a,b),b.holds()&&Oa.push(b))})};oa.Ls=function(a){u.sets.lines.forEach(function(b){a.name!==b.name&&(b=oa._helper.duplicatePsLs(a,b),b.holds()&&Oa.push(b))})};oa.Cs=function(a){u.sets.conics.forEach(function(b){a.name!==b.name&&(b=oa._helper.duplicateCs(a,b),b.holds()&&Oa.push(b))})};oa.L=function(a){u.lines.forEach(function(b){a.name!==
b.name&&a.kind===b.kind&&(b=oa._helper.duplicatePPLL(a,b),b.holds()&&Oa.push(b))})};oa.S=function(a){u.lines.forEach(function(b){a.name!==b.name&&"S"===b.kind&&(b=oa._helper.duplicateSS(a,b),b.holds()&&Oa.push(b))})};oa.C=function(a){u.conics.forEach(function(b){a.name!==b.name&&(b=oa._helper.duplicateCC(a,b),b.holds()&&Oa.push(b))})};oa._helper.isSetEq=function(a,b,c){a=a.slice();b=b.slice();if(a.length!==b.length)return!1;if(0===a.length&&0===b.length)return!0;var d=a.shift(),f=b.reduce(function(a,
b,f,e){return c(b,d)<c(e[a],d)?f:a},0);return c(b[f],d)<m.epsbig?(b.splice(f,1),oa._helper.isSetEq(a,b,c)):!1};Kb.P=function(a){u.lines.forEach(function(b){b=nd(a,b);b.holds()&&Oa.push(b)});u.conics.forEach(function(b){b=Zd(a,b);b.holds()&&Oa.push(b)})};Kb.L=function(a){u.points.forEach(function(b){b=nd(b,a);b.holds()&&Oa.push(b)})};Kb.S=Kb.L;Kb.C=function(a){u.points.forEach(function(b){b=Zd(b,a);b.holds()&&Oa.push(b)})};var n={_helper:{},RandomLine:{}};n.RandomLine.kind="L";n.RandomLine.signature=
[];n.RandomLine.updatePosition=function(a){a.homog=f.realVector([Math.random()-.5,Math.random()-.5,Math.random()-.5]);a.homog=f.normalizeMax(a.homog);a.homog=v.withUsage(a.homog,"Line")};n._helper.getRandMove=function(a){a=a.homog;var b=f.getRandComplexVec3(-.05,.05);return{type:"homog",value:f.add(a,b)}};n._helper.getRandPointMove=function(a){a=f.normalizeMax(a.homog);var b=a.value[2],c=m.abs(b).value.real,e=m.real(0);c<m.eps&&(e=m.getRandComplex(-.05,.05),b=m.real(1));c=f.turnIntoCSList([m.getRandComplex(-.1,
.1),m.getRandComplex(-.1,.1),e]);b=f.scalmult(b,c);b=f.add(a,b);return{type:"homog",value:b}};n.FreeLine={};n.FreeLine.kind="L";n.FreeLine.signature=[];n.FreeLine.isMovable=!0;n.FreeLine.initialize=function(a){a=n._helper.initializeLine(a);Y(a)};n.FreeLine.getParamForInput=function(a,b,c){"mouse"===c?(a=f.cross(b,f.ez),a=f.cross(a,b)):a="homog"===c?b:f.turnIntoCSList([m.zero,m.zero,m.zero]);return f.normalizeMax(a)};n.FreeLine.getParamFromState=function(a){return da(3)};n.FreeLine.putParamToState=
function(a,b){Y(b)};n.FreeLine.updatePosition=function(a){var b=da(3);Y(b);a.homog=v.withUsage(b,"Line")};n.FreeLine.getRandomMove=n._helper.getRandMove;n.FreeLine.stateSize=6;n.RandomPoint={};n.RandomPoint.kind="P";n.RandomPoint.signature=[];n.RandomPoint.updatePosition=function(a){a.homog=f.realVector([100*Math.random(),100*Math.random(),100*Math.random()]);a.homog=f.normalizeMax(a.homog);a.homog=v.withUsage(a.homog,"Point")};n.Join={};n.Join.kind="L";n.Join.signature=["P","P"];n.Join.updatePosition=
function(a){a.homog=f.cross(u.csnames[a.args[0]].homog,u.csnames[a.args[1]].homog);a.homog=f.normalizeMax(a.homog);a.homog=v.withUsage(a.homog,"Line")};n.Segment={};n.Segment.kind="S";n.Segment.signature=["P","P"];n.Segment.updatePosition=function(a){var b=u.csnames[a.args[0]],c=u.csnames[a.args[1]];n.Segment.setSegmentPos(a,f.cross(b.homog,c.homog),f.scalmult(c.homog.value[2],b.homog),f.scalmult(b.homog.value[2],c.homog))};n.Segment.setSegmentPos=function(a,b,c,e){b=f.normalizeMax(b);a.homog=v.withUsage(b,
"Line");b=f.turnIntoCSList([c,e]);b=f.normalizeMax(b);a.startpos=b.value[0];a.endpos=b.value[1]};n.Meet={};n.Meet.kind="P";n.Meet.signature=["L","L"];n.Meet.updatePosition=function(a){a.homog=f.cross(u.csnames[a.args[0]].homog,u.csnames[a.args[1]].homog);a.homog=f.normalizeMax(a.homog);a.homog=v.withUsage(a.homog,"Point")};n.Meet.visiblecheck=function(a){var b=!0,c=u.csnames[a.args[0]],f=u.csnames[a.args[1]];"S"===c.kind&&(b=Pd(a,c));b&&"S"===f.kind&&(b=Pd(a,f));a.isshowing=b};n._helper.midpoint=
function(a,b){return f.normalizeMax(f.add(f.scalmult(b.value[2],a),f.scalmult(a.value[2],b)))};n.Mid={};n.Mid.kind="P";n.Mid.signature=["P","P"];n.Mid.updatePosition=function(a){var b=n._helper.midpoint(u.csnames[a.args[0]].homog,u.csnames[a.args[1]].homog);a.homog=v.withUsage(b,"Point")};n.Perp={};n.Perp.kind="L";n.Perp.signature=["L","P"];n.Perp.updatePosition=function(a){var b=u.csnames[a.args[0]].homog,c=u.csnames[a.args[1]].homog;b=f.turnIntoCSList([b.value[0],b.value[1],m.zero]);a.homog=f.cross(b,
c);a.homog=f.normalizeMax(a.homog);a.homog=v.withUsage(a.homog,"Line")};n.Para={};n.Para.kind="L";n.Para.signature=["L","P"];n.Para.updatePosition=function(a){var b=u.csnames[a.args[1]].homog;a.homog=f.cross(f.cross(f.linfty,u.csnames[a.args[0]].homog),b);a.homog=f.normalizeMax(a.homog);a.homog=v.withUsage(a.homog,"Line")};n.Horizontal={};n.Horizontal.kind="L";n.Horizontal.signature=["P"];n.Horizontal.updatePosition=function(a){a.homog=f.cross(f.ex,u.csnames[a.args[0]].homog);a.homog=f.normalizeMax(a.homog);
a.homog=v.withUsage(a.homog,"Line")};n.HorizontalLine={};n.HorizontalLine.kind="L";n.HorizontalLine.signature=[];n.HorizontalLine.isMovable=!0;n.HorizontalLine.initialize=function(a){a=n._helper.initializeLine(a);a=f.turnIntoCSList([m.zero,a.value[1],a.value[2]]);a=f.normalizeMax(a);Y(a)};n.HorizontalLine.getParamForInput=function(a,b,c){if("mouse"===c)b=f.cross(b,f.ex);else if("homog"===c){if(0!==b.value[0].real||0!==b.value[0].imag)b=f.turnIntoCSList([m.zero,b.value[1],b.value[2]])}else b=f.turnIntoCSList([m.zero,
m.zero,m.zero]);return f.normalizeMax(b)};n.HorizontalLine.getParamFromState=function(a){return da(3)};n.HorizontalLine.putParamToState=function(a,b){Y(b)};n.HorizontalLine.updatePosition=function(a){var b=da(3);Y(b);a.homog=v.withUsage(b,"Line")};n.HorizontalLine.getRandomMove=n._helper.getRandMove;n.HorizontalLine.stateSize=6;n.Vertical={};n.Vertical.kind="L";n.Vertical.signature=["P"];n.Vertical.updatePosition=function(a){a.homog=f.cross(f.ey,u.csnames[a.args[0]].homog);a.homog=f.normalizeMax(a.homog);
a.homog=v.withUsage(a.homog,"Line")};n.VerticalLine={};n.VerticalLine.kind="L";n.VerticalLine.signature=[];n.VerticalLine.isMovable=!0;n.VerticalLine.initialize=function(a){a=n._helper.initializeLine(a);a=f.turnIntoCSList([a.value[0],m.zero,a.value[2]]);a=f.normalizeMax(a);Y(a)};n.VerticalLine.getParamForInput=function(a,b,c){if("mouse"===c)b=f.cross(b,f.ey);else if("homog"===c){if(0!==b.value[1].real||0!==b.value[1].imag)b=f.turnIntoCSList([b.value[0],m.zero,b.value[2]])}else b=f.turnIntoCSList([m.zero,
m.zero,m.zero]);return f.normalizeMax(b)};n.VerticalLine.getParamFromState=function(a){return da(3)};n.VerticalLine.putParamToState=function(a,b){Y(b)};n.VerticalLine.updatePosition=function(a){var b=da(3);Y(b);a.homog=v.withUsage(b,"Line")};n.VerticalLine.getRandomMove=n._helper.getRandMove;n.VerticalLine.stateSize=6;n.LineByFixedAngle={};n.LineByFixedAngle.kind="L";n.LineByFixedAngle.signature=["L","P"];n.LineByFixedAngle.initialize=function(a){var b=m._helper.input(a.angle),c=m.cos(b);b=m.sin(b);
a.rot=f.turnIntoCSList([f.turnIntoCSList([b,c,m.zero]),f.turnIntoCSList([m.neg(c),b,m.zero]),f.turnIntoCSList([m.zero,m.zero,m.zero])])};n.LineByFixedAngle.updatePosition=function(a){var b=u.csnames[a.args[1]],c=f.productMV(a.rot,u.csnames[a.args[0]].homog);a.homog=f.cross(b.homog,c);a.homog=f.normalizeMax(a.homog);a.homog=v.withUsage(a.homog,"Line")};n.Through={};n.Through.kind="L";n.Through.signature=["P"];n.Through.isMovable=!0;n.Through.initialize=function(a){a=a.dir?v.wrap(a.dir):f.realVector([a.pos[1],
-a.pos[0],0]);Y(a)};n.Through.getParamForInput=function(a,b,c){a="dir"===c||"mouse"===c?f.cross(u.csnames[a.args[0]].homog,b):"homog"===c?b:f.turnIntoCSList([m.zero,m.zero,m.zero]);a=f.cross(f.linfty,a);return f.normalizeMax(a)};n.Through.getParamFromState=function(a){return da(3)};n.Through.putParamToState=function(a,b){Y(b)};n.Through.updatePosition=function(a){var b=da(3);Y(b);b=f.cross(u.csnames[a.args[0]].homog,b);b=f.normalizeMax(b);a.homog=v.withUsage(b,"Line")};n.Through.getRandomMove=n._helper.getRandMove;
n.Through.stateSize=6;n.Through.set_angle=function(a,b){if("number"===b.ctype){var c=m.cos(b);b=m.sin(b);c=f.turnIntoCSList([c,b,m.real(0)]);Ra(a,c,"dir")}};n.Through.set_slope=function(a,b){"number"===b.ctype&&(b=f.turnIntoCSList([m.real(1),b,m.real(0)]),Ra(a,b,"dir"))};n.Free={};n.Free.kind="P";n.Free.signature=[];n.Free.isMovable=!0;n.Free.initialize=function(a){a=n._helper.initializePoint(a);Y(a)};n.Free.getParamForInput=function(a,b,c){if("mouse"===c&&wc&&0!==Sa){b=f.normalizeZ(b);a=b.value[0].value.real;
c=b.value[1].value.real;var d=Math.round(a/Sa)*Sa,e=Math.round(c/Sa)*Sa;Math.abs(d-a)<Nb&&Math.abs(e-c)<Nb&&(b=f.realVector([d,e,1]))}return f.normalizeMax(b)};n.Free.getParamFromState=function(a){return da(3)};n.Free.putParamToState=function(a,b){Y(b)};n.Free.updatePosition=function(a){var b=da(3);Y(b);a.homog=v.withUsage(b,"Point")};n.Free.getRandomMove=n._helper.getRandPointMove;n.Free.stateSize=6;n._helper.projectPointToLine=function(a,b){var c=f.turnIntoCSList([b.value[0],b.value[1],m.zero]);
a=f.cross(c,a);return f.normalizeMax(f.cross(a,b))};n.PointOnLine={};n.PointOnLine.kind="P";n.PointOnLine.signature=["L"];n.PointOnLine.isMovable=!0;n.PointOnLine.initialize=function(a){var b=n._helper.initializePoint(a);a=u.csnames[a.args[0]].homog;b=n._helper.projectPointToLine(b,a);b=f.normalizeMax(b);var c=f.cross(f.linfty,b);f.normalizeMax(c);Y(b);Y(a);fc=!1};n.PointOnLine.updatePosition=function(a,b){var c=u.csnames[a.args[0]].homog;var d=da(3);da(3);if(!b){eb=a.stateIdx;var e=Ea;Ea=jb;b=da(3);
var g=da(3);Ea=e;e=f.cross(g,c);f._helper.isAlmostZero(e)&&(e=f.cross(f.linfty,c));b=n._helper.CircleMP(e,b);b=n._helper.IntersectLC(c,b);e=n._helper.pointReflection(e,d);d=kd(b[0],b[1],d,e)[0]}d=f.normalizeMax(d);Y(d);Y(c);a.homog=v.withUsage(d,"Point")};n.PointOnLine.getParamForInput=function(a,b,c){a=u.csnames[a.args[0]].homog;b=n._helper.projectPointToLine(b,a);"mouse"===c&&wc&&0!==Sa&&(b=n._helper.snapPointToLine(b,a));return b};n.PointOnLine.getParamFromState=function(a){return da(3)};n.PointOnLine.putParamToState=
function(a,b){return Y(b)};n.PointOnLine.getRandomMove=n._helper.getRandPointMove;n.PointOnLine.stateSize=12;n.PointOnCircle={};n.PointOnCircle.kind="P";n.PointOnCircle.signature=["C"];n.PointOnCircle.isMovable=!0;n.PointOnCircle.initialize=function(a){var b=u.csnames[a.args[0]];a=f.normalizeZ(n._helper.initializePoint(a));var c=f.normalizeZ(n._helper.CenterOfCircle(b.matrix)),e=f.sub(a,c);e=f.turnIntoCSList([e.value[1],m.neg(e.value[0]),m.zero]);c=f.cross(a,c);b=n._helper.IntersectLC(c,b.matrix);
c=f.projectiveDistMinScal(a,b[0]);f.projectiveDistMinScal(a,b[1])<c?(a=b[1],b=b[0]):(a=b[0],b=b[1]);Y(e);Y(a);Y(b);fc=!1};n.PointOnCircle.putParamToState=function(a,b){Y(b)};n.PointOnCircle.getParamFromState=function(a){return da(3)};n.PointOnCircle.getParamForInput=function(a,b,c){c=f.normalizeZ(n._helper.CenterOfCircle(u.csnames[a.args[0]].matrix));b=f.sub(b,c);eb=a.stateIdx;a=da(3);var d=f.normalizeZ(da(3));c=f.sub(d,c);0>m.sub(m.mult(a.value[0],c.value[1]),m.mult(a.value[1],c.value[0])).value.real&&
(b=f.neg(b));return f.turnIntoCSList([b.value[1],m.neg(b.value[0]),m.zero])};n.PointOnCircle.parameterPath=function(a,b,c,e,g){e=f.normalizeAbs(e);g=f.normalizeAbs(g);var d=f.scalproduct(e,g);if(0<=d.value.real)return Sd(a,b,c,e,g);a=f.turnIntoCSList([m.sub(e.value[1],g.value[1]),m.sub(g.value[0],e.value[0]),m.zero]);d=f.scalproduct(e,a);0>d.value.real&&(a=f.neg(a));0>b?(b=2*b+1,c=b*b,d=.25/(1+c),c=m.complex(2*b*d+.25,(1-c)*d)):(b=2*b-1,c=b*b,d=.25/(1+c),c=m.complex(2*b*d+.75,(1-c)*d));var h=m.sub(m.real(1),
c);b=m.mult(c,c);d=m.mult(h,h);c=m.mult(c,h);e=f.scalmult(d,e);e=f.add(e,f.scalmult(c,a));return e=f.add(e,f.scalmult(b,g))};n.PointOnCircle.updatePosition=function(a){var b=da(3);Y(b);var c=u.csnames[a.args[0]];b=f.productMV(c.matrix,b);c=n._helper.IntersectLC(b,c.matrix);c=gb(c[0],c[1]);b=f.normalizeMax(c.value[0]);a.homog=v.withUsage(b,"Point");a.antipodalPoint=c.value[1]};n.PointOnCircle.getRandomMove=n._helper.getRandPointMove;n.PointOnCircle.stateSize=6+gb.stateSize;n.PointOnCircle.get_angle=
function(a){var b=n._helper.CenterOfCircle(u.csnames[a.args[0]].matrix),c=f._helper.isAlmostFarpoint;if(c(a.homog)||c(b))return g;a=f.normalizeZ(a.homog);b=f.normalizeZ(b);b=f.sub(a,b);b=m.arctan2(b.value[0],b.value[1]);a=m.real(Bc);b=m.mod(m.add(b,a),a);return v.withUsage(b,"Angle")};n.PointOnCircle.set_angle=function(a,b){if("number"===b.ctype){var c=u.csnames[a.args[0]],d=n._helper.CenterOfCircle(c.matrix);if(!f._helper.isAlmostFarpoint(d)){d=f.normalizeZ(d);var e=m.cos(b);b=m.sin(b);c=f.turnIntoCSList([m.mult(e,
c.radius),m.mult(b,c.radius),m.real(0)]);Ra(a,f.add(d,c),"homog")}}return g};n.OtherPointOnCircle={};n.OtherPointOnCircle.kind="P";n.OtherPointOnCircle.signature=["P"];n.OtherPointOnCircle.signatureConstraints=function(a){return"PointOnCircle"===u.csnames[a.args[0]].type};n.OtherPointOnCircle.updatePosition=function(a){var b=u.csnames[a.args[0]].antipodalPoint;b=f.normalizeMax(b);a.homog=v.withUsage(b,"Point")};n.PointOnSegment={};n.PointOnSegment.kind="P";n.PointOnSegment.signature=["S"];n.PointOnSegment.isMovable=
!0;n.PointOnSegment.initialize=function(a){var b=n._helper.initializePoint(a);a=n.PointOnSegment.getParamForInput(a,b);qb(a)};n.PointOnSegment.getParamForInput=function(a,b,c){a=u.csnames[a.args[0]];var d=a.homog;"mouse"===c&&wc&&0!==Sa&&(b=n._helper.snapPointToLine(b,d));c=f.turnIntoCSList([d.value[0],d.value[1],m.zero]);d=f.sub(a.startpos,a.endpos);b=f.crossratio3(d,a.startpos,a.endpos,b,c);0>b.value.real&&(b=m.complex(0,b.value.imag));1<b.value.real&&(b=m.complex(1,b.value.imag));return b};n.PointOnSegment.getParamFromState=
function(a){return bc()};n.PointOnSegment.putParamToState=function(a,b){qb(b)};n.PointOnSegment.updatePosition=function(a){var b=bc();qb(b);var c=u.csnames[a.args[0]],e=c.startpos;c=f.sub(c.endpos,e);b=f.add(e,f.scalmult(b,c));b=f.normalizeMax(b);a.homog=v.withUsage(b,"Point")};n.PointOnSegment.getRandomMove=n._helper.getRandPointMove;n.PointOnSegment.stateSize=2;n._helper.projectPointToCircle=function(a,b){var c=n._helper.CenterOfCircle(a.matrix);c=f.normalizeMax(c);c=f.normalizeMax(f.cross(b,c));
a=n._helper.IntersectLC(c,a.matrix);c=f.projectiveDistMinScal(b,a[0]);b=f.projectiveDistMinScal(b,a[1]);return c<b?a[0]:a[1]};n.PointOnArc={};n.PointOnArc.kind="P";n.PointOnArc.signature=["C"];n.PointOnArc.signatureConstraints=function(a){return u.csnames[a.args[0]].isArc};n.PointOnArc.isMovable=!0;n.PointOnArc.initialize=function(a){var b=n._helper.initializePoint(a);a=n.PointOnArc.getParamForInput(a,b);Y(a)};n.PointOnArc.getParamForInput=function(a,b){a=u.csnames[a.args[0]];b=n._helper.projectPointToCircle(a,
b);b=f.normalizeMax(f.crossratio3harm(a.startPoint,a.endPoint,a.viaPoint,b,f.ii));a=m.div(b.value[0],b.value[1]);0>a.value.real&&(b=-1>a.value.real?f.realVector([1,0]):f.realVector([0,1]));return b};n.PointOnArc.getParamFromState=function(a){return da(2)};n.PointOnArc.putParamToState=function(a,b){Y(b)};n.PointOnArc.updatePosition=function(a){var b=u.csnames[a.args[0]],c=b.startPoint,e=b.viaPoint,g=b.endPoint,h=f.ii,k=f.cross(c,h);e=f.cross(e,h);var l=f.cross(g,h);l=f.turnIntoCSList([k,l]);k=f.transpose(l);
l=f.conjugate(l);k=f.productMM(l,k);e=f.productMV(l,e);k=f.productMV(f.adjoint2(k),e);e=k.value[0];k=k.value[1];l=da(2);Y(l);c=f.normalizeMax(f.add(f.scalmult(m.mult(e,l.value[0]),c),f.scalmult(m.mult(k,l.value[1]),g)));b=n._helper.conicOtherIntersection(b.matrix,h,c);a.homog=v.withUsage(b,"Point")};n.PointOnArc.getRandomMove=n._helper.getRandPointMove;n.PointOnArc.stateSize=4;n._helper.CenterOfCircle=function(a){return f.turnIntoCSList([a.value[2].value[0],a.value[2].value[1],m.neg(a.value[0].value[0])])};
n._helper.CenterOfConic=function(a){a=f.adjoint3(a);return{ctype:"list",value:[a.value[2].value[0],a.value[2].value[1],a.value[2].value[2]]}};n.CenterOfConic={};n.CenterOfConic.kind="P";n.CenterOfConic.signature=["C"];n.CenterOfConic.updatePosition=function(a){var b=n._helper.CenterOfConic(u.csnames[a.args[0]].matrix);a.homog=b;a.homog=f.normalizeMax(a.homog);a.homog=v.withUsage(a.homog,"Point")};n._helper.CircleMP=function(a,b){var c=a.value[0],d=a.value[1];a=m.neg(a.value[2]);var e=m.zero;c=f.turnIntoCSList([f.turnIntoCSList([a,
e,c]),f.turnIntoCSList([e,a,d]),f.turnIntoCSList([c,d,e])]);d=v.mult(v.mult(b,c),b);b=v.mult(v.mult(b,f.fund),b);d=v.mult(d,f.fund);b=v.mult(b,c);return f.sub(d,b)};n.CircleMP={};n.CircleMP.kind="C";n.CircleMP.signature=["P","P"];n.CircleMP.updatePosition=function(a){a.matrix=n._helper.CircleMP(u.csnames[a.args[0]].homog,u.csnames[a.args[1]].homog);a.matrix=f.normalizeMax(a.matrix);a.matrix=v.withUsage(a.matrix,"Circle")};n.CircleMr={};n.CircleMr.kind="C";n.CircleMr.signature=["P"];n.CircleMr.isMovable=
!0;n.CircleMr.initialize=function(a){qb(m.real(a.radius))};n.CircleMr.getParamForInput=function(a,b,c){if("radius"===c)return b;a=u.csnames[a.args[0]].homog;a=f.normalizeZ(a);b=f.normalizeZ(b);b=f.sub(a,b);return b=f.abs(b)};n.CircleMr.getParamFromState=function(a){return bc()};n.CircleMr.putParamToState=function(a,b){qb(b)};n.CircleMr.updatePosition=function(a){var b=bc();qb(b);var c=u.csnames[a.args[0]].homog,e=m.mult(c.value[2],b);e=m.mult(e,e);if(!m._helper.isFinite(e)&&!m._helper.isNaN(e))return f.fund;
c=n._helper.ScaledCircleMrr(c,e);a.matrix=v.withUsage(c,"Circle");a.radius=b};n.CircleMr.getRandomMove=function(a){a=a.radius;return{type:"radius",value:m.abs(a).value.real<m.eps?m.getRandComplex(.05,.1):m.mult(a,m.getRandReal(.95,1.05))}};n.CircleMr.stateSize=2;n.CircleMr.set_radius=function(a,b){"number"===b.ctype&&Ra(a,b,"radius")};n._helper.ScaledCircleMrr=function(a,b){var c=a.value[0],d=a.value[1];a=m.neg(a.value[2]);a=f.scalmult(a,f.turnIntoCSList([c,d,a])).value;c=f.turnIntoCSList([c,d]);
b=m.sub(f.scalproduct(c,c),b);b=n._helper.buildConicMatrix([a[2],m.zero,a[2],a[0],a[1],b]);return f.normalizeMax(b)};n.Compass={};n.Compass.kind="C";n.Compass.signature=["P","P","P"];n.Compass.updatePosition=function(a){var b=u.csnames[a.args[0]].homog,c=u.csnames[a.args[1]].homog,e=u.csnames[a.args[2]].homog,g=b.value[2],h=c.value[2],k=e.value[2];b=f.scalmult(m.mult(h,k),b);c=f.scalmult(m.mult(g,k),c);e=f.scalmult(m.mult(g,h),e);b=f.sub(c,b);e=n._helper.ScaledCircleMrr(e,f.scalproduct(b,b));a.matrix=
v.withUsage(e,"Circle")};n._helper.getConicType=function(a){if(1E-16>m.abs(f.det(a)).value.real)return"degenerate";var b=m.mult(a.value[0].value[0],a.value[1].value[1]);b=m.sub(b,m.pow(a.value[0].value[1],m.real(2)));b=b.value.real;return 1E-16>Math.abs(b)?"parabola":1E-16<b?"ellipsoid":"hyperbola"};n._helper.ConicBy5=function(a,b,c,e,g,h){a=f.turnIntoCSList([f.cross(c,e)]);var d=f.turnIntoCSList([f.cross(b,g)]);b=f.turnIntoCSList([f.cross(b,c)]);e=f.turnIntoCSList([f.cross(e,g)]);return n._helper.conicFromTwoDegenerates(a,
d,b,e,h)};n._helper.conicFromTwoDegenerates=function(a,b,c,e,g){a=v.mult(f.transpose(b),a);c=v.mult(f.transpose(e),c);a=f.add(a,f.transpose(a));c=f.add(c,f.transpose(c));e=v.mult(v.mult(g,a),g);g=v.mult(v.mult(g,c),g);c=v.mult(e,c);g=v.mult(g,a);return f.sub(c,g)};n.ConicBy5={};n.ConicBy5.kind="C";n.ConicBy5.signature=["P","P","P","P","P"];n.ConicBy5.updatePosition=function(a){var b=n._helper.ConicBy5(a,u.csnames[a.args[0]].homog,u.csnames[a.args[1]].homog,u.csnames[a.args[2]].homog,u.csnames[a.args[3]].homog,
u.csnames[a.args[4]].homog);a.matrix=b;a.matrix=f.normalizeMax(a.matrix);a.matrix=v.withUsage(a.matrix,"Conic")};n.FreeConic={};n.FreeConic.kind="C";n.FreeConic.signature=[];n.FreeConic.initialize=function(a){var b=a.pos?n._helper.inputConic(a.pos):f.zeromatrix(m.real(3),m.real(3));n.FreeConic.putParamToState(a,b)};n.FreeConic.getParamForInput=function(a,b,c){return f.normalizeMax(b)};n.FreeConic.getParamFromState=function(a){return n._helper.buildConicMatrix(da(6).value)};n.FreeConic.putParamToState=
function(a,b){for(a=0;3>a;++a)for(var c=0;c<=a;++c)qb(b.value[a].value[c])};n.FreeConic.updatePosition=function(a){var b=da(6);Y(b);a.matrix=n._helper.buildConicMatrix(b.value);a.matrix=f.normalizeMax(a.matrix);a.matrix=v.withUsage(a.matrix,"Conic")};n.FreeConic.set_matrix=function(a,b){f._helper.isNumberMatrixMN(b,3,3)&&Ra(a,f.add(b,f.transpose(b)),"matrix")};n.FreeConic.stateSize=12;n._helper.buildConicMatrix=function(a){var b=a[1],c=a[2],e=a[3],g=a[4],h=a[5];return f.turnIntoCSList([f.turnIntoCSList([a[0],
b,e]),f.turnIntoCSList([b,c,g]),f.turnIntoCSList([e,g,h])])};n._helper.flattenConicMatrix=function(a){return f.turnIntoCSList([a.value[0].value[0],a.value[0].value[1],a.value[1].value[1],a.value[0].value[2],a.value[1].value[2],a.value[2].value[2]])};n._helper.splitDegenConic=function(a){var b=f.adjoint3(a),c=0,e,g=m.abs2(b.value[0].value[0]).value.real;for(e=1;3>e;e++){var h=m.abs2(b.value[e].value[e]).value.real;h>g&&(c=e,g=h)}e=m.sqrt(m.mult(m.real(-1),b.value[c].value[c]));if(1E-16>m.abs2(e).value.real)return a=
f.turnIntoCSList([m.zero,m.zero,m.zero]),[a,a];c=m.real(c+1);h=f.column(b,c);h=f.scaldiv(e,h);e=h.value[0];g=h.value[1];h=h.value[2];e=f.turnIntoCSList([f.turnIntoCSList([m.real(0),h,m.mult(m.real(-1),g)]),f.turnIntoCSList([m.mult(m.real(-1),h),m.real(0),e]),f.turnIntoCSList([g,m.mult(m.real(-1),e),m.real(0)])]);a=f.add(a,e);var k=0;for(e=g=b=0;3>e;e++)for(c=0;3>c;c++)h=m.abs2(a.value[e].value[c]).value.real,h>g&&(k=e,b=c,g=h);e=a.value[k];a=f.transpose(a);a=a.value[b];e=f.normalizeMax(e);a=f.normalizeMax(a);
e=v.withUsage(e,"Line");a=v.withUsage(a,"Line");return[e,a]};n._helper.inputConic=function(a){var b="xx xy yy xz yz zz".split(" ").map(function(b){var c=m._helper.input(a[b]);b[0]!==b[1]&&(c=m.realmult(.5,c));return c});return n._helper.buildConicMatrix(b)};n.SelectConic={};n.SelectConic.kind="C";n.SelectConic.signature=["Cs"];n.SelectConic.initialize=function(a){if(void 0!==a.index)return a.index-1;var b=n._helper.inputConic(a.pos);a=u.csnames[a.args[0]].results;for(var c=f.conicDist(b,a[0]),e=0,
g=1;g<a.length;++g){var h=f.conicDist(b,a[g]);h<c&&(c=h,e=g)}return e};n.SelectConic.updatePosition=function(a){a.matrix=u.csnames[a.args[0]].results[a.param];a.matrix=f.normalizeMax(a.matrix);a.matrix=v.withUsage(a.matrix,"Conic")};n._helper.ConicBy4p1l=function(a,b,c,e,g,h){var d=f.scalproduct(b,h),k=f.scalproduct(c,h),l=f.scalproduct(e,h),p=f.scalproduct(g,h),B=f.det3(c,e,g),q=f.det3(b,c,g),r=f.det3(b,e,g),H=f.det3(b,c,e),t=m.mult;k=m.sqrt(t(t(k,p),t(B,q)));d=m.sqrt(t(t(d,l),t(r,H)));l=f.cross(f.cross(b,
e),h);h=f.cross(f.cross(c,g),h);l=f.scalmult(k,l);d=f.scalmult(d,h);h=f.normalizeMax(f.add(l,d));d=f.normalizeMax(f.sub(l,d));d=gb(h,d);h=n._helper.ConicBy5(a,b,c,e,g,d.value[0]);a=n._helper.ConicBy5(a,b,c,e,g,d.value[1]);return[f.normalizeMax(h),f.normalizeMax(a)]};n.ConicBy4p1l={};n.ConicBy4p1l.kind="Cs";n.ConicBy4p1l.signature=["P","P","P","P","L"];n.ConicBy4p1l.updatePosition=function(a){var b=n._helper.ConicBy4p1l(a,u.csnames[a.args[0]].homog,u.csnames[a.args[1]].homog,u.csnames[a.args[2]].homog,
u.csnames[a.args[3]].homog,u.csnames[a.args[4]].homog);a.results=b};n.ConicBy4p1l.stateSize=gb.stateSize;n._helper.ConicBy3p2l=function(a,b,c,e,g){function d(a,b,c,d){return m.sub(m.mult(a,d),m.mult(b,c))}var h=f.cross(a,b),k=f.cross(e,g);e=f.cross(e,h);g=f.cross(g,h);h=f.turnIntoCSList([e,g,k]);c=f.productVM(c,f.adjoint3(h));k=f.adjoint3(f.turnIntoCSList([f.scalmult(c.value[0],e),f.scalmult(c.value[1],g),f.scalmult(c.value[2],k)]));c=f.transpose(k);e=m.mult;g=f.productMV(c,a);a=g.value[0];g=g.value[1];
h=f.productMV(c,b);b=h.value[0];h=h.value[1];var l=m.sqrt(e(a,g)),n=m.sqrt(e(b,h)),p,B=Array(4);for(p=0;4>p;++p){var q=(p&2)-1,r=e(m.real(((p&1)<<1)-1),l),H=e(m.real(q),n),t=d(g,r,h,H),u=d(b,H,a,r);q=d(a,g,b,h);var v=m.add(m.add(d(b,h,a,g),d(h,H,g,r)),d(H,b,r,a));r=e(t,t);H=e(u,u);var R=e(v,v),w=e(t,u);t=e(t,v);u=e(u,v);w=m.sub(w,e(m.real(.5),e(q,q)));q=f.turnIntoCSList([f.turnIntoCSList([r,w,t]),f.turnIntoCSList([w,H,u]),f.turnIntoCSList([t,u,R])]);q=f.productMM(k,f.productMM(q,c));q=f.turnIntoCSList([q.value[0].value[0],
q.value[0].value[1],q.value[0].value[2],q.value[1].value[1],q.value[1].value[2],q.value[2].value[2]]);B[p]=q}return B};n.ConicBy3p2l={};n.ConicBy3p2l.kind="Cs";n.ConicBy3p2l.signature=["P","P","P","L","L"];n.ConicBy3p2l.updatePosition=function(a){var b=n._helper.ConicBy3p2l(u.csnames[a.args[0]].homog,u.csnames[a.args[1]].homog,u.csnames[a.args[2]].homog,u.csnames[a.args[3]].homog,u.csnames[a.args[4]].homog);b=Yd(b);for(var c=Array(4),e=0;4>e;++e){var g=b[e].value;c[e]=f.turnIntoCSList([f.turnIntoCSList([g[0],
g[1],g[2]]),f.turnIntoCSList([g[1],g[3],g[4]]),f.turnIntoCSList([g[2],g[4],g[5]])])}a.results=c};n.ConicBy3p2l.stateSize=48;n.ConicBy2p3l={};n.ConicBy2p3l.kind="Cs";n.ConicBy2p3l.signature=["P","P","L","L","L"];n.ConicBy2p3l.updatePosition=function(a){var b=n._helper.ConicBy3p2l(u.csnames[a.args[2]].homog,u.csnames[a.args[3]].homog,u.csnames[a.args[4]].homog,u.csnames[a.args[0]].homog,u.csnames[a.args[1]].homog);b=Yd(b);for(var c=Array(4),e=0;4>e;++e){var g=b[e].value;g=f.turnIntoCSList([f.turnIntoCSList([g[0],
g[1],g[2]]),f.turnIntoCSList([g[1],g[3],g[4]]),f.turnIntoCSList([g[2],g[4],g[5]])]);c[e]=f.normalizeMax(f.adjoint3(g))}a.results=c};n.ConicBy2p3l.stateSize=48;n.ConicBy1p4l={};n.ConicBy1p4l.kind="Cs";n.ConicBy1p4l.signature=["P","L","L","L","L"];n.ConicBy1p4l.updatePosition=function(a){var b=n._helper.ConicBy4p1l(a,u.csnames[a.args[1]].homog,u.csnames[a.args[2]].homog,u.csnames[a.args[3]].homog,u.csnames[a.args[4]].homog,u.csnames[a.args[0]].homog),c=b[0];b=b[1];c=f.adjoint3(c);b=f.adjoint3(b);b=
[c,b];a.results=b};n.ConicBy1p4l.stateSize=gb.stateSize;n.ConicParabolaPL={};n.ConicParabolaPL.kind="C";n.ConicParabolaPL.signature=["P","L"];n.ConicParabolaPL.updatePosition=function(a){var b=u.csnames[a.args[0]].homog.value,c=u.csnames[a.args[1]].homog.value,e=m.mult,g=m.neg,h=m.add,k=m.sub,l=b[0],p=b[1],q=b[2],r=c[0];b=c[1];c=c[2];var t=e(q,q),w=e(r,r),x=e(b,b),y=e(q,c),z=g(q);q=h(w,x);x=e(t,x);w=e(t,w);g=e(g(t),e(r,b));r=e(z,h(e(l,q),e(y,r)));b=e(z,h(e(p,q),e(y,b)));e=k(e(h(e(l,l),e(p,p)),q),
e(t,e(c,c)));e=n._helper.buildConicMatrix([x,g,w,r,b,e]);e=f.normalizeMax(e);a.matrix=v.withUsage(e,"Conic")};n.ConicBy2Foci1P={};n.ConicBy2Foci1P.kind="Cs";n.ConicBy2Foci1P.signature=["P","P","P"];n.ConicBy2Foci1P.updatePosition=function(a){var b=u.csnames[a.args[0]].homog,c=u.csnames[a.args[1]].homog,e=u.csnames[a.args[2]].homog,g=f.ii,h=f.jj,k=f.normalizeMax(f.cross(b,e)),l=f.normalizeMax(f.cross(c,e)),p=f.normalizeMax(f.cross(e,g));e=f.normalizeMax(f.cross(e,h));l=n._helper.coHarmonic(p,e,k,l);
k=f.normalizeMax(l[0]);l=f.normalizeMax(l[1]);g=f.turnIntoCSList([g]);p=f.turnIntoCSList([h]);e=f.turnIntoCSList([b]);var q=f.turnIntoCSList([c]);h=n._helper.conicFromTwoDegenerates(g,p,e,q,k);h=f.normalizeMax(h);g=n._helper.conicFromTwoDegenerates(g,p,e,q,l);g=f.normalizeMax(g);h=f.normalizeMax(f.adjoint3(h));g=f.normalizeMax(f.adjoint3(g));"ellipsoid"!==n._helper.getConicType(h)&&(k=h,h=g,g=k);f.almostequals(b,c).value&&(b=m.real(3),g=f.zeromatrix(b,b));a.results=[h,g]};n.ConicBy2Pol1P={};n.ConicBy2Pol1P.kind=
"C";n.ConicBy2Pol1P.signature=["P","L","P","L","P"];n.ConicBy2Pol1P.updatePosition=function(a){var b=u.csnames[a.args[0]].homog,c=u.csnames[a.args[1]].homog,e=u.csnames[a.args[2]].homog,g=u.csnames[a.args[3]].homog,h=u.csnames[a.args[4]].homog,k=f.scalproduct,l=f.scalmult,n=f.sub,p=f.productMM,q=m.realmult,r=f.transpose,t=f.turnIntoCSList,w=n(l(k(c,b),h),l(q(2,k(c,h)),b)),x=n(l(k(g,e),h),l(q(2,k(g,h)),e)),y=t([f.cross(b,h)]);h=t([f.cross(e,h)]);x=p(r(y),t([f.cross(b,x)]));t=p(r(h),t([f.cross(e,w)]));
p=p(r(y),h);b=k(b,g);c=k(e,c);e=f.add(l(c,x),l(b,t));e=n(e,l(q(2,m.mult(b,c)),p));e=f.add(e,r(e));e=f.normalizeMax(e);e=v.withUsage(e,"Conic");a.matrix=e};n.ConicBy2Pol1L={};n.ConicBy2Pol1L.kind="C";n.ConicBy2Pol1L.signature=["P","L","P","L","L"];n.ConicBy2Pol1L.updatePosition=function(a){var b=u.csnames[a.args[0]].homog,c=u.csnames[a.args[1]].homog,e=u.csnames[a.args[2]].homog,g=u.csnames[a.args[3]].homog,h=u.csnames[a.args[4]].homog,k=f.scalproduct,l=f.scalmult,n=f.productMM,p=m.mult,q=f.transpose,
r=f.turnIntoCSList,t=k(c,b),w=k(c,e),x=k(g,b),y=k(g,e),z=k(h,b);k=k(h,e);var A=r([f.sub(l(p(x,k),c),l(p(w,z),g))]);b=f.add(n(q(r([l(p(x,w),h)])),r([f.sub(f.add(l(m.sub(p(t,k),p(w,z)),g),l(m.sub(p(y,z),p(x,k)),c)),l(f.det3(c,g,h),f.cross(b,e)))])),n(q(A),A));b=f.add(b,q(b));b=f.normalizeMax(b);b=v.withUsage(b,"Conic");a.matrix=b};n._helper.conic1Pol3Inc=function(a,b,c,e,g){var d=f.scalproduct,h=f.scalmult,k=f.productMM,l=f.cross,n=m.realmult,p=m.mult,q=f.transpose,B=f.turnIntoCSList,r=f.det3,t=r(a,
c,e),H=B([l(c,g)]),u=B([l(a,g)]),v=B([l(c,e)]),w=d(b,a),x=d(b,c);b=d(b,g);l=B([l(e,f.sub(h(w,g),h(n(2,b),a)))]);H=h(t,k(q(H),l));a=n(2,m.add(p(r(a,e,g),x),p(t,b)));a=m.sub(p(r(c,e,g),w),a);H=f.add(H,h(a,k(q(u),v)));H=f.add(H,q(H));return H=f.normalizeMax(H)};n.ConicBy1Pol3P={};n.ConicBy1Pol3P.kind="C";n.ConicBy1Pol3P.signature=["P","L","P","P","P"];n.ConicBy1Pol3P.updatePosition=function(a){var b=n._helper.conic1Pol3Inc(u.csnames[a.args[0]].homog,u.csnames[a.args[1]].homog,u.csnames[a.args[2]].homog,
u.csnames[a.args[3]].homog,u.csnames[a.args[4]].homog);b=v.withUsage(b,"Conic");a.matrix=b};n.ConicBy1Pol3L={};n.ConicBy1Pol3L.kind="C";n.ConicBy1Pol3L.signature=["P","L","L","L","L"];n.ConicBy1Pol3L.updatePosition=function(a){var b=n._helper.conic1Pol3Inc(u.csnames[a.args[1]].homog,u.csnames[a.args[0]].homog,u.csnames[a.args[2]].homog,u.csnames[a.args[3]].homog,u.csnames[a.args[4]].homog);b=f.normalizeMax(f.adjoint3(b));b=v.withUsage(b,"Conic");a.matrix=b};n.ConicBy1Pol2P1L={};n.ConicBy1Pol2P1L.kind=
"Cs";n.ConicBy1Pol2P1L.signature=["P","L","P","P","L"];n.ConicBy1Pol2P1L.updatePosition=function(a){var b=u.csnames[a.args[0]].homog,c=u.csnames[a.args[1]].homog,e=u.csnames[a.args[2]].homog,g=u.csnames[a.args[3]].homog,h=u.csnames[a.args[4]].homog,k=m.add,l=f.turnIntoCSList,n=f.cross,p=f.productMM,q=m.mult,r=m.realmult,t=f.scalmult,v=f.scalproduct,w=m.sub,x=f.transpose,y=v(c,b),z=v(c,e),A=v(c,g);c=v(h,b);var C=v(h,e);v=v(h,g);h=l([n(b,e)]);b=l([n(b,g)]);e=l([n(e,g)]);g=m.sqrt(q(q(C,v),q(w(q(y,C),
r(2,q(c,z))),w(q(y,v),r(2,q(c,A))))));l=p(x(h),b);g=t(g,f.add(l,x(l)));k=t(w(q(y,q(C,v)),k(q(c,q(z,v)),q(c,q(C,A)))),l);r=f.add(f.sub(t(A,h),t(z,b)),t(r(.5,y),e));k=f.add(k,t(q(c,c),p(x(e),r)));k=f.add(k,x(k));p=f.normalizeMax(f.add(g,k));q=f.normalizeMax(f.sub(g,k));a.results=pc(p,q).value};n.ConicBy1Pol2P1L.stateSize=pc.stateSize;n.ConicBy1Pol1P2L={};n.ConicBy1Pol1P2L.kind="Cs";n.ConicBy1Pol1P2L.signature=["P","L","P","L","L"];n.ConicBy1Pol1P2L.updatePosition=function(a){var b=u.csnames[a.args[0]].homog,
c=u.csnames[a.args[1]].homog,e=u.csnames[a.args[2]].homog,g=u.csnames[a.args[3]].homog,h=u.csnames[a.args[4]].homog,k=m.add,l=f.turnIntoCSList,n=f.cross,p=f.productMM,q=m.mult,r=m.realmult,t=f.scalmult,v=f.scalproduct,w=m.sub,x=f.transpose,y=v(c,b),z=v(c,e),A=v(g,b),C=v(g,e),D=v(h,b),E=v(h,e),F=q(y,y),G=q(y,z);v=q(z,z);var I=q(A,A),J=q(A,C),K=q(C,C),L=q(D,D),M=q(D,E),O=q(E,E),N=q(q(F,K),O);N=w(N,r(2,q(q(G,J),O)));N=w(N,r(2,q(q(G,K),M)));N=k(N,r(.5,q(q(v,I),O)));N=k(N,r(3,q(q(v,J),M)));N=k(N,r(.5,
q(q(v,K),L)));M=q(q(y,C),E);M=w(M,q(q(z,A),E));M=w(M,q(q(z,C),D));M=q(M,q(v,D));O=w(q(y,C),r(2,q(z,A)));O=q(O,q(v,q(C,D)));N=p(x(l([c])),l([f.add(f.add(t(N,c),t(M,g)),t(O,h))]));M=l([g]);N=f.add(N,t(r(.5,q(q(v,v),L)),p(x(M),M)));N=f.add(N,t(v,p(x(l([h])),l([f.add(t(w(w(r(2,q(G,J)),q(F,K)),r(.5,q(v,I))),h),t(q(f.det3(c,g,h),w(q(y,C),q(z,A))),n(b,e)))]))));N=f.add(N,x(N));b=m.sqrt(q(q(C,E),q(w(q(y,C),r(2,q(z,A))),w(q(y,E),r(2,q(z,D))))));c=p(x(l([c])),l([f.sub(t(w(q(z,k(q(A,E),q(C,D))),q(y,q(C,E))),
c),t(v,f.add(t(D,g),t(A,h))))]));c=f.add(c,t(q(y,v),p(x(l([g])),l([h]))));c=t(b,c);c=f.add(c,x(c));g=f.normalizeMax(f.add(N,c));h=f.normalizeMax(f.sub(N,c));a.results=pc(g,h).value};n.ConicBy1Pol1P2L.stateSize=pc.stateSize;n._helper.coHarmonic=function(a,b,c,e){var d=f.realVector([100*Math.random(),100*Math.random(),1]),g=f.det3(d,c,a),h=f.det3(d,c,b);c=f.det3(d,e,a);e=f.det3(d,e,b);e=m.sqrt(m.mult(e,h));g=m.sqrt(m.mult(c,g));a=v.mult(a,e);g=v.mult(b,g);b=f.add(a,g);a=f.sub(a,g);return[b,a]};n.ConicInSquare=
{};n.ConicInSquare.kind="C";n.ConicInSquare.signature=["P","P","P","P"];n.ConicInSquare.updatePosition=function(a){var b=E.basismap(u.csnames[a.args[0]].homog,u.csnames[a.args[1]].homog,u.csnames[a.args[2]].homog,u.csnames[a.args[3]].homog),c=m.one;c=n._helper.buildConicMatrix([c,c,c,m.real(-3),c,c]);b=f.adjoint3(b);b=f.productMM(f.productMM(f.transpose(b),c),b);b=f.normalizeMax(b);a.matrix=v.withUsage(b,"Conic")};n.ConicBy5lines={};n.ConicBy5lines.kind="C";n.ConicBy5lines.signature=["L","L","L",
"L","L"];n.ConicBy5lines.updatePosition=function(a){var b=n._helper.ConicBy5(a,u.csnames[a.args[0]].homog,u.csnames[a.args[1]].homog,u.csnames[a.args[2]].homog,u.csnames[a.args[3]].homog,u.csnames[a.args[4]].homog);b=f.adjoint3(b);a.matrix=b;a.matrix=f.normalizeMax(a.matrix);a.matrix=v.withUsage(a.matrix,"Conic")};n.ConicFromPrincipalDirections={};n.ConicFromPrincipalDirections.kind="C";n.ConicFromPrincipalDirections.signature=["P","P","P"];n.ConicFromPrincipalDirections.updatePosition=function(a){var b=
u.csnames[a.args[0]].homog,c=u.csnames[a.args[1]].homog,e=u.csnames[a.args[2]].homog,g=n._helper.pointReflection(b,c),h=f.cross(c,b);b=f.turnIntoCSList([h.value[0],h.value[1],m.zero]);h=f.turnIntoCSList([h]);c=f.turnIntoCSList([f.cross(c,b)]);g=f.turnIntoCSList([f.cross(g,b)]);a.matrix=n._helper.conicFromTwoDegenerates(h,h,c,g,e);a.matrix=f.normalizeMax(a.matrix);a.matrix=v.withUsage(a.matrix,"Conic")};n.CircleBy3={};n.CircleBy3.kind="C";n.CircleBy3.signature=["P","P","P"];n.CircleBy3.updatePosition=
function(a){var b=n._helper.ConicBy5(a,u.csnames[a.args[0]].homog,u.csnames[a.args[1]].homog,f.ii,f.jj,u.csnames[a.args[2]].homog);a.matrix=f.normalizeMax(b);a.matrix=v.withUsage(a.matrix,"Circle")};n.ArcBy3={};n.ArcBy3.kind="C";n.ArcBy3.signature=["P","P","P"];n.ArcBy3.updatePosition=function(a){n.CircleBy3.updatePosition(a);a.startPoint=u.csnames[a.args[0]].homog;a.viaPoint=u.csnames[a.args[1]].homog;a.endPoint=u.csnames[a.args[2]].homog};n.ArcBy3.initialize=function(a){a.startPoint=u.csnames[a.args[0]].homog;
a.viaPoint=u.csnames[a.args[1]].homog;a.endPoint=u.csnames[a.args[2]].homog;a.isArc=!0};n.PolarOfPoint={};n.PolarOfPoint.kind="L";n.PolarOfPoint.signature=["P","C"];n.PolarOfPoint.updatePosition=function(a){var b=v.mult(u.csnames[a.args[1]].matrix,u.csnames[a.args[0]].homog);b=f.normalizeMax(b);a.homog=v.withUsage(b,"Line")};n.PolarOfLine={};n.PolarOfLine.kind="P";n.PolarOfLine.signature=["L","C"];n.PolarOfLine.updatePosition=function(a){var b=u.csnames[a.args[0]],c=f.adjoint3(u.csnames[a.args[1]].matrix);
b=v.mult(c,b.homog);b=f.normalizeMax(b);a.homog=v.withUsage(b,"Point")};n.AngleBisector={};n.AngleBisector.kind="Ls";n.AngleBisector.signature=["L","L","P"];n.AngleBisector.updatePosition=function(a){var b=u.csnames[a.args[0]].homog,c=u.csnames[a.args[1]].homog,e=u.csnames[a.args[2]].homog,g=f.add,h=f.sub,k=f.abs,l=f.cross,m=f.scalmult,n=f.normalizeMax,p=f._helper.isAlmostZero,q=f.linfty,r=m(k(l(l(q,c),q)),b);b=m(k(l(l(q,b),q)),c);h=h(r,b);g=g(r,b);p(h)&&(h=l(l(l(q,g),q),e));p(g)&&(g=l(l(l(q,h),q),
e));a.results=gb(n(h),n(g))};n.AngleBisector.stateSize=gb.stateSize;n._helper.IntersectLC=function(a,b){var c=m,d=f.crossOperator(a),e=f.transpose(d);b=v.mult(e,v.mult(b,d));e=f.maxIndex(a,m.abs2);if(0===e){e=b.value[1].value[1];var g=b.value[1].value[2];var h=b.value[2].value[1];var k=b.value[2].value[2];a=a.value[0]}else 1===e?(e=b.value[0].value[0],g=b.value[0].value[2],h=b.value[2].value[0],k=b.value[2].value[2],a=a.value[1]):(e=b.value[0].value[0],g=b.value[0].value[1],h=b.value[1].value[0],
k=b.value[1].value[1],a=a.value[2]);c=c.div(c.sqrt(c.sub(c.mult(g,h),c.mult(e,k))),a);c=f.add(b,f.scalmult(c,d));e=f.maxIndex(c,f.abs2);d=c.value[e];d=f.normalizeMax(d);d=v.withUsage(d,"Point");c=f.transpose(c);e=f.maxIndex(c,f.abs2);c=c.value[e];c=f.normalizeMax(c);c=v.withUsage(c,"Point");return[d,c]};n.IntersectLC={};n.IntersectLC.kind="Ps";n.IntersectLC.signature=["L","C"];n.IntersectLC.updatePosition=function(a){var b=n._helper.IntersectLC(u.csnames[a.args[0]].homog,u.csnames[a.args[1]].matrix);
a.results=gb(b[0],b[1])};n.IntersectLC.stateSize=gb.stateSize;n.OtherIntersectionCL={};n.OtherIntersectionCL.kind="P";n.OtherIntersectionCL.signature=["C","L","P"];n.OtherIntersectionCL.updatePosition=function(a){var b=u.csnames[a.args[2]].homog,c=n._helper.IntersectLC(u.csnames[a.args[1]].homog,u.csnames[a.args[0]].matrix),e=c[0];c=c[1];var g=f.projectiveDistMinScal(e,b);b=f.projectiveDistMinScal(c,b);a.homog=g<b?c:e;a.homog=f.normalizeMax(a.homog);a.homog=v.withUsage(a.homog,"Point")};n.IntersectCirCir=
{};n.IntersectCirCir.kind="Ps";n.IntersectCirCir.signature=["C","C"];n.IntersectCirCir.updatePosition=function(a){var b=u.csnames[a.args[0]].matrix,c=u.csnames[a.args[1]].matrix,e=f.scalmult(c.value[0].value[0],b.value[2]);c=f.scalmult(b.value[0].value[0],c.value[2]);e=f.sub(e,c);e=f.turnIntoCSList([e.value[0],e.value[1],m.realmult(.5,e.value[2])]);e=f.normalizeMax(e);b=n._helper.IntersectLC(e,b);a.results=gb(b[0],b[1])};n.IntersectCirCir.stateSize=gb.stateSize;n.OtherIntersectionCC={};n.OtherIntersectionCC.kind=
"P";n.OtherIntersectionCC.signature=["C","C","P"];n.OtherIntersectionCC.updatePosition=function(a){var b=u.csnames[a.args[0]].matrix,c=u.csnames[a.args[1]].matrix,e=u.csnames[a.args[2]].homog,g=f.scalmult(c.value[0].value[0],b.value[2]);c=f.scalmult(b.value[0].value[0],c.value[2]);g=f.sub(g,c);g=f.turnIntoCSList([g.value[0],g.value[1],m.realmult(.5,g.value[2])]);g=f.normalizeMax(g);g=n._helper.IntersectLC(g,b);b=g[0];g=g[1];c=f.projectiveDistMinScal(b,e);e=f.projectiveDistMinScal(g,e);a.homog=c<e?
g:b;a.homog=f.normalizeMax(a.homog);a.homog=v.withUsage(a.homog,"Point")};n._helper.IntersectConicConic=function(a,b){var c=a.value[0],d=a.value[1],e=a.value[2],g=b.value[0],h=b.value[1],k=b.value[2],l=f.det3(c,d,e),p=m.add(m.add(f.det3(c,d,k),f.det3(c,h,e)),f.det3(g,d,e));c=m.add(m.add(f.det3(c,h,k),f.det3(g,d,k)),f.det3(g,h,e));g=f.det3(g,h,k);k=m.abs2(l).value.real;h=m.abs2(g).value.real;k<h&&(k=a,a=b,b=k,k=g,g=l,l=k,k=c,c=p,p=k,k=h);1E-24>k?(l=a,p=b):(p=m.solveCubic(l,p,c,g),c=m.abs2(m.sub(p[0],
p[1])).value.real,g=m.abs2(m.sub(p[0],p[2])).value.real,h=m.abs2(m.sub(p[1],p[2])).value.real,c>g?(l=p[1],p=c>h?p[0]:p[2]):(l=p[2],p=g>h?p[0]:p[1]),l=f.add(f.scalmult(l,a),b),p=f.add(f.scalmult(p,a),b));b=n._helper.splitDegenConic(l);a=b[0];b=b[1];l=n._helper.splitDegenConic(p);c=l[0];p=l[1];l=f.cross(a,c);c=f.cross(b,c);a=f.cross(a,p);b=f.cross(b,p);l=f.normalizeMax(l);c=f.normalizeMax(c);a=f.normalizeMax(a);b=f.normalizeMax(b);l=v.withUsage(l,"Point");c=v.withUsage(c,"Point");a=v.withUsage(a,"Point");
b=v.withUsage(b,"Point");return[l,c,a,b]};n.IntersectConicConic={};n.IntersectConicConic.kind="Ps";n.IntersectConicConic.signature=["C","C"];n.IntersectConicConic.updatePosition=function(a){var b=n._helper.IntersectConicConic(u.csnames[a.args[0]].matrix,u.csnames[a.args[1]].matrix);b=ld(b[0],b[1],b[2],b[3]);a.results=b};n.IntersectConicConic.stateSize=ld.stateSize;n.SelectP={};n.SelectP.kind="P";n.SelectP.signature=["Ps"];n.SelectP.initialize=function(a){if(void 0!==a.index)return a.index-1;var b=
u.csnames[a.args[0]].results.value;a=n._helper.initializePoint(a);for(var c=f.projectiveDistMinScal(a,b[0]),e=0,g=1;g<b.length;++g){var h=f.projectiveDistMinScal(a,b[g]);h<c&&(c=h,e=g)}return e};n.SelectP.updatePosition=function(a){a.homog=u.csnames[a.args[0]].results.value[a.param]};n.SelectL={};n.SelectL.kind="L";n.SelectL.signature=["Ls"];n.SelectL.initialize=function(a){if(void 0!==a.index)return a.index-1;var b=u.csnames[a.args[0]].results.value;a=n._helper.initializeLine(a);for(var c=f.projectiveDistMinScal(a,
b[0]),e=0,g=1;g<b.length;++g){var h=f.projectiveDistMinScal(a,b[g]);h<c&&(c=h,e=g)}return e};n.SelectL.updatePosition=function(a){a.homog=u.csnames[a.args[0]].results.value[a.param];a.homog=v.withUsage(a.homog,"Line")};n._helper.moebiusStep=function(a,b,c){var d=m.add,f=m.sub,e=m.mult,g=a.value[0],h=a.value[1];a=a.value[2];var k=b.value[0],l=b.value[1];b=b.value[2];var n=c.value[0],p=c.value[1],q=c.value[2];c=f(e(b,n),e(k,q));var B=f(e(b,p),e(l,q));n=f(e(g,q),e(a,n));p=f(e(h,q),e(a,p));return[f(e(g,
c),e(h,B)),d(e(h,c),e(g,B)),e(a,c),e(a,B),f(e(k,n),e(l,p)),d(e(l,n),e(k,p)),e(b,n),e(b,p)]};n.TrMoebius={};n.TrMoebius.kind="Mt";n.TrMoebius.signature="PPPPPP".split("");n.TrMoebius.updatePosition=function(a){var b=m.neg,c=n._helper.moebiusStep(u.csnames[a.args[0]].homog,u.csnames[a.args[2]].homog,u.csnames[a.args[4]].homog),e=n._helper.moebiusStep(u.csnames[a.args[1]].homog,u.csnames[a.args[3]].homog,u.csnames[a.args[5]].homog);e=f.normalizeMax(f.matrix([[e[0],b(e[1]),e[4],b(e[5])],[e[1],e[0],e[5],
e[4]],[e[2],b(e[3]),e[6],b(e[7])],[e[3],e[2],e[7],e[6]]]));b=f.normalizeMax(f.matrix([[c[6],b(c[4])],[c[7],b(c[5])],[b(c[2]),c[0]],[b(c[3]),c[1]]]));b=f.normalizeMax(f.productMM(e,b));a.moebius={anti:!1,ar:b.value[0].value[0],ai:b.value[1].value[0],br:b.value[0].value[1],bi:b.value[1].value[1],cr:b.value[2].value[0],ci:b.value[3].value[0],dr:b.value[2].value[1],di:b.value[3].value[1]};n._helper.moebiusPair(a)};n._helper.moebiusPair=function(a){var b=a.moebius,c=m.neg,e=b.anti?c:v.identity;b=f.normalizeMax(f.turnIntoCSList([f.matrix([[c(b.cr),
e(b.ci),c(b.dr)],[b.ci,e(b.cr),b.di],[b.ar,c(e(b.ai)),b.br]]),f.matrix([[c(b.ci),c(e(b.cr)),c(b.di)],[c(b.cr),e(b.ci),c(b.dr)],[b.ai,e(b.ar),b.bi]])]));a.mat1=b.value[0];a.mat2=b.value[1]};n._helper.inverseMoebius=function(a){var b=m.neg,c=a.anti?b:v.identity;return{anti:a.anti,ar:a.dr,ai:c(a.di),br:b(a.br),bi:b(c(a.bi)),cr:b(a.cr),ci:b(c(a.ci)),dr:a.ar,di:c(a.ai)}};n.TrInverseMoebius={};n.TrInverseMoebius.kind="Mt";n.TrInverseMoebius.signature=["Mt"];n.TrInverseMoebius.updatePosition=function(a){a.moebius=
n._helper.inverseMoebius(u.csnames[a.args[0]].moebius);n._helper.moebiusPair(a)};n.TrMoebiusP={};n.TrMoebiusP.kind="P";n.TrMoebiusP.signature=["Mt","P"];n.TrMoebiusP.updatePosition=function(a){var b=u.csnames[a.args[0]],c=u.csnames[a.args[1]].homog,e=f.productMV(b.mat1,c);b=f.productMV(b.mat2,c);a.homog=f.normalizeMax(f.cross(e,b));a.homog=v.withUsage(a.homog,"Point")};n._helper.TrMoebiusP=function(a,b){var c=f.productMV(b.mat1,a);a=f.productMV(b.mat2,a);return f.normalizeMax(f.cross(c,a))};n.TrMoebiusL=
{};n.TrMoebiusL.kind="C";n.TrMoebiusL.signature=["Mt","L"];n.TrMoebiusL.updatePosition=function(a){var b=u.csnames[a.args[0]],c=u.csnames[a.args[1]].homog,e=function(){var a=f.realVector([Math.random()-.5,Math.random()-.5,Math.random()-.5]);return f.normalizeMax(a)},g=f.cross(e(),c),h=f.cross(e(),c);c=f.cross(e(),c);g=n._helper.TrMoebiusP(g,b);h=n._helper.TrMoebiusP(h,b);b=n._helper.TrMoebiusP(c,b);a.matrix=f.normalizeMax(n._helper.ConicBy5(null,g,h,b,f.ii,f.jj));a.matrix=v.withUsage(a.matrix,"Circle")};
n.TrMoebiusS={};n.TrMoebiusS.kind="C";n.TrMoebiusS.signature=["Mt","S"];n.TrMoebiusS.updatePosition=function(a){var b=u.csnames[a.args[0]],c=u.csnames[a.args[1]],e=c.startpos;c=c.endpos;var g=f.add(e,c);e=n._helper.TrMoebiusP(e,b);g=n._helper.TrMoebiusP(g,b);b=n._helper.TrMoebiusP(c,b);a.startPoint=e;a.viaPoint=g;a.endPoint=b;a.isArc=!0;a.matrix=f.normalizeMax(n._helper.ConicBy5(null,e,g,b,f.ii,f.jj));a.matrix=v.withUsage(a.matrix,"Circle")};n.TrMoebiusC={};n.TrMoebiusC.kind="C";n.TrMoebiusC.signature=
["Mt","C"];n.TrMoebiusC.signatureConstraints=function(a){return"Circle"===u.csnames[a.args[1]].matrix.usage};n.TrMoebiusC.updatePosition=function(a){var b=u.csnames[a.args[0]],c=u.csnames[a.args[1]].matrix,e=function(){var a=f.realVector([Math.random()-.5,Math.random()-.5,Math.random()-.5]);return f.normalizeMax(a)},g=n._helper.IntersectLC(e(),c);e=n._helper.IntersectLC(e(),c);c=g[1];e=e[1];g=n._helper.TrMoebiusP(g[0],b);c=n._helper.TrMoebiusP(c,b);b=n._helper.TrMoebiusP(e,b);a.matrix=f.normalizeMax(n._helper.ConicBy5(null,
g,c,b,f.ii,f.jj));a.matrix=v.withUsage(a.matrix,"Circle")};n.TrMoebiusArc={};n.TrMoebiusArc.kind="C";n.TrMoebiusArc.signature=["Mt","C"];n.TrMoebiusArc.signatureConstraints=function(a){return u.csnames[a.args[1]].isArc};n.TrMoebiusArc.updatePosition=function(a){var b=u.csnames[a.args[0]],c=u.csnames[a.args[1]],e=c.viaPoint,g=c.endPoint;c=n._helper.TrMoebiusP(c.startPoint,b);e=n._helper.TrMoebiusP(e,b);b=n._helper.TrMoebiusP(g,b);a.startPoint=c;a.viaPoint=e;a.endPoint=b;a.isArc=!0;a.matrix=f.normalizeMax(n._helper.ConicBy5(null,
c,e,b,f.ii,f.jj));a.matrix=v.withUsage(a.matrix,"Circle")};n._helper.trBuildMatrix=function(a,b){var c=b(0);b=b(1);var d=f.productMM(b,f.adjoint3(c));a.matrix=f.normalizeMax(d);d=f.transpose(f.productMM(c,f.adjoint3(b)));a.dualMatrix=f.normalizeMax(d)};n.TrProjection={};n.TrProjection.kind="Tr";n.TrProjection.signature="PPPPPPPP".split("");n.TrProjection.initialize=function(a){a.isEuclidean=0};n.TrProjection.updatePosition=function(a){n._helper.trBuildMatrix(a,function(b){return E.basismap(u.csnames[a.args[0+
b]].homog,u.csnames[a.args[2+b]].homog,u.csnames[a.args[4+b]].homog,u.csnames[a.args[6+b]].homog)})};n.TrAffine={};n.TrAffine.kind="Tr";n.TrAffine.signature="PPPPPP".split("");n.TrAffine.initialize=function(a){a.isEuclidean=0};n.TrAffine.updatePosition=function(a){var b=m.mult,c=f.scalmult,e=f.turnIntoCSList,g=f.transpose,h=f.normalizeMax,k=f.productMM,l=f.adjoint3,n=e([u.csnames[a.args[0]].homog,u.csnames[a.args[2]].homog,u.csnames[a.args[4]].homog]),p=e([u.csnames[a.args[1]].homog,u.csnames[a.args[3]].homog,
u.csnames[a.args[5]].homog]),q=g(n);g=g(p);var r=q.value[2].value,t=g.value[2].value,v=[b(r[0],t[2]),b(r[1],t[0]),b(r[2],t[1])];q=l(q).value;a.matrix=h(k(g,e([c(b(v[0],t[1]),q[0]),c(b(v[1],t[2]),q[1]),c(b(v[2],t[0]),q[2])])));q=n.value;a.dualMatrix=h(k(l(p),e([c(b(r[2],v[1]),q[0]),c(b(r[0],v[2]),q[1]),c(b(r[1],v[0]),q[2])])))};n.TrSimilarity={};n.TrSimilarity.kind="Tr";n.TrSimilarity.signature=["P","P","P","P"];n.TrSimilarity.initialize=function(a){a.isEuclidean=1};n.TrSimilarity.updatePosition=function(a){n._helper.trBuildMatrix(a,
function(b){return E.basismap(u.csnames[a.args[0+b]].homog,u.csnames[a.args[2+b]].homog,f.ii,f.jj)})};n.TrTranslation={};n.TrTranslation.kind="Tr";n.TrTranslation.signature=["P","P"];n.TrTranslation.initialize=function(a){a.isEuclidean=1};n.TrTranslation.updatePosition=function(a){var b=u.csnames[a.args[0]].homog,c=u.csnames[a.args[1]].homog,e=f.cross(b,c).value;b=m.mult(b.value[2],c.value[2]);c=f.turnIntoCSList;var g=m.neg,h=m.zero;e=c([c([b,h,e[1]]),c([h,b,g(e[0])]),c([h,h,b])]);e=f.normalizeMax(e);
a.matrix=e;b=g(e.value[0].value[0]);e=c([c([b,h,h]),c([h,b,h]),c([e.value[0].value[2],e.value[1].value[2],b])]);a.dualMatrix=e};n.TrRotationPNumb={};n.TrRotationPNumb.kind="Tr";n.TrRotationPNumb.signature=["P","V"];n.TrRotationPNumb.updatePosition=function(a){var b=u.csnames[a.args[0]].homog.value,c=u.csnames[a.args[1]].value,e=m.mult,g=m.add,h=m.sub,k=f.turnIntoCSList,l=f.normalizeMax,n=m.zero,p=b[0],q=b[1];b=b[2];var r=m.cos(c),t=m.sin(c),v=h(m.real(1),r);c=e(v,p);v=e(v,q);p=e(t,p);q=e(t,q);r=e(r,
b);e=e(t,b);t=m.neg(e);a.matrix=l(k([k([r,t,g(c,q)]),k([e,r,h(v,p)]),k([n,n,b])]));a.dualMatrix=l(k([k([r,t,n]),k([e,r,n]),k([h(c,q),g(v,p),b])]))};n.TrReflectionP={};n.TrReflectionP.kind="Tr";n.TrReflectionP.signature=["P"];n.TrReflectionP.initialize=function(a){a.isEuclidean=1};n.TrReflectionP.updatePosition=function(a){var b=u.csnames[a.args[0]].homog.value,c=m.realmult(-.5,b[2]),e=m.zero;b=f.turnIntoCSList([f.turnIntoCSList([c,e,b[0]]),f.turnIntoCSList([e,c,b[1]]),f.turnIntoCSList([e,e,m.neg(c)])]);
b=f.normalizeMax(b);a.matrix=b;a.dualMatrix=f.transpose(b)};n.TrReflectionL={};n.TrReflectionL.kind="Tr";n.TrReflectionL.signature=["L"];n.TrReflectionL.initialize=function(a){a.isEuclidean=-1};n.TrReflectionL.updatePosition=function(a){var b=m.mult,c=m.realmult,e=m.zero,g=u.csnames[a.args[0]].homog.value,h=g[0],k=g[1];g=g[2];var l=b(h,h),n=b(k,k),p=c(-.5,m.sub(l,n)),q=b(h,k);b=f.turnIntoCSList([f.turnIntoCSList([m.neg(p),q,b(h,g)]),f.turnIntoCSList([q,p,b(k,g)]),f.turnIntoCSList([e,e,c(-.5,m.add(l,
n))])]);b=f.normalizeMax(b);a.matrix=b;a.dualMatrix=f.transpose(b)};n.TrReflectionS={};n.TrReflectionS.kind="Tr";n.TrReflectionS.signature=["S"];n.TrReflectionS.updatePosition=n.TrReflectionL.updatePosition;n.TrReflectionC={};n.TrReflectionC.kind="Mt";n.TrReflectionC.signature=["C"];n.TrReflectionC.signatureConstraints=function(a){return"Circle"===u.csnames[a.args[0]].matrix.usage};n.TrReflectionC.updatePosition=function(a){var b=u.csnames[a.args[0]].matrix,c=b.value[0].value[2],e=b.value[1].value[2],
f=m.neg;a.moebius={anti:!0,ar:c,ai:e,br:b.value[2].value[2],bi:m.zero,cr:f(b.value[0].value[0]),ci:m.zero,dr:f(c),di:e};n._helper.moebiusPair(a)};n.TrInverse={};n.TrInverse.kind="Tr";n.TrInverse.signature=["Tr"];n.TrInverse.initialize=function(a){a.isEuclidean=u.csnames[a.args[0]].isEuclidean};n.TrInverse.updatePosition=function(a){var b=u.csnames[a.args[0]];a.dualMatrix=f.transpose(b.matrix);a.matrix=f.transpose(b.dualMatrix)};n.TransformC={};n.TransformC.kind="C";n.TransformC.signature=["Tr","C"];
n.TransformC.updatePosition=function(a){var b=u.csnames[a.args[0]].dualMatrix;b=f.productMM(f.productMM(b,u.csnames[a.args[1]].matrix),f.transpose(b));b=f.normalizeMax(b);a.matrix=v.withUsage(b,"Conic")};n.TransformArc={};n.TransformArc.kind="C";n.TransformArc.signature=["Tr","C"];n.TransformArc.signatureConstraints=function(a){return u.csnames[a.args[0]].isArc};n.TransformArc.updatePosition=function(a){var b=u.csnames[a.args[0]].matrix,c=u.csnames[a.args[1]],e=c.viaPoint,g=c.endPoint;c=f.normalizeMax(f.productMV(b,
c.startPoint));e=f.normalizeMax(f.productMV(b,e));b=f.normalizeMax(f.productMV(b,g));a.startPoint=c;a.viaPoint=e;a.endPoint=b;a.isArc=!0;a.matrix=f.normalizeMax(n._helper.ConicBy5(null,c,e,b,f.ii,f.jj));a.matrix=v.withUsage(a.matrix,"Circle")};n.TransformP={};n.TransformP.kind="P";n.TransformP.signature=["Tr","P"];n.TransformP.updatePosition=function(a){a.homog=f.normalizeMax(f.productMV(u.csnames[a.args[0]].matrix,u.csnames[a.args[1]].homog));a.homog=v.withUsage(a.homog,"Point")};n.TransformL={};
n.TransformL.kind="L";n.TransformL.signature=["Tr","L"];n.TransformL.updatePosition=function(a){a.homog=f.normalizeMax(f.productMV(u.csnames[a.args[0]].dualMatrix,u.csnames[a.args[1]].homog));a.homog=v.withUsage(a.homog,"Line")};n.TransformS={};n.TransformS.kind="S";n.TransformS.signature=["Tr","S"];n.TransformS.updatePosition=function(a){var b=u.csnames[a.args[0]],c=u.csnames[a.args[1]];n.Segment.setSegmentPos(a,f.productMV(b.dualMatrix,c.homog),f.productMV(b.matrix,c.startpos),f.productMV(b.matrix,
c.endpos))};n.TransformPolygon={};n.TransformPolygon.kind="Poly";n.TransformPolygon.signature=["Tr","Poly"];n.TransformPolygon.updatePosition=function(a){var b=u.csnames[a.args[0]].matrix;a.vertices=f.turnIntoCSList(u.csnames[a.args[1]].vertices.value.map(function(a){a=f.normalizeMax(f.productMV(b,a));return a=v.withUsage(a,"Point")}))};n.TrComposeTrTr={};n.TrComposeTrTr.kind="Tr";n.TrComposeTrTr.signature=["Tr","Tr"];n.TrComposeTrTr.initialize=function(a){a.isEuclidean=u.csnames[a.args[0]].isEuclidean*
u.csnames[a.args[1]].isEuclidean};n.TrComposeTrTr.updatePosition=function(a){var b=u.csnames[a.args[0]],c=u.csnames[a.args[1]];a.matrix=f.normalizeMax(f.productMM(c.matrix,b.matrix));a.dualMatrix=f.normalizeMax(f.productMM(c.dualMatrix,b.dualMatrix))};n._helper.composeMtMt=function(a,b,c){function d(a,b,c,d){return h(l(a,b),l(c,d))}function e(a,b,c,e,f,g,k,l){return h(d(a,b,c,e),d(f,g,k,l))}function g(a,b,c,e,f,g,h,l){return k(d(a,b,c,e),d(f,g,h,l))}var h=m.add,k=m.sub,l=m.mult,p=c.anti?g:e,q=c.anti?
e:g;p=f.normalizeMax(f.turnIntoCSList([q(b.ar,c.ar,b.cr,c.br,b.ai,c.ai,b.ci,c.bi),p(b.ar,c.ai,b.cr,c.bi,b.ai,c.ar,b.ci,c.br),q(b.br,c.ar,b.dr,c.br,b.bi,c.ai,b.di,c.bi),p(b.br,c.ai,b.dr,c.bi,b.bi,c.ar,b.di,c.br),q(b.ar,c.cr,b.cr,c.dr,b.ai,c.ci,b.ci,c.di),p(b.ar,c.ci,b.cr,c.di,b.ai,c.cr,b.ci,c.dr),q(b.br,c.cr,b.dr,c.dr,b.bi,c.ci,b.di,c.di),p(b.br,c.ci,b.dr,c.di,b.bi,c.cr,b.di,c.dr)])).value;a.moebius={anti:b.anti!==c.anti,ar:p[0],ai:p[1],br:p[2],bi:p[3],cr:p[4],ci:p[5],dr:p[6],di:p[7]};n._helper.moebiusPair(a)};
n._helper.euc2moeb=function(a){var b=a.matrix.value;return{anti:0>a.isEuclidean,ar:b[0].value[0],ai:b[1].value[0],br:b[0].value[2],bi:b[1].value[2],cr:m.zero,ci:m.zero,dr:b[2].value[2],di:m.zero}};n.TrComposeMtMt={};n.TrComposeMtMt.kind="Mt";n.TrComposeMtMt.signature=["Mt","Mt"];n.TrComposeMtMt.updatePosition=function(a){n._helper.composeMtMt(a,u.csnames[a.args[0]].moebius,u.csnames[a.args[1]].moebius)};n.TrComposeTrMt={};n.TrComposeTrMt.kind="Mt";n.TrComposeTrMt.signature=["Tr","Mt"];n.TrComposeTrMt.signatureConstraints=
function(a){return!!u.csnames[a.args[0]].isEuclidean};n.TrComposeTrMt.updatePosition=function(a){n._helper.composeMtMt(a,n._helper.euc2moeb(u.csnames[a.args[0]]),u.csnames[a.args[1]].moebius)};n.TrComposeMtTr={};n.TrComposeMtTr.kind="Mt";n.TrComposeMtTr.signature=["Mt","Tr"];n.TrComposeMtTr.signatureConstraints=function(a){return!!u.csnames[a.args[1]].isEuclidean};n.TrComposeMtTr.updatePosition=function(a){n._helper.composeMtMt(a,u.csnames[a.args[0]].moebius,n._helper.euc2moeb(u.csnames[a.args[1]]))};
n._helper.pointReflection=function(a,b){return f.normalizeMax(f.sub(f.scalmult(m.realmult(2,b.value[2]),a),f.scalmult(a.value[2],b)))};n._helper.conicOtherIntersection=function(a,b,c){var d=f.productMV(a,c);a=f.scalproduct(c,d);d=f.scalproduct(b,d);d=m.realmult(-2,d);b=f.scalmult(a,b);c=f.scalmult(d,c);c=f.add(b,c);return c=f.normalizeMax(c)};n.Dist={};n.Dist.kind="V";n.Dist.signature=["P","P"];n.Dist.updatePosition=function(a){var b=u.csnames[a.args[1]].homog;a.value=f.abs(f.sub(f.normalizeZ(u.csnames[a.args[0]].homog),
f.normalizeZ(b)))};n.Angle={};n.Angle.kind="V";n.Angle.signature=["L","L","P"];n.Angle.initialize=function(a){void 0===a.angle&&(a.angle=.5*Math.PI);qb(m._helper.input(a.angle))};n.Angle.updatePosition=function(a){var b=u.csnames[a.args[1]].homog,c=u.csnames[a.args[2]].homog,e=f.cross(u.csnames[a.args[0]].homog,f.linfty);b=f.cross(b,f.linfty);c=f.crossratio3(e,b,f.ii,f.jj,c);c=m.mult(m.complex(0,.5),m.log(c));e=(bc().value.real-c.value.real)/Math.PI;b=Math.round(e);!fc&&.01<Math.abs(b-e)&&oc();c=
m.complex(b*Math.PI+c.value.real,c.value.imag);qb(c);a.value=v.withUsage(c,"Angle")};n.Angle.stateSize=2;n.Text={};n.Text.kind="Text";n.Text.signature="**";n.Text.isMovable=!0;n.Text.updatePosition=ab;n.Text.initialize=function(a){a.text=String(a.text);a.pos&&(a.homog=n._helper.initializePoint(a));a.dock&&(a.dock.offset=a.dock.offset&&2===a.dock.offset.length?f.realVector([+a.dock.offset[0],+a.dock.offset[1]]):f.realVector([0,0]))};n.Text.getParamForInput=function(a,b,c){return n.Free.getParamForInput(a,
b,c)};n.Text.getParamFromState=function(a){return a.homog};n.Text.putParamToState=function(a,b){a.homog=b};n.Calculation={};n.Calculation.kind="Text";n.Calculation.signature="**";n.Calculation.isMovable=!0;n.Calculation.updatePosition=ab;n.Calculation.initialize=function(a){n.Text.initialize(a);a.calculation=fb(a.text)};n.Calculation.getText=function(a){return ca(x(a.calculation))};n.Calculation.getParamForInput=n.Text.getParamForInput;n.Calculation.getParamFromState=n.Text.getParamFromState;n.Calculation.putParamToState=
n.Text.putParamToState;n.Equation={};n.Equation.kind="Text";n.Equation.isMovable=!0;n.Equation.signature="**";n.Equation.updatePosition=ab;n.Equation.initialize=function(a){n.Text.initialize(a);a.calculation=fb(a.text)};n.Equation.getText=function(a){return a.text+" = "+ca(x(a.calculation))};n.Equation.getParamForInput=n.Text.getParamForInput;n.Equation.getParamFromState=n.Text.getParamFromState;n.Equation.putParamToState=n.Text.putParamToState;n.Evaluate={};n.Evaluate.kind="Text";n.Evaluate.isMovable=
!0;n.Evaluate.signature="**";n.Evaluate.updatePosition=ab;n.Evaluate.initialize=function(a){n.Text.initialize(a);a.calculation=fb(a.text)};n.Evaluate.getText=function(a){x(a.calculation);return a.text};n.Evaluate.getParamForInput=n.Text.getParamForInput;n.Evaluate.getParamFromState=n.Text.getParamFromState;n.Evaluate.putParamToState=n.Text.putParamToState;n.Plot={};n.Plot.kind="Text";n.Plot.isMovable=!0;n.Plot.signature="**";n.Plot.updatePosition=ab;n.Plot.initialize=function(a){n.Text.initialize(a);
a.calculation=fb("plot(("+a.text+"))")};n.Plot.getText=function(a){x(a.calculation);return a.text};n.Plot.getParamForInput=n.Text.getParamForInput;n.Plot.getParamFromState=n.Text.getParamFromState;n.Plot.putParamToState=n.Text.putParamToState;n.Button={};n.Button.kind="Text";n.Button.signature="**";n.Button.isMovable=!0;n.Button.updatePosition=ab;n.Button.initialize=function(a){var b=document.createElement("button");Oc(a,"click",b)};n.Button.getParamForInput=n.Text.getParamForInput;n.Button.getParamFromState=
n.Text.getParamFromState;n.Button.putParamToState=n.Text.putParamToState;n.Button.set_fillcolor=function(a,b){f._helper.isNumberVecN(b,3)&&(a.fillcolor=b.value.map(function(a){return a.value.real}),a.html.style.backgroundColor=w.makeColor(a.fillcolor,a.fillalpha))};n.Button.set_color=function(a,b){f._helper.isNumberVecN(b,3)&&(a.color=b.value.map(function(a){return a.value.real}),a.html.style.color=w.makeColor(a.color,a.alpha))};n.ToggleButton={};n.ToggleButton.kind="Text";n.ToggleButton.signature=
"**";n.ToggleButton.isMovable=!0;n.ToggleButton.updatePosition=ab;n.ToggleButton.initialize=function(a){var b=void 0;void 0===b&&(b="CindyJSid");b+=++J;var c=document.createElement("input"),e=document.createElement("label");c.setAttribute("id",b);e.setAttribute("for",b);c.setAttribute("type","checkbox");a.pressed&&(c.checked=!0);a.checkbox=c;Oc(a,"change",c,e)};n.ToggleButton.get_text=function(a){return v.string(String(a.text))};n.ToggleButton.set_currenttext=function(a,b){a.html.value=a.text=ca(b)};
n.ToggleButton.getParamForInput=n.Text.getParamForInput;n.ToggleButton.getParamFromState=n.Text.getParamFromState;n.ToggleButton.putParamToState=n.Text.putParamToState;n.ToggleButton.set_fillcolor=n.Button.set_fillcolor;n.ToggleButton.set_color=n.Button.set_color;n.ToggleButton.set_text=n.ToggleButton.set_currenttext;n.ToggleButton.get_val=n.ToggleButton.get_text;n.ToggleButton.set_val=n.ToggleButton.set_currenttext;n.EditableText={};n.EditableText.kind="Text";n.EditableText.isMovable=!0;n.EditableText.signature=
[];n.EditableText.updatePosition=ab;n.EditableText.initialize=function(a){var b=document.createElement("input");b.setAttribute("type","text");b.className="CindyJS-editabletext";Wa(a.minwidth)&&(b.style.width=a.minwidth-3+"px");"string"===typeof a.text&&(b.value=a.text);b.addEventListener("keydown",function(c){13===c.keyCode&&(a.text=a.html.value,b.blur())});b.addEventListener("change",function(b){a.text=a.html.value});Oc(a,"change",b)};n.EditableText.getText=function(a){return!1};n.EditableText.getParamForInput=
n.Text.getParamForInput;n.EditableText.getParamFromState=n.Text.getParamFromState;n.EditableText.putParamToState=n.Text.putParamToState;n.EditableText.set_fillcolor=n.Button.set_fillcolor;n.EditableText.set_color=n.Button.set_color;n.EditableText.get_currenttext=function(a){return v.string(String(a.html.value))};n.EditableText.get_text=n.ToggleButton.get_text;n.EditableText.set_currenttext=n.ToggleButton.set_currenttext;n.EditableText.set_text=n.EditableText.set_currenttext;n.EditableText.get_val=
n.EditableText.get_text;n.EditableText.set_val=n.EditableText.set_currenttext;n._helper.initializePoint=function(a){var b=0,c=0,e=0;if(a.pos){if("list"===a.pos.ctype&&f.isNumberVector(a.pos))return a.pos;2===a.pos.length&&(b=a.pos[0],c=a.pos[1],e=1);3===a.pos.length&&(b=a.pos[0],c=a.pos[1],e=a.pos[2])}a=f.turnIntoCSList([m._helper.input(b),m._helper.input(c),m._helper.input(e)]);return a=f.normalizeMax(a)};n._helper.initializeLine=function(a){var b=0,c=0,e=0;if(a.pos){if("list"===a.pos.ctype&&f.isNumberVector(a.pos))return a.pos;
3===a.pos.length&&(b=a.pos[0],c=a.pos[1],e=a.pos[2])}a=f.turnIntoCSList([m._helper.input(b),m._helper.input(c),m._helper.input(e)]);return a=f.normalizeMax(a)};n.Poly={};n.Poly.kind="Poly";n.Poly.signature="P*";n.Poly.updatePosition=function(a){a.vertices=f.turnIntoCSList(a.args.map(function(a){return u.csnames[a].homog}))};var fa=null;n.IFS={};n.IFS.kind="IFS";n.IFS.signature="**";n.IFS.signatureConstraints=function(a){for(var b=0;b<a.args.length;++b){var c=u.csnames[a.args[b]].kind;if("Tr"!==c&&
"Mt"!==c)return!1}return 0<a.args.length};n.IFS.initialize=function(a){if(fa)fa.dirty=!0;else if(a=Da.getBaseDir(),!1!==a){fa={dirty:!1,params:{generation:0}};var b=fa.worker=new Worker(a+"ifs.js");b.onmessage=function(a){fa.img&&"function"===typeof fa.img.close&&fa.img.close();if(!zc){a=a.data;if(a.generation===fa.params.generation){if(a.buffer){fa.canvas||(fa.canvas=document.createElement("canvas"),fa.ctx=fa.canvas.getContext("2d"));fa.canvas.width=a.width;fa.canvas.height=a.height;var c=new Uint8ClampedArray(a.buffer,
a.imgPtr,a.width*a.height*4);c=new ImageData(c,a.width,a.height);fa.ctx.putImageData(c,0,0);fa.img=fa.canvas}else fa.img=a.img;q()}else fa.img=null;a.buffer?b.postMessage({cmd:"next",buffer:a.buffer},[a.buffer]):b.postMessage({cmd:"next"})}};xb.push(b.terminate.bind(b))}};n.IFS.updatePosition=function(a){fa.dirty=!0};n.IFS.updateParameters=function(){if(fa.worker){var a={cmd:"init",generation:fa.params.generation,width:Math.round(4*ia),height:Math.round(4*la)};a.systems=u.ifs.map(function(a){var b=
0,c,d=a.ifs||[],e=a.args.map(function(a,b){a=d[b]||{};return{prob:a.prob||1,color:a.color||[0,0,0]}});for(c=0;c<e.length;++c)b+=e[c].prob;c=f.realMatrix([[1,0,0],[0,1,0],[0,0,4]]);var g=f.productMM(A.toMat(),c);for(c=0;c<a.args.length;++c){var h=u.csnames[a.args[c]],k=h.kind,l=e[c];l.kind=k;l.prob/=b;if("Tr"===k)h=f.normalizeMax(f.productMM(f.adjoint3(g),f.productMM(h.matrix,g))),f._helper.isAlmostReal(h)?l.mat=h.value.map(function(a){return a.value.map(function(a){return a.value.real})}):l.kind=
"cplx";else if("Mt"===k){k=A.drawingstate.matrix;k={anti:0<k.det,ar:m.real(k.a),ai:m.real(k.c),br:m.real(k.tx),bi:m.real(-k.ty),cr:m.zero,ci:m.zero,dr:m.real(.25),di:m.zero};var p={};n._helper.composeMtMt(p,h.moebius,k);k=n._helper.inverseMoebius(k);n._helper.composeMtMt(p,k,p.moebius);k=p.moebius;k=f.turnIntoCSList([k.ar,k.ai,k.br,k.bi,k.cr,k.ci,k.dr,k.di]);f._helper.isAlmostReal(k)?(k=k.value,l.moebius={ar:k[0].value.real,ai:k[1].value.real,br:k[2].value.real,bi:k[3].value.real,cr:k[4].value.real,
ci:k[5].value.real,dr:k[6].value.real,di:k[7].value.real,sign:h.moebius.anti?-1:1}):l.kind="cplx"}}return{trafos:e}});v.deeplyEqual(a,fa.params)||(++a.generation,fa.img=null,fa.params=a,fa.mat=A.drawingstate.matrix,fa.worker.postMessage(a))}};n.IFS.probSetter=function(a,b,c){"number"===c.ctype&&(b.ifs[a].prob=c.value.real,fa.dirty=!0)};(function(){for(var a=0;10>a;++a)n.IFS["set_prob"+a]=n.IFS.probSetter.bind(null,a)})();n._helper.snapPointToLine=function(a,b){if(m._helper.isAlmostZero(a.value[2]))return a;
var c=n._helper.projectPointToLine(a,b);c=f.normalizeZ(c);var d=c.value[0].value.real;c=c.value[1].value.real;var e=Math.round(d/Sa)*Sa,g=Math.round(c/Sa)*Sa,h=f.realVector([e,g,1]);Math.abs(e-d)<Nb&&Math.abs(g-c)<Nb&&m._helper.isAlmostZero(f.scalproduct(b,h))&&(a=n._helper.projectPointToLine(h,b));return a};var Yc={CircleByRadius:"CircleMr",IntersectionCircleCircle:"IntersectCirCir",IntersectionConicConic:"IntersectConicConic",FreePoint:"Free",Orthogonal:"Perp",Parallel:"Para",Pole:"PolarOfLine",
Polar:"PolarOfPoint",Arc:"ArcBy3",EuclideanMid:"Mid",AngularBisector:"AngleBisector",TransformConic:"TransformC",TransformSegment:"TransformS",TrMoebiusSegment:"TrMoebiusS",ReflectCC:"TrMoebiusC",ReflectCL:"TrMoebiusL",ReflectCP:"TrMoebiusP",ReflectCArc:"TrMoebiusArc",ReflectCS:"TrMoebiusS",TrMoebiusCircle:"TrMoebiusC"},Be={CircleMFixedr:function(a){a.pinned=!0;a.type="CircleMr";return[a]},CircleByFixedRadius:function(a){a.pinned=!0;a.type="CircleMr";return[a]},IntersectionConicLine:function(a){a.args=
[a.args[1],a.args[0]];a.type="IntersectLC";return[a]},angleBisector:function(a){var b={name:a.name+"_Intersection",type:"Meet",args:a.args,visible:!1};a.type="AngleBisector";a.args=[a.args[0],a.args[1],b.name];return[b,a]},Transform:function(a){var b=u.csnames[a.args[1]];b={Tr:"Transform",Mt:"TrMoebius"}[u.csnames[a.args[0]].kind]+(b.isArc?"Arc":b.kind);if(n.hasOwnProperty(b))return a.type=b,[a];console.log(b+" not implemented yet");return[]},TrReflection:function(a){var b="TrReflection"+u.csnames[a.args[0]].kind;
if(n.hasOwnProperty(b))return a.type=b,[a];console.log(b+" not implemented yet");return[]},TrCompose:function(a){var b="TrCompose"+a.args.map(function(a){return u.csnames[a].kind}).join("");if(n.hasOwnProperty(b))return a.type=b,[a];console.log(b+" not implemented yet");return[]}},We="align alpha angle args arrow arrowposition arrowshape arrowsides arrowsize clip color dashtype drawtrace fillalpha fillcolor filled labeled labelpos name overhang pinned printname radius size text text_fontfamily textbold textitalics textsize tracedim tracelength traceskip tracing type visible".split(" ");
Ha.saveState=function(){return{geometry:pe()}};var Za={};var Xe=[[],[.2],[.075,.225],[44/45,-56/15,32/9],[19372/6561,-25360/2187,64448/6561,-212/729],[9017/3168,-355/33,46732/5247,49/176,-5103/18656],[35/384,0,500/1113,125/192,-2187/6784,11/84]];var ge=[0,.2,.3,.8,8/9,1,1];var Ye=[35/384,0,500/1113,125/192,-2187/6784,11/84,0];var Ze=[5179/57600,0,7571/16695,.6140625,-92097/339200,187/2100,.025];var lb,xa=[],Ee=[],ze=!1;Za.tick=function(a){a/=tc;for(var b=0;b<tc;b++)Za.tick1(a),sc+=a,x(S.simulationstep)};
Za.tick1=function(a){for(var b=a,c=0;0<a&&c<.999*a||0>a&&c>.999*a;)b=Za.oneRKStep(b),c+=b,b=Math.min(2*b,a-c),b=Math.max(b,1E-16),Za.restorePosition(),Za.doCollisions(),Za.calculateForces(),Za.moveToFinalPos();return!0};Za.restorePosition=function(){lb.forEach(function(a){T[a.type].restorePos(a,9)})};Za.doCollisions=function(){lb.forEach(function(a){T[a.type].doCollisions(a)})};Za.calculateForces=function(){lb.forEach(function(a){T[a.type].calculateForces(a)})};Za.moveToFinalPos=function(){lb.forEach(function(a){T[a.type].move(a)})};
Za.oneRKStep=function(a){for(var b=function(a){lb.forEach(function(b){T[b.type].initRK(b,a);T[b.type].storePosition(b)})},c=function(a){lb.forEach(function(b){T[b.type].setToTimestep(b,ge[a])})},e=function(a){lb.forEach(function(b){T[b.type].proceedMotion(b,ge[a],a,Xe[a])})},f=function(){lb.forEach(function(a){T[a.type].resetForces(a)})},g=function(a){lb.forEach(function(b){T[b.type].calculateDelta(b,a)})},h=function(b){var c=0;lb.forEach(function(a){T[a.type].proceedMotion(a,ge[6],7,Ye);T[a.type].savePos(a,
8);T[a.type].proceedMotion(a,ge[6],7,Ze);T[a.type].savePos(a,9);c+=T[a.type].sqDist(a,8,9)});return c=Math.sqrt(c)/a},k=function(a){lb.forEach(function(a){T[a.type].recallPosition(a)})},l=!1;!l;){b(a);for(var m=0;7>m;m++)c(m),e(m),f(),Za.calculateForces(),g(m);h(a)>T.env.errorbound&&a>T.env.lowestdeltat?(a/=T.env.slowdownfactor,k()):l=!0}return a};var T={Mass:{reset:function(a,b){a.vel=[0,0,0];a.pos=[0,0,0,0];a.el=b;"undefined"===typeof a.mass&&(a.mass=1);"undefined"===typeof a.charge&&(a.charge=
0);"undefined"===typeof a.friction&&(a.friction=0);a.lnfrict=0;"undefined"===typeof a.limitspeed&&(a.limitspeed=!1);"undefined"===typeof a.fixed&&(a.fixed=!1);"undefined"===typeof a.radius&&(a.radius=1);a.internalmove=!1;a.fx=0;a.fy=0;a.fz=0;a.vx=a.vx||0;a.vy=a.vy||0;a.vz=a.vz||0;a.mtype=0;a.env=T.env;a.deltat=0;a.mx=0;a.my=0;a.mz=0;a.mvx=0;a.mvy=0;a.mvz=0;a.dx=[0,0,0,0,0,0,0,0,0,0];a.dy=[0,0,0,0,0,0,0,0,0,0];a.dz=[0,0,0,0,0,0,0,0,0,0];a.dvx=[0,0,0,0,0,0,0,0,0,0];a.dvy=[0,0,0,0,0,0,0,0,0,0];a.dvz=
[0,0,0,0,0,0,0,0,0,0];a.midx=0;a.midy=0;a.midz=0;a.lx=0;a.ly=0;a.lz=0},resetForces:function(a){a.fx=0;a.fy=0;a.fz=0},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){var c=E.extractPoint(a.el.homog);a.x=c.x;a.y=c.y;a.z=0;a.xo=a.x;a.yo=a.y;a.zo=a.z;a.vxo=a.vx;a.vyo=a.vy;a.vzo=a.vz;a.deltat=b;a.fx=0;a.fy=0;a.fz=0},setVelocity:function(a,b,c,e){e||(e=0);a.vx=b;a.vy=c;a.vz=e},move:function(a){a.pos=[a.x,a.y,1];a.internalmove=!0;ua&&ea.down&&a.el===ua.mover||Ra(a.el,f.realVector(a.pos),
"homog");a.el.sx=a.x;a.el.sy=a.y;a.internalmove=!1},proceedMotion:function(a,b,c,e){if(!a.fixed)for(a.x=a.mx,a.y=a.my,a.z=a.mz,a.vx=a.mvx,a.vy=a.mvy,a.vz=a.mvz,b=0;b<c;b++)a.x+=e[b]*a.dx[b]*a.deltat,a.y+=e[b]*a.dy[b]*a.deltat,a.z+=e[b]*a.dz[b]*a.deltat,a.vx+=e[b]*a.dvx[b]*a.deltat,a.vy+=e[b]*a.dvy[b]*a.deltat,a.vz+=e[b]*a.dvz[b]*a.deltat},calculateForces:function(a){var b=Math.sqrt(a.vx*a.vx+a.vy*a.vy+a.vz*a.vz);a.lnfrict=-Math.log((1-a.friction)*(1-a.env.friction)*(.1<b&&a.limitSpeed?.1/b:1));a.fx+=
-a.vx*a.lnfrict*a.mass;a.fy+=-a.vy*a.lnfrict*a.mass;a.fz+=-a.vz*a.lnfrict*a.mass},calculateDelta:function(a,b){a.dx[b]=a.vx;a.dy[b]=a.vy;a.dz[b]=a.vz;a.dvx[b]=a.fx/a.mass;a.dvy[b]=a.fy/a.mass;a.dvz[b]=a.fz/a.mass},savePos:function(a,b){a.dx[b]=a.x;a.dy[b]=a.y;a.dz[b]=a.z;a.dvx[b]=a.vx;a.dvy[b]=a.vy;a.dvz[b]=a.vz},restorePos:function(a,b){a.fixed||(a.x=a.dx[b],a.y=a.dy[b],a.z=a.dz[b],a.vx=a.dvx[b],a.vy=a.dvy[b],a.vz=a.dvz[b])},sqDist:function(a,b,c){var d=(a.dx[b]-a.dx[c])*(a.dx[b]-a.dx[c]);d+=(a.dy[b]-
a.dy[c])*(a.dy[b]-a.dy[c]);d+=(a.dz[b]-a.dz[c])*(a.dz[b]-a.dz[c]);d+=(a.dvx[b]-a.dvx[c])*(a.dvx[b]-a.dvx[c]);d+=(a.dvy[b]-a.dvy[c])*(a.dvy[b]-a.dvy[c]);return d+=(a.dvz[b]-a.dvz[c])*(a.dvz[b]-a.dvz[c])},kineticEnergy:function(a){return.5*a.mass*(a.vx*a.vx+a.vy*a.vy+a.vz*a.vz)},storePosition:function(a){a.mx=a.x;a.my=a.y;a.mz=a.z;a.mvx=a.vx;a.mvy=a.vy;a.mvz=a.vz},recallPosition:function(a){a.fixed||(a.x=a.mx,a.y=a.my,a.z=a.mz,a.vx=a.mvx,a.vy=a.mvy,a.vz=a.mvz)},doCollisions:function(a){}},Sun:{reset:function(a,
b){a.vel=[0,0,0];a.pos=[0,0,0,0];a.el=b;"undefined"===typeof a.mass&&(a.mass=10);"undefined"===typeof a.friction&&(a.friction=0);a.charge=0;a.x=0;a.y=0;a.z=0},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){b=E.extractPoint(a.el.homog);a.x=b.x;a.y=b.y;a.z=0},setVelocity:function(a,b,c,e){},move:function(a){},proceedMotion:function(a,b,c,e){},calculateDelta:function(a,b){},calculateForces:function(a){for(var b=a.x,c=a.y,e=a.z,f=0;f<xa.length;f++){var g=xa[f],
h=g.behavior.x,k=g.behavior.y,l=g.behavior.z,m=Math.sqrt((b-h)*(b-h)+(c-k)*(c-k)+(e-l)*(e-l));k=(c-k)*a.mass*g.behavior.mass/(m*m*m);l=(e-l)*a.mass*g.behavior.mass/(m*m*m);g.behavior.fx+=(b-h)*a.mass*g.behavior.mass/(m*m*m)*g.behavior.mass;g.behavior.fy+=k*g.behavior.mass;g.behavior.fz+=l*g.behavior.mass}},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},
Velocity:{reset:function(a){var b=u.csnames[a.geo[1]];console.log(b);var c=E.extractPoint(b.homog);a=E.extractPoint(u.csnames[a.geo[2]].homog);b=b.behavior;T[b.type].setVelocity(b,a.x-c.x,a.y-c.y,0)},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,e){},move:function(a){var b=u.csnames[a.geo[2]];if(!ua||!ea.down||b!==ua.mover){var c=u.csnames[a.geo[1]];a=E.extractPoint(c.homog);c=c.behavior;a=f.realVector([a.x+c.vx,a.y+c.vy,1]);
Ra(b,a,"homog")}},proceedMotion:function(a,b,c,e){},calculateForces:function(a){},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},Gravity:{reset:function(a,b){a.vel=[0,0,0];a.pos=[0,0,0,0];a.el=b;"undefined"===typeof a.strength&&(a.strength=1);a.namea=b.args[0];a.nameb=b.args[1];a.ma=u.csnames[a.namea];a.mb=u.csnames[a.nameb]},
resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,e){},move:function(a){},proceedMotion:function(a,b,c,e){},calculateDelta:function(a,b){},calculateForces:function(a){var b=E.extractPoint(a.ma.homog),c=E.extractPoint(a.mb.homog),e=(c.x-b.x)*a.strength;a=(c.y-b.y)*a.strength;for(b=0;b<xa.length;b++)c=xa[b],c.behavior.fx+=e*c.behavior.mass,c.behavior.fy+=a*c.behavior.mass,c.behavior.fz+=0*c.behavior.mass},savePos:function(a,b){},
restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},Spring:{reset:function(a,b){a.el=b;"undefined"===typeof a.strength&&(a.strength=1);"undefined"===typeof a.amplitude&&(a.amplitude=0);"undefined"===typeof a.phase&&(a.phase=0);"undefined"===typeof a.speed&&(a.speed=1);"undefined"===typeof a.l0&&(a.l0=0);"undefined"===typeof a.stype&&(a.stype=1);"undefined"===typeof a.readOnInit&&
(a.readOnInit=!1);a.namea=b.args[0];a.nameb=b.args[1];a.ma=u.csnames[a.namea];a.mb=u.csnames[a.nameb];b=E.extractPoint(a.ma.homog);var c=E.extractPoint(a.mb.homog);a.l0=Math.sqrt((b.x-c.x)*(b.x-c.x)+(b.y-c.y)*(b.y-c.y));a.env=T.env;a.ldiff=0},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,e){},move:function(a){},proceedMotion:function(a,b,c,e){},calculateForces:function(a){if(!a.ma.behavior||ua&&ea.down&&a.ma===ua.mover){var b=
E.extractPoint(a.ma.homog);var c=b.x;var e=b.y}else c=a.ma.behavior.x,e=a.ma.behavior.y;if(!a.mb.behavior||ua&&ea.down&&a.mb===ua.mover){var f=E.extractPoint(a.mb.homog);b=f.x;f=f.y}else b=a.mb.behavior.x,f=a.mb.behavior.y;var g=Math.sqrt((c-b)*(c-b)+(e-f)*(e-f)),h=a.l0;a.ldiff=g-h;var k=a.stype;1===k&&(h=0);var l=0;if(2===k||3===k)l=a.ma.behavior.mass*a.mb.behavior.mass*a.strength;2===k&&(l=-l);if(0===g||0!==k&&1!==k)if(a.ma.behavior&&a.mb.behavior&&0!==g){if(g*=g*g,2===k||3===k){var m=(c-b)*l/g;
var n=(e-f)*l/g}}else m=n=0;else m=-(c-b)*a.strength*(g-h)/g*a.env.springstrength,n=-(e-f)*a.strength*(g-h)/g*a.env.springstrength;a.ma.behavior&&(a.ma.behavior.fx+=m,a.ma.behavior.fy+=n);a.mb.behavior&&(a.mb.behavior.fx-=m,a.mb.behavior.fy-=n)},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},det:function(a,b,c,e,f,g){return c*
g-f*e+f*b-a*g+a*e-c*b},Bouncer:{reset:function(a,b){a.el=b;"undefined"===typeof a.xdamp&&(a.xdamp=0);"undefined"===typeof a.ydamp&&(a.ydamp=0);"undefined"===typeof a.motorchanger&&(a.motorchanger=!0);a.namea=b.args[0];a.nameb=b.args[1];a.ma=u.csnames[a.namea];a.mb=u.csnames[a.nameb];b=E.extractPoint(a.ma.homog);var c=E.extractPoint(a.mb.homog);a.x1o=1.01*b.x-.01*c.x;a.y1o=1.01*b.y-.01*c.y;a.x2o=1.01*c.x-.01*b.x;a.y2o=1.01*c.y-.01*b.y;a.env=T.env},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,
b,c){},initRK:function(a,b){a.deltat=b},setVelocity:function(a,b,c,e){},move:function(a){},proceedMotion:function(a,b,c,e){},calculateForces:function(a){},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){var b=E.extractPoint(a.ma.homog),c=E.extractPoint(a.mb.homog),e=b.x;b=b.y;var f=c.x;c=c.y;var g=a.x1o,h=a.y1o,k=a.x2o,l=a.y2o,
n=Math.sqrt((e-f)*(e-f)+(b-c)*(b-c)),p=(e-f)/n;n=(b-c)/n;for(var q=0;q<xa.length;q++){var r=xa[q],t=r.behavior.xo,u=r.behavior.yo,v=r.behavior.x,w=r.behavior.y,x=m.mult(m.complex(g,h),m.complex(f,c)),y=m.mult(m.complex(k,l),m.complex(e,b));x=m.sub(x,y);y=m.mult(m.complex(t,u),m.complex(e,b));x=m.add(x,y);y=m.mult(m.complex(t,u),m.complex(f,c));x=m.sub(x,y);y=m.sub(m.complex(g,h),m.complex(k,l));x=m.div(x,y);0>T.det(e,b,f,c,v,w)*T.det(e,b,f,c,x.value.real,x.value.imag)&&0>T.det(e,b,v,w,x.value.real,
x.value.imag)*T.det(f,c,v,w,x.value.real,x.value.imag)&&(u=r.behavior.mvx+a.deltat*(-x.value.real+r.behavior.xo),v=r.behavior.mvy+a.deltat*(-x.value.imag+r.behavior.yo),t=p*u+n*v,u=n*u-p*v,r.behavior.x=x.value.real,r.behavior.y=x.value.imag,r.behavior.vx=p*t*(1-a.xdamp),r.behavior.vy=n*t*(1-a.xdamp),r.behavior.vx+=-n*u*(1-a.ydamp),r.behavior.vy+=p*u*(1-a.ydamp))}a.x1o=e;a.y1o=b;a.x2o=f;a.y2o=c}},Environment:{init:function(a){"undefined"===typeof a.gravity&&(a.gravity=0);"undefined"===typeof a.friction&&
(a.friction=0);"undefined"===typeof a.springstrength&&(a.springstrength=1);"undefined"!==typeof a.accuracy&&(tc=a.accuracy);"undefined"!==typeof a.deltat&&I(a.deltat/.6);"undefined"===typeof a.charges&&(a.charges=!1);"undefined"===typeof a.balls&&(a.balls=!1);"undefined"===typeof a.newton&&(a.newton=!1);"undefined"===typeof a.ballInteractionBoosting&&(a.ballInteractionBoosting=1);T.env=a;a.errorbound=.001;a.lowestdeltat=1E-7;a.slowdownfactor=2},reset:function(a){},resetForces:function(a){},getBlock:!1,
setToTimestep:function(a,b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,e){},move:function(a){},proceedMotion:function(a,b,c,e){},calculateForces:function(a){var b,c;if(a.newton)for(b=0;b<xa.length-1;b++){var e=xa[b];var f=e.behavior.x;var g=e.behavior.y;for(c=b+1;c<xa.length;c++){var h=xa[c];var k=h.behavior.x;var l=h.behavior.y;var m=Math.sqrt((f-k)*(f-k)+(g-l)*(g-l));k=(f-k)*e.behavior.mass*h.behavior.mass/(m*m*m);l=(g-l)*e.behavior.mass*h.behavior.mass/(m*m*m);e.behavior.fx-=k;e.behavior.fy-=
l;h.behavior.fx+=k;h.behavior.fy+=l}}if(a.charges)for(b=0;b<xa.length-1;b++)for(e=xa[b],f=e.behavior.x,g=e.behavior.y,c=b+1;c<xa.length;c++)h=xa[c],k=h.behavior.x,l=h.behavior.y,m=Math.sqrt((f-k)*(f-k)+(g-l)*(g-l)),k=(f-k)*e.behavior.charge*h.behavior.charge/(m*m*m),l=(g-l)*e.behavior.charge*h.behavior.charge/(m*m*m),e.behavior.fx+=k,e.behavior.fy+=l,h.behavior.fx-=k,h.behavior.fy-=l;if(a.balls)for(b=0;b<xa.length-1;b++)if(e=xa[b],0!==e.behavior.radius)for(f=e.behavior.x,g=e.behavior.y,c=b+1;c<xa.length;c++)if(h=
xa[c],0!==h.behavior.radius){k=h.behavior.x;l=h.behavior.y;var n=e.behavior.radius+h.behavior.radius;m=Math.sqrt((f-k)*(f-k)+(g-l)*(g-l));0===a.ballInteractionBoosting?(k=(f-k)/(m*m*m)*(m>n?0:(m-n)*(m-n)),l=(g-l)/(m*m*m)*(m>n?0:(m-n)*(m-n))):1===a.ballInteractionBoosting?(k=(f-k)/(m*m*m*m)*(m>n?0:(m-n)*(m-n)),l=(g-l)/(m*m*m*m)*(m>n?0:(m-n)*(m-n))):(k=(f-k)/(m*m*m*m*m)*(m>n?0:(m-n)*(m-n)),l=(g-l)/(m*m*m*m*m)*(m>n?0:(m-n)*(m-n)));e.behavior.fx+=k;e.behavior.fy+=l;h.behavior.fx-=k;h.behavior.fy-=l}for(b=
0;b<xa.length;b++)e=xa[b],e.behavior.fx+=0,e.behavior.fy+=-a.gravity*e.behavior.mass,e.behavior.fz+=0},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}}};return Ha};return l}(),createCindy=CindyJS;
"undefined"!==typeof process&&"undefined"!==typeof module&&"undefined"!==typeof module.exports&&"undefined"===typeof window&&(module.exports=CindyJS);
//# sourceMappingURL=Cindy.js.map

