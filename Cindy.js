/* CindyJS - (C) 2014-2016  The CindyJS Project
 * Mostly licensed under the Apache License 2.0, but subprojects may use different licensing.
 * See https://github.com/CindyJS/CindyJS/tree/bf6f5184f00d4f7ff7eacfe58d6d3fbbc8815d06
 * for corresponding sources and their respective licensing conditions.
 */
/*
 npm.im/iphone-inline-video 2.2.2  npm.im/intervalometer  https://github.com/paulmillr/es6-shim
 @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
   and contributors,  MIT License
 es6-shim: v0.35.4
 see https://github.com/paulmillr/es6-shim/blob/0.35.3/LICENSE
 Details and documentation:
 https://github.com/paulmillr/es6-shim/
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(R){var Y=0;return function(){return Y<R.length?{done:!1,value:R[Y++]}:{done:!0}}};$jscomp.arrayIterator=function(R){return{next:$jscomp.arrayIteratorImpl(R)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(R,Y,va){if(R==Array.prototype||R==Object.prototype)return R;R[Y]=va.value;return R};$jscomp.getGlobal=function(R){R=["object"==typeof globalThis&&globalThis,R,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var Y=0;Y<R.length;++Y){var va=R[Y];if(va&&va.Math==Math)return va}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(R,Y){var va=$jscomp.propertyToPolyfillSymbol[Y];if(null==va)return R[Y];va=R[va];return void 0!==va?va:R[Y]};
$jscomp.polyfill=function(R,Y,va,Da){Y&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(R,Y,va,Da):$jscomp.polyfillUnisolated(R,Y,va,Da))};$jscomp.polyfillUnisolated=function(R,Y,va,Da){va=$jscomp.global;R=R.split(".");for(Da=0;Da<R.length-1;Da++){var ya=R[Da];if(!(ya in va))return;va=va[ya]}R=R[R.length-1];Da=va[R];Y=Y(Da);Y!=Da&&null!=Y&&$jscomp.defineProperty(va,R,{configurable:!0,writable:!0,value:Y})};
$jscomp.polyfillIsolated=function(R,Y,va,Da){var ya=R.split(".");R=1===ya.length;Da=ya[0];Da=!R&&Da in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var Ua=0;Ua<ya.length-1;Ua++){var Cb=ya[Ua];if(!(Cb in Da))return;Da=Da[Cb]}ya=ya[ya.length-1];va=$jscomp.IS_SYMBOL_NATIVE&&"es6"===va?Da[ya]:null;Y=Y(va);null!=Y&&(R?$jscomp.defineProperty($jscomp.polyfills,ya,{configurable:!0,writable:!0,value:Y}):Y!==va&&(void 0===$jscomp.propertyToPolyfillSymbol[ya]&&(va=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[ya]=
$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(ya):$jscomp.POLYFILL_PREFIX+va+"$"+ya),$jscomp.defineProperty(Da,$jscomp.propertyToPolyfillSymbol[ya],{configurable:!0,writable:!0,value:Y})))};$jscomp.initSymbol=function(){};$jscomp.iteratorPrototype=function(R){R={next:R};R[Symbol.iterator]=function(){return this};return R};
$jscomp.iteratorFromArray=function(R,Y){R instanceof String&&(R+="");var va=0,Da=!1,ya={next:function(){if(!Da&&va<R.length){var Ua=va++;return{value:Y(Ua,R[Ua]),done:!1}}Da=!0;return{done:!0,value:void 0}}};ya[Symbol.iterator]=function(){return ya};return ya};$jscomp.polyfill("Array.prototype.values",function(R){return R?R:function(){return $jscomp.iteratorFromArray(this,function(Y,va){return va})}},"es8","es3");$jscomp.owns=function(R,Y){return Object.prototype.hasOwnProperty.call(R,Y)};
$jscomp.polyfill("Object.values",function(R){return R?R:function(Y){var va=[],Da;for(Da in Y)$jscomp.owns(Y,Da)&&va.push(Y[Da]);return va}},"es8","es3");$jscomp.polyfill("Object.entries",function(R){return R?R:function(Y){var va=[],Da;for(Da in Y)$jscomp.owns(Y,Da)&&va.push([Da,Y[Da]]);return va}},"es8","es3");
var enableInlineVideo=function(){function R(S,ua,Ea,Db){function Mb(Eb){Qb=ua(Mb,Db);S(Eb-(Jb||Eb));Jb=Eb}var Qb,Jb;return{start:function(){Qb||Mb(0)},stop:function(){Ea(Qb);Qb=null;Jb=0}}}function Y(S,ua,Ea){function Db(Mb){Ea&&!Ea(S,ua)||Mb.stopImmediatePropagation()}return S.addEventListener(ua,Db),Db}function va(S,ua,Ea,Db){function Mb(Qb){Ea[ua]=Qb}Db&&Mb(S[ua]);Object.defineProperty(S,ua,{get:function(){return Ea[ua]},set:Mb})}function Da(S,ua,Ea){Ea.addEventListener(ua,function(){return S.dispatchEvent(new Event(ua))})}
function ya(S,ua){Promise.resolve().then(function(){S.dispatchEvent(new Event(ua))})}function Ua(S){var ua=new Audio;return Da(S,"play",ua),Da(S,"playing",ua),Da(S,"pause",ua),ua.crossOrigin=S.crossOrigin,ua.src=S.src||S.currentSrc||"data:",ua}function Cb(S,ua,Ea){(ob||0)+200<Date.now()&&(S[pb]=!0,ob=Date.now());Ea||(S.currentTime=ua);gb[++kb%3]=100*ua|0}function B(S){this.video.readyState>=this.video.HAVE_FUTURE_DATA?(this.hasAudio||(this.driver.currentTime=this.video.currentTime+S*this.video.playbackRate/
1E3,this.video.loop&&this.driver.currentTime>=this.video.duration&&(this.driver.currentTime=0)),Cb(this.video,this.driver.currentTime)):this.video.networkState===this.video.NETWORK_IDLE&&0===this.video.buffered.length&&this.video.load();this.video.ended&&(delete this.video[pb],this.video.pause(!0))}function cb(){var S=this[ib];if(this.webkitDisplayingFullscreen)return void this[r]();"data:"!==S.driver.src&&S.driver.src!==this.src&&(Cb(this,0,!0),S.driver.src=this.src);this.paused&&(S.paused=!1,0===
this.buffered.length&&this.load(),S.driver.play(),S.updater.start(),S.hasAudio||(ya(this,"play"),S.video.readyState>=S.video.HAVE_ENOUGH_DATA&&ya(this,"playing")))}function aa(S){var ua=this[ib];ua.driver.pause();ua.updater.stop();this.webkitDisplayingFullscreen&&this[Ya]();ua.paused&&!S||(ua.paused=!0,ua.hasAudio||ya(this,"pause"),this.ended&&!this.webkitDisplayingFullscreen&&(this[pb]=!0,ya(this,"ended")))}function Ga(S,ua){var Ea={};S[ib]=Ea;Ea.paused=!0;Ea.hasAudio=ua;Ea.video=S;Ea.updater=R(B.bind(Ea),
requestAnimationFrame,cancelAnimationFrame);ua?Ea.driver=Ua(S):(S.addEventListener("canplay",function(){S.paused||ya(S,"playing")}),Ea.driver={src:S.src||S.currentSrc||"data:",muted:!0,paused:!0,pause:function(){Ea.driver.paused=!0},play:function(){Ea.driver.paused=!1;Ea.driver.currentTime>=Ea.video.duration&&Cb(S,0)},get ended(){return Ea.driver.currentTime>=Ea.video.duration}});S.addEventListener("emptied",function(){var Db=!Ea.driver.src||"data:"===Ea.driver.src;Ea.driver.src&&Ea.driver.src!==
S.src&&(Cb(S,0,!0),Ea.driver.src=S.src,Db||!ua&&S.autoplay?Ea.driver.play():Ea.updater.stop())},!1);S.addEventListener("webkitbeginfullscreen",function(){S.paused?ua&&0===Ea.driver.buffered.length&&Ea.driver.load():(S.pause(),S[r]())});ua&&(S.addEventListener("webkitendfullscreen",function(){Ea.driver.currentTime=S.currentTime}),S.addEventListener("seeking",function(){0>gb.indexOf(100*S.currentTime|0)&&(Ea.driver.currentTime=S.currentTime)}))}function Va(S){var ua=S[pb];return delete S[pb],!S.webkitDisplayingFullscreen&&
!ua}function lb(S){var ua=S[ib];S[r]=S.play;S[Ya]=S.pause;S.play=cb;S.pause=aa;va(S,"paused",ua.driver);va(S,"muted",ua.driver,!0);va(S,"playbackRate",ua.driver,!0);va(S,"ended",ua.driver);va(S,"loop",ua.driver,!0);Y(S,"seeking",function(Ea){return!Ea.webkitDisplayingFullscreen});Y(S,"seeked",function(Ea){return!Ea.webkitDisplayingFullscreen});Y(S,"timeupdate",Va);Y(S,"ended",Va)}var ob,za="object"==typeof document&&"object-fit"in document.head.style&&!matchMedia("(-webkit-video-playable-inline)").matches,
ib="bfred-it:iphone-inline-video",pb="bfred-it:iphone-inline-video:event",r="bfred-it:iphone-inline-video:nativeplay",Ya="bfred-it:iphone-inline-video:nativepause",gb=[],kb=0;return function(S,ua){if(void 0===ua&&(ua={}),!S[ib])if(ua.everywhere||za&&(ua.iPad||ua.ipad?/iPhone|iPod|iPad/:/iPhone|iPod/).test(navigator.userAgent))S.pause(),ua=S.autoplay,S.autoplay=!1,Ga(S,!S.muted),lb(S),S.classList.add("IIV"),S.muted&&ua&&(S.play(),S.addEventListener("playing",function Db(){S.autoplay=!0;S.removeEventListener("playing",
Db)})),/iPhone|iPod|iPad/.test(navigator.platform)||console.warn("iphone-inline-video is not guaranteed to work in emulated environments")}}();
(function(){function R(e,g,l){r.biginteger_used=1;null!=e&&("number"==typeof e&&"undefined"==typeof g?this.fromInt(e):"number"==typeof e?this.fromNumber(e,g,l):null==g&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,g))}function Y(){return new R(null,void 0,void 0)}function va(e,g,l,q,z,D){for(;0<=--D;){var I=g*this[e++]+l[q]+z;z=Math.floor(I/67108864);l[q++]=I&67108863}return z}function Da(e,g,l,q,z,D){var I=g&32767;for(g>>=15;0<=--D;){var W=this[e]&32767,da=this[e++]>>15,ha=g*W+da*
I;W=I*W+((ha&32767)<<15)+l[q]+(z&1073741823);z=(W>>>30)+(ha>>>15)+g*da+(z>>>30);l[q++]=W&1073741823}return z}function ya(e,g,l,q,z,D){var I=g&16383;for(g>>=14;0<=--D;){var W=this[e]&16383,da=this[e++]>>14,ha=g*W+da*I;W=I*W+((ha&16383)<<14)+l[q]+z;z=(W>>28)+(ha>>14)+g*da;l[q++]=W&268435455}return z}function Ua(e,g){e=Jb[e.charCodeAt(g)];return null==e?-1:e}function Cb(e){var g=Y();g.fromInt(e);return g}function B(e){var g=1,l;0!=(l=e>>>16)&&(e=l,g+=16);0!=(l=e>>8)&&(e=l,g+=8);0!=(l=e>>4)&&(e=l,g+=
4);0!=(l=e>>2)&&(e=l,g+=2);0!=e>>1&&(g+=1);return g}function cb(e){this.m=e}function aa(e){this.m=e;this.mp=e.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<e.DB-15)-1;this.mt2=2*e.t}function Ga(e,g){return e&g}function Va(e,g){return e|g}function lb(e,g){return e^g}function ob(e,g){return e&~g}function za(){}function ib(e){return e}function pb(e){this.r2=Y();this.q3=Y();R.ONE.dlShiftTo(2*e.t,this.r2);this.mu=this.r2.divide(e);this.m=e}var r={use_lines:!0,use_xyz:!1},Ya=!1;"undefined"!==
typeof module&&module.exports?(module.exports=r,Ya=!0):"undefined"!==typeof document?window.ClipperLib=r:self.ClipperLib=r;if(Ya){kb="chrome";var gb="Netscape"}else{var kb=navigator.userAgent.toString().toLowerCase();gb=navigator.appName}var S=-1!=kb.indexOf("chrome")&&-1==kb.indexOf("chromium")?1:0;Ya=-1!=kb.indexOf("chromium")?1:0;var ua=-1!=kb.indexOf("safari")&&-1==kb.indexOf("chrome")&&-1==kb.indexOf("chromium")?1:0;var Ea=-1!=kb.indexOf("firefox")?1:0;kb.indexOf("firefox/17");kb.indexOf("firefox/15");
kb.indexOf("firefox/3");var Db=-1!=kb.indexOf("opera")?1:0;kb.indexOf("msie 10");kb.indexOf("msie 9");var Mb=-1!=kb.indexOf("msie 8")?1:0;var Qb=-1!=kb.indexOf("msie 7")?1:0;kb=-1!=kb.indexOf("msie ")?1:0;r.biginteger_used=null;"Microsoft Internet Explorer"==gb?(R.prototype.am=Da,gb=30):"Netscape"!=gb?(R.prototype.am=va,gb=26):(R.prototype.am=ya,gb=28);R.prototype.DB=gb;R.prototype.DM=(1<<gb)-1;R.prototype.DV=1<<gb;R.prototype.FV=Math.pow(2,52);R.prototype.F1=52-gb;R.prototype.F2=2*gb-52;var Jb=[],
Eb;gb=48;for(Eb=0;9>=Eb;++Eb)Jb[gb++]=Eb;gb=97;for(Eb=10;36>Eb;++Eb)Jb[gb++]=Eb;gb=65;for(Eb=10;36>Eb;++Eb)Jb[gb++]=Eb;cb.prototype.convert=function(e){return 0>e.s||0<=e.compareTo(this.m)?e.mod(this.m):e};cb.prototype.revert=function(e){return e};cb.prototype.reduce=function(e){e.divRemTo(this.m,null,e)};cb.prototype.mulTo=function(e,g,l){e.multiplyTo(g,l);this.reduce(l)};cb.prototype.sqrTo=function(e,g){e.squareTo(g);this.reduce(g)};aa.prototype.convert=function(e){var g=Y();e.abs().dlShiftTo(this.m.t,
g);g.divRemTo(this.m,null,g);0>e.s&&0<g.compareTo(R.ZERO)&&this.m.subTo(g,g);return g};aa.prototype.revert=function(e){var g=Y();e.copyTo(g);this.reduce(g);return g};aa.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var g=0;g<this.m.t;++g){var l=e[g]&32767,q=l*this.mpl+((l*this.mph+(e[g]>>15)*this.mpl&this.um)<<15)&e.DM;l=g+this.m.t;for(e[l]+=this.m.am(0,q,e,g,0,this.m.t);e[l]>=e.DV;)e[l]-=e.DV,e[++l]++}e.clamp();e.drShiftTo(this.m.t,e);0<=e.compareTo(this.m)&&e.subTo(this.m,e)};
aa.prototype.mulTo=function(e,g,l){e.multiplyTo(g,l);this.reduce(l)};aa.prototype.sqrTo=function(e,g){e.squareTo(g);this.reduce(g)};R.prototype.copyTo=function(e){for(var g=this.t-1;0<=g;--g)e[g]=this[g];e.t=this.t;e.s=this.s};R.prototype.fromInt=function(e){this.t=1;this.s=0>e?-1:0;0<e?this[0]=e:-1>e?this[0]=e+this.DV:this.t=0};R.prototype.fromString=function(e,g){if(16==g)g=4;else if(8==g)g=3;else if(256==g)g=8;else if(2==g)g=1;else if(32==g)g=5;else if(4==g)g=2;else{this.fromRadix(e,g);return}this.s=
this.t=0;for(var l=e.length,q=!1,z=0;0<=--l;){var D=8==g?e[l]&255:Ua(e,l);0>D?"-"==e.charAt(l)&&(q=!0):(q=!1,0==z?this[this.t++]=D:z+g>this.DB?(this[this.t-1]|=(D&(1<<this.DB-z)-1)<<z,this[this.t++]=D>>this.DB-z):this[this.t-1]|=D<<z,z+=g,z>=this.DB&&(z-=this.DB))}8==g&&0!=(e[0]&128)&&(this.s=-1,0<z&&(this[this.t-1]|=(1<<this.DB-z)-1<<z));this.clamp();q&&R.ZERO.subTo(this,this)};R.prototype.clamp=function(){for(var e=this.s&this.DM;0<this.t&&this[this.t-1]==e;)--this.t};R.prototype.dlShiftTo=function(e,
g){var l;for(l=this.t-1;0<=l;--l)g[l+e]=this[l];for(l=e-1;0<=l;--l)g[l]=0;g.t=this.t+e;g.s=this.s};R.prototype.drShiftTo=function(e,g){for(var l=e;l<this.t;++l)g[l-e]=this[l];g.t=Math.max(this.t-e,0);g.s=this.s};R.prototype.lShiftTo=function(e,g){var l=e%this.DB,q=this.DB-l,z=(1<<q)-1;e=Math.floor(e/this.DB);var D=this.s<<l&this.DM,I;for(I=this.t-1;0<=I;--I)g[I+e+1]=this[I]>>q|D,D=(this[I]&z)<<l;for(I=e-1;0<=I;--I)g[I]=0;g[e]=D;g.t=this.t+e+1;g.s=this.s;g.clamp()};R.prototype.rShiftTo=function(e,
g){g.s=this.s;var l=Math.floor(e/this.DB);if(l>=this.t)g.t=0;else{e%=this.DB;var q=this.DB-e,z=(1<<e)-1;g[0]=this[l]>>e;for(var D=l+1;D<this.t;++D)g[D-l-1]|=(this[D]&z)<<q,g[D-l]=this[D]>>e;0<e&&(g[this.t-l-1]|=(this.s&z)<<q);g.t=this.t-l;g.clamp()}};R.prototype.subTo=function(e,g){for(var l=0,q=0,z=Math.min(e.t,this.t);l<z;)q+=this[l]-e[l],g[l++]=q&this.DM,q>>=this.DB;if(e.t<this.t){for(q-=e.s;l<this.t;)q+=this[l],g[l++]=q&this.DM,q>>=this.DB;q+=this.s}else{for(q+=this.s;l<e.t;)q-=e[l],g[l++]=q&
this.DM,q>>=this.DB;q-=e.s}g.s=0>q?-1:0;-1>q?g[l++]=this.DV+q:0<q&&(g[l++]=q);g.t=l;g.clamp()};R.prototype.multiplyTo=function(e,g){var l=this.abs(),q=e.abs(),z=l.t;for(g.t=z+q.t;0<=--z;)g[z]=0;for(z=0;z<q.t;++z)g[z+l.t]=l.am(0,q[z],g,z,0,l.t);g.s=0;g.clamp();this.s!=e.s&&R.ZERO.subTo(g,g)};R.prototype.squareTo=function(e){for(var g=this.abs(),l=e.t=2*g.t;0<=--l;)e[l]=0;for(l=0;l<g.t-1;++l){var q=g.am(l,g[l],e,2*l,0,1);(e[l+g.t]+=g.am(l+1,2*g[l],e,2*l+1,q,g.t-l-1))>=g.DV&&(e[l+g.t]-=g.DV,e[l+g.t+
1]=1)}0<e.t&&(e[e.t-1]+=g.am(l,g[l],e,2*l,0,1));e.s=0;e.clamp()};R.prototype.divRemTo=function(e,g,l){var q=e.abs();if(!(0>=q.t)){var z=this.abs();if(z.t<q.t)null!=g&&g.fromInt(0),null!=l&&this.copyTo(l);else{null==l&&(l=Y());var D=Y(),I=this.s;e=e.s;var W=this.DB-B(q[q.t-1]);0<W?(q.lShiftTo(W,D),z.lShiftTo(W,l)):(q.copyTo(D),z.copyTo(l));q=D.t;z=D[q-1];if(0!=z){var da=z*(1<<this.F1)+(1<q?D[q-2]>>this.F2:0),ha=this.FV/da;da=(1<<this.F1)/da;var fa=1<<this.F2,Wa=l.t,Ra=Wa-q,Nb=null==g?Y():g;D.dlShiftTo(Ra,
Nb);0<=l.compareTo(Nb)&&(l[l.t++]=1,l.subTo(Nb,l));R.ONE.dlShiftTo(q,Nb);for(Nb.subTo(D,D);D.t<q;)D[D.t++]=0;for(;0<=--Ra;){var Qa=l[--Wa]==z?this.DM:Math.floor(l[Wa]*ha+(l[Wa-1]+fa)*da);if((l[Wa]+=D.am(0,Qa,l,Ra,0,q))<Qa)for(D.dlShiftTo(Ra,Nb),l.subTo(Nb,l);l[Wa]<--Qa;)l.subTo(Nb,l)}null!=g&&(l.drShiftTo(q,g),I!=e&&R.ZERO.subTo(g,g));l.t=q;l.clamp();0<W&&l.rShiftTo(W,l);0>I&&R.ZERO.subTo(l,l)}}}};R.prototype.invDigit=function(){if(1>this.t)return 0;var e=this[0];if(0==(e&1))return 0;var g=e&3;g=
g*(2-(e&15)*g)&15;g=g*(2-(e&255)*g)&255;g=g*(2-((e&65535)*g&65535))&65535;g=g*(2-e*g%this.DV)%this.DV;return 0<g?this.DV-g:-g};R.prototype.isEven=function(){return 0==(0<this.t?this[0]&1:this.s)};R.prototype.exp=function(e,g){if(4294967295<e||1>e)return R.ONE;var l=Y(),q=Y(),z=g.convert(this),D=B(e)-1;for(z.copyTo(l);0<=--D;)if(g.sqrTo(l,q),0<(e&1<<D))g.mulTo(q,z,l);else{var I=l;l=q;q=I}return g.revert(l)};R.prototype.toString=function(e){if(0>this.s)return"-"+this.negate().toString(e);if(16==e)e=
4;else if(8==e)e=3;else if(2==e)e=1;else if(32==e)e=5;else if(4==e)e=2;else return this.toRadix(e);var g=(1<<e)-1,l,q=!1,z="",D=this.t,I=this.DB-D*this.DB%e;if(0<D--)for(I<this.DB&&0<(l=this[D]>>I)&&(q=!0,z="0123456789abcdefghijklmnopqrstuvwxyz".charAt(l));0<=D;)I<e?(l=(this[D]&(1<<I)-1)<<e-I,l|=this[--D]>>(I+=this.DB-e)):(l=this[D]>>(I-=e)&g,0>=I&&(I+=this.DB,--D)),0<l&&(q=!0),q&&(z+="0123456789abcdefghijklmnopqrstuvwxyz".charAt(l));return q?z:"0"};R.prototype.negate=function(){var e=Y();R.ZERO.subTo(this,
e);return e};R.prototype.abs=function(){return 0>this.s?this.negate():this};R.prototype.compareTo=function(e){var g=this.s-e.s;if(0!=g)return g;var l=this.t;g=l-e.t;if(0!=g)return 0>this.s?-g:g;for(;0<=--l;)if(0!=(g=this[l]-e[l]))return g;return 0};R.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+B(this[this.t-1]^this.s&this.DM)};R.prototype.mod=function(e){var g=Y();this.abs().divRemTo(e,null,g);0>this.s&&0<g.compareTo(R.ZERO)&&e.subTo(g,g);return g};R.prototype.modPowInt=function(e,
g){g=256>e||g.isEven()?new cb(g):new aa(g);return this.exp(e,g)};R.ZERO=Cb(0);R.ONE=Cb(1);za.prototype.convert=ib;za.prototype.revert=ib;za.prototype.mulTo=function(e,g,l){e.multiplyTo(g,l)};za.prototype.sqrTo=function(e,g){e.squareTo(g)};pb.prototype.convert=function(e){if(0>e.s||e.t>2*this.m.t)return e.mod(this.m);if(0>e.compareTo(this.m))return e;var g=Y();e.copyTo(g);this.reduce(g);return g};pb.prototype.revert=function(e){return e};pb.prototype.reduce=function(e){e.drShiftTo(this.m.t-1,this.r2);
e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>e.compareTo(this.r2);)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);0<=e.compareTo(this.m);)e.subTo(this.m,e)};pb.prototype.mulTo=function(e,g,l){e.multiplyTo(g,l);this.reduce(l)};pb.prototype.sqrTo=function(e,g){e.squareTo(g);this.reduce(g)};var Na=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,
131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,
929,937,941,947,953,967,971,977,983,991,997],Vd=67108864/Na[Na.length-1];R.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))};R.prototype.toRadix=function(e){null==e&&(e=10);if(0==this.signum()||2>e||36<e)return"0";var g=this.chunkSize(e);g=Math.pow(e,g);var l=Cb(g),q=Y(),z=Y(),D="";for(this.divRemTo(l,q,z);0<q.signum();)D=(g+z.intValue()).toString(e).substr(1)+D,q.divRemTo(l,q,z);return z.intValue().toString(e)+D};R.prototype.fromRadix=function(e,g){this.fromInt(0);
null==g&&(g=10);for(var l=this.chunkSize(g),q=Math.pow(g,l),z=!1,D=0,I=0,W=0;W<e.length;++W){var da=Ua(e,W);0>da?"-"==e.charAt(W)&&0==this.signum()&&(z=!0):(I=g*I+da,++D>=l&&(this.dMultiply(q),this.dAddOffset(I,0),I=D=0))}0<D&&(this.dMultiply(Math.pow(g,D)),this.dAddOffset(I,0));z&&R.ZERO.subTo(this,this)};R.prototype.fromNumber=function(e,g,l){if("number"==typeof g)if(2>e)this.fromInt(1);else for(this.fromNumber(e,l),this.testBit(e-1)||this.bitwiseTo(R.ONE.shiftLeft(e-1),Va,this),this.isEven()&&
this.dAddOffset(1,0);!this.isProbablePrime(g);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(R.ONE.shiftLeft(e-1),this);else{l=[];var q=e&7;l.length=(e>>3)+1;g.nextBytes(l);l[0]=0<q?l[0]&(1<<q)-1:0;this.fromString(l,256)}};R.prototype.bitwiseTo=function(e,g,l){var q,z=Math.min(e.t,this.t);for(q=0;q<z;++q)l[q]=g(this[q],e[q]);if(e.t<this.t){var D=e.s&this.DM;for(q=z;q<this.t;++q)l[q]=g(this[q],D);l.t=this.t}else{D=this.s&this.DM;for(q=z;q<e.t;++q)l[q]=g(D,e[q]);l.t=e.t}l.s=g(this.s,e.s);l.clamp()};
R.prototype.changeBit=function(e,g){e=R.ONE.shiftLeft(e);this.bitwiseTo(e,g,e);return e};R.prototype.addTo=function(e,g){for(var l=0,q=0,z=Math.min(e.t,this.t);l<z;)q+=this[l]+e[l],g[l++]=q&this.DM,q>>=this.DB;if(e.t<this.t){for(q+=e.s;l<this.t;)q+=this[l],g[l++]=q&this.DM,q>>=this.DB;q+=this.s}else{for(q+=this.s;l<e.t;)q+=e[l],g[l++]=q&this.DM,q>>=this.DB;q+=e.s}g.s=0>q?-1:0;0<q?g[l++]=q:-1>q&&(g[l++]=this.DV+q);g.t=l;g.clamp()};R.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,
0,this.t);++this.t;this.clamp()};R.prototype.dAddOffset=function(e,g){if(0!=e){for(;this.t<=g;)this[this.t++]=0;for(this[g]+=e;this[g]>=this.DV;)this[g]-=this.DV,++g>=this.t&&(this[this.t++]=0),++this[g]}};R.prototype.multiplyLowerTo=function(e,g,l){var q=Math.min(this.t+e.t,g);l.s=0;for(l.t=q;0<q;)l[--q]=0;var z;for(z=l.t-this.t;q<z;++q)l[q+this.t]=this.am(0,e[q],l,q,0,this.t);for(z=Math.min(e.t,g);q<z;++q)this.am(0,e[q],l,q,0,g-q);l.clamp()};R.prototype.multiplyUpperTo=function(e,g,l){--g;var q=
l.t=this.t+e.t-g;for(l.s=0;0<=--q;)l[q]=0;for(q=Math.max(g-this.t,0);q<e.t;++q)l[this.t+q-g]=this.am(g-q,e[q],l,0,0,this.t+q-g);l.clamp();l.drShiftTo(1,l)};R.prototype.modInt=function(e){if(0>=e)return 0;var g=this.DV%e,l=0>this.s?e-1:0;if(0<this.t)if(0==g)l=this[0]%e;else for(var q=this.t-1;0<=q;--q)l=(g*l+this[q])%e;return l};R.prototype.millerRabin=function(e){var g=this.subtract(R.ONE),l=g.getLowestSetBit();if(0>=l)return!1;var q=g.shiftRight(l);e=e+1>>1;e>Na.length&&(e=Na.length);for(var z=Y(),
D=0;D<e;++D){z.fromInt(Na[Math.floor(Math.random()*Na.length)]);var I=z.modPow(q,this);if(0!=I.compareTo(R.ONE)&&0!=I.compareTo(g)){for(var W=1;W++<l&&0!=I.compareTo(g);)if(I=I.modPowInt(2,this),0==I.compareTo(R.ONE))return!1;if(0!=I.compareTo(g))return!1}}return!0};R.prototype.clone=function(){var e=Y();this.copyTo(e);return e};R.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&
(1<<32-this.DB)-1)<<this.DB|this[0]};R.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24};R.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16};R.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1};R.prototype.toByteArray=function(){var e=this.t,g=[];g[0]=this.s;var l=this.DB-e*this.DB%8,q,z=0;if(0<e--)for(l<this.DB&&(q=this[e]>>l)!=(this.s&this.DM)>>l&&(g[z++]=q|this.s<<this.DB-l);0<=e;)if(8>l?(q=(this[e]&(1<<l)-1)<<8-l,q|=
this[--e]>>(l+=this.DB-8)):(q=this[e]>>(l-=8)&255,0>=l&&(l+=this.DB,--e)),0!=(q&128)&&(q|=-256),0==z&&(this.s&128)!=(q&128)&&++z,0<z||q!=this.s)g[z++]=q;return g};R.prototype.equals=function(e){return 0==this.compareTo(e)};R.prototype.min=function(e){return 0>this.compareTo(e)?this:e};R.prototype.max=function(e){return 0<this.compareTo(e)?this:e};R.prototype.and=function(e){var g=Y();this.bitwiseTo(e,Ga,g);return g};R.prototype.or=function(e){var g=Y();this.bitwiseTo(e,Va,g);return g};R.prototype.xor=
function(e){var g=Y();this.bitwiseTo(e,lb,g);return g};R.prototype.andNot=function(e){var g=Y();this.bitwiseTo(e,ob,g);return g};R.prototype.not=function(){for(var e=Y(),g=0;g<this.t;++g)e[g]=this.DM&~this[g];e.t=this.t;e.s=~this.s;return e};R.prototype.shiftLeft=function(e){var g=Y();0>e?this.rShiftTo(-e,g):this.lShiftTo(e,g);return g};R.prototype.shiftRight=function(e){var g=Y();0>e?this.lShiftTo(-e,g):this.rShiftTo(e,g);return g};R.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=
this[e]){var g=e*this.DB;e=this[e];if(0==e)e=-1;else{var l=0;0==(e&65535)&&(e>>=16,l+=16);0==(e&255)&&(e>>=8,l+=8);0==(e&15)&&(e>>=4,l+=4);0==(e&3)&&(e>>=2,l+=2);0==(e&1)&&++l;e=l}return g+e}return 0>this.s?this.t*this.DB:-1};R.prototype.bitCount=function(){for(var e=0,g=this.s&this.DM,l=0;l<this.t;++l){for(var q=this[l]^g,z=0;0!=q;)q&=q-1,++z;e+=z}return e};R.prototype.testBit=function(e){var g=Math.floor(e/this.DB);return g>=this.t?0!=this.s:0!=(this[g]&1<<e%this.DB)};R.prototype.setBit=function(e){return this.changeBit(e,
Va)};R.prototype.clearBit=function(e){return this.changeBit(e,ob)};R.prototype.flipBit=function(e){return this.changeBit(e,lb)};R.prototype.add=function(e){var g=Y();this.addTo(e,g);return g};R.prototype.subtract=function(e){var g=Y();this.subTo(e,g);return g};R.prototype.multiply=function(e){var g=Y();this.multiplyTo(e,g);return g};R.prototype.divide=function(e){var g=Y();this.divRemTo(e,g,null);return g};R.prototype.remainder=function(e){var g=Y();this.divRemTo(e,null,g);return g};R.prototype.divideAndRemainder=
function(e){var g=Y(),l=Y();this.divRemTo(e,g,l);return[g,l]};R.prototype.modPow=function(e,g){var l=e.bitLength(),q=Cb(1);if(0>=l)return q;var z=18>l?1:48>l?3:144>l?4:768>l?5:6;g=8>l?new cb(g):g.isEven()?new pb(g):new aa(g);var D=[],I=3,W=z-1,da=(1<<z)-1;D[1]=g.convert(this);if(1<z)for(l=Y(),g.sqrTo(D[1],l);I<=da;)D[I]=Y(),g.mulTo(l,D[I-2],D[I]),I+=2;var ha=e.t-1,fa,Wa=!0,Ra=Y();for(l=B(e[ha])-1;0<=ha;){l>=W?fa=e[ha]>>l-W&da:(fa=(e[ha]&(1<<l+1)-1)<<W-l,0<ha&&(fa|=e[ha-1]>>this.DB+l-W));for(I=z;0==
(fa&1);)fa>>=1,--I;0>(l-=I)&&(l+=this.DB,--ha);if(Wa)D[fa].copyTo(q),Wa=!1;else{for(;1<I;)g.sqrTo(q,Ra),g.sqrTo(Ra,q),I-=2;0<I?g.sqrTo(q,Ra):(I=q,q=Ra,Ra=I);g.mulTo(Ra,D[fa],q)}for(;0<=ha&&0==(e[ha]&1<<l);)g.sqrTo(q,Ra),I=q,q=Ra,Ra=I,0>--l&&(l=this.DB-1,--ha)}return g.revert(q)};R.prototype.modInverse=function(e){var g=e.isEven();if(this.isEven()&&g||0==e.signum())return R.ZERO;for(var l=e.clone(),q=this.clone(),z=Cb(1),D=Cb(0),I=Cb(0),W=Cb(1);0!=l.signum();){for(;l.isEven();)l.rShiftTo(1,l),g?(z.isEven()&&
D.isEven()||(z.addTo(this,z),D.subTo(e,D)),z.rShiftTo(1,z)):D.isEven()||D.subTo(e,D),D.rShiftTo(1,D);for(;q.isEven();)q.rShiftTo(1,q),g?(I.isEven()&&W.isEven()||(I.addTo(this,I),W.subTo(e,W)),I.rShiftTo(1,I)):W.isEven()||W.subTo(e,W),W.rShiftTo(1,W);0<=l.compareTo(q)?(l.subTo(q,l),g&&z.subTo(I,z),D.subTo(W,D)):(q.subTo(l,q),g&&I.subTo(z,I),W.subTo(D,W))}if(0!=q.compareTo(R.ONE))return R.ZERO;if(0<=W.compareTo(e))return W.subtract(e);if(0>W.signum())W.addTo(e,W);else return W;return 0>W.signum()?W.add(e):
W};R.prototype.pow=function(e){return this.exp(e,new za)};R.prototype.gcd=function(e){var g=0>this.s?this.negate():this.clone();e=0>e.s?e.negate():e.clone();if(0>g.compareTo(e)){var l=g;g=e;e=l}l=g.getLowestSetBit();var q=e.getLowestSetBit();if(0>q)return g;l<q&&(q=l);for(0<q&&(g.rShiftTo(q,g),e.rShiftTo(q,e));0<g.signum();)0<(l=g.getLowestSetBit())&&g.rShiftTo(l,g),0<(l=e.getLowestSetBit())&&e.rShiftTo(l,e),0<=g.compareTo(e)?(g.subTo(e,g),g.rShiftTo(1,g)):(e.subTo(g,e),e.rShiftTo(1,e));0<q&&e.lShiftTo(q,
e);return e};R.prototype.isProbablePrime=function(e){var g,l=this.abs();if(1==l.t&&l[0]<=Na[Na.length-1]){for(g=0;g<Na.length;++g)if(l[0]==Na[g])return!0;return!1}if(l.isEven())return!1;for(g=1;g<Na.length;){for(var q=Na[g],z=g+1;z<Na.length&&q<Vd;)q*=Na[z++];for(q=l.modInt(q);g<z;)if(0==q%Na[g++])return!1}return l.millerRabin(e)};R.prototype.square=function(){var e=Y();this.squareTo(e);return e};R.prototype.IsNegative=function(){return-1==this.compareTo(R.ZERO)?!0:!1};R.op_Equality=function(e,g){return 0==
e.compareTo(g)?!0:!1};R.op_Inequality=function(e,g){return 0!=e.compareTo(g)?!0:!1};R.op_GreaterThan=function(e,g){return 0<e.compareTo(g)?!0:!1};R.op_LessThan=function(e,g){return 0>e.compareTo(g)?!0:!1};R.op_Addition=function(e,g){return(new R(e)).add(new R(g))};R.op_Subtraction=function(e,g){return(new R(e)).subtract(new R(g))};R.Int128Mul=function(e,g){return(new R(e)).multiply(new R(g))};R.op_Division=function(e,g){return e.divide(g)};R.prototype.ToDouble=function(){return parseFloat(this.toString())};
gb=function(e,g){var l;if("undefined"==typeof Object.getOwnPropertyNames)for(l in g.prototype){if("undefined"==typeof e.prototype[l]||e.prototype[l]==Object.prototype[l])e.prototype[l]=g.prototype[l]}else for(var q=Object.getOwnPropertyNames(g.prototype),z=0;z<q.length;z++)"undefined"==typeof Object.getOwnPropertyDescriptor(e.prototype,q[z])&&Object.defineProperty(e.prototype,q[z],Object.getOwnPropertyDescriptor(g.prototype,q[z]));for(l in g)"undefined"==typeof e[l]&&(e[l]=g[l]);e.$baseCtor=g};r.Path=
function(){return[]};r.Paths=function(){return[]};r.DoublePoint=function(){var e=arguments;this.Y=this.X=0;1==e.length?(this.X=e[0].X,this.Y=e[0].Y):2==e.length&&(this.X=e[0],this.Y=e[1])};r.DoublePoint0=function(){this.Y=this.X=0};r.DoublePoint1=function(e){this.X=e.X;this.Y=e.Y};r.DoublePoint2=function(e,g){this.X=e;this.Y=g};r.PolyNode=function(){this.m_Parent=null;this.m_polygon=new r.Path;this.m_endtype=this.m_jointype=this.m_Index=0;this.m_Childs=[];this.IsOpen=!1};r.PolyNode.prototype.IsHoleNode=
function(){for(var e=!0,g=this.m_Parent;null!==g;)e=!e,g=g.m_Parent;return e};r.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length};r.PolyNode.prototype.Contour=function(){return this.m_polygon};r.PolyNode.prototype.AddChild=function(e){var g=this.m_Childs.length;this.m_Childs.push(e);e.m_Parent=this;e.m_Index=g};r.PolyNode.prototype.GetNext=function(){return 0<this.m_Childs.length?this.m_Childs[0]:this.GetNextSiblingUp()};r.PolyNode.prototype.GetNextSiblingUp=function(){return null===
this.m_Parent?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]};r.PolyNode.prototype.Childs=function(){return this.m_Childs};r.PolyNode.prototype.Parent=function(){return this.m_Parent};r.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()};r.PolyTree=function(){this.m_AllPolys=[];r.PolyNode.call(this)};r.PolyTree.prototype.Clear=function(){for(var e=0,g=this.m_AllPolys.length;e<g;e++)this.m_AllPolys[e]=null;this.m_AllPolys.length=
0;this.m_Childs.length=0};r.PolyTree.prototype.GetFirst=function(){return 0<this.m_Childs.length?this.m_Childs[0]:null};r.PolyTree.prototype.Total=function(){var e=this.m_AllPolys.length;0<e&&this.m_Childs[0]!=this.m_AllPolys[0]&&e--;return e};gb(r.PolyTree,r.PolyNode);r.Math_Abs_Int64=r.Math_Abs_Int32=r.Math_Abs_Double=function(e){return Math.abs(e)};r.Math_Max_Int32_Int32=function(e,g){return Math.max(e,g)};r.Cast_Int32=kb||Db||ua?function(e){return e|0}:function(e){return~~e};r.Cast_Int64=S?function(e){return-2147483648>
e||2147483647<e?0>e?Math.ceil(e):Math.floor(e):~~e}:Ea&&"function"==typeof Number.toInteger?function(e){return Number.toInteger(e)}:Qb||Mb?function(e){return parseInt(e,10)}:kb?function(e){return-2147483648>e||2147483647<e?0>e?Math.ceil(e):Math.floor(e):e|0}:function(e){return 0>e?Math.ceil(e):Math.floor(e)};r.Clear=function(e){e.length=0};r.PI=3.141592653589793;r.PI2=6.283185307179586;r.IntPoint=function(){var e=arguments,g=e.length;this.Y=this.X=0;r.use_xyz?(this.Z=0,3==g?(this.X=e[0],this.Y=e[1],
this.Z=e[2]):2==g?(this.X=e[0],this.Y=e[1],this.Z=0):1==g?e[0]instanceof r.DoublePoint?(e=e[0],this.X=r.Clipper.Round(e.X),this.Y=r.Clipper.Round(e.Y),this.Z=0):(e=e[0],"undefined"==typeof e.Z&&(e.Z=0),this.X=e.X,this.Y=e.Y,this.Z=e.Z):this.Z=this.Y=this.X=0):2==g?(this.X=e[0],this.Y=e[1]):1==g?e[0]instanceof r.DoublePoint?(e=e[0],this.X=r.Clipper.Round(e.X),this.Y=r.Clipper.Round(e.Y)):(e=e[0],this.X=e.X,this.Y=e.Y):this.Y=this.X=0};r.IntPoint.op_Equality=function(e,g){return e.X==g.X&&e.Y==g.Y};
r.IntPoint.op_Inequality=function(e,g){return e.X!=g.X||e.Y!=g.Y};r.use_xyz?(r.IntPoint0=function(){this.Z=this.Y=this.X=0},r.IntPoint1=function(e){this.X=e.X;this.Y=e.Y;this.Z=e.Z},r.IntPoint1dp=function(e){this.X=r.Clipper.Round(e.X);this.Y=r.Clipper.Round(e.Y);this.Z=0},r.IntPoint2=function(e,g){this.X=e;this.Y=g;this.Z=0},r.IntPoint3=function(e,g,l){this.X=e;this.Y=g;this.Z=l}):(r.IntPoint0=function(){this.Y=this.X=0},r.IntPoint1=function(e){this.X=e.X;this.Y=e.Y},r.IntPoint1dp=function(e){this.X=
r.Clipper.Round(e.X);this.Y=r.Clipper.Round(e.Y)},r.IntPoint2=function(e,g){this.X=e;this.Y=g});r.IntRect=function(){var e=arguments,g=e.length;4==g?(this.left=e[0],this.top=e[1],this.right=e[2],this.bottom=e[3]):1==g?(this.left=e[0].left,this.top=e[0].top,this.right=e[0].right,this.bottom=e[0].bottom):this.bottom=this.right=this.top=this.left=0};r.IntRect0=function(){this.bottom=this.right=this.top=this.left=0};r.IntRect1=function(e){this.left=e.left;this.top=e.top;this.right=e.right;this.bottom=
e.bottom};r.IntRect4=function(e,g,l,q){this.left=e;this.top=g;this.right=l;this.bottom=q};r.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3};r.PolyType={ptSubject:0,ptClip:1};r.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3};r.JoinType={jtSquare:0,jtRound:1,jtMiter:2};r.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4};r.EdgeSide={esLeft:0,esRight:1};r.Direction={dRightToLeft:0,dLeftToRight:1};r.TEdge=function(){this.Bot=new r.IntPoint;
this.Curr=new r.IntPoint;this.Top=new r.IntPoint;this.Delta=new r.IntPoint;this.Dx=0;this.PolyTyp=r.PolyType.ptSubject;this.Side=r.EdgeSide.esLeft;this.OutIdx=this.WindCnt2=this.WindCnt=this.WindDelta=0;this.PrevInSEL=this.NextInSEL=this.PrevInAEL=this.NextInAEL=this.NextInLML=this.Prev=this.Next=null};r.IntersectNode=function(){this.Edge2=this.Edge1=null;this.Pt=new r.IntPoint};r.MyIntersectNodeSort=function(){};r.MyIntersectNodeSort.Compare=function(e,g){e=g.Pt.Y-e.Pt.Y;return 0<e?1:0>e?-1:0};r.LocalMinima=
function(){this.Y=0;this.Next=this.RightBound=this.LeftBound=null};r.Scanbeam=function(){this.Y=0;this.Next=null};r.OutRec=function(){this.Idx=0;this.IsOpen=this.IsHole=!1;this.PolyNode=this.BottomPt=this.Pts=this.FirstLeft=null};r.OutPt=function(){this.Idx=0;this.Pt=new r.IntPoint;this.Prev=this.Next=null};r.Join=function(){this.OutPt2=this.OutPt1=null;this.OffPt=new r.IntPoint};r.ClipperBase=function(){this.m_edges=[];this.PreserveCollinear=!1;this.m_CurrentLM=this.m_MinimaList=null;this.m_HasOpenPaths=
this.m_UseFullRange=!1};r.ClipperBase.horizontal=-9007199254740992;r.ClipperBase.Skip=-2;r.ClipperBase.Unassigned=-1;r.ClipperBase.tolerance=1E-20;r.ClipperBase.loRange=47453132;r.ClipperBase.hiRange=0xfffffffffffff;r.ClipperBase.near_zero=function(e){return e>-r.ClipperBase.tolerance&&e<r.ClipperBase.tolerance};r.ClipperBase.IsHorizontal=function(e){return 0===e.Delta.Y};r.ClipperBase.prototype.PointIsVertex=function(e,g){var l=g;do{if(r.IntPoint.op_Equality(l.Pt,e))return!0;l=l.Next}while(l!=g);
return!1};r.ClipperBase.prototype.PointOnLineSegment=function(e,g,l,q){return q?e.X==g.X&&e.Y==g.Y||e.X==l.X&&e.Y==l.Y||e.X>g.X==e.X<l.X&&e.Y>g.Y==e.Y<l.Y&&R.op_Equality(R.Int128Mul(e.X-g.X,l.Y-g.Y),R.Int128Mul(l.X-g.X,e.Y-g.Y)):e.X==g.X&&e.Y==g.Y||e.X==l.X&&e.Y==l.Y||e.X>g.X==e.X<l.X&&e.Y>g.Y==e.Y<l.Y&&(e.X-g.X)*(l.Y-g.Y)==(l.X-g.X)*(e.Y-g.Y)};r.ClipperBase.prototype.PointOnPolygon=function(e,g,l){for(var q=g;;){if(this.PointOnLineSegment(e,q.Pt,q.Next.Pt,l))return!0;q=q.Next;if(q==g)break}return!1};
r.ClipperBase.prototype.SlopesEqual=r.ClipperBase.SlopesEqual=function(){var e=arguments,g=e.length,l,q;if(3==g)return g=e[0],l=e[1],e[2]?R.op_Equality(R.Int128Mul(g.Delta.Y,l.Delta.X),R.Int128Mul(g.Delta.X,l.Delta.Y)):r.Cast_Int64(g.Delta.Y*l.Delta.X)==r.Cast_Int64(g.Delta.X*l.Delta.Y);if(4==g)return g=e[0],l=e[1],q=e[2],e[3]?R.op_Equality(R.Int128Mul(g.Y-l.Y,l.X-q.X),R.Int128Mul(g.X-l.X,l.Y-q.Y)):0===r.Cast_Int64((g.Y-l.Y)*(l.X-q.X))-r.Cast_Int64((g.X-l.X)*(l.Y-q.Y));g=e[0];l=e[1];q=e[2];var z=
e[3];return e[4]?R.op_Equality(R.Int128Mul(g.Y-l.Y,q.X-z.X),R.Int128Mul(g.X-l.X,q.Y-z.Y)):0===r.Cast_Int64((g.Y-l.Y)*(q.X-z.X))-r.Cast_Int64((g.X-l.X)*(q.Y-z.Y))};r.ClipperBase.SlopesEqual3=function(e,g,l){return l?R.op_Equality(R.Int128Mul(e.Delta.Y,g.Delta.X),R.Int128Mul(e.Delta.X,g.Delta.Y)):r.Cast_Int64(e.Delta.Y*g.Delta.X)==r.Cast_Int64(e.Delta.X*g.Delta.Y)};r.ClipperBase.SlopesEqual4=function(e,g,l,q){return q?R.op_Equality(R.Int128Mul(e.Y-g.Y,g.X-l.X),R.Int128Mul(e.X-g.X,g.Y-l.Y)):0===r.Cast_Int64((e.Y-
g.Y)*(g.X-l.X))-r.Cast_Int64((e.X-g.X)*(g.Y-l.Y))};r.ClipperBase.SlopesEqual5=function(e,g,l,q,z){return z?R.op_Equality(R.Int128Mul(e.Y-g.Y,l.X-q.X),R.Int128Mul(e.X-g.X,l.Y-q.Y)):0===r.Cast_Int64((e.Y-g.Y)*(l.X-q.X))-r.Cast_Int64((e.X-g.X)*(l.Y-q.Y))};r.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var e=0,g=this.m_edges.length;e<g;++e){for(var l=0,q=this.m_edges[e].length;l<q;++l)this.m_edges[e][l]=null;r.Clear(this.m_edges[e])}r.Clear(this.m_edges);this.m_HasOpenPaths=
this.m_UseFullRange=!1};r.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;null!==this.m_MinimaList;){var e=this.m_MinimaList.Next;this.m_MinimaList=null;this.m_MinimaList=e}this.m_CurrentLM=null};r.ClipperBase.prototype.RangeTest=function(e,g){if(g.Value)(e.X>r.ClipperBase.hiRange||e.Y>r.ClipperBase.hiRange||-e.X>r.ClipperBase.hiRange||-e.Y>r.ClipperBase.hiRange)&&r.Error("Coordinate outside allowed range in RangeTest().");else if(e.X>r.ClipperBase.loRange||e.Y>r.ClipperBase.loRange||
-e.X>r.ClipperBase.loRange||-e.Y>r.ClipperBase.loRange)g.Value=!0,this.RangeTest(e,g)};r.ClipperBase.prototype.InitEdge=function(e,g,l,q){e.Next=g;e.Prev=l;e.Curr.X=q.X;e.Curr.Y=q.Y;r.use_xyz&&(e.Curr.Z=q.Z);e.OutIdx=-1};r.ClipperBase.prototype.InitEdge2=function(e,g){e.Curr.Y>=e.Next.Curr.Y?(e.Bot.X=e.Curr.X,e.Bot.Y=e.Curr.Y,r.use_xyz&&(e.Bot.Z=e.Curr.Z),e.Top.X=e.Next.Curr.X,e.Top.Y=e.Next.Curr.Y,r.use_xyz&&(e.Top.Z=e.Next.Curr.Z)):(e.Top.X=e.Curr.X,e.Top.Y=e.Curr.Y,r.use_xyz&&(e.Top.Z=e.Curr.Z),
e.Bot.X=e.Next.Curr.X,e.Bot.Y=e.Next.Curr.Y,r.use_xyz&&(e.Bot.Z=e.Next.Curr.Z));this.SetDx(e);e.PolyTyp=g};r.ClipperBase.prototype.FindNextLocMin=function(e){for(var g;;){for(;r.IntPoint.op_Inequality(e.Bot,e.Prev.Bot)||r.IntPoint.op_Equality(e.Curr,e.Top);)e=e.Next;if(e.Dx!=r.ClipperBase.horizontal&&e.Prev.Dx!=r.ClipperBase.horizontal)break;for(;e.Prev.Dx==r.ClipperBase.horizontal;)e=e.Prev;for(g=e;e.Dx==r.ClipperBase.horizontal;)e=e.Next;if(e.Top.Y!=e.Prev.Bot.Y){g.Prev.Bot.X<e.Bot.X&&(e=g);break}}return e};
r.ClipperBase.prototype.ProcessBound=function(e,g){var l,q=e,z;if(q.OutIdx==r.ClipperBase.Skip){e=q;if(g){for(;e.Top.Y==e.Next.Bot.Y;)e=e.Next;for(;e!=q&&e.Dx==r.ClipperBase.horizontal;)e=e.Prev}else{for(;e.Top.Y==e.Prev.Bot.Y;)e=e.Prev;for(;e!=q&&e.Dx==r.ClipperBase.horizontal;)e=e.Next}e==q?q=g?e.Next:e.Prev:(e=g?q.Next:q.Prev,l=new r.LocalMinima,l.Next=null,l.Y=e.Bot.Y,l.LeftBound=null,l.RightBound=e,e.WindDelta=0,q=this.ProcessBound(e,g),this.InsertLocalMinima(l));return q}e.Dx==r.ClipperBase.horizontal&&
(l=g?e.Prev:e.Next,l.OutIdx!=r.ClipperBase.Skip&&(l.Dx==r.ClipperBase.horizontal?l.Bot.X!=e.Bot.X&&l.Top.X!=e.Bot.X&&this.ReverseHorizontal(e):l.Bot.X!=e.Bot.X&&this.ReverseHorizontal(e)));l=e;if(g){for(;q.Top.Y==q.Next.Bot.Y&&q.Next.OutIdx!=r.ClipperBase.Skip;)q=q.Next;if(q.Dx==r.ClipperBase.horizontal&&q.Next.OutIdx!=r.ClipperBase.Skip){for(z=q;z.Prev.Dx==r.ClipperBase.horizontal;)z=z.Prev;z.Prev.Top.X==q.Next.Top.X?g||(q=z.Prev):z.Prev.Top.X>q.Next.Top.X&&(q=z.Prev)}for(;e!=q;)e.NextInLML=e.Next,
e.Dx==r.ClipperBase.horizontal&&e!=l&&e.Bot.X!=e.Prev.Top.X&&this.ReverseHorizontal(e),e=e.Next;e.Dx==r.ClipperBase.horizontal&&e!=l&&e.Bot.X!=e.Prev.Top.X&&this.ReverseHorizontal(e);q=q.Next}else{for(;q.Top.Y==q.Prev.Bot.Y&&q.Prev.OutIdx!=r.ClipperBase.Skip;)q=q.Prev;if(q.Dx==r.ClipperBase.horizontal&&q.Prev.OutIdx!=r.ClipperBase.Skip){for(z=q;z.Next.Dx==r.ClipperBase.horizontal;)z=z.Next;z.Next.Top.X==q.Prev.Top.X?g||(q=z.Next):z.Next.Top.X>q.Prev.Top.X&&(q=z.Next)}for(;e!=q;)e.NextInLML=e.Prev,
e.Dx==r.ClipperBase.horizontal&&e!=l&&e.Bot.X!=e.Next.Top.X&&this.ReverseHorizontal(e),e=e.Prev;e.Dx==r.ClipperBase.horizontal&&e!=l&&e.Bot.X!=e.Next.Top.X&&this.ReverseHorizontal(e);q=q.Prev}return q};r.ClipperBase.prototype.AddPath=function(e,g,l){r.use_lines?l||g!=r.PolyType.ptClip||r.Error("AddPath: Open paths must be subject."):l||r.Error("AddPath: Open paths have been disabled.");var q=e.length-1;if(l)for(;0<q&&r.IntPoint.op_Equality(e[q],e[0]);)--q;for(;0<q&&r.IntPoint.op_Equality(e[q],e[q-
1]);)--q;if(l&&2>q||!l&&1>q)return!1;for(var z=[],D=0;D<=q;D++)z.push(new r.TEdge);var I=!0;z[1].Curr.X=e[1].X;z[1].Curr.Y=e[1].Y;r.use_xyz&&(z[1].Curr.Z=e[1].Z);var W={Value:this.m_UseFullRange};this.RangeTest(e[0],W);this.m_UseFullRange=W.Value;W.Value=this.m_UseFullRange;this.RangeTest(e[q],W);this.m_UseFullRange=W.Value;this.InitEdge(z[0],z[1],z[q],e[0]);this.InitEdge(z[q],z[0],z[q-1],e[q]);for(D=q-1;1<=D;--D)W.Value=this.m_UseFullRange,this.RangeTest(e[D],W),this.m_UseFullRange=W.Value,this.InitEdge(z[D],
z[D+1],z[D-1],e[D]);for(D=e=q=z[0];;)if(e.Curr!=e.Next.Curr||!l&&e.Next==q){if(e.Prev==e.Next)break;else if(l&&r.ClipperBase.SlopesEqual(e.Prev.Curr,e.Curr,e.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(e.Prev.Curr,e.Curr,e.Next.Curr))){e==q&&(q=e.Next);e=this.RemoveEdge(e);D=e=e.Prev;continue}e=e.Next;if(e==D||!l&&e.Next==q)break}else{if(e==e.Next)break;e==q&&(q=e.Next);D=e=this.RemoveEdge(e)}if(!l&&e==e.Next||l&&e.Prev==e.Next)return!1;l||(this.m_HasOpenPaths=
!0,q.Prev.OutIdx=r.ClipperBase.Skip);e=q;do this.InitEdge2(e,g),e=e.Next,I&&e.Curr.Y!=q.Curr.Y&&(I=!1);while(e!=q);if(I){if(l)return!1;e.Prev.OutIdx=r.ClipperBase.Skip;e.Prev.Bot.X<e.Prev.Top.X&&this.ReverseHorizontal(e.Prev);g=new r.LocalMinima;g.Next=null;g.Y=e.Bot.Y;g.LeftBound=null;g.RightBound=e;g.RightBound.Side=r.EdgeSide.esRight;for(g.RightBound.WindDelta=0;e.Next.OutIdx!=r.ClipperBase.Skip;)e.NextInLML=e.Next,e.Bot.X!=e.Prev.Top.X&&this.ReverseHorizontal(e),e=e.Next;this.InsertLocalMinima(g);
this.m_edges.push(z);return!0}this.m_edges.push(z);I=null;for(r.IntPoint.op_Equality(e.Prev.Bot,e.Prev.Top)&&(e=e.Next);;){e=this.FindNextLocMin(e);if(e==I)break;else null==I&&(I=e);g=new r.LocalMinima;g.Next=null;g.Y=e.Bot.Y;e.Dx<e.Prev.Dx?(g.LeftBound=e.Prev,g.RightBound=e,z=!1):(g.LeftBound=e,g.RightBound=e.Prev,z=!0);g.LeftBound.Side=r.EdgeSide.esLeft;g.RightBound.Side=r.EdgeSide.esRight;g.LeftBound.WindDelta=l?g.LeftBound.Next==g.RightBound?-1:1:0;g.RightBound.WindDelta=-g.LeftBound.WindDelta;
e=this.ProcessBound(g.LeftBound,z);e.OutIdx==r.ClipperBase.Skip&&(e=this.ProcessBound(e,z));q=this.ProcessBound(g.RightBound,!z);q.OutIdx==r.ClipperBase.Skip&&(q=this.ProcessBound(q,!z));g.LeftBound.OutIdx==r.ClipperBase.Skip?g.LeftBound=null:g.RightBound.OutIdx==r.ClipperBase.Skip&&(g.RightBound=null);this.InsertLocalMinima(g);z||(e=q)}return!0};r.ClipperBase.prototype.AddPaths=function(e,g,l){for(var q=!1,z=0,D=e.length;z<D;++z)this.AddPath(e[z],g,l)&&(q=!0);return q};r.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=
function(e,g,l){return r.IntPoint.op_Equality(e,l)||r.IntPoint.op_Equality(e,g)||r.IntPoint.op_Equality(l,g)?!1:e.X!=l.X?g.X>e.X==g.X<l.X:g.Y>e.Y==g.Y<l.Y};r.ClipperBase.prototype.RemoveEdge=function(e){e.Prev.Next=e.Next;e.Next.Prev=e.Prev;var g=e.Next;e.Prev=null;return g};r.ClipperBase.prototype.SetDx=function(e){e.Delta.X=e.Top.X-e.Bot.X;e.Delta.Y=e.Top.Y-e.Bot.Y;e.Dx=0===e.Delta.Y?r.ClipperBase.horizontal:e.Delta.X/e.Delta.Y};r.ClipperBase.prototype.InsertLocalMinima=function(e){if(null===this.m_MinimaList)this.m_MinimaList=
e;else if(e.Y>=this.m_MinimaList.Y)e.Next=this.m_MinimaList,this.m_MinimaList=e;else{for(var g=this.m_MinimaList;null!==g.Next&&e.Y<g.Next.Y;)g=g.Next;e.Next=g.Next;g.Next=e}};r.ClipperBase.prototype.PopLocalMinima=function(){null!==this.m_CurrentLM&&(this.m_CurrentLM=this.m_CurrentLM.Next)};r.ClipperBase.prototype.ReverseHorizontal=function(e){var g=e.Top.X;e.Top.X=e.Bot.X;e.Bot.X=g;r.use_xyz&&(g=e.Top.Z,e.Top.Z=e.Bot.Z,e.Bot.Z=g)};r.ClipperBase.prototype.Reset=function(){this.m_CurrentLM=this.m_MinimaList;
if(null!=this.m_CurrentLM)for(var e=this.m_MinimaList;null!=e;){var g=e.LeftBound;null!=g&&(g.Curr.X=g.Bot.X,g.Curr.Y=g.Bot.Y,r.use_xyz&&(g.Curr.Z=g.Bot.Z),g.Side=r.EdgeSide.esLeft,g.OutIdx=r.ClipperBase.Unassigned);g=e.RightBound;null!=g&&(g.Curr.X=g.Bot.X,g.Curr.Y=g.Bot.Y,r.use_xyz&&(g.Curr.Z=g.Bot.Z),g.Side=r.EdgeSide.esRight,g.OutIdx=r.ClipperBase.Unassigned);e=e.Next}};r.Clipper=function(e){"undefined"==typeof e&&(e=0);this.m_PolyOuts=null;this.m_ClipType=r.ClipType.ctIntersection;this.m_IntersectNodeComparer=
this.m_IntersectList=this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;this.m_ExecuteLocked=!1;this.m_SubjFillType=this.m_ClipFillType=r.PolyFillType.pftEvenOdd;this.m_GhostJoins=this.m_Joins=null;this.StrictlySimple=this.ReverseSolution=this.m_UsingPolyTree=!1;r.ClipperBase.call(this);this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;this.m_IntersectList=[];this.m_IntersectNodeComparer=r.MyIntersectNodeSort.Compare;this.m_UsingPolyTree=this.m_ExecuteLocked=!1;this.m_PolyOuts=[];
this.m_Joins=[];this.m_GhostJoins=[];this.ReverseSolution=0!==(1&e);this.StrictlySimple=0!==(2&e);this.PreserveCollinear=0!==(4&e);r.use_xyz&&(this.ZFillFunction=null)};r.Clipper.ioReverseSolution=1;r.Clipper.ioStrictlySimple=2;r.Clipper.ioPreserveCollinear=4;r.Clipper.prototype.Clear=function(){0!==this.m_edges.length&&(this.DisposeAllPolyPts(),r.ClipperBase.prototype.Clear.call(this))};r.Clipper.prototype.DisposeScanbeamList=function(){for(;null!==this.m_Scanbeam;){var e=this.m_Scanbeam.Next;this.m_Scanbeam=
null;this.m_Scanbeam=e}};r.Clipper.prototype.Reset=function(){r.ClipperBase.prototype.Reset.call(this);this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;for(var e=this.m_MinimaList;null!==e;)this.InsertScanbeam(e.Y),e=e.Next};r.Clipper.prototype.InsertScanbeam=function(e){if(null===this.m_Scanbeam)this.m_Scanbeam=new r.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=e;else if(e>this.m_Scanbeam.Y){var g=new r.Scanbeam;g.Y=e;g.Next=this.m_Scanbeam;this.m_Scanbeam=g}else{for(var l=this.m_Scanbeam;null!==
l.Next&&e<=l.Next.Y;)l=l.Next;e!=l.Y&&(g=new r.Scanbeam,g.Y=e,g.Next=l.Next,l.Next=g)}};r.Clipper.prototype.Execute=function(){var e=arguments,g=e.length,l=e[1]instanceof r.PolyTree;if(4!=g||l){if(4==g&&l){g=e[0];var q=e[1];l=e[2];e=e[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0;this.m_SubjFillType=l;this.m_ClipFillType=e;this.m_ClipType=g;this.m_UsingPolyTree=!0;try{(z=this.ExecuteInternal())&&this.BuildResult2(q)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return z}if(2==
g&&!l||2==g&&l)return g=e[0],q=e[1],this.Execute(g,q,r.PolyFillType.pftEvenOdd,r.PolyFillType.pftEvenOdd)}else{g=e[0];q=e[1];l=e[2];e=e[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&r.Error("Error: PolyTree struct is need for open path clipping.");this.m_ExecuteLocked=!0;r.Clear(q);this.m_SubjFillType=l;this.m_ClipFillType=e;this.m_ClipType=g;this.m_UsingPolyTree=!1;try{var z=this.ExecuteInternal();z&&this.BuildResult(q)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return z}};
r.Clipper.prototype.FixHoleLinkage=function(e){if(null!==e.FirstLeft&&(e.IsHole==e.FirstLeft.IsHole||null===e.FirstLeft.Pts)){for(var g=e.FirstLeft;null!==g&&(g.IsHole==e.IsHole||null===g.Pts);)g=g.FirstLeft;e.FirstLeft=g}};r.Clipper.prototype.ExecuteInternal=function(){try{this.Reset();if(null===this.m_CurrentLM)return!1;var e=this.PopScanbeam();do{this.InsertLocalMinimaIntoAEL(e);r.Clear(this.m_GhostJoins);this.ProcessHorizontals(!1);if(null===this.m_Scanbeam)break;var g=this.PopScanbeam();if(!this.ProcessIntersections(g))return!1;
this.ProcessEdgesAtTopOfScanbeam(g);e=g}while(null!==this.m_Scanbeam||null!==this.m_CurrentLM);e=0;for(var l=this.m_PolyOuts.length;e<l;e++){var q=this.m_PolyOuts[e];null===q.Pts||q.IsOpen||(q.IsHole^this.ReverseSolution)==0<this.Area(q)&&this.ReversePolyPtLinks(q.Pts)}this.JoinCommonEdges();e=0;for(l=this.m_PolyOuts.length;e<l;e++)q=this.m_PolyOuts[e],null===q.Pts||q.IsOpen||this.FixupOutPolygon(q);this.StrictlySimple&&this.DoSimplePolygons();return!0}finally{r.Clear(this.m_Joins),r.Clear(this.m_GhostJoins)}};
r.Clipper.prototype.PopScanbeam=function(){var e=this.m_Scanbeam.Y;this.m_Scanbeam=this.m_Scanbeam.Next;return e};r.Clipper.prototype.DisposeAllPolyPts=function(){for(var e=0,g=this.m_PolyOuts.length;e<g;++e)this.DisposeOutRec(e);r.Clear(this.m_PolyOuts)};r.Clipper.prototype.DisposeOutRec=function(e){this.m_PolyOuts[e].Pts=null;this.m_PolyOuts[e]=null};r.Clipper.prototype.AddJoin=function(e,g,l){var q=new r.Join;q.OutPt1=e;q.OutPt2=g;q.OffPt.X=l.X;q.OffPt.Y=l.Y;r.use_xyz&&(q.OffPt.Z=l.Z);this.m_Joins.push(q)};
r.Clipper.prototype.AddGhostJoin=function(e,g){var l=new r.Join;l.OutPt1=e;l.OffPt.X=g.X;l.OffPt.Y=g.Y;r.use_xyz&&(l.OffPt.Z=g.Z);this.m_GhostJoins.push(l)};r.Clipper.prototype.SetZ=function(e,g,l){null!==this.ZFillFunction&&0==e.Z&&null!==this.ZFillFunction&&(r.IntPoint.op_Equality(e,g.Bot)?e.Z=g.Bot.Z:r.IntPoint.op_Equality(e,g.Top)?e.Z=g.Top.Z:r.IntPoint.op_Equality(e,l.Bot)?e.Z=l.Bot.Z:r.IntPoint.op_Equality(e,l.Top)?e.Z=l.Top.Z:this.ZFillFunction(g.Bot,g.Top,l.Bot,l.Top,e))};r.Clipper.prototype.InsertLocalMinimaIntoAEL=
function(e){for(;null!==this.m_CurrentLM&&this.m_CurrentLM.Y==e;){var g=this.m_CurrentLM.LeftBound,l=this.m_CurrentLM.RightBound;this.PopLocalMinima();var q=null;null===g?(this.InsertEdgeIntoAEL(l,null),this.SetWindingCount(l),this.IsContributing(l)&&(q=this.AddOutPt(l,l.Bot))):(null==l?(this.InsertEdgeIntoAEL(g,null),this.SetWindingCount(g),this.IsContributing(g)&&(q=this.AddOutPt(g,g.Bot))):(this.InsertEdgeIntoAEL(g,null),this.InsertEdgeIntoAEL(l,g),this.SetWindingCount(g),l.WindCnt=g.WindCnt,l.WindCnt2=
g.WindCnt2,this.IsContributing(g)&&(q=this.AddLocalMinPoly(g,l,g.Bot))),this.InsertScanbeam(g.Top.Y));null!=l&&(r.ClipperBase.IsHorizontal(l)?this.AddEdgeToSEL(l):this.InsertScanbeam(l.Top.Y));if(null!=g&&null!=l){if(null!==q&&r.ClipperBase.IsHorizontal(l)&&0<this.m_GhostJoins.length&&0!==l.WindDelta)for(var z=0,D=this.m_GhostJoins.length;z<D;z++){var I=this.m_GhostJoins[z];this.HorzSegmentsOverlap(I.OutPt1.Pt.X,I.OffPt.X,l.Bot.X,l.Top.X)&&this.AddJoin(I.OutPt1,q,I.OffPt)}0<=g.OutIdx&&null!==g.PrevInAEL&&
g.PrevInAEL.Curr.X==g.Bot.X&&0<=g.PrevInAEL.OutIdx&&r.ClipperBase.SlopesEqual(g.PrevInAEL,g,this.m_UseFullRange)&&0!==g.WindDelta&&0!==g.PrevInAEL.WindDelta&&(z=this.AddOutPt(g.PrevInAEL,g.Bot),this.AddJoin(q,z,g.Top));if(g.NextInAEL!=l&&(0<=l.OutIdx&&0<=l.PrevInAEL.OutIdx&&r.ClipperBase.SlopesEqual(l.PrevInAEL,l,this.m_UseFullRange)&&0!==l.WindDelta&&0!==l.PrevInAEL.WindDelta&&(z=this.AddOutPt(l.PrevInAEL,l.Bot),this.AddJoin(q,z,l.Top)),q=g.NextInAEL,null!==q))for(;q!=l;)this.IntersectEdges(l,q,
g.Curr,!1),q=q.NextInAEL}}};r.Clipper.prototype.InsertEdgeIntoAEL=function(e,g){if(null===this.m_ActiveEdges)e.PrevInAEL=null,e.NextInAEL=null,this.m_ActiveEdges=e;else if(null===g&&this.E2InsertsBeforeE1(this.m_ActiveEdges,e))e.PrevInAEL=null,e.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges=this.m_ActiveEdges.PrevInAEL=e;else{for(null===g&&(g=this.m_ActiveEdges);null!==g.NextInAEL&&!this.E2InsertsBeforeE1(g.NextInAEL,e);)g=g.NextInAEL;e.NextInAEL=g.NextInAEL;null!==g.NextInAEL&&(g.NextInAEL.PrevInAEL=
e);e.PrevInAEL=g;g.NextInAEL=e}};r.Clipper.prototype.E2InsertsBeforeE1=function(e,g){return g.Curr.X==e.Curr.X?g.Top.Y>e.Top.Y?g.Top.X<r.Clipper.TopX(e,g.Top.Y):e.Top.X>r.Clipper.TopX(g,e.Top.Y):g.Curr.X<e.Curr.X};r.Clipper.prototype.IsEvenOddFillType=function(e){return e.PolyTyp==r.PolyType.ptSubject?this.m_SubjFillType==r.PolyFillType.pftEvenOdd:this.m_ClipFillType==r.PolyFillType.pftEvenOdd};r.Clipper.prototype.IsEvenOddAltFillType=function(e){return e.PolyTyp==r.PolyType.ptSubject?this.m_ClipFillType==
r.PolyFillType.pftEvenOdd:this.m_SubjFillType==r.PolyFillType.pftEvenOdd};r.Clipper.prototype.IsContributing=function(e){var g,l;e.PolyTyp==r.PolyType.ptSubject?(g=this.m_SubjFillType,l=this.m_ClipFillType):(g=this.m_ClipFillType,l=this.m_SubjFillType);switch(g){case r.PolyFillType.pftEvenOdd:if(0===e.WindDelta&&1!=e.WindCnt)return!1;break;case r.PolyFillType.pftNonZero:if(1!=Math.abs(e.WindCnt))return!1;break;case r.PolyFillType.pftPositive:if(1!=e.WindCnt)return!1;break;default:if(-1!=e.WindCnt)return!1}switch(this.m_ClipType){case r.ClipType.ctIntersection:switch(l){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0!==
e.WindCnt2;case r.PolyFillType.pftPositive:return 0<e.WindCnt2;default:return 0>e.WindCnt2}case r.ClipType.ctUnion:switch(l){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0===e.WindCnt2;case r.PolyFillType.pftPositive:return 0>=e.WindCnt2;default:return 0<=e.WindCnt2}case r.ClipType.ctDifference:if(e.PolyTyp==r.PolyType.ptSubject)switch(l){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0===e.WindCnt2;case r.PolyFillType.pftPositive:return 0>=e.WindCnt2;
default:return 0<=e.WindCnt2}else switch(l){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0!==e.WindCnt2;case r.PolyFillType.pftPositive:return 0<e.WindCnt2;default:return 0>e.WindCnt2}case r.ClipType.ctXor:if(0===e.WindDelta)switch(l){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0===e.WindCnt2;case r.PolyFillType.pftPositive:return 0>=e.WindCnt2;default:return 0<=e.WindCnt2}}return!0};r.Clipper.prototype.SetWindingCount=function(e){for(var g=e.PrevInAEL;null!==
g&&(g.PolyTyp!=e.PolyTyp||0===g.WindDelta);)g=g.PrevInAEL;if(null===g)e.WindCnt=0===e.WindDelta?1:e.WindDelta,e.WindCnt2=0,g=this.m_ActiveEdges;else{if(0===e.WindDelta&&this.m_ClipType!=r.ClipType.ctUnion)e.WindCnt=1;else if(this.IsEvenOddFillType(e))if(0===e.WindDelta){for(var l=!0,q=g.PrevInAEL;null!==q;)q.PolyTyp==g.PolyTyp&&0!==q.WindDelta&&(l=!l),q=q.PrevInAEL;e.WindCnt=l?0:1}else e.WindCnt=e.WindDelta;else e.WindCnt=0>g.WindCnt*g.WindDelta?1<Math.abs(g.WindCnt)?0>g.WindDelta*e.WindDelta?g.WindCnt:
g.WindCnt+e.WindDelta:0===e.WindDelta?1:e.WindDelta:0===e.WindDelta?0>g.WindCnt?g.WindCnt-1:g.WindCnt+1:0>g.WindDelta*e.WindDelta?g.WindCnt:g.WindCnt+e.WindDelta;e.WindCnt2=g.WindCnt2;g=g.NextInAEL}if(this.IsEvenOddAltFillType(e))for(;g!=e;)0!==g.WindDelta&&(e.WindCnt2=0===e.WindCnt2?1:0),g=g.NextInAEL;else for(;g!=e;)e.WindCnt2+=g.WindDelta,g=g.NextInAEL};r.Clipper.prototype.AddEdgeToSEL=function(e){null===this.m_SortedEdges?(this.m_SortedEdges=e,e.PrevInSEL=null,e.NextInSEL=null):(e.NextInSEL=this.m_SortedEdges,
e.PrevInSEL=null,this.m_SortedEdges=this.m_SortedEdges.PrevInSEL=e)};r.Clipper.prototype.CopyAELToSEL=function(){var e=this.m_ActiveEdges;for(this.m_SortedEdges=e;null!==e;)e.PrevInSEL=e.PrevInAEL,e=e.NextInSEL=e.NextInAEL};r.Clipper.prototype.SwapPositionsInAEL=function(e,g){if(e.NextInAEL!=e.PrevInAEL&&g.NextInAEL!=g.PrevInAEL){if(e.NextInAEL==g){var l=g.NextInAEL;null!==l&&(l.PrevInAEL=e);var q=e.PrevInAEL;null!==q&&(q.NextInAEL=g);g.PrevInAEL=q;g.NextInAEL=e;e.PrevInAEL=g;e.NextInAEL=l}else g.NextInAEL==
e?(l=e.NextInAEL,null!==l&&(l.PrevInAEL=g),q=g.PrevInAEL,null!==q&&(q.NextInAEL=e),e.PrevInAEL=q,e.NextInAEL=g,g.PrevInAEL=e,g.NextInAEL=l):(l=e.NextInAEL,q=e.PrevInAEL,e.NextInAEL=g.NextInAEL,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=e),e.PrevInAEL=g.PrevInAEL,null!==e.PrevInAEL&&(e.PrevInAEL.NextInAEL=e),g.NextInAEL=l,null!==g.NextInAEL&&(g.NextInAEL.PrevInAEL=g),g.PrevInAEL=q,null!==g.PrevInAEL&&(g.PrevInAEL.NextInAEL=g));null===e.PrevInAEL?this.m_ActiveEdges=e:null===g.PrevInAEL&&(this.m_ActiveEdges=
g)}};r.Clipper.prototype.SwapPositionsInSEL=function(e,g){if(null!==e.NextInSEL||null!==e.PrevInSEL)if(null!==g.NextInSEL||null!==g.PrevInSEL){if(e.NextInSEL==g){var l=g.NextInSEL;null!==l&&(l.PrevInSEL=e);var q=e.PrevInSEL;null!==q&&(q.NextInSEL=g);g.PrevInSEL=q;g.NextInSEL=e;e.PrevInSEL=g;e.NextInSEL=l}else g.NextInSEL==e?(l=e.NextInSEL,null!==l&&(l.PrevInSEL=g),q=g.PrevInSEL,null!==q&&(q.NextInSEL=e),e.PrevInSEL=q,e.NextInSEL=g,g.PrevInSEL=e,g.NextInSEL=l):(l=e.NextInSEL,q=e.PrevInSEL,e.NextInSEL=
g.NextInSEL,null!==e.NextInSEL&&(e.NextInSEL.PrevInSEL=e),e.PrevInSEL=g.PrevInSEL,null!==e.PrevInSEL&&(e.PrevInSEL.NextInSEL=e),g.NextInSEL=l,null!==g.NextInSEL&&(g.NextInSEL.PrevInSEL=g),g.PrevInSEL=q,null!==g.PrevInSEL&&(g.PrevInSEL.NextInSEL=g));null===e.PrevInSEL?this.m_SortedEdges=e:null===g.PrevInSEL&&(this.m_SortedEdges=g)}};r.Clipper.prototype.AddLocalMaxPoly=function(e,g,l){this.AddOutPt(e,l);0==g.WindDelta&&this.AddOutPt(g,l);e.OutIdx==g.OutIdx?(e.OutIdx=-1,g.OutIdx=-1):e.OutIdx<g.OutIdx?
this.AppendPolygon(e,g):this.AppendPolygon(g,e)};r.Clipper.prototype.AddLocalMinPoly=function(e,g,l){var q,z;r.ClipperBase.IsHorizontal(g)||e.Dx>g.Dx?(q=this.AddOutPt(e,l),g.OutIdx=e.OutIdx,e.Side=r.EdgeSide.esLeft,g.Side=r.EdgeSide.esRight,z=e,e=z.PrevInAEL==g?g.PrevInAEL:z.PrevInAEL):(q=this.AddOutPt(g,l),e.OutIdx=g.OutIdx,e.Side=r.EdgeSide.esRight,g.Side=r.EdgeSide.esLeft,z=g,e=z.PrevInAEL==e?e.PrevInAEL:z.PrevInAEL);null!==e&&0<=e.OutIdx&&r.Clipper.TopX(e,l.Y)==r.Clipper.TopX(z,l.Y)&&r.ClipperBase.SlopesEqual(z,
e,this.m_UseFullRange)&&0!==z.WindDelta&&0!==e.WindDelta&&(l=this.AddOutPt(e,l),this.AddJoin(q,l,z.Top));return q};r.Clipper.prototype.CreateOutRec=function(){var e=new r.OutRec;e.Idx=-1;e.IsHole=!1;e.IsOpen=!1;e.FirstLeft=null;e.Pts=null;e.BottomPt=null;e.PolyNode=null;this.m_PolyOuts.push(e);e.Idx=this.m_PolyOuts.length-1;return e};r.Clipper.prototype.AddOutPt=function(e,g){var l=e.Side==r.EdgeSide.esLeft;if(0>e.OutIdx){var q=this.CreateOutRec();q.IsOpen=0===e.WindDelta;var z=new r.OutPt;q.Pts=
z;z.Idx=q.Idx;z.Pt.X=g.X;z.Pt.Y=g.Y;r.use_xyz&&(z.Pt.Z=g.Z);z.Next=z;z.Prev=z;q.IsOpen||this.SetHoleState(e,q);e.OutIdx=q.Idx}else{q=this.m_PolyOuts[e.OutIdx];e=q.Pts;if(l&&r.IntPoint.op_Equality(g,e.Pt))return e;if(!l&&r.IntPoint.op_Equality(g,e.Prev.Pt))return e.Prev;z=new r.OutPt;z.Idx=q.Idx;z.Pt.X=g.X;z.Pt.Y=g.Y;r.use_xyz&&(z.Pt.Z=g.Z);z.Next=e;z.Prev=e.Prev;z.Prev.Next=z;e.Prev=z;l&&(q.Pts=z)}return z};r.Clipper.prototype.SwapPoints=function(e,g){var l=new r.IntPoint(e.Value);e.Value.X=g.Value.X;
e.Value.Y=g.Value.Y;r.use_xyz&&(e.Value.Z=g.Value.Z);g.Value.X=l.X;g.Value.Y=l.Y;r.use_xyz&&(g.Value.Z=l.Z)};r.Clipper.prototype.HorzSegmentsOverlap=function(e,g,l,q){var z;e>g&&(z=e,e=g,g=z);l>q&&(z=l,l=q,q=z);return e<q&&l<g};r.Clipper.prototype.SetHoleState=function(e,g){var l=!1;for(e=e.PrevInAEL;null!==e;)0<=e.OutIdx&&0!=e.WindDelta&&(l=!l,null===g.FirstLeft&&(g.FirstLeft=this.m_PolyOuts[e.OutIdx])),e=e.PrevInAEL;l&&(g.IsHole=!0)};r.Clipper.prototype.GetDx=function(e,g){return e.Y==g.Y?r.ClipperBase.horizontal:
(g.X-e.X)/(g.Y-e.Y)};r.Clipper.prototype.FirstIsBottomPt=function(e,g){for(var l=e.Prev;r.IntPoint.op_Equality(l.Pt,e.Pt)&&l!=e;)l=l.Prev;var q=Math.abs(this.GetDx(e.Pt,l.Pt));for(l=e.Next;r.IntPoint.op_Equality(l.Pt,e.Pt)&&l!=e;)l=l.Next;e=Math.abs(this.GetDx(e.Pt,l.Pt));for(l=g.Prev;r.IntPoint.op_Equality(l.Pt,g.Pt)&&l!=g;)l=l.Prev;var z=Math.abs(this.GetDx(g.Pt,l.Pt));for(l=g.Next;r.IntPoint.op_Equality(l.Pt,g.Pt)&&l!=g;)l=l.Next;l=Math.abs(this.GetDx(g.Pt,l.Pt));return q>=z&&q>=l||e>=z&&e>=l};
r.Clipper.prototype.GetBottomPt=function(e){for(var g=null,l=e.Next;l!=e;)l.Pt.Y>e.Pt.Y?(e=l,g=null):l.Pt.Y==e.Pt.Y&&l.Pt.X<=e.Pt.X&&(l.Pt.X<e.Pt.X?(g=null,e=l):l.Next!=e&&l.Prev!=e&&(g=l)),l=l.Next;if(null!==g)for(;g!=l;)for(this.FirstIsBottomPt(l,g)||(e=g),g=g.Next;r.IntPoint.op_Inequality(g.Pt,e.Pt);)g=g.Next;return e};r.Clipper.prototype.GetLowermostRec=function(e,g){null===e.BottomPt&&(e.BottomPt=this.GetBottomPt(e.Pts));null===g.BottomPt&&(g.BottomPt=this.GetBottomPt(g.Pts));var l=e.BottomPt,
q=g.BottomPt;return l.Pt.Y>q.Pt.Y?e:l.Pt.Y<q.Pt.Y?g:l.Pt.X<q.Pt.X?e:l.Pt.X>q.Pt.X?g:l.Next==l?g:q.Next==q?e:this.FirstIsBottomPt(l,q)?e:g};r.Clipper.prototype.Param1RightOfParam2=function(e,g){do if(e=e.FirstLeft,e==g)return!0;while(null!==e);return!1};r.Clipper.prototype.GetOutRec=function(e){for(e=this.m_PolyOuts[e];e!=this.m_PolyOuts[e.Idx];)e=this.m_PolyOuts[e.Idx];return e};r.Clipper.prototype.AppendPolygon=function(e,g){var l=this.m_PolyOuts[e.OutIdx],q=this.m_PolyOuts[g.OutIdx];var z=this.Param1RightOfParam2(l,
q)?q:this.Param1RightOfParam2(q,l)?l:this.GetLowermostRec(l,q);var D=l.Pts,I=D.Prev,W=q.Pts,da=W.Prev;e.Side==r.EdgeSide.esLeft?(g.Side==r.EdgeSide.esLeft?(this.ReversePolyPtLinks(W),W.Next=D,D.Prev=W,I.Next=da,da.Prev=I,l.Pts=da):(da.Next=D,D.Prev=da,W.Prev=I,I.Next=W,l.Pts=W),D=r.EdgeSide.esLeft):(g.Side==r.EdgeSide.esRight?(this.ReversePolyPtLinks(W),I.Next=da,da.Prev=I,W.Next=D,D.Prev=W):(I.Next=W,W.Prev=I,D.Prev=da,da.Next=D),D=r.EdgeSide.esRight);l.BottomPt=null;z==q&&(q.FirstLeft!=l&&(l.FirstLeft=
q.FirstLeft),l.IsHole=q.IsHole);q.Pts=null;q.BottomPt=null;q.FirstLeft=l;z=e.OutIdx;I=g.OutIdx;e.OutIdx=-1;g.OutIdx=-1;for(W=this.m_ActiveEdges;null!==W;){if(W.OutIdx==I){W.OutIdx=z;W.Side=D;break}W=W.NextInAEL}q.Idx=l.Idx};r.Clipper.prototype.ReversePolyPtLinks=function(e){if(null!==e){var g=e;do{var l=g.Next;g.Next=g.Prev;g=g.Prev=l}while(g!=e)}};r.Clipper.SwapSides=function(e,g){var l=e.Side;e.Side=g.Side;g.Side=l};r.Clipper.SwapPolyIndexes=function(e,g){var l=e.OutIdx;e.OutIdx=g.OutIdx;g.OutIdx=
l};r.Clipper.prototype.IntersectEdges=function(e,g,l){var q=0<=e.OutIdx,z=0<=g.OutIdx;r.use_xyz&&this.SetZ(l,e,g);if(!r.use_lines||0!==e.WindDelta&&0!==g.WindDelta){if(e.PolyTyp==g.PolyTyp)if(this.IsEvenOddFillType(e)){var D=e.WindCnt;e.WindCnt=g.WindCnt;g.WindCnt=D}else e.WindCnt=0===e.WindCnt+g.WindDelta?-e.WindCnt:e.WindCnt+g.WindDelta,g.WindCnt=0===g.WindCnt-e.WindDelta?-g.WindCnt:g.WindCnt-e.WindDelta;else this.IsEvenOddFillType(g)?e.WindCnt2=0===e.WindCnt2?1:0:e.WindCnt2+=g.WindDelta,this.IsEvenOddFillType(e)?
g.WindCnt2=0===g.WindCnt2?1:0:g.WindCnt2-=e.WindDelta;var I,W,da;e.PolyTyp==r.PolyType.ptSubject?(I=this.m_SubjFillType,da=this.m_ClipFillType):(I=this.m_ClipFillType,da=this.m_SubjFillType);g.PolyTyp==r.PolyType.ptSubject?(W=this.m_SubjFillType,D=this.m_ClipFillType):(W=this.m_ClipFillType,D=this.m_SubjFillType);switch(I){case r.PolyFillType.pftPositive:I=e.WindCnt;break;case r.PolyFillType.pftNegative:I=-e.WindCnt;break;default:I=Math.abs(e.WindCnt)}switch(W){case r.PolyFillType.pftPositive:W=g.WindCnt;
break;case r.PolyFillType.pftNegative:W=-g.WindCnt;break;default:W=Math.abs(g.WindCnt)}if(q&&z)0!=I&&1!=I||0!=W&&1!=W||e.PolyTyp!=g.PolyTyp&&this.m_ClipType!=r.ClipType.ctXor?this.AddLocalMaxPoly(e,g,l):(this.AddOutPt(e,l),this.AddOutPt(g,l),r.Clipper.SwapSides(e,g),r.Clipper.SwapPolyIndexes(e,g));else if(q){if(0===W||1==W)this.AddOutPt(e,l),r.Clipper.SwapSides(e,g),r.Clipper.SwapPolyIndexes(e,g)}else if(z){if(0===I||1==I)this.AddOutPt(g,l),r.Clipper.SwapSides(e,g),r.Clipper.SwapPolyIndexes(e,g)}else if(!(0!=
I&&1!=I||0!=W&&1!=W)){switch(da){case r.PolyFillType.pftPositive:q=e.WindCnt2;break;case r.PolyFillType.pftNegative:q=-e.WindCnt2;break;default:q=Math.abs(e.WindCnt2)}switch(D){case r.PolyFillType.pftPositive:z=g.WindCnt2;break;case r.PolyFillType.pftNegative:z=-g.WindCnt2;break;default:z=Math.abs(g.WindCnt2)}if(e.PolyTyp!=g.PolyTyp)this.AddLocalMinPoly(e,g,l);else if(1==I&&1==W)switch(this.m_ClipType){case r.ClipType.ctIntersection:0<q&&0<z&&this.AddLocalMinPoly(e,g,l);break;case r.ClipType.ctUnion:0>=
q&&0>=z&&this.AddLocalMinPoly(e,g,l);break;case r.ClipType.ctDifference:(e.PolyTyp==r.PolyType.ptClip&&0<q&&0<z||e.PolyTyp==r.PolyType.ptSubject&&0>=q&&0>=z)&&this.AddLocalMinPoly(e,g,l);break;case r.ClipType.ctXor:this.AddLocalMinPoly(e,g,l)}else r.Clipper.SwapSides(e,g)}}else if(0!=e.WindDelta||0!=g.WindDelta)e.PolyTyp==g.PolyTyp&&e.WindDelta!=g.WindDelta&&this.m_ClipType==r.ClipType.ctUnion?0===e.WindDelta?z&&(this.AddOutPt(e,l),q&&(e.OutIdx=-1)):q&&(this.AddOutPt(g,l),z&&(g.OutIdx=-1)):e.PolyTyp!=
g.PolyTyp&&(0!==e.WindDelta||1!=Math.abs(g.WindCnt)||this.m_ClipType==r.ClipType.ctUnion&&0!==g.WindCnt2?0!==g.WindDelta||1!=Math.abs(e.WindCnt)||this.m_ClipType==r.ClipType.ctUnion&&0!==e.WindCnt2||(this.AddOutPt(g,l),z&&(g.OutIdx=-1)):(this.AddOutPt(e,l),q&&(e.OutIdx=-1)))};r.Clipper.prototype.DeleteFromAEL=function(e){var g=e.PrevInAEL,l=e.NextInAEL;if(null!==g||null!==l||e==this.m_ActiveEdges)null!==g?g.NextInAEL=l:this.m_ActiveEdges=l,null!==l&&(l.PrevInAEL=g),e.NextInAEL=null,e.PrevInAEL=null};
r.Clipper.prototype.DeleteFromSEL=function(e){var g=e.PrevInSEL,l=e.NextInSEL;if(null!==g||null!==l||e==this.m_SortedEdges)null!==g?g.NextInSEL=l:this.m_SortedEdges=l,null!==l&&(l.PrevInSEL=g),e.NextInSEL=null,e.PrevInSEL=null};r.Clipper.prototype.UpdateEdgeIntoAEL=function(e){null===e.NextInLML&&r.Error("UpdateEdgeIntoAEL: invalid call");var g=e.PrevInAEL,l=e.NextInAEL;e.NextInLML.OutIdx=e.OutIdx;null!==g?g.NextInAEL=e.NextInLML:this.m_ActiveEdges=e.NextInLML;null!==l&&(l.PrevInAEL=e.NextInLML);
e.NextInLML.Side=e.Side;e.NextInLML.WindDelta=e.WindDelta;e.NextInLML.WindCnt=e.WindCnt;e.NextInLML.WindCnt2=e.WindCnt2;e=e.NextInLML;e.Curr.X=e.Bot.X;e.Curr.Y=e.Bot.Y;r.use_xyz&&(e.Curr.Z=e.Bot.Z);e.PrevInAEL=g;e.NextInAEL=l;r.ClipperBase.IsHorizontal(e)||this.InsertScanbeam(e.Top.Y);return e};r.Clipper.prototype.ProcessHorizontals=function(e){for(var g=this.m_SortedEdges;null!==g;)this.DeleteFromSEL(g),this.ProcessHorizontal(g,e),g=this.m_SortedEdges};r.Clipper.prototype.GetHorzDirection=function(e,
g){e.Bot.X<e.Top.X?(g.Left=e.Bot.X,g.Right=e.Top.X,g.Dir=r.Direction.dLeftToRight):(g.Left=e.Top.X,g.Right=e.Bot.X,g.Dir=r.Direction.dRightToLeft)};r.Clipper.prototype.ProcessHorizontal=function(e,g){var l={Dir:null,Left:null,Right:null};this.GetHorzDirection(e,l);for(var q=l.Dir,z=l.Left,D=l.Right,I=e,W=null;null!==I.NextInLML&&r.ClipperBase.IsHorizontal(I.NextInLML);)I=I.NextInLML;for(null===I.NextInLML&&(W=this.GetMaximaPair(I));;){for(var da=e==I,ha=this.GetNextInAEL(e,q);null!==ha&&!(ha.Curr.X==
e.Top.X&&null!==e.NextInLML&&ha.Dx<e.NextInLML.Dx);){l=this.GetNextInAEL(ha,q);if(q==r.Direction.dLeftToRight&&ha.Curr.X<=D||q==r.Direction.dRightToLeft&&ha.Curr.X>=z){if(ha==W&&da){if(0<=e.OutIdx){q=this.AddOutPt(e,e.Top);for(l=this.m_SortedEdges;null!==l;)0<=l.OutIdx&&this.HorzSegmentsOverlap(e.Bot.X,e.Top.X,l.Bot.X,l.Top.X)&&(z=this.AddOutPt(l,l.Bot),this.AddJoin(z,q,l.Top)),l=l.NextInSEL;this.AddGhostJoin(q,e.Bot);this.AddLocalMaxPoly(e,W,e.Top)}this.DeleteFromAEL(e);this.DeleteFromAEL(W);return}if(q==
r.Direction.dLeftToRight){var fa=new r.IntPoint(ha.Curr.X,e.Curr.Y);this.IntersectEdges(e,ha,fa)}else fa=new r.IntPoint(ha.Curr.X,e.Curr.Y),this.IntersectEdges(ha,e,fa);this.SwapPositionsInAEL(e,ha)}else if(q==r.Direction.dLeftToRight&&ha.Curr.X>=D||q==r.Direction.dRightToLeft&&ha.Curr.X<=z)break;ha=l}if(null!==e.NextInLML&&r.ClipperBase.IsHorizontal(e.NextInLML))e=this.UpdateEdgeIntoAEL(e),0<=e.OutIdx&&this.AddOutPt(e,e.Bot),l={Dir:q,Left:z,Right:D},this.GetHorzDirection(e,l),q=l.Dir,z=l.Left,D=
l.Right;else break}null!==e.NextInLML?0<=e.OutIdx?(q=this.AddOutPt(e,e.Top),g&&this.AddGhostJoin(q,e.Bot),e=this.UpdateEdgeIntoAEL(e),0!==e.WindDelta&&(W=e.PrevInAEL,l=e.NextInAEL,null!==W&&W.Curr.X==e.Bot.X&&W.Curr.Y==e.Bot.Y&&0!==W.WindDelta&&0<=W.OutIdx&&W.Curr.Y>W.Top.Y&&r.ClipperBase.SlopesEqual(e,W,this.m_UseFullRange)?(z=this.AddOutPt(W,e.Bot),this.AddJoin(q,z,e.Top)):null!==l&&l.Curr.X==e.Bot.X&&l.Curr.Y==e.Bot.Y&&0!==l.WindDelta&&0<=l.OutIdx&&l.Curr.Y>l.Top.Y&&r.ClipperBase.SlopesEqual(e,
l,this.m_UseFullRange)&&(z=this.AddOutPt(l,e.Bot),this.AddJoin(q,z,e.Top)))):this.UpdateEdgeIntoAEL(e):(0<=e.OutIdx&&this.AddOutPt(e,e.Top),this.DeleteFromAEL(e))};r.Clipper.prototype.GetNextInAEL=function(e,g){return g==r.Direction.dLeftToRight?e.NextInAEL:e.PrevInAEL};r.Clipper.prototype.IsMinima=function(e){return null!==e&&e.Prev.NextInLML!=e&&e.Next.NextInLML!=e};r.Clipper.prototype.IsMaxima=function(e,g){return null!==e&&e.Top.Y==g&&null===e.NextInLML};r.Clipper.prototype.IsIntermediate=function(e,
g){return e.Top.Y==g&&null!==e.NextInLML};r.Clipper.prototype.GetMaximaPair=function(e){var g=null;r.IntPoint.op_Equality(e.Next.Top,e.Top)&&null===e.Next.NextInLML?g=e.Next:r.IntPoint.op_Equality(e.Prev.Top,e.Top)&&null===e.Prev.NextInLML&&(g=e.Prev);return null===g||-2!=g.OutIdx&&(g.NextInAEL!=g.PrevInAEL||r.ClipperBase.IsHorizontal(g))?g:null};r.Clipper.prototype.ProcessIntersections=function(e){if(null==this.m_ActiveEdges)return!0;try{this.BuildIntersectList(e);if(0==this.m_IntersectList.length)return!0;
if(1==this.m_IntersectList.length||this.FixupIntersectionOrder())this.ProcessIntersectList();else return!1}catch(g){this.m_SortedEdges=null,this.m_IntersectList.length=0,r.Error("ProcessIntersections error")}this.m_SortedEdges=null;return!0};r.Clipper.prototype.BuildIntersectList=function(e){if(null!==this.m_ActiveEdges){var g=this.m_ActiveEdges;for(this.m_SortedEdges=g;null!==g;)g.PrevInSEL=g.PrevInAEL,g.NextInSEL=g.NextInAEL,g.Curr.X=r.Clipper.TopX(g,e),g=g.NextInAEL;for(var l=!0;l&&null!==this.m_SortedEdges;){l=
!1;for(g=this.m_SortedEdges;null!==g.NextInSEL;){e=g.NextInSEL;var q=new r.IntPoint;g.Curr.X>e.Curr.X?(this.IntersectPoint(g,e,q),l=new r.IntersectNode,l.Edge1=g,l.Edge2=e,l.Pt.X=q.X,l.Pt.Y=q.Y,r.use_xyz&&(l.Pt.Z=q.Z),this.m_IntersectList.push(l),this.SwapPositionsInSEL(g,e),l=!0):g=e}if(null!==g.PrevInSEL)g.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null}};r.Clipper.prototype.EdgesAdjacent=function(e){return e.Edge1.NextInSEL==e.Edge2||e.Edge1.PrevInSEL==e.Edge2};r.Clipper.IntersectNodeSort=
function(e,g){return g.Pt.Y-e.Pt.Y};r.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer);this.CopyAELToSEL();for(var e=this.m_IntersectList.length,g=0;g<e;g++){if(!this.EdgesAdjacent(this.m_IntersectList[g])){for(var l=g+1;l<e&&!this.EdgesAdjacent(this.m_IntersectList[l]);)l++;if(l==e)return!1;var q=this.m_IntersectList[g];this.m_IntersectList[g]=this.m_IntersectList[l];this.m_IntersectList[l]=q}this.SwapPositionsInSEL(this.m_IntersectList[g].Edge1,
this.m_IntersectList[g].Edge2)}return!0};r.Clipper.prototype.ProcessIntersectList=function(){for(var e=0,g=this.m_IntersectList.length;e<g;e++){var l=this.m_IntersectList[e];this.IntersectEdges(l.Edge1,l.Edge2,l.Pt);this.SwapPositionsInAEL(l.Edge1,l.Edge2)}this.m_IntersectList.length=0};S=function(e){return 0>e?Math.ceil(e-.5):Math.round(e)};Ea=function(e){return 0>e?Math.ceil(e-.5):Math.floor(e+.5)};Db=function(e){return 0>e?-Math.round(Math.abs(e)):Math.round(e)};Mb=function(e){if(0>e)return e-=
.5,-2147483648>e?Math.ceil(e):e|0;e+=.5;return 2147483647<e?Math.floor(e):e|0};r.Clipper.Round=kb?S:Ya?Db:ua?Mb:Ea;r.Clipper.TopX=function(e,g){return g==e.Top.Y?e.Top.X:e.Bot.X+r.Clipper.Round(e.Dx*(g-e.Bot.Y))};r.Clipper.prototype.IntersectPoint=function(e,g,l){l.X=0;l.Y=0;var q,z;if(e.Dx==g.Dx)l.Y=e.Curr.Y,l.X=r.Clipper.TopX(e,l.Y);else{if(0===e.Delta.X)l.X=e.Bot.X,r.ClipperBase.IsHorizontal(g)?l.Y=g.Bot.Y:(z=g.Bot.Y-g.Bot.X/g.Dx,l.Y=r.Clipper.Round(l.X/g.Dx+z));else if(0===g.Delta.X)l.X=g.Bot.X,
r.ClipperBase.IsHorizontal(e)?l.Y=e.Bot.Y:(q=e.Bot.Y-e.Bot.X/e.Dx,l.Y=r.Clipper.Round(l.X/e.Dx+q));else{q=e.Bot.X-e.Bot.Y*e.Dx;z=g.Bot.X-g.Bot.Y*g.Dx;var D=(z-q)/(e.Dx-g.Dx);l.Y=r.Clipper.Round(D);l.X=Math.abs(e.Dx)<Math.abs(g.Dx)?r.Clipper.Round(e.Dx*D+q):r.Clipper.Round(g.Dx*D+z)}if(l.Y<e.Top.Y||l.Y<g.Top.Y){if(e.Top.Y>g.Top.Y)return l.Y=e.Top.Y,l.X=r.Clipper.TopX(g,e.Top.Y),l.X<e.Top.X;l.Y=g.Top.Y;l.X=Math.abs(e.Dx)<Math.abs(g.Dx)?r.Clipper.TopX(e,l.Y):r.Clipper.TopX(g,l.Y)}l.Y>e.Curr.Y&&(l.Y=
e.Curr.Y,l.X=Math.abs(e.Dx)>Math.abs(g.Dx)?r.Clipper.TopX(g,l.Y):r.Clipper.TopX(e,l.Y))}};r.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(e){for(var g=this.m_ActiveEdges;null!==g;){var l=this.IsMaxima(g,e);l&&(l=this.GetMaximaPair(g),l=null===l||!r.ClipperBase.IsHorizontal(l));if(l){var q=g.PrevInAEL;this.DoMaxima(g);g=null===q?this.m_ActiveEdges:q.NextInAEL}else{this.IsIntermediate(g,e)&&r.ClipperBase.IsHorizontal(g.NextInLML)?(g=this.UpdateEdgeIntoAEL(g),0<=g.OutIdx&&this.AddOutPt(g,g.Bot),
this.AddEdgeToSEL(g)):(g.Curr.X=r.Clipper.TopX(g,e),g.Curr.Y=e);if(this.StrictlySimple&&(q=g.PrevInAEL,0<=g.OutIdx&&0!==g.WindDelta&&null!==q&&0<=q.OutIdx&&q.Curr.X==g.Curr.X&&0!==q.WindDelta)){var z=new r.IntPoint(g.Curr);r.use_xyz&&this.SetZ(z,q,g);l=this.AddOutPt(q,z);q=this.AddOutPt(g,z);this.AddJoin(l,q,z)}g=g.NextInAEL}}this.ProcessHorizontals(!0);for(g=this.m_ActiveEdges;null!==g;)this.IsIntermediate(g,e)&&(l=null,0<=g.OutIdx&&(l=this.AddOutPt(g,g.Top)),g=this.UpdateEdgeIntoAEL(g),q=g.PrevInAEL,
z=g.NextInAEL,null!==q&&q.Curr.X==g.Bot.X&&q.Curr.Y==g.Bot.Y&&null!==l&&0<=q.OutIdx&&q.Curr.Y>q.Top.Y&&r.ClipperBase.SlopesEqual(g,q,this.m_UseFullRange)&&0!==g.WindDelta&&0!==q.WindDelta?(q=this.AddOutPt(q,g.Bot),this.AddJoin(l,q,g.Top)):null!==z&&z.Curr.X==g.Bot.X&&z.Curr.Y==g.Bot.Y&&null!==l&&0<=z.OutIdx&&z.Curr.Y>z.Top.Y&&r.ClipperBase.SlopesEqual(g,z,this.m_UseFullRange)&&0!==g.WindDelta&&0!==z.WindDelta&&(q=this.AddOutPt(z,g.Bot),this.AddJoin(l,q,g.Top))),g=g.NextInAEL};r.Clipper.prototype.DoMaxima=
function(e){var g=this.GetMaximaPair(e);if(null===g)0<=e.OutIdx&&this.AddOutPt(e,e.Top),this.DeleteFromAEL(e);else{for(var l=e.NextInAEL;null!==l&&l!=g;)this.IntersectEdges(e,l,e.Top),this.SwapPositionsInAEL(e,l),l=e.NextInAEL;-1==e.OutIdx&&-1==g.OutIdx?(this.DeleteFromAEL(e),this.DeleteFromAEL(g)):0<=e.OutIdx&&0<=g.OutIdx?(0<=e.OutIdx&&this.AddLocalMaxPoly(e,g,e.Top),this.DeleteFromAEL(e),this.DeleteFromAEL(g)):r.use_lines&&0===e.WindDelta?(0<=e.OutIdx&&(this.AddOutPt(e,e.Top),e.OutIdx=-1),this.DeleteFromAEL(e),
0<=g.OutIdx&&(this.AddOutPt(g,e.Top),g.OutIdx=-1),this.DeleteFromAEL(g)):r.Error("DoMaxima error")}};r.Clipper.ReversePaths=function(e){for(var g=0,l=e.length;g<l;g++)e[g].reverse()};r.Clipper.Orientation=function(e){return 0<=r.Clipper.Area(e)};r.Clipper.prototype.PointCount=function(e){if(null===e)return 0;var g=0,l=e;do g++,l=l.Next;while(l!=e);return g};r.Clipper.prototype.BuildResult=function(e){r.Clear(e);for(var g=0,l=this.m_PolyOuts.length;g<l;g++){var q=this.m_PolyOuts[g];if(null!==q.Pts){q=
q.Pts.Prev;var z=this.PointCount(q);if(!(2>z)){for(var D=Array(z),I=0;I<z;I++)D[I]=q.Pt,q=q.Prev;e.push(D)}}}};r.Clipper.prototype.BuildResult2=function(e){e.Clear();for(var g=0,l=this.m_PolyOuts.length;g<l;g++){var q=this.m_PolyOuts[g],z=this.PointCount(q.Pts);if(!(q.IsOpen&&2>z||!q.IsOpen&&3>z)){this.FixHoleLinkage(q);var D=new r.PolyNode;e.m_AllPolys.push(D);q.PolyNode=D;D.m_polygon.length=z;q=q.Pts.Prev;for(var I=0;I<z;I++)D.m_polygon[I]=q.Pt,q=q.Prev}}g=0;for(l=this.m_PolyOuts.length;g<l;g++)q=
this.m_PolyOuts[g],null!==q.PolyNode&&(q.IsOpen?(q.PolyNode.IsOpen=!0,e.AddChild(q.PolyNode)):null!==q.FirstLeft&&null!=q.FirstLeft.PolyNode?q.FirstLeft.PolyNode.AddChild(q.PolyNode):e.AddChild(q.PolyNode))};r.Clipper.prototype.FixupOutPolygon=function(e){var g=null;e.BottomPt=null;for(var l=e.Pts;;){if(l.Prev==l||l.Prev==l.Next){e.Pts=null;return}if(r.IntPoint.op_Equality(l.Pt,l.Next.Pt)||r.IntPoint.op_Equality(l.Pt,l.Prev.Pt)||r.ClipperBase.SlopesEqual(l.Prev.Pt,l.Pt,l.Next.Pt,this.m_UseFullRange)&&
(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(l.Prev.Pt,l.Pt,l.Next.Pt)))g=null,l.Prev.Next=l.Next,l=l.Next.Prev=l.Prev;else if(l==g)break;else null===g&&(g=l),l=l.Next}e.Pts=l};r.Clipper.prototype.DupOutPt=function(e,g){var l=new r.OutPt;l.Pt.X=e.Pt.X;l.Pt.Y=e.Pt.Y;r.use_xyz&&(l.Pt.Z=e.Pt.Z);l.Idx=e.Idx;g?(l.Next=e.Next,l.Prev=e,e.Next.Prev=l,e.Next=l):(l.Prev=e.Prev,l.Next=e,e.Prev.Next=l,e.Prev=l);return l};r.Clipper.prototype.GetOverlap=function(e,g,l,q,z){e<g?l<q?(z.Left=Math.max(e,l),
z.Right=Math.min(g,q)):(z.Left=Math.max(e,q),z.Right=Math.min(g,l)):l<q?(z.Left=Math.max(g,l),z.Right=Math.min(e,q)):(z.Left=Math.max(g,q),z.Right=Math.min(e,l));return z.Left<z.Right};r.Clipper.prototype.JoinHorz=function(e,g,l,q,z,D){var I=e.Pt.X>g.Pt.X?r.Direction.dRightToLeft:r.Direction.dLeftToRight;q=l.Pt.X>q.Pt.X?r.Direction.dRightToLeft:r.Direction.dLeftToRight;if(I==q)return!1;if(I==r.Direction.dLeftToRight){for(;e.Next.Pt.X<=z.X&&e.Next.Pt.X>=e.Pt.X&&e.Next.Pt.Y==z.Y;)e=e.Next;D&&e.Pt.X!=
z.X&&(e=e.Next);g=this.DupOutPt(e,!D);r.IntPoint.op_Inequality(g.Pt,z)&&(e=g,e.Pt.X=z.X,e.Pt.Y=z.Y,r.use_xyz&&(e.Pt.Z=z.Z),g=this.DupOutPt(e,!D))}else{for(;e.Next.Pt.X>=z.X&&e.Next.Pt.X<=e.Pt.X&&e.Next.Pt.Y==z.Y;)e=e.Next;D||e.Pt.X==z.X||(e=e.Next);g=this.DupOutPt(e,D);r.IntPoint.op_Inequality(g.Pt,z)&&(e=g,e.Pt.X=z.X,e.Pt.Y=z.Y,r.use_xyz&&(e.Pt.Z=z.Z),g=this.DupOutPt(e,D))}if(q==r.Direction.dLeftToRight){for(;l.Next.Pt.X<=z.X&&l.Next.Pt.X>=l.Pt.X&&l.Next.Pt.Y==z.Y;)l=l.Next;D&&l.Pt.X!=z.X&&(l=l.Next);
q=this.DupOutPt(l,!D);r.IntPoint.op_Inequality(q.Pt,z)&&(l=q,l.Pt.X=z.X,l.Pt.Y=z.Y,r.use_xyz&&(l.Pt.Z=z.Z),q=this.DupOutPt(l,!D))}else{for(;l.Next.Pt.X>=z.X&&l.Next.Pt.X<=l.Pt.X&&l.Next.Pt.Y==z.Y;)l=l.Next;D||l.Pt.X==z.X||(l=l.Next);q=this.DupOutPt(l,D);r.IntPoint.op_Inequality(q.Pt,z)&&(l=q,l.Pt.X=z.X,l.Pt.Y=z.Y,r.use_xyz&&(l.Pt.Z=z.Z),q=this.DupOutPt(l,D))}I==r.Direction.dLeftToRight==D?(e.Prev=l,l.Next=e,g.Next=q,q.Prev=g):(e.Next=l,l.Prev=e,g.Prev=q,q.Next=g);return!0};r.Clipper.prototype.JoinPoints=
function(e,g,l){var q=e.OutPt1,z;new r.OutPt;var D=e.OutPt2,I;new r.OutPt;if((I=e.OutPt1.Pt.Y==e.OffPt.Y)&&r.IntPoint.op_Equality(e.OffPt,e.OutPt1.Pt)&&r.IntPoint.op_Equality(e.OffPt,e.OutPt2.Pt)){if(g!=l)return!1;for(z=e.OutPt1.Next;z!=q&&r.IntPoint.op_Equality(z.Pt,e.OffPt);)z=z.Next;z=z.Pt.Y>e.OffPt.Y;for(I=e.OutPt2.Next;I!=D&&r.IntPoint.op_Equality(I.Pt,e.OffPt);)I=I.Next;if(z==I.Pt.Y>e.OffPt.Y)return!1;z?(z=this.DupOutPt(q,!1),I=this.DupOutPt(D,!0),q.Prev=D,D.Next=q,z.Next=I,I.Prev=z):(z=this.DupOutPt(q,
!0),I=this.DupOutPt(D,!1),q.Next=D,D.Prev=q,z.Prev=I,I.Next=z);e.OutPt1=q;e.OutPt2=z;return!0}if(I){for(z=q;q.Prev.Pt.Y==q.Pt.Y&&q.Prev!=z&&q.Prev!=D;)q=q.Prev;for(;z.Next.Pt.Y==z.Pt.Y&&z.Next!=q&&z.Next!=D;)z=z.Next;if(z.Next==q||z.Next==D)return!1;for(I=D;D.Prev.Pt.Y==D.Pt.Y&&D.Prev!=I&&D.Prev!=z;)D=D.Prev;for(;I.Next.Pt.Y==I.Pt.Y&&I.Next!=D&&I.Next!=q;)I=I.Next;if(I.Next==D||I.Next==q)return!1;l={Left:null,Right:null};if(!this.GetOverlap(q.Pt.X,z.Pt.X,D.Pt.X,I.Pt.X,l))return!1;g=l.Left;var W=l.Right;
l=new r.IntPoint;q.Pt.X>=g&&q.Pt.X<=W?(l.X=q.Pt.X,l.Y=q.Pt.Y,r.use_xyz&&(l.Z=q.Pt.Z),g=q.Pt.X>z.Pt.X):D.Pt.X>=g&&D.Pt.X<=W?(l.X=D.Pt.X,l.Y=D.Pt.Y,r.use_xyz&&(l.Z=D.Pt.Z),g=D.Pt.X>I.Pt.X):z.Pt.X>=g&&z.Pt.X<=W?(l.X=z.Pt.X,l.Y=z.Pt.Y,r.use_xyz&&(l.Z=z.Pt.Z),g=z.Pt.X>q.Pt.X):(l.X=I.Pt.X,l.Y=I.Pt.Y,r.use_xyz&&(l.Z=I.Pt.Z),g=I.Pt.X>D.Pt.X);e.OutPt1=q;e.OutPt2=D;return this.JoinHorz(q,z,D,I,l,g)}for(z=q.Next;r.IntPoint.op_Equality(z.Pt,q.Pt)&&z!=q;)z=z.Next;if(W=z.Pt.Y>q.Pt.Y||!r.ClipperBase.SlopesEqual(q.Pt,
z.Pt,e.OffPt,this.m_UseFullRange)){for(z=q.Prev;r.IntPoint.op_Equality(z.Pt,q.Pt)&&z!=q;)z=z.Prev;if(z.Pt.Y>q.Pt.Y||!r.ClipperBase.SlopesEqual(q.Pt,z.Pt,e.OffPt,this.m_UseFullRange))return!1}for(I=D.Next;r.IntPoint.op_Equality(I.Pt,D.Pt)&&I!=D;)I=I.Next;var da=I.Pt.Y>D.Pt.Y||!r.ClipperBase.SlopesEqual(D.Pt,I.Pt,e.OffPt,this.m_UseFullRange);if(da){for(I=D.Prev;r.IntPoint.op_Equality(I.Pt,D.Pt)&&I!=D;)I=I.Prev;if(I.Pt.Y>D.Pt.Y||!r.ClipperBase.SlopesEqual(D.Pt,I.Pt,e.OffPt,this.m_UseFullRange))return!1}if(z==
q||I==D||z==I||g==l&&W==da)return!1;W?(z=this.DupOutPt(q,!1),I=this.DupOutPt(D,!0),q.Prev=D,D.Next=q,z.Next=I,I.Prev=z):(z=this.DupOutPt(q,!0),I=this.DupOutPt(D,!1),q.Next=D,D.Prev=q,z.Prev=I,I.Next=z);e.OutPt1=q;e.OutPt2=z;return!0};r.Clipper.GetBounds=function(e){for(var g=0,l=e.length;g<l&&0==e[g].length;)g++;if(g==l)return new r.IntRect(0,0,0,0);var q=new r.IntRect;q.left=e[g][0].X;q.right=q.left;q.top=e[g][0].Y;for(q.bottom=q.top;g<l;g++)for(var z=0,D=e[g].length;z<D;z++)e[g][z].X<q.left?q.left=
e[g][z].X:e[g][z].X>q.right&&(q.right=e[g][z].X),e[g][z].Y<q.top?q.top=e[g][z].Y:e[g][z].Y>q.bottom&&(q.bottom=e[g][z].Y);return q};r.Clipper.prototype.GetBounds2=function(e){var g=e,l=new r.IntRect;l.left=e.Pt.X;l.right=e.Pt.X;l.top=e.Pt.Y;l.bottom=e.Pt.Y;for(e=e.Next;e!=g;)e.Pt.X<l.left&&(l.left=e.Pt.X),e.Pt.X>l.right&&(l.right=e.Pt.X),e.Pt.Y<l.top&&(l.top=e.Pt.Y),e.Pt.Y>l.bottom&&(l.bottom=e.Pt.Y),e=e.Next;return l};r.Clipper.PointInPolygon=function(e,g){var l=0,q=g.length;if(3>q)return 0;for(var z=
g[0],D=1;D<=q;++D){var I=D==q?g[0]:g[D];if(I.Y==e.Y&&(I.X==e.X||z.Y==e.Y&&I.X>e.X==z.X<e.X))return-1;if(z.Y<e.Y!=I.Y<e.Y)if(z.X>=e.X)if(I.X>e.X)l=1-l;else{var W=(z.X-e.X)*(I.Y-e.Y)-(I.X-e.X)*(z.Y-e.Y);if(0==W)return-1;0<W==I.Y>z.Y&&(l=1-l)}else if(I.X>e.X){W=(z.X-e.X)*(I.Y-e.Y)-(I.X-e.X)*(z.Y-e.Y);if(0==W)return-1;0<W==I.Y>z.Y&&(l=1-l)}z=I}return l};r.Clipper.prototype.PointInPolygon=function(e,g){var l=0,q=g,z=e.X;e=e.Y;var D=g.Pt.X,I=g.Pt.Y;do{g=g.Next;var W=g.Pt.X,da=g.Pt.Y;if(da==e&&(W==z||I==
e&&W>z==D<z))return-1;if(I<e!=da<e)if(D>=z)if(W>z)l=1-l;else{D=(D-z)*(da-e)-(W-z)*(I-e);if(0==D)return-1;0<D==da>I&&(l=1-l)}else if(W>z){D=(D-z)*(da-e)-(W-z)*(I-e);if(0==D)return-1;0<D==da>I&&(l=1-l)}D=W;I=da}while(q!=g);return l};r.Clipper.prototype.Poly2ContainsPoly1=function(e,g){var l=e;do{var q=this.PointInPolygon(l.Pt,g);if(0<=q)return 0<q;l=l.Next}while(l!=e);return!0};r.Clipper.prototype.FixupFirstLefts1=function(e,g){for(var l=0,q=this.m_PolyOuts.length;l<q;l++){var z=this.m_PolyOuts[l];
null!=z.Pts&&null!=z.FirstLeft&&this.ParseFirstLeft(z.FirstLeft)==e&&this.Poly2ContainsPoly1(z.Pts,g.Pts)&&(z.FirstLeft=g)}};r.Clipper.prototype.FixupFirstLefts2=function(e,g){for(var l=0,q=this.m_PolyOuts,z=q.length,D=q[l];l<z;l++,D=q[l])D.FirstLeft==e&&(D.FirstLeft=g)};r.Clipper.ParseFirstLeft=function(e){for(;null!=e&&null==e.Pts;)e=e.FirstLeft;return e};r.Clipper.prototype.JoinCommonEdges=function(){for(var e=0,g=this.m_Joins.length;e<g;e++){var l=this.m_Joins[e],q=this.GetOutRec(l.OutPt1.Idx),
z=this.GetOutRec(l.OutPt2.Idx);if(null!=q.Pts&&null!=z.Pts){var D=q==z?q:this.Param1RightOfParam2(q,z)?z:this.Param1RightOfParam2(z,q)?q:this.GetLowermostRec(q,z);if(this.JoinPoints(l,q,z))if(q==z){q.Pts=l.OutPt1;q.BottomPt=null;z=this.CreateOutRec();z.Pts=l.OutPt2;this.UpdateOutPtIdxs(z);if(this.m_UsingPolyTree){D=0;for(var I=this.m_PolyOuts.length;D<I-1;D++){var W=this.m_PolyOuts[D];null!=W.Pts&&r.Clipper.ParseFirstLeft(W.FirstLeft)==q&&W.IsHole!=q.IsHole&&this.Poly2ContainsPoly1(W.Pts,l.OutPt2)&&
(W.FirstLeft=z)}}this.Poly2ContainsPoly1(z.Pts,q.Pts)?(z.IsHole=!q.IsHole,z.FirstLeft=q,this.m_UsingPolyTree&&this.FixupFirstLefts2(z,q),(z.IsHole^this.ReverseSolution)==0<this.Area(z)&&this.ReversePolyPtLinks(z.Pts)):this.Poly2ContainsPoly1(q.Pts,z.Pts)?(z.IsHole=q.IsHole,q.IsHole=!z.IsHole,z.FirstLeft=q.FirstLeft,q.FirstLeft=z,this.m_UsingPolyTree&&this.FixupFirstLefts2(q,z),(q.IsHole^this.ReverseSolution)==0<this.Area(q)&&this.ReversePolyPtLinks(q.Pts)):(z.IsHole=q.IsHole,z.FirstLeft=q.FirstLeft,
this.m_UsingPolyTree&&this.FixupFirstLefts1(q,z))}else z.Pts=null,z.BottomPt=null,z.Idx=q.Idx,q.IsHole=D.IsHole,D==z&&(q.FirstLeft=z.FirstLeft),z.FirstLeft=q,this.m_UsingPolyTree&&this.FixupFirstLefts2(z,q)}}};r.Clipper.prototype.UpdateOutPtIdxs=function(e){var g=e.Pts;do g.Idx=e.Idx,g=g.Prev;while(g!=e.Pts)};r.Clipper.prototype.DoSimplePolygons=function(){for(var e=0;e<this.m_PolyOuts.length;){var g=this.m_PolyOuts[e++],l=g.Pts;if(null!=l&&!g.IsOpen){do{for(var q=l.Next;q!=g.Pts;){if(r.IntPoint.op_Equality(l.Pt,
q.Pt)&&q.Next!=l&&q.Prev!=l){var z=l.Prev,D=q.Prev;l.Prev=D;D.Next=l;q.Prev=z;z.Next=q;g.Pts=l;z=this.CreateOutRec();z.Pts=q;this.UpdateOutPtIdxs(z);this.Poly2ContainsPoly1(z.Pts,g.Pts)?(z.IsHole=!g.IsHole,z.FirstLeft=g,this.m_UsingPolyTree&&this.FixupFirstLefts2(z,g)):this.Poly2ContainsPoly1(g.Pts,z.Pts)?(z.IsHole=g.IsHole,g.IsHole=!z.IsHole,z.FirstLeft=g.FirstLeft,g.FirstLeft=z,this.m_UsingPolyTree&&this.FixupFirstLefts2(g,z)):(z.IsHole=g.IsHole,z.FirstLeft=g.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(g,
z));q=l}q=q.Next}l=l.Next}while(l!=g.Pts)}}};r.Clipper.Area=function(e){var g=e.length;if(3>g)return 0;for(var l=0,q=0,z=g-1;q<g;++q)l+=(e[z].X+e[q].X)*(e[z].Y-e[q].Y),z=q;return.5*-l};r.Clipper.prototype.Area=function(e){var g=e.Pts;if(null==g)return 0;var l=0;do l+=(g.Prev.Pt.X+g.Pt.X)*(g.Prev.Pt.Y-g.Pt.Y),g=g.Next;while(g!=e.Pts);return.5*l};r.Clipper.SimplifyPolygon=function(e,g){var l=[],q=new r.Clipper(0);q.StrictlySimple=!0;q.AddPath(e,r.PolyType.ptSubject,!0);q.Execute(r.ClipType.ctUnion,
l,g,g);return l};r.Clipper.SimplifyPolygons=function(e,g){"undefined"==typeof g&&(g=r.PolyFillType.pftEvenOdd);var l=[],q=new r.Clipper(0);q.StrictlySimple=!0;q.AddPaths(e,r.PolyType.ptSubject,!0);q.Execute(r.ClipType.ctUnion,l,g,g);return l};r.Clipper.DistanceSqrd=function(e,g){var l=e.X-g.X;e=e.Y-g.Y;return l*l+e*e};r.Clipper.DistanceFromLineSqrd=function(e,g,l){var q=g.Y-l.Y;l=l.X-g.X;g=q*g.X+l*g.Y;g=q*e.X+l*e.Y-g;return g*g/(q*q+l*l)};r.Clipper.SlopesNearCollinear=function(e,g,l,q){return Math.abs(e.X-
g.X)>Math.abs(e.Y-g.Y)?e.X>g.X==e.X<l.X?r.Clipper.DistanceFromLineSqrd(e,g,l)<q:g.X>e.X==g.X<l.X?r.Clipper.DistanceFromLineSqrd(g,e,l)<q:r.Clipper.DistanceFromLineSqrd(l,e,g)<q:e.Y>g.Y==e.Y<l.Y?r.Clipper.DistanceFromLineSqrd(e,g,l)<q:g.Y>e.Y==g.Y<l.Y?r.Clipper.DistanceFromLineSqrd(g,e,l)<q:r.Clipper.DistanceFromLineSqrd(l,e,g)<q};r.Clipper.PointsAreClose=function(e,g,l){var q=e.X-g.X;e=e.Y-g.Y;return q*q+e*e<=l};r.Clipper.ExcludeOp=function(e){var g=e.Prev;g.Next=e.Next;e.Next.Prev=g;g.Idx=0;return g};
r.Clipper.CleanPolygon=function(e,g){"undefined"==typeof g&&(g=1.415);var l=e.length;if(0==l)return[];for(var q=Array(l),z=0;z<l;++z)q[z]=new r.OutPt;for(z=0;z<l;++z)q[z].Pt=e[z],q[z].Next=q[(z+1)%l],q[z].Next.Prev=q[z],q[z].Idx=0;z=g*g;for(q=q[0];0==q.Idx&&q.Next!=q.Prev;)r.Clipper.PointsAreClose(q.Pt,q.Prev.Pt,z)?(q=r.Clipper.ExcludeOp(q),l--):r.Clipper.PointsAreClose(q.Prev.Pt,q.Next.Pt,z)?(r.Clipper.ExcludeOp(q.Next),q=r.Clipper.ExcludeOp(q),l-=2):r.Clipper.SlopesNearCollinear(q.Prev.Pt,q.Pt,
q.Next.Pt,z)?(q=r.Clipper.ExcludeOp(q),l--):(q.Idx=1,q=q.Next);3>l&&(l=0);e=Array(l);for(z=0;z<l;++z)e[z]=new r.IntPoint(q.Pt),q=q.Next;return e};r.Clipper.CleanPolygons=function(e,g){for(var l=Array(e.length),q=0,z=e.length;q<z;q++)l[q]=r.Clipper.CleanPolygon(e[q],g);return l};r.Clipper.Minkowski=function(e,g,l,q){q=q?1:0;var z=e.length,D=g.length,I=[];if(l)for(l=0;l<D;l++){for(var W=Array(z),da=0,ha=e.length,fa=e[da];da<ha;da++,fa=e[da])W[da]=new r.IntPoint(g[l].X+fa.X,g[l].Y+fa.Y);I.push(W)}else for(l=
0;l<D;l++){W=Array(z);da=0;ha=e.length;for(fa=e[da];da<ha;da++,fa=e[da])W[da]=new r.IntPoint(g[l].X-fa.X,g[l].Y-fa.Y);I.push(W)}e=[];for(l=0;l<D-1+q;l++)for(da=0;da<z;da++)g=[],g.push(I[l%D][da%z]),g.push(I[(l+1)%D][da%z]),g.push(I[(l+1)%D][(da+1)%z]),g.push(I[l%D][(da+1)%z]),r.Clipper.Orientation(g)||g.reverse(),e.push(g);return e};r.Clipper.MinkowskiSum=function(e,g,l){if(g[0]instanceof Array){I=g;g=new r.Paths;for(var q=new r.Clipper,z=0;z<I.length;++z){var D=r.Clipper.Minkowski(e,I[z],!0,l);q.AddPaths(D,
r.PolyType.ptSubject,!0);l&&(D=r.Clipper.TranslatePath(I[z],e[0]),q.AddPath(D,r.PolyType.ptClip,!0))}q.Execute(r.ClipType.ctUnion,g,r.PolyFillType.pftNonZero,r.PolyFillType.pftNonZero);return g}var I=r.Clipper.Minkowski(e,g,!0,l);q=new r.Clipper;q.AddPaths(I,r.PolyType.ptSubject,!0);q.Execute(r.ClipType.ctUnion,I,r.PolyFillType.pftNonZero,r.PolyFillType.pftNonZero);return I};r.Clipper.TranslatePath=function(e,g){for(var l=new r.Path,q=0;q<e.length;q++)l.push(new r.IntPoint(e[q].X+g.X,e[q].Y+g.Y));
return l};r.Clipper.MinkowskiDiff=function(e,g){e=r.Clipper.Minkowski(e,g,!1,!0);g=new r.Clipper;g.AddPaths(e,r.PolyType.ptSubject,!0);g.Execute(r.ClipType.ctUnion,e,r.PolyFillType.pftNonZero,r.PolyFillType.pftNonZero);return e};r.Clipper.PolyTreeToPaths=function(e){var g=[];r.Clipper.AddPolyNodeToPaths(e,r.Clipper.NodeType.ntAny,g);return g};r.Clipper.AddPolyNodeToPaths=function(e,g,l){var q=!0;switch(g){case r.Clipper.NodeType.ntOpen:return;case r.Clipper.NodeType.ntClosed:q=!e.IsOpen}0<e.m_polygon.length&&
q&&l.push(e.m_polygon);q=0;e=e.Childs();for(var z=e.length,D=e[q];q<z;q++,D=e[q])r.Clipper.AddPolyNodeToPaths(D,g,l)};r.Clipper.OpenPathsFromPolyTree=function(e){for(var g=new r.Paths,l=0,q=e.ChildCount();l<q;l++)e.Childs()[l].IsOpen&&g.push(e.Childs()[l].m_polygon);return g};r.Clipper.ClosedPathsFromPolyTree=function(e){var g=new r.Paths;r.Clipper.AddPolyNodeToPaths(e,r.Clipper.NodeType.ntClosed,g);return g};gb(r.Clipper,r.ClipperBase);r.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2};r.ClipperOffset=
function(e,g){"undefined"==typeof e&&(e=2);"undefined"==typeof g&&(g=r.ClipperOffset.def_arc_tolerance);this.m_destPolys=new r.Paths;this.m_srcPoly=new r.Path;this.m_destPoly=new r.Path;this.m_normals=[];this.m_StepsPerRad=this.m_miterLim=this.m_cos=this.m_sin=this.m_sinA=this.m_delta=0;this.m_lowest=new r.IntPoint;this.m_polyNodes=new r.PolyNode;this.MiterLimit=e;this.ArcTolerance=g;this.m_lowest.X=-1};r.ClipperOffset.two_pi=6.28318530717959;r.ClipperOffset.def_arc_tolerance=.25;r.ClipperOffset.prototype.Clear=
function(){r.Clear(this.m_polyNodes.Childs());this.m_lowest.X=-1};r.ClipperOffset.Round=r.Clipper.Round;r.ClipperOffset.prototype.AddPath=function(e,g,l){var q=e.length-1;if(!(0>q)){var z=new r.PolyNode;z.m_jointype=g;z.m_endtype=l;if(l==r.EndType.etClosedLine||l==r.EndType.etClosedPolygon)for(;0<q&&r.IntPoint.op_Equality(e[0],e[q]);)q--;z.m_polygon.push(e[0]);var D=0;g=0;for(var I=1;I<=q;I++)r.IntPoint.op_Inequality(z.m_polygon[D],e[I])&&(D++,z.m_polygon.push(e[I]),e[I].Y>z.m_polygon[g].Y||e[I].Y==
z.m_polygon[g].Y&&e[I].X<z.m_polygon[g].X)&&(g=D);if(!(l==r.EndType.etClosedPolygon&&2>D)&&(this.m_polyNodes.AddChild(z),l==r.EndType.etClosedPolygon))if(0>this.m_lowest.X)this.m_lowest=new r.IntPoint(this.m_polyNodes.ChildCount()-1,g);else if(e=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y],z.m_polygon[g].Y>e.Y||z.m_polygon[g].Y==e.Y&&z.m_polygon[g].X<e.X)this.m_lowest=new r.IntPoint(this.m_polyNodes.ChildCount()-1,g)}};r.ClipperOffset.prototype.AddPaths=function(e,g,l){for(var q=
0,z=e.length;q<z;q++)this.AddPath(e[q],g,l)};r.ClipperOffset.prototype.FixOrientations=function(){if(0<=this.m_lowest.X&&!r.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var e=0;e<this.m_polyNodes.ChildCount();e++){var g=this.m_polyNodes.Childs()[e];(g.m_endtype==r.EndType.etClosedPolygon||g.m_endtype==r.EndType.etClosedLine&&r.Clipper.Orientation(g.m_polygon))&&g.m_polygon.reverse()}else for(e=0;e<this.m_polyNodes.ChildCount();e++)g=this.m_polyNodes.Childs()[e],g.m_endtype!=
r.EndType.etClosedLine||r.Clipper.Orientation(g.m_polygon)||g.m_polygon.reverse()};r.ClipperOffset.GetUnitNormal=function(e,g){var l=g.X-e.X;e=g.Y-e.Y;if(0==l&&0==e)return new r.DoublePoint(0,0);g=1/Math.sqrt(l*l+e*e);return new r.DoublePoint(e*g,-(l*g))};r.ClipperOffset.prototype.DoOffset=function(e){this.m_destPolys=[];this.m_delta=e;if(r.ClipperBase.near_zero(e))for(var g=0;g<this.m_polyNodes.ChildCount();g++){var l=this.m_polyNodes.Childs()[g];l.m_endtype==r.EndType.etClosedPolygon&&this.m_destPolys.push(l.m_polygon)}else{this.m_miterLim=
2<this.MiterLimit?2/(this.MiterLimit*this.MiterLimit):.5;var q=3.14159265358979/Math.acos(1-(0>=this.ArcTolerance?r.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(e)*r.ClipperOffset.def_arc_tolerance?Math.abs(e)*r.ClipperOffset.def_arc_tolerance:this.ArcTolerance)/Math.abs(e));this.m_sin=Math.sin(r.ClipperOffset.two_pi/q);this.m_cos=Math.cos(r.ClipperOffset.two_pi/q);this.m_StepsPerRad=q/r.ClipperOffset.two_pi;0>e&&(this.m_sin=-this.m_sin);for(g=0;g<this.m_polyNodes.ChildCount();g++){l=
this.m_polyNodes.Childs()[g];this.m_srcPoly=l.m_polygon;var z=this.m_srcPoly.length;if(!(0==z||0>=e&&(3>z||l.m_endtype!=r.EndType.etClosedPolygon))){this.m_destPoly=[];if(1==z)if(l.m_jointype==r.JoinType.jtRound){l=1;z=0;for(var D=1;D<=q;D++){this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X+l*e),r.ClipperOffset.Round(this.m_srcPoly[0].Y+z*e)));var I=l;l=l*this.m_cos-this.m_sin*z;z=I*this.m_sin+z*this.m_cos}}else for(z=l=-1,D=0;4>D;++D)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X+
l*e),r.ClipperOffset.Round(this.m_srcPoly[0].Y+z*e))),0>l?l=1:0>z?z=1:l=-1;else{for(D=this.m_normals.length=0;D<z-1;D++)this.m_normals.push(r.ClipperOffset.GetUnitNormal(this.m_srcPoly[D],this.m_srcPoly[D+1]));l.m_endtype==r.EndType.etClosedLine||l.m_endtype==r.EndType.etClosedPolygon?this.m_normals.push(r.ClipperOffset.GetUnitNormal(this.m_srcPoly[z-1],this.m_srcPoly[0])):this.m_normals.push(new r.DoublePoint(this.m_normals[z-2]));if(l.m_endtype==r.EndType.etClosedPolygon)for(I=z-1,D=0;D<z;D++)I=
this.OffsetPoint(D,I,l.m_jointype);else if(l.m_endtype==r.EndType.etClosedLine){I=z-1;for(D=0;D<z;D++)I=this.OffsetPoint(D,I,l.m_jointype);this.m_destPolys.push(this.m_destPoly);this.m_destPoly=[];I=this.m_normals[z-1];for(D=z-1;0<D;D--)this.m_normals[D]=new r.DoublePoint(-this.m_normals[D-1].X,-this.m_normals[D-1].Y);this.m_normals[0]=new r.DoublePoint(-I.X,-I.Y);I=0;for(D=z-1;0<=D;D--)I=this.OffsetPoint(D,I,l.m_jointype)}else{I=0;for(D=1;D<z-1;++D)I=this.OffsetPoint(D,I,l.m_jointype);l.m_endtype==
r.EndType.etOpenButt?(D=z-1,I=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[D].X+this.m_normals[D].X*e),r.ClipperOffset.Round(this.m_srcPoly[D].Y+this.m_normals[D].Y*e)),this.m_destPoly.push(I),I=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[D].X-this.m_normals[D].X*e),r.ClipperOffset.Round(this.m_srcPoly[D].Y-this.m_normals[D].Y*e)),this.m_destPoly.push(I)):(D=z-1,I=z-2,this.m_sinA=0,this.m_normals[D]=new r.DoublePoint(-this.m_normals[D].X,-this.m_normals[D].Y),l.m_endtype==r.EndType.etOpenSquare?
this.DoSquare(D,I):this.DoRound(D,I));for(D=z-1;0<D;D--)this.m_normals[D]=new r.DoublePoint(-this.m_normals[D-1].X,-this.m_normals[D-1].Y);this.m_normals[0]=new r.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y);I=z-1;for(D=I-1;0<D;--D)I=this.OffsetPoint(D,I,l.m_jointype);l.m_endtype==r.EndType.etOpenButt?(I=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*e),r.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*e)),this.m_destPoly.push(I),I=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X+
this.m_normals[0].X*e),r.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*e)),this.m_destPoly.push(I)):(this.m_sinA=0,l.m_endtype==r.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1))}}this.m_destPolys.push(this.m_destPoly)}}}};r.ClipperOffset.prototype.Execute=function(){var e=arguments;if(e[0]instanceof r.PolyTree)if(g=e[0],l=e[1],g.Clear(),this.FixOrientations(),this.DoOffset(l),e=new r.Clipper(0),e.AddPaths(this.m_destPolys,r.PolyType.ptSubject,!0),0<l)e.Execute(r.ClipType.ctUnion,
g,r.PolyFillType.pftPositive,r.PolyFillType.pftPositive);else if(l=r.Clipper.GetBounds(this.m_destPolys),q=new r.Path,q.push(new r.IntPoint(l.left-10,l.bottom+10)),q.push(new r.IntPoint(l.right+10,l.bottom+10)),q.push(new r.IntPoint(l.right+10,l.top-10)),q.push(new r.IntPoint(l.left-10,l.top-10)),e.AddPath(q,r.PolyType.ptSubject,!0),e.ReverseSolution=!0,e.Execute(r.ClipType.ctUnion,g,r.PolyFillType.pftNegative,r.PolyFillType.pftNegative),1==g.ChildCount()&&0<g.Childs()[0].ChildCount())for(e=g.Childs()[0],
g.Childs()[0]=e.Childs()[0],g.Childs()[0].m_Parent=g,l=1;l<e.ChildCount();l++)g.AddChild(e.Childs()[l]);else g.Clear();else{var g=e[0],l=e[1];r.Clear(g);this.FixOrientations();this.DoOffset(l);e=new r.Clipper(0);e.AddPaths(this.m_destPolys,r.PolyType.ptSubject,!0);if(0<l)e.Execute(r.ClipType.ctUnion,g,r.PolyFillType.pftPositive,r.PolyFillType.pftPositive);else{l=r.Clipper.GetBounds(this.m_destPolys);var q=new r.Path;q.push(new r.IntPoint(l.left-10,l.bottom+10));q.push(new r.IntPoint(l.right+10,l.bottom+
10));q.push(new r.IntPoint(l.right+10,l.top-10));q.push(new r.IntPoint(l.left-10,l.top-10));e.AddPath(q,r.PolyType.ptSubject,!0);e.ReverseSolution=!0;e.Execute(r.ClipType.ctUnion,g,r.PolyFillType.pftNegative,r.PolyFillType.pftNegative);0<g.length&&g.splice(0,1)}}};r.ClipperOffset.prototype.OffsetPoint=function(e,g,l){this.m_sinA=this.m_normals[g].X*this.m_normals[e].Y-this.m_normals[e].X*this.m_normals[g].Y;if(1>Math.abs(this.m_sinA*this.m_delta)){if(0<this.m_normals[g].X*this.m_normals[e].X+this.m_normals[e].Y*
this.m_normals[g].Y)return this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[g].X*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[g].Y*this.m_delta))),g}else 1<this.m_sinA?this.m_sinA=1:-1>this.m_sinA&&(this.m_sinA=-1);if(0>this.m_sinA*this.m_delta)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[g].X*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[g].Y*this.m_delta))),
this.m_destPoly.push(new r.IntPoint(this.m_srcPoly[e])),this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[e].X*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[e].Y*this.m_delta)));else switch(l){case r.JoinType.jtMiter:l=1+(this.m_normals[e].X*this.m_normals[g].X+this.m_normals[e].Y*this.m_normals[g].Y);l>=this.m_miterLim?this.DoMiter(e,g,l):this.DoSquare(e,g);break;case r.JoinType.jtSquare:this.DoSquare(e,g);break;case r.JoinType.jtRound:this.DoRound(e,
g)}return e};r.ClipperOffset.prototype.DoSquare=function(e,g){var l=Math.tan(Math.atan2(this.m_sinA,this.m_normals[g].X*this.m_normals[e].X+this.m_normals[g].Y*this.m_normals[e].Y)/4);this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_delta*(this.m_normals[g].X-this.m_normals[g].Y*l)),r.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_delta*(this.m_normals[g].Y+this.m_normals[g].X*l))));this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_delta*
(this.m_normals[e].X+this.m_normals[e].Y*l)),r.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_delta*(this.m_normals[e].Y-this.m_normals[e].X*l))))};r.ClipperOffset.prototype.DoMiter=function(e,g,l){l=this.m_delta/l;this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[e].X+(this.m_normals[g].X+this.m_normals[e].X)*l),r.ClipperOffset.Round(this.m_srcPoly[e].Y+(this.m_normals[g].Y+this.m_normals[e].Y)*l)))};r.ClipperOffset.prototype.DoRound=function(e,g){var l=Math.max(r.Cast_Int32(r.ClipperOffset.Round(this.m_StepsPerRad*
Math.abs(Math.atan2(this.m_sinA,this.m_normals[g].X*this.m_normals[e].X+this.m_normals[g].Y*this.m_normals[e].Y)))),1),q=this.m_normals[g].X;g=this.m_normals[g].Y;for(var z,D=0;D<l;++D)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[e].X+q*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[e].Y+g*this.m_delta))),z=q,q=q*this.m_cos-this.m_sin*g,g=z*this.m_sin+g*this.m_cos;this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[e].X*this.m_delta),
r.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[e].Y*this.m_delta)))};r.Error=function(e){try{throw Error(e);}catch(g){alert(g.message)}};r.JS={};r.JS.AreaOfPolygon=function(e,g){g||(g=1);return r.Clipper.Area(e)/(g*g)};r.JS.AreaOfPolygons=function(e,g){g||(g=1);for(var l=0,q=0;q<e.length;q++)l+=r.Clipper.Area(e[q]);return l/(g*g)};r.JS.BoundsOfPath=function(e,g){return r.JS.BoundsOfPaths([e],g)};r.JS.BoundsOfPaths=function(e,g){g||(g=1);e=r.Clipper.GetBounds(e);e.left/=g;e.bottom/=g;e.right/=
g;e.top/=g;return e};r.JS.Clean=function(e,g){if(!(e instanceof Array))return[];var l=e[0]instanceof Array;e=r.JS.Clone(e);if("number"!=typeof g||null===g)return r.Error("Delta is not a number in Clean()."),e;if(0===e.length||1==e.length&&0===e[0].length||0>g)return e;l||(e=[e]);for(var q=e.length,z,D,I,W,da,ha,fa,Wa=[],Ra=0;Ra<q;Ra++)if(D=e[Ra],z=D.length,0!==z)if(3>z)I=D,Wa.push(I);else{I=D;W=g*g;da=D[0];for(fa=ha=1;fa<z;fa++)(D[fa].X-da.X)*(D[fa].X-da.X)+(D[fa].Y-da.Y)*(D[fa].Y-da.Y)<=W||(I[ha]=
D[fa],da=D[fa],ha++);da=D[ha-1];(D[0].X-da.X)*(D[0].X-da.X)+(D[0].Y-da.Y)*(D[0].Y-da.Y)<=W&&ha--;ha<z&&I.splice(ha,z-ha);I.length&&Wa.push(I)}!l&&Wa.length?Wa=Wa[0]:l||0!==Wa.length?l&&0===Wa.length&&(Wa=[[]]):Wa=[];return Wa};r.JS.Clone=function(e){if(!(e instanceof Array)||0===e.length)return[];if(1==e.length&&0===e[0].length)return[[]];var g=e[0]instanceof Array;g||(e=[e]);var l=e.length,q,z,D=Array(l);for(q=0;q<l;q++){var I=e[q].length;var W=Array(I);for(z=0;z<I;z++)W[z]={X:e[q][z].X,Y:e[q][z].Y};
D[q]=W}g||(D=D[0]);return D};r.JS.Lighten=function(e,g){if(!(e instanceof Array))return[];if("number"!=typeof g||null===g)return r.Error("Tolerance is not a number in Lighten()."),r.JS.Clone(e);if(0===e.length||1==e.length&&0===e[0].length||0>g)return r.JS.Clone(e);e[0]instanceof Array||(e=[e]);var l,q,z,D,I,W=e.length,da=g*g,ha=[];for(g=0;g<W;g++)if(q=e[g],D=q.length,0!=D){for(z=0;1E6>z;z++){var fa=[];D=q.length;q[D-1].X!=q[0].X||q[D-1].Y!=q[0].Y?(I=1,q.push({X:q[0].X,Y:q[0].Y}),D=q.length):I=0;
var Wa=[];for(l=0;l<D-2;l++){var Ra=q[l];var Nb=q[l+1];var Qa=q[l+2];var wc=Ra.X;var xb=Ra.Y;Ra=Qa.X-wc;var Zb=Qa.Y-xb;if(0!==Ra||0!==Zb){var $b=((Nb.X-wc)*Ra+(Nb.Y-xb)*Zb)/(Ra*Ra+Zb*Zb);1<$b?(wc=Qa.X,xb=Qa.Y):0<$b&&(wc+=Ra*$b,xb+=Zb*$b)}Ra=Nb.X-wc;Zb=Nb.Y-xb;Qa=Ra*Ra+Zb*Zb;Qa<=da&&(Wa[l+1]=1,l++)}fa.push({X:q[0].X,Y:q[0].Y});for(l=1;l<D-1;l++)Wa[l]||fa.push({X:q[l].X,Y:q[l].Y});fa.push({X:q[D-1].X,Y:q[D-1].Y});I&&q.pop();if(Wa.length)q=fa;else break}D=fa.length;fa[D-1].X==fa[0].X&&fa[D-1].Y==fa[0].Y&&
fa.pop();2<fa.length&&ha.push(fa)}e[0]instanceof Array||(ha=ha[0]);"undefined"==typeof ha&&(ha=[[]]);return ha};r.JS.PerimeterOfPath=function(e,g,l){if("undefined"==typeof e)return 0;var q=Math.sqrt,z=0,D=e.length;if(2>D)return 0;for(g&&(e[D]=e[0],D++);--D;){var I=e[D];var W=I.X;I=I.Y;var da=e[D-1];var ha=da.X;da=da.Y;z+=q((W-ha)*(W-ha)+(I-da)*(I-da))}g&&e.pop();return z/l};r.JS.PerimeterOfPaths=function(e,g,l){l||(l=1);for(var q=0,z=0;z<e.length;z++)q+=r.JS.PerimeterOfPath(e[z],g,l);return q};r.JS.ScaleDownPath=
function(e,g){var l;g||(g=1);for(l=e.length;l--;){var q=e[l];q.X/=g;q.Y/=g}};r.JS.ScaleDownPaths=function(e,g){var l,q;g||(g=1);for(l=e.length;l--;)for(q=e[l].length;q--;){var z=e[l][q];z.X/=g;z.Y/=g}};r.JS.ScaleUpPath=function(e,g){var l,q=Math.round;g||(g=1);for(l=e.length;l--;){var z=e[l];z.X=q(z.X*g);z.Y=q(z.Y*g)}};r.JS.ScaleUpPaths=function(e,g){var l,q,z=Math.round;g||(g=1);for(l=e.length;l--;)for(q=e[l].length;q--;){var D=e[l][q];D.X=z(D.X*g);D.Y=z(D.Y*g)}};r.ExPolygons=function(){return[]};
r.ExPolygon=function(){this.holes=this.outer=null};r.JS.AddOuterPolyNodeToExPolygons=function(e,g){var l=new r.ExPolygon;l.outer=e.Contour();e=e.Childs();var q=e.length;l.holes=Array(q);var z,D;for(z=0;z<q;z++){var I=e[z];l.holes[z]=I.Contour();var W=0;var da=I.Childs();for(D=da.length;W<D;W++)I=da[W],r.JS.AddOuterPolyNodeToExPolygons(I,g)}g.push(l)};r.JS.ExPolygonsToPaths=function(e){var g,l,q=new r.Paths;var z=0;for(g=e.length;z<g;z++){q.push(e[z].outer);var D=0;for(l=e[z].holes.length;D<l;D++)q.push(e[z].holes[D])}return q};
r.JS.PolyTreeToExPolygons=function(e){var g=new r.ExPolygons,l;var q=0;var z=e.Childs();for(l=z.length;q<l;q++)e=z[q],r.JS.AddOuterPolyNodeToExPolygons(e,g);return g}})();
(function(R,Y){"function"===typeof define&&define.amd?define(Y):"object"===typeof exports?module.exports=Y():R.returnExports=Y()})(this,function(){var R=Function.call.bind(Function.apply),Y=Function.call.bind(Function.call),va=Array.isArray,Da=Object.keys,ya=function(J){try{return J(),!1}catch(w){return!0}},Ua=function(J){try{return J()}catch(w){return!1}},Cb=function(J){return function(){return!R(J,this,arguments)}}(ya),B=function(){return!ya(function(){return Object.defineProperty({},"x",{get:function(){}})})},
cb=!!Object.defineProperty&&B(),aa="foo"===function(){}.name,Ga=Function.call.bind(Array.prototype.forEach),Va=Function.call.bind(Array.prototype.reduce),lb=Function.call.bind(Array.prototype.filter),ob=Function.call.bind(Array.prototype.some),za=function(J,w,v,A){!A&&w in J||(cb?Object.defineProperty(J,w,{configurable:!0,enumerable:!1,writable:!0,value:v}):J[w]=v)},ib=function(J,w,v){Ga(Da(w),function(A){za(J,A,w[A],!!v)})},pb=Function.call.bind(Object.prototype.toString),r="function"===typeof/abc/?
function(J){return"function"===typeof J&&"[object Function]"===pb(J)}:function(J){return"function"===typeof J},Ya={getter:function(J,w,v){if(!cb)throw new TypeError("getters require true ES5 support");Object.defineProperty(J,w,{configurable:!0,enumerable:!1,get:v})},proxy:function(J,w,v){if(!cb)throw new TypeError("getters require true ES5 support");var A=Object.getOwnPropertyDescriptor(J,w);Object.defineProperty(v,w,{configurable:A.configurable,enumerable:A.enumerable,get:function(){return J[w]},
set:function(M){J[w]=M}})},redefine:function(J,w,v){if(cb){var A=Object.getOwnPropertyDescriptor(J,w);A.value=v;Object.defineProperty(J,w,A)}else J[w]=v},defineByDescriptor:function(J,w,v){cb?Object.defineProperty(J,w,v):"value"in v&&(J[w]=v.value)},preserveToString:function(J,w){w&&r(w.toString)&&za(J,"toString",w.toString.bind(w),!0)}},gb=Object.create||function(J,w){var v=function(){};v.prototype=J;var A=new v;"undefined"!==typeof w&&Da(w).forEach(function(M){Ya.defineByDescriptor(A,M,w[M])});
return A},kb=function(J,w){return Object.setPrototypeOf?Ua(function(){var v=function Z(M){M=new J(M);Object.setPrototypeOf(M,Z.prototype);return M};Object.setPrototypeOf(v,J);v.prototype=gb(J.prototype,{constructor:{value:v}});return w(v)}):!1},S=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof global)return global;throw Error("unable to locate global object");}(),ua=S.isFinite,Ea=Function.call.bind(String.prototype.indexOf),
Db=Function.apply.bind(Array.prototype.indexOf),Mb=Function.call.bind(Array.prototype.concat),Qb=Function.call.bind(String.prototype.slice),Jb=Function.call.bind(Array.prototype.push),Eb=Function.apply.bind(Array.prototype.push),Na=Function.call.bind(Array.prototype.join),Vd=Function.call.bind(Array.prototype.shift),e=Math.max,g=Math.min,l=Math.floor,q=Math.abs,z=Math.exp,D=Math.log,I=Math.sqrt,W=Function.call.bind(Object.prototype.hasOwnProperty),da=function(){},ha=S.Map,fa=ha&&ha.prototype["delete"],
Wa=ha&&ha.prototype.get,Ra=ha&&ha.prototype.has,Nb=ha&&ha.prototype.set,Qa=S.Symbol||{},wc=Qa.species||"@@species",xb=Number.isNaN||function(J){return J!==J},Zb=Number.isFinite||function(J){return"number"===typeof J&&ua(J)},$b=r(Math.sign)?Math.sign:function(J){J=Number(J);return 0===J||xb(J)?J:0>J?-1:1},Vc=function(J){J=Number(J);return-1>J||xb(J)?NaN:0===J||Infinity===J?J:-1===J?-Infinity:0===1+J-1?J:J*(D(1+J)/(1+J-1))},Wd=function(J){return"[object Arguments]"===pb(J)},ye=function(J){return null!==
J&&"object"===typeof J&&"number"===typeof J.length&&0<=J.length&&"[object Array]"!==pb(J)&&"[object Function]"===pb(J.callee)},wd=Wd(arguments)?Wd:ye,yb={primitive:function(J){return null===J||"function"!==typeof J&&"object"!==typeof J},string:function(J){return"[object String]"===pb(J)},regex:function(J){return"[object RegExp]"===pb(J)},symbol:function(J){return"function"===typeof S.Symbol&&"symbol"===typeof J}},Aa=function(J,w,v){var A=J[w];za(J,w,v,!0);Ya.preserveToString(J[w],A)},Dc="function"===
typeof Qa&&"function"===typeof Qa["for"]&&yb.symbol(Qa()),fc=yb.symbol(Qa.iterator)?Qa.iterator:"_es6-shim iterator_";S.Set&&"function"===typeof(new S.Set)["@@iterator"]&&(fc="@@iterator");S.Reflect||za(S,"Reflect",{},!0);var Ic=S.Reflect,xd=String,yd="undefined"!==typeof document&&document?document.all:null,pc=null==yd?function(J){return null==J}:function(J){return null==J&&J!==yd},O={Call:function(J,w){var v=2<arguments.length?arguments[2]:[];if(!O.IsCallable(J))throw new TypeError(J+" is not a function");
return R(J,w,v)},RequireObjectCoercible:function(J,w){if(pc(J))throw new TypeError(w||"Cannot call method on "+J);return J},TypeIsObject:function(J){return void 0===J||null===J||!0===J||!1===J?!1:"function"===typeof J||"object"===typeof J||J===yd},ToObject:function(J,w){return Object(O.RequireObjectCoercible(J,w))},IsCallable:r,IsConstructor:function(J){return O.IsCallable(J)},ToInt32:function(J){return O.ToNumber(J)>>0},ToUint32:function(J){return O.ToNumber(J)>>>0},ToNumber:function(J){if(Dc&&"[object Symbol]"===
pb(J))throw new TypeError("Cannot convert a Symbol value to a number");return+J},ToInteger:function(J){J=O.ToNumber(J);return xb(J)?0:0!==J&&Zb(J)?(0<J?1:-1)*l(q(J)):J},ToLength:function(J){J=O.ToInteger(J);return 0>=J?0:J>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:J},SameValue:function(J,w){return J===w?0===J?1/J===1/w:!0:xb(J)&&xb(w)},SameValueZero:function(J,w){return J===w||xb(J)&&xb(w)},IsIterable:function(J){return O.TypeIsObject(J)&&("undefined"!==typeof J[fc]||wd(J))},GetIterator:function(J){if(wd(J))return new gc(J,
"value");var w=O.GetMethod(J,fc);if(!O.IsCallable(w))throw new TypeError("value is not an iterable");J=O.Call(w,J);if(!O.TypeIsObject(J))throw new TypeError("bad iterator");return J},GetMethod:function(J,w){J=O.ToObject(J)[w];if(!pc(J)){if(!O.IsCallable(J))throw new TypeError("Method not callable: "+w);return J}},IteratorComplete:function(J){return!!J.done},IteratorClose:function(J,w){var v=O.GetMethod(J,"return");if(void 0!==v){try{var A=O.Call(v,J)}catch(Z){var M=Z}if(!w){if(M)throw M;if(!O.TypeIsObject(A))throw new TypeError("Iterator's return method returned a non-object.");
}}},IteratorNext:function(J){var w=1<arguments.length?J.next(arguments[1]):J.next();if(!O.TypeIsObject(w))throw new TypeError("bad iterator");return w},IteratorStep:function(J){J=O.IteratorNext(J);return O.IteratorComplete(J)?!1:J},Construct:function(J,w,v,A){v="undefined"===typeof v?J:v;if(!A&&Ic.construct)return Ic.construct(J,w,v);A=v.prototype;O.TypeIsObject(A)||(A=Object.prototype);A=gb(A);J=O.Call(J,A,w);return O.TypeIsObject(J)?J:A},SpeciesConstructor:function(J,w){J=J.constructor;if(void 0===
J)return w;if(!O.TypeIsObject(J))throw new TypeError("Bad constructor");J=J[wc];if(pc(J))return w;if(!O.IsConstructor(J))throw new TypeError("Bad @@species");return J},CreateHTML:function(J,w,v,A){J=O.ToString(J);var M="<"+w;""!==v&&(A=O.ToString(A).replace(/"/g,"&quot;"),M+=" "+v+'="'+A+'"');return M+">"+J+"</"+w+">"},IsRegExp:function(J){if(!O.TypeIsObject(J))return!1;var w=J[Qa.match];return"undefined"!==typeof w?!!w:yb.regex(J)},ToString:function(J){if(Dc&&"[object Symbol]"===pb(J))throw new TypeError("Cannot convert a Symbol value to a number");
return xd(J)}};if(cb&&Dc){var zd=function(J){if(yb.symbol(Qa[J]))return Qa[J];var w=Qa["for"]("Symbol."+J);Object.defineProperty(Qa,J,{configurable:!1,enumerable:!1,writable:!1,value:w});return w};if(!yb.symbol(Qa.search)){var ed=zd("search"),Xd=String.prototype.search;za(RegExp.prototype,ed,function(J){return O.Call(Xd,J,[this])});Aa(String.prototype,"search",function(J){var w=O.RequireObjectCoercible(this);if(!pc(J)){var v=O.GetMethod(J,ed);if("undefined"!==typeof v)return O.Call(v,J,[w])}return O.Call(Xd,
w,[O.ToString(J)])})}if(!yb.symbol(Qa.replace)){var Wb=zd("replace"),Jc=String.prototype.replace;za(RegExp.prototype,Wb,function(J,w){return O.Call(Jc,J,[this,w])});Aa(String.prototype,"replace",function(J,w){var v=O.RequireObjectCoercible(this);if(!pc(J)){var A=O.GetMethod(J,Wb);if("undefined"!==typeof A)return O.Call(A,J,[v,w])}return O.Call(Jc,v,[O.ToString(J),w])})}if(!yb.symbol(Qa.split)){var Yd=zd("split"),ub=String.prototype.split;za(RegExp.prototype,Yd,function(J,w){return O.Call(ub,J,[this,
w])});Aa(String.prototype,"split",function(J,w){var v=O.RequireObjectCoercible(this);if(!pc(J)){var A=O.GetMethod(J,Yd);if("undefined"!==typeof A)return O.Call(A,J,[v,w])}return O.Call(ub,v,[O.ToString(J),w])})}var Kc=yb.symbol(Qa.match),Ad=Kc&&function(){var J={};J[Qa.match]=function(){return 42};return 42!=="a".match(J)}();if(!Kc||Ad){var Zd=zd("match"),$d=String.prototype.match;za(RegExp.prototype,Zd,function(J){return O.Call($d,J,[this])});Aa(String.prototype,"match",function(J){var w=O.RequireObjectCoercible(this);
if(!pc(J)){var v=O.GetMethod(J,Zd);if("undefined"!==typeof v)return O.Call(v,J,[w])}return O.Call($d,w,[O.ToString(J)])})}}var fd=function(J,w,v){Ya.preserveToString(w,J);Object.setPrototypeOf&&Object.setPrototypeOf(J,w);cb?Ga(Object.getOwnPropertyNames(J),function(A){A in da||v[A]||Ya.proxy(J,A,w)}):Ga(Object.keys(J),function(A){A in da||v[A]||(w[A]=J[A])});w.prototype=J.prototype;Ya.redefine(J.prototype,"constructor",w)},K=function(){return this},V=function(J){cb&&!W(J,wc)&&Ya.getter(J,wc,K)},sa=
function(J,w){w=w||function(){return this};za(J,fc,w);!J[fc]&&yb.symbol(fc)&&(J[fc]=w)},qc=function(J,w,v){cb?Object.defineProperty(J,w,{configurable:!0,enumerable:!0,writable:!0,value:v}):J[w]=v;if(!O.SameValue(J[w],v))throw new TypeError("property is nonconfigurable");},ae=function(J,w,v,A){if(!O.TypeIsObject(J))throw new TypeError("Constructor requires `new`: "+w.name);J=w.prototype;O.TypeIsObject(J)||(J=v);v=gb(J);for(var M in A)W(A,M)&&za(v,M,A[M],!0);return v};if(String.fromCodePoint&&1!==String.fromCodePoint.length){var qb=
String.fromCodePoint;Aa(String,"fromCodePoint",function(J){return O.Call(qb,this,arguments)})}var be={fromCodePoint:function(J){for(var w=[],v,A=0,M=arguments.length;A<M;A++){v=Number(arguments[A]);if(!O.SameValue(v,O.ToInteger(v))||0>v||1114111<v)throw new RangeError("Invalid code point "+v);65536>v?Jb(w,String.fromCharCode(v)):(v-=65536,Jb(w,String.fromCharCode((v>>10)+55296)),Jb(w,String.fromCharCode(v%1024+56320)))}return Na(w,"")},raw:function(J){var w=O.ToObject(J,"bad template");w=O.ToObject(w.raw,
"bad raw value");var v=O.ToLength(w.length);if(0>=v)return"";for(var A=[],M=0,Z;M<v;){Z=O.ToString(M);Z=O.ToString(w[Z]);Jb(A,Z);if(M+1>=v)break;Z=M+1<arguments.length?arguments[M+1]:"";Z=O.ToString(Z);Jb(A,Z);M+=1}return Na(A,"")}};String.raw&&"xy"!==String.raw({raw:{0:"x",1:"y",length:2}})&&Aa(String,"raw",be.raw);ib(String,be);var ze=function A(w,v){if(1>v)return"";if(v%2)return A(w,v-1)+w;w=A(w,v/2);return w+w},Lc={repeat:function(w){var v=O.ToString(O.RequireObjectCoercible(this));w=O.ToInteger(w);
if(0>w||Infinity<=w)throw new RangeError("repeat count must be less than infinity and not overflow maximum string size");return ze(v,w)},startsWith:function(w){var v=O.ToString(O.RequireObjectCoercible(this));if(O.IsRegExp(w))throw new TypeError('Cannot call method "startsWith" with a regex');var A=O.ToString(w),M;1<arguments.length&&(M=arguments[1]);M=e(O.ToInteger(M),0);return Qb(v,M,M+A.length)===A},endsWith:function(w){var v=O.ToString(O.RequireObjectCoercible(this));if(O.IsRegExp(w))throw new TypeError('Cannot call method "endsWith" with a regex');
var A=O.ToString(w),M=v.length,Z;1<arguments.length&&(Z=arguments[1]);Z="undefined"===typeof Z?M:O.ToInteger(Z);M=g(e(Z,0),M);return Qb(v,M-A.length,M)===A},includes:function(w){if(O.IsRegExp(w))throw new TypeError('"includes" does not accept a RegExp');var v=O.ToString(w),A;1<arguments.length&&(A=arguments[1]);return-1!==Ea(this,v,A)},codePointAt:function(w){var v=O.ToString(O.RequireObjectCoercible(this)),A=O.ToInteger(w),M=v.length;if(0<=A&&A<M){w=v.charCodeAt(A);if(55296>w||56319<w||A+1===M)return w;
v=v.charCodeAt(A+1);return 56320>v||57343<v?w:1024*(w-55296)+(v-56320)+65536}}};String.prototype.includes&&!1!=="a".includes("a",Infinity)&&Aa(String.prototype,"includes",Lc.includes);if(String.prototype.startsWith&&String.prototype.endsWith){var af=ya(function(){return"/a/".startsWith(/a/)}),bf=Ua(function(){return!1==="abc".startsWith("a",Infinity)});af&&bf||(Aa(String.prototype,"startsWith",Lc.startsWith),Aa(String.prototype,"endsWith",Lc.endsWith))}Dc&&(Ua(function(){var w=/a/;w[Qa.match]=!1;
return"/a/".startsWith(w)})||Aa(String.prototype,"startsWith",Lc.startsWith),Ua(function(){var w=/a/;w[Qa.match]=!1;return"/a/".endsWith(w)})||Aa(String.prototype,"endsWith",Lc.endsWith),Ua(function(){var w=/a/;w[Qa.match]=!1;return"/a/".includes(w)})||Aa(String.prototype,"includes",Lc.includes));ib(String.prototype,Lc);var Bd=RegExp("(^[\t\n\v\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]+)|([\t\n\v\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]+$)",
"g"),Ae=function(){return O.ToString(O.RequireObjectCoercible(this)).replace(Bd,"")},Mc=RegExp("[\u0085\u200b\ufffe]","g"),ce=/^[-+]0x[0-9a-f]+$/i;za(String.prototype,"trim",Ae,!0);var Nc=function(w){return{value:w,done:0===arguments.length}},Wc=function(w){O.RequireObjectCoercible(w);this._s=O.ToString(w);this._i=0};Wc.prototype.next=function(){var w=this._s,v=this._i;if("undefined"===typeof w||v>=w.length)return this._s=void 0,Nc();var A=w.charCodeAt(v);55296>A||56319<A||v+1===w.length?A=1:(A=w.charCodeAt(v+
1),A=56320>A||57343<A?1:2);this._i=v+A;return Nc(w.substr(v,A))};sa(Wc.prototype);sa(String.prototype,function(){return new Wc(this)});var ac={from:function(w){var v;1<arguments.length&&(v=arguments[1]);var A;if("undefined"===typeof v)var M=!1;else{if(!O.IsCallable(v))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(A=arguments[2]);M=!0}var Z;if("undefined"!==typeof(wd(w)||O.GetMethod(w,fc))){var la=O.IsConstructor(this)?Object(new this):
[];var ia=O.GetIterator(w);for(Z=0;;){var ea=O.IteratorStep(ia);if(!1===ea)break;ea=ea.value;try{M&&(ea="undefined"===typeof A?v(ea,Z):Y(v,A,ea,Z)),la[Z]=ea}catch(Fa){throw O.IteratorClose(ia,!0),Fa;}Z+=1}ia=Z}else for(ea=O.ToObject(w),ia=O.ToLength(ea.length),la=O.IsConstructor(this)?Object(new this(ia)):Array(ia),Z=0;Z<ia;++Z){var oa=ea[Z];M&&(oa="undefined"===typeof A?v(oa,Z):Y(v,A,oa,Z));qc(la,Z,oa)}la.length=ia;return la},of:function(){for(var w=arguments.length,v=va(this)||!O.IsCallable(this)?
Array(w):O.Construct(this,[w]),A=0;A<w;++A)qc(v,A,arguments[A]);v.length=w;return v}};ib(Array,ac);V(Array);var gc=function(w,v){this.i=0;this.array=w;this.kind=v};ib(gc.prototype,{next:function(){var w=this.i,v=this.array;if(!(this instanceof gc))throw new TypeError("Not an ArrayIterator");if("undefined"!==typeof v){var A=O.ToLength(v.length);if(w<A){A=this.kind;var M;"key"===A?M=w:"value"===A?M=v[w]:"entry"===A&&(M=[w,v[w]]);this.i=w+1;return Nc(M)}}this.array=void 0;return Nc()}});sa(gc.prototype);
Array.of===ac.of||function(){var w=function(A){this.length=A};w.prototype=[];var v=Array.of.apply(w,[1,2]);return v instanceof w&&2===v.length}()||Aa(Array,"of",ac.of);var od={copyWithin:function(w,v){var A=O.ToObject(this),M=O.ToLength(A.length),Z=O.ToInteger(w),la=O.ToInteger(v);Z=0>Z?e(M+Z,0):g(Z,M);la=0>la?e(M+la,0):g(la,M);var ia;2<arguments.length&&(ia=arguments[2]);ia="undefined"===typeof ia?M:O.ToInteger(ia);ia=0>ia?e(M+ia,0):g(ia,M);M=g(ia-la,M-Z);ia=1;la<Z&&Z<la+M&&(ia=-1,la+=M-1,Z+=M-1);
for(;0<M;)la in A?A[Z]=A[la]:delete A[Z],la+=ia,Z+=ia,--M;return A},fill:function(w){var v;1<arguments.length&&(v=arguments[1]);var A;2<arguments.length&&(A=arguments[2]);var M=O.ToObject(this),Z=O.ToLength(M.length);v=O.ToInteger("undefined"===typeof v?0:v);A=O.ToInteger("undefined"===typeof A?Z:A);v=0>v?e(Z+v,0):g(v,Z);for(A=0>A?Z+A:A;v<Z&&v<A;++v)M[v]=w;return M},find:function(w){var v=O.ToObject(this),A=O.ToLength(v.length);if(!O.IsCallable(w))throw new TypeError("Array#find: predicate must be a function");
for(var M=1<arguments.length?arguments[1]:null,Z=0,la;Z<A;Z++)if(la=v[Z],M){if(Y(w,M,la,Z,v))return la}else if(w(la,Z,v))return la},findIndex:function(w){var v=O.ToObject(this),A=O.ToLength(v.length);if(!O.IsCallable(w))throw new TypeError("Array#findIndex: predicate must be a function");for(var M=1<arguments.length?arguments[1]:null,Z=0;Z<A;Z++)if(M){if(Y(w,M,v[Z],Z,v))return Z}else if(w(v[Z],Z,v))return Z;return-1},keys:function(){return new gc(this,"key")},values:function(){return new gc(this,
"value")},entries:function(){return new gc(this,"entry")}};Array.prototype.keys&&!O.IsCallable([1].keys().next)&&delete Array.prototype.keys;Array.prototype.entries&&!O.IsCallable([1].entries().next)&&delete Array.prototype.entries;Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[fc]&&(ib(Array.prototype,{values:Array.prototype[fc]}),yb.symbol(Qa.unscopables)&&(Array.prototype[Qa.unscopables].values=!0));if(aa&&Array.prototype.values&&"values"!==Array.prototype.values.name){var Be=
Array.prototype.values;Aa(Array.prototype,"values",function(){return O.Call(Be,this,arguments)});za(Array.prototype,fc,Array.prototype.values,!0)}ib(Array.prototype,od);0>1/[!0].indexOf(!0,-0)&&za(Array.prototype,"indexOf",function(w){var v=Db(this,arguments);return 0===v&&0>1/v?0:v},!0);sa(Array.prototype,function(){return this.values()});Object.getPrototypeOf&&sa(Object.getPrototypeOf([].values()));var Ce=function(){return Ua(function(){return 0===Array.from({length:-1}).length})}(),de=function(){var w=
Array.from([0].entries());return 1===w.length&&va(w[0])&&0===w[0][0]&&0===w[0][1]}();Ce&&de||Aa(Array,"from",ac.from);if(!function(){return Ua(function(){return Array.from([0],void 0)})}()){var Oc=Array.from;Aa(Array,"from",function(w){return 1<arguments.length&&"undefined"!==typeof arguments[1]?O.Call(Oc,this,arguments):Y(Oc,this,w)})}var De=-(Math.pow(2,32)-1),Pc=function(w,v){var A={length:De};A[v?(A.length>>>0)-1:0]=!0;return Ua(function(){Y(w,A,function(){throw new RangeError("should not reach here");
},[]);return!0})};if(!Pc(Array.prototype.forEach)){var gd=Array.prototype.forEach;Aa(Array.prototype,"forEach",function(w){return O.Call(gd,0<=this.length?this:[],arguments)})}if(!Pc(Array.prototype.map)){var Cd=Array.prototype.map;Aa(Array.prototype,"map",function(w){return O.Call(Cd,0<=this.length?this:[],arguments)})}if(!Pc(Array.prototype.filter)){var cf=Array.prototype.filter;Aa(Array.prototype,"filter",function(w){return O.Call(cf,0<=this.length?this:[],arguments)})}if(!Pc(Array.prototype.some)){var df=
Array.prototype.some;Aa(Array.prototype,"some",function(w){return O.Call(df,0<=this.length?this:[],arguments)})}if(!Pc(Array.prototype.every)){var Ee=Array.prototype.every;Aa(Array.prototype,"every",function(w){return O.Call(Ee,0<=this.length?this:[],arguments)})}if(!Pc(Array.prototype.reduce)){var Fe=Array.prototype.reduce;Aa(Array.prototype,"reduce",function(w){return O.Call(Fe,0<=this.length?this:[],arguments)})}if(!Pc(Array.prototype.reduceRight,!0)){var hd=Array.prototype.reduceRight;Aa(Array.prototype,
"reduceRight",function(w){return O.Call(hd,0<=this.length?this:[],arguments)})}var Ge=8!==Number("0o10"),He=2!==Number("0b10"),Ie=ob("\u0085\u200b\ufffe",function(w){return 0===Number(w+0+w)});if(Ge||He||Ie){var zb=Number,ee=/^0b[01]+$/i,pd=/^0o[0-7]+$/i,ef=ee.test.bind(ee),Je=pd.test.bind(pd),fe=function(w,v){if("function"===typeof w.valueOf&&(v=w.valueOf(),yb.primitive(v))||"function"===typeof w.toString&&(v=w.toString(),yb.primitive(v)))return v;throw new TypeError("No default value");},Ke=Mc.test.bind(Mc),
ff=ce.test.bind(ce),Dd=function(){var w=function(v){var A=0<arguments.length?yb.primitive(v)?v:fe(v,"number"):0;if("string"===typeof A)if(A=O.Call(Ae,A),ef(A))A=parseInt(Qb(A,2),2);else if(Je(A))A=parseInt(Qb(A,2),8);else if(Ke(A)||ff(A))A=NaN;var M=this,Z=Ua(function(){zb.prototype.valueOf.call(M);return!0});return M instanceof w&&!Z?new zb(A):zb(A)};return w}();fd(zb,Dd,{});ib(Dd,{NaN:zb.NaN,MAX_VALUE:zb.MAX_VALUE,MIN_VALUE:zb.MIN_VALUE,NEGATIVE_INFINITY:zb.NEGATIVE_INFINITY,POSITIVE_INFINITY:zb.POSITIVE_INFINITY});
Number=Dd;Ya.redefine(S,"Number",Dd)}var Ec=Math.pow(2,53)-1;ib(Number,{MAX_SAFE_INTEGER:Ec,MIN_SAFE_INTEGER:-Ec,EPSILON:2.220446049250313E-16,parseInt:S.parseInt,parseFloat:S.parseFloat,isFinite:Zb,isInteger:function(w){return Zb(w)&&O.ToInteger(w)===w},isSafeInteger:function(w){return Number.isInteger(w)&&q(w)<=Number.MAX_SAFE_INTEGER},isNaN:xb});za(Number,"parseInt",S.parseInt,Number.parseInt!==S.parseInt);1===[,1].find(function(){return!0})&&Aa(Array.prototype,"find",od.find);0!==[,1].findIndex(function(){return!0})&&
Aa(Array.prototype,"findIndex",od.findIndex);var Le=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable),Fc=function(w,v){cb&&Le(w,v)&&Object.defineProperty(w,v,{enumerable:!1})},Ed=function(){var w=Number(this),v=arguments.length,A=v-w;A=Array(0>A?0:A);for(var M=w;M<v;++M)A[M-w]=arguments[M];return A},ge=function(w){return function(v,A){v[A]=w[A];return v}},gf=function(w,v){var A=Da(Object(v)),M;O.IsCallable(Object.getOwnPropertySymbols)&&(M=lb(Object.getOwnPropertySymbols(Object(v)),
Le(v)));return Va(Mb(A,M||[]),ge(v),w)},Rb={assign:function(w,v){var A=O.ToObject(w,"Cannot convert undefined or null to object");return Va(O.Call(Ed,1,arguments),gf,A)},is:function(w,v){return O.SameValue(w,v)}};Object.assign&&Object.preventExtensions&&function(){var w=Object.preventExtensions({1:2});try{Object.assign(w,"xy")}catch(v){return"y"===w[1]}}()&&Aa(Object,"assign",Rb.assign);ib(Object,Rb);if(cb){var Me={setPrototypeOf:function(w,v){var A=function(Z,la){if(!O.TypeIsObject(Z))throw new TypeError("cannot set prototype on a non-object");
if(null!==la&&!O.TypeIsObject(la))throw new TypeError("can only set prototype to an object or null"+la);Y(M,Z,la);return Z};try{var M=w.getOwnPropertyDescriptor(w.prototype,v).set;Y(M,{},null)}catch(Z){if(w.prototype!=={}[v])return;M=function(la){this[v]=la};A.polyfill=A(A({},null),w.prototype)instanceof w}return A}(Object,"__proto__")};ib(Object,Me)}Object.setPrototypeOf&&Object.getPrototypeOf&&null!==Object.getPrototypeOf(Object.setPrototypeOf({},null))&&null===Object.getPrototypeOf(Object.create(null))&&
function(){var w=Object.create(null),v=Object.getPrototypeOf,A=Object.setPrototypeOf;Object.getPrototypeOf=function(M){M=v(M);return M===w?null:M};Object.setPrototypeOf=function(M,Z){return A(M,null===Z?w:Z)};Object.setPrototypeOf.polyfill=!1}();if(ya(function(){return Object.keys("foo")})){var Ne=Object.keys;Aa(Object,"keys",function(w){return Ne(O.ToObject(w))});Da=Object.keys}if(ya(function(){return Object.keys(/a/g)})){var Oe=Object.keys;Aa(Object,"keys",function(w){if(yb.regex(w)){var v=[],A;
for(A in w)W(w,A)&&Jb(v,A);return v}return Oe(w)});Da=Object.keys}if(Object.getOwnPropertyNames&&ya(function(){return Object.getOwnPropertyNames("foo")})){var hf="object"===typeof window?Object.getOwnPropertyNames(window):[],Pe=Object.getOwnPropertyNames;Aa(Object,"getOwnPropertyNames",function(w){w=O.ToObject(w);if("[object Window]"===pb(w))try{return Pe(w)}catch(v){return Mb([],hf)}return Pe(w)})}if(Object.getOwnPropertyDescriptor&&ya(function(){return Object.getOwnPropertyDescriptor("foo","bar")})){var id=
Object.getOwnPropertyDescriptor;Aa(Object,"getOwnPropertyDescriptor",function(w,v){return id(O.ToObject(w),v)})}if(Object.seal&&ya(function(){return Object.seal("foo")})){var ab=Object.seal;Aa(Object,"seal",function(w){return O.TypeIsObject(w)?ab(w):w})}if(Object.isSealed&&ya(function(){return Object.isSealed("foo")})){var xc=Object.isSealed;Aa(Object,"isSealed",function(w){return O.TypeIsObject(w)?xc(w):!0})}if(Object.freeze&&ya(function(){return Object.freeze("foo")})){var Sa=Object.freeze;Aa(Object,
"freeze",function(w){return O.TypeIsObject(w)?Sa(w):w})}if(Object.isFrozen&&ya(function(){return Object.isFrozen("foo")})){var hc=Object.isFrozen;Aa(Object,"isFrozen",function(w){return O.TypeIsObject(w)?hc(w):!0})}if(Object.preventExtensions&&ya(function(){return Object.preventExtensions("foo")})){var he=Object.preventExtensions;Aa(Object,"preventExtensions",function(w){return O.TypeIsObject(w)?he(w):w})}if(Object.isExtensible&&ya(function(){return Object.isExtensible("foo")})){var ie=Object.isExtensible;
Aa(Object,"isExtensible",function(w){return O.TypeIsObject(w)?ie(w):!1})}if(Object.getPrototypeOf&&ya(function(){return Object.getPrototypeOf("foo")})){var jf=Object.getPrototypeOf;Aa(Object,"getPrototypeOf",function(w){return jf(O.ToObject(w))})}var Qe=cb&&function(){var w=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return w&&O.IsCallable(w.get)}();cb&&!Qe&&Ya.getter(RegExp.prototype,"flags",function(){if(!O.TypeIsObject(this))throw new TypeError("Method called on incompatible type: must be an object.");
var w="";this.global&&(w+="g");this.ignoreCase&&(w+="i");this.multiline&&(w+="m");this.unicode&&(w+="u");this.sticky&&(w+="y");return w});var qd=cb&&Ua(function(){return"/a/i"===String(new RegExp(/a/g,"i"))}),mb=Dc&&cb&&function(){var w=/./;w[Qa.match]=!1;return RegExp(w)===w}(),Gc=Ua(function(){return"/abc/"===RegExp.prototype.toString.call({source:"abc"})}),Re=Gc&&Ua(function(){return"/a/b"===RegExp.prototype.toString.call({source:"a",flags:"b"})});if(!Gc||!Re){var jd=RegExp.prototype.toString;
za(RegExp.prototype,"toString",function(){var w=O.RequireObjectCoercible(this);if(yb.regex(w))return Y(jd,w);var v=xd(w.source);w=xd(w.flags);return"/"+v+"/"+w},!0);Ya.preserveToString(RegExp.prototype.toString,jd)}if(cb&&(!qd||mb)){var Se=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get,je=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{},Te=function(){return this.source},ke=O.IsCallable(je.get)?je.get:Te,ic=RegExp,le=function(){return function M(v,A){var Z=O.IsRegExp(v);
return this instanceof M||!Z||"undefined"!==typeof A||v.constructor!==M?yb.regex(v)?(Z=O.Call(ke,v),v="undefined"===typeof A?O.Call(Se,v):A,new M(Z,v)):new ic(v,A):v}}();fd(ic,le,{$input:!0});RegExp=le;Ya.redefine(S,"RegExp",le)}if(cb){var me={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};Ga(Da(me),function(w){w in RegExp&&!(me[w]in RegExp)&&Ya.getter(RegExp,me[w],function(){return RegExp[w]})})}V(RegExp);var Fd=1/Number.EPSILON,Gd=Math.pow(2,-23),kf=Math.pow(2,127)*
(2-Gd),rd=Math.pow(2,-126),Ab=Math.E,Fb=Math.LOG2E,Ha=Math.LOG10E,yc=Number.prototype.clz;delete Number.prototype.clz;var Ob={acosh:function(w){var v=Number(w);if(xb(v)||1>w)return NaN;if(1===v)return 0;if(Infinity===v)return v;w=1/(v*v);if(2>v)return Vc(v-1+I(1-w)*v);v/=2;return Vc(v+I(1-w)*v-1)+1/Fb},asinh:function(w){var v=Number(w);if(0===v||!ua(v))return v;w=q(v);var A=w*w;v=$b(v);return 1>w?v*Vc(w+A/(I(A+1)+1)):v*(Vc(w/2+I(1+1/A)*w/2-1)+1/Fb)},atanh:function(w){w=Number(w);if(0===w)return w;
if(-1===w)return-Infinity;if(1===w)return Infinity;if(xb(w)||-1>w||1<w)return NaN;var v=q(w);return $b(w)*Vc(2*v/(1-v))/2},cbrt:function(w){w=Number(w);if(0===w)return w;var v=0>w;v&&(w=-w);if(Infinity===w)var A=Infinity;else A=z(D(w)/3),A=(w/(A*A)+2*A)/3;return v?-A:A},clz32:function(w){w=O.ToUint32(Number(w));return 0===w?32:yc?O.Call(yc,w):31-l(D(w+.5)*Fb)},cosh:function(w){w=Number(w);if(0===w)return 1;if(xb(w))return NaN;if(!ua(w))return Infinity;w=z(q(w)-1);return Ab/2*(w+1/(w*Ab*Ab))},expm1:function(w){w=
Number(w);if(-Infinity===w)return-1;if(!ua(w)||0===w)return w;if(.5<q(w))return z(w)-1;for(var v=w,A=0,M=1;A+v!==A;)A+=v,M+=1,v*=w/M;return A},hypot:function(w,v){for(var A=0,M=0,Z=0;Z<arguments.length;++Z){var la=q(Number(arguments[Z]));M<la?(A*=M/la*(M/la),A+=1,M=la):A+=0<la?la/M*(la/M):la}return Infinity===M?Infinity:M*I(A)},log2:function(w){return D(w)*Fb},log10:function(w){return D(w)*Ha},log1p:Vc,sign:$b,sinh:function(w){w=Number(w);if(!ua(w)||0===w)return w;var v=q(w);if(1>v)return v=Math.expm1(v),
$b(w)*v*(1+1/(v+1))/2;v=z(v-1);return $b(w)*(v-1/(v*Ab*Ab))*(Ab/2)},tanh:function(w){w=Number(w);return xb(w)||0===w?w:20<=w?1:-20>=w?-1:(Math.expm1(w)-Math.expm1(-w))/(z(w)+z(-w))},trunc:function(w){w=Number(w);return 0>w?-l(-w):l(w)},imul:function(w,v){w=O.ToUint32(w);v=O.ToUint32(v);var A=w&65535,M=v&65535;return A*M+((w>>>16&65535)*M+A*(v>>>16&65535)<<16>>>0)|0},fround:function(w){var v=Number(w);if(0===v||Infinity===v||-Infinity===v||xb(v))return v;w=$b(v);v=q(v);if(v<rd)return w*(v/rd/Gd+Fd-
Fd)*rd*Gd;var A=(1+Gd/Number.EPSILON)*v;v=A-(A-v);return v>kf||xb(v)?Infinity*w:w*v}};ib(Math,Ob);za(Math,"sinh",Ob.sinh,Infinity===Math.sinh(710));za(Math,"cosh",Ob.cosh,Infinity===Math.cosh(710));za(Math,"log1p",Ob.log1p,-1E-17!==Math.log1p(-1E-17));za(Math,"asinh",Ob.asinh,Math.asinh(-1E7)!==-Math.asinh(1E7));za(Math,"asinh",Ob.asinh,Infinity===Math.asinh(1E300));za(Math,"atanh",Ob.atanh,0===Math.atanh(1E-300));za(Math,"tanh",Ob.tanh,-2E-17!==Math.tanh(-2E-17));za(Math,"acosh",Ob.acosh,Infinity===
Math.acosh(Number.MAX_VALUE));za(Math,"acosh",Ob.acosh,!(8>q(1-Math.acosh(1+Number.EPSILON)/Math.sqrt(2*Number.EPSILON))/Number.EPSILON));za(Math,"cbrt",Ob.cbrt,!(8>q(1-Math.cbrt(1E-300)/1E-100)/Number.EPSILON));za(Math,"sinh",Ob.sinh,-2E-17!==Math.sinh(-2E-17));var Xc=Math.expm1(10);za(Math,"expm1",Ob.expm1,22025.465794806718<Xc||22025.465794806718>Xc);za(Math,"hypot",Ob.hypot,Infinity!==Math.hypot(Infinity,NaN));var Ue=Math.round,Ve=0===Math.round(.5-Number.EPSILON/4)&&1===Math.round(-.5+Number.EPSILON/
3.99),Hd=[Fd+1,2*Fd-1].every(function(w){return Math.round(w)===w});za(Math,"round",function(w){var v=l(w);return.5>w-v?v:-1===v?-0:v+1},!Ve||!Hd);Ya.preserveToString(Math.round,Ue);var We=Math.imul;2!==Math.imul.length&&Aa(Math,"imul",function(w,v){return O.Call(We,Math,arguments)});var Id=function(){var w=S.setTimeout;if("function"===typeof w||"object"===typeof w){O.IsPromise=function(ja){return O.TypeIsObject(ja)&&"undefined"!==typeof ja._promise?!0:!1};var v=function(ja){if(!O.IsConstructor(ja))throw new TypeError("Bad promise constructor");
var qa=this;qa.resolve=void 0;qa.reject=void 0;qa.promise=new ja(function(ma,Ca){if(void 0!==qa.resolve||void 0!==qa.reject)throw new TypeError("Bad Promise implementation!");qa.resolve=ma;qa.reject=Ca});if(!O.IsCallable(qa.resolve)||!O.IsCallable(qa.reject))throw new TypeError("Bad promise constructor");},A;"undefined"!==typeof window&&O.IsCallable(window.postMessage)&&(A=function(){var ja=[];window.addEventListener("message",function(qa){qa.source===window&&"zero-timeout-message"===qa.data&&(qa.stopPropagation(),
0!==ja.length&&Vd(ja)())},!0);return function(qa){Jb(ja,qa);window.postMessage("zero-timeout-message","*")}});var M=function(){var ja=S.Promise,qa=ja&&ja.resolve&&ja.resolve();return qa&&function(ma){return qa.then(ma)}},Z=O.IsCallable(S.setImmediate)?S.setImmediate:"object"===typeof process&&process.nextTick?process.nextTick:M()||(O.IsCallable(A)?A():function(ja){w(ja,0)}),la=function(ja){return ja},ia=function(ja){throw ja;},ea={},oa=function(ja,qa,ma){Z(function(){if(qa===ea)ja(ma);else{try{var Ca=
ja(ma);var Za=qa.resolve}catch(wa){Ca=wa,Za=qa.reject}Za(Ca)}})},Fa=function(ja,qa){var ma=ja._promise,Ca=ma.reactionLength;if(0<Ca&&(oa(ma.fulfillReactionHandler0,ma.reactionCapability0,qa),ma.fulfillReactionHandler0=void 0,ma.rejectReactions0=void 0,ma.reactionCapability0=void 0,1<Ca))for(var Za=1,wa=0;Za<Ca;Za++,wa+=3)oa(ma[wa+0],ma[wa+2],qa),ja[wa+0]=void 0,ja[wa+1]=void 0,ja[wa+2]=void 0;ma.result=qa;ma.state=1;ma.reactionLength=0},hb=function(ja,qa){var ma=ja._promise,Ca=ma.reactionLength;if(0<
Ca&&(oa(ma.rejectReactionHandler0,ma.reactionCapability0,qa),ma.fulfillReactionHandler0=void 0,ma.rejectReactions0=void 0,ma.reactionCapability0=void 0,1<Ca))for(var Za=1,wa=0;Za<Ca;Za++,wa+=3)oa(ma[wa+1],ma[wa+2],qa),ja[wa+0]=void 0,ja[wa+1]=void 0,ja[wa+2]=void 0;ma.result=qa;ma.state=2;ma.reactionLength=0},Qc=function(ja){var qa=!1;return{resolve:function(ma){if(!qa){qa=!0;if(ma===ja)return hb(ja,new TypeError("Self resolution"));if(!O.TypeIsObject(ma))return Fa(ja,ma);try{var Ca=ma.then}catch(Za){return hb(ja,
Za)}if(!O.IsCallable(Ca))return Fa(ja,ma);Z(function(){var Za=Ca,wa=Qc(ja),bc=wa.resolve;wa=wa.reject;try{Gb(Za,ma,bc,wa)}catch(rc){wa(rc)}})}},reject:function(ma){if(!qa)return qa=!0,hb(ja,ma)}}},Gb=function(ja,qa,ma,Ca){ja===lf?Y(ja,qa,ma,Ca,ea):Y(ja,qa,ma,Ca)},zc=function(){var ja=function(qa){if(!(this instanceof ja))throw new TypeError('Constructor Promise requires "new"');if(this&&this._promise)throw new TypeError("Bad construction");if(!O.IsCallable(qa))throw new TypeError("not a valid resolver");
var ma=ae(this,ja,ne,{_promise:{result:void 0,state:0,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}}),Ca=Qc(ma),Za=Ca.reject;try{qa(Ca.resolve,Za)}catch(wa){Za(wa)}return ma};return ja}();var ne=zc.prototype;var mf=function(ja,qa,ma,Ca){var Za=!1;return function(wa){Za||(Za=!0,qa[ja]=wa,0===--Ca.count&&(wa=ma.resolve,wa(qa)))}};ib(zc,{all:function(ja){if(!O.TypeIsObject(this))throw new TypeError("Promise is not object");var qa=new v(this),
ma;try{var Ca=O.GetIterator(ja);ja=ma={iterator:Ca,done:!1};for(var Za=ja.iterator,wa=[],bc={count:1},rc,Yc,kd=0;;){try{rc=O.IteratorStep(Za);if(!1===rc){ja.done=!0;break}Yc=rc.value}catch(Ac){throw ja.done=!0,Ac;}wa[kd]=void 0;var Xe=this.resolve(Yc),oe=mf(kd,wa,qa,bc);bc.count+=1;Gb(Xe.then,Xe,oe,qa.reject);kd+=1}if(0===--bc.count){var nf=qa.resolve;nf(wa)}return qa.promise}catch(Ac){Za=Ac;if(ma&&!ma.done)try{O.IteratorClose(Ca,!0)}catch(sd){Za=sd}Ca=qa.reject;Ca(Za);return qa.promise}},race:function(ja){if(!O.TypeIsObject(this))throw new TypeError("Promise is not object");
var qa=new v(this),ma;try{var Ca=O.GetIterator(ja);ja=ma={iterator:Ca,done:!1};for(var Za=ja.iterator,wa,bc,rc;;){try{wa=O.IteratorStep(Za);if(!1===wa){ja.done=!0;break}bc=wa.value}catch(Yc){throw ja.done=!0,Yc;}rc=this.resolve(bc);Gb(rc.then,rc,qa.resolve,qa.reject)}return qa.promise}catch(Yc){Za=Yc;if(ma&&!ma.done)try{O.IteratorClose(Ca,!0)}catch(kd){Za=kd}Ca=qa.reject;Ca(Za);return qa.promise}},reject:function(ja){if(!O.TypeIsObject(this))throw new TypeError("Bad promise constructor");var qa=new v(this),
ma=qa.reject;ma(ja);return qa.promise},resolve:function(ja){if(!O.TypeIsObject(this))throw new TypeError("Bad promise constructor");if(O.IsPromise(ja)&&ja.constructor===this)return ja;var qa=new v(this),ma=qa.resolve;ma(ja);return qa.promise}});ib(ne,{"catch":function(ja){return this.then(null,ja)},then:function(ja,qa){if(!O.IsPromise(this))throw new TypeError("not a promise");var ma=O.SpeciesConstructor(this,zc);ma=2<arguments.length&&arguments[2]===ea&&ma===zc?ea:new v(ma);var Ca=O.IsCallable(ja)?
ja:la,Za=O.IsCallable(qa)?qa:ia,wa=this._promise;if(0===wa.state){if(0===wa.reactionLength)wa.fulfillReactionHandler0=Ca,wa.rejectReactionHandler0=Za,wa.reactionCapability0=ma;else{var bc=3*(wa.reactionLength-1);wa[bc+0]=Ca;wa[bc+1]=Za;wa[bc+2]=ma}wa.reactionLength+=1}else if(1===wa.state)wa=wa.result,oa(Ca,ma,wa);else if(2===wa.state)wa=wa.result,oa(Za,ma,wa);else throw new TypeError("unexpected Promise state");return ma.promise}});ea=new v(zc);var lf=ne.then;return zc}}();S.Promise&&(delete S.Promise.accept,
delete S.Promise.defer,delete S.Promise.prototype.chain);if("function"===typeof Id){ib(S,{Promise:Id});var Jd=kb(S.Promise,function(w){return w.resolve(42).then(function(){})instanceof w}),Tb=!ya(function(){return S.Promise.reject(42).then(null,5).then(null,da)}),pe=ya(function(){return S.Promise.call(3,da)}),td=function(w){var v=w.resolve(5);v.constructor={};w=w.resolve(v);try{w.then(null,da).then(null,da)}catch(A){return!0}return v===w}(S.Promise),ld=cb&&function(){var w=0,v=Object.defineProperty({},
"then",{get:function(){w+=1}});Promise.resolve(v);return 1===w}(),Zc=function A(v){var M=new Promise(v);v(3,function(){});this.then=M.then;this.constructor=A};Zc.prototype=Promise.prototype;Zc.all=Promise.all;var Kd=Ua(function(){return!!Zc.all([1,2])});Jd&&Tb&&pe&&!td&&ld&&!Kd||(Promise=Id,Aa(S,"Promise",Id));if(1!==Promise.all.length){var Ld=Promise.all;Aa(Promise,"all",function(v){return O.Call(Ld,this,arguments)})}if(1!==Promise.race.length){var rb=Promise.race;Aa(Promise,"race",function(v){return O.Call(rb,
this,arguments)})}if(1!==Promise.resolve.length){var jb=Promise.resolve;Aa(Promise,"resolve",function(v){return O.Call(jb,this,arguments)})}if(1!==Promise.reject.length){var Md=Promise.reject;Aa(Promise,"reject",function(v){return O.Call(Md,this,arguments)})}Fc(Promise,"all");Fc(Promise,"race");Fc(Promise,"resolve");Fc(Promise,"reject");V(Promise)}var Ub=function(w){var v=Da(Va(w,function(A,M){A[M]=!0;return A},{}));return w.join(":")===v.join(":")},Pb=Ub(["z","a","bb"]),P=Ub(["z",1,"a","3",2]);if(cb){var $a=
function(w,v){return v||Pb?pc(w)?"^"+O.ToString(w):"string"===typeof w?"$"+w:"number"===typeof w?P?w:"n"+w:"boolean"===typeof w?"b"+w:null:null},fb=function(){return Object.create?Object.create(null):{}},E=function(w,v,A){if(va(A)||yb.string(A))Ga(A,function(la){if(!O.TypeIsObject(la))throw new TypeError("Iterator value "+la+" is not an entry object");v.set(la[0],la[1])});else if(A instanceof w)Y(w.prototype.forEach,A,function(la,ia){v.set(ia,la)});else{if(!pc(A)){var M=v.set;if(!O.IsCallable(M))throw new TypeError("bad map");
var Z=O.GetIterator(A)}if("undefined"!==typeof Z)for(;;){w=O.IteratorStep(Z);if(!1===w)break;w=w.value;try{if(!O.TypeIsObject(w))throw new TypeError("Iterator value "+w+" is not an entry object");Y(M,v,w[0],w[1])}catch(la){throw O.IteratorClose(Z,!0),la;}}}},Bc=function(w,v,A){if(va(A)||yb.string(A))Ga(A,function(la){v.add(la)});else if(A instanceof w)Y(w.prototype.forEach,A,function(la){v.add(la)});else{if(!pc(A)){var M=v.add;if(!O.IsCallable(M))throw new TypeError("bad set");var Z=O.GetIterator(A)}if("undefined"!==
typeof Z)for(;;){w=O.IteratorStep(Z);if(!1===w)break;w=w.value;try{Y(M,v,w)}catch(la){throw O.IteratorClose(Z,!0),la;}}}},$c={Map:function(){var w={},v=function(ia,ea){this.key=ia;this.value=ea;this.prev=this.next=null};v.prototype.isRemoved=function(){return this.key===w};var A=function(ia,ea){if(!O.TypeIsObject(ia)||!ia._es6map)throw new TypeError("Method Map.prototype."+ea+" called on incompatible receiver "+O.ToString(ia));},M=function(ia,ea){A(ia,"[[MapIterator]]");this.i=this.head=ia._head;
this.kind=ea};M.prototype={isMapIterator:!0,next:function(){if(!this.isMapIterator)throw new TypeError("Not a MapIterator");var ia=this.i,ea=this.kind,oa=this.head;if("undefined"===typeof this.i)return Nc();for(;ia.isRemoved()&&ia!==oa;)ia=ia.prev;for(;ia.next!==oa;)if(ia=ia.next,!ia.isRemoved())return ea="key"===ea?ia.key:"value"===ea?ia.value:[ia.key,ia.value],this.i=ia,Nc(ea);this.i=void 0;return Nc()}};sa(M.prototype);var Z=function ea(){if(!(this instanceof ea))throw new TypeError('Constructor Map requires "new"');
if(this&&this._es6map)throw new TypeError("Bad construction");var oa=ae(this,ea,la,{_es6map:!0,_head:null,_map:ha?new ha:null,_size:0,_storage:fb()}),Fa=new v(null,null);Fa.next=Fa.prev=Fa;oa._head=Fa;0<arguments.length&&E(ea,oa,arguments[0]);return oa};var la=Z.prototype;Ya.getter(la,"size",function(){if("undefined"===typeof this._size)throw new TypeError("size method called on incompatible Map");return this._size});ib(la,{get:function(ea){A(this,"get");var oa=$a(ea,!0);if(null!==oa){if(ea=this._storage[oa])return ea.value}else if(this._map){if(ea=
Wa.call(this._map,ea))return ea.value}else for(var Fa=oa=this._head;(Fa=Fa.next)!==oa;)if(O.SameValueZero(Fa.key,ea))return Fa.value},has:function(ea){A(this,"has");var oa=$a(ea,!0);if(null!==oa)return"undefined"!==typeof this._storage[oa];if(this._map)return Ra.call(this._map,ea);for(var Fa=oa=this._head;(Fa=Fa.next)!==oa;)if(O.SameValueZero(Fa.key,ea))return!0;return!1},set:function(ea,oa){A(this,"set");var Fa=this._head,hb=Fa,Qc=$a(ea,!0);if(null!==Qc){if("undefined"!==typeof this._storage[Qc])return this._storage[Qc].value=
oa,this;var Gb=this._storage[Qc]=new v(ea,oa);hb=Fa.prev}else this._map&&(Ra.call(this._map,ea)?Wa.call(this._map,ea).value=oa:(Gb=new v(ea,oa),Nb.call(this._map,ea,Gb),hb=Fa.prev));for(;(hb=hb.next)!==Fa;)if(O.SameValueZero(hb.key,ea))return hb.value=oa,this;Gb=Gb||new v(ea,oa);O.SameValue(-0,ea)&&(Gb.key=0);Gb.next=this._head;Gb.prev=this._head.prev;Gb.prev.next=Gb;Gb.next.prev=Gb;this._size+=1;return this},"delete":function(ea){A(this,"delete");var oa=this._head,Fa=oa,hb=$a(ea,!0);if(null!==hb){if("undefined"===
typeof this._storage[hb])return!1;Fa=this._storage[hb].prev;delete this._storage[hb]}else if(this._map){if(!Ra.call(this._map,ea))return!1;Fa=Wa.call(this._map,ea).prev;fa.call(this._map,ea)}for(;(Fa=Fa.next)!==oa;)if(O.SameValueZero(Fa.key,ea))return Fa.key=w,Fa.value=w,Fa.prev.next=Fa.next,Fa.next.prev=Fa.prev,--this._size,!0;return!1},clear:function(){A(this,"clear");this._map=ha?new ha:null;this._size=0;this._storage=fb();for(var ea=this._head,oa,Fa=ea.next;(oa=Fa)!==ea;)oa.key=w,oa.value=w,Fa=
oa.next,oa.next=oa.prev=ea;ea.next=ea.prev=ea},keys:function(){A(this,"keys");return new M(this,"key")},values:function(){A(this,"values");return new M(this,"value")},entries:function(){A(this,"entries");return new M(this,"key+value")},forEach:function(ea){A(this,"forEach");for(var oa=1<arguments.length?arguments[1]:null,Fa=this.entries(),hb=Fa.next();!hb.done;hb=Fa.next())oa?Y(ea,oa,hb.value[1],hb.value[0],this):ea(hb.value[1],hb.value[0],this)}});sa(la,la.entries);return Z}(),Set:function(){var w=
function(la,ia){if(!O.TypeIsObject(la)||!la._es6set||"undefined"===typeof la._storage)throw new TypeError("Set.prototype."+ia+" called on incompatible receiver "+O.ToString(la));},v=function ia(){if(!(this instanceof ia))throw new TypeError('Constructor Set requires "new"');if(this&&this._es6set)throw new TypeError("Bad construction");var ea=ae(this,ia,A,{_es6set:!0,"[[SetData]]":null,_storage:fb()});if(!ea._es6set)throw new TypeError("bad set");0<arguments.length&&Bc(ia,ea,arguments[0]);return ea};
var A=v.prototype;var M=function(ia){if(!ia["[[SetData]]"]){var ea=new $c.Map;ia["[[SetData]]"]=ea;Ga(Da(ia._storage),function(oa){if("^null"===oa)oa=null;else if("^undefined"!==oa){var Fa=oa.charAt(0);oa="$"===Fa?Qb(oa,1):"n"===Fa?+Qb(oa,1):"b"===Fa?"btrue"===oa:+oa}else oa=void 0;ea.set(oa,oa)});ia["[[SetData]]"]=ea}ia._storage=null};Ya.getter(v.prototype,"size",function(){w(this,"size");if(this._storage)return Da(this._storage).length;M(this);return this["[[SetData]]"].size});ib(v.prototype,{has:function(ia){w(this,
"has");var ea;if(this._storage&&null!==(ea=$a(ia)))return!!this._storage[ea];M(this);return this["[[SetData]]"].has(ia)},add:function(ia){w(this,"add");var ea;if(this._storage&&null!==(ea=$a(ia)))return this._storage[ea]=!0,this;M(this);this["[[SetData]]"].set(ia,ia);return this},"delete":function(ia){w(this,"delete");var ea;if(this._storage&&null!==(ea=$a(ia)))return ia=W(this._storage,ea),delete this._storage[ea]&&ia;M(this);return this["[[SetData]]"]["delete"](ia)},clear:function(){w(this,"clear");
this._storage&&(this._storage=fb());this["[[SetData]]"]&&this["[[SetData]]"].clear()},values:function(){w(this,"values");M(this);return new Z(this["[[SetData]]"].values())},entries:function(){w(this,"entries");M(this);return new Z(this["[[SetData]]"].entries())},forEach:function(ia){w(this,"forEach");var ea=1<arguments.length?arguments[1]:null,oa=this;M(oa);this["[[SetData]]"].forEach(function(Fa,hb){ea?Y(ia,ea,hb,hb,oa):ia(hb,hb,oa)})}});za(v.prototype,"keys",v.prototype.values,!0);sa(v.prototype,
v.prototype.values);var Z=function(ia){this.it=ia};Z.prototype={isSetIterator:!0,next:function(){if(!this.isSetIterator)throw new TypeError("Not a SetIterator");return this.it.next()}};sa(Z.prototype);return v}()};S.Set&&!Set.prototype["delete"]&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys)&&(S.Set=$c.Set);if(S.Map||S.Set){Ua(function(){return 2===(new Map([[1,2]])).get(1)})||(S.Map=function v(){if(!(this instanceof v))throw new TypeError('Constructor Map requires "new"');
var A=new ha;0<arguments.length&&E(v,A,arguments[0]);delete A.constructor;Object.setPrototypeOf(A,S.Map.prototype);return A},S.Map.prototype=gb(ha.prototype),za(S.Map.prototype,"constructor",S.Map,!0),Ya.preserveToString(S.Map,ha));var Nd=new Map,sc=function(){var w=new Map([[1,0],[2,0],[3,0],[4,0]]);w.set(-0,w);return w.get(0)===w&&w.get(-0)===w&&w.has(0)&&w.has(-0)}(),qe=Nd.set(1,2)===Nd;sc&&qe||Aa(Map.prototype,"set",function(w,v){Y(Nb,this,0===w?0:w,v);return this});sc||(ib(Map.prototype,{get:function(w){return Y(Wa,
this,0===w?0:w)},has:function(w){return Y(Ra,this,0===w?0:w)}},!0),Ya.preserveToString(Map.prototype.get,Wa),Ya.preserveToString(Map.prototype.has,Ra));var ad=new Set,re=Set.prototype["delete"]&&Set.prototype.add&&Set.prototype.has&&function(w){w["delete"](0);w.add(-0);return!w.has(0)}(ad),ud=ad.add(1)===ad;if(!re||!ud){var Hc=Set.prototype.add;Set.prototype.add=function(w){Y(Hc,this,0===w?0:w);return this};Ya.preserveToString(Set.prototype.add,Hc)}if(!re){var vd=Set.prototype.has;Set.prototype.has=
function(w){return Y(vd,this,0===w?0:w)};Ya.preserveToString(Set.prototype.has,vd);var Kb=Set.prototype["delete"];Set.prototype["delete"]=function(w){return Y(Kb,this,0===w?0:w)};Ya.preserveToString(Set.prototype["delete"],Kb)}var Od=kb(S.Map,function(w){var v=new w([]);v.set(42,42);return v instanceof w}),Pd=Object.setPrototypeOf&&!Od;try{var bb=!(S.Map()instanceof S.Map)}catch(w){bb=w instanceof TypeError}if(0!==S.Map.length||Pd||!bb)S.Map=function v(){if(!(this instanceof v))throw new TypeError('Constructor Map requires "new"');
var A=new ha;0<arguments.length&&E(v,A,arguments[0]);delete A.constructor;Object.setPrototypeOf(A,v.prototype);return A},S.Map.prototype=ha.prototype,za(S.Map.prototype,"constructor",S.Map,!0),Ya.preserveToString(S.Map,ha);var tb=kb(S.Set,function(w){var v=new w([]);v.add(42,42);return v instanceof w}),Ye=Object.setPrototypeOf&&!tb;try{var se=!(S.Set()instanceof S.Set)}catch(w){se=w instanceof TypeError}if(0!==S.Set.length||Ye||!se){var Xb=S.Set;S.Set=function v(){if(!(this instanceof v))throw new TypeError('Constructor Set requires "new"');
var A=new Xb;0<arguments.length&&Bc(v,A,arguments[0]);delete A.constructor;Object.setPrototypeOf(A,v.prototype);return A};S.Set.prototype=Xb.prototype;za(S.Set.prototype,"constructor",S.Set,!0);Ya.preserveToString(S.Set,Xb)}var tc=new S.Map,bd=!Ua(function(){return tc.keys().next().done});("function"!==typeof S.Map.prototype.clear||0!==(new S.Set).size||0!==tc.size||"function"!==typeof S.Map.prototype.keys||"function"!==typeof S.Set.prototype.keys||"function"!==typeof S.Map.prototype.forEach||"function"!==
typeof S.Set.prototype.forEach||Cb(S.Map)||Cb(S.Set)||"function"!==typeof tc.keys().next||bd||!Od)&&ib(S,{Map:$c.Map,Set:$c.Set},!0);S.Set.prototype.keys!==S.Set.prototype.values&&za(S.Set.prototype,"keys",S.Set.prototype.values,!0);sa(Object.getPrototypeOf((new S.Map).keys()));sa(Object.getPrototypeOf((new S.Set).keys()));if(aa&&"has"!==S.Set.prototype.has.name){var te=S.Set.prototype.has;Aa(S.Set.prototype,"has",function(w){return Y(te,this,w)})}}ib(S,$c);V(S.Map);V(S.Set)}var cc=function(w){if(!O.TypeIsObject(w))throw new TypeError("target must be an object");
},jc={apply:function(){return O.Call(O.Call,null,arguments)},construct:function(w,v){if(!O.IsConstructor(w))throw new TypeError("First argument must be a constructor.");var A=2<arguments.length?arguments[2]:w;if(!O.IsConstructor(A))throw new TypeError("new.target must be a constructor.");return O.Construct(w,v,A,"internal")},deleteProperty:function(w,v){cc(w);if(cb){var A=Object.getOwnPropertyDescriptor(w,v);if(A&&!A.configurable)return!1}return delete w[v]},has:function(w,v){cc(w);return v in w}};
Object.getOwnPropertyNames&&Object.assign(jc,{ownKeys:function(w){cc(w);var v=Object.getOwnPropertyNames(w);O.IsCallable(Object.getOwnPropertySymbols)&&Eb(v,Object.getOwnPropertySymbols(w));return v}});Object.preventExtensions&&Object.assign(jc,{isExtensible:function(w){cc(w);return Object.isExtensible(w)},preventExtensions:function(w){cc(w);return!ya(function(){return Object.preventExtensions(w)})}});if(cb){var n=function(w,v,A){var M=Object.getOwnPropertyDescriptor(w,v);if(!M)return w=Object.getPrototypeOf(w),
null===w?void 0:n(w,v,A);if("value"in M)return M.value;if(M.get)return O.Call(M.get,A)},Qd=function(w,v,A,M){var Z=Object.getOwnPropertyDescriptor(w,v);if(!Z){w=Object.getPrototypeOf(w);if(null!==w)return Qd(w,v,A,M);Z={value:void 0,writable:!0,enumerable:!0,configurable:!0}}return"value"in Z?Z.writable&&O.TypeIsObject(M)?Object.getOwnPropertyDescriptor(M,v)?Ic.defineProperty(M,v,{value:A}):Ic.defineProperty(M,v,{value:A,writable:!0,enumerable:!0,configurable:!0}):!1:Z.set?(Y(Z.set,M,A),!0):!1};Object.assign(jc,
{defineProperty:function(w,v,A){cc(w);return!ya(function(){return Object.defineProperty(w,v,A)})},getOwnPropertyDescriptor:function(w,v){cc(w);return Object.getOwnPropertyDescriptor(w,v)},get:function(w,v){cc(w);return n(w,v,2<arguments.length?arguments[2]:w)},set:function(w,v,A){cc(w);return Qd(w,v,A,3<arguments.length?arguments[3]:w)}})}if(Object.getPrototypeOf){var of=Object.getPrototypeOf;jc.getPrototypeOf=function(w){cc(w);return of(w)}}Object.setPrototypeOf&&jc.getPrototypeOf&&Object.assign(jc,
{setPrototypeOf:function(w,v){cc(w);if(null!==v&&!O.TypeIsObject(v))throw new TypeError("proto must be an object or null");if(v===Ic.getPrototypeOf(w))return!0;if(Ic.isExtensible&&!Ic.isExtensible(w))return!1;var A;a:{for(A=v;A;){if(w===A){A=!0;break a}A=jc.getPrototypeOf(A)}A=!1}if(A)return!1;Object.setPrototypeOf(w,v);return!0}});var ue=function(w,v){O.IsCallable(S.Reflect[w])?Ua(function(){S.Reflect[w](1);S.Reflect[w](NaN);S.Reflect[w](!0);return!0})&&Aa(S.Reflect,w,v):za(S.Reflect,w,v)};Object.keys(jc).forEach(function(w){ue(w,
jc[w])});var ve=S.Reflect.getPrototypeOf;aa&&ve&&"getPrototypeOf"!==ve.name&&Aa(S.Reflect,"getPrototypeOf",function(w){return Y(ve,S.Reflect,w)});S.Reflect.setPrototypeOf&&Ua(function(){S.Reflect.setPrototypeOf(1,{});return!0})&&Aa(S.Reflect,"setPrototypeOf",jc.setPrototypeOf);S.Reflect.defineProperty&&(Ua(function(){var w=!S.Reflect.defineProperty(1,"test",{value:1}),v="function"!==typeof Object.preventExtensions||!S.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return w&&v})||Aa(S.Reflect,
"defineProperty",jc.defineProperty));S.Reflect.construct&&(Ua(function(){var w=function(){};return S.Reflect.construct(function(){},[],w)instanceof w})||Aa(S.Reflect,"construct",jc.construct));if("Invalid Date"!==String(new Date(NaN))){var pf=Date.prototype.toString;Aa(Date.prototype,"toString",function(){var w=+this;return w!==w?"Invalid Date":O.Call(pf,this)})}var h={anchor:function(w){return O.CreateHTML(this,"a","name",w)},big:function(){return O.CreateHTML(this,"big","","")},blink:function(){return O.CreateHTML(this,
"blink","","")},bold:function(){return O.CreateHTML(this,"b","","")},fixed:function(){return O.CreateHTML(this,"tt","","")},fontcolor:function(w){return O.CreateHTML(this,"font","color",w)},fontsize:function(w){return O.CreateHTML(this,"font","size",w)},italics:function(){return O.CreateHTML(this,"i","","")},link:function(w){return O.CreateHTML(this,"a","href",w)},small:function(){return O.CreateHTML(this,"small","","")},strike:function(){return O.CreateHTML(this,"strike","","")},sub:function(){return O.CreateHTML(this,
"sub","","")},sup:function(){return O.CreateHTML(this,"sup","","")}};Ga(Object.keys(h),function(w){var v=String.prototype[w];if(O.IsCallable(v)){v=Y(v,"",' " ');var A=Mb([],v.match(/"/g)).length;v=v!==v.toLowerCase()||2<A}else v=!0;v&&Aa(String.prototype,w,h[w])});var Ja=function(){if(!Dc)return!1;var w="object"===typeof JSON&&"function"===typeof JSON.stringify?JSON.stringify:null;if(!w)return!1;if("undefined"!==typeof w(Qa())||"[null]"!==w([Qa()]))return!0;var v={a:Qa()};v[Qa()]=!0;return"{}"!==
w(v)?!0:!1}(),kc=Ua(function(){return Dc?"{}"===JSON.stringify(Object(Qa()))&&"[{}]"===JSON.stringify([Object(Qa())]):!0});if(Ja||!kc){var G=JSON.stringify;Aa(JSON,"stringify",function(w){if("symbol"!==typeof w){var v;1<arguments.length&&(v=arguments[1]);var A=[w];if(va(v))A.push(v);else{var M=O.IsCallable(v)?v:null;A.push(function(Z,la){Z=M?Y(M,this,Z,la):la;if("symbol"!==typeof Z)return yb.symbol(Z)?ge({})(Z):Z})}2<arguments.length&&A.push(arguments[2]);return G.apply(this,A)}})}return S});
var CindyJS=function(){function R(aa){if(0===va)return console.error("Waiting for "+aa+" after we finished waiting."),function(){};0>va&&(va=0);++va;return function(){--va;0>va&&console.error("Wait count mismatch: "+aa);if(0===va)for(var Ga=0,Va=Da.length;Ga<Va;)Da[Ga++].startup()}}function Y(aa){var Ga=Y.newInstance(aa);0>=va?Ga.startup():!1!==aa.autostart&&Da.push(Ga);return Ga}var va=-1,Da=[];Math.sign||(Math.sign=function(aa){return(0<aa)-(0>aa)||+aa});"undefined"===typeof document||"undefined"===
typeof window||"undefined"===typeof document.addEventListener||"undefined"!==typeof window.cindyDontWait&&!0===window.cindyDontWait||document.addEventListener("DOMContentLoaded",R("DOMContentLoaded"));var ya=null,Ua=null,Cb={};Y.getBaseDir=function(){if(null!==ya)return ya;for(var aa=document.getElementsByTagName("script"),Ga=0;Ga<aa.length;++Ga){var Va=aa[Ga],lb=Va.src;if(lb){var ob=/Cindy\.js$/.exec(lb);if(ob)return ya=lb.substr(0,ob.index),console.log("Will load extensions from "+ya),Ua=Va,ya}}console.error("Could not find <script> tag for Cindy.js");
return ya=Ua=!1};Y.addNewScript=function(aa,Ga){Ga||console.error.bind(console);var Va=Y.getBaseDir();if(!1===Va)return!1;Ga=document.createElement("script");Ga.src=Va+aa;aa=Ua.nextSibling;Va=Ua.parentElement;aa?Va.insertBefore(Ga,aa):Va.appendChild(Ga);return Ga};Y.loadScript=function(aa,Ga,Va,lb){for(var ob=String(aa).split("."),za=window;ob.length&&"object"===typeof za&&null!==za;)za=za[ob.shift()];if(za&&!ob.length)return Va(),!0;lb||(lb=console.error.bind(console));ob=Cb[aa];if(!ob){ob=Y.addNewScript(Ga,
lb);if(!1===ob)return lb("Can't load additional components."),!1;Cb[aa]=ob}ob.addEventListener("load",Va);ob.addEventListener("error",lb);return null};Y._autoLoadingPlugin={};Y.autoLoadPlugin=function(aa,Ga,Va){if(Y._pluginRegistry[aa])return Va(),!0;var lb=Y._autoLoadingPlugin[aa];if(!lb){Ga||(Ga=aa+"-plugin.js");lb=Y._autoLoadingPlugin[aa]=[];aa=Y.addNewScript(Ga);if(!1===aa)return!1;aa.addEventListener("error",console.error.bind(console))}lb.push(Va);return null};var B={ctype:"undefined"};Y.waitFor=
R;Y._pluginRegistry={};Y.instances=[];Y.registerPlugin=function(aa,Ga,Va){if(1!==aa)return console.error("Plugin API version "+aa+" not supported"),!1;Y._pluginRegistry[Ga]=Va;(Y._autoLoadingPlugin[Ga]||[]).forEach(function(lb){lb()})};var cb=0;Y.dumpState=function(aa){aa=Y.instances[aa||0].saveState();console.log(JSON.stringify(aa))};Y.debugState=function(aa){Y.instances.map(function(Ga){var Va=Ga.config;Va=JSON.parse(JSON.stringify(Va));var lb=Ga.saveState();console.log(JSON.stringify(lb));for(var ob in lb)Va[ob]=
lb[ob];Ga.shutdown();return Va}).forEach(function(Ga){Y(Ga)})};Y.newInstance=function(aa){function Ga(){jb.width=$a=jb.clientWidth;jb.height=fb=jb.clientHeight;rb=1;if(Kd||Ld)rb=Math.max(Kd?Kd/jb.width:0,Ld?Ld/jb.height:0),$a=rb*jb.clientWidth,fb=rb*jb.clientHeight;P.setTransform(1/rb,0,0,1/rb,0,0);N.setMat(25,0,0,25,250.5,250.5);if(Md)for(var a of Md){var b=Object.keys(a)[0];"scale"===b&&(Jd=a.scale,N[b](a.scale));if("translate"===b)N[b](a.translate[0],a.translate[1]);"scaleAndOrigin"===b&&(Jd=a[b][0]/
25,N[b].apply(null,a[b]));"visibleRect"===b&&(N[b].apply(null,a[b]),Jd=N.drawingstate.initialmatrix.a/25)}N.createnewbackup();N.greset();a=1;"undefined"!==typeof window&&window.devicePixelRatio&&(a=window.devicePixelRatio);b=P.webkitBackingStorePixelRatio||P.mozBackingStorePixelRatio||P.msBackingStorePixelRatio||P.oBackingStorePixelRatio||P.backingStorePixelRatio||1;a!==b&&(a/=b,jb.width=$a*a,jb.height=fb*a,P.scale(a,a))}function Va(a){let b;if("canvas"!==a.tagName.toLowerCase())for(b=a,jb=document.createElement("canvas");b.firstChild;)b.removeChild(b.firstChild);
else{jb=a;b=document.createElement("div");let c=null,d=null;Array.prototype.slice.call(jb.attributes).forEach(function(f){"width"===f.name?c=f.value:"height"===f.name?d=f.value:b.setAttributeNodeNS(jb.removeAttributeNode(f))});null===c||b.style.width||(b.style.width=c+"px");null===d||b.style.height||(b.style.height=d+"px");jb.parentNode.replaceChild(b,jb)}b.classList.add("CindyJS-widget");a=jb.style;a.position="absolute";a.border="none";a.margin=a.padding=a.left=a.top="0px";a.width=a.height="100%";
a="static";window.getComputedStyle&&(a=window.getComputedStyle(b).getPropertyValue("position"),a=String(a||"static"));"static"===a&&(b.style.position="relative");b.appendChild(jb);return jb}function lb(){const a=aa.cinderella;if(!a||!a.version)return!1;for(let b=0;b<arguments.length;++b){const c=a.version[b],d=arguments[b];if(c!==d)return typeof c===typeof d&&c<d}return!1}function ob(){Od=!0;if(0===Pd){if(aa.exclusive)for(d=Ab.instances.length;0<d;)Ab.instances[--d].shutdown();void 0!==aa.csconsole&&
(Fb=aa.csconsole);Fb=null===Fb?new Eb:!0===Fb?new Qb:"string"===typeof Fb?new Jb(Fb):"object"===typeof Fb&&"function"===typeof Fb.appendChild?new Jb(Fb):new Eb;Pb=[100,100];var a=null;Md=aa.transform;if(aa.ports&&0<aa.ports.length){d=aa.ports[0];(a=d.element)||(a=document.getElementById(d.id));a=Va(a);const k=a.parentNode.style;"window"===d.fill?(k.width="100vw",k.height="100vh"):"parent"===d.fill?(k.width="100%",k.height="100%"):d.width&&d.height&&(k.width=d.width+"px",k.height=d.height+"px");d.virtualwidth&&
(Kd=d.virtualwidth);d.virtualheight&&(Ld=d.virtualheight);d.background&&(a.style.backgroundColor=d.background);void 0!==d.transform&&(Md=d.transform);Ub(d.grid)&&0<d.grid&&(Tb=d.grid);Ub(d.tgrid)&&0<d.tgrid&&(pe=d.tgrid);d.snap&&(td=!0);Number.isFinite(d.snapdistance)&&(ld=Math.max(d.snapdistance,0));d.axes&&(Zc=!0)}a||(a=aa.canvas,a||"undefined"===typeof document||(a=document.getElementById(aa.canvasname))&&(a=Va(a)));a&&(jb=a,P=a.getContext("2d"),Ga(),P.setLineDash||(P.setLineDash=function(){}),
(aa.animation?aa.animation.controls:aa.animcontrols)&&ib(aa),aa.animation&&Ub(aa.animation.speed)&&(void 0===aa.animation.accuracy&&lb(2,9,1875)?pb(.5*aa.animation.speed):pb(aa.animation.speed)),aa.animation&&Ub(aa.animation.accuracy)&&(Hd=aa.animation.accuracy));aa.statusbar&&(Fa="string"===typeof aa.statusbar?document.getElementById(aa.statusbar):aa.statusbar);var b=aa.scripts,c=null;"string"===typeof b&&0<=b.search(/\*/)&&(c=b);"object"!==typeof b&&(b=null);"move keydown keyup keytyped keytype mousedown mouseup mousedrag mousemove mouseclick multidown multiup multidrag init tick draw simulationstep simulationstart simulationstop ondrop xrdraw xrinputsourceschange xrselectstart xrselectend xrselect xrselecthold xrsqueezestart xrsqueezeend xrsqueeze xrsqueezehold".split(" ").forEach(function(k){if(null!==
b&&b[k])var m=b[k];else{m=k+"script";if(aa[m])m=document.getElementById(aa[m]);else if(c){if(m=document.getElementById(c.replace(/\*/,k)),!m)return}else return;m=m.text}m=qc(m,!1);"error"===m.ctype?console.error("Error compiling "+k+" script: "+m.message):Ha[k]=ae(m,k)});lb(2,9,1888)&&!Ha.keydown&&(Ha.keydown=Ha.keytyped,Ha.keytyped=Ha.keytype,Ha.keytype=void 0);Ub(aa.grid)&&0<aa.grid&&(Tb=aa.grid);aa.snap&&(td=!0);Number.isFinite(aa.snapdistance)&&(ld=Math.max(aa.snapdistance,0));E={};var d=0;Bc=
{};aa.geometry||(aa.geometry=[]);df(aa.geometry);aa.behavior||(aa.behavior=[]);"function"===typeof rd&&rd(aa.behavior);for(var f in aa.images)d=za(aa.images[f],!1),d!==B&&(Bc[f]=d);for(const k in aa.videos)f=za(aa.videos[k],!0),f!==B&&(Bc[k]=f);Kb.canvas=a;if(aa.oninit)aa.oninit(Kb);Ab.instances.push(Kb);aa.use&&aa.use.forEach(function(k){v.use$1([G.wrap(k)],{})});Ac.convexhull3d$1&&Ya("QuickHull3D","QuickHull3D.js");(Ac.colorplot$1||Ac.colorplot$2||Ac.colorplot$3||Ac.colorplot$4)&&Ya("CindyGL","CindyGL.js");
(Ac.playtone$1||Ac.playmelody$1)&&Ya("midi","midi-plugin.js");gb()}}function za(a,b){let c;"string"===typeof a?(b?(c=document.createElement("video"),c.preload="auto",c.loop=!0,c.setAttribute("playsinline",""),enableInlineVideo(c)):c=new Image,c.src=a):c=a;if(!c.tagName)return console.error("Not a valid image element",c),B;const d={img:c,width:NaN,height:NaN,ready:!0,live:!1,generation:0,whenReady:r};a=c.tagName.toLowerCase();const f=[];if("img"===a)c.complete?(d.width=c.width,d.height=c.height):(d.ready=
!1,c.addEventListener("load",function(){d.width=c.width;d.height=c.height;d.ready=!0;d.whenReady=r;f.forEach(r);l()}),d.whenReady=f.push.bind(f));else if("video"===a)d.live=!0,c.readyState>=c.HAVE_METADATA?(d.width=c.videoWidth,d.height=c.videoHeight):(d.ready=!1,c.addEventListener("loadedmetadata",function(){d.width=c.videoWidth;d.height=c.videoHeight;d.ready=!0;d.whenReady=r;f.forEach(r);l()}),d.whenReady=f.push.bind(f));else if("canvas"===a)d.width=c.width,d.height=c.height;else return console.error("Not a valid image element",
a,c),B;return{ctype:"image",value:d}}function ib(a){function b(C,F){const H=document.createElement("button"),Q=document.createElement("img");H.appendChild(Q);x.appendChild(H);ad(Q,C);H.addEventListener("click",F);sc[C]=function(T){T?H.classList.add("CindyJS-active"):H.classList.remove("CindyJS-active")}}function c(C){if(y){var F=p.getBoundingClientRect();pb(m*(C.clientX-F.left-p.clientLeft+.5)/F.width+f)}}const d=document.createElement("div");d.className="CindyJS-animcontrols";jb.parentNode.appendChild(d);
let f=0,k=1,m=1;a.animation&&a.animation.speedRange&&Ub(a.animation.speedRange[0])&&Ub(a.animation.speedRange[1])&&(f=a.animation.speedRange[0],k=a.animation.speedRange[1],m=k-f);const p=document.createElement("div");p.className="CindyJS-animspeed";d.appendChild(p);const u=document.createElement("div");p.appendChild(u);Na(p,"mousedown",function(C){y=!0;c(C)});Na(p,"mousemove",c);Na(jb.parentNode,"mouseup",function(C){y=!1},!0);const x=document.createElement("div");x.className="CindyJS-animbuttons";
d.appendChild(x);b("play",S);b("pause",ua);b("stop",Ea);sc.stop(!0);qe=function(C){C=(C-f)/m;C=Math.max(0,Math.min(1,C));C=.1*Math.round(1E3*C);u.style.width=C+"%"};let y=!1}function pb(a){Ue=a;qe&&qe(a)}function r(a){return a()}function Ya(a,b,c){let d=null;aa.plugins&&(d=aa.plugins[a]);d||(d=Ab._pluginRegistry[a]);d?v.use$1([G.wrap(a)],{}):(++re,Ab.autoLoadPlugin(a,b,function(){v.use$1([G.wrap(a)],{});gb(c)}))}function gb(a){0===--re&&(a?l():(K(Ha.init),(aa.animation||aa).autoplay&&S(),Kb.canvas&&
Vd(Kb.canvas,aa)))}function kb(){null!==ud&&(Hb.set(ud.state),Object.keys(ud.speeds).forEach(function(a){const b=E.csnames[a];"undefined"!==typeof b.behavior&&(a=ud.speeds[a],b.behavior.vx=a[0],b.behavior.vy=a[1],b.behavior.vz=a[2],b.behavior.fx=0,b.behavior.fy=0,b.behavior.fz=0)}),Ne())}function S(){if(!yc){if(Ob){const a=Rc.backup;a.set(Hb);const b={};for(const c of E.points)"undefined"!==typeof c.behavior&&(b[c.name]=[c.behavior.vx,c.behavior.vy,c.behavior.vz]);ud={state:a,speeds:b};Xc=0;Ob=!1;
sc.stop(!1)}else sc.pause(!1);Ve=Date.now();sc.play(!0);"function"===typeof rd&&qf&&kf();yc=!0;K(Ha.simulationstart);l()}}function ua(){yc&&(sc.play(!1),sc.pause(!0),yc=!1)}function Ea(){Ob||(yc?(K(Ha.simulationstop),yc=!1,sc.play(!1)):sc.pause(!1),sc.stop(!0),Ob=!0,kb())}function Db(){if(!vd){vd=!0;for(var a=Ab.instances.length;0<a;)if(Ab.instances[--a]===Kb){Ab.instances.splice(a,1);break}for(a=Hc.length;0<a;)try{Hc[--a]()}catch(b){console.error(b)}}}function Mb(a){this.in=function(b,c){console.log(b);
c?this.append(this.createTextNode("span","blue",b)):this.append(this.createTextNode("p","blue",b))};this.out=function(b,c){console.log(b);c?this.append(this.createTextNode("span","red",b)):this.append(this.createTextNode("p","red",b))};this.err=function(b,c){console.log(b);c?this.append(this.createTextNode("span","red",b)):this.append(this.createTextNode("p","red",b))};this.createTextNode=function(b,c,d){return"undefined"!==typeof document?(b=document.createElement(b),b.appendChild(document.createTextNode(d)),
b.style.color=c,b):d+"\n"}}function Qb(){const a=this;let b;const c=document.createElement("div");let d;c.innerHTML='<div id="console" style="border-top: 1px solid #333333; bottom: 0px; position: absolute; width: 100%;"><div id="log" style="height: 150px; overflow-y: auto;"></div><input id="cmd" type="text" style="box-sizing: border-box; height: 30px; width: 100%;"></div>';document.body.appendChild(c);b=document.getElementById("cmd");d=document.getElementById("log");b.onkeydown=function(f){13===f.keyCode&&
""!==b.value&&(a.in(b.value),f=v.parse$1([G.wrap(b.value)],[]),f=K(f),console.log(fa(f)),"undefined"!==f.ctype&&Fb.out(fa(f)),b.value="",d.scrollTop=d.scrollHeight)};this.append=function(f){d.appendChild(f)};this.clear=function(){d.innerHTML=""}}function Jb(a){let b=a;"string"===typeof a&&(b=document.getElementById(a));this.append=function(c){b.appendChild(c)};this.clear=function(){b.innerHTML=""}}function Eb(){this.append=function(a){};this.clear=function(){}}function Na(a,b,c,d){void 0===d&&(d=
!1);Hc.push(function(){a.removeEventListener(b,c,d)});a.addEventListener(b,c,d)}function Vd(a,b){function c(y,C){for(let H of y.changedTouches)if(y=f(H.identifier),C||tc[y]){var F=a.getBoundingClientRect();F=N.to(H.clientX-F.left-a.clientLeft+.5,H.clientY-F.top-a.clientTop+.5);tc[y]=[F[0],F[1]]}l()}function d(y){const C=a.getBoundingClientRect();y=N.to(y.clientX-C.left-a.clientLeft+.5,y.clientY-C.top-a.clientTop+.5);bb.prevx=bb.x;bb.prevy=bb.y;bb.x=y[0];bb.y=y[1];Pb[0]=bb.x;Pb[1]=bb.y;l()}function f(y){if(bd.hasOwnProperty(y))return bd[y];
let C=Object.values(bd);C=C.sort((H,Q)=>H-Q);let F=!1;for(let H in C)!F&&C[H]>(H|0)+1&&(bd[y]=(H|0)+1,F=!0);F||(bd[y]=C.length+1);return bd[y]}function k(y){const C=y.changedTouches;c(y,!1);for(var F=0;F<y.changedTouches.length;F++)Xb=f(y.changedTouches[F].identifier),W(Xb),delete bd[y.changedTouches[F].identifier];F=!1;for(var H=0;H<C.length;H++)C[H].identifier===x&&(F=!0);F&&(x=-1,bb.down=!1,tb=void 0,K(Ha.mouseup),gc("mouseup"),u||K(Ha.mouseclick),l(),y.preventDefault())}let m=null,p=null,u=!1;
"undefined"!==typeof MutationObserver&&(m=MutationObserver);m||"undefined"===typeof WebKitMutationObserver||(m=WebKitMutationObserver);m?(m=new m(function(y){document.body.contains(a)||Db()}),m.observe(document.documentElement,{childList:!0,subtree:!0}),Hc.push(function(){m.disconnect()})):(Na(a,"DOMNodeRemovedFromDocument",Db),Na(a,"DOMNodeRemoved",Db));if(!0===b.keylistener)Na(document,"keydown",function(y){D(y,Ha.keydown);return!1}),Na(document,"keyup",function(y){D(y,Ha.keyup);return!1}),Na(document,
"keypress",function(y){D(y,Ha.keytyped);return!1});else if(Ha.keydown||Ha.keyup||Ha.keytyped)a.setAttribute("tabindex","0"),Na(a,"mousedown",function(){a.focus()}),Na(a,"keydown",function(y){9!==y.keyCode&&(D(y,Ha.keydown),Ha.keytyped||y.preventDefault())}),Na(a,"keyup",function(y){D(y,Ha.keyup);y.preventDefault()}),Na(a,"keypress",function(y){9!==y.keyCode&&(D(y,Ha.keytyped),y.preventDefault())});Na(a,"mousedown",function(y){p=y;u=!1;bb.button=y.which;d(y);I(0);K(Ha.mousedown);gc("mousedown");bb.down=
!0;y.preventDefault()});Na(a,"mouseup",function(y){bb.down=!1;tb=void 0;K(Ha.mouseup);W(0);gc("mouseup");delete tc[0];l();y.preventDefault()});Na(a,"mousemove",function(y){d(y);bb.down?(p&&(2<Math.abs(p.clientX-y.clientX)||2<Math.abs(p.clientY-y.clientY))&&(u=!0),K(Ha.mousedrag),tc[0]&&(Xb=0,K(Ha.multidrag),Xb=0)):K(Ha.mousemove);gc("mousemove");y.preventDefault()});Na(a,"click",function(y){d(y);u||K(Ha.mouseclick);y.preventDefault()});Na(a,"dragenter",function(y){y.preventDefault()});Na(a,"dragover",
function(y){y.preventDefault()});Na(a,"drop",function(y){function C(ta,Ka){function Xa(){La.readyState===XMLHttpRequest.DONE&&(200!==La.status?(console.error("GET request for "+ta+" failed: "+(La.responseText||"(no error message)")),T(Ka,B)):H(Ka,La.responseText))}let Ta=ta.replace(/[?#][^]*/,"");Ta=Ta.replace(/[^]*\/([^\/])/,"$1");U[Ka]={type:"",name:Ta};let La=new XMLHttpRequest;La.onreadystatechange=function(){if(La.readyState===XMLHttpRequest.DONE)if(200!==La.status)console.error("HEAD request for "+
ta+" failed: "+(La.responseText||"(no error message)")),T(Ka,B);else{var Oa=La.getResponseHeader("Content-Type");U[Ka].type=Oa;/^image\//.test(Oa)?Q(Ka,ta):F(Oa)?(La=new XMLHttpRequest,La.onreadystatechange=Xa,La.open("GET",ta),La.send()):T(Ka,B)}};La.open("HEAD",ta);La.send()}function F(ta){ta=ta.replace(/;[^]*/,"");return/^text\//.test(ta)?1:"application/json"===ta?2:0}function H(ta,Ka){switch(F(U[ta].type)){case 1:T(ta,G.string(Ka));break;case 2:let Xa,Ta;try{Xa=JSON.parse(Ka),Ta=G.wrapJSON(Xa)}catch(La){console.error(La),
Ta=B}T(ta,Ta);break;default:T(ta,B)}}function Q(ta,Ka){const Xa=new Image;let Ta=!1;Xa.onload=function(){Ta||(Ta=!0,T(ta,za(Xa,!1)))};Xa.onerror=function(La){Ta||(Ta=!0,console.error(La),T(ta,B))};Xa.src=Ka}function T(ta,Ka,Xa){pa[ta]=h.turnIntoCSList([Ka,G.string(Xa||Ka.ctype),G.string(U[ta].type),G.string(U[ta].name)]);0===--ca&&(ta=Pa,$c=h.turnIntoCSList(pa),Nd=ta,K(Ha.ondrop),Nd=$c=B,l())}y.preventDefault();const X=y.dataTransfer;let U=X.files,pa=Array(U.length),ca=U.length;const Ba=y.currentTarget.getBoundingClientRect(),
Pa=h.realVector(N.to(y.clientX-Ba.left-a.clientLeft+.5,y.clientY-Ba.top-a.clientTop+.5));if(0<U.length)Array.prototype.forEach.call(U,function(ta,Ka){const Xa=new FileReader;F(ta.type)?(Xa.onload=function(){H(Ka,Xa.result)},Xa.readAsText(ta)):/^image\//.test(ta.type)?(Xa.onload=function(){Q(Ka,Xa.result)},Xa.readAsDataURL(ta)):(console.log("Unknown MIME type: "+ta.type),T(Ka,B))});else if(y=X.getData("text/uri-list"))y=y.split("\n").filter(function(ta){return!/^\s*(#|$)/.test(ta)}),ca=y.length,pa=
Array(ca),U=Array(ca),y.forEach(C)});var x=-1;Na(a,"touchstart",function(y){c(y,!0);for(var C=0;C<y.changedTouches.length;C++)I(f(y.changedTouches[C].identifier));-1===x&&(C=y.changedTouches,0!==C.length&&(x=C[0].identifier,d(y.targetTouches[0]),K(Ha.mousedown),bb.down=!0,p=y.targetTouches[0],u=!1,gc("mousedown"),y.preventDefault()))},!1);Na(a,"touchmove",function(y){c(y,!1);for(var C=0;C<y.changedTouches.length;C++)Xb=f(y.changedTouches[C].identifier),K(Ha.multidrag),Xb=0;C=y.changedTouches;let F=
!1;for(var H=0;H<C.length;H++)C[H].identifier===x&&(F=!0);F&&(d(y.targetTouches[0]),bb.down?(p&&(2<Math.abs(p.clientX-y.targetTouches[0].clientX)||2<Math.abs(p.clientY-y.targetTouches[0].clientY))&&(u=!0),Xb=f(x),K(Ha.mousedrag)):K(Ha.mousemove),gc("mousemove"),y.preventDefault())},!0);Na(a,"touchend",k,!1);"undefined"!==typeof document&&document.body&&Na(document.body,"touchcancel",k,!1);"undefined"!==typeof window&&Na(window,"resize",function(){te(function(){Ga();l()})},!1);g(a.parentNode);l()}
function e(a,b){const c=document.createElement("div");c.setAttribute("style",b);a.appendChild(c);return c}function g(a){function b(){d.scrollLeft=d.scrollTop=f.scrollLeft=f.scrollTop=1E5}function c(){if(k!==a.clientWidth||m!==a.clientHeight)k=a.clientWidth,m=a.clientHeight,p||(p=!0,te(function(){p=!1;Ga();l()}));b()}if("undefined"!==typeof document){var d=e(a,"position: absolute; transition: 0s; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;");e(d,"position: absolute; transition: 0s; left: 0; top: 0; width: 100000px; height: 100000px");
var f=e(a,"position: absolute; transition: 0s; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;");e(f,"position: absolute; transition: 0s; left: 0; top: 0; width: 200%; height: 200%");b();var k=a.clientWidth,m=a.clientHeight,p=!1;d.addEventListener("scroll",c);f.addEventListener("scroll",c)}}function l(){cc||(cc=te(q))}function q(){cc=null;if(!vd){if(yc){var a=Date.now();const b=Math.min(50,a-Ve)*Ue*Id;Xc=a;a=Xc+b;qf&&"undefined"!==typeof Yb&&Yb.tick(b);Xc=
a;yc&&K(Ha.tick)}z();yc&&l()}}function z(){N.reset();P.save();P.clearRect(0,0,$a,fb);var a=N.drawingstate.matrix,b,c;if(0!==Tb){P.beginPath();P.strokeStyle="rgba(0,0,0,0.1)";P.lineWidth=1;P.lineCap="butt";var d=Tb*a.a;for(b=Math.ceil(-a.tx/d);(c=b*d+a.tx)<$a;){if(b||!Zc)P.moveTo(c,0),P.lineTo(c,fb);b++}for(b=Math.floor(a.ty/d);(c=b*d-a.ty)<fb;){if(b||!Zc)P.moveTo(0,c),P.lineTo($a,c);b++}P.stroke()}if(0!==pe){P.beginPath();P.strokeStyle="rgba(0,0,0,0.1)";P.lineWidth=1;P.lineCap="butt";d=pe*a.a;var f=
Math.sqrt(3);var k=a.ty/f;var m=(fb+a.ty)/f;for(b=Math.ceil(-(a.tx+m)/d);(c=b*d+a.tx)+k<$a;)P.moveTo(c+k,0),P.lineTo(c+m,fb),b++;for(b=Math.ceil(-(a.tx-k)/d);(c=b*d+a.tx)-m<$a;)P.moveTo(c-k,0),P.lineTo(c-m,fb),b++;d*=.5*f;for(b=Math.floor(a.ty/d);(c=b*d-a.ty)<fb;){if(b||!Zc)P.moveTo(0,c),P.lineTo($a,c);b++}P.stroke()}Zc&&(P.beginPath(),P.strokeStyle="rgba(0,0,0,0.2)",P.lineWidth=3,P.lineCap="butt",P.lineJoin="miter",P.miterLimit=10,P.beginPath(),P.moveTo(0,-a.ty),P.lineTo($a-6,-a.ty),P.moveTo($a-
13,-5-a.ty),P.lineTo($a-3,-a.ty),P.lineTo($a-13,5-a.ty),P.moveTo(a.tx,fb),P.lineTo(a.tx,6),P.moveTo(a.tx-5,13),P.lineTo(a.tx,3),P.lineTo(a.tx+5,13),P.stroke());gf();N.greset();Dd();for(a=0;a<E.polygons.length;a++)d=E.polygons[a],d.isshowing&&!1!==d.visible&&(k={color:d.color,alpha:d.alpha,fillcolor:d.fillcolor,fillalpha:d.fillalpha,size:d.size,lineJoin:G.string("miter"),fillrule:G.string(d.fillrule)},A.drawpolygon([d.vertices],k,"D",!0));for(a=0;a<E.conics.length;a++)E.conics[a].isArc?(d=E.conics[a],
d.isshowing&&!1!==d.visible&&(k={},k.color=d.color,k.alpha=d.alpha,k.size=d.size,A.drawarc(d,k,d.filled?"F":"D"))):(d=E.conics[a],d.isshowing&&!1!==d.visible&&(k={},k.color=d.color,k.alpha=d.alpha,k.size=d.size,A.drawconic(d.matrix,k)));for(a=0;a<E.lines.length;a++)a:if(d=E.lines[a],d.isshowing&&!1!==d.visible&&h._helper.isAlmostReal(d.homog))if("S"===d.kind)k={overhang:d.overhang,dashtype:d.dashtype,size:d.size,color:d.color,alpha:d.alpha,arrow:d.arrow,arrowsize:d.arrowsize,arrowposition:d.arrowposition,
arrowshape:d.arrowshape,arrowsides:d.arrowsides},0<=n.mult(d.startpos.value[2],n.conjugate(d.endpos.value[2])).value.real?(v.draw$2([d.startpos,d.endpos],k),d.labeled&&!d.tmp&&(k=d.printname||d.name||"S",m=h.scalmult(n.real(Math.sign(d.startpos.value[2].value.real)*Math.sign(d.endpos.value[2].value.real)),h.cross(d.startpos,d.endpos)),m={x:m.value[0].value.real,y:m.value[1].value.real},b=Math.sqrt(m.x*m.x+m.y*m.y),m={x:8*m.x/b-3,y:8*m.y/b-3},m=d.labelpos||m,b=L.makeColor(vb.textColor),c=t._helper.midpoint(t._helper.midpoint(d.startpos,
d.endpos),d.endpos),Ke(d,k,c,m,b))):(L.handleModifs(k,L.lineModifs),L.drawRaySegment(d.startpos,d.endpos));else if("end"===d.clip.value&&"Join"===d.type)b=E.csnames[d.args[0]],k=E.csnames[d.args[1]],v.draw$2([b.homog,k.homog],{overhang:d.overhang,dashtype:d.dashtype,size:d.size,color:d.color,alpha:d.alpha});else{if("inci"===d.clip.value){b=[1E6,0];k=[-1E6,0];c=[1E6,0];m=[-1E6,0];for(f=0;f<d.incidences.length;f++){const p=E.csnames[d.incidences[f]].homog;let u=p.value[0],x=p.value[1];const y=p.value[2];
n._helper.isAlmostZero(y)||(u=n.div(u,y),x=n.div(x,y),n._helper.isAlmostReal(u)&&n._helper.isAlmostReal(x)&&(u.value.real<b[0]&&(b=[u.value.real,p]),u.value.real>k[0]&&(k=[u.value.real,p]),x.value.real<c[0]&&(c=[x.value.real,p]),x.value.real>m[0]&&(m=[x.value.real,p])))}k[0]-b[0]>m[0]-c[0]?(b=b[1],k=k[1]):(b=c[1],k=m[1]);if(b!==k){v.draw$2([b,k],{dashtype:d.dashtype,size:d.size,color:d.color,alpha:d.alpha,overhang:d.overhang});break a}}v.draw$1([d.homog],{dashtype:d.dashtype,size:d.size,color:d.color,
alpha:d.alpha})}for(a=0;a<E.points.length;a++)if(d=E.points[a],d.isshowing&&!1!==d.visible&&h._helper.isAlmostReal(d.homog)&&(k=d.color,d.behavior&&(k=d.color),v.draw$1([d.homog],{size:d.size,color:k,alpha:d.alpha,noborder:d.noborder,border:d.border}),d.labeled&&!d.tmp)){m=d.printname||d.name||"P";b=d.labelpos||{x:3,y:3};c=L.makeColor(vb.textColor);if(!0===d.noborder.value||!1===d.border.value)c=k;Ke(d,m,d.homog,b,c)}for(a=0;a<E.texts.length;a++)ff(E.texts[a]);if(E.ifs.length){if(db.dirty||!G.deeplyEqual(db.mat,
N.drawingstate.matrix))t.IFS.updateParameters(),db.dirty=!1;db.img&&P.drawImage(db.img,0,0,$a,fb)}P.restore()}function D(a,b){a=window.event?event:a;a=a.charCode?a.charCode:a.keyCode;Ye=String.fromCharCode(a);se=a;K(b);l()}function I(a){Xb=a;0===a&&(tc[0]=Pb);K(Ha.multidown);Xb=0}function W(a){Xb=a;K(Ha.multiup);delete tc[a];Xb=0}function da(a){var b=a.value;a=b[0].value;const c=b[1].value;b=b[2].value;return h.turnIntoCSList([a[0],n.add(a[1],c[0]),n.add(a[2],b[0]),c[1],n.add(c[2],b[1]),b[2]])}function ha(a){let b=
!0;return function(c,d){b&&(console.error("Operator "+a+" is not supported yet."),b=!1);return B}}function fa(a,b){if("undefined"===typeof a)return"_??_";if(null===a)return"_???_";if("undefined"===a.ctype)return"___";if("number"===a.ctype)return n.niceprint(a);if("string"===a.ctype||"boolean"===a.ctype)return a.value;if("list"===a.ctype){b="[";for(let c=0;c<a.value.length;c++)b+=fa(K(a.value[c])),c!==a.value.length-1&&(b+=", ");return b+"]"}if("JSON"===a.ctype)try{return Ja.niceprint(a,b)}catch(c){return Ja._helper.handlePrintException(c)}return"dict"===
a.ctype?kc.niceprint(a):"function"===a.ctype?"FUNCTION":"infix"===a.ctype?"INFIX":"modifier"===a.ctype?a.key+"->"+fa(a.value):"shape"===a.ctype?a.type:"error"===a.ctype?"Error: "+a.message:"variable"===a.ctype?fa(M.getvar(a.name)):"geo"===a.ctype?a.value.name:"image"===a.ctype?"IMAGE":"_?_"}function Wa(a,b){b="undefined"===a[0].ctype;const c="undefined"===a[1].ctype,d=K(a[1]);if(b||c)return B;"variable"===a[0].ctype?("list"===d.ctype&&(d.internal_usage=void 0),M.setvar(a[0].name,d)):"infix"===a[0].ctype?
"_"===a[0].oper?A.assigntake(a[0],d):qb("Can't use infix expression as lvalue"):"field"===a[0].ctype?A.assigndot(a[0],d):"userdata"===a[0].ctype?A.assigncolon(a[0],d):"function"===a[0].ctype&&"genList"===a[0].oper?"list"===d.ctype?A.assignlist(a[0].args,d.value):qb("Expected list in rhs of assignment"):qb("Left hand side of assignment is not a recognized lvalue");return d}function Ra(a,b){b=K(a[0]);a=K(a[1]);if(b.ctype===a.ctype){if("number"===b.ctype)return G.bool(b.value.real===a.value.real&&b.value.imag===
a.value.imag);if("string"===b.ctype||"boolean"===b.ctype)return G.bool(b.value===a.value);if("list"===b.ctype)return h.equals(b,a);if("geo"===b.ctype||"JSON"===b.ctype)return G.bool(b.value===a.value)}return{ctype:"boolean",value:!1}}function Nb(a,b){return G.not(Ra(a,b))}function Qa(a,b){b=V(a[0]);a=V(a[1]);return"number"===b.ctype&&"number"===a.ctype?{ctype:"boolean",value:n._helper.isAlmostEqual(b,a)}:"string"===b.ctype&&"string"===a.ctype||"boolean"===b.ctype&&"boolean"===a.ctype?{ctype:"boolean",
value:b.value===a.value}:"list"===b.ctype&&"list"===a.ctype?h.almostequals(b,a):{ctype:"boolean",value:!1}}function wc(a,b){b=V(a[0]);a=V(a[1]);return"boolean"===b.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:b.value&&a.value}:B}function xb(a,b){b=V(a[0]);a=V(a[1]);return"boolean"===b.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:b.value||a.value}:B}function Zb(a,b){b=a[0];"void"!==b.ctype&&(b=V(b));a=V(a[1]);let c=G.add(b,a);"Angle"===b.usage&&"Angle"===a.usage&&(c=G.withUsage(c,"Angle"));
return c}function $b(a,b){b=a[0];"void"!==b.ctype&&(b=V(b));a=V(a[1]);let c=G.sub(b,a);"Angle"===b.usage&&"Angle"===a.usage&&(c=G.withUsage(c,"Angle"));return c}function Vc(a,b){b=V(a[0]);a=V(a[1]);let c=G.mult(b,a);"Angle"!==b.usage||a.usage?"Angle"!==a.usage||b.usage||(c=G.withUsage(c,"Angle")):c=G.withUsage(c,"Angle");return c}function Wd(a,b){b=V(a[0]);a=V(a[1]);"number"===a.ctype&&n._helper.isZero(a)&&qb("WARNING: Division by zero!");let c=G.div(b,a);"Angle"!==b.usage||a.usage?"Angle"!==a.usage||
b.usage||(c=G.withUsage(c,"Angle")):c=G.withUsage(c,"Angle");return c}function ye(a,b){b=V(a[0]);a=V(a[1]);return"number"===b.ctype&&"number"===a.ctype?n.pow(b,a):B}function wd(a,b){b=sa(a[0]);a=sa(a[1]);if(b!==B&&a!==B){let c=h.cross(b,a);"Point"===b.usage&&"Point"===a.usage&&(c=G.withUsage(c,"Line"));"Line"===b.usage&&"Line"===a.usage&&(c=G.withUsage(c,"Point"));return c}return B}function yb(a){const b=a.length;if(0===b)return[];if(1===b)return[0];if(2===b)return a[0][0]+a[1][1]<=a[0][1]+a[1][0]?
[0,1]:[1,0];if(4<b)return Aa(a);var c=ia[b];let d=Number.POSITIVE_INFINITY,f=c[0];for(const k of c){c=0;for(let m=0;m<b;++m)c+=a[m][k[m]];c<d&&(d=c,f=k)}return f}function Aa(a){function b(){return{matched:-1,prev:-1,start:-1,cost:0,used:!1,leaf:!1}}function c(H){for(let Q=0;Q<k;++Q)0<y[H][Q]||x[Q].used||(x[Q].used=!0,c(x[Q].matched))}function d(H){for(let Q=0;Q<k;++Q)0<y[Q][H]||u[Q].used||(u[Q].used=!0,d(u[Q].matched))}const f=Math.abs,k=a.length;let m,p;const u=Array(k),x=Array(k),y=Array(k);for(m=
0;m<k;++m)y[m]=Array(k);for(m=0;m<k;++m)for(u[m]=b(),x[m]=b(),u[m].cost=a[m][0],p=1;p<k;++p)u[m].cost>a[m][p]&&(u[m].cost=a[m][p]);for(;;){for(m=0;m<k;++m)for(p=0;p<k;++p)y[m][p]=a[m][p]-u[m].cost-x[p].cost,y[m][p]<1E-14*(f(a[m][p])+f(u[m].cost)+f(x[p].cost))&&(y[m][p]=0);for(m=0;m<k;++m)u[m].matched=x[m].matched=-1;for(var C=0;;){for(m=0;m<k;++m)u[m].used=u[m].leaf=x[m].used=x[m].leaf=!1,-1===u[m].matched&&(u[m].start=m,u[m].used=u[m].leaf=!0,u[m].prev=-1);var F=!1;let H=!1;for(;!H;){for(m=0;m<k;++m)if(u[m].leaf)for(u[m].leaf=
!1,p=0;p<k;++p)if(!(x[p].used||0<y[m][p])&&u[m].matched!==p&&(x[p].prev=m,x[p].start=u[m].start,x[p].used=x[p].leaf=!0,-1===x[p].matched)){u[x[p].start].prev=p;F=!0;break}if(F)break;H=!0;for(p=0;p<k;++p)x[p].leaf&&(x[p].leaf=!1,m=x[p].matched,u[m].used||(u[m].prev=p,u[m].start=x[p].start,u[m].used=u[m].leaf=!0,H=!1))}if(!F)break;for(F=0;F<k;++F)if(-1===u[F].matched&&-1!==u[F].prev){p=u[F].prev;do m=x[p].prev,x[p].matched=m,u[m].matched=p,p=u[m].prev;while(m!==F);++C}}if(C===k)break;for(m=0;m<k;++m)u[m].used=
u[m].leaf=x[m].used=x[m].leaf=!1;for(m=0;m<k;++m)-1===u[m].matched&&c(m);for(p=0;p<k;++p)-1===x[p].matched&&d(p);for(m=0;m<k;++m)-1===u[m].matched||u[m].used||x[u[m].matched].used||(u[m].used=!0);C=Number.POSITIVE_INFINITY;for(m=0;m<k;++m)if(!u[m].used)for(p=0;p<k;++p)x[p].used||C>y[m][p]&&(C=y[m][p]);for(m=0;m<k;++m)u[m].used||(u[m].cost+=C),x[m].used&&(x[m].cost-=C)}a=Array(k);for(m=0;m<k;++m)p=u[m].matched,a[m]=p;return a}function Dc(a,b){b=K(a[0]);a=V(a[1]);"string"!==b.ctype&&"JSON"!==b.ctype&&
(b=h.asList(b));if("JSON"!==b.ctype&&"number"===a.ctype){a=Math.floor(a.value.real);0>a&&(a=b.value.length+a+1);if(0<a&&a<b.value.length+1)return"list"===b.ctype?b.value[a-1]:{ctype:"string",value:b.value.charAt(a-1)};qb("WARNING: Index out of range!");return B}if("JSON"===b.ctype){a=fa(a);if(fa.errorTypes.includes(a))return B;b=b.value[a];return void 0!==b&&b.ctype?b:B}if("list"===a.ctype){const c=[];for(let d=0;d<a.value.length;d++){const f=V(a.value[d]);c[d]=Dc([b,f],[])}return h.turnIntoCSList(c)}return B}
function fc(a,b){b=K(a[0]);a=K(a[1]);if("shape"===b.ctype&&"shape"===a.ctype)return A.shapeconcat(b,a);b=h.asList(b);a=h.asList(a);return"list"===b.ctype&&"list"===a.ctype?h.concat(b,a):B}function Ic(a,b){b=K(a[0]);a=K(a[1]);return"list"===b.ctype&&"list"===a.ctype?h.set(h.common(b,a)):"shape"===b.ctype&&"shape"===a.ctype?A.shapecommon(b,a):B}function xd(a,b){b=K(a[0]);a=K(a[1]);return"list"===b.ctype&&"list"===a.ctype?h.remove(b,a):"shape"===b.ctype&&"shape"===a.ctype?A.shaperemove(b,a):B}function yd(a,
b){b=K(a[0]);a=K(a[1]);return"list"===b.ctype?h.append(b,a):B}function pc(a,b){b=K(a[0]);a=K(a[1]);return"list"===a.ctype?h.prepend(b,a):B}function O(a,b){a|=0;b|=0;if(0===a&&0===b)return 0;for(;0!==b;){const c=a;a=b;b=c%b|0}return a}function zd(a){return 1===a?0:1}function ed(a,b,c){var d=b*b-4*a*c;0<=d?(d=Math.sqrt(d),0<b&&(d=-d),a=[[d-b,2*a],[2*c,d-b]]):a=null;b=a;if(null===b)return null;a=b[0][0]/b[0][1];b=b[1][0]/b[1][1];return b<a?[b,a]:[a,b]}function Xd(a,b,c,d,f,k,m,p=0){if(b.includes("\n")){let x=
Infinity,y=-Infinity,C=Infinity,F=-Infinity;b.split("\n").forEach(function(H){H=Xd(a,H,c,d,f,k);x>H.left&&(x=H.left);y<H.right&&(y=H.right);C>H.top&&(C=H.top);F<H.bottom&&(F=H.bottom);d+=m});return{left:x,right:y,top:C,bottom:F}}const u=a.measureText(b);p?(a.save(),a.translate(c,d),a.rotate(-p),a.fillText(b,-u.width*f,0),a.restore()):a.fillText(b,c-u.width*f,d);return{left:c-u.width*f,right:c+u.width*(1-f),top:d-.84*k,bottom:d+.36*k}}function Wb(a){return"image"===a.ctype?a.value:"string"===a.ctype&&
Bc.hasOwnProperty(a.value)?Bc[a.value].value:null}function Jc(a,b,c,d,f){let k=[];if(a.readPixels)k=a.readPixels(b,c,d,f);else{let m,p;if(a.img.getContext)p=a.img.getContext("2d"),m=p.getImageData(b,c,d,f).data;else try{zc||(zc=document.createElement("canvas")),zc.width=d,zc.height=f,p=zc.getContext("2d"),p.drawImage(a.img,b,c,d,f,0,0,d,f),m=p.getImageData(0,0,d,f).data}catch(u){console.log(u)}for(const u in m)k.push(m[u]/255)}return k}function Yd(a){return a.replace(/[^A-Za-z0-9 \u0080-\uffff]/gi,
"\\$&")}function ub(a,b,c){var d=a;b&&(d=d+" at "+b.row+":"+b.col);c&&(d=d+": \u2018"+c+"\u2019");d=Error(d);d.name="CindyScriptParseError";d.description=a;d.location=b;d.text=c;return d}function Kc(a){this.input=a;this.re=new RegExp(kd,"g");const b=[];let c=a.indexOf("\n")+1;for(;c;)b.push(c),c=a.indexOf("\n",c)+1;b.push(a.length);this.bols=b;this.bol=this.pos=0;this.line=1}function Ad(a){const b=a[a.length-2],c=a[a.length-3],d=a[a.length-1];if(c){if(c.isSuperscript&&b.precedence<=c.precedence)throw ub("Operator not allowed after superscript",
b.start,b.text);if(d){if(!b.op.infix)throw ub("Operator may not be used infix",b.start,b.text);}else if(!b.op.postfix)throw ub("Operator may not be used postfix",b.start,b.text);}else if(d){if(!b.op.prefix)throw ub("Operator may not be used prefix",b.start,b.text);}else if(!b.op.bare)throw ub("Operator without operands",b.start,b.text);b.ctype="infix";b.oper=b.op.sym;b.args=[c,d];a.splice(a.length-3,3,b)}function Zd(a,b,c,d){a.length&1||a.push(null);for(c=Ca[c];3<=a.length&&a[a.length-2].precedence<=
c.precedence;)Ad(a);a.push({op:c,precedence:c.precedence+(c.rassoc?1:0),start:b.start,end:b.end,text:b.text,rawtext:b.rawtext});c="";const f=b.text;for(let k=0;k<f.length;++k)c+="0123456789+-".charAt(d.indexOf(f.charAt(k)));b.ctype="number";b.value={real:+c,imag:0};a.push(b);Ad(a)}function $d(a,b){const c=[];let d="}"===b;a:for(;;){var f=a.next();switch(f.toktype){case "OP":var k=Ca[f.text];"_"!==k.sym||!c.length||c.length&1||"OP"!==c[c.length-1].toktype||":="!==c[c.length-1].op.sym||(c.pop(),k=Ca[":=_"],
f.text=k.sym);f.op=k;f.precedence=k.precedence;for(c.length&1||c.push(null);3<=c.length&&c[c.length-2].precedence<=f.precedence;)Ad(c);k.rassoc&&f.precedence++;d&&":"===k.sym&&(f.jsonatom=!0,f.precedence=Ca[","].precedence,d=!1);"}"===b&&","===k.sym&&0<c.length&&c[c.length-1].jsonatom&&(d=!0);c.push(f);break;case "ID":f.ctype="variable";f.name=f.text;if(c.length&1)throw ub("Missing operator",f.start,f.text);c.push(f);break;case "NUM":f.ctype="number";f.value={real:+f.text,imag:0};if(c.length&1)throw ub("Missing operator",
f.start,f.text);c.push(f);break;case "STR":f.ctype="string";f.value=f.raw.substring(1,f.raw.length-1);if(c.length&1)throw ub("Missing operator",f.start,f.text);c.push(f);break;case "SUB":Zd(c,f,"_","\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089\u208a\u208b");break;case "SUP":Zd(c,f,"^","\u2070\u00b9\u00b2\u00b3\u2074\u2075\u2076\u2077\u2078\u2079\u207a\u207b");c[c.length-1].isSuperscript=!0;break;case "BRA":k="[](){}||".indexOf(f.text);if(f.text===b||k&1)break a;k="[](){}||".charAt(k+
1);var m=$d(a,k),p=m.closedBy;if(p.text!==k)throw ub("Opening "+f.text+" at "+f.start.row+":"+f.start.col+" closed by "+(p.text||"EOF")+" at "+p.start.row+":"+p.start.col);p=f.text+p.text;k=[];if(m=m.expr){for(;m&&"infix"===m.ctype&&","===m.oper;)k.push(m.args[0]),m=m.args[1];k.push(m)}if(c.length&1){if("{}"===p)throw ub("{\u2026} not yet defined for operators.",f.start);m=c[c.length-1];if("variable"!==m.ctype)throw ub("Function name must be an identifier",m.start);if(2<c.length&&c[c.length-2].precedence<
Za)throw ub("Function call in indexing construct must be enclosed in parentheses",f.start);m.ctype="function";f=m.args=[];p=m.modifs={};for(const u of k)if(u&&"infix"===u.ctype&&"->"===u.oper){k=u.args[0];if("variable"!==k.ctype)throw ub("Modifier name must be an identifier",u.start);p[k.name]=u.args[1]}else f.push(u);m.oper=m.name.toLowerCase()+"$"+m.args.length}else if("||"===p)if(1===k.length)c.push({ctype:"function",oper:"abs_infix",args:k,modifs:{}});else if(2===k.length)c.push({ctype:"function",
oper:"dist_infix",args:k,modifs:{}});else throw ub("Don't support |\u2026| with "+k.length+" arguments",f.start);else"{}"===p?c.push({ctype:"function",oper:"genJSON",args:k,modifs:{}}):"[]"!==p&&1===k.length?c.push({ctype:"paren",args:k}):0===k.length?c.push({ctype:"list",value:[]}):c.push({ctype:"function",oper:"genList",args:k,modifs:{}});break;case "EOF":break a}}for(c.length&1||c.push(null);3<=c.length;)Ad(c);return{expr:c[0],closedBy:f}}function fd(a){this.usedFunctions={};this.usedVariables=
{}}function K(a){if(void 0===a)return B;if("infix"===a.ctype)return a.impl(a.args,{},a);if("variable"===a.ctype)return K(M.getvar(a.name));if("function"===a.ctype)return sd.push(a),a=A.evaluate(a.oper,a.args,a.modifs),sd.pop(),a;if("void"===a.ctype)return B;if("field"===a.ctype){var b=K(a.obj);if("geo"===b.ctype){var c=Ja._helper.self;Ja._helper.self=b;a=K(Z.getField(b.value,a.key));Ja._helper.self=c;return a}return"list"===b.ctype?(c=Ja._helper.self,Ja._helper.self=b,a=h.getField(b,a.key),Ja._helper.self=
c,a):"JSON"===b.ctype?(c=Ja._helper.self,Ja._helper.self=b,a=K(Ja.getField(b,a.key)),Ja._helper.self=c,a):B}return"userdata"===a.ctype?(b=K(a.obj),a=G.string(fa(K(a.key))),"_?_"===a.value&&(a=B),"geo"===b.ctype?(c=Ja._helper.self,Ja._helper.self=b,a=K(Z.getuserData(b.value,a)),Ja._helper.self=c,a):"list"===b.ctype||"string"===b.ctype?(c=Ja._helper.self,Ja._helper.self=b,a=K(Z.getuserData(b,a)),Ja._helper.self=c,a):"JSON"===b.ctype?(c=Ja._helper.self,Ja._helper.self=b,a=K(Ja.getField(b,a.value)),Ja._helper.self=
c,a):B):a}function V(a){a=K(a);if("geo"===a.ctype){const b=a.value;if("P"===b.kind)return Z.getField(b,"xy");if("V"===b.kind)return b.value}return a}function sa(a){a=K(a);if("geo"===a.ctype){var b=a.value;if("P"===b.kind||"L"===b.kind)return Z.getField(b,"homog")}return h._helper.isNumberVecN(a,3)?a:h._helper.isNumberVecN(a,2)?(b=h.turnIntoCSList([a.value[0],a.value[1],n.real(1)]),a.usage&&(b=G.withUsage(b,a.usage)),b):B}function qc(a){const b=new fd;b.usedFunctions=Ac;b.infixmap=w;a=b.parse(a);for(const c in b.usedVariables)M.create(c);
return a}function ae(a,b){return{ctype:"infix",args:[],impl:function(){sd=[{oper:b}];const c=K(a);sd=[];return c}}}function qb(a){Fb.err(a+sd.map(function(b){return"\n  at "+b.oper}).join("\n"))}function be(){this._path=[];this._defs=["<defs>"];this._imgcache=[];this._body=[];this._saveStack=[""];this._clipIndex=0;this._stroke=this._fill="#000";this._strokeOpacity=this._fillOpacity=null;this.height=this.width=0;this.lineWidth=1;this.lineCap="butt";this.lineJoin="miter";this.miterLimit=10;this.globalAlpha=
1}function ze(){this._body=[];this._yPos=this._xPos=NaN;this._extGState={Af255:"<< /ca 1 >>",As255:"<< /CA 1 >>"};this._objects=[["%PDF-1.4\n"]];this._offset=this._objects[0][0].length;this._nextIndex=5;this._imgcache=[];this._xobjects={};this._pathUsed=-1;this._fillAlpha=this._strokeAlpha=this._globalAlpha=1;this.height=this.width=0;this.lineWidth=1;this.lineCap="butt";this.lineJoin="miter";this.miterLimit=10}function Lc(a,b){const c=a.width,d=a.height,f=document.createElement("canvas");f.setAttribute("width",
c);f.setAttribute("height",d);f.setAttribute("style","display:none;");const k=Kb.canvas;k.parentNode.insertBefore(f,k.nextSibling);try{return f.getContext("2d").drawImage(a,0,0,c,d),f.toDataURL(b||"image/png")}finally{f.parentNode.removeChild(f)}}function af(a){a=a.replace(RegExp("[^ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/]+","g"),"");const b=new Uint8Array(3*a.length>>2);let c,d,f,k,m,p;for(d=c=0;c+3<a.length;c+=4)f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c)),
k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+1)),m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+2)),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+3)),b[d++]=f<<2|k>>4,b[d++]=k<<4|m>>2,b[d++]=m<<6|p;switch(a.length-c){case 0:break;case 2:f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c));k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+
1));b[d++]=f<<2|k>>4;break;case 3:f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c));k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+1));m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+2));b[d++]=f<<2|k>>4;b[d++]=k<<4|m>>2;break;default:throw Error("Malformed Base64 input: "+(a.length-c)+" chars left: "+a.substr(c));}if(d!==b.length)throw Error("Failed assertion: "+d+" should be "+
b.length);return b}function bf(a){function b(f){return(a[f]<<24|a[f+1]<<16|a[f+2]<<8|a[f+3])>>>0}if(57>a.length)throw Error("Too short to be a PNG file");if(2303741511!==b(0)||218765834!==b(4))throw Error("PNG signature missing");const c=[];let d=8;for(;d<a.length;){if(d+12>a.length)throw Error("Incomplete chunk at offset 0x"+d.toString(16));const f=b(d);if(2147483648<=f)throw Error("Chunk too long");const k=d+12+f;if(k>a.length)throw Error("Incomplete chunk at offset 0x"+d.toString(16));let m=a.subarray(d+
4,d+8);m=String.fromCharCode.apply(String,m);c.push({len:f,type:m,data:a.subarray(d+8,d+8+f),crc:b(d+8+f)});d=k}return c}function Bd(a,b){let c;if(c=/^rgba\(([0-9.]+), *([0-9.]+), *([0-9.]+), *([0-9.]+)\)$/.exec(a))b(+c[1],+c[2],+c[3],+c[4]);else if(c=/^rgb\(([0-9.]+), *([0-9.]+), *([0-9.]+)\)$/.exec(a))b(+c[1],+c[2],+c[3],1);else throw Error("Can't handle color style "+a);}function Ae(a){let b=1;Object.keys(Bc).forEach(function(c){const d=Bc[c].value.img;if(void 0===d.cachedDataURL&&d.src)if("data:"===
d.src.substr(0,5))d.cachedDataURL=d.src;else{++b;d.cachedDataURL=null;var f=new XMLHttpRequest;f.responseType="blob";f.onreadystatechange=function(){if(f.readyState===XMLHttpRequest.DONE)if(200===f.status){const k=new FileReader;k.onloadend=function(){d.cachedDataURL=k.result;console.log("Cached data for image "+d.src);0===--b&&a()};k.readAsDataURL(f.response)}else console.error("Failed to load "+d.src+": "+f.statusText),0===--b&&a()};f.open("GET",d.src,!0);f.send()}});0===--b&&a()}function Mc(a,
b,c){for(c||(c="0");a.length<b;)a=c+a;return a}function ce(){null!==we&&(window.URL.revokeObjectURL(we),we=null)}function Nc(a){Ae(function(){const b=P;try{P=new a;P.width=$a;P.height=fb;z();const c=P.toBlob();we=window.URL.createObjectURL(c);xf(we)}finally{P=b}})}function Wc(a){let b=null,c=1E6,d;console.log("getElementAtMouse");for(const p of E.gslp){if(p.pinned||!1===p.visible||!0===p.tmp)continue;var f=void 0,k=void 0,m=void 0;const u=N.drawingstate.matrix.sdet;if("P"===p.kind){const x=h.normalizeZ(p.homog);
if(!h._helper.isAlmostReal(x))continue;f=x.value[0].value.real-a.x;k=x.value[1].value.real-a.y;m=Math.sqrt(f*f+k*k);p.narrow&m>20/u&&(m=1E4)}else if("C"===p.kind)k=E.csnames[p.args[0]],m=0,"undefined"!==typeof p.radius&&(m=p.radius.value.real),f=n.div(k.homog.value[0],k.homog.value[2]).value.real,k=n.div(k.homog.value[1],k.homog.value[2]).value.real,f-=a.x,k-=a.y,m=Math.sqrt(f*f+k*k)-m,k=f=0,0>m&&(m=-m),m+=30/u;else if("L"===p.kind||"S"===p.kind)f=p.homog,m=n,k=m.add(m.mult(f.value[0],m.conjugate(f.value[0])),
m.mult(f.value[1],m.conjugate(f.value[1]))),k=h.scaldiv(m.sqrt(k),f),m=k.value[0].value.real*a.x+k.value[1].value.real*a.y+k.value[2].value.real,f=k.value[0].value.real*m,k=k.value[1].value.real*m,0>m&&(m=-m),m+=1;m<c+.2/u&&(c=m,b=p,d={x:f,y:k})}return null===b?null:{mover:b,offset:d,prev:{x:a.x,y:a.y}}}function ac(){return"P"+Df++}function gc(a){const b=ba[rf].actions;b[Rd].event===a&&b[Rd].do()&&(l(),Rd===b.length-1?(dc=[],Rd=Sc=0):Rd++)}function od(a){return a&&.5>Math.abs(a.offset.x)&&.5>Math.abs(a.offset.y)&&
!a.mover.tmp}function Be(a){return od(a)&&"P"===a.mover.kind}function Ce(a){return od(a)&&("L"===a.mover.kind||"S"===a.mover.kind)}function de(a){tb={mover:a,offset:{x:0,y:0},prev:{x:bb.x,y:bb.y}}}function Oc(){const a=Wc(bb);Be(a)?dc[Sc]=a.mover:(dc[Sc]={type:"Free",name:ac(),labeled:!0,pos:[Pb[0],Pb[1],1]},zb(dc[Sc]));Sc++}function De(){const a=Wc(bb);return Ce(a)?(dc[Sc]=a.mover,Sc++,!0):!1}function Pc(){const a=Wc(bb);var b;(b=Ce(a))||(b=od(a)&&"C"===a.mover.kind);return b?(dc[Sc]=a.mover,Sc++,
!0):!1}function gd(){const a=Wc(bb);if(Be(a)){xe.args[1]=a.mover.name;for(const b of E.gslp)!0===b.tmp&&pd(b.name)}else for(const b of E.gslp)!0===b.tmp&&(b.tmp=!1)}function Cd(a){let b={type:"Free",name:ac(),labeled:!0,pos:[Pb[0],Pb[1],1],tmp:!0};b=zb(b);xe=zb({type:a,name:ac(),labeled:!0,args:[dc[0].name,b.name]});de(b)}function cf(a){let b;for(b in a)null!==a[b]&&(vb[b]=a[b])}function df(a){Object.keys(t).forEach(function(b){const c=t[b];Ec(c.signature||"_helper"===b,b+" has no signature");void 0!==
c.updatePosition&&void 0===c.stateSize&&(c.stateSize=0)});E.gslp=[];E.csnames={};E.points=[];E.lines=[];E.conics=[];E.texts=[];E.free=[];E.polygons=[];E.ifs=[];E.sets={points:[],lines:[],conics:[]};a.forEach(ee);Te()}function Ee(a){"undefined"===typeof a.tracedim&&(a.tracedim=1);"undefined"===typeof a.tracelength&&(a.tracelength=100);"undefined"===typeof a.traceskip&&(a.traceskip=1);a._traces=Array(a.tracelength);a._traces_index=0;a._traces_tick=0}function Fe(a){void 0===a.size&&(a.size=vb.pointSize);
a.size=n.real(a.size);!a.movable||a.pinned?(a.color=h.realVector(a.color||vb.pointColor),a.color=h.scalmult(n.real(vb.dimDependent),a.color)):a.color=h.realVector(a.color||vb.pointColor);void 0===a.alpha&&(a.alpha=vb.alpha);a.alpha=n.real(a.alpha);"boolean"!==typeof a.noborder&&(a.noborder=vb.noborder);a.noborder=G.bool(a.noborder);"boolean"!==typeof a.border&&(a.border=!vb.noborder);a.border=G.bool(a.border);a.drawtrace&&Ee(a)}function hd(a){void 0===a.size&&(a.size=vb.lineSize);a.size=n.real(a.size);
a.color=h.realVector(a.color||vb.lineColor);void 0===a.alpha&&(a.alpha=vb.alpha);a.alpha=n.real(a.alpha);a.clip=G.string(a.clip||vb.clip);void 0===a.overhang&&(a.overhang=vb.overhangLine);a.overhang=n.real(a.overhang);a.dashtype&&(a.dashtype=G.wrap(a.dashtype))}function Ge(a){void 0===a.overhang&&(a.overhang=vb.overhangSeg);a.arrow&&(a.arrow=G.bool(a.arrow));a.arrowsize&&(a.arrowsize=n.real(a.arrowsize));a.arrowposition&&(a.arrowposition=n.real(a.arrowposition));a.arrowshape&&(a.arrowshape=G.string(a.arrowshape));
a.arrowsides&&(a.arrowsides=G.string(a.arrowsides));hd(a);a.clip=G.string("end")}function He(a){a.size=void 0!==a.textsize?a.textsize:vb.textsize;a.size=n.real(+a.size)}function Ie(a){a.filled=void 0!==a.filled?G.bool(a.filled):G.bool(!0);a.fillcolor=void 0===a.fillcolor?B:h.realVector(a.fillcolor);void 0===a.fillalpha&&(a.fillalpha=0);a.fillalpha=n.real(a.fillalpha);hd(a)}function zb(a,b){a=ee(a);Te();return"boolean"===typeof b&&b&&a.Duplicate?(b=a.Duplicate,console.log("duplication detected: removing "+
a.name+" (type "+a.kind+") (duplicate of "+b.name+")."),pd(a.name),b):a}function ee(a){if(void 0!==E.csnames[a.name]){console.log("Element name '"+a.name+"' already exists");var b=E.csnames[a.name];t[b.type].isMovable&&"P"===t[b.type].kind&&Rb(b,a.pos,"homog");return b}for(;Sd.hasOwnProperty(a.type);)a.type=Sd[a.type];if(b=sf[a.type]){var c=b(a),d=null;for(b=0;b<c.length;++b)d=zb(c[b]);return d}const f=t[a.type];c=!1;if(!f)return console.error(a),console.error("Operation "+a.type+" not implemented yet"),
null;if("**"!==f.signature)if(!Array.isArray(f.signature)&&"*"===f.signature.charAt(1))c=!0,a.args.forEach(function(k){if(E.csnames[k].kind!==f.signature.charAt(0))return console.error("Not all elements in set are of same type: "+a.name+" expects "+f.signature+" but "+k+" is of kind "+E.csnames[k].kind),"undefined"!==typeof window&&window.alert("Not all elements in set are of same type: "+a.name),null});else if(f.signature.length!==(a.args?a.args.length:0))return console.error("Wrong number of arguments for "+
a.name+" of type "+a.type),"undefined"!==typeof window&&window.alert("Wrong number of arguments for "+a.name),null;if(a.args)for(b=0;b<a.args.length;++b){if(!E.csnames.hasOwnProperty(a.args[b]))return console.log("Dropping "+a.name+" due to missing argument "+a.args[b]),null;if("**"!==f.signature&&!c&&(d=E.csnames[a.args[b]].kind,f.signature[b]!==d&&("S"!==d||"L"!==f.signature[b])))return window.alert("Wrong argument kind "+d+" as argument "+b+" to element "+a.name+" of type "+a.type),null}f.signatureConstraints&&
!f.signatureConstraints(a)&&window.alert("signature constraints violated for element "+a.name);E.gslp.push(a);E.csnames[a.name]=a;b=lc.length;a.kind=f.kind;a.stateIdx=b;b+=f.stateSize;a.incidences=[];a.isshowing=!0;a.movable=!1;f.isMovable&&(a.movable=!0,E.free.push(a));"P"===a.kind&&(E.points.push(a),Fe(a));"L"===a.kind&&(E.lines.push(a),hd(a));"C"===a.kind&&(E.conics.push(a),hd(a));"S"===a.kind&&(E.lines.push(a),Ge(a));"Text"===a.kind&&(E.texts.push(a),He(a));"Poly"===a.kind&&(E.polygons.push(a),
Ie(a));"IFS"===a.kind&&E.ifs.push(a);/^[P|L|S|C]s$/.test(a.kind)&&E.sets[{P:"points",L:"lines",S:"lines",C:"conics"}[a.kind[0]]].push(a);Le(b);Hb=Cc=lc;md=!0;f.initialize&&(ec=mc=a.stateIdx,a.param=f.initialize(a),Ec(mc===a.stateIdx+f.stateSize,"State fully initialized"));ec=mc=a.stateIdx;f.updatePosition(a,!1);Ec(ec===a.stateIdx+f.stateSize,"State fully consumed");Ec(mc===a.stateIdx+f.stateSize,"State fully updated");md=!1;Hb=Rc.in;Hb.set(lc);Cc=Rc.out;fe(a,f);Ze={};try{mb(a),Gc(a)}catch(k){console.error(k)}return E.csnames[a.name]}
function pd(a){if(E.csnames.hasOwnProperty(a)){var b={};Object.keys(E.csnames).forEach(function(d){const f=E.csnames[d];f.hasOwnProperty("args")&&f.args.forEach(function(k){b.hasOwnProperty(k)||(b[k]={});b[k][d]=!0})});var c=function(d,f){f[d]=!0;if(!b.hasOwnProperty(d))return f;for(const k in b[d])f[k]||c(k,f);return f};a=c(a,{});ef(a)}else console.log("removeElement: name "+a+"does not exist.")}function ef(a){const b=Object.keys(a),c=function(f,k){return function(m){return f[m.name]?!1:!0}},d={};
b.forEach(function(f){E.csnames[f].incidences.forEach(function(k){d[k]||(E.csnames[k].incidences=E.csnames[k].incidences.filter(function(m){return!a[m]}),d[k]=!0)})});"conics free gslp ifs lines points polygons texts".split(" ").map(function(f){E[f]=E[f].filter(c(a,f))});for(const f in E.sets)E.sets[f]=E.sets[f].filter(c(a,"set of "+f));b.forEach(function(f){delete E.csnames[f]});Ze={}}function Je(a,b){var c=E.csnames[b.args[0]].homog,d=E.csnames[b.args[1]].homog;b=a.homog;a=n.div(c.value[0],c.value[2]);
c=n.div(c.value[1],c.value[2]);let f=n.div(d.value[0],d.value[2]);d=n.div(d.value[1],d.value[2]);let k=n.div(b.value[0],b.value[2]);b=n.div(b.value[1],b.value[2]);return n._helper.isAlmostReal(a)&&n._helper.isAlmostReal(c)&&n._helper.isAlmostReal(f)&&n._helper.isAlmostReal(d)&&n._helper.isAlmostReal(k)&&n._helper.isAlmostReal(b)?(a=a.value.real,c=c.value.real,f=f.value.real,d=d.value.real,k=k.value.real,b=b.value.real,a=Math.sqrt((a-f)*(a-f)+(c-d)*(c-d))-Math.sqrt((a-k)*(a-k)+(c-b)*(c-b))-Math.sqrt((f-
k)*(f-k)+(d-b)*(d-b)),1E-15>a*a):!1}function fe(a,b){a.isshowing=!0;if(a.args)for(let c=0;c<a.args.length;c++)if(!E.csnames[a.args[c]].isshowing){a.isshowing=!1;return}b.visiblecheck&&b.visiblecheck(a)}function Ke(a,b,c,d,f){const k=a.textsize||vb.textsize,m=!0===a.textbold,p=!0===a.textitalics,u=a.text_fontfamily||vb.fontFamily,x=d.x*d.x+d.y*d.y;let y=1;0<x&&(y=1+a.size.value.real/Math.sqrt(x));a=a.alpha||n.real(vb.alpha);A.drawtext([c,G.wrap(b)],{xoffset:G.wrap(y*d.x),yoffset:G.wrap(y*d.y),size:G.wrap(k),
bold:G.wrap(m),italics:G.wrap(p),family:G.wrap(u),color:f,alpha:a})}function ff(a){a._bbox=null;if(a.isshowing&&!1!==a.visible){var b={size:a.size},c=a.homog,d=a.text,f=t[a.type].getText;d=f?f(a):d.replace(/@[$#]"([^"\\]|\\.)*"/g,function(k){let m,p;try{if(m=JSON.parse(k.substring(2)),p=E.csnames[m],!p)return"?"}catch(u){return"?"}switch(k.charAt(1)){case "$":return p.printname||m;case "#":return"V"!==p.kind?"?":fa(p.value)}});f=null;if(a.html){const k=a._textCache||{text:!1},m=a.html,p=m.parentNode,
u=p.parentNode;f=function(x,y,C,F,H){y/=rb;C/=rb;H=L.bold+L.italics+Math.round(H/rb*10)/10+"px "+L.family;k.invisible&&u.style.removeProperty("display");if(x!==k.text||H!==k.font||y!==k.x||C!==k.y||F!==k.align){H!==k.font&&(m.style.font=H,m.style.lineHeight=vb.lineHeight);x!==k.text&&!1!==x&&!1===Qc(m,x,H)&&(x=!1);u.style.left=y+"px";u.style.top=C+"px";if(F||p.style.transform)p.style.transform="translateX("+-100*F+"%)";a._textCache={text:x,font:H,x:y,y:C,align:F}}}}d=G.string(d);a.dock&&(a.dock.to?
c=E.csnames[a.dock.to].homog:yf.hasOwnProperty(a.dock.corner)&&(c=v.screenbounds$0([],{}),c=c.value[yf[a.dock.corner]]),b.offset=a.dock.offset);a.align&&(b.align=G.string(a.align));c&&(a._bbox=A.drawtext([c,d],b,f))}else a.html&&(a.html.parentNode.parentNode.style.display="none",a._textCache={invisible:!0})}function Dd(){function a(){var p=m++/b._traces.length;const u=b._traces[k];u&&(p*=c*p*p,v.draw$1([u],{size:n.real(d),color:b.color,alpha:n.real(p)}));d*=f}for(let p=0;p<E.points.length;p++){var b=
E.points[p];if(b.drawtrace){b._traces_tick===b.traceskip?(b._traces[b._traces_index]=b.homog,b._traces_index=(b._traces_index+1)%b._traces.length,b._traces_tick=0):b._traces_tick++;var c=b.alpha.value.real,d=b.size.value.real,f=1;1!==b.tracedim&&(d*=b.tracedim,f=b.tracedim**(-1/b._traces.length));var k,m=0;for(k=b._traces_index;k<b._traces.length;++k)a();for(k=0;k<b._traces_index;++k)a()}}}function Ec(a,b){b="Assertion failed: "+b;if(!a)throw console.log(b),Db(),"undefined"!==typeof alert&&alert(b),
Error(b);}function Le(a){if(a!==lc.length){var b,c=tf.length;if(nd.length<a*c){var d=2*a;nd=new Float64Array(c*d)}else d=nd.length/c|0;for(b=0;b<c;++b)Rc[tf[b]]=nd.subarray(b*d,b*d+a);a=lc;Hb=Rc.in;Cc=Rc.out;lc=Rc.good;lc.set(a)}}function Fc(){lc.set(Hb);uc=!1;Oe(!1);const a=lc.length,b=Math.abs;for(let c=0;c<a;c+=2)b(lc[c])>1E12*b(lc[c+1])&&(lc[c+1]=0)}function Ed(){if(Td)uc=!0;else throw zf;}function ge(a,b,c,d,f){return G.add(d,G.mult(c,G.sub(f,d)))}function gf(){ra&&(ra.currentMouseAndScripts=
[]);uf=!0;if(tb){const a=tb.mover,b=h.realVector([bb.x+tb.offset.x,bb.y+tb.offset.y,1]);Me(a,b,"mouse");tb.prev.x=bb.x;tb.prev.y=bb.y}K(Ha.move);K(Ha.draw);uc||Fc();uf=!1;ra&&(ra.fullLog.push(h.turnIntoCSList([h.turnIntoCSList(ra.currentMouseAndScripts)])),ra.length>ra.logLength&&ra.splice(0,ra.length-ra.logLength),ra.currentMouseAndScripts=null,ra.postMouseHooks.forEach(function(a){a()}))}function Rb(a,b,c){Me(a,b,c);uf||uc||Fc()}function Me(a,b,c){ra&&ra.currentMouseAndScripts&&(ra.currentMover=
[]);a===Af?(Hb.set(lc),uc=!1):(Af=a,Fc());Cc.set(Hb);let d=1E4;var f=Ze[a.name];if(!f){var k={};var m=0;f=[];k[a.name]=a;var p=E.gslp;for(var u of p)if(p=u.args)for(var x of p)k.hasOwnProperty(x)&&(k[u.name]=u,f[m++]=u);Ze[a.name]=f}k=f;m=-1;f=.9;let y,C,F;u=t[a.type];x=u.parameterPath||ge;ec=a.stateIdx;p=u.getParamFromState(a);ec=mc=a.stateIdx;const H=u.getParamForInput(a,b,c);let Q=m+f;for(;m!==Q;){var T=Q*Q,X=.5/(1+T);X=n.complex(2*Q*X+.5,(1-T)*X);Td=m+.5*f<=m||0===d;0===d&&console.log("tracing limit Reached");
T=!1;ra&&ra.currentMouseAndScripts&&(ra.currentStep=[]);try{ec=mc=a.stateIdx;const U=x(a,Q,X,p,H);ra&&(ra.currentParam=U);X=Cc;Cc=Hb;u.putParamToState(a,U);Cc=X;mc=a.stateIdx;ra&&(ra.currentElement=a);u.updatePosition(a,!0);Ec(ec===a.stateIdx+u.stateSize,"State fully consumed");Ec(mc===a.stateIdx+u.stateSize,"State fully updated");for(y=0;y<k.length;++y)C=k[y],F=t[C.type],ec=mc=C.stateIdx,ra&&(ra.currentElement=C),F.updatePosition(C,!1),Ec(ec===C.stateIdx+F.stateSize,"State fully consumed"),Ec(mc===
C.stateIdx+F.stateSize,"State fully updated");ra&&(ra.currentElement=null);m=Q;f*=1.25;Q+=f;1<=Q&&(Q=1);Cc=Hb;Hb=X}catch(U){if(U!==zf)throw U;f*=.5;Q=m+f;--d;T=!0}ra&&ra.currentMouseAndScripts&&(ra.currentMover.push(h.turnIntoCSList([h.turnIntoCSList(ra.currentStep),G.wrap(T),G.wrap(m),G.wrap(Q),G.wrap(ra.currentParam)])),ra.currentStep=null,ra.currentParam=null)}Oe(uc);for(y=0;y<k.length;++y)C=k[y],F=t[C.type],fe(C,F);ra&&ra.currentMouseAndScripts&&(ra.currentMouseAndScripts.push(h.turnIntoCSList([h.turnIntoCSList(ra.currentMover),
G.wrap(uc),G.wrap(a.name),b,G.wrap(c),p,H])),ra.currentMover=null)}function Ne(){Fc();Td=!0;var a=E.gslp;for(var b of a)a=t[b.type],ec=mc=b.stateIdx,a.updatePosition(b,!1),fe(b,a);b=Cc;Cc=Hb;Hb=b;Fc()}function Oe(a){const b=aa.tracingStateReport;"string"===typeof b&&(document.getElementById(b).textContent=a?"BAD":"GOOD")}function hf(){return h.turnIntoCSList(ra.fullLog.slice())}function Pe(a){const b=JSON.stringify(ra.fullLog);a=new Blob([b],{type:a?"application/octet-stream":"application/json"});
return window.URL.createObjectURL(a)}function id(){const a=ec;ec+=2;return n.complex(Hb[a],Hb[a+1])}function ab(a){const b=Array(a);for(let c=0;c<a;++c)b[c]=id();return h.turnIntoCSList(b)}function xc(a){Cc[mc]=a.value.real;Cc[mc+1]=a.value.imag;mc+=2}function Sa(a){for(let b=0,c=a.value.length;b<c;++b)xc(a.value[b])}function hc(a,b){const c=ab(3),d=ab(3);a=he(a,b,c,d);Sa(a[0]);Sa(a[1]);return h.turnIntoCSList(a)}function he(a,b,c,d){if(md)return[a,b];const f=h.projectiveDistMinScal(c,a),k=h.projectiveDistMinScal(c,
b),m=h.projectiveDistMinScal(d,a),p=h.projectiveDistMinScal(d,b),u=h.projectiveDistMinScal(c,d),x=h.projectiveDistMinScal(a,b);var y=f+p,C=k+m;let F;y>C?(F=[b,a],y=C):F=[a,b];C=function(){};if(ra&&ra.currentStep){const H=[ra.labelTracing2,G.wrap(ra.currentElement.name),h.turnIntoCSList(F),h.turnIntoCSList([c,d]),h.realMatrix([[f,k],[m,p]]),G.wrap(y),G.wrap(u),G.wrap(x),B];ra.currentStep.push(h.turnIntoCSList(H));C=function(Q){ra.hasOwnProperty(Q)||(ra[Q]=G.wrap(Q));H[H.length-1]=ra[Q]}}h._helper.isNaN(a)||
h._helper.isNaN(b)?(C("Tracing failed due to NaNs."),uc=!0):u>3*y&&x>3*y?C("Normal case, everything all right."):1E-5>x?1E-5>u?C("Staying inside singularity."):(C("Moved into singularity."),uc=!0):1E-5>u?C("Moved out of singularity."):(Td?C("Reached refinement limit, giving up."):C("Need to refine."),Ed());return F}function ie(a,b,c,d){const f=ab(3),k=ab(3),m=ab(3),p=ab(3);a=jf(a,b,c,d,f,k,m,p);Sa(a[0]);Sa(a[1]);Sa(a[2]);Sa(a[3]);return h.turnIntoCSList(a)}function jf(a,b,c,d,f,k,m,p){let u=function(){};
f=[f,k,m,p];a=[a,b,c,d];if(md)return a;k=0;d=Array(4);for(c=0;4>c;c++)for(d[c]=Array(4),p=0;4>p;p++)m=h.projectiveDistMinScal(f[c],a[p]),d[c][p]=m;m=yb(d);b=Array(4);for(c=0;4>c;++c)b[c]=a[m[c]],k+=d[c][m[c]];const x=1*k;let y=Infinity,C=Infinity;for(c=0;4>c;c++){if(h._helper.isNaN(a[c]))return u("Tracing failed due to NaNs."),uc=!0,b;for(p=c+1;4>p;p++)m=h.projectiveDistMinScal(f[c],f[p]),y>m&&(y=m),m=h.projectiveDistMinScal(b[c],b[p]),C>m&&(C=m)}if(ra&&ra.currentStep){const F=[ra.labelTracing4,G.wrap(ra.currentElement.name),
h.turnIntoCSList(b),h.turnIntoCSList(f),h.realMatrix(d),G.wrap(k),G.wrap(y),G.wrap(C),B];ra.currentStep.push(h.turnIntoCSList(F));u=function(H){ra.hasOwnProperty(H)||(ra[H]=G.wrap(H));F[F.length-1]=ra[H]}}y>x&&C>x||(1E-5>C?1E-5>y?u("Staying inside singularity."):(u("Moved into singularity."),uc=!0):1E-5>y?u("Moved out of singularity."):(Td?u("Reached refinement limit, giving up."):u("Need to refine."),Ed()));return b}function Qe(a){const b=a.length;let c;var d;if(md){for(c=0;c<b;++c)ec+=2*a[c].value.length,
Sa(a[c]);return a}const f=Array(b);var k=Array(b),m=Array(b);let p=99,u=99;const x=Array(b);for(c=0;c<b;++c)f[c]=ab(a[c].value.length),k[c]=h.normSquared(f[c]).value.real,m[c]=h.normSquared(a[c]).value.real,x[c]=Array(b);for(c=0;c<b;++c){for(d=0;d<b;++d){var y=h.sesquilinearproduct(f[c],a[d]).value;y=(y.real*y.real+y.imag*y.imag)/(k[c]*m[d]);x[c][d]=1-y}for(d=c+1;d<b;++d)y=h.sesquilinearproduct(f[c],f[d]).value,y=(y.real*y.real+y.imag*y.imag)/(k[c]*k[d]),p>1-y&&(p=1-y),y=h.sesquilinearproduct(a[c],
a[d]).value,y=(y.real*y.real+y.imag*y.imag)/(m[c]*m[d]),u>1-y&&(u=1-y)}y=yb(x);d=Array(b);k=0;m=!1;for(c=0;c<b;++c){k+=x[c][y[c]];const C=d[c]=a[y[c]];Sa(C);m|=h._helper.isNaN(C)}m|=isNaN(k);a=function(){};if(ra&&ra.currentStep){const C=[ra.labelTracingSesq,G.wrap(ra.currentElement.name),h.turnIntoCSList(d),h.turnIntoCSList(f),h.realMatrix(x),G.wrap(k),G.wrap(p),G.wrap(u),B];ra.currentStep.push(h.turnIntoCSList(C));a=function(F){ra.hasOwnProperty(F)||(ra[F]=G.wrap(F));C[C.length-1]=ra[F]}}m?(a("Tracing failed due to NaNs."),
uc=!0):p>3*k&&u>3*k?a("Normal case, everything all right."):1E-5>u?1E-5>p?a("Staying inside singularity."):(a("Moved into singularity."),uc=!0):1E-5>p?a("Moved out of singularity."):(Td?a("Reached refinement limit, giving up."):a("Need to refine."),Ed());return d}function qd(a,b){a=t._helper.flattenConicMatrix(a);b=t._helper.flattenConicMatrix(b);const c=ab(6),d=ab(6);b=he(a,b,c,d);Sa(b[0]);Sa(b[1]);a=t._helper.buildConicMatrix(b[0].value);b=t._helper.buildConicMatrix(b[1].value);return h.turnIntoCSList([a,
b])}function mb(a){if(mb.hasOwnProperty(a.kind))mb[a.kind](a)}function Gc(a){Gc.hasOwnProperty(a.kind)&&(a.incidences=[],Gc[a.kind](a))}function Re(a,b){return function(){a.incidences.push(b.name);b.incidences.push(a.name)}}function jd(a,b){return function(){a.Duplicate=b}}function Se(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"point "+a.name+" incident line "+b.name},apply:Re(a,b),holds:function(){const c=h.scaldiv(h.abs(a.homog),a.homog),d=h.scaldiv(h.abs(b.homog),
b.homog);return n.abs(h.scalproduct(c,d)).value.real<n.epsbig}}}function je(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"point "+a.name+" incident conic "+b.name},apply:Re(a,b),holds:function(){let c=G.mult(b.matrix,a.homog);c=G.mult(a.homog,c);c=n.abs(c);return c.value.real<n.epsbig}}}function Te(){if(0!==Sb.length){Rc.prover.set(Hb);var a,b=function(){a={};Sb.forEach(function(k){let m;k.getInvolved().forEach(function(p){a[p.name]||(a[p.name]=!0,m=c(p,{}),m.forEach(function(u){a[u]=
!0}))})})},c=function(k,m){k.incidences.forEach(function(p){m[p]||(m[p]=!0,c(E.csnames[p],m))});return Object.keys(m)};b();var d=function(k){return k.holds()};Object.keys(a).forEach(function(k){k=E.csnames[k].args;"undefined"!==typeof k&&k.forEach(function(m){a[m]=!0})});for(let k=0;3>k;k++){for(const m in a){const p=E.csnames[m];if(!p.pinned&&t[p.type].isMovable){var f=t[p.type].getRandomMove(p);Rb(p,f.value,f.type);Sb=Sb.filter(d)}}b()}Hb.set(Rc.prover);Ne();for(b=0;b<Sb.length;++b)Sb[b].apply();
Sb=[]}}function ke(a,b,c){var d=document.createElement("div"),f=document.createElement("img");f.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAPoCAQAAAC1v1zVAAAAGklEQVR42u3BMQEAAADCoPVPbQ0PoAAAgHcDC7gAAVI8ZnwAAAAASUVORK5CYII=";d.className="CindyJS-baseline";d.appendChild(f);f=document.createElement("div");f.className="CindyJS-button";d.appendChild(f);for(let k=2;k<arguments.length;++k)f.appendChild(arguments[k]);jb.parentNode.appendChild(d);a.html=arguments[arguments.length-1];Ub(a.fillalpha)||
(a.fillalpha=1);a.fillcolor&&(a.html.style.backgroundColor=L.makeColor(a.fillcolor,a.fillalpha));Ub(a.alpha)||(a.alpha=1);a.color&&(a.html.style.color=L.makeColor(a.color,a.alpha));d=l;if(a.script){const k=qc(a.script);d=function(){K(k);l()}}c.addEventListener(b,d);!aa.keylistener&&(Ha.keydown||Ha.keyup||Ha.keytyped)&&(c.addEventListener("keydown",function(k){9!==k.keyCode&&D(k,Ha.keydown)}),c.addEventListener("keyup",function(k){D(k,Ha.keyup)}),c.addEventListener("keypress",function(k){9!==k.keyCode&&
D(k,Ha.keytyped)}));t.Text.initialize(a)}function ic(){}function le(a){if(!/^Select/.test(a.type)&&!t[a.type].isMovable)return null;const b=G.unwrap,c=n.add;switch(a.kind){case "P":case "L":case "Text":return b(a.homog);case "C":return a=a.matrix.value,{xx:b(a[0].value[0]),yy:b(a[1].value[1]),zz:b(a[2].value[2]),xy:b(c(a[0].value[1],a[1].value[0])),xz:b(c(a[0].value[2],a[2].value[0])),yz:b(c(a[1].value[2],a[2].value[1]))};default:return null}}function me(a){const b={};b.offset=G.unwrap(a.offset);
a.to&&(b.to=a.to);a.corner&&(b.corner=a.corner);return b}function Fd(a){const b={},c={pinned:!1,movable:!0};"P"===a.kind&&Fe(c);"L"===a.kind&&hd(c);"C"===a.kind&&hd(c);"S"===a.kind&&Ge(c);"Text"===a.kind&&He(c);"Poly"===a.kind&&Ie(c);Ef.forEach(function(f){if(a.hasOwnProperty(f)){var k=G.unwrap(a[f]),m=G.unwrap(c[f]);null!==k&&void 0!==k&&k!==m&&JSON.stringify(k)!==JSON.stringify(m)&&(b[f]=k)}});if("P"===a.kind&&(!a.movable||a.pinned)&&b.color){var d=n.real(1/vb.dimDependent);b.color=G.unwrap(h.scalmult(d,
a.color))}if(d=le(a))b.pos=d;a.dock&&(b.dock=me(a.dock));return b}function Gd(){const a=[];E.gslp.forEach(function(b){b.tmp||a.push(Fd(b))});return a}function kf(){nc.forEach(function(a){const b=(a.geo||[]).map(function(c){return E.csnames[c]});Ia[a.type].reset(a,b[0],b)})}function rd(a){qf=0!==a.length;nc=[];Lb=[];vf=[];Ia.Environment.init({});a.forEach(function(b){b.behavior?(b.name&&(b.behavior.geo=[b.name]),b=b.behavior,b.gravity&&(b.gravity=-b.gravity)):c=b.geo;var c=(b.geo||[]).map(function(k){return E.csnames[k]});
const d=c[0],f=Ia[b.type];f?(f.init&&f.init(b,d,c),d&&(d.behavior=b,"Mass"===b.type?Lb.push(d):"Spring"===b.type&&vf.push(d)),nc.push(b)):(console.error(b),console.error("Behavior "+b.type+" not implemented yet"))})}const Ab=this;let Fb;const Ha={};let yc=!1,Ob=!0,Xc=0,Ue=.5,Ve=0,Hd=10;const We=5/360,Id=.32/We/1E3*2;let Jd=1,Tb=0,pe=0,td=!1,ld=.2,Zc=!1,Kd=0,Ld=0,rb=1,jb,Md;const Ub=Number.isFinite||function(a){return"number"===typeof a&&isFinite(a)};let Pb;var P,$a,fb;let E,Bc,$c=B,Nd=B;const sc=
{play:ic,pause:ic,stop:ic};var qe=null,ad=function(a,b){let c=[];ad=function(k,m){c.push({img:k,id:m})};ad(a,b);const d=Ab.getBaseDir()+"images/Icons.svg",f=new XMLHttpRequest;f.onreadystatechange=function(){if(f.readyState===XMLHttpRequest.DONE)if(200!==f.status)console.error("Failed to load CindyJS Icons.svg from "+d+": "+f.statusText);else{var k=f.responseXML,m=k.documentElement,p={},u;for(u=m.firstChild;u;u=x){var x=u.nextSibling;u.nodeType===Node.ELEMENT_NODE&&"http://www.w3.org/2000/svg"===
u.namespaceURI&&"g"===u.localName.toLowerCase()&&(m.removeChild(u),u.setAttribute("style","display:inline"),p[u.getAttribute("id")]=u)}var y=new XMLSerializer;ad=function(C,F){if(p.hasOwnProperty(F)){F=p[F];m.appendChild(F);try{var H=y.serializeToString(k)}finally{m.removeChild(F)}C.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(H)}};c.forEach(function(C){ad(C.img,C.id)});c=null}};f.responseType="document";f.open("GET",d);f.send()};let re=1,ud=null;const Hc=[];let vd=!1;var Kb={config:aa,
startup:ob,shutdown:Db,evokeCS:function(a){a=qc(a,!1);K(a);l()},play:S,pause:ua,stop:Ea,evalcs:function(a){return K(qc(a,!1))},parse:function(a){return qc(a)},niceprint:fa,canvas:null},Od=!1,Pd=0;aa.use&&aa.use.forEach(function(a){let b=null;aa.plugins&&(b=aa.plugins[a]);b||(b=Ab._pluginRegistry[a]);b||(++Pd,console.log("Loading script for plugin "+a),Ab.loadScript(a+"-plugin",a+"-plugin.js",function(){console.log("Successfully loaded plugin "+a);0===--Pd&&Od&&ob()},function(){console.error("Failed to auto-load plugin "+
a);0===--Pd&&Od&&ob()}))});Qb.prototype=new Mb;Jb.prototype=new Mb;Eb.prototype=new Mb;const bb={};let tb,Ye="",se=0,Xb=0;const tc={},bd={};var te=aa.isNode?process.nextTick:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,0)};let cc=null;var jc=[0,8,13,51,"gbf6f518"];const n={_helper:{}};n._helper.roundingfactor=1E4;n._helper.angleroundingfactor=10;n._helper.niceround=
function(a,b){return Math.round(a*b)/b};n.niceprint=function(a,b){b=b||n._helper.roundingfactor;if("Angle"===a.usage)return n._helper.niceangle(a);const c=n._helper.niceround(a.value.real,b);a=n._helper.niceround(a.value.imag,b);return 0===a?""+c:0<a?""+c+" + i*"+a:""+c+" - i*"+-a};const Qd=aa.angleUnit||"\u00b0",of=Qd.replace(/\s+/g,""),ue=2*Math.PI,ve=1/ue,pf={rad:ue,"\u00b0":360,deg:360,degree:360,gra:400,grad:400,turn:1,cyc:1,rev:1,rot:1,"\u03c0":2,pi:2,quad:4};n._helper.niceangle=function(a){const b=
pf[of];if(!b)return n.niceprint(G.withUsage(a,null));if("function"===typeof b)return b(a);a=n.niceprint(n.realmult(b*ve,a),200<b?n._helper.angleroundingfactor:null);return a.includes("i*")?"("+a+")"+Qd:a+Qd};n.complex=function(a,b){return{ctype:"number",value:{real:a,imag:b}}};n.real=function(a){return{ctype:"number",value:{real:a,imag:0}}};n.zero=n.real(0);n.one=n.real(1);n.infinity=n.complex(Infinity,Infinity);n.nan=n.complex(NaN,NaN);n._helper.input=function(a){return"object"===typeof a?n.complex(+a.r,
+a.i):n.real(+a)};n.argmax=function(a,b){return a.value.real*a.value.real+a.value.imag*a.value.imag<b.value.real*b.value.real+b.value.imag*b.value.imag?b:a};n.max=function(a,b){return{ctype:"number",value:{real:Math.max(a.value.real,b.value.real),imag:Math.max(a.value.imag,b.value.imag)}}};n.min=function(a,b){return{ctype:"number",value:{real:Math.min(a.value.real,b.value.real),imag:Math.min(a.value.imag,b.value.imag)}}};n.add=function(a,b){return{ctype:"number",value:{real:a.value.real+b.value.real,
imag:a.value.imag+b.value.imag}}};n.sub=function(a,b){return{ctype:"number",value:{real:a.value.real-b.value.real,imag:a.value.imag-b.value.imag}}};n.neg=function(a){return Object.assign({},a,{ctype:"number",value:{real:-a.value.real,imag:-a.value.imag}})};n.re=function(a){return{ctype:"number",value:{real:a.value.real,imag:0}}};n.im=function(a){return{ctype:"number",value:{real:a.value.imag,imag:0}}};n.conjugate=function(a){return{ctype:"number",value:{real:a.value.real,imag:-a.value.imag}}};n.round=
function(a){return{ctype:"number",value:{real:Math.round(a.value.real),imag:Math.round(a.value.imag)}}};n.ceil=function(a){return{ctype:"number",value:{real:Math.ceil(a.value.real),imag:Math.ceil(a.value.imag)}}};n.floor=function(a){return{ctype:"number",value:{real:Math.floor(a.value.real),imag:Math.floor(a.value.imag)}}};n.mult=function(a,b){return{ctype:"number",value:{real:a.value.real*b.value.real-a.value.imag*b.value.imag,imag:a.value.real*b.value.imag+a.value.imag*b.value.real}}};n.realmult=
function(a,b){return{ctype:"number",value:{real:a*b.value.real,imag:a*b.value.imag}}};n.multiMult=function(a){let b=a[0];if("number"!==b.ctype)return B;for(let c=1;c<a.length;c++){if("number"!==a[c].ctype)return B;b=n.mult(b,a[c])}return b};n.abs2=function(a){return{ctype:"number",value:{real:a.value.real*a.value.real+a.value.imag*a.value.imag,imag:0}}};n.abs=function(a){return n.sqrt(n.abs2(a))};n.inv=function(a){const b=a.value.real*a.value.real+a.value.imag*a.value.imag;return{ctype:"number",value:{real:a.value.real/
b,imag:-a.value.imag/b}}};n.div=function(a,b){const c=a.value.real;a=a.value.imag;const d=b.value.real;b=b.value.imag;const f=d*d+b*b;return{ctype:"number",value:{real:(c*d+a*b)/f,imag:(a*d-c*b)/f}}};n.eps=1E-10;n.epsbig=1E-6;n.snap=function(a){let b=a.value.real,c=a.value.imag;Math.floor(b+n.eps)!==Math.floor(b-n.eps)&&(b=Math.round(b));Math.floor(c+n.eps)!==Math.floor(c-n.eps)&&(c=Math.round(c));return Object.assign({},a,{ctype:"number",value:{real:b,imag:c}})};n.exp=function(a){const b=Math.exp(a.value.real);
return{ctype:"number",value:{real:b*Math.cos(a.value.imag),imag:b*Math.sin(a.value.imag)}}};n.cos=function(a){const b=a.value.real;a=a.value.imag;let c=Math.exp(a);const d=c*Math.sin(-b),f=c*Math.cos(-b);c=Math.exp(-a);return{ctype:"number",value:{real:(f+c*Math.cos(b))/2,imag:(d+c*Math.sin(b))/2}}};n.sin=function(a){const b=a.value.real;a=a.value.imag;let c=Math.exp(a);const d=c*Math.sin(-b),f=c*Math.cos(-b);c=Math.exp(-a);return{ctype:"number",value:{real:-(d-c*Math.sin(b))/2,imag:(f-c*Math.cos(b))/
2}}};n.tan=function(a){const b=n.sin(a);a=n.cos(a);return n.div(b,a)};n.arccos=function(a){var b=n.mult(a,n.neg(a));b=n.sqrt(n.add(n.real(1),b));a=n.add(n.mult(a,n.complex(0,1)),b);a=n.add(n.mult(n.log(a),n.complex(0,1)),n.real(.5*Math.PI));return G.withUsage(a,"Angle")};n.arcsin=function(a){var b=n.mult(a,n.neg(a));b=n.sqrt(n.add(n.real(1),b));a=n.add(n.mult(a,n.complex(0,1)),b);a=n.mult(n.log(a),n.complex(0,-1));return G.withUsage(a,"Angle")};n.arctan=function(a){var b=n.log(n.add(n.mult(a,n.complex(0,
-1)),n.real(1)));a=n.log(n.add(n.mult(a,n.complex(0,1)),n.real(1)));b=n.mult(n.sub(b,a),n.complex(0,.5));return G.withUsage(b,"Angle")};n.arctan2=function(a,b){if(void 0===b)var c=n.real(Math.atan2(a.value.imag,a.value.real));else n._helper.isReal(a)&&n._helper.isReal(b)?c=n.real(Math.atan2(b.value.real,a.value.real)):(c=n.add(a,n.mult(n.complex(0,1),b)),a=n.sqrt(n.add(n.mult(a,a),n.mult(b,b))),c=n.mult(n.complex(0,-1),n.log(n.div(c,a))));return G.withUsage(c,"Angle")};n.sqrt=function(a){var b=a.value.real;
const c=a.value.imag;a=Math.sqrt(Math.sqrt(b*b+c*c));b=Math.atan2(c,b);return{ctype:"number",value:{real:a*Math.cos(b/2),imag:a*Math.sin(b/2)}}};n.powRealExponent=function(a,b){var c=a.value.real;const d=a.value.imag;a=Math.sqrt(c*c+d*d)**b;c=Math.atan2(d,c);return{ctype:"number",value:{real:a*Math.cos(c*b),imag:a*Math.sin(c*b)}}};n.powIntegerExponent=function(a,b){return 0>b?n.powIntegerExponent(n.inv(a),-b):0===b?n.one:0===b%2?n.powIntegerExponent(n.mult(a,a),b/2):1===b%2?n.mult(a,n.powIntegerExponent(n.mult(a,
a),(b-1)/2)):B};n.log=function(a){const b=a.value.real;a=a.value.imag;const c=Math.sqrt(b*b+a*a);let d=Math.atan2(a,b);0>a&&(d+=2*Math.PI);0===a&&0>b&&(d=Math.PI);d>Math.PI&&(d-=2*Math.PI);return n.snap({ctype:"number",value:{real:Math.log(c),imag:d}})};n.pow=function(a,b){return n._helper.isZero(b)?n.one:n._helper.isZero(a)?n.zero:[a,b].every(n._helper.isReal)?n.real(a.value.real**b.value.real):n._helper.isReal(b)?(b=b.value.real,Number.isInteger(b)?n.powIntegerExponent(a,b):n.powRealExponent(a,
b)):n.exp(n.mult(n.log(a),b))};n.mod=function(a,b){var c=a.value.real;const d=b.value.real;var f=a.value.imag;const k=b.value.imag;c-=Math.floor(c/d)*d;f-=Math.floor(f/k)*k;0===d&&(c=0);0===k&&(f=0);return n.snap(Object.assign({},[a,b].every(m=>"Angle"===m.usage)&&{usage:"Angle"},{ctype:"number",value:{real:c,imag:f}}))};n._helper.seed="NO";n._helper.seedrandom=function(a){a-=Math.floor(a);n._helper.seed=.8*a+.1};n._helper.rand=function(){if("NO"===n._helper.seed)return Math.random();let a=n._helper.seed;
a=1E3*Math.sin(1E3*a);a-=Math.floor(a);return n._helper.seed=a};n._helper.randnormal=function(){const a=n._helper.rand(),b=n._helper.rand();return Math.sqrt(-2*Math.log(a))*Math.cos(2*Math.PI*b)};n._helper.isEqual=function(a,b){return a.value.real===b.value.real&&a.value.imag===b.value.imag};n._helper.isLessThan=function(a,b){return a.value.real<b.value.real||a.value.real===b.value.real&&a.value.imag<b.value.imag};n._helper.compare=function(a,b){return n._helper.isLessThan(a,b)?-1:n._helper.isEqual(a,
b)?0:1};n._helper.isAlmostEqual=function(a,b,c){let d=n.eps;"undefined"!==typeof c&&(d=c);c=a.value.real-b.value.real;a=a.value.imag-b.value.imag;return c<d&&c>-d&&a<d&&a>-d};n._helper.isZero=function(a){return 0===a.value.real&&0===a.value.imag};n._helper.isAlmostZero=function(a){const b=a.value.real;a=a.value.imag;return b<n.eps&&b>-n.eps&&a<n.eps&&a>-n.eps};n._helper.isReal=function(a){return 0===a.value.imag};n._helper.isAlmostReal=function(a){a=a.value.imag;return a<n.epsbig&&a>-n.epsbig};n._helper.isNaN=
function(a){return isNaN(a.value.real)||isNaN(a.value.imag)};n._helper.isFinite=function(a){return isFinite(a.value.real)&&isFinite(a.value.imag)};n._helper.isAlmostImag=function(a){a=a.value.real;return a<n.epsbig&&a>-n.epsbig};n._helper.z3a=n.complex(-.5,.5*Math.sqrt(3));n._helper.z3b=n.complex(-.5,-.5*Math.sqrt(3));n._helper.cub1={ctype:"list",value:[n.one,n.one,n.one]};n._helper.cub2={ctype:"list",value:[n._helper.z3a,n.one,n._helper.z3b]};n._helper.cub3={ctype:"list",value:[n._helper.z3b,n.one,
n._helper.z3a]};n.solveCubic=function(a,b,c,d){a=n._helper.solveCubicHelper(a,b,c,d);return[h.scalproduct(n._helper.cub1,a),h.scalproduct(n._helper.cub2,a),h.scalproduct(n._helper.cub3,a)]};n._helper.solveCubicHelper=function(a,b,c,d){var f=a.value.real;a=a.value.imag;var k=b.value.real;b=b.value.imag;var m=c.value.real;const p=c.value.imag,u=d.value.real,x=d.value.imag;var y=f*m-a*p;c=f*p+a*m;d=4*y-(k*k-b*b);var C=4*c-2*k*b;const F=f*k-a*b,H=f*b+a*k,Q=d*m-C*p-18*(F*u-H*x);C=d*p+C*m-18*(F*x+H*u);
d=27*(f*f-a*a);var T=54*a*f;const X=d*u-T*x,U=d*x+T*u,pa=k*k-b*b;var ca=2*k*b;let Ba=pa*k-ca*b,Pa=pa*b+ca*k,ta=X+4*Ba;T=U+4*Pa;d=27*(Q*m-C*p+ta*u-T*x);C=27*(Q*p+C*m+ta*x+T*u);ta=Math.sqrt(Math.sqrt(d*d+C*C));T=Math.atan2(C,d);C=ta*Math.sin(T/2);d=ta*Math.cos(T/2);Ba=-2*Ba+9*(F*m-H*p)-X+(d*f-C*a);Pa=-2*Pa+9*(F*p+H*m)-U+(d*a+C*f);d=Math.exp(Math.log(Math.sqrt(Ba*Ba+Pa*Pa))/3);m=Math.atan2(Pa,Ba);T=d*Math.sin(m/3);C=d*Math.cos(m/3);d*=d;m*=2;y=2*pa-6*y;c=2*ca-6*c;ca=-1.5874010519681996*(k*C-b*T);k=-1.5874010519681996*
(k*T+b*C);b=1.2599210498948732*d*Math.cos(m/3);m=1.2599210498948732*d*Math.sin(m/3);d=4.762203155904599*(C*f-T*a);C=4.762203155904599*(C*a+T*f);f=d*d+C*C;T=(-y*C+c*d)/f;y=(y*d+c*C)/f;c=T;T=(-ca*C+k*d)/f;ca=(ca*d+k*C)/f;k=T;T=(-b*C+m*d)/f;b=(b*d+m*C)/f;m=T;return h.turnIntoCSList([n.complex(y,c),n.complex(ca,k),n.complex(b,m)])};n._helper.getRangeRand=function(a,b){return Math.random()*(b-a)+a};n.getRandReal=function(a,b){a=n._helper.getRangeRand(a,b);return n.real(a)};n.getRandComplex=function(a,
b){const c=n._helper.getRangeRand(a,b);a=n._helper.getRangeRand(a,b);return n.complex(c,a)};const h={_helper:{},turnIntoCSList:function(a){return{ctype:"list",value:a}}};h.EMPTY=h.turnIntoCSList([]);h.asList=function(a){return"list"===a.ctype?a:"number"===a.ctype||"boolean"===a.ctype||"geo"===a.ctype?h.turnIntoCSList([a]):h.EMPTY};h.realVector=function(a){const b=[];for(let c=0;c<a.length;c++)b[c]={ctype:"number",value:{real:a[c],imag:0}};return{ctype:"list",value:b}};h._helper.unitvector=function(a,
b){a=h.zerovector(a);a.value[Math.floor(b.value.real-1)]=n.real(1);return a};h.idMatrix=function(a){const b=h.zeromatrix(a,a),c=n.real(1);for(let d=0;d<a.value.real;d++)b.value[d].value[d]=c;return b};h._helper.flippedidMatrix=function(a){const b=h.zeromatrix(a,a),c=n.real(1);for(let d=0;d<a.value.real;d++)b.value[d].value[a.value.real-d-1]=c;return b};h.println=function(a){const b=[];for(let c=0;c<a.value.length;c++)if("number"===a.value[c].ctype)b[c]=n.niceprint(a.value[c]);else if("list"===a.value[c].ctype)h.println(a.value[c]);
else return B;"number"===a.value[0].ctype&&console.log(b)};h.matrix=function(a){return h.turnIntoCSList(a.map(h.turnIntoCSList))};h.realMatrix=function(a){const b=a.length,c=Array(b);for(let d=0;d<b;d++)c[d]=h.realVector(a[d]);return h.turnIntoCSList(c)};h.ex=h.realVector([1,0,0]);h.ey=h.realVector([0,1,0]);h.ez=h.realVector([0,0,1]);h.linfty=h.realVector([0,0,1]);h.ii=h.turnIntoCSList([n.complex(1,0),n.complex(0,1),n.complex(0,0)]);h.jj=h.turnIntoCSList([n.complex(1,0),n.complex(0,-1),n.complex(0,
0)]);h.fundDual=h.realMatrix([[1,0,0],[0,1,0],[0,0,0]]);h.fund=h.realMatrix([[0,0,0],[0,0,0],[0,0,1]]);h.sequence=function(a,b){a=Math.ceil(a.value.real);b=Math.floor(b.value.real)+1;let c=[];for(let d=a,f=0;d<b;d++,f++)c[f]=n.real(d);return h.turnIntoCSList(c)};h.pairs=function(a){const b=[];for(let c=0;c<a.value.length-1;c++)for(let d=c+1;d<a.value.length;d++)b.push({ctype:"list",value:[a.value[c],a.value[d]]});return{ctype:"list",value:b}};h.triples=function(a){const b=[];for(let c=0;c<a.value.length-
2;c++)for(let d=c+1;d<a.value.length-1;d++)for(let f=d+1;f<a.value.length;f++)b.push({ctype:"list",value:[a.value[c],a.value[d],a.value[f]]});return{ctype:"list",value:b}};h.cycle=function(a){const b=[];for(let c=0;c<a.value.length-1;c++)b[c]={ctype:"list",value:[a.value[c],a.value[c+1]]};b.push({ctype:"list",value:[a.value[a.value.length-1],a.value[0]]});return{ctype:"list",value:b}};h.consecutive=function(a){const b=[];for(let c=0;c<a.value.length-1;c++)b[c]={ctype:"list",value:[a.value[c],a.value[c+
1]]};return{ctype:"list",value:b}};h.reverse=function(a){const b=Array(a.value.length);for(let c=a.value.length-1,d=0;0<=c;c--,d++)b[d]=a.value[c];return{ctype:"list",value:b}};h.directproduct=function(a,b){const c=[];for(let d=0;d<a.value.length;d++)for(let f=0;f<b.value.length;f++)c.push({ctype:"list",value:[a.value[d],b.value[f]]});return{ctype:"list",value:c}};h.concat=function(a,b){const c=[];for(let d=0;d<a.value.length;d++)c.push(a.value[d]);for(a=0;a<b.value.length;a++)c.push(b.value[a]);
return{ctype:"list",value:c}};h.prepend=function(a,b){const c=[];c[0]=a;for(a=0;a<b.value.length;a++)c[a+1]=b.value[a];return{ctype:"list",value:c}};h.append=function(a,b){const c=[];for(let d=0;d<a.value.length;d++)c[d]=a.value[d];c.push(b);return{ctype:"list",value:c}};h.contains=function(a,b){for(const c of a.value)if(A.equals(c,b).value)return{ctype:"boolean",value:!0};return{ctype:"boolean",value:!1}};h.common=function(a,b){const c=[];let d=0;for(let f=0;f<a.value.length;f++){let k=!1;const m=
a.value[f];for(let p=0;p<b.value.length;p++)k=k||A.equals(m,b.value[p]).value;k&&(c[d]=a.value[f],d++)}return{ctype:"list",value:c}};h.remove=function(a,b){const c=[];let d=0;for(let f=0;f<a.value.length;f++){let k=!1;const m=a.value[f];for(let p=0;p<b.value.length;p++)k=k||A.equals(m,b.value[p]).value;k||(c[d]=a.value[f],d++)}return{ctype:"list",value:c}};h.sort1=function(a){a=a.value.slice();a.sort(G.compare);return h.turnIntoCSList(a)};h._helper.isEqual=function(a,b){return h.equals(a,b).value};
h._helper.isLessThan=function(a,b){const c=a.value.length,d=b.value.length;let f=0;for(;!(f>=c||f>=d)&&G.isEqual(a.value[f],b.value[f]);)f++;return f===c&&f<d?!0:f===d&&f<c||f===c&&f===d?!1:G.isLessThan(a.value[f],b.value[f])};h._helper.compare=function(a,b){return h._helper.isLessThan(a,b)?-1:h._helper.isEqual(a,b)?0:1};h.equals=function(a,b){if(a.value.length!==b.value.length)return{ctype:"boolean",value:!1};let c=!0;for(let d=0;d<a.value.length;d++){const f=a.value[d],k=b.value[d];c="list"===f.ctype&&
"list"===k.ctype?c&&h.equals(f,k).value:c&&Ra([f,k],[]).value}return{ctype:"boolean",value:c}};h.almostequals=function(a,b){if(a.value.length!==b.value.length)return{ctype:"boolean",value:!1};let c=!0;for(let d=0;d<a.value.length;d++){const f=a.value[d],k=b.value[d];c="list"===f.ctype&&"list"===k.ctype?c&&h.almostequals(f,k).value:c&&Qa([f,k],[]).value}return{ctype:"boolean",value:c}};h._helper.isAlmostReal=function(a){let b=!0;for(const c of a.value)b="list"===c.ctype?b&&h._helper.isAlmostReal(c):
b&&n._helper.isAlmostReal(c);return b};h._helper.isAlmostZero=function(a){for(const b of a.value)if("list"===b.ctype){if(!h._helper.isAlmostZero(b))return!1}else if(!n._helper.isAlmostZero(b))return!1;return!0};h._helper.isNaN=function(a){let b=!1;for(const c of a.value)b="list"===c.ctype?b||h._helper.isNaN(c):b||n._helper.isNaN(c);return b};h.set=function(a){const b=[];let c=0;a=a.value.slice();a.sort(G.compare);for(let d=0;d<a.length;d++)0!==d&&Ra([b[b.length-1],a[d]],[]).value||(b[c]=a[d],c++);
return{ctype:"list",value:b}};h.maxval=function(a){let b=n.zero;for(const c of a.value)"number"===c.ctype&&(b=n.argmax(b,c)),"list"===c.ctype&&(b=n.argmax(b,h.maxval(c)));return b};h.maxIndex=function(a,b,c){var d=0;void 0!==c&&(d=c);c=d;let f=b(a.value[d]).value.real;for(;d<a.value.length;++d){const k=b(a.value[d]).value.real;k>f&&(c=d,f=k)}return c};h.normalizeMax=function(a){const b=n.inv(h.maxval(a));return n._helper.isFinite(b)?h.scalmult(b,a):a};h.normalizeZ=function(a){const b=n.inv(a.value[2]);
return h.scalmult(b,a)};h.dehom=function(a){a=a.value.slice();const b=a.length-1,c=n.inv(a[b]);a.length=b;for(let d=0;d<b;++d)a[d]=n.mult(c,a[d]);return h.turnIntoCSList(a)};h.normalizeAbs=function(a){const b=n.inv(h.abs(a));return h.scalmult(b,a)};h.max=function(a,b){if(a.value.length!==b.value.length)return B;const c=[];for(let d=0;d<a.value.length;d++)c[d]=G.max(a.value[d],b.value[d]);return{ctype:"list",value:c}};h.min=function(a,b){if(a.value.length!==b.value.length)return B;const c=[];for(let d=
0;d<a.value.length;d++)c[d]=G.min(a.value[d],b.value[d]);return{ctype:"list",value:c}};h.scaldiv=function(a,b){if("number"!==a.ctype)return B;const c=[];for(let d=0;d<b.value.length;d++){const f=b.value[d];c[d]="number"===f.ctype?G.div(f,a):"list"===f.ctype?h.scaldiv(a,f):B}return{ctype:"list",value:c}};h.scalmult=function(a,b){if("number"!==a.ctype)return B;const c=[];for(let d=0;d<b.value.length;d++){const f=b.value[d];c[d]="number"===f.ctype?G.mult(f,a):"list"===f.ctype?h.scalmult(a,f):B}return{ctype:"list",
value:c}};h.add=function(a,b){if(a.value.length!==b.value.length)return B;const c=[];for(let d=0;d<a.value.length;d++){const f=a.value[d],k=b.value[d];c[d]="number"===f.ctype&&"number"===k.ctype?G.add(f,k):"list"===f.ctype&&"list"===k.ctype?h.add(f,k):B}return{ctype:"list",value:c}};h.sub=function(a,b){if(a.value.length!==b.value.length)return B;const c=[];for(let d=0;d<a.value.length;d++){const f=a.value[d],k=b.value[d];c[d]="number"===f.ctype&&"number"===k.ctype?n.sub(f,k):"list"===f.ctype&&"list"===
k.ctype?h.sub(f,k):B}return{ctype:"list",value:c}};h.abs2=function(a){let b=0;for(const c of a.value)if("number"===c.ctype)b+=n.abs2(c).value.real;else if("list"===c.ctype)b+=h.abs2(c).value.real;else return B;return{ctype:"number",value:{real:b,imag:0}}};h.abs=function(a){return n.sqrt(h.abs2(a))};h.normalizeMaxXX=function(a){let b=-1E4,c=n.real(1);for(let d=0;d<a.value.length;d++){const f=n.abs(a.value[d]);f.value.real>b&&(c=a.value[d],b=f.value.real)}return h.scaldiv(c,a)};h.recursive=function(a,
b){const c=[];for(let d=0;d<a.value.length;d++){const f=V(a.value[d]);c[d]="number"===f.ctype?n[b](f):"list"===f.ctype?h[b](f):B}return{ctype:"list",value:c}};h.re=function(a){return h.recursive(a,"re")};h.neg=function(a){return h.recursive(a,"neg")};h.im=function(a){return h.recursive(a,"im")};h.conjugate=function(a){return h.recursive(a,"conjugate")};h.transjugate=function(a){return h.transpose(h.conjugate(a))};h.round=function(a){return h.recursive(a,"round")};h.ceil=function(a){return h.recursive(a,
"ceil")};h.floor=function(a){return h.recursive(a,"floor")};h._helper.colNumb=function(a){if("list"!==a.ctype)return-1;let b=-1;for(let c=0;c<a.value.length;c++){if("list"!==a.value[c].ctype)return-1;if(0===c)b=a.value[c].value.length;else if(b!==a.value[c].value.length)return-1}return b};h._helper.isNumberVecN=function(a,b){if("list"!==a.ctype||a.value.length!==b)return!1;for(b=0;b<a.value.length;b++)if("number"!==a.value[b].ctype)return!1;return!0};h.isNumberVector=function(a){if("list"!==a.ctype)return{ctype:"boolean",
value:!1};for(let b=0;b<a.value.length;b++)if("number"!==a.value[b].ctype)return{ctype:"boolean",value:!1};return{ctype:"boolean",value:!0}};h.isNumberVectorN=function(a,b){if("list"!==a.ctype)return{ctype:"boolean",value:!1};if(a.value)for(b=0;b<a.value.length;b++)if("number"!==a.value[b].ctype)return{ctype:"boolean",value:!1};return{ctype:"boolean",value:!0}};h.isNumberMatrix=function(a){if(-1===h._helper.colNumb(a))return{ctype:"boolean",value:!1};for(let b=0;b<a.value.length;b++)if(!h.isNumberVector(a.value[b]).value)return{ctype:"boolean",
value:!1};return{ctype:"boolean",value:!0}};h._helper.isNumberMatrixMN=function(a,b,c){return h.isNumberMatrix(a).value&&a.value.length===b&&a.value[0].value.length===c};h.scalproduct=function(a,b){if(a.value.length!==b.value.length)return B;let c={ctype:"number",value:{real:0,imag:0}};for(let d=0;d<b.value.length;d++){const f=a.value[d],k=b.value[d];if("number"===f.ctype&&"number"===k.ctype)c=n.add(n.mult(f,k),c);else return B}return c};h.sesquilinearproduct=function(a,b){if(a.value.length!==b.value.length)return B;
let c=0,d=0;for(let f=0;f<b.value.length;f++){const k=a.value[f].value,m=b.value[f].value;c+=k.real*m.real+k.imag*m.imag;d+=k.real*m.imag-k.imag*m.real}return n.complex(c,d)};h.normSquared=function(a){let b=0;for(let c=0;c<a.value.length;c++){const d=a.value[c].value;b+=d.real*d.real+d.imag*d.imag}return n.real(b)};h.productMV=function(a,b){if(a.value[0].value.length!==b.value.length)return B;const c=[];for(let d=0;d<a.value.length;d++){let f={ctype:"number",value:{real:0,imag:0}};const k=a.value[d];
for(let m=0;m<b.value.length;m++){const p=k.value[m],u=b.value[m];if("number"===p.ctype&&"number"===u.ctype)f=n.add(n.mult(p,u),f);else return B}c[d]=f}return h.turnIntoCSList(c)};h.productVM=function(a,b){if(a.value.length!==b.value.length)return B;const c=[];for(let d=0;d<b.value[0].value.length;d++){let f={ctype:"number",value:{real:0,imag:0}};for(let k=0;k<a.value.length;k++){const m=a.value[k],p=b.value[k].value[d];if("number"===m.ctype&&"number"===p.ctype)f=n.add(n.mult(m,p),f);else return B}c[d]=
f}return h.turnIntoCSList(c)};h.productMM=function(a,b){if(a.value[0].value.length!==b.value.length)return B;const c=[];for(let d=0;d<a.value.length;d++){const f=h.productVM(a.value[d],b);c[d]=f}return h.turnIntoCSList(c)};h.mult=function(a,b){return a.value.length===b.value.length&&h.isNumberVector(a).value&&h.isNumberVector(b).value?h.scalproduct(a,b):h.isNumberMatrix(a).value&&b.value.length===a.value[0].value.length&&h.isNumberVector(b).value?h.productMV(a,b):h.isNumberMatrix(b).value&&a.value.length===
b.value.length&&h.isNumberVector(a).value?h.productVM(a,b):h.isNumberMatrix(a).value&&h.isNumberMatrix(b).value&&b.value.length===a.value[0].value.length?h.productMM(a,b):B};h.projectiveDistMinScal=function(a,b){const c=h.abs(a);var d=h.abs(b);if(0===c.value.real||0===d.value.real)return 0;var f=h.conjugate(b);f=h.scalproduct(a,f);f=n._helper.isAlmostZero(f)?n.real(1):n.div(f,n.abs(f));a=h.scaldiv(c,a);b=h.scaldiv(d,b);b=h.scalmult(f,b);d=h.abs(h.add(a,b));b=h.abs(h.sub(a,b));return Math.min(d.value.real,
b.value.real)};h.conicDist=function(a,b){a=da(a);b=da(b);return h.projectiveDistMinScal(a,b)};h.crossOperator=function(a){const b=a.value[0],c=a.value[1];a=a.value[2];return h.turnIntoCSList([h.turnIntoCSList([n.zero,n.neg(a),c]),h.turnIntoCSList([a,n.zero,n.neg(b)]),h.turnIntoCSList([n.neg(c),b,n.zero])])};h.cross=function(a,b){const c=n.sub(n.mult(a.value[1],b.value[2]),n.mult(a.value[2],b.value[1])),d=n.sub(n.mult(a.value[2],b.value[0]),n.mult(a.value[0],b.value[2]));a=n.sub(n.mult(a.value[0],
b.value[1]),n.mult(a.value[1],b.value[0]));return h.turnIntoCSList([c,d,a])};h.crossratio3harm=function(a,b,c,d,f){var k=h.det3(a,c,f),m=h.det3(b,d,f);a=h.det3(a,d,f);b=h.det3(b,c,f);k=n.mult(k,m);m=n.mult(a,b);return h.turnIntoCSList([k,m])};h.crossratio3=function(a,b,c,d,f){a=h.crossratio3harm(a,b,c,d,f);return n.div(a.value[0],a.value[1])};h.veronese=function(a){const b=n.mult(a.value[0],a.value[0]),c=n.mult(a.value[1],a.value[1]),d=n.mult(a.value[2],a.value[2]),f=n.mult(a.value[0],a.value[1]),
k=n.mult(a.value[0],a.value[2]);a=n.mult(a.value[1],a.value[2]);return h.turnIntoSCList([b,c,d,f,k,a])};h.matrixFromVeronese=function(a){const b=a.value[0],c=a.value[1],d=a.value[2],f=n.realmult(.5,a.value[3]),k=n.realmult(.5,a.value[4]);a=n.realmult(.5,a.value[5]);return h.turnIntoCSList([h.turnIntoCSList([b,f,k]),h.turnIntoCSList([f,c,a]),h.turnIntoCSList([k,a,d])])};h.det2=function(a,b){let c=n.mult(a.value[0],b.value[1]);return c=n.sub(c,n.mult(a.value[1],b.value[0]))};h.det3=function(a,b,c){return n.complex(a.value[0].value.real*
b.value[1].value.real*c.value[2].value.real-a.value[0].value.imag*b.value[1].value.imag*c.value[2].value.real-a.value[0].value.imag*b.value[1].value.real*c.value[2].value.imag-a.value[0].value.real*b.value[1].value.imag*c.value[2].value.imag+a.value[2].value.real*b.value[0].value.real*c.value[1].value.real-a.value[2].value.imag*b.value[0].value.imag*c.value[1].value.real-a.value[2].value.imag*b.value[0].value.real*c.value[1].value.imag-a.value[2].value.real*b.value[0].value.imag*c.value[1].value.imag+
a.value[1].value.real*b.value[2].value.real*c.value[0].value.real-a.value[1].value.imag*b.value[2].value.imag*c.value[0].value.real-a.value[1].value.imag*b.value[2].value.real*c.value[0].value.imag-a.value[1].value.real*b.value[2].value.imag*c.value[0].value.imag-a.value[0].value.real*b.value[2].value.real*c.value[1].value.real+a.value[0].value.imag*b.value[2].value.imag*c.value[1].value.real+a.value[0].value.imag*b.value[2].value.real*c.value[1].value.imag+a.value[0].value.real*b.value[2].value.imag*
c.value[1].value.imag-a.value[2].value.real*b.value[1].value.real*c.value[0].value.real+a.value[2].value.imag*b.value[1].value.imag*c.value[0].value.real+a.value[2].value.imag*b.value[1].value.real*c.value[0].value.imag+a.value[2].value.real*b.value[1].value.imag*c.value[0].value.imag-a.value[1].value.real*b.value[0].value.real*c.value[2].value.real+a.value[1].value.imag*b.value[0].value.imag*c.value[2].value.real+a.value[1].value.imag*b.value[0].value.real*c.value[2].value.imag+a.value[1].value.real*
b.value[0].value.imag*c.value[2].value.imag,-a.value[0].value.imag*b.value[1].value.imag*c.value[2].value.imag+a.value[0].value.imag*b.value[1].value.real*c.value[2].value.real+a.value[0].value.real*b.value[1].value.real*c.value[2].value.imag+a.value[0].value.real*b.value[1].value.imag*c.value[2].value.real-a.value[2].value.imag*b.value[0].value.imag*c.value[1].value.imag+a.value[2].value.imag*b.value[0].value.real*c.value[1].value.real+a.value[2].value.real*b.value[0].value.real*c.value[1].value.imag+
a.value[2].value.real*b.value[0].value.imag*c.value[1].value.real-a.value[1].value.imag*b.value[2].value.imag*c.value[0].value.imag+a.value[1].value.imag*b.value[2].value.real*c.value[0].value.real+a.value[1].value.real*b.value[2].value.real*c.value[0].value.imag+a.value[1].value.real*b.value[2].value.imag*c.value[0].value.real+a.value[0].value.imag*b.value[2].value.imag*c.value[1].value.imag-a.value[0].value.imag*b.value[2].value.real*c.value[1].value.real-a.value[0].value.real*b.value[2].value.real*
c.value[1].value.imag-a.value[0].value.real*b.value[2].value.imag*c.value[1].value.real+a.value[2].value.imag*b.value[1].value.imag*c.value[0].value.imag-a.value[2].value.imag*b.value[1].value.real*c.value[0].value.real-a.value[2].value.real*b.value[1].value.real*c.value[0].value.imag-a.value[2].value.real*b.value[1].value.imag*c.value[0].value.real+a.value[1].value.imag*b.value[0].value.imag*c.value[2].value.imag-a.value[1].value.imag*b.value[0].value.real*c.value[2].value.real-a.value[1].value.real*
b.value[0].value.real*c.value[2].value.imag-a.value[1].value.real*b.value[0].value.imag*c.value[2].value.real)};h.det4m=function(a){var b=a.value,c=b[0].value,d=c[0].value,f=+d.real,k=+d.imag;d=c[1].value;var m=+d.real,p=+d.imag;d=c[2].value;var u=+d.real;let x=+d.imag;d=c[3].value;let y=+d.real,C=+d.imag;c=b[1].value;d=c[0].value;var F=+d.real,H=+d.imag;d=c[1].value;let Q=+d.real,T=+d.imag;d=c[2].value;let X=+d.real,U=+d.imag;d=c[3].value;c=+d.real;d=+d.imag;a=f*Q-k*T-m*F+p*H;const pa=f*T+k*Q-m*
H-p*F,ca=f*X-k*U-u*F+x*H,Ba=f*U+k*X-u*H-x*F,Pa=f*c-k*d-y*F+C*H,ta=f*d+k*c-y*H-C*F,Ka=m*X-p*U-u*Q+x*T,Xa=m*U+p*X-u*T-x*Q,Ta=m*c-p*d-y*Q+C*T,La=m*d+p*c-y*T-C*Q,Oa=u*c-x*d-y*X+C*U,eb=u*d+x*c-y*U-C*X;c=b[2].value;d=c[0].value;f=+d.real;k=+d.imag;d=c[1].value;m=+d.real;p=+d.imag;d=c[2].value;u=+d.real;x=+d.imag;d=c[3].value;y=+d.real;C=+d.imag;c=b[3].value;d=c[0].value;F=+d.real;H=+d.imag;d=c[1].value;Q=+d.real;T=+d.imag;d=c[2].value;X=+d.real;U=+d.imag;d=c[3].value;c=+d.real;d=+d.imag;b=f*Q-k*T-m*F+p*
H;const ka=f*T+k*Q-m*H-p*F,xa=f*X-k*U-u*F+x*H,wb=f*U+k*X-u*H-x*F,Bb=f*c-k*d-y*F+C*H;f=f*d+k*c-y*H-C*F;k=m*X-p*U-u*Q+x*T;F=m*U+p*X-u*T-x*Q;H=m*c-p*d-y*Q+C*T;m=m*d+p*c-y*T-C*Q;p=u*c-x*d-y*X+C*U;u=u*d+x*c-y*U-C*X;return n.complex(a*p-pa*u-ca*H+Ba*m+Pa*k-ta*F+Ka*Bb-Xa*f-Ta*xa+La*wb+Oa*b-eb*ka,a*u+pa*p-ca*m-Ba*H+Pa*F+ta*k+Ka*f+Xa*Bb-Ta*wb-La*xa+Oa*ka+eb*b)};h.eucangle=function(a,b){var c=h.cross(a,h.linfty);a=h.cross(b,h.linfty);b=h.det3(h.ez,c,h.ii);c=h.det3(h.ez,c,h.jj);const d=h.det3(h.ez,a,h.ii);a=
h.det3(h.ez,a,h.jj);b=n.div(n.mult(b,a),n.mult(d,c));b=n.log(b);return b=n.mult(b,n.complex(0,.5))};h.zerovector=function(a){a=Math.floor(a.value.real);const b=Array(a);for(let c=0;c<a;c++)b[c]=0;return h.realVector(b)};h.zeromatrix=function(a,b){a=Math.floor(a.value.real);const c=Array(a);for(let d=0;d<a;d++)c[d]=h.zerovector(b);return h.turnIntoCSList(c)};h.vandermonde=function(a){const b=a.value.length,c=h.zeromatrix(b,b);for(let d=0;d<b;d++)for(let f=0;f<b;f++)c.value[d].value[f]=n.pow(a.value[d],
n.real(f-1));return c};h.transpose=function(a){const b=[],c=a.value[0].value.length,d=a.value.length;for(let f=0;f<c;f++){const k=[];for(let m=0;m<d;m++)k[m]=a.value[m].value[f];b[f]=h.turnIntoCSList(k)}return h.turnIntoCSList(b)};h.column=function(a,b){const c=[],d=a.value.length;b=Math.floor(b.value.real-1);for(let f=0;f<d;f++)c[f]=a.value[f].value[b];return h.turnIntoCSList(c)};h.row=function(a,b){const c=[],d=a.value[0].value.length;b=Math.floor(b.value.real-1);for(let f=0;f<d;f++)c[f]=a.value[b].value[f];
return h.turnIntoCSList(c)};h.adjoint2=function(a){const b=a.value[0].value[0],c=a.value[1].value[0];let d=Array(2);d[0]=h.turnIntoCSList([a.value[1].value[1],n.neg(a.value[0].value[1])]);d[1]=h.turnIntoCSList([n.neg(c),b]);return d=h.turnIntoCSList(d)};h.adjoint3=function(a){let b,c,d,f,k,m,p,u,x,y,C,F,H,Q,T;var X=a.value[0].value;var U=X[0].value;b=U.real;c=U.imag;U=X[1].value;d=U.real;f=U.imag;U=X[2].value;k=U.real;m=U.imag;X=a.value[1].value;U=X[0].value;p=U.real;u=U.imag;U=X[1].value;x=U.real;
y=U.imag;U=X[2].value;C=U.real;F=U.imag;X=a.value[2].value;U=X[0].value;a=U.real;H=U.imag;U=X[1].value;Q=U.real;T=U.imag;U=X[2].value;X=U.real;U=U.imag;return{ctype:"list",value:[{ctype:"list",value:[{ctype:"number",value:{real:x*X-C*Q-y*U+F*T,imag:x*U-C*T-Q*F+X*y}},{ctype:"number",value:{real:-d*X+k*Q+f*U-m*T,imag:-d*U+k*T+Q*m-X*f}},{ctype:"number",value:{real:d*C-k*x-f*F+m*y,imag:d*F-k*y-x*m+C*f}}]},{ctype:"list",value:[{ctype:"number",value:{real:-p*X+C*a+u*U-F*H,imag:-p*U+C*H+a*F-X*u}},{ctype:"number",
value:{real:b*X-k*a-c*U+m*H,imag:b*U-k*H-a*m+X*c}},{ctype:"number",value:{real:-b*C+k*p+c*F-m*u,imag:-b*F+k*u+p*m-C*c}}]},{ctype:"list",value:[{ctype:"number",value:{real:p*Q-x*a-u*T+y*H,imag:p*T-x*H-a*y+Q*u}},{ctype:"number",value:{real:-b*Q+d*a+c*T-f*H,imag:-b*T+d*H+a*f-Q*c}},{ctype:"number",value:{real:b*x-d*p-c*y+f*u,imag:b*y-d*u-p*f+x*c}}]}]}};h.inverse=function(a){var b=a.value.length;if(b!==a.value[0].value.length)return console.log("Inverse works only for square matrices"),B;if(2===b)return h.scaldiv(h.det(a),
h.adjoint2(a));if(3===b)return h.scaldiv(h.det(a),h.adjoint3(a));b=h.LUdecomp(a);a=a.value.length;const c=n.real(0),d=n.real(1),f=h.zerovector(n.real(a));f.value[0]=d;let k=Array(a);for(let m=0;m<a;m++)k[m]=h._helper.LUsolve(b,f),f.value[m]=c,f.value[m+1]=d;k=h.turnIntoCSList(k);return k=h.transpose(k)};h.linearsolve=function(a,b){return 2===a.value.length?h.linearsolveCramer2(a,b):3===a.value.length?h.linearsolveCramer3(a,b):h.LUsolve(a,b)};h.getDiag=function(a){if(a.value.length!==a.value[0].value.length)return B;
const b=Array(a.value.length);for(let c=0;c<a.value.length;c++)b[c]=a.value[c].value[c];return h.turnIntoCSList(b)};h.getSubDiag=function(a){if(a.value.length!==a.value[0].value.length)return B;const b=Array(a.value.length-1);for(let c=0;c<a.value.length-1;c++)b[c]=a.value[c+1].value[c];return h.turnIntoCSList(b)};h.eig2=function(a){var b=n.add(a.value[0].value[0],a.value[1].value[1]);a=h.det2(a.value[0],a.value[1]);const c=n.mult(b,b);let d=b=n.mult(b,n.real(.5));a=n.sqrt(n.sub(n.div(c,n.real(4)),
a));b=n.add(b,a);d=n.sub(d,a);return h.turnIntoCSList([b,d])};h.eig=function(a,b){var c=b||!0,d=a,f=n.real(d.value.length);b=f.value.real;n.real(0);d=h._helper.QRIteration(d)[0];d=h.getDiag(d);d=h.sort1(d);f=h.idMatrix(f,f);let k=Array(b);k=h.turnIntoCSList(k);if(c){let p,u,x=0,y=!1;for(c=0;c<b;c++){if(y)p=m.value[x];else{var m=d.value[c];m=h.sub(a,h.scalmult(m,f));m=h.nullSpace(m);p=m.value[0];void 0!==p&&(u=p)}void 0===p&&(p=u);1E-8>h.abs(p).value.real&&0===x&&(p=h._helper.inverseIteration(a,d.value[c]));
k.value[c]=h._helper.isAlmostZeroVec(p)?p:h.scaldiv(h.abs(p),p);c<b-1&&((y=1E-6>n.abs(n.sub(d.value[c],d.value[c+1])).value.real)?x++:x=0)}k=h.transpose(k)}return h.turnIntoCSList([d,k])};h._helper.isNormalMatrix=function(a){return 1E-10>h.abs(h.sub(a,h.transjugate(a))).value.real};h._helper.QRIteration=function(a,b){var c=n.real(a.value.length);const d=c.value.real;let f=c.value.real;n.real(0);h.idMatrix(c,c);const k=h.zeromatrix(c,c);c=h.idMatrix(c,c);const m=b?b:2500;let p,u=0;const x=Array(f);
for(b=0;b<m;b++){var y=h._helper.getBlock(a,[f-2,f-1],[f-2,f-1]);var C=h.eig2(y);y=C.value[0];C=C.value[1];h.abs(y);h.abs(C);var F=a.value[f-1].value[f-1];p=n.abs(n.sub(F,y)).value.real;F=n.abs(n.sub(F,C)).value.real;C=p<F?y:C;y=h.idMatrix(n.real(f),n.real(f));C=h.scalmult(C,y);y=h.QRdecomp(h.sub(a,C));a=G.mult(y.R,y.Q);a=h.add(a,C);y.Q=h._helper.buildBlockMatrix(y.Q,h.idMatrix(n.real(u),n.real(u)));c=G.mult(c,y.Q);if(1E-48>n.abs2(a.value[a.value.length-1].value[a.value[0].value.length-2]).value.real&&
1<f){x[d-u-1]=a.value[f-1].value[f-1];for(b=0;b<f;b++)k.value[f-1].value[b]=a.value[f-1].value[b],k.value[b].value[f-1]=a.value[b].value[f-1];a=h._helper.getBlock(a,[0,f-2],[0,f-2]);u++;f--}if(1===f){k.value[0].value[0]=a.value[0].value[0];break}if(h._helper.isUpperTriangular(a)){for(b=0;b<f;b++)k.value[b].value[b]=a.value[b].value[b];break}}return[k,c]};h.rank=function(a,b){return h.RRQRdecomp(a,b).rank};h._helper.isAlmostZeroVec=function(a){const b=a.value.length;for(let c=0;c<b;c++)if(!n._helper.isAlmostZero(a.value[c]))return!1;
return!0};h._helper.isLowerTriangular=function(a){const b=a.value.length,c=a.value[0].value.length;for(let d=0;d<b;d++)for(let f=d+1;f<c;f++)if(!n._helper.isAlmostZero(a.value[d].value[f]))return!1;return!0};h._helper.isUpperTriangular=function(a){return h._helper.isLowerTriangular(h.transpose(a))};h._helper.isAlmostId=function(a){const b=a.value.length;var c=n.real(b);if(b!==a.value[0].value.length)return!1;a=h.sub(a,h.idMatrix(c),c);for(c=0;c<b;c++)for(let d=0;d<b;d++)if(1E-16<n.abs(a.value[c].value[d]).value.real)return!1;
return!0};h.nullSpace=function(a,b){const c=a.value.length;b=h.RRQRdecomp(h.transjugate(a),b);a=h.transpose(b.Q);b=c-b.rank.value.real;let d=Array(b);a.value.reverse();let f;for(let k=0;k<b;k++)f=a.value[k],d[k]=h.scaldiv(h.abs(f),f);d=h.turnIntoCSList(d);return 0<d.value.length?d:h.turnIntoCSList([h.zerovector(n.real(c))])};h._helper.isAlmostDiagonal=function(a){const b=a.value.length;n.real(b);n.real(0);if(b!==a.value[0].value.length)return!1;for(let c=0;c<b;c++)for(let d=0;d<b;d++)if(c!==d&&1E-16<
n.abs(a.value[c].value[d]).value.real)return!1;return!0};h._helper.inverseIteration=function(a,b){console.log("warning: code untested");var c=a.value.length,d=Array(c);for(var f=0;f<c;f++)d[f]=2*Math.random()-.5;d=h.realVector(d);c=h.idMatrix(n.real(c),n.real(c));b=n.add(b,n.real(.1*Math.random()-.5));for(f=0;100>f;f++)d=h.scaldiv(h.abs(d),d),d=h.LUsolve(h.sub(a,h.scalmult(b,c)),JSON.parse(JSON.stringify(d)));return h.scaldiv(h.abs(d),d)};h._helper.toHessenberg=function(a){let b=JSON.parse(JSON.stringify(a));
const c=b.value.length,d=n.real(c-1);var f=n.real(c);n.real(1);if(h._helper.isUpperTriangular(b))return[h.idMatrix(d,d),a];a=h.idMatrix(f,f);let k;for(f=1;f<c-1;f++){var m=h.column(b,n.real(f));m.value=m.value.splice(f);k=h.abs2(m).value.real;1E-16<k&&(m=h._helper.getHouseHolder(m),a=G.mult(a,m),b=G.mult(G.mult(m,b),m));d.value.real--}return[a,b]};h._helper.swapEl=function(a,b,c){let d;"[object Array]"===Object.prototype.toString.call(a)?(d=a[b],a[b]=a[c],a[c]=d):"list"===a.ctype&&(d=a.value[b],a.value[b]=
a.value[c],a.value[c]=d)};h.RRQRdecomp=function(a,b){var c=Math.sqrt(n.eps);void 0!==b&&(c=.1*b.value.real);b=c*c;var d;c=a.value.length;let f=n.real(c);const k=n.real(1),m=h._helper.unitvector(n.real(a.value.length),k);let p=h.idMatrix(f,f),u=JSON.parse(JSON.stringify(a));var x=h.transpose(a);a=Array(c);for(d=0;d<c;d++)a[d]=h.abs2(x.value[d]);a=h.turnIntoCSList(a);x=Array(c);for(d=0;d<c;d++)x[d]=d;d=h.maxIndex(a,n.abs);var y=a.value[d];let C=0;for(let F=0;1E-16<n.abs2(y).value.real;F++){C++;h._helper.swapColumn(u,
F,d);h._helper.swapEl(a,F,d);h._helper.swapEl(x,F,d);d=h._helper.getBlock(u,[F],[F]);d=h.column(d,k);y=h.abs2(d).value.real;1E-8<y&&(d=h._helper.getHouseHolder(d),d=h._helper.buildBlockMatrix(h.idMatrix(n.real(F),n.real(F)),d),p=G.mult(p,h.transjugate(d)),u=G.mult(d,u));for(d=F+1;d<c;d++)a.value[d]=n.sub(a.value[d],n.mult(u.value[F].value[d],n.conjugate(u.value[F].value[d])));d=h.maxIndex(a,n.abs2,F+1);y=a.value[d];if(F+2===c){n.abs(y).value.real>b&&C++;break}f=n.sub(f,k);m.value=m.value.splice(0,
m.value.length-1)}return{Q:p,R:u,P:h.turnIntoCSList(x),rank:n.real(C)}};h._helper.getHouseHolder=function(a){var b=n.real(a.value.length);if(1E-16>h.abs2(a))return h.idMatrix(b,b);const c=n.real(1),d=h._helper.unitvector(n.real(a.value.length),c);var f=h._helper.QRgetAlpha(a,0);f=h.sub(a,h.scalmult(f,d));f=h.scaldiv(h.abs(f),f);a=n.div(h.sesquilinearproduct(a,f),h.sesquilinearproduct(f,a));b=h.idMatrix(b,b);return b=h.sub(b,h.scalmult(n.add(c,a),h._helper.transposeMult(f,h.conjugate(f))))};h._helper.reOrderbyPivots=
function(a,b){var c=a.value.length.length;a=h.transpose(a);c=Array(c);for(let d=0;d<b.length;d++)c[b[d]]=a.value[d];c=h.turnIntoCSList(c);return h.transpose(c)};h.QRdecomp=function(a){const b=a.value.length;let c=n.real(b);if(h._helper.isUpperTriangular(a))return{Q:h.idMatrix(c,c),R:a};const d=n.real(1),f=h._helper.unitvector(n.real(a.value.length),d);let k,m=h.idMatrix(c,c);a=JSON.parse(JSON.stringify(a));for(let u=0;;u++){var p=h._helper.getBlock(a,[u],[u]);p=h.column(p,d);k=h.abs2(p).value.real;
1E-8<k&&(p=h._helper.getHouseHolder(p),p=h._helper.buildBlockMatrix(h.idMatrix(n.real(u),n.real(u)),p),m=G.mult(m,h.transjugate(p)),a=G.mult(p,a));if(u+2===b)break;c=n.sub(c,d);f.value=f.value.splice(0,f.value.length-1)}return{Q:m,R:a}};h._helper.swapColumn=function(a,b,c){let d;for(let f=0;f<a.value.length;f++)d=a.value[f].value[b],a.value[f].value[b]=a.value[f].value[c],a.value[f].value[c]=d};h._helper.buildBlockMatrix=function(a,b){if(0===a.value.length)return b;if(0===b.value.length)return a;
const c=a.value.length,d=a.value[0].value.length;var f=d+b.value[0].value.length;f=h.zeromatrix(n.real(c+b.value.length),n.real(f));for(var k=0;k<a.value.length;k++)for(let m=0;m<a.value[0].value.length;m++)f.value[k].value[m]=a.value[k].value[m];for(a=0;a<b.value.length;a++)for(k=0;k<b.value[0].value.length;k++)f.value[c+a].value[d+k]=b.value[a].value[k];return f};h._helper.getBlock=function(a,b,c){a=JSON.parse(JSON.stringify(a));var d=b[0];const f=c[0];b=void 0===b[1]?a.value.length:b[1];c=void 0===
c[1]?a.value[0].value.length:c[1];b++;c++;a.value=a.value.slice(d,b);for(d=0;d<a.value.length;d++)a.value[d].value=a.value[d].value.slice(f,c);return a};h._helper.setBlock=function(a,b,c){a=JSON.parse(JSON.stringify(a));const d=c[0];c=c[1];const f=b.value.length,k=b.value[0].value.length;for(let m=0;m<f;m++)for(let p=0;p<k;p++)a.value[d+m].value[c+p]=b.value[m].value[p];return a};h._helper.transposeMult=function(a,b){if(a.value.length!==b.value.length)return B;const c=a.value.length,d=Array(c);for(let f=
0;f<c;f++)d[f]=h.scalmult(a.value[f],b);return h.turnIntoCSList(d)};h._helper.QRgetAlpha=function(a,b){return 0>a.value[b].value.real?h.abs(a):n.neg(h.abs(a))};h.LUdecomp=function(a){a=JSON.parse(JSON.stringify(a));var b;let c,d;let f=0,k;const m=a.value.length,p=m-1,u=Array(m);for(c=0;c<m;++c){var x=c;d=a.value[c];k=n.abs(d.value[c]).value.real;for(b=c+1;b<m;++b){var y=n.abs(a.value[b].value[c]);k<y.value.real&&(k=y.value.real,x=b)}k<n.eps&&console.log("Warning: singular matrix!");u[c]=x;x!==c&&
(a.value[c]=a.value[x],a.value[x]=d,d=a.value[c],f++);b=d.value[c];for(y=c+1;y<m;++y)a.value[y].value[c]=n.div(a.value[y].value[c],b);for(y=c+1;y<m;++y){x=a.value[y];for(b=c+1;b<p;++b)x.value[b]=n.sub(x.value[b],n.mult(x.value[c],d.value[b])),++b,x.value[b]=n.sub(x.value[b],n.mult(x.value[c],d.value[b]));b===p&&(x.value[b]=n.sub(x.value[b],n.mult(x.value[c],d.value[b])))}}return{LU:a,P:u,TransPos:f}};h.LUsolve=function(a,b){a=h.LUdecomp(a);return h._helper.LUsolve(a,b)};h._helper.LUsolve=function(a,
b){var c=JSON.parse(JSON.stringify(b));b=a.LU;const d=b.value.length,f=JSON.parse(JSON.stringify(c)),k=a.P;for(a=d-1;-1!==a;--a)f.value[a]=c.value[a];for(a=0;a<d;++a){c=k[a];if(k[a]!==a){var m=f.value[a];f.value[a]=f.value[c];f.value[c]=m}m=b.value[a];for(c=0;c<a;++c)f.value[a]=n.sub(f.value[a],n.mult(f.value[c],m.value[c]))}for(a=d-1;0<=a;--a){m=b.value[a];for(c=a+1;c<d;++c)f.value[a]=n.sub(f.value[a],n.mult(f.value[c],m.value[c]));f.value[a]=n.div(f.value[a],m.value[a])}return f};h.linearsolveCramer2=
function(a,b){const c=h.column(a,n.real(1));var d=h.column(a,n.real(2));a=h.det2(c,d);n._helper.isZero(a)&&console.log("A is not regular!");d=h.det2(b,d);d=n.div(d,a);b=h.det2(c,b);b=n.div(b,a);return h.turnIntoCSList([d,b])};h.linearsolveCramer3=function(a,b){const c=h.column(a,n.real(1)),d=h.column(a,n.real(2));var f=h.column(a,n.real(3));a=h.det3(c,d,f);n._helper.isZero(a)&&console.log("A is not regular!");const k=h.det3(b,d,f);f=h.det3(c,b,f);b=h.det3(c,d,b);b=h.turnIntoCSList([k,f,b]);return b=
h.scaldiv(a,b)};h.linearsolveCGNR=function(a,b){const c=h.transpose(a);a=G.mult(c,a);b=G.mult(c,b);return h.linearsolveCG(a,b)};h.linearsolveCG=function(a,b){let c;var d;let f,k,m;f=b;c=b=h.sub(b,G.mult(a,b));const p=Math.ceil(1.2*a.value.length);let u=0;for(;u<p;){u++;k=G.mult(a,c);m=d=h.scalproduct(b,b);d=n.div(d,h.scalproduct(c,k));f=h.add(f,G.mult(d,c));b=h.sub(b,G.mult(d,k));if(h.abs(b).value.real<n.eps)break;d=h.scalproduct(b,b);d=n.div(d,m);c=h.add(b,G.mult(d,c))}u>=p&&console.log("CG did not converge");
return f};h.det=function(a){if(1===a.value.length)return a.value[0].value[0];if(2===a.value.length)return h.det2(a.value[0],a.value[1]);if(3===a.value.length)return h.det3(a.value[0],a.value[1],a.value[2]);if(4===a.value.length)return h.det4m(a);const b=a.value.length;let c=n.real(1);var d;let f;const k=JSON.parse(JSON.stringify(a));let m,p,u,x;for(a=0;a<b-1;a++){f=a;for(d=a+1;d<b;d++)n.abs(k.value[d].value[a]).value.real>n.abs(k.value[f].value[a]).value.real&&(f=d);f!==a&&(d=k.value[f],k.value[f]=
k.value[a],k.value[a]=d,c=n.neg(c));m=k.value[a];for(d=a+1;d<b;d++){p=k.value[d];u=n.div(p.value[a],m.value[a]);for(f=a+1;f<b-1;f+=2)x=f+1,p.value[f]=n.sub(p.value[f],n.mult(m.value[f],u)),p.value[x]=n.sub(p.value[x],n.mult(m.value[x],u));f!==b&&(p.value[f]=n.sub(p.value[f],n.mult(m.value[f],u)))}if(n._helper.isZero(m.value[a]))return n.real(0);c=n.mult(c,m.value[a])}return n.mult(c,k.value[a].value[a])};h.LUdet=function(a){a=h.LUdecomp(a);const b=a.LU,c=b.value.length;let d=b.value[0].value[0];for(let f=
1;f<c;f++)d=n.mult(d,b.value[f].value[f]);1===a.TransPos%2&&(d=n.neg(d));return d};h.getField=function(a,b){let c;if("homog"===b){if(h._helper.isNumberVecN(a,3))return a;if(h._helper.isNumberVecN(a,2))return h.turnIntoCSList([a.value[0],a.value[1],n.real(1)])}if("xy"===b){if(h._helper.isNumberVecN(a,2))return a;if(h._helper.isNumberVecN(a,3))return h.turnIntoCSList([n.div(a.value[0],a.value[2]),n.div(a.value[1],a.value[2])])}if("x"===b&&h.isNumberVector(a)){c=a.value.length;if(0<c&&3!==c)return a.value[0];
if(3===c)return"Point"===a.usage?n.div(a.value[0],a.value[2]):a.value[0]}if("y"===b&&h.isNumberVector(a)){c=a.value.length;if(1<c&&3!==c)return a.value[1];if(3===c)return"Point"===a.usage?n.div(a.value[1],a.value[2]):a.value[1]}return"z"===b&&h.isNumberVector(a)&&(c=a.value.length,2<c)?a.value[2]:B};h.nil=h.turnIntoCSList([]);h.ofGeos=function(a){return h.turnIntoCSList(a.map(function(b){return{ctype:"geo",value:b}}))};h._helper.isAlmostFarpoint=function(a){a=h.normalizeMax(a).value[2];return n.abs(a).value.real<
n.eps};h.getRandRealVec3=function(a,b){const c=n.getRandReal;return h.turnIntoCSList([c(a,b),c(a,b),c(a,b)])};h.getRandComplexVec3=function(a,b){const c=n.getRandComplex;return h.turnIntoCSList([c(a,b),c(a,b),c(a,b)])};const Ja={_helper:{},turnIntoCSJson:function(a){return{ctype:"JSON",value:a}}};Ja._helper.ShallowClone=function(a){let b,c,d;b=Array.isArray(a)?[]:{};for(d in a)c=a[d],b[d]=c;return b};Ja.getField=function(a,b){return a.value&&a.value[b]?a.value[b]:B};Ja.setField=function(a,b,c){"undefined"===
c.ctype&&a[b]?delete a[b]:a[b]=c};Ja.GenFromUserDataEl=function(a){const b=a.key;a=a.value;if(!b||"string"!==b.ctype)return console.log("Error: JSON keys have to be strings."),B;if(a)return{key:b.value,val:K(a)};console.log("Warning: JSON object not defined.");return{key:b.value,val:B}};Ja._helper.GenJSONAtom=function(a,b){return{ctype:"JSON",value:{key:G.string(a),value:b}}};Ja._helper.forall=function(a,b,c,d){let f="value",k;if(void 0!==d.iterator){d=K(d.iterator);let m=["key","value","pair"];"string"===
d.ctype&&m.includes(d.value)&&(f=d.value)}if("value"===f)for(let m in a)M.setvar(b,a[m]),k=K(c);else if("key"===f)for(let m in a)M.setvar(b,G.string(m)),k=K(c);else for(let m in a)M.setvar(b,Ja._helper.GenJSONAtom(m,a[m])),k=K(c);return k};Ja._helper.niceprint=function(a,b,c){return"JSON"===a.ctype?Ja.niceprint(a,b,c):fa(a)};Ja.niceprint=function(a,b,c){if(!c&&(c={printedWarning:!1,visitedMap:{}},c.visitedMap.tracker=new WeakMap,c.visitedMap.level=0,c.visitedMap.maxLevel=1E3,c.visitedMap.maxElVisit=
5E3,b&&b.maxDepth)){let f=K(b.maxDepth);"number"===f.ctype&&(c.visitedMap.maxLevel=f.value.real)}const d=c.visitedMap;d.newLevel=!0;d.level+=1;return"{"+Object.keys(a.value).sort().map(function(f){let k=a.value[f];if(d.tracker.has(k)){if(d[k]>d.maxElVisit||d.level>d.maxLevel)return c.printedWarning||(console.log("Warning: We visited a key-value pair very often or encountered a very deeply nested dictionary. Dictionary is probably cyclic. Output will be probably incomplete."),c.printedWarning=!0),
f+":...";d.newLevel&&(d.tracker.set(k,d.tracker.get(k)+1),d.newLevel=!1)}else d.tracker.set(k,1);return f+":"+Ja._helper.niceprint(k,b,c)}).join(", ")+"}"};Ja._helper.handlePrintException=function(a){a instanceof RangeError?console.log("Warning: Dictionary string could not be generated! Probably large cyclic Dictionary!"):a instanceof SyntaxError?console.log("Warning: Dictionary string could not be parsed!"):console.log("Warning: Dictionary printing failed!")};const kc={key:function(a){if("string"===
a.ctype)return"s"+a.value.length+":"+a.value+";";if("number"===a.ctype)return"n"+a.value.real+","+a.value.imag+";";if("list"===a.ctype)return"l"+a.value.length+":"+a.value.map(kc.key).join(",")+";";if("boolean"===a.ctype)return"b"+a.value+";";if("dict"===a.ctype)return a=Object.keys(a.value).sort(),"d"+a.length+":"+a.join(",")+";";"undefined"!==a.ctype&&Fb.err("Bad dictionary key: "+fa(a));return"undef"},create:function(){return{ctype:"dict",value:{}}},clone:function(a){const b=kc.create();for(const c in a.value)a.value.hasOwnProperty(c)&&
(b.value[c]=a.value[c]);return b},put:function(a,b,c){a.value[kc.key(b)]={key:b,value:c}},get:function(a,b,c){return(a=a.value[kc.key(b)])?a.value:c},niceprint:function(a){return"{"+Object.keys(a.value).sort().map(function(b){b=a.value[b];return fa(b.key)+":"+fa(b.value)}).join(", ")+"}"}},G={_helper:{},order:{undefined:0,boolean:1,number:2,term:3,atomic:4,variable:5,geo:6,string:7,list:8},string:function(a){return{ctype:"string",value:a}},bool:function(a){return{ctype:"boolean",value:a}},not:function(a){return G.bool(!a.value)},
isLessThan:function(a,b){return-1===G.compare(a,b)},isEqual:function(a,b){return 0===G.compare(a,b)},compareResults:function(a,b){return G.compare(a.result,b.result)},compare:function(a,b){if(a.ctype!==b.ctype)return G.order[a.ctype]-G.order[b.ctype];if("number"===a.ctype)return n._helper.compare(a,b);if("list"===a.ctype)return h._helper.compare(a,b);if("geo"===a.ctype)return a.value.name===b.value.name?0:a.value.name<b.value.name?-1:1;if("string"===a.ctype)return a.value===b.value?0:a.value<b.value?
-1:1;if("boolean"===a.ctype)return a.value===b.value?0:!1===a.value?-1:1},add:function(a,b){return"void"===a.ctype&&"number"===b.ctype||"void"===a.ctype&&"list"===b.ctype?b:"number"===a.ctype&&"number"===b.ctype?n.add(a,b):"string"===a.ctype||"string"===b.ctype?{ctype:"string",value:fa(a)+fa(b)}:"list"===a.ctype&&"list"===b.ctype?h.add(a,b):B},sub:function(a,b){return"void"===a.ctype&&"number"===b.ctype?n.neg(b):"void"===a.ctype&&"list"===b.ctype?h.neg(b):"number"===a.ctype&&"number"===b.ctype?n.sub(a,
b):"list"===a.ctype&&"list"===b.ctype?h.sub(a,b):B},mult:function(a,b){return"number"===a.ctype&&"number"===b.ctype?n.mult(a,b):"number"===a.ctype&&"list"===b.ctype?h.scalmult(a,b):"list"===a.ctype&&"number"===b.ctype?h.scalmult(b,a):"list"===a.ctype&&"list"===b.ctype?h.mult(a,b):B},div:function(a,b){return"number"===a.ctype&&"number"===b.ctype?n.div(a,b):"list"===a.ctype&&"number"===b.ctype?h.scaldiv(b,a):B},max:function(a,b){return"number"===a.ctype&&"number"===b.ctype?n.max(a,b):"list"===a.ctype&&
"list"===b.ctype?h.max(a,b):B},min:function(a,b){return"number"===a.ctype&&"number"===b.ctype?n.min(a,b):"list"===a.ctype&&"list"===b.ctype?h.min(a,b):B},wrap:function(a){if("number"===typeof a)return n.real(a);if("object"===typeof a&&void 0!==a.length){const b=[];for(let c=0;c<a.length;c++)b[c]=G.wrap(a[c]);return h.turnIntoCSList(b)}return"string"===typeof a?{ctype:"string",value:a}:"boolean"===typeof a?{ctype:"boolean",value:a}:B},unwrap:function(a){if("object"!==typeof a||null===a)return a;if(Array.isArray(a))return a.map(G.unwrap);
switch(a.ctype){case "string":case "boolean":return a.value;case "number":return 0===a.value.imag?a.value.real:{r:a.value.real,i:a.value.imag};case "list":return a.value.map(G.unwrap);default:return null}},withUsage:function(a,b){return{ctype:a.ctype,value:a.value,usage:b}},wrapJSON:function(a){switch(typeof a){case "number":return n.real(a);case "string":return G.string(a);case "boolean":return G.bool(a);case "object":if(null===a)return B;if(Array.isArray(a))return h.turnIntoCSList(a.map(G.wrapJSON));
const b=kc.create();for(const c in a)kc.put(b,G.string(c),G.wrapJSON(a[c]));return b;default:return console.log("Failed to convert "+typeof a+" to CindyJS data type"),B}},identity:function(a){return a},deeplyEqual:function(a,b){if("object"!==typeof a||"object"!==typeof b||null===a||null===b)return a===b;let c=0,d;for(d in a)if(++c,!(d in b&&G.deeplyEqual(a[d],b[d])))return!1;for(d in b)--c;return 0===c}},J={},w={};w[":"]=ha(":");w["\u00b0"]=function(a,b){b=V(a[0]);return"number"===b.ctype&&"void"===
a[1].ctype?G.withUsage(n.realmult(Math.PI/180,b),"Angle"):B};w._=Dc;w["^"]=ye;w["\u221a"]=function(a,b){return"void"===a[0].ctype?v.sqrt$1([a[1]],b):B};w["*"]=Vc;w["\u00d7"]=wd;w["/"]=Wd;w["+"]=Zb;w["-"]=$b;w["!"]=function(a,b){b=V(a[1]);return"void"===a[0].ctype&&"boolean"===b.ctype?{ctype:"boolean",value:!b.value}:B};w["=="]=Ra;w["~="]=Qa;w["~<"]=function(a,b){b=V(a[0]);a=V(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",
value:b.value.real-a.value.real<=-n.eps}:B};w["~>"]=function(a,b){b=V(a[0]);a=V(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real-a.value.real>=n.eps}:B};w["=:="]=ha("=:=");w[">="]=function(a,b){b=V(a[0]);a=V(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real>=a.value.real}:"string"===b.ctype&&"string"===a.ctype?{ctype:"boolean",
value:b.value>=a.value}:B};w["<="]=function(a,b){b=V(a[0]);a=V(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real<=a.value.real}:"string"===b.ctype&&"string"===a.ctype?{ctype:"boolean",value:b.value<=a.value}:B};w["~>="]=function(a,b){b=V(a[0]);a=V(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real-a.value.real>-n.eps}:
B};w["~<="]=function(a,b){b=V(a[0]);a=V(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real-a.value.real<n.eps}:B};w[">"]=function(a,b){b=V(a[0]);a=V(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real>a.value.real}:"string"===b.ctype&&"string"===a.ctype?{ctype:"boolean",value:b.value>a.value}:B};w["<"]=function(a,b){b=V(a[0]);
a=V(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real<a.value.real}:"string"===b.ctype&&"string"===a.ctype?{ctype:"boolean",value:b.value<a.value}:B};w["<>"]=Nb;w["\u2208"]=function(a,b){b=K(a[0]);a=K(a[1]);return"list"===a.ctype?h.contains(a,b):B};w["\u2209"]=function(a,b){b=K(a[0]);a=K(a[1]);return"list"===a.ctype?G.not(h.contains(a,b)):B};w["&"]=wc;w["%"]=xb;w["!="]=Nb;w["~!="]=function(a,b){return G.not(Qa(a,
b))};w[".."]=function(a,b){b=K(a[0]);a=K(a[1]);return"number"===b.ctype&&"number"===a.ctype?h.sequence(b,a):B};w["++"]=fc;w["--"]=xd;w["~~"]=Ic;w[":>"]=yd;w["<:"]=pc;w["="]=Wa;w[":="]=function(a,b,c){b="undefined"===a[1].ctype;if("undefined"===a[0].ctype||b)return B;if("function"===a[0].ctype){b=a[0].oper;const f=a[0].args;a=a[1];var d=1;if(J.hasOwnProperty(b)){d=J[b];if(d.definer===c)return B;d=d.generation+1}J[b]={oper:b,body:a,arglist:f,definer:c,generation:d}}else"variable"===a[0].ctype?M.setvar(a[0].name,
a[1]):"field"===a[0].ctype?A.assigndotNoVal(a[0],a[1]):"userdata"===a[0].ctype&&A.assigncolonNoVal(a[0],a[1]);return B};w[":=_"]=function(a,b){if("void"!==a[1].ctype)return B;"function"===a[0].ctype&&delete J[a[0].oper];return B};w["::="]=ha("::=");w[";"]=function(a,b){b="void"===a[0].ctype;const c="void"===a[1].ctype;if(b&&c)return B;if(!b&&c)return K(a[0]);b||c||K(a[0]);return c?B:K(a[1])};fa.errorTypes=["_?_","_??_","_???_","___"];const v={},A={evaluate:function(a,b,c){if(J.hasOwnProperty(a)){c=
J[a];if(void 0===c)b=B;else{var d=[];for(a=0;a<c.arglist.length;a++)d[a]=K(b[a]);for(a=0;a<c.arglist.length;a++)M.newvar(c.arglist[a].name),M.setvar(c.arglist[a].name,d[a]);M.pushVstack("*");b=K(c.body);M.cleanVstack();for(a=0;a<c.arglist.length;a++)M.removevar(c.arglist[a].name)}return b}if(d=v[a])return d(b,c);let f=a.lastIndexOf("$");if(-1!==f&&(f=a.substr(0,f),d=v[f]))return d(b,c);Fb.err("Called undefined function "+f+" (as "+a+")");return B},equals:function(a,b){return"number"===a.ctype&&"number"===
b.ctype?{ctype:"boolean",value:a.value.real===b.value.real&&a.value.imag===b.value.imag}:"string"===a.ctype&&"string"===b.ctype||"boolean"===a.ctype&&"boolean"===b.ctype?{ctype:"boolean",value:a.value===b.value}:"list"===a.ctype&&"list"===b.ctype?h.equals(a,b):"geo"===a.ctype&&"geo"===b.ctype||"JSON"===a.ctype&&"JSON"===b.ctype?{ctype:"boolean",value:a.value===b.value}:{ctype:"boolean",value:!1}}},M={};M.vars=function(){const a={pi:n.real(Math.PI),"\u03c0":n.real(Math.PI),i:n.complex(0,1),true:G.bool(!0),
false:G.bool(!1),"#":B,nil:h.turnIntoCSList([]),newline:G.string("\n"),tab:G.string("\t")},b=[];for(const c in a)b[c]=[a[c]];return b}();M.isVariable=function(a){return this.vars.hasOwnProperty(a)};M.create=function(a){if(this.vars.hasOwnProperty(a))return this.vars[a];const b=[null];return this.vars[a]=b};M.newvar=function(a){a=this.vars[a];a.push(B);return a};M.removevar=function(a){const b=this.vars[a];0===b.length&&console.error("Removing non-existing "+a);b.pop();0===b.length&&console.warn("Removing last "+
a)};M.setvar=function(a,b){const c=this.vars[a];0===c.length&&console.error("Setting non-existing variable "+a);void 0===b&&(console.error("Setting variable "+a+" to undefined value"),b=B);"undefined"===b.ctype?c[c.length-1]=b:(a=b,null===a&&(a=B),c[c.length-1]=a)};M.undefinedWarning={};M.getvar=function(a){var b=this.vars[a]||[];0===b.length&&console.error("Getting non-existing variable "+a);b=b[b.length-1];if(null===b){if(E.csnames.hasOwnProperty(a))return{ctype:"geo",value:E.csnames[a]};console&&
console.log&&void 0===this.undefinedWarning[a]&&(this.undefinedWarning[a]=!0,console.log("Warning: Accessing undefined variable: "+a));return B}return b};M.dump=function(a){const b=this.vars[a];console.log("*** Dump "+a);for(a=0;a<b.length;a++)console.log(a+":> "+fa(b[a]))};M.vstack=[];M.pushVstack=function(a){this.vstack.push(a)};M.popVstack=function(){this.vstack.pop()};M.cleanVstack=function(){const a=this.vstack;for(;0<a.length&&"*"!==a[a.length-1];)this.removevar(a[a.length-1]),a.pop();0<a.length&&
a.pop()};const Z={generalFields:{color:"color",colorhsb:"",size:"size",alpha:"alpha",fillcolor:"fillcolor",fillalpha:"fillalpha",isshowing:"isshowing",visible:"visible",name:"name",caption:"caption",trace:"",tracelength:"",selected:"",labeled:"labeled",labelled:"labeled"},getGeoField:function(a,b){return"undefined"!==typeof E.csnames[a]?Z.getField(E.csnames[a],b):B},setGeoField:function(a,b,c){return"undefined"!==typeof E.csnames[a]?Z.setField(E.csnames[a],b,c):B},getField:function(a,b){if("P"===
a.kind){if("xy"===b)return a=h.dehom(a.homog),G.withUsage(a,"Point");if("homog"===b)return G.withUsage(a.homog,"Point");if("x"===b)return n.div(a.homog.value[0],a.homog.value[2]);if("y"===b)return n.div(a.homog.value[1],a.homog.value[2]);if("narrow"===b)return G.wrap(a.narrow)}if("L"===a.kind||"S"===a.kind){if("homog"===b)return G.withUsage(a.homog,"Line");if("angle"===b)return a=h.eucangle(h.ey,a.homog),G.withUsage(a,"Angle");if("slope"===b)return n.neg(n.div(a.homog.value[0],a.homog.value[1]))}if("Tr"===
a.kind&&"matrix"===b)return a.matrix;if("C"===a.kind){if("radius"===b){var c=a.matrix;a=c.value[0].value[0];var d=c.value[0].value[2];b=c.value[1].value[2];c=c.value[2].value[2];n.mult(a,a);d=n.div(d,a);b=n.div(b,a);a=n.div(c,a);return a=n.sqrt(n.sub(n.add(n.mult(d,d),n.mult(b,b)),a))}if("size"===b)return a.size;if("matrix"===b)return a.matrix;if("center"===b)return a=t._helper.CenterOfConic(a.matrix),a=h.dehom(a),G.withUsage(a,"Point");if("dualMatrix"===b)return h.normalizeMax(h.adjoint3(a.matrix));
if("narrow"===b)return G.wrap(a.narrow)}if("Text"===a.kind){if("pressed"===b)return a.checkbox?G.bool(a.checkbox.checked):G.bool(!1);if("xy"===b)return a=h.dehom(a.homog),G.withUsage(a,"Point");if("homog"===b)return G.withUsage(a.homog,"Point");if("x"===b)return n.div(a.homog.value[0],a.homog.value[2]);if("y"===b)return n.div(a.homog.value[1],a.homog.value[2])}if("trace"===b)return G.bool(!!a.drawtrace);if("pinned"===b)return G.bool(!!a.pinned);if(Z.generalFields[b])return(a=a[Z.generalFields[b]])&&
a.ctype?a:"object"!==typeof a?G.wrap(a):B;if(a.behavior){if("mass"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.mass);if("radius"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.radius);if("charge"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.charge);if("friction"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.friction);if("vx"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.vx);if("vy"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.vy);if("v"===b&&
"Mass"===a.behavior.type)return h.realVector([a.behavior.vx,a.behavior.vy]);if("fx"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.fx);if("fy"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.fy);if("f"===b&&"Mass"===a.behavior.type)return h.realVector([a.behavior.fx,a.behavior.fy]);if("ldiff"===b&&"Spring"===a.behavior.type)return n.real(a.behavior.ldiff)}b=t[a.type]["get_"+b];return"function"===typeof b?b(a):B},setField:function(a,b,c){"color"===b&&h._helper.isNumberVecN(c,3)&&(a.color=
c);"size"===b&&"number"===c.ctype&&(a.size=c);"alpha"===b&&"number"===c.ctype&&(a.alpha=c);"fillcolor"===b&&h._helper.isNumberVecN(c,3)&&(a.fillcolor=c);"fillalpha"===b&&"number"===c.ctype&&(a.fillalpha=c);"visible"===b&&"boolean"===c.ctype&&(a.visible=c.value);"pinned"===b&&"boolean"===c.ctype&&(a.pinned=c.value);"labeled"!==b&&"labelled"!==b||"boolean"!==c.ctype||(a.labeled=c.value);"printlabel"===b&&(a.printname=fa(c));"trace"===b&&"boolean"===c.ctype&&(c.value&&!a.drawtrace?(a.drawtrace=!0,Ee(a)):
a.drawtrace=c.value);"P"===a.kind&&a.movable&&("xy"===b&&h._helper.isNumberVecN(c,2)&&Rb(a,h.turnIntoCSList([c.value[0],c.value[1],n.real(1)]),"homog"),"xy"===b&&h._helper.isNumberVecN(c,3)&&Rb(a,c,"homog"),"x"===b&&"number"===c.ctype&&Rb(a,h.turnIntoCSList([n.mult(c,a.homog.value[2]),a.homog.value[1],a.homog.value[2]]),"homog"),"y"===b&&"number"===c.ctype&&Rb(a,h.turnIntoCSList([a.homog.value[0],n.mult(c,a.homog.value[2]),a.homog.value[2]]),"homog"),"homog"===b&&h._helper.isNumberVecN(c,3)&&Rb(a,
c,"homog"));"homog"===b&&"L"===a.kind&&a.movable&&h._helper.isNumberVecN(c,3)&&Rb(a,c,"homog");"Text"===a.kind&&("pressed"===b&&"boolean"===c.ctype&&a.checkbox&&(a.checkbox.checked=c.value),a.movable&&("xy"===b?h._helper.isNumberVecN(c,2)?a.homog=h.turnIntoCSList([c.value[0],c.value[1],n.real(1)]):h._helper.isNumberVecN(c,3)&&(a.homog=c):"homog"===b&&h._helper.isNumberVecN(c,3)?a.homog=c:"x"===b&&"number"===c.ctype?a.homog=h.turnIntoCSList([n.mult(c,a.homog.value[2]),a.homog.value[1],a.homog.value[2]]):
"y"===b&&"number"===c.ctype&&(a.homog=h.turnIntoCSList([a.homog.value[0],n.mult(c,a.homog.value[2]),a.homog.value[2]]))));a.behavior&&("mass"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.mass=c.value.real),"mass"===b&&"Sun"===a.behavior.type&&"number"===c.ctype&&(a.behavior.mass=c.value.real),"friction"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.friction=c.value.real),"charge"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.charge=c.value.real),
"radius"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.radius=c.value.real),"vx"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.vx=c.value.real),"vy"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.vy=c.value.real),"v"===b&&"Mass"===a.behavior.type&&h._helper.isNumberVecN(c,2)&&(a.behavior.vx=c.value[0].value.real,a.behavior.vy=c.value[1].value.real));"narrow"===b&&["P","C"].includes(a.kind)&&("boolean"===c.ctype&&(a.narrow=c.value),"number"===c.ctype&&
n._helper.isAlmostReal(c)&&(a.narrow=c.value.real));b=t[a.type]["set_"+b];if("function"===typeof b)return b(a,c)},getuserData:function(a,b){let c;"string"===b.ctype&&a.userData&&a.userData[b.value]&&(c=a.userData[b.value]);return c&&c.ctype?c:"object"!==typeof c?G.wrap(c):B},setuserData:function(a,b,c){b&&"string"===b.ctype&&a&&c&&(a.userData||(a.userData={}),a.userData[b.value]=c)}};v.version$0=function(a,b){a=["CindyJS"].concat(jc);return h.turnIntoCSList(a.map(G.wrap))};v.clearconsole$0=function(a,
b){Fb.clear()};v.err$1=function(a,b){b="";"variable"===a[0].ctype?(b=a[0].name,a=M.getvar(a[0].name)):a=a[0];a=b+" ===> "+fa(K(a));qb(a);return B};v.errc$1=function(a,b){"variable"===a[0].ctype?(b=K(M.getvar(a[0].name)),console.log(a[0].name+" ===> "+fa(b))):(b=K(a[0]),console.log(" ===> "+fa(b)));return B};v.print$1=function(a,b){Fb.out(fa(K(a[0]),b),!0);return B};v.println$1=function(a,b){Fb.out(fa(K(a[0],b)));return B};v.assert$2=function(a,b){const c=K(a[0]);if("boolean"===c.ctype){if(!1===c.value)return v.println$1([a[1]],
b)}else qb("Condition for assert is not boolean");return B};v.dump$1=function(a,b){console.log(JSON.stringify(a[0]));return B};v.repeat$2=function(a,b){return v.repeat$3([a[0],null,a[1]],b)};v.repeat$3=function(a,b){var c=V(a[0]);let d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);if("number"!==c.ctype)return B;c=Math.round(c.value.real);var f=1,k=1,m=c+1,p=!1,u=!1,x=!1;let y;void 0!==b.start&&(y=K(b.start),"number"===y.ctype&&(p=!0,k=y.value.real));void 0!==b.step&&(y=K(b.step),"number"===
y.ctype&&(x=!0,f=y.value.real));void 0!==b.stop&&(y=K(b.stop),"number"===y.ctype&&(u=!0,m=y.value.real));!p||u||x||(m=f*c+k);p||!u||x||(k=-f*(c-1)+m,m+=f);p||u||!x||(m=f*c+k);p&&u&&!x&&(f=(m-k)/(c-1),m+=f);p&&!u&&x&&(m=f*c+k);!p&&u&&x&&(k=-f*(c-1)+m,m+=f);p&&u&&x&&(m+=f);(k<=m&&0<f||k>=m&&0>f)&&p&&u&&x&&(c=Math.floor((m-k)/f));M.newvar(d);b=B;for(m=0;m<c;m++)M.setvar(d,{ctype:"number",value:{real:m*f+k,imag:0}}),b=K(a[2]);M.removevar(d);return b};v.while$2=function(a,b){b=a[1];a=a[0];let c=K(a),d=
B;for(;"list"!==c.ctype&&c.value;)d=K(b),c=K(a);return d};v.apply$2=function(a,b){return v.apply$3([a[0],null,a[1]],b)};v.apply$3=function(a,b){return v.apply$4([a[0],a[1],null,a[2]],b)};v.apply$4=function(a,b){b=V(a[0]);if("list"!==b.ctype&&"JSON"!==b.ctype)return B;let c="#";null!==a[1]&&"variable"===a[1].ctype&&(c=a[1].name);if(null!==a[2]&&"variable"===a[2].ctype){var d=a[2].name;M.newvar(d)}const f=b.value;let k="list"===b.ctype?[]:{};M.newvar(c);if(void 0!==d){if("list"===b.ctype)for(var m=
0;m<f.length;m++)M.setvar(d,n.real(m+1)),M.setvar(c,f[m]),k[m]=K(a[3]);else for(m in f)M.setvar(d,G.string(m)),M.setvar(c,f[m]),k[m]=K(a[3]);M.removevar(d)}else if("list"===b.ctype)for(k=[],d=0;d<f.length;d++)M.setvar(c,f[d]),k[d]=K(a[3]);else for(let p in f)M.setvar(c,f[p]),k[p]=K(a[3]);M.removevar(c);return"list"===b.ctype?h.turnIntoCSList(k):Ja.turnIntoCSJson(k)};v.forall$2=function(a,b){return v.forall$3([a[0],null,a[1]],b)};v.forall$3=function(a,b){const c=V(a[0]);if("list"!==c.ctype&&"JSON"!==
c.ctype)return B;let d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);const f=c.value;M.newvar(d);let k;if("list"===c.ctype)for(b=0;b<f.length;b++)M.setvar(d,f[b]),k=K(a[2]);else k=Ja._helper.forall(f,d,a[2],b);M.removevar(d);return k};v.select$2=function(a,b){return v.select$3([a[0],null,a[1]],b)};v.select$3=function(a,b){var c=V(a[0]);if("list"!==c.ctype&&"JSON"!==c.ctype)return B;b="#";null!==a[1]&&"variable"===a[1].ctype&&(b=a[1].name);const d=c.value;let f;M.newvar(b);if("list"===c.ctype){c=
[];var k=0;for(let m=0;m<d.length;m++)M.setvar(b,d[m]),f=K(a[2]),"boolean"===f.ctype&&!0===f.value&&(c[k]=d[m],k++);a={ctype:"list",value:c}}else{c={};for(k in d)M.setvar(b,d[k]),f=K(a[2]),"boolean"===f.ctype&&!0===f.value&&(c[k]=d[k]);a={ctype:"JSON",value:c}}M.removevar(b);return a};v.flatten$1=function(a,b){function c(d,f){return-1===f||"list"!==d.ctype?d:[].concat.apply([],d.value.map(function(k){return c(k,f-1)}))}a=V(a[0]);if("list"!==a.ctype)return a;b=b.levels;void 0===b?b=1:(b=K(b),b="number"===
b.ctype?b.value.real:"string"===b.ctype&&"all"===b.value?-2:1);return{ctype:"list",value:c(a,b)}};v.createvar$1=function(a,b){"variable"===a[0].ctype&&M.newvar(a[0].name);return B};v.local=function(a,b){for(b=0;b<a.length;b++)"variable"===a[b].ctype&&M.newvar(a[b].name);return B};v.removevar$1=function(a,b){b=K(a[0]);"variable"===a[0].ctype&&M.removevar(a[0].name);return b};v.release=function(a,b){if(0===a.length)return B;b=K(a[a.length-1]);for(let c=0;c<a.length;c++)"variable"===a[c].ctype&&M.removevar(a[c].name);
return b};v.regional=function(a,b){for(b=0;b<a.length;b++)if("variable"===a[b].ctype){const c=a[b].name;M.newvar(c);M.pushVstack(c)}return B};v.genList=function(a,b){return h.turnIntoCSList(a.map(K))};v.genJSON=function(a,b){b={};for(let c=0;c<a.length;c++){const d=Ja.GenFromUserDataEl(a[c]);d.key&&(b[d.key]=d.val)}return{ctype:"JSON",value:b}};A.assigntake=function(a,b){const c=a.args[0],d=K(c);a=V(a.args[1]);var f=B;if("list"===d.ctype||"string"===d.ctype){let k=Math.floor(a.value.real);0>k&&(k=
d.value.length+k+1);0<k&&k<=d.value.length&&("list"===d.ctype?(f="userData"===d.internal_usage?d.value:d.value.slice(),f[k-1]=K(b),f=h.turnIntoCSList(f),d.userData&&(f.userData=d.userData)):(f=d.value,f=f.substring(0,k-1)+fa(K(b))+f.substring(k,f.length),f=G.string(f)))}"JSON"===d.ctype&&(a=fa(a),fa.errorTypes.includes(a)||(f=Ja._helper.ShallowClone(d),f.value[a]=K(b)));Wa([c,f])};A.assigndot=function(a,b){const c=K(a.obj);a=a.key;"geo"===c.ctype&&"string"===typeof a&&Z.setField(c.value,a,V(b));"JSON"===
c.ctype&&"string"===typeof a&&Ja.setField(c.value,a,V(b));return B};A.assigndotNoVal=function(a,b){const c=K(a.obj);a=a.key;"geo"===c.ctype&&"string"===typeof a&&Z.setField(c.value,a,b);"JSON"===c.ctype&&"string"===typeof a&&Ja.setField(c.value,a,b);return B};A.assigncolon=function(a,b){const c=a.obj,d=K(c);a=G.string(fa(K(a.key)));"_?_"===a.value&&(a=B);if("geo"===d.ctype&&a)Z.setuserData(d.value,a,V(b));else if("JSON"===d.ctype&&a)Ja.setField(d.value,a.value,V(b));else if("list"===d.ctype||"string"===
d.ctype&&a){const f=Object.assign({},d);f.userData||(f.userData={});"userData"!==d.internal_usage&&(f.userData=Object.assign({},f.userData));b=V(b);"list"===b.ctype&&(b.internal_usage="userData");f.userData[a.value]=b;Wa([c,f])}else a&&"string"===a.ctype?console.log("User data "+a.value+" can only be assigned to geo objects and lists, not to "+d.ctype):console.log("Key is undefined");return B};A.assigncolonNoVal=function(a,b){const c=a.obj;var d=K(c);a=G.string(fa(K(a.key)));"_?_"===a.value&&(a=B);
if("geo"===d.ctype&&a)Z.setuserData(d.value,a,K(b));else if("JSON"===d.ctype&&a)Ja.setField(d.value,a.value,b);else if("list"===d.ctype||"string"===d.ctype&&a){const f={};for(const k in d)f[k]=d[k];if(f.userData){d={};for(const k in f.userData)d[k]=f.userData[k];f.userData=d}else f.userData={};f.userData[a.value]=b;Wa([c,f])}else a&&"string"===a.ctype?console.log("User data "+a.value+" can only be assigned to geo objects and lists, not to "+d.ctype):console.log("Key is undefined");return B};v.keys$1=
function(a,b){b=K(a[0]);const c=b.ctype;return"geo"===c||"list"===c||"JSON"===c?(a=[],(b="geo"===c?b.value.userData:"list"===c?b.userData:b.value)&&(a=Object.keys(b).map(G.string).sort()),h.turnIntoCSList(a)):B};v.values$1=function(a,b){a=K(a[0]);b=a.ctype;if("list"===b)return a;if("geo"===b||"JSON"===b){let c=[],d;(d="geo"===b?a.value.userData:a.value)&&(c=Object.keys(d).sort().map(f=>d[f]));return h.turnIntoCSList(c)}return B};A.assignlist=function(a,b){let c=a.length;var d=b.length;d<c&&(c=d);
for(d=0;d<c;d++)Wa([a[d],b[d]],[])};v.if$2=function(a,b){return v.if$3(a,b)};v.if$3=function(a,b){b=V(a[0]);if("boolean"===b.ctype){if(!0===b.value)return K(a[1]);if(3===a.length)return K(a[2])}else"undefined"!==b.ctype&&qb("Condition for if is not boolean");return B};v.and$2=wc;v.or$2=xb;v.xor$2=function(a,b){b=V(a[0]);a=V(a[1]);return"boolean"===b.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:b.value!==a.value}:B};v.not$1=function(a,b){a=V(a[0]);return"boolean"===a.ctype?{ctype:"boolean",value:!a.value}:
B};A.genericListMathGen=function(a,b,c){v[a+"$1"]=function(f,k){f=K(f[0]);if("list"!==f.ctype)return B;f=f.value;if(0===f.length)return c;k=f[0];for(let m=1;m<f.length;m++)k=b(k,f[m]);return k};const d=a+"$3";v[a+"$2"]=function(f,k){return v[d]([f[0],null,f[1]])};v[d]=function(f,k){k=V(f[0]);if("list"!==k.ctype)return B;k=k.value;if(0===k.length)return c;let m="#";null!==f[1]&&"variable"===f[1].ctype&&(m=f[1].name);M.newvar(m);M.setvar(m,k[0]);let p=K(f[2]);for(let u=1;u<k.length;u++){M.setvar(m,
k[u]);const x=K(f[2]);p=b(p,x)}M.removevar(m);return p}};A.genericListMathGen("product",G.mult,n.real(1));A.genericListMathGen("sum",G.add,n.real(0));A.genericListMathGen("max",G.max,B);A.genericListMathGen("min",G.min,B);v.max$2=function(a,b){b=V(a[0]);if("list"===b.ctype)return v.max$3([b,null,a[1]]);a=V(a[1]);return v.max$1([h.turnIntoCSList([b,a])])};v.min$2=function(a,b){b=V(a[0]);if("list"===b.ctype)return v.min$3([b,null,a[1]]);a=V(a[1]);return v.min$1([h.turnIntoCSList([b,a])])};v.add$2=Zb;
v.sub$2=$b;v.mult$2=Vc;v.div$2=Wd;v.mod$2=function(a,b){b=V(a[0]);a=V(a[1]);return"number"===b.ctype&&"number"===a.ctype?n.mod(b,a):B};v.pow$2=ye;v.exp$1=function(a,b){a=V(a[0]);return"number"===a.ctype?n.exp(a):B};v.sin$1=function(a,b){a=V(a[0]);return"number"===a.ctype?n.sin(a):B};v.sqrt$1=function(a,b){a=V(a[0]);return"number"===a.ctype?n.sqrt(a):B};A.laguerre=function(a,b,c){if("list"!==a.ctype)return B;const d=a.value.length-1;var f;for(f=0;f<=d;f++)if("number"!==a.value[f].ctype)return B;if("number"!==
b.ctype)return B;const k=[1,.3141,.5926,.5358,.9793,.2385,.6264,.3383,.2795,.0288];var m;for(let x=1;x<=c;x++){var p=m=n.zero;var u=a.value[d];for(f=d-1;0<=f;f--)m=n.add(p,n.mult(m,b)),p=n.add(u,n.mult(p,b)),u=n.add(a.value[f],n.mult(u,b));if(n._helper.isLessThan(n.abs(u),n.real(1E-14)))break;f=n.div(p,u);p=n.mult(f,f);u=n.sub(p,n.div(n.mult(n.real(2),m),u));m=n.sqrt(n.mult(n.real(d-1),n.sub(n.mult(n.real(d),u),p)));u=n.add(f,m);f=n.sub(f,m);n._helper.isLessThan(n.abs(u),n.abs(f))&&(u=f);f=n._helper.isLessThan(n.real(1E-14),
n.abs(u))?n.div(n.real(d),u):n.mult(n.add(n.abs(b),n.one),n.complex(Math.cos(x),Math.sin(x)));if(n._helper.isLessThan(n.abs(f),n.real(1E-14)))break;0===x%20&&x<c-19&&(f=n.mult(f,n.real(k[Math.floor(x/20)])));b=n.sub(b,f)}return b};A.quadratic_roots=function(a){if("list"!==a.ctype)return B;const b=a.value[2],c=a.value[1];a=a.value[0];if(n._helper.isZero(a))return[n.zero,n.neg(n.div(c,b))];let d=n.sqrt(n.sub(n.mult(c,c),n.mult(n.real(4),n.mult(b,a))));0<=n.re(c)&&(d=n.neg(d));return[n.div(n.sub(d,c),
n.mult(n.real(2),b)),n.div(n.mult(n.real(2),a),n.sub(d,c))]};A.roots=function(a){let b=[];const c=a,d=a.value.length-1;if(0>=d)return h.turnIntoCSList([]);if(n._helper.isZero(a.value[d]))return b=A.roots(h.turnIntoCSList(a.value.slice(0,d))),h.append(b,n.infinity);if(1===d)b[0]=n.neg(n.div(a.value[0],a.value[1]));else if(2===d)b=A.quadratic_roots(a);else{for(let f=0;f<d-2;f++){b[f]=A.laguerre(a,n.zero,200);b[f]=A.laguerre(c,b[f],1);const k=[];k[d-f]=a.value[d-f];for(let m=d-f;0<m;m--)k[m-1]=n.add(a.value[m-
1],n.mult(k[m],b[f]));k.shift();a=h.turnIntoCSList(k)}a=A.quadratic_roots(a);b[d-2]=a[0];b[d-1]=a[1]}return h.turnIntoCSList(b)};v.roots$1=function(a,b){a=V(a[0]);if("list"===a.ctype){for(b=0;b<a.value.length;b++)if("number"!==a.value[b].ctype)return B;a=A.roots(a);return h.sort1(a)}return B};v.autodiff$3=function(a,b){b="x";let c;if("function"===a[0].ctype)c=J[a[0].oper].body,b=a[0].args[0].name;else if("function"===typeof a[0].impl)c=a[0];else return qb("could not parse function"),B;const d=V(a[1]);
a=V(a[2]);if(1>a.value.real)return qb("grade cant be < 1"),B;a=n.add(a,n.real(1));return Ma.autodiff(c,b,d,a)};v.cos$1=function(a,b){a=V(a[0]);return"number"===a.ctype?n.cos(a):B};v.tan$1=function(a,b){a=V(a[0]);return"number"===a.ctype?n.tan(a):B};v.arccos$1=function(a,b){a=V(a[0]);return"number"===a.ctype?n.arccos(a):B};v.arcsin$1=function(a,b){a=V(a[0]);return"number"===a.ctype?n.arcsin(a):B};v.arctan$1=function(a,b){a=V(a[0]);return"number"===a.ctype?n.arctan(a):B};v.arctan2$2=function(a,b){b=
V(a[0]);a=V(a[1]);return"number"===b.ctype&&"number"===a.ctype?n.arctan2(b,a):B};v.arctan2$1=function(a,b){a=V(a[0]);if("list"===a.ctype&&2===a.value.length){if(a=a.value,"number"===a[0].ctype&&"number"===a[1].ctype)return v.arctan2$2(a,b)}else if("number"===a.ctype)return n.arctan2(a);return B};v.log$1=function(a,b){a=V(a[0]);return"number"===a.ctype?n.log(a):B};A.recursiveGen=function(a){const b=n[a],c=h[a];v[a+"$1"]=function(d,f){d=V(d[0]);return"number"===d.ctype?b(d):"list"===d.ctype?c(d):B}};
A.recursiveGen("im");A.recursiveGen("re");A.recursiveGen("conjugate");A.recursiveGen("round");A.recursiveGen("ceil");A.recursiveGen("floor");A.recursiveGen("abs");v.abs_infix=v.abs$1;v.random$0=function(a,b){return n.real(n._helper.rand())};v.random$1=function(a,b){a=V(a[0]);return"number"===a.ctype?n.complex(a.value.real*n._helper.rand(),a.value.imag*n._helper.rand()):B};v.seedrandom$1=function(a,b){a=V(a[0]);"number"===a.ctype&&n._helper.seedrandom(a.value.real);return B};v.randomnormal$0=function(a,
b){return n.real(n._helper.randnormal())};v.randominteger$1=function(a,b){b=V(a[0]);return"number"===b.ctype?(a=b.value.real|0,b=b.value.imag|0,a=a*n._helper.rand()|0,b=b*n._helper.rand()|0,n.complex(a,b)):B};v.randomint$1=v.randominteger$1;v.randombool$0=function(a,b){return.5<n._helper.rand()?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};v.isreal$1=function(a,b){a=K(a[0]);return"number"===a.ctype&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};v.isinteger$1=
function(a,b){a=K(a[0]);return"number"===a.ctype&&n._helper.isAlmostReal(a)&&a.value.real===Math.floor(a.value.real)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};v.iseven$1=function(a,b){a=K(a[0]);return"number"===a.ctype&&n._helper.isAlmostReal(a)&&a.value.real/2===Math.floor(a.value.real/2)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};v.isodd$1=function(a,b){a=K(a[0]);return"number"===a.ctype&&n._helper.isAlmostReal(a)&&(a.value.real-1)/2===Math.floor((a.value.real-1)/2)?{ctype:"boolean",
value:!0}:{ctype:"boolean",value:!1}};v.iscomplex$1=function(a,b){return"number"===K(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};v.isstring$1=function(a,b){return"string"===K(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};v.islist$1=function(a,b){return"list"===K(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};v.ismatrix$1=function(a,b){a=K(a[0]);return-1!==h._helper.colNumb(a)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};v.iscircle$1=
function(a,b){a=K(a[0]);return"geo"===a.ctype&&"C"===a.value.kind&&"Circle"===a.value.matrix.usage?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};v.isconic$1=function(a,b){a=K(a[0]);return"geo"===a.ctype&&"C"===a.value.kind?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};v.isline$1=function(a,b){a=K(a[0]);return"geo"===a.ctype&&"L"===a.value.kind?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};v.ispoint$1=function(a,b){a=K(a[0]);return"geo"===a.ctype&&"P"===a.value.kind?{ctype:"boolean",
value:!0}:{ctype:"boolean",value:!1}};v.isgeometric$1=function(a,b){return"geo"===K(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};v.isnumbermatrix$1=function(a,b){a=K(a[0]);return h.isNumberMatrix(a)};v.isnumbervector$1=function(a,b){a=K(a[0]);return h.isNumberVector(a)};v.issun$1=function(a,b){a=K(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Sun"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};v.ismass$1=function(a,b){a=K(a[0]);return"geo"===
a.ctype&&void 0!==a.value.behavior&&"Mass"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};v.isspring$1=function(a,b){a=K(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Spring"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};v.isbouncer$1=function(a,b){a=K(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Bouncer"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};v.isundefined$1=function(a,
b){return"undefined"===K(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};const la={ArcBy3:"Arc",CenterOfConic:"Center",ConicBy1p4l:"Conic1P4L",ConicBy4p1l:"Conic4P1L",ConicBy5lines:"Conic5L",ConicBy2Foci1P:"ConicFoci",ConicFromPrincipalDirections:"ConicPrincipleDirs",Free:"FreePoint",PolarOfLine:"PolarLine",PolarOfPoint:"PolarPoint",PointOnSegment:"PointOnLine",Button:"Text",ToggleButton:"Text",TrReflectionL:"TrReflection",TrReflectionP:"TrReflection",TrReflectionC:"TrReflection",
TrTranslation:"TrProjection",TrSimilarity:"TrProjection",TrAffine:"TrProjection",TransformP:"Transform",TransformL:"Transform",TransformSegment:"Transform",TransformS:"Transform",TransformPolygon:"Transform",TransformArc:"Transform",TransformConic:"Transform",TransformC:"Transform",TrMoebiusP:"Transform",TrMoebiusL:"Transform",TrMoebiusSegment:"Transform",TrMoebiusS:"Transform",TrMoebiusPolygon:"Transform",TrMoebiusArc:"Transform",TrMoebiusCircle:"Transform",TrMoebiusC:"Transform",TrInverseMoebius:"TrInverse",
Perp:"Orthogonal",Para:"Parallel",AngleBisector:"AngularBisector",IntersectLC:"IntersectionConicLine",IntersectCirCir:"IntersectionCircleCircle",OtherPointOnCircle:"PointOnCircle"};v.algorithm$1=function(a,b){a=K(a[0]);if("geo"===a.ctype){a=a.value;let c=a.type;b=V(b.compatibility);"string"===b.ctype&&/^cinderella$/i.test(b.value)&&(/^Select/.test(c)&&(a=E.csnames[a.args[0]],c=a.type),la.hasOwnProperty(c)?c=la[c]:"CircleMr"===c&&(c=a.pinned?"CircleByFixedRadius":"CircleByRadius"));return G.string(c)}return B};
v.inputs$1=function(a,b){a=K(a[0]);if("geo"===a.ctype){a=a.value;b=a.type;let c=[];a.args&&(c=a.args.map(function(d){return{ctype:"geo",value:E.csnames[d]}}));if(/^Select/.test(b)||t[b].isMovable)switch(a.kind){case "P":case "L":c.push(a.homog);break;case "C":c.push(a.matrix)}return h.turnIntoCSList(c)}return B};v.moveto$2=function(a,b){b=K(a[0]);a=V(a[1]);"geo"===b.ctype&&(b=b.value,h._helper.isNumberVecN(a,2)?Z.setField(b,"xy",a):h._helper.isNumberVecN(a,3)&&Z.setField(b,"homog",a));return B};v.continuefromhere$0=
function(a,b){Fc();return B};v.matrixrowcolumn$1=function(a,b){a=K(a[0]);return-1!==h._helper.colNumb(a)?h.realVector([a.value.length,a.value[0].value.length]):B};v.rowmatrix$1=function(a,b){a=K(a[0]);return"list"===a.ctype?h.turnIntoCSList([a]):B};v.columnmatrix$1=function(a,b){a=K(a[0]);return"list"===a.ctype?h.turnIntoCSList(a.value.map(function(c){return h.turnIntoCSList([c])})):B};v.submatrix$3=function(a,b){b=K(a[0]);const c=K(a[1]);a=K(a[2]);if("list"===b.ctype&&"number"===c.ctype&&"number"===
a.ctype){const d=Math.round(c.value.real);a=Math.round(a.value.real);b=b.value.slice();0<a&&a<=b.length&&b.splice(a-1,1);let f=!0;b=b.map(function(k){if("list"!==k.ctype)f=!1;else return k=k.value.slice(),0<d&&d<=k.length&&k.splice(d-1,1),h.turnIntoCSList(k)});return f?h.turnIntoCSList(b):B}return B};v.complex$1=function(a,b){var c=V(a[0]);if("list"===c.ctype&&h.isNumberVector(c)){if(2===c.value.length)return a=c.value[0],b=c.value[1],n.complex(a.value.real-b.value.imag,b.value.real+a.value.imag);
if(3===c.value.length)return a=c.value[0],b=c.value[1],c=c.value[2],a=n.div(a,c),b=n.div(b,c),n.complex(a.value.real-b.value.imag,b.value.real+a.value.imag)}return B};v.gauss$1=function(a,b){a=V(a[0]);return"number"===a.ctype?h.realVector([a.value.real,a.value.imag]):B};v.cross$2=wd;v.crossratio$4=function(a,b){b=K(a[0]);const c=K(a[1]),d=K(a[2]);a=K(a[3]);const f=sa(b),k=sa(c),m=sa(d),p=sa(a);return f!==B&&k!==B&&m!==B&&p!==B?h.crossratio3(f,k,m,p,h.ii):"number"===b.ctype&&"number"===c.ctype&&"number"===
d.ctype&&"number"===a.ctype?n.div(n.mult(n.sub(b,d),n.sub(c,a)),n.mult(n.sub(b,a),n.sub(c,d))):B};v.para$2=function(a,b){b=V(a[0]);var c=V(a[1]);a=sa(b);const d=sa(c);if(b!==B&&c!==B){c=c.usage;let f=a,k=d;if("Line"===b.usage||"Point"===c)f=d,k=a;b=h.cross(h.cross(h.linfty,k),f);return G.withUsage(b,"Line")}return B};v.perp$2=function(a,b){b=V(a[0]);var c=V(a[1]);a=sa(b);const d=sa(c);if(b!==B&&c!==B){const f=c.usage||d.usage;c=a;let k=d;if("Line"===(b.usage||a.usage)||"Point"===f)c=d,k=a;b=h.turnIntoCSList([k.value[0],
k.value[1],n.zero]);b=h.cross(b,c);return G.withUsage(b,"Line")}return B};v.perp$1=function(a,b){a=V(a[0]);return h._helper.isNumberVecN(a,2)?h.turnIntoCSList([n.neg(a.value[1]),a.value[0]]):B};v.parallel$2=v.para$2;v.perpendicular$2=v.perp$2;v.perpendicular$1=v.perp$1;v.meet$2=function(a,b){b=sa(a[0]);a=sa(a[1]);return b!==B&&a!==B?(a=h.cross(b,a),G.withUsage(a,"Point")):B};v.join$2=function(a,b){b=sa(a[0]);a=sa(a[1]);return b!==B&&a!==B?(a=h.cross(b,a),G.withUsage(a,"Line")):B};v.dist$2=function(a,
b){b=V(a[0]);a=V(a[1]);a=$b([b,a],[]);return v.abs$1([a],[])};v.dist_infix=v.dist$2;v.point$1=function(a,b){a=K(a[0]);return h._helper.isNumberVecN(a,3)||h._helper.isNumberVecN(a,2)?G.withUsage(a,"Point"):a};v.line$1=function(a,b){a=K(a[0]);return h._helper.isNumberVecN(a,3)?G.withUsage(a,"Line"):a};v.det$3=function(a,b){b=sa(a[0]);const c=sa(a[1]);a=sa(a[2]);if(b!==B&&c!==B&&a!==B)return h.det3(b,c,a)};v.det$1=function(a,b){a=V(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?
h.det(a):B};v.eig$1=function(a,b){a=V(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.eig(a):B};v.eigenvalues$1=function(a,b){a=V(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.eig(a,!1).value[0]:B};v.rank$1=function(a,b){a=V(a[0]);if("list"===a.ctype){const c=h._helper.colNumb(a);if(-1!==c&&c===a.value.length)return h.rank(a,b.precision)}return B};v.kernel$1=function(a,b){a=V(a[0]);if("list"===a.ctype){const c=h._helper.colNumb(a);
if(-1!==c&&c===a.value.length)return b=h.nullSpace(a,b.precision),h.transpose(b)}return B};v.eigenvectors$1=function(a,b){a=V(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.eig(a).value[1]:B};v.area$3=function(a,b){b=sa(a[0]);let c=sa(a[1]);a=sa(a[2]);if(b!==B&&c!==B&&a!==B){const d=b.value[2],f=c.value[2],k=a.value[2];if(!n._helper.isAlmostZero(d)&&!n._helper.isAlmostZero(f)&&!n._helper.isAlmostZero(k))return b=h.scaldiv(d,b),c=h.scaldiv(f,c),a=h.scaldiv(k,a),
b=h.det3(b,c,a),n.realmult(.5,b)}return B};v.inverse$1=function(a,b){a=V(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.inverse(a):B};v.linearsolve$2=function(a,b){b=V(a[0]);a=V(a[1]);if("list"===b.ctype){const c=h._helper.colNumb(b);if(-1!==c&&c===b.value.length&&h._helper.isNumberVecN(a,c))return h.linearsolve(b,a)}return B};const ia=[[[]],[[0]],[[0,1],[1,0]],[[0,1,2],[0,2,1],[1,0,2],[1,2,0],[2,0,1],[2,1,0]],[[0,1,2,3],[0,1,3,2],[0,2,1,3],[0,2,3,1],[0,3,1,2],
[0,3,2,1],[1,0,2,3],[1,0,3,2],[1,2,0,3],[1,2,3,0],[1,3,0,2],[1,3,2,0],[2,0,1,3],[2,0,3,1],[2,1,0,3],[2,1,3,0],[2,3,0,1],[2,3,1,0],[3,0,1,2],[3,0,2,1],[3,1,0,2],[3,1,2,0],[3,2,0,1],[3,2,1,0]]];v.mincostmatching$1=function(a,b){var c=K(a[0]);if(h.isNumberMatrix(c).value){a=c.value.length;b=h._helper.colNumb(c);var d=a<b?b:a;let f,k;const m=Array(d);for(f=0;f<d;++f)for(m[f]=Array(d),k=0;k<d;++k)m[f][k]=f<a&&k<b?c.value[f].value[k].value.real:0;c=yb(m);d=Array(a);for(f=0;f<a;++f)k=c[f],d[f]=k<b?n.real(k+
1):n.real(0);return h.turnIntoCSList(d)}return B};v.take$2=Dc;v.length$1=function(a,b){a=K(a[0]);return"list"===a.ctype||"string"===a.ctype?n.real(a.value.length):B};v.pairs$1=function(a,b){a=K(a[0]);return"list"===a.ctype?h.pairs(a):B};v.triples$1=function(a,b){a=K(a[0]);return"list"===a.ctype?h.triples(a):B};v.cycle$1=function(a,b){a=K(a[0]);return"list"===a.ctype?h.cycle(a):B};v.consecutive$1=function(a,b){a=K(a[0]);return"list"===a.ctype?h.consecutive(a):B};v.reverse$1=function(a,b){a=K(a[0]);
return"list"===a.ctype?h.reverse(a):"string"===a.ctype?(a=Array.from(a.value).reverse().join(""),G.string(a)):B};v.directproduct$2=function(a,b){b=K(a[0]);a=K(a[1]);return"list"===b.ctype&&"list"===a.ctype?h.directproduct(b,a):B};v.concat$2=fc;v.common$2=Ic;v.remove$2=xd;v.append$2=yd;v.prepend$2=pc;v.contains$2=function(a,b){b=K(a[0]);a=K(a[1]);return"list"===b.ctype?h.contains(b,a):B};v.sort$2=function(a,b){return v.sort$3([a[0],null,a[1]],b)};v.sort$3=function(a,b){var c=V(a[0]);if("list"!==c.ctype)return B;
b="#";null!==a[1]&&"variable"===a[1].ctype&&(b=a[1].name);c=c.value;const d=[];M.newvar(b);let f;for(f=0;f<c.length;f++)M.setvar(b,c[f]),d[f]={val:c[f],result:K(a[2])};M.removevar(b);d.sort(G.compareResults);a=[];for(f=0;f<c.length;f++)a[f]=d[f].val;return{ctype:"list",value:a}};v.sort$1=function(a,b){a=K(a[0]);return"list"===a.ctype?h.sort1(a):B};v.set$1=function(a,b){a=K(a[0]);return"list"===a.ctype?h.set(a):B};v.combinations$2=function(a,b){function c(u,x){u===k?p.push(h.turnIntoCSList(m.slice())):
x<f&&(m[u]=d.value[x],c(u+1,x+1),c(u,x+1))}const d=K(a[0]);a=K(a[1]);let f,k,m,p;if("number"===a.ctype){k=a.value.real|0;if("number"===d.ctype){f=d.value.real|0;f-k<k&&(k=f-k);if(0>k)return n.real(0);if(0===k)return n.real(1);if(1===k)return d;b=a=1;for(let u=1;u<=k;++u){let x=f-k+u|0,y=u|0,C=O(x,y)|0;x=x/C|0;y=y/C|0;C=O(a,y)|0;a=a/C|0;y=y/C|0;C=O(x,b)|0;x=x/C|0;b=b/C|0;a=a*x|0;b=b*y|0}return n.real(a/b)}if("list"===d.ctype){f=d.value.length;if(0>k||k>f)return h.turnIntoCSList([]);if(0===k)return h.turnIntoCSList([h.turnIntoCSList([])]);
if(k===f)return h.turnIntoCSList([d]);p=[];m=Array(k);c(0,0);return h.turnIntoCSList(p)}}return B};v.zeromatrix$2=function(a,b){b=V(a[0]);a=V(a[1]);return"number"===b.ctype&&"number"===a.ctype?h.zeromatrix(b,a):B};v.zerovector$1=function(a,b){a=V(a[0]);return"number"===a.ctype?h.zerovector(a):B};v.transpose$1=function(a,b){a=V(a[0]);return"list"===a.ctype&&-1!==h._helper.colNumb(a)?h.transpose(a):B};v.row$2=function(a,b){b=V(a[0]);a=V(a[1]);return"number"===a.ctype&&"list"===b.ctype&&-1!==h._helper.colNumb(b)?
h.row(b,a):B};v.column$2=function(a,b){b=V(a[0]);a=V(a[1]);return"number"===a.ctype&&"list"===b.ctype&&-1!==h._helper.colNumb(b)?h.column(b,a):B};v.dict$0=function(a,b){a=kc.create();for(const c in b)b.hasOwnProperty(c)&&kc.put(a,G.string(c),K(b[c]));return a};v.put$3=function(a,b){b=K(a[0]);const c=K(a[1]);a=K(a[2]);return"dict"===b.ctype?(b=kc.clone(b),kc.put(b,c,a),b):B};v.get$2=function(a,b){b=K(a[0]);a=K(a[1]);return"dict"===b.ctype?kc.get(b,a,B):B};v.red$1=function(a,b){a=K(a[0]);return"number"===
a.ctype?h.realVector([Math.min(1,Math.max(0,a.value.real)),0,0]):B};v.green$1=function(a,b){a=K(a[0]);return"number"===a.ctype?h.realVector([0,Math.min(1,Math.max(0,a.value.real)),0]):B};v.blue$1=function(a,b){a=K(a[0]);return"number"===a.ctype?h.realVector([0,0,Math.min(1,Math.max(0,a.value.real))]):B};v.gray$1=function(a,b){a=K(a[0]);return"number"===a.ctype?(a=Math.min(1,Math.max(0,a.value.real)),h.realVector([a,a,a])):B};v.grey$1=v.gray$1;A.HSVtoRGB=function(a,b,c){let d,f,k,m,p,u;a&&void 0===
b&&void 0===c&&(b=a.s,c=a.v,a=a.h);m=Math.floor(6*a);p=6*a-m;a=c*(1-b);u=c*(1-p*b);b=c*(1-(1-p)*b);switch(m%6){case 0:d=c;f=b;k=a;break;case 1:d=u;f=c;k=a;break;case 2:d=a;f=c;k=b;break;case 3:d=a;f=u;k=c;break;case 4:d=b;f=a;k=c;break;case 5:d=c,f=a,k=u}return h.realVector([d,f,k])};v.hue$1=function(a,b){a=K(a[0]);return"number"===a.ctype?(a=a.value.real,a-=Math.floor(a),A.HSVtoRGB(a,1,1)):B};A.shapeconvert=function(a){let b;if("circle"===a.type){var c=a.value.value[0];c=G.div(c,c.value[2]);var d=
c.value[0].value.real,f=c.value[1].value.real;a=a.value.value[1].value.real;b=Array(125);var k=2*Math.PI/125;for(c=0;125>c;c++)b[c]={X:d+Math.cos(c*k)*a,Y:f+Math.sin(c*k)*a};return[b]}if("polygon"===a.type){d=[];for(c=0;c<a.value.length;c++){f=a.value[c];b=[];for(k=0;k<f.length;k++)b[k]={X:f[k].X,Y:f[k].Y};d[c]=b}return d}};A.shapeop=function(a,b,c){a=A.shapeconvert(a);var d=A.shapeconvert(b);ClipperLib.JS.ScaleUpPaths(a,1E3);ClipperLib.JS.ScaleUpPaths(d,1E3);b=new ClipperLib.Clipper;b.AddPaths(a,
ClipperLib.PolyType.ptSubject,!0);b.AddPaths(d,ClipperLib.PolyType.ptClip,!0);d=a=ClipperLib.PolyFillType.pftNonZero;const f=new ClipperLib.Paths;b.Execute(c,f,a,d);ClipperLib.JS.ScaleDownPaths(f,1E3);return{ctype:"shape",type:"polygon",value:f}};A.shapecommon=function(a,b){return A.shapeop(a,b,ClipperLib.ClipType.ctIntersection)};A.shaperemove=function(a,b){return A.shapeop(a,b,ClipperLib.ClipType.ctDifference)};A.shapeconcat=function(a,b){return A.shapeop(a,b,ClipperLib.ClipType.ctUnion)};v.key$0=
function(a,b){return{ctype:"string",value:Ye}};v.keycode$0=function(a,b){return n.real(se)};v.mouse$0=function(a,b){return b.id?(a=K(b.id),"number"===a.ctype&&(a=a.value.real,tc[a])?h.realVector(tc[a]):B):h.realVector(Pb)};v.mover$0=function(a,b){return tb&&tb.mover?{ctype:"geo",value:tb.mover}:B};v.multiid$0=function(a,b){return n.real(Xb)};v.multiidlist$0=function(a,b){a=[];for(let c in tc)a.push(c);return h.realVector(a)};v.translate$1=function(a,b){a=V(a[0]);"list"===a.ctype&&h.isNumberVector(a)&&
2===a.value.length&&N.translate(a.value[0].value.real,a.value[1].value.real);return B};v.rotate$1=function(a,b){a=V(a[0]);"number"===a.ctype&&N.rotate(a.value.real);return B};v.scale$1=function(a,b){a=V(a[0]);"number"===a.ctype&&N.scale(a.value.real);return B};v.greset$0=function(a,b){a=cd.stack.length;N.greset();for(b=0;b<a;b++)P.restore();return B};v.gsave$0=function(a,b){N.gsave();P.save();return B};v.grestore$0=function(a,b){N.grestore();P.restore();return B};v.color$1=function(a,b){a=V(a[0]);
"list"===a.ctype&&h.isNumberVector(a).value&&N.setcolor(a);return B};v.linecolor$1=function(a,b){a=V(a[0]);"list"===a.ctype&&h.isNumberVector(a).value&&N.setlinecolor(a);return B};v.pointcolor$1=function(a,b){a=V(a[0]);"list"===a.ctype&&h.isNumberVector(a).value&&N.setpointcolor(a);return B};v.alpha$1=function(a,b){a=V(a[0]);"number"===a.ctype&&N.setalpha(a);return B};v.pointsize$1=function(a,b){a=V(a[0]);"number"===a.ctype&&N.setpointsize(a);return B};v.linesize$1=function(a,b){a=V(a[0]);"number"===
a.ctype&&N.setlinesize(a);return B};v.textsize$1=function(a,b){a=V(a[0]);"number"===a.ctype&&N.settextsize(a);return B};v.playanimation$0=function(a,b){S();return B};v.pauseanimation$0=function(a,b){ua();return B};v.stopanimation$0=function(a,b){Ea();return B};v.text$1=function(a,b){a=V(a[0]);return G.string(fa(a))};v.replace$3=function(a,b){var c=K(a[0]);b=K(a[1]);a=K(a[2]);if("string"===c.ctype&&"string"===b.ctype&&"string"===a.ctype)return c=c.value,b=b.value.replace(/[^A-Za-z0-9]/g,"\\$&"),a=
a.value.replace(/\$/g,"$$$$"),c=c.replace(new RegExp(b,"g"),a),{ctype:"string",value:c}};v.replace$2=function(a,b){function c(p,u,x){let y="";f=d=-1;for(let C=0;C<u.length;C++){const F=u[C][0],H=p.indexOf(F,x);-1!==H&&(-1===d?(y=F,d=H,f=C):H<d&&(y=F,d=H,f=C))}return y}let d,f;var k;b=K(a[0]);const m=K(a[1]);if("string"===b.ctype&&"list"===m.ctype){a=b.value;b=[];for(k of m.value)"list"===k.ctype&&2===k.value.length&&"string"===k.value[0].ctype&&"string"===k.value[1].ctype&&(b[b.length]=[k.value[0].value,
k.value[1].value]);d=-1;for(k=c(a,b,0);-1!==d;)a=a.substring(0,d)+b[f][1]+a.substring(d+k.length,a.length),k=d+b[f][1].length,k=c(a,b,k);return{ctype:"string",value:a}}return B};v.substring$3=function(a,b){b=K(a[0]);const c=V(a[1]);a=V(a[2]);return"string"===b.ctype&&"number"===c.ctype&&"number"===a.ctype?{ctype:"string",value:b.value.substring(Math.floor(c.value.real),Math.floor(a.value.real))}:B};v.tokenize$2=function(a,b){var c=K(a[0]);a=K(a[1]);if("string"===c.ctype&&"string"===a.ctype)return v.tokenize$2([c,
h.turnIntoCSList([a])],b);if("string"===c.ctype&&"list"===a.ctype){c=c.value;if(0===a.value.length){a=!0;if(void 0!==b.autoconvert){var d=K(b.autoconvert);"boolean"===d.ctype&&(a=d.value)}return a&&""!==c&&(a=Number(c),!isNaN(a))?n.real(a):G.string(c)}d=a.value[0];const f=h.turnIntoCSList(a.value.slice(1));c=c.split(d.value);return h.turnIntoCSList(c.map(function(k){return v.tokenize$2([G.string(k),f],b)}))}return B};v.indexof$2=function(a,b){b=K(a[0]);a=K(a[1]);return"string"===b.ctype&&"string"===
a.ctype?(a=b.value.indexOf(a.value),n.real(a+1)):B};v.indexof$3=function(a,b){b=K(a[0]);const c=K(a[1]);a=K(a[2]);return"string"===b.ctype&&"string"===c.ctype&&"number"===a.ctype?(a=b.value.indexOf(c.value,Math.round(a.value.real)-1),n.real(a+1)):B};v.parse$1=function(a,b){a=K(a[0]);return"string"===a.ctype?(a=qc(a.value),K(a)):B};v.unicode$1=function(a,b){a=K(a[0]);let c=16;b.base&&(b=K(b.base),"number"===b.ctype&&(c=b.value.real));if("string"===a.ctype)b=parseInt(a.value,c);else if("number"===a.ctype)b=
a.value.real;else return B;"undefined"!==typeof String.fromCodePoint?b=String.fromCodePoint(b):65535>=b?b=String.fromCharCode(b):(b-=65536,b=String.fromCharCode((b>>10)+55296,(b&1023)+56320));return G.string(b)};v.international$1=function(a,b){return v.international$2([a[0],null],b)};v.international$2=function(a,b){b=K(a[0]);if("string"!==b.ctype)return B;const c=(aa.translations||{})[aa.language||"en"]||{};if(!c.hasOwnProperty(b.value))return b;const d=c[b.value];if("string"===typeof d)return G.string(d);
if(null===a[1])return b;a=K(a[1]);a="number"===a.ctype?a.value.real:0;a=(c._pluralFormFunction||zd)(a);return a<d.length?G.string(d[a]):b};v.currentlanguage$0=function(a,b){return G.string(aa.language||"en")};A.basismap=function(a,b,c,d){let f=h.turnIntoCSList([a,b,c]);f=h.adjoint3(h.transpose(f));d=G.mult(f,d);f=h.turnIntoCSList([G.mult(d.value[0],a),G.mult(d.value[1],b),G.mult(d.value[2],c)]);return h.transpose(f)};v.map$8=function(a,b){b=sa(a[0]);const c=sa(a[1]),d=sa(a[2]),f=sa(a[3]),k=sa(a[4]),
m=sa(a[5]),p=sa(a[6]);a=sa(a[7]);return k!==B&&m!==B&&p!==B&&a!==B&&b!==B&&c!==B&&d!==B&&f!==B?(a=A.basismap(k,m,p,a),b=A.basismap(b,c,d,f),b=G.mult(a,h.adjoint3(b)),h.normalizeMax(b)):B};v.map$6=function(a,b){b=sa(a[0]);const c=sa(a[1]),d=sa(a[2]);var f=h.realVector([0,0,1]);const k=h.cross,m=k(k(d,k(f,k(b,c))),k(c,k(f,k(b,d))));var p=sa(a[3]);const u=sa(a[4]);a=sa(a[5]);f=k(k(a,k(f,k(p,u))),k(u,k(f,k(p,a))));return p!==B&&u!==B&&a!==B&&f!==B&&b!==B&&c!==B&&d!==B&&m!==B?(p=A.basismap(p,u,a,f),b=
A.basismap(b,c,d,m),b=G.mult(p,h.adjoint3(b)),h.normalizeMax(b)):B};v.map$4=function(a,b){b=h.ii;const c=h.jj,d=sa(a[0]),f=sa(a[1]),k=sa(a[2]);a=sa(a[3]);return k!==B&&a!==B&&d!==B&&f!==B?(a=A.basismap(k,a,b,c),b=A.basismap(d,f,b,c),b=G.mult(a,h.adjoint3(b)),h.normalizeMax(b)):B};v.map$2=function(a,b){b=h.ii;const c=h.jj,d=sa(a[0]),f=G.add(h.realVector([1,0,0]),d);a=sa(a[1]);const k=G.add(h.realVector([1,0,0]),a);return a!==B&&k!==B&&d!==B&&f!==B?(a=A.basismap(a,k,b,c),b=A.basismap(d,f,b,c),b=G.mult(a,
h.adjoint3(b)),h.normalizeMax(b)):B};v.pointreflect$1=function(a,b){b=h.ii;const c=h.jj;a=sa(a[0]);const d=G.add(h.realVector([1,0,0]),a);var f=G.add(h.realVector([-1,0,0]),a);return f!==B&&a!==B&&d!==B?(f=A.basismap(a,f,b,c),b=A.basismap(a,d,b,c),b=G.mult(f,h.adjoint3(b)),h.normalizeMax(b)):B};v.linereflect$1=function(a,b){b=h.ii;const c=h.jj;a=sa(a[0]);var d=h.realVector([Math.random(),Math.random(),Math.random()]),f=h.realVector([Math.random(),Math.random(),Math.random()]);d=h.cross(d,a);f=h.cross(f,
a);return a!==B&&d!==B?(a=A.basismap(d,f,b,c),b=A.basismap(d,f,c,b),b=G.mult(a,h.adjoint3(b)),h.normalizeMax(b)):B};A.extractPointVec=function(a){const b={ok:!1};if("geo"===a.ctype){var c=a.value;if("P"===c.kind)return b.x=Z.getField(c,"x"),b.y=Z.getField(c,"y"),b.z=n.real(1),b.ok=!0,b}if("list"!==a.ctype)return b;var d=a.value;if(2===d.length&&(a=d[0],c=d[1],"number"===a.ctype&&"number"===c.ctype))return b.x=a,b.y=c,b.z=n.real(1),b.ok=!0,b;3===d.length&&(a=d[0],c=d[1],d=d[2],"number"===a.ctype&&
"number"===c.ctype&&"number"===d.ctype&&(b.x=n.div(a,d),b.y=n.div(c,d),b.z=n.real(1),b.ok=!0));return b};v.polygon$1=function(a,b){a=K(a[0]);if("list"===a.ctype){b=[];for(let c=0;c<a.value.length;c++){const d=A.extractPoint(a.value[c]);if(!d.ok)return B;b[c]={X:d.x,Y:d.y}}return{ctype:"shape",type:"polygon",value:[b]}}return B};v.circle$2=function(a,b){b=V(a[0]);a=V(a[1]);b=A.extractPointVec(b);if(!b.ok||"number"!==a.ctype)return B;b=h.turnIntoCSList([b.x,b.y,b.z]);return{ctype:"shape",type:"circle",
value:h.turnIntoCSList([b,a])}};v.screen$0=function(a,b){const c=N.drawingstate.initialmatrix;a=function(d,f){d-=c.tx;f+=c.ty;return{X:(d*c.d-f*c.b)/c.det,Y:-(-d*c.c+f*c.a)/c.det}};return{ctype:"shape",type:"polygon",value:[[a(0,0),a($a,0),a($a,fb),a(0,fb)]]}};v.halfplane$2=function(a,b){b=V(a[0]);a=V(a[1]);var c=sa(b);const d=sa(a);if(b!==B&&a!==B){const k=a.usage;a=c;var f=d;if("Line"===b.usage||"Point"===k)a=d,f=c;b=h.turnIntoCSList([f.value[0],f.value[1],n.zero]);b=h.cross(b,a);f=h.cross(f,b);
f=G.div(f,f.value[2]);a=G.div(a,a.value[2]);a=h.sub(a,f);b=h.abs(a);a=G.div(a,b);b=f.value[0].value.real;f=f.value[1].value.real;c=1E3*a.value[0].value.real;a=1E3*a.value[1].value.real;return{ctype:"shape",type:"polygon",value:[[{X:b+a/2,Y:f-c/2},{X:b+a/2+c,Y:f-c/2+a},{X:b-a/2+c,Y:f+c/2+a},{X:b-a/2,Y:f+c/2}]]}}return B};v.element$1=function(a,b){a=K(a[0]);return"string"===a.ctype&&E.csnames.hasOwnProperty(a.value)?{ctype:"geo",value:E.csnames[a.value]}:B};A.all$1=function(a,b){a=K(a[0]);return"geo"===
a.ctype&&a.value.incidences?h.ofGeos(a.value.incidences.map(function(c){return E.csnames[c]}).filter(b)):h.nil};v.allpoints$0=function(a,b){return h.ofGeos(E.points)};v.allpoints$1=function(a,b){return A.all$1(a,function(c){return"P"===c.kind})};v.allmasses$0=function(a,b){return h.ofGeos(Lb)};v.allmasses$1=function(a,b){return A.all$1(a,function(c){return"P"===c.kind&&c.behavior&&"Mass"===c.behavior.type})};v.allsprings$0=function(a,b){return h.ofGeos(vf)};v.allsprings$1=function(a,b){return A.all$1(a,
function(c){return"S"===c.kind&&c.behavior&&"Spring"===c.behavior.type})};v.alllines$0=function(a,b){return h.ofGeos(E.lines)};v.alllines$1=function(a,b){return A.all$1(a,function(c){return"L"===c.kind||"S"===c.kind})};v.allsegments$0=function(a,b){return h.ofGeos(E.lines.filter(function(c){return"S"===c.kind}))};v.allsegments$1=function(a,b){return A.all$1(a,function(c){return"S"===c.kind})};v.allconics$0=function(a,b){return h.ofGeos(E.conics)};v.allconics$1=function(a,b){return A.all$1(a,function(c){return"C"===
c.kind})};v.allcircles$0=function(a,b){return h.ofGeos(E.conics.filter(function(c){return"Circle"===c.matrix.usage}))};v.allcircles$1=function(a,b){return A.all$1(a,function(c){return"C"===c.kind&&"Circle"===c.matrix.usage})};v.allelements$0=function(a,b){return h.ofGeos(E.gslp)};v.allelements$1=function(a,b){return A.all$1(a,function(c){return!0})};v.elementsatmouse$0=function(a,b){const c=h.realVector([Pb[0],Pb[1],1]),d=function(p){if(n._helper.isAlmostZero(p.value[2]))return Infinity;p=h.normalizeZ(p);
return h.abs(h.sub(p,c)).value.real},f=function(p){p=h.turnIntoCSList([p.value[0],p.value[1],n.zero]);return h.normalizeMax(h.cross(c,p))},k=function(p){var u=G.mult(p.matrix,c);u=f(u);p=t._helper.IntersectLC(u,p.matrix).map(function(x){return d(x)});return.5>Math.min(p[0],p[1])};a=E.points.filter(function(p){return.5>d(p.homog)});b=E.lines.filter(function(p){var u=f(p.homog);u=h.normalizeMax(h.cross(p.homog,u));if((u=.5>d(u))&&"S"===p.kind){var x=p.homog;x=h.turnIntoCSList([x.value[0],x.value[1],
n.zero]);p=h.crossratio3(p.farpoint,p.startpos,p.endpos,c,x).value.real;if(0>p||1<p)u=!1}return u});const m=E.conics.filter(function(p){let u=k(p);if(u&&p.isArc){var x=h.crossratio3harm(p.startPoint,p.endPoint,p.viaPoint,c,h.ii);p=x.value[0];x=x.value[1];n._helper.isAlmostZero(p)?(p=n.div(p,x),x=n.real(1)):(x=n.div(x,p),p=n.real(1));const y=h.abs(h.turnIntoCSList([x,p]));p=n.div(p,y);x=n.div(x,y);x=n.mult(x,p);0>p.value.real&&(x=n.neg(x));0>x.value.real&&(u=!1)}return u});a=a.concat(b,m);return h.ofGeos(a)};
v.incidences$1=v.allelements$1;v.createpoint$2=function(a,b){b=K(a[0]);a=sa(a[1]);return"string"!==b.ctype?(qb("Name must be a string"),B):"list"!==a.ctype&&h.isNumberVector(a)?(qb("Position must be a number vector"),B):{ctype:"geo",value:zb({name:b.value,type:"Free",labeled:!0,pos:a},!0)}};v.create$3=function(a,b){var c=K(a[0]);let d=K(a[1]);var f=K(a[2]);a={};for(var k in b)a[k]=V(b[k]);if("string"===c.ctype)k=c.value;else{if("list"!==c.ctype)return qb("Names must be a string or a list of strings"),
B;if(1!==c.value.length){k=G.string(c.value.map(function(u){return u.value}).join("__"));f=v.create$3([k,d,f],a);var m=[];if(f!==B)for(d=G.string(f.value.kind.replace(/^(.*)s$/,"Select$1")),f=h.turnIntoCSList([G.string(f.value.name)]),b=0;b<c.value.length;++b)a.index=n.real(b+1),m.push(v.create$3([c.value[b],d,f],a));return h.turnIntoCSList(m)}if("string"!==c.value[0].ctype)return qb("Element of names list must be a string"),B;k=c.value[0].value}if("string"!==d.ctype)return qb("Type must be a string"),
B;if("list"!==f.ctype)return qb("Arguments must be a list"),B;if(!t.hasOwnProperty(d.value)&&!Sd.hasOwnProperty(d.value)&&!sf.hasOwnProperty(d.value))return qb("Invalid geometric operation: '"+d.value+"'"),B;c=[];var p=null;for(b=0;b<f.value.length;b++){const u=f.value[b];if("string"===u.ctype)c.push(u.value);else if("geo"===u.ctype)c.push(u.value.name);else if(p=sa(u),p===B)return qb("Unknown argument type"),B}f={name:k,type:d.value,labeled:!0};p&&(f.pos=p);0<c.length&&(f.args=c);for(m in a)f[m]=
G.unwrap(a[m]);return{ctype:"geo",value:zb(f,!0)}};v.create$2=function(a,b){function c(u){function x(F){E.csnames[F]||(y=F)}let y=!1,C;if("P"===u)for(C=0;26>C&!y;C++)8!==C&&9!==C&&x(String.fromCharCode(65+C));else if("L"===u||"S"===u)for(C=0;26>C&!y;C++)8!==C&&9!==C&&x(String.fromCharCode(97+C));for(C=0;!y;C++)x(u+C);return y}let d=K(a[0]);a=K(a[1]);const f={};for(var k in b)f[k]=V(b[k]);if(!t.hasOwnProperty(d.value)&&!Sd.hasOwnProperty(d.value)&&!sf.hasOwnProperty(d.value))return qb("Invalid geometric operation: '"+
d.value+"'"),B;for(;Sd.hasOwnProperty(d.value);)d.value=Sd[d.value];k=t[d.value];b=G.string(c(k.kind));if(a.value.length>k.signature.length){var m="Operation "+d.value+" requieres only "+k.signature.length+" argument"+(1===k.signature.length?"":"s")+" ("+a.value.length+" argument"+(1===a.value.length?"":"s")+" given) to create "+b.value+". Ignoring the last arguments.";if(!f.pos){var p=sa(a.value[a.value.length-1]);p!==B&&(m+=" Use the last argument as modifier `pos`.",f.pos=p)}qb(m);a=h.turnIntoCSList(a.value.slice(0,
k.signature.length))}k=v.create$3([b,d,a],f);if(k!==B&&"s"===k.value.kind[1]&&k.value.results){d=G.string("Select"+k.value.kind[0]);a=h.turnIntoCSList([G.string(k.value.name)]);if(f.pos)return b=G.string(c(k.value.kind[0])),v.create$3([b,d,a],f);m=[];for(p=0;p<k.value.results.value.length;p++)f.index=n.real(p+1),b=G.string(c(k.value.kind[0])),m.push(v.create$3([b,d,a],f));return h.turnIntoCSList(m)}k.isDuplicate&&delete k.isDuplicate;return k};Ja._helper.self=B;v.self$0=function(a,b){return Ja._helper.self};
v.eval$1=function(a,b){Object.entries(b).forEach(function([c,d]){d=K(d);M.newvar(c);M.setvar(c,d)});M.pushVstack("*");a=K(a[0]);M.cleanVstack();Object.entries(b).forEach(function([c]){M.removevar(c)});return a};v.javascript$1=function(a,b){a=K(a[0]);"string"===a.ctype&&(new Function(a.value)).call(Kb);return B};v.use$1=function(a,b){function c(d,f,k){v[d.toLowerCase()+"$"+f]=k}a=K(a[0]);if("string"===a.ctype){a=a.value;let d;aa.plugins&&(d=aa.plugins[a]);d||(d=Ab._pluginRegistry[a]);if(d)return d({instance:Kb,
config:aa,nada:B,evaluate:K,cscompiled:Ha,extractPoint:A.extractPoint,evaluateAndVal:V,defineFunction:c,addShutdownHook:Hc.push.bind(Hc),addAutoCleaningEventListener:Na,getVariable:M.getvar.bind(M),getInitialMatrix:function(){return N.drawingstate.initialmatrix},setTextRenderer:function(f,k){hb=f;k&&(Qc=k)},getImage:function(f,k){"string"===typeof f&&(f=G.string(f));f=Wb(f);if(!f)return null;!k&&f.cdyUpdate&&f.cdyUpdate();return f},getMyfunction:function(f){return J.hasOwnProperty(f)?J[f]:null},scheduleUpdate:l}),
{ctype:"boolean",value:!0};qb("Plugin "+a+" not found");return{ctype:"boolean",value:!1}}return B};v.format$2=function(a,b){function c(p,u){p=p.toFixed(k);let x;do x=p,p=p.substring(0,p.length-1);while(u&&""!==p&&"-"!==p&&+p===+x);u=""+x;b.delimiter&&"string"===b.delimiter.ctype&&(u=u.replace(".",b.delimiter.value));return u}function d(p,u){let x,y;return"number"===p.ctype?(x=c(p.value.real,m),y=c(p.value.imag,m),p=Math.abs(p.value.imag)<10**-u?x:"-"===y.substring(0,1)?x+" - i*"+y.substring(1):x+
" + i*"+y,{ctype:"string",value:p}):"list"===p.ctype?{ctype:"list",value:p.value.map(d)}:{ctype:"string",value:fa(p).toString()}}const f=V(a[0]);a=V(a[1]);let k,m=!0;if(b.truncate){const p=K(b.truncate);"boolean"===p.ctype&&(m=p.value)}return"number"!==f.ctype&&"list"!==f.ctype||"number"!==a.ctype?B:(k=Math.max(0,Math.min(20,Math.round(a.value.real))),d(f,k))};Date.now||(Date.now=function(){return(new Date).getTime()});let ea=0;v.timestamp$0=function(a,b){return n.real(Date.now())};v.seconds$0=function(a,
b){return n.real((Date.now()-ea)/1E3)};v.resetclock$0=function(a,b){ea=Date.now();return B};v.time$0=function(a,b){a=new Date;return h.realVector([a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()])};v.date$0=function(a,b){a=new Date;return h.realVector([a.getFullYear(),a.getMonth()+1,a.getDate()])};v.simulationtime$0=function(a,b){return n.real(Xc*We)};v.settimeout$2=function(a,b){function c(){K(d);l()}b=K(a[0]);const d=a[1];"number"===b.ctype&&"undefined"!==typeof window&&window.setTimeout(c,
1E3*b.value.real);return B};A.formatForWebGL=function(a){return a.toFixed(10)};v.generateWebGL$2=function(a,b){var c=A.formatForWebGL;b=a[0];a=K(a[1]);console.log(a);if("list"!==a.ctype)return B;const d=[];for(let f=0;f<a.value.length;f++)"string"===a.value[f].ctype&&d.push(a.value[f].value);console.log("***********");console.log(d);a=A.plotvars(b);console.log(a);a.includes("a")||a.includes("b")||a.includes("c")||a.includes("d")||a.includes("e")||a.includes("f")||(b=V(b));if("number"===b.ctype)return{ctype:"string",
value:"vec2("+c(b.value.real)+","+c(b.value.imag)+")"};if("variable"===b.ctype)return{ctype:"string",value:b.name};if("string"===b.ctype||"void"===b.ctype)return b;if(2===b.args.length&&("infix"===b.ctype||"function"===b.ctype)){c=v.compileToWebGL$1([b.args[0]],{});a=v.compileToWebGL$1([b.args[1]],{});if("+"===b.oper||"add"===b.oper)return void 0===c.value||"void"===c.ctype?{ctype:"string",value:a.value}:{ctype:"string",value:"addc("+c.value+","+a.value+")"};if("*"===b.oper||"mult"===b.oper)return{ctype:"string",
value:"multc("+c.value+","+a.value+")"};if("/"===b.oper||"div"===b.oper)return{ctype:"string",value:"divc("+c.value+","+a.value+")"};if("-"===b.oper||"sub"===b.oper)return void 0===c.value||"void"===c.ctype?{ctype:"string",value:"negc("+a.value+")"}:{ctype:"string",value:"subc("+c.value+","+a.value+")"};if("^"===b.oper||"pow"===b.oper)return{ctype:"string",value:"powc("+c.value+","+a.value+")"}}if("function"===b.ctype&&1===b.args.length){c=v.compileToWebGL$1([b.args[0]],{});if("sin$1"===b.oper)return{ctype:"string",
value:"sinc("+c.value+")"};if("cos$1"===b.oper)return{ctype:"string",value:"cosc("+c.value+")"};if("tan$1"===b.oper)return{ctype:"string",value:"tanc("+c.value+")"};if("exp$1"===b.oper)return{ctype:"string",value:"expc("+c.value+")"};if("log$1"===b.oper)return{ctype:"string",value:"logc("+c.value+")"};if("arctan$1"===b.oper)return{ctype:"string",value:"arctanc("+c.value+")"};if("arcsin$1"===b.oper)return{ctype:"string",value:"arcsinc("+c.value+")"};if("arccos$1"===b.oper)return{ctype:"string",value:"arccosc("+
c.value+")"};if("sqrt$1"===b.oper)return{ctype:"string",value:"sqrtc("+c.value+")"}}return B};v.compileToWebGL$1=function(a,b){b=A.formatForWebGL;a=a[0];var c=A.plotvars(a);c.includes("a")||c.includes("b")||c.includes("c")||c.includes("d")||c.includes("e")||c.includes("f")||(a=V(a));if("number"===a.ctype)return{ctype:"string",value:"vec2("+b(a.value.real)+","+b(a.value.imag)+")"};if("variable"===a.ctype)return{ctype:"string",value:a.name};if("string"===a.ctype||"void"===a.ctype)return a;if(2===a.args.length&&
("infix"===a.ctype||"function"===a.ctype)){b=v.compileToWebGL$1([a.args[0]],{});c=v.compileToWebGL$1([a.args[1]],{});if("+"===a.oper||"add"===a.oper)return void 0===b.value||"void"===b.ctype?{ctype:"string",value:c.value}:{ctype:"string",value:"addc("+b.value+","+c.value+")"};if("*"===a.oper||"mult"===a.oper)return{ctype:"string",value:"multc("+b.value+","+c.value+")"};if("/"===a.oper||"div"===a.oper)return{ctype:"string",value:"divc("+b.value+","+c.value+")"};if("-"===a.oper||"sub"===a.oper)return void 0===
b.value||"void"===b.ctype?{ctype:"string",value:"negc("+c.value+")"}:{ctype:"string",value:"subc("+b.value+","+c.value+")"};if("^"===a.oper||"pow"===a.oper)return{ctype:"string",value:"powc("+b.value+","+c.value+")"}}if("function"===a.ctype&&1===a.args.length){b=v.compileToWebGL$1([a.args[0]],{});if("sin$1"===a.oper)return{ctype:"string",value:"sinc("+b.value+")"};if("cos$1"===a.oper)return{ctype:"string",value:"cosc("+b.value+")"};if("tan$1"===a.oper)return{ctype:"string",value:"tanc("+b.value+")"};
if("exp$1"===a.oper)return{ctype:"string",value:"expc("+b.value+")"};if("log$1"===a.oper)return{ctype:"string",value:"logc("+b.value+")"};if("arctan$1"===a.oper)return{ctype:"string",value:"arctanc("+b.value+")"};if("arcsin$1"===a.oper)return{ctype:"string",value:"arcsinc("+b.value+")"};if("arccos$1"===a.oper)return{ctype:"string$1",value:"arccosc("+b.value+")"};if("sqrt$1"===a.oper)return{ctype:"string",value:"sqrtc("+b.value+")"}}return B};v.setsimulationspeed$1=function(a,b){a=V(a[0]);"number"===
a.ctype&&pb(a.value.real);return B};v.setsimulationaccuracy$1=function(a,b){a=V(a[0]);"number"===a.ctype&&"undefined"!==typeof Ia&&"undefined"!==typeof Ia.env&&(Ia.env.accuracy=Math.max(1,a.value.real|0));return B};v.setsimulationquality$1=function(a,b){a=V(a[0]);"number"===a.ctype&&"undefined"!==typeof Ia&&"undefined"!==typeof Ia.env&&(a=a.value.real,0===a&&(Ia.env.errorbound=.01,Ia.env.lowestdeltat=1E-5,Ia.env.slowdownfactor=2),1===a&&(Ia.env.errorbound=.001,Ia.env.lowestdeltat=1E-7,Ia.env.slowdownfactor=
2),2===a&&(Ia.env.errorbound=1E-5,Ia.env.lowestdeltat=1E-10,Ia.env.slowdownfactor=4),3===a&&(Ia.env.errorbound=1E-6,Ia.env.lowestdeltat=1E-12,Ia.env.slowdownfactor=4));return B};let oa=null,Fa=null;v.createtool$3=function(a,b){let c="left",d="top",f=null;if(b.space){var k=K(b.space);"number"===k.ctype&&(f=k.value.real/2)}let m=null;b.toolbar&&(k=K(b.toolbar),"string"===k.ctype&&((m=document.getElementById(k.value))||console.warn("Element #"+k.value+" not found")));if(!m){if(b.reference&&(k=K(b.reference),
"string"===k.ctype))switch(k.value){case "UR":c="right";break;case "LL":d="bottom";break;case "LR":c="right",d="bottom"}m=document.createElement("div");m.className="CindyJS-toolbar";jb.parentNode.appendChild(m);k=K(a[1]);var p=K(a[2]);"number"===k.ctype&&(m.style[c]=k.value.real+"px");"number"===p.ctype&&(m.style[d]=p.value.real+"px");null!==f&&(m.style.margin=-f+"px")}a=K(a[0]);if("string"===a.ctype)a=[[a.value]];else if("list"===a.ctype)a=a.value.map(function(u){return"string"===u.ctype?[u.value]:
"list"===u.ctype?u.value.map(function(x){return"string"===x.ctype?x.value:null}):[null]});else return qb("Name must be a string or a list of strings"),B;if(b.flipped&&(k=K(b.flipped),"boolean"===k.ctype&&k.value)){qb("Flipping");let u=0;b=a.length;a.forEach(function(x){x.length>u&&(u=x.length)});k=[];for(p=0;p<u;++p){k[p]=[];for(let x=0;x<b;++x)k[p][x]=a[x][p]||null}a=k}"bottom"===d&&a.reverse();a.forEach(function(u){"right"===c&&u.reverse();const x=document.createElement("div");m.appendChild(x);
u.forEach(function(y){function C(){oa&&oa.classList.remove("CindyJS-active");oa=H;H.classList.add("CindyJS-active");rf=y;const Q=ba[rf].actions;Fa&&(Fa.textContent=Q[0].tooltip||"");dc=[];Rd=Sc=0}ba.hasOwnProperty(y)||(qb("Tool '"+y+"' not implemented yet."),y=null);if(null===y){var F=document.createElement("span");F.className="CindyJS-spacer";x.appendChild(F)}else{var H=document.createElement("button");F=document.createElement("img");F.src=Ab.getBaseDir()+"images/"+y+".png";H.appendChild(F);H.addEventListener("click",
C);oa||C();null!==f&&(H.style.margin=f+"px");x.appendChild(H)}})});return B};v.dropped$0=function(){return $c};v.droppoint$0=function(){return Nd};v.parsecsv$1=function(a,b){let c=!0;var d=V(b.autoconvert);"boolean"===d.ctype&&(c=d.value);d=null;b=V(b.delimiter);"string"===b.ctype&&/^[^"\r\n]$/.test(b.value)&&(d=b.value);a=V(a[0]);if("string"!==a.ctype)return qb("CSV data is not a string"),B;a=a.value;b='(?:"((?:[^"]+|"")*)"|([^]*?))(\r\n|(,)|[\r\n]|$)';d&&(d=d.replace(/[^A-Za-z0-9]/g,"\\$&").replace(/\$/g,
"$$$$"),b=b.replace(/,/g,d));b=new RegExp(b,"g");d=[];const f=[];let k=null;for(;b.lastIndex<a.length;){var m=b.exec(a),p=m[2];"string"===typeof m[1]&&(p=m[1].replace(/""/g,'"'));p=c?/^[Tt]rue$/.test(p)?G.bool(!0):/^[Ff]alse$/.test(p)?G.bool(!1):/^[\-+]?([0-9]+(\.[0-9]*)?|\.[0-9]+|Infinity)$/.test(p)?n.real(Number(p)):G.string(p):G.string(p);d.push(p);m[4]&&b.lastIndex===a.length&&(d.push(G.string("")),m={});if(!m[4]){null===k&&(k=d.length);if(k<d.length)for(k=d.length,m=0;m<f.length;++m)for(p=f[m].length;p<
k;++p)f[m][p]=B;else if(k>d.length)for(m=d.length;m<k;++m)d[m]=B;f.push(d);d=[]}}return h.turnIntoCSList(f.map(h.turnIntoCSList))};v.load$2=function(a,b){return v.load$3([a[0],null,a[1]],b)};v.load$3=function(a,b){function c(){if(k.readyState===XMLHttpRequest.DONE){if(200===k.status)var m=G.string(String(k.responseText));else qb("Failed to load "+f+": "+k.statusText),m=B;M.newvar(d);M.setvar(d,m);K(a[2]);M.removevar(d);l()}}let d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);b=V(a[0]);let f=
null,k=null;"string"===b.ctype&&/^https?:\/\//.test(b.value)&&(f=b.value);return null!==f?(k=new XMLHttpRequest,k.onreadystatechange=c,k.open("GET",f),k.send(),G.bool(!0)):B};v.removeelement$1=function(a,b){a=K(a[0]);"geo"===a.ctype?pd(a.value.name):console.log("argument of removeelement is undefined or not of type <geo>")};v.guess$1=function(a,b){function c(u){if((u=dd.doPSLQ([u,1,Math.PI*Math.E],15))&&0===u[2])return[Math.round(u[0]),Math.round(u[1])]}function d(u){if(n._helper.isAlmostZero(u))return"0";
if(!n._helper.isAlmostReal(u)){var x=u.value.real,y=u.value.imag,C=c(x),F=c(x*x+y*y);if(C&&F){x=-C[0]*F[0];var H=-C[1]*F[0]*2,Q=C[0]*F[1];C=k(-H,2*x);F=H*H-4*Q*x;u=m(F);F/=u*u;F=u===2*x?"+i*sqrt("+-F+")":u===-2*x?"+i*sqrt("+-F+")":"+i*"+k(u,2*x).substring(1)+"*sqrt("+-F+")";u="-"+F.substring(1);H=Math.abs((H*H-4*Q*x)/(4*x*x));x=Math.sqrt(H);H=-Math.sqrt(H);if("+0"===C||"-0"===C)C="";y=Math.abs(y-x)<Math.abs(y-H)?C+F:C+u;y.startsWith("+")&&(y=y.substring(1))}else y=fa(u);return y}var T=dd.doPSLQ([Math.PI,
u.value.real,1],15);y=""+u.value.real;Q=x="";var X=H=1E4;C=1E5;if(T&&3E3>(C=f(T))){x=u.value.real;H=T[0];F=-T[1];T=T[2];var U="";if(0!==H){var pa=Math.round(H);var ca=Math.round(F);U=k(pa,ca)+"*pi"}pa="";0!==T&&(pa=Math.round(T),ca=Math.round(F),pa=k(pa,ca));p=Math.abs(x-(T/F+Math.PI*H/F));x=pa+U;""===x?x="0":x.startsWith("+")&&(x=x.substring(1));H=p}U=dd.doPSLQ([u.value.real*u.value.real,u.value.real,1],15);F=1E5;if(U&&9E3>(F=10+f(U))){u=u.value.real;X=U[0];T=U[1];U=U[2];pa=Math.round(X);ca=Math.round(T);
var Ba=Math.round(U);Q=k(-ca,2*pa);ca=ca*ca-4*Ba*pa;Ba=m(ca);ca/=Ba*Ba;pa=Ba===2*pa?"+sqrt("+ca+")":Ba===-2*pa?"-sqrt("+ca+")":k(Ba,2*pa)+"*sqrt("+ca+")";ca=-T/(2*X);U=Math.abs((T*T-4*U*X)/(4*X*X));pa="+"+pa.substring(1);X="-"+pa.substring(1);T=ca+Math.sqrt(U);U=ca-Math.sqrt(U);if("+0"===Q||"-0"===Q)Q="";Math.abs(u-T)<Math.abs(u-U)?(p=Math.abs(u-T),u=Q+pa):(p=Math.abs(u-U),u=Q+X);u.startsWith("+")&&(u=u.substring(1));Q=u;X=p}C<F&&1E-12>H&&(y=x);F<C&&1E-12>X&&(y=Q);return y}function f(u){let x=Math.abs(u[0]);
Math.abs(u[1])>x&&(x=Math.abs(u[1]));Math.abs(u[2])>x&&(x=Math.abs(u[2]));return x}function k(u,x){let y="+";0>u*x&&(u=Math.abs(u),x=Math.abs(x),y="-");const C=O(u,x);u/=C;x/=C;0>u&&0>x&&(u=-u,x=-x);return 1===x?y+u:y+u+"/"+x}function m(u){for(let x=3E3;0<x;x--)if(0===u%(x*x))return x;return 1}let p=0;a=V(a[0]);return"number"===a.ctype&&n._helper.isFinite(a)?(a=void 0===d(a)?"no guess":d(a),G.string(a)):B};A.extractPoint=function(a){const b={ok:!1};if("geo"===a.ctype){var c=a.value;if("P"===c.kind)return b.x=
Z.getField(c,"x").value.real,b.y=Z.getField(c,"y").value.real,b.ok=!0,b}if("list"!==a.ctype)return b;var d=a.value;if(2===d.length&&(a=d[0],c=d[1],"number"===a.ctype&&"number"===c.ctype))return b.x=a.value.real,b.y=c.value.real,b.ok=!0,b;3===d.length&&(a=d[0],c=d[1],d=d[2],"number"===a.ctype&&"number"===c.ctype&&"number"===d.ctype&&(a=n.div(a,d),c=n.div(c,d),b.x=a.value.real,b.y=c.value.real,b.ok=!0));return b};v.draw$1=function(a,b){a=V(a[0]);if("shape"===a.ctype)A.drawshape(a,b);else if("Line"===
a.usage)L.handleModifs(b,L.lineModifs),L.drawline(a);else{const c=A.extractPoint(a);if(!c.ok){if("undefined"!==typeof a.value&&2===a.value.length)return v.draw$2(a.value,b);return}null!==b&&L.handleModifs(b,L.pointModifs);L.drawpoint(c)}return B};v.draw$2=function(a,b){var c=V(a[0]);a=V(a[1]);c=A.extractPoint(c);a=A.extractPoint(a);if(!c.ok||!a.ok)return B;null!==b&&L.handleModifs(b,L.lineModifs);L.drawsegcore(c,a);return B};v.drawcircle$2=function(a,b){return A.drawcircle(a,b,"D")};A.arcHelper=function(a){const b=
{};b.startPoint=sa(a[0]);b.viaPoint=sa(a[1]);b.endPoint=sa(a[2]);return b};v.fillcircle$2=function(a,b){return A.drawcircle(a,b,"F")};v.drawarc$3=function(a,b){a=A.arcHelper(a);return A.drawarc(a,b,"D")};v.fillarc$3=function(a,b){a=A.arcHelper(a);return A.drawarc(a,b,"F")};A.drawarc=function(a,b,c){var d=a.startPoint;let f=a.viaPoint;a=a.endPoint;if(!h._helper.isAlmostReal(h.turnIntoCSList([d,f,a])))return B;L.handleModifs(b,L.conicModifs);L.preDrawCurve();b=h.det3(d,f,a);if(1E-12<Math.abs(b.value.real)){b=
t._helper.ConicBy5(null,d,f,a,h.ii,h.jj);var k=t._helper.CenterOfConic(b);k=h.normalizeMax(k);b=n.real(0);var m=h.turnIntoCSList([h.turnIntoCSList([k.value[2],b,n.neg(k.value[0])]),h.turnIntoCSList([b,k.value[2],n.neg(k.value[1])]),h.turnIntoCSList([b,b,k.value[2]])]);b=h.normalizeZ(G.mult(m,d));h.normalizeZ(G.mult(m,f));m=h.normalizeZ(G.mult(m,a));b=-Math.atan2(b.value[1].value.real,b.value[0].value.real);m=-Math.atan2(m.value[1].value.real,m.value[0].value.real);k=h.normalizeZ(k);d=h.normalizeZ(d);
f=h.normalizeZ(f);a=h.normalizeZ(a);var p=h.abs(h.sub(d,k)),u=[k.value[0].value.real,k.value[1].value.real];k=N.drawingstate.matrix;const x=u[0]*k.a-u[1]*k.b+k.tx;u=u[0]*k.c-u[1]*k.d-k.ty;d=0<h.det3(d,f,a).value.real;P.save();P.beginPath();P.translate(x,u);P.arc(0,0,p.value.real*k.sdet,b,m,d);"F"===c&&(P.fillStyle=L.lineColor,P.closePath(),P.fill());"D"===c&&P.stroke();P.restore()}else{if("D"!==c)return B;c=A.extractPoint(d);b=A.extractPoint(f);m=A.extractPoint(a);if(!c.ok||!b.ok||!m.ok)return B;
p=(c.x-m.x)*(c.x-m.x)+(c.y-m.y)*(c.y-m.y);k=(m.x-b.x)*(m.x-b.x)+(m.y-b.y)*(m.y-b.y);if(1E-12>(c.x-b.x)*(c.x-b.x)+(c.y-b.y)*(c.y-b.y)||1E-12>p||1E-12>k)return B;0>h.crossratio3(d,a,f,h.cross(h.cross(d,f),h.linfty),h.ii).value.real?L.drawsegcore(c,m):L.drawRaySegment(d,a)}return B};A.drawcircle=function(a,b,c){var d=V(a[0]);a=V(a[1]);var f=A.extractPoint(d);if(!f.ok||"number"!==a.ctype||!n._helper.isAlmostReal(a))return B;d=N.drawingstate.matrix;const k=f.x*d.a-f.y*d.b+d.tx;f=f.x*d.c-f.y*d.d-d.ty;L.handleModifs(b,
L.conicModifs);L.preDrawCurve();P.lineJoin="miter";P.beginPath();P.arc(k,f,Math.abs(a.value.real)*d.sdet,0,2*Math.PI);P.closePath();"D"===c&&P.stroke();"F"===c&&(P.fillStyle=L.lineColor,P.fill());"C"===c&&P.clip();return B};v.drawconic$1=function(a,b){a=V(a[0]);if("list"!==a.ctype||3!==a.value.length&&6!==a.value.length)return console.error("could not parse conic"),B;if(6===a.value.length){for(var c=0;6>c;c++)if("number"!==a.value[c].ctype)return console.error("could not parse conic"),B;const d=n.real(.5);
c=a.value[0];let f=a.value[2];f=n.mult(f,d);const k=a.value[1];let m=a.value[3];m=n.mult(m,d);let p=a.value[4];p=n.mult(p,d);a=a.value[5];a=h.turnIntoCSList([h.turnIntoCSList([c,f,m]),h.turnIntoCSList([f,k,p]),h.turnIntoCSList([m,p,a])])}else{if(!h.isNumberMatrix(a).value||3!==a.value.length||3!==a.value[0].value.length)return B;c=h.transpose(a);h.equals(a,c).value||(a=h.add(c,a))}return A.drawconic(a,b)};A.drawconic=function(a,b){function c(ka,xa){ka=(u*ka+x*xa+y)*ka+(C*xa+F)*xa+H;return 0<=ka?1:
0>ka?-1:NaN}function d(ka){La.next=ka;ka.prev=La;return La=ka}function f(ka,xa,wb,Bb){return{a:ka,b1:xa,b2:wb,vertical:!0,index:Bb,sign:function(Ib){return c(ka,Ib)},mkp:function(Ib){return{x:ka,y:Ib}},sol:ed(C,x*ka+F,(u*ka+y)*ka+H),discr:function(){return ed(ca,-2*X,Q)},tpt:function(Ib){return{x:Ib,y:-.5*(x*Ib+F)/C}}}}function k(ka,xa,wb,Bb){return{a:ka,b1:xa,b2:wb,vertical:!1,index:Bb,sign:function(Ib){return c(Ib,ka)},mkp:function(Ib){return{x:Ib,y:ka}},sol:ed(u,x*ka+y,(C*ka+F)*ka+H),discr:function(){return ed(ca,
-2*pa,U)},tpt:function(Ib){return{x:-.5*(x*Ib+y)/u,y:Ib}}}}function m(ka){var xa=Math.min(ka.b1,ka.b2);const wb=Math.max(ka.b1,ka.b2);var Bb=ka.sign(xa);const Ib=ka.sign(wb);if(!isFinite(Bb*Ib))return!1;let nb=ka.sol,sb;if(Bb!==Ib){if(null===nb)return!1;sb=.5*(nb[0]+nb[1]);sb>xa&&sb<wb?(xa=ka.sign(sb),sb=nb[xa===Ib?0:1]):(Bb=.5*(xa+wb),sb=nb[Math.abs(Bb-nb[0])<Math.abs(Bb-nb[1])?0:1]);Ta.push(d(ka.mkp(sb)))}else{if(null===nb){if(0>=Ba)return!0;nb=ka.discr();if(null===nb)return!0;ka=ka.tpt(nb[ka.index]);
ka.x>=Pa&&ka.x<=Ka&&ka.y>=ta&&ka.y<=Xa&&d(ka);return!0}sb=.5*(nb[0]+nb[1]);if(!(sb>xa&&sb<wb))return!0;xa=ka.sign(sb);if(xa===Bb||isNaN(xa))return!0;ka.b1>ka.b2&&(nb=[nb[1],nb[0]]);Ta.push(d(ka.mkp(nb[0])));Ta.push(d(ka.mkp(nb[1])))}return!0}function p(ka,xa,wb,Bb,Ib){var nb=xa-Bb,sb=wb-ka,oc=ka*Bb-xa*wb,Vb=X*nb+pa*sb+ca*oc;if(1E-14>Math.abs(Vb))return P.lineTo(wb,Bb);const Ud=(Q*nb+T*sb+X*oc)/Vb;nb=(T*nb+U*sb+pa*oc)/Vb;if(!isFinite(Ud)||!isFinite(nb)||.04>Math.abs(ka*nb+Ud*Bb+wb*xa-wb*nb-Ud*xa-ka*
Bb))return P.lineTo(wb,Bb);do{if(10<Ib)break;oc=.5*(ka+wb);sb=.5*(xa+Bb);var vc=Ud-oc;Vb=nb-sb;if(.04>vc*vc+Vb*Vb)break;const Bf=u*vc*vc+x*vc*Vb+C*Vb*Vb,wf=2*u*vc*oc+x*(vc*sb+Vb*oc)+2*C*Vb*sb+y*vc+F*Vb,Cf=(u*oc+x*sb+y)*oc+(C*sb+F)*sb+H;let Tc=ed(Bf,wf,Cf);Tc||(Tc=[-.5*wf/Bf,-2*Cf/wf]);if(0<Tc[0])Tc=Tc[0];else if(0<=Tc[1])Tc=Tc[1];else break;vc=oc+Tc*vc;Vb=sb+Tc*Vb;oc=vc-.5*(Ud+oc);sb=Vb-.5*(nb+sb);if(!(.04>oc*oc+sb*sb)){p(ka,xa,vc,Vb,Ib+1);p(vc,Vb,wb,Bb,Ib+1);return}}while(0);P.quadraticCurveTo(Ud,
nb,wb,Bb)}L.handleModifs(b,L.conicModifs);if(0!==L.lsize&&(L.preDrawCurve(),a=h.normalizeMax(a),h._helper.isAlmostReal(a))){b=N.toMat();a=h.mult(h.transpose(b),a);a=h.mult(a,b);a=h.normalizeMax(a);var u=a.value[0].value[0].value.real,x=2*a.value[0].value[1].value.real,y=2*a.value[0].value[2].value.real,C=a.value[1].value[1].value.real,F=2*a.value[1].value[2].value.real,H=a.value[2].value[2].value.real,Q=4*H*C-F*F,T=F*y-2*H*x,X=F*x-2*C*y,U=4*H*u-y*y,pa=y*x-2*F*u,ca=4*C*u-x*x,Ba=ca;a=C*U+x*T+u*Q-H*
ca;0>a&&(u=-u,x=-x,y=-y,C=-C,F=-F,H=-H,a=-a);a=L.lsize;var Pa=-a,ta=-a,Ka=$a+a,Xa=fb+a,Ta=[],La=a={};if(m(f(Pa,ta,Xa,0))&&m(k(Xa,Pa,Ka,1))&&m(f(Ka,Xa,ta,1))&&m(k(ta,Ka,Pa,0))&&La!==a){La.next=a.next;a.next.prev=La;P.beginPath();if(0===Ta.length){var Oa=La;P.moveTo(Oa.x,Oa.y);do{var eb=Oa.next;p(Oa.x,Oa.y,eb.x,eb.y,0);Oa=eb}while(Oa!==La);P.closePath()}b=1===c(Pa,ta)?0:1;if(4===Ta.length){let ka=0;for(a=0;2>a;++a){Oa=Ta[a];eb=Ta[a+2];const xa=eb.x-Oa.x;Oa=eb.y-Oa.y;Oa=(u*xa+x*Oa)*xa+C*Oa*Oa;Math.abs(Oa)>
Math.abs(ka)&&(ka=Oa)}if(isNaN(ka))return;0<=ka&&(b=1-b)}for(a=b;a<Ta.length;a+=2)for(Oa=Ta[a],b=Ta[(a+1)%Ta.length],P.moveTo(Oa.x,Oa.y),eb=Oa.next;Oa!==b;eb=(Oa=eb).next)p(Oa.x,Oa.y,eb.x,eb.y,0);P.stroke()}}};v.drawall$1=function(a,b){a=K(a[0]);if("list"===a.ctype)for(L.handleModifs(b,L.pointAndLineModifs),b=0;b<a.value.length;b++)v.draw$1([a.value[b]],null);return B};v.connect$1=function(a,b){return A.drawpolygon(a,b,"D",!1)};v.drawpoly$1=function(a,b){return A.drawpolygon(a,b,"D",!0)};v.fillpoly$1=
function(a,b){return A.drawpolygon(a,b,"F",!0)};v.drawpolygon$1=function(a,b){return A.drawpolygon(a,b,"D",!0)};v.fillpolygon$1=function(a,b){return A.drawpolygon(a,b,"F",!0)};A.drawpolygon=function(a,b,c,d){function f(){var u=p.value;for(const y of u){for(u=0;u<y.length;u++){var x=y[u];const C=x.X*m.a-x.Y*m.b+m.tx;x=x.X*m.c-x.Y*m.d-m.ty;0===u?P.moveTo(C,x):P.lineTo(C,x)}P.closePath()}}function k(){let u;for(u=0;u<p.value.length;u++){var x=A.extractPoint(p.value[u]);if(!x.ok)return;const y=x.x*m.a-
x.y*m.b+m.tx;x=x.x*m.c-x.y*m.d-m.ty;0===u?P.moveTo(y,x):P.lineTo(y,x)}d&&P.closePath()}L.handleModifs(b,d?L.conicModifs:L.lineModifs);L.preDrawCurve();const m=N.drawingstate.matrix;var p=K(a[0]);P.beginPath();"list"===p.ctype&&k();"shape"===p.ctype&&f();"D"===c&&(L.fillColor&&(P.fillStyle=L.fillColor,P.fill(L.fillrule)),P.stroke());"F"===c&&(P.fillStyle=L.lineColor,P.fill(L.fillrule));"C"===c&&P.clip();return B};let hb=Xd,Qc=function(a,b,c){if(b.includes("\n"))for(b=b.split("\n"),a.textContent=b[0],
c=1;c<b.length;++c)a.appendChild(document.createElement("br")),a.appendChild(document.createTextNode(b[c]));else a.textContent=b};A.drawtext=function(a,b,c){var d=V(a[0]);a=K(a[1]);var f=A.extractPoint(d);if(!f.ok)return null;L.handleModifs(b,L.textModifs);b=N.drawingstate.textsize;null===b&&(b=vb.textsize);null!==L.size&&(b=L.size);P.fillStyle=L.textColor;const k=N.drawingstate.matrix;d=f.x*k.a-f.y*k.b+k.tx+L.xOffset;f=f.x*k.c-f.y*k.d-k.ty-L.yOffset;a=fa(a);Ab._pluginRegistry.katex||"string"!==typeof a||
3<=a.split("$").length&&Ya("katex","katex-plugin.js",!0);P.font=L.bold+L.italics+Math.round(10*b)/10+"px "+L.family;return c?c(a,d,f,L.align,b):hb(P,a,d,f,L.align,b,b*vb.lineHeight,L.angle)};v.drawtext$2=function(a,b){A.drawtext(a,b,null);return B};v.drawtable$2=function(a,b){var c=V(a[0]);a=V(a[1]);var d=A.extractPoint(c);if(!d.ok||"list"!==a.ctype)return B;c=a.value;a=c.length;let f=-1;var k;for(k=0;k<a;++k)"list"===c[k].ctype&&c[k].value.length>f&&(f=c[k].value.length);-1===f?(c=c.map(function(H){return[H]}),
f=1):c=c.map(function(H){return h.asList(H).value});let m=100,p=null,u=!0,x=N.drawingstate.textcolor;L.handleModifs(b,{size:!0,color:function(H){h._helper.isNumberVecN(H,3)&&(x=L.makeColor([H.value[0].value.real,H.value[1].value.real,H.value[2].value.real]))},alpha:!0,bold:!0,italics:!0,family:!0,align:!0,xoffset:!0,yoffset:!0,offset:!0,width:function(H){"number"===H.ctype&&(m=H.value.real)},height:function(H){"number"===H.ctype&&(p=H.value.real)},border:function(H){"boolean"===H.ctype&&(u=H.value)}});
k=N.drawingstate.textsize;null===k&&(k=vb.textsize);null!==L.size&&(k=L.size);null===p&&(p=1.6*k);P.font=L.bold+L.italics+Math.round(10*k)/10+"px "+L.family;k=N.drawingstate.matrix;var y=f*m;const C=a*p;b=d.x*k.a-d.y*k.b+k.tx+L.xOffset;let F=d.x*k.c-d.y*k.d-k.ty-L.yOffset-C;if(u){L.preDrawCurve();P.strokeStyle=L.lineColor;P.beginPath();for(k=1;k<a;++k)P.moveTo(b,F+k*p),P.lineTo(b+y,F+k*p);for(d=1;d<f;++d)P.moveTo(b+d*m,F),P.lineTo(b+d*m,F+C);P.stroke();P.lineWidth=L.lsize+1;P.beginPath();P.rect(b,
F,y,C);P.stroke()}b+=L.align*m+(1-2*L.align)*p*.3;F+=.7*p;P.fillStyle=x;for(k=0;k<a;++k)for(d=0;d<f;++d)y=fa(c[k][d]),hb(P,y,b+d*m,F+k*p,L.align);return B};A.drawshape=function(a,b){return"polygon"===a.type?A.drawpolygon([a],b,"D",1):"circle"===a.type?A.drawcircle([a.value.value[0],a.value.value[1]],b,"D"):B};A.fillshape=function(a,b){return"polygon"===a.type?A.drawpolygon([a],b,"F",1):"circle"===a.type?A.drawcircle([a.value.value[0],a.value.value[1]],b,"F"):B};A.clipshape=function(a,b){return"polygon"===
a.type?A.drawpolygon([a],b,"C",1):"circle"===a.type?A.drawcircle([a.value.value[0],a.value.value[1]],b,"C"):B};v.fill$1=function(a,b){a=K(a[0]);return"shape"===a.ctype?A.fillshape(a,b):B};v.clip$1=function(a,b){const c=K(a[0]);return"shape"===c.ctype?A.clipshape(c,b):"list"===c.ctype?(a=v.polygon$1(a,[]),v.clip$1([a],[])):B};v.plot$1=function(a,b){return v.plot$2([a[0],null],b)};v.plot$2=function(a,b){function c(ca){return"number"===ca.ctype&&n._helper.isAlmostReal(ca)}function d(ca,Ba,Pa,ta,Ka){p++;
Ba=+Ba.value.real;Ka=+ta.value.real;ta=Ba*T.a-Ka*T.b+T.tx;Ba=Ba*T.c-Ka*T.d-T.ty;ca=+ca.value.real;Ka=+Pa.value.real;Pa=ca*T.a-Ka*T.b+T.tx;ca=ca*T.c-Ka*T.d-T.ty;u?(P.lineTo(Pa,ca),P.lineTo(ta,Ba)):(P.beginPath(),P.moveTo(Pa,ca),P.lineTo(ta,Ba),u=!0)}function f(ca,Ba,Pa,ta,Ka){var Xa=c(Pa),Ta=c(ta);if(.001>Ka)!k&&u&&(P.stroke(),u=!1);else if(Xa||Ta){var La=n.real((ca.value.real+Ba.value.real)/2);M.setvar(Q,La);var Oa=K(H),eb=c(Oa);if(Xa&&Ta&&eb){var ka=Pa.value.real;Ta=Oa.value.real;eb=ta.value.real;
if(Xa=1>Math.abs(ka+eb-2*Ta)/m){var xa=n.real((ca.value.real+La.value.real)/2);M.setvar(Q,xa);xa=K(H);var wb=n.real((La.value.real+Ba.value.real)/2);M.setvar(Q,wb);wb=K(H);ka=Math.abs(ka+Ta-2*xa.value.real)/m;Ta=Math.abs(Ta+eb-2*wb.value.real)/m;Xa=Xa&&1>ka&&1>Ta}Xa?(d(ca,La,Pa,Oa,Ka/2),d(La,Ba,Oa,ta,Ka/2)):(f(ca,La,Pa,Oa,Ka/2),f(La,Ba,Oa,ta,Ka/2))}else f(ca,La,Pa,Oa,Ka/2),f(La,Ba,Oa,ta,Ka/2)}}let k=!1;const m=.2/Jd;let p=0,u=!1,x=-10,y=10,C=.1,F=1E3;const H=a[0];let Q;null!==a[1]&&"variable"===a[1].ctype?
Q=a[1].name:(a=A.plotvars(H),Q="#",a.includes("t")&&(Q="t"),a.includes("z")&&(Q="z"),a.includes("y")&&(Q="y"),a.includes("x")&&(Q="x"));M.newvar(Q);const T=N.drawingstate.matrix;L.handleModifs(b,{color:!0,alpha:!0,size:!0,dashpattern:!0,dashtype:!0,dashing:!0,lineCap:!0,lineJoin:!0,miterLimit:!0,connect:function(ca){"boolean"===ca.ctype&&(k=ca.value)},start:function(ca){"number"===ca.ctype&&(x=ca.value.real)},stop:function(ca){"number"===ca.ctype&&(y=ca.value.real)},steps:function(ca){"number"===
ca.ctype&&(F=ca.value.real)}});P.strokeStyle=L.lineColor;P.lineWidth=L.lsize;let X;u=!1;b=n.real(14.32);M.setvar(Q,b);X=K(H);if("number"!==X.ctype){if(h.isNumberVector(X).value&&2===X.value.length){u=!1;C=(y-x)/F;for(b=x;b<y;b+=C){M.setvar(Q,n.real(b));var U=K(H);if(h.isNumberVector(U).value&&2===U.value.length){var pa=+U.value[0].value.real;U=+U.value[1].value.real;a=pa*T.a-U*T.b+T.tx;pa=pa*T.c-U*T.d-T.ty;u?P.lineTo(a,pa):(P.beginPath(),P.moveTo(a,pa),u=!0)}}P.stroke();M.removevar(Q)}return B}for(a=
x;a<y+C;a+=C)b=n.real(a),M.setvar(Q,b),X=K(H),b.value.real>x&&f(pa,b,U,X,C),pa=b,U=X;M.removevar(Q);u&&P.stroke();return B};v.plotX$1=function(a,b){a=a[0];var c=A.plotvars(a);b="#";c.includes("t")&&(b="t");c.includes("z")&&(b="z");c.includes("y")&&(b="y");c.includes("x")&&(b="x");M.newvar(b);c=N.drawingstate.matrix;P.fillStyle=N.drawingstate.linecolor;P.lineWidth=1;P.lineCap=L.lineCap;P.lineJoin=L.lineJoin;P.miterLimit=L.miterLimit;let d=!1;for(let m=-10;10>m;m+=.01){M.setvar(b,n.real(m));var f=K(a);
if("number"===f.ctype){var k=+f.value.real;f=m*c.a-k*c.b+c.tx;k=m*c.c-k*c.d-c.ty;d?P.lineTo(f,k):(P.beginPath(),P.moveTo(f,k),d=!0)}}P.stroke();M.removevar(b);return B};A.plotvars=function(a){function b(p,u){const x={};let y;for(y=p.length-1;0<=y;--y)x[p[y]]=p[y];for(y=u.length-1;0<=y;--y)x[u[y]]=u[y];p=[];for(const C in x)x.hasOwnProperty(C)&&p.push(x[C]);return p}function c(p,u){for(let x=0;x<p.length;x++)p[x]===u&&(p.splice(x,1),x--);return p}let d,f,k,m;if("variable"===a.ctype)return[a.name];
if("infix"===a.ctype)return d=A.plotvars(a.args[0]),a=A.plotvars(a.args[1]),b(d,a);if("list"===a.ctype){k=a.value;f=[];for(m=0;m<k.length;m++)d=A.plotvars(k[m]),f=b(f,d);return f}if("function"===a.ctype){k=a.args;f=[];for(m=0;m<k.length;m++)d=A.plotvars(k[m]),f=b(f,d);"apply"!==a.oper&&"select"!==a.oper&&"forall"!==a.oper&&"sum"!==a.oper&&"product"!==a.oper&&"repeat"!==a.oper&&"min"!==a.oper&&"max"!==a.oper&&"sort"!==a.oper||"variable"!==a.args[1].ctype||(f=c(f,a.args[1].name));return f}return[]};
v.clrscr$0=function(a,b){"undefined"!==typeof $a&&"undefined"!==typeof fb&&P.clearRect(0,0,$a,fb);return B};v.repaint$0=function(a,b){l();return B};v.screenbounds$0=function(a,b){a=G.withUsage(h.realVector(N.to(0,0)),"Point");b=G.withUsage(h.realVector(N.to(jb.clientWidth,0)),"Point");const c=G.withUsage(h.realVector(N.to(jb.clientWidth,jb.clientHeight)),"Point"),d=G.withUsage(h.realVector(N.to(0,jb.clientHeight)),"Point");return h.turnIntoCSList([a,b,c,d])};v.createimage$3=function(a,b){b=K(a[0]);
const c=V(a[1]);a=V(a[2]);if("number"!==c.ctype||"number"!==a.ctype||"string"!==b.ctype)return B;const d=document.createElement("canvas");d.id=b.value;d.width=c.value.real;d.height=a.value.real;d.style.display="none";document.body.appendChild(d);Bc[b.value]=za(d,!1);return B};v.clearimage$1=function(a,b){a=K(a[0]);if("string"!==a.ctype&&"image"!==a.ctype)return B;a=Wb(a);if(!a)return B;b=a.img;if("undefined"===typeof b||null===b)return B;const c=a.width,d=a.height;b.getContext("2d").clearRect(0,0,
c,d);a.generation++;return B};v.canvas$4=function(a,b){var c=V(a[0]),d=V(a[1]);b=K(a[2]);a=a[3];var f=A.extractPoint(c),k=A.extractPoint(d);if(!f.ok||!k.ok||"string"!==b.ctype&&"image"!==b.ctype)return B;b=Wb(b);if(!b||!b.img.getContext)return B;d=b.img;var m=b.width;c=b.height;var p=k.x-f.x,u=k.y-f.y,x=f.x-u*c/m,y=f.y+p*c/m;u=k.x-u*c/m;p=k.y+p*c/m;k=N.from(f.x,f.y,1);x=N.from(x,y,1);u=N.from(u,p,1);f=k[0]*rb;y=k[1]*rb;p=x[0]*rb;const C=x[1]*rb,F=u[0]*rb,H=u[1]*rb;x=m*(y-C)/((f-p)*(y-H)-(f-F)*(y-
C));m=m*(f-p)/((y-C)*(f-F)-(y-H)*(f-p));u=-x*f-m*y;k=(c*(y-H)-c*(y-C))/((f-p)*(y-H)-(f-F)*(y-C));p=(c*(f-F)-c*(f-p))/((y-C)*(f-F)-(y-H)*(f-p));c=c-k*f-p*y;d=d.getContext("2d");f=P;P=d;P.save();P.transform(x,k,m,p,u,c);b.generation++;K(a);P.restore();P=f};v.canvas$5=function(a,b){var c=V(a[0]),d=V(a[1]),f=V(a[2]);b=K(a[3]);a=a[4];c=A.extractPoint(c);var k=A.extractPoint(d),m=A.extractPoint(f);if(!c.ok||!k.ok||!m.ok||"string"!==b.ctype&&"image"!==b.ctype)return B;b=Wb(b);if(!b||!b.img.getContext)return B;
f=b.img;var p=b.width;d=b.height;var u=N.from(c.x,c.y,1),x=N.from(k.x,k.y,1);k=N.from(m.x,m.y,1);c=u[0]*rb;m=u[1]*rb;var y=x[0]*rb;const C=x[1]*rb,F=k[0]*rb,H=k[1]*rb;k=((0-p)*(m-H)-0*(m-C))/((c-y)*(m-H)-(c-F)*(m-C));p=((0-p)*(c-F)-0*(c-y))/((m-C)*(c-F)-(m-H)*(c-y));x=-(k*c)-p*m;u=((d-d)*(m-H)-(d-0)*(m-C))/((c-y)*(m-H)-(c-F)*(m-C));y=((d-d)*(c-F)-(d-0)*(c-y))/((m-C)*(c-F)-(m-H)*(c-y));d=d-u*c-y*m;f=f.getContext("2d");c=P;P=f;P.save();P.transform(k,u,p,y,x,d);b.generation++;K(a);P.restore();P=c};v.screenresolution$0=
function(a,b){return n.real(N.drawingstate.matrix.a)};v.layer$1=function(a,b){};v.imagesize$1=function(a,b){a=Wb(V(a[0]));b=function(c){return"number"===typeof c&&Number.isFinite(c)};return void 0!=a&&b(a.width)&&b(a.height)?h.realVector([+a.width,+a.height]):B};v.imageready$1=function(a,b){a=Wb(V(a[0]));return G.bool(!(!a||!a.ready))};v.drawimage$2=function(a,b){function c(){var u=1,x=1,y=1,C=1,F=0,H=1,Q=A.extractPoint(f);if(!Q.ok)return B;k=Wb(k);if(!k)return B;P.save();if(void 0!==b.angle){var T=
K(b.angle);"number"===T.ctype&&(F=T.value.real)}void 0!==b.rotation&&(T=K(b.rotation),"number"===T.ctype&&(F=T.value.real));void 0!==b.scale&&(T=V(b.scale),"number"===T.ctype&&(x=u=T.value.real),h.isNumberVector(T).value&&2===T.value.length&&(u=T.value[0].value.real,x=T.value[1].value.real));void 0!==b.scalex&&(T=K(b.scalex),"number"===T.ctype&&(u=T.value.real));void 0!==b.scaley&&(T=K(b.scaley),"number"===T.ctype&&(x=T.value.real));void 0!==b.flipx&&(T=K(b.flipx),"boolean"===T.ctype&&T.value&&(y=
-1));void 0!==b.flipy&&(T=K(b.flipy),"boolean"===T.ctype&&T.value&&(C=-1));void 0!==b.alpha&&(T=K(b.alpha),"number"===T.ctype&&(H=T.value.real));P.imageSmoothingEnabled=!0;void 0!==b.interpolate&&(T=K(b.interpolate),"boolean"===T.ctype&&(P.imageSmoothingEnabled=T.value));var X=N.drawingstate.matrix,U=N.drawingstate.initialmatrix;const pa=k.width,ca=k.height;T=Q.x*X.a-Q.y*X.b+X.tx;const Ba=Q.x*X.c-Q.y*X.d-X.ty;var Pa=(Q.x+1)*X.a-Q.y*X.b+X.tx-T;X=(Q.x+1)*X.c-Q.y*X.d-X.ty-Ba;const ta=(Q.x+1)*U.a-Q.y*
U.b+U.tx-(Q.x*U.a-Q.y*U.b+U.tx);U=(Q.x+1)*U.c-Q.y*U.d-U.ty-(Q.x*U.c-Q.y*U.d-U.ty);Q=Math.sqrt(Pa*Pa+X*X)/Math.sqrt(ta*ta+U*U);Pa=-Math.atan2(Pa,X)+Math.atan2(ta,U);X=N.drawingstate.matrix.sdet/72;u*=X;x*=X;1!==H&&(P.globalAlpha=H);P.translate(T,Ba);P.scale(u*y*Q,x*C*Q);P.rotate(F+Pa);P.translate(-T,-Ba);P.translate(-pa/2,-ca/2);u=k;u.drawTo?u.drawTo(P,T,Ba):P.drawImage(u.img,T,Ba);P.globalAlpha=1;P.restore()}function d(){var u=1,x=1;let y=1,C=1;var F=A.extractPoint(f);const H=A.extractPoint(m);let Q;
if(!F.ok||!H.ok)return B;k=Wb(k);if(!k)return B;const T=k.width,X=k.height;if(0===p)Q={},Q.x=F.x-(H.y-F.y),Q.y=F.y+(H.x-F.x),C=X/T;else if(Q=A.extractPoint(p),!F.ok)return B;P.save();if(void 0!==b.alpha){var U=K(b.alpha);"number"===U.ctype&&(u=U.value.real)}void 0!==b.aspect&&(U=K(b.aspect),"number"===U.ctype&&(C=U.value.real));void 0!==b.flipx&&(U=K(b.flipx),"boolean"===U.ctype&&U.value&&(x=-1));void 0!==b.flipy&&(U=K(b.flipy),"boolean"===U.ctype&&U.value&&(y=-1));P.imageSmoothingEnabled=!0;void 0!==
b.interpolate&&(U=K(b.interpolate),"boolean"===U.ctype&&(P.imageSmoothingEnabled=U.value));U=N.drawingstate.matrix;1!==u&&(P.globalAlpha=u);u=F.x*U.a-F.y*U.b+U.tx;F=F.x*U.c-F.y*U.d-U.ty;P.transform(H.x*U.a-H.y*U.b+U.tx-u,H.x*U.c-H.y*U.d-U.ty-F,Q.x*U.a-Q.y*U.b+U.tx-u,Q.x*U.c-Q.y*U.d-U.ty-F,u,F);P.scale(1/T,-1/X*C);P.translate(T/2,-X/2);P.scale(x,y);P.translate(-T/2,X/2);P.translate(0,-X);x=k;x.drawTo?x.drawTo(P,0,0):P.drawImage(x.img,0,0);P.globalAlpha=1;P.restore()}if(2===a.length){var f=V(a[0]);
var k=V(a[1]);return c()}if(3===a.length){f=V(a[0]);var m=V(a[1]);var p=0;k=V(a[2]);return d()}return 4===a.length?(f=V(a[0]),m=V(a[1]),p=V(a[2]),k=V(a[3]),d()):B};v.drawimage$3=v.drawimage$2;v.drawimage$4=v.drawimage$2;v.allimages$0=function(){const a=[];Object.keys(Bc).forEach(function(b){a.push({ctype:"string",value:b})});return h.turnIntoCSList(a)};const Gb={};v.cameravideo$0=function(a,b){function c(m){return{video:{width:m,advanced:[{width:{max:m,min:m}},{width:{ideal:m}}]},audio:!1}}a=!0;let d=
{};void 0!==b.resolution&&(b=K(b.resolution),"string"===b.ctype&&"maximal"===b.value?a=!0:"number"===b.ctype?(a=!1,d=c(b.value.real)):h._helper.isNumberVecN(b,2)&&(a=!1,d=c(b.value[0].value.real),b=b.value[1].value.real,10>b||!Number.isInteger(b)?(d.video.aspectRatio=b,d.video.advanced[0].aspectRatio={min:b,max:b},d.video.advanced[1].aspectRatio={ideal:b}):(d.video.height=b,d.video.advanced[0].height={min:b,max:b},d.video.advanced[1].height={ideal:b})));a&&(d=[320,640,1024,1280,1920,2560],d=d.map(function(m){return{width:{min:m}}}),
d={video:{width:16E3,height:9E3,advanced:d},audio:!1});a=JSON.stringify(d);if(Gb[a])return Gb[a];b=null;let f=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia;f?b=function(m,p){navigator.mediaDevices.getUserMedia(d).then(m,p)}:(f=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)&&(b=function(m,p){f.call(navigator,d,m,p)});if(!b)return console.warn("getUserMedia call not supported"),Gb[a]=B;const k=document.createElement("video");
k.autoplay=!0;Gb[a]=za(k,!0);console.log("Opening stream.");b(function(m){k.srcObject=m;k.setAttribute("autoplay","");k.setAttribute("muted","");k.setAttribute("playsinline","");k.play();k.addEventListener("loadeddata",S)},function(m){console.error("Could not get user video:",String(m),m)});return Gb[a]};v.playvideo$1=function(a,b){a=Wb(V(a[0]));a.live&&a.img.play&&a.img.play();return B};v.pausevideo$1=function(a,b){a=Wb(V(a[0]));a.live&&a.img.pause&&a.img.pause();return B};let zc;v.imagergba$3=function(a,
b){b=Wb(V(a[0]));let c=V(a[1]);a=V(a[2]);if(!b||"number"!==c.ctype||"number"!==a.ctype||!b.ready)return B;c=Math.round(c.value.real);a=Math.round(a.value.real);if(!Ub(c)||!Ub(a))return B;a=Jc(b,c,a,1,1);return h.realVector([255*a[0],255*a[1],255*a[2],a[3]])};v.imagergb$3=v.imagergba$3;v.imagergba$4=function(a,b){var c=Wb(V(a[2]));if(!c||!c.ready)return B;var d=c.width,f=c.height,k=sa(a[0]),m=sa(a[1]),p=sa(h.realVector([0,f,1]));d=sa(h.realVector([d,f,1]));if(k===B||m===B||u===B)return B;u=h.ii;f=
h.jj;p=A.basismap(p,d,u,f);k=A.basismap(k,m,f,u);var u=sa(a[3]);f=A.extractPoint(G.mult(p,G.mult(h.adjoint3(k),u)));if(f.ok)if(a=c.width,k=c.height,m=!0,p=!1,void 0!==b.interpolate&&(u=K(b.interpolate),"boolean"===u.ctype&&(m=u.value)),void 0!==b.repeat&&(u=K(b.repeat),"boolean"===u.ctype&&(p=u.value)),m&&(f.x-=.5,f.y-=.5),p&&(f.x=(f.x%a+a)%a,f.y=(f.y%k+k)%k),u=Math.floor(f.x),d=Math.floor(f.y),Ub(u)&&Ub(d)){b=[0,0,0,0];if(m){m=f.x-u;f=f.y-d;let x=Jc(c,u,d,2,2);if(p){if(u===a-1||d===k-1){p=Jc(c,(u+
1)%a,d,1,1);const y=Jc(c,u,(d+1)%k,1,1);c=Jc(c,(u+1)%a,(d+1)%k,1,1);x=x.slice(0,4).concat(p,y,c)}}else{if(-1===u||u===a-1)m=Math.round(m);if(-1===d||d===k-1)f=Math.round(f)}for(c=0;4>c;c++)b[c]=(1-f)*((1-m)*x[c]+m*x[c+4])+f*((1-m)*x[c+8]+m*x[c+12])}else b=Jc(c,u,d,1,1);c=h.realVector(b)}else c=B;else c=B;return c};v.imagergb$4=function(a,b){a=v.imagergba$4(a,b);return a===B?B:h.turnIntoCSList(a.value.slice(0,3))};v.readpixels$1=function(a,b){a=Wb(V(a[0]));a=Jc(a,0,0,a.width,a.height);b=[];for(let c=
0;c+3<a.length;c+=4)b.push(h.turnIntoCSList([n.real(a[c+0]),n.real(a[c+1]),n.real(a[c+2]),n.real(a[c+3])]));return h.turnIntoCSList(b)};"use strict";const ne=[{key:[":"],field:["."],deg:["\u00b0"],take:["_"]},{functionCall:!0},{rassoc:!0,pow:["^"],sqrt:["\u221a"]},{mul:["*","\u2062","\u22c5","\u00b7"],cross:["\u00d7"],div:["/","\u00f7","\u2215","\u2236"]},{add:["+"],sub:["-","\u2212"],neg:["!","\u00ac"]},{seq:[".."]},{eq:["==","\u225f"],ne:["!=","<>","\u2260"],lt:["<"],gt:[">"],le:["<=","\u2264",
"\u2266"],ge:[">=","\u2265","\u2267"],aeq:["~=","\u2248"],ane:["~!=","\u2249"],alt:["~<","\u2a89"],agt:["~>","\u2a8a"],ale:["~<=","\u2a85"],age:["~>=","\u2a86"],in:["\u2208"],nin:["\u2209"]},{and:["&","\u2227"],or:["%","\u2228"]},{rassoc:!0,prepend:["<:"]},{concat:["++","\u222a"],remove:["--","\u2216"],common:["~~","\u2229"],append:[":>"]},{rassoc:!0,assign:["="],define:[":="],undefine:[":=_"],bdefine:["::="]},{seq:[";"]},{modif:["->","\u2192"]},{rassoc:!0,list:[","]}],mf=["+","-"],lf=["!","\u221a"],
ja=["\u00b0",":=_"],qa=[";",","],ma=[],Ca={};let Za;(function(){let a=0;ne.forEach(function(b){a+=2;const c=!!b.rassoc;b.functionCall&&(Za=a);for(const d in b){const f=b[d];if("boolean"===typeof f)continue;const k={name:d,sym:f[0],symbols:f,rassoc:c,precedence:a,prefix:!1,postfix:!1,infix:!0,bare:!1};for(const m of f){if(Ca.hasOwnProperty(m))throw Error("Duplicate operator: "+m);Ca[m]=k;ma.push(m)}}});mf.forEach(function(b){Ca[b].prefix=!0});lf.forEach(function(b){Ca[b].prefix=!0;Ca[b].infix=!1});
ja.forEach(function(b){Ca[b].postfix=!0;Ca[b].infix=!1});qa.forEach(function(b){Ca[b].prefix=!0;Ca[b].postfix=!0;Ca[b].infix=!0;Ca[b].bare=!0})})();ma.sort(function(a,b){return b.length-a.length});const wa="(?:[\u207a\u207b] )?[\u2070\u00b9\u00b2\u00b3\u2074\u2075\u2076\u2077\u2078\u2079](?: [\u2070\u00b9\u00b2\u00b3\u2074\u2075\u2076\u2077\u2078\u2079])*".replace(/ /g,"[ \t]*"),bc="(?:[\u208a\u208b] )?[\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089](?: [\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089])*".replace(/ /g,
"[ \t]*"),rc=function(a,b,c){let d;let f=0,k="(?:[";const m=b.length;for(d=0;d<m;++d){var p=b.charCodeAt(d);55296<=p?(k+="]|"+b.charAt(d)+"[",f=56320):(k+=String.fromCharCode(p=f=a[p-32]+f),f+=a[b.charCodeAt(++d)-32],f!==p&&(f!==p+1&&(k+="-"),k+=String.fromCharCode(f)))}return k+"]|["+c+"][\udc00-\udfff])"}([2,0,106,3,4,1,6,5,7,11,17,8,12,21,9,22,30,10,15,24,25,16,13,42,46,14,18,19,29,37,27,28,35,26,32,36,40,43,47,53,20,48,50,56,33,34,39,51,52,55,63,64,65,68,85,23,31,38,45,49,105,59,66,69,72,88,102,
114,117,128,157,191,41,44,54,60,67,70,71,73,74,75,76,80,81,82,83,84,86,87,89,93,94,98,99,107,108,116,122,130,132,134,138,160,165,185,195,196,255,268,277,310,332,339,362,365,390,449,457,470,512,513,541,568,582,619,673,726,768,820,921,991,1164,2684,6581,8453,11171,20949],"T4(4I!)!'!&/ 0 \u0096')2$+! !\u0083$ %## !(!   ! ; u \u0086.\u0088 =#!+YoA& 87C% } !5%+%) #!*! <0a,!4B1%'!&-'!1!$!33`HsG$!;!+.52'(#%#- & !$#$!*!9%  2%H''%#- & % % %B# !H *+   - & % $$!;!5%3!,(#%#- & % $$!X%  5!:! '$  #$% ! %$%$ $)W!G(   / 2$!> &%C(   / . $$!L! %5%;(   D#!*!* 4'&*$W + !#&]F %6&]% !#% !#!(# &   ! !#% # %1!#$ !/#L!S( @?$\u00817-!*''#$!$%+ ',6!:= !&!#7 \u0090 ##& ! ##D ##B ##& ! ##9 K ##^Y2*V#'$\u009d#5 4&p((+, #2*2*2,  5OC!'!Uy.D !&_)0J<#$,E'4Q/1Pv!|8:&K<9%)E>@7 )@\u0080# #$%1gT\u008e#'#=#'#( ! ! ! 0#P & !$  &$##'',&  &d!9!*,b!'!#. !$$(! ! ! # 1##&$'!G%\u00a58 8 \u0084(#$%6= !&!#Q+!*/1& & & & & & & &t!\u0097%E$&%'V(  z #&D${:Aj2\u0099\u00a6q\u00a9E\u00a4UZ#\u008d$2)%-8*0#_J+#b#M#(S1   # /0O2[R'$! !6>)/A?+8<!*$ .)$ D3  (-/$!$[ !$%#$#! !4 #1+ 6'#'#'1& & 7 .)c0\u00a86/'I\u00a7\u0093#\\N&6$&! . , $ ! % % \u007fM\u0092;R#Gh)d$ \u0085=4(4,a$'#'#'# \ud800!) 4 : % 9#6@\u0082\u0094?$IIX*5 ((=)<#@'(\ud801!f~N.Of\u008f1-)(\ud802!'#! E %$!#/)/10^: %)-)4nQ(%T!5#   AZ?$?C( >?G)-):9*\ud803!`KJ9J\ud804#PriL3>@7M$!6F2#/! !C* 3V& ! # 9 .+8N(#%#- & % $$!;!6$\ud805eF-% !\u008987#=F-!k7x4\ud806\u0087RB!\u0095K\ud808!\u00a2\ud809e\u008a\ud80d!8\ud811!\u009c\ud81a!\u009b+0c<;F*#BH&:\ud81b\u00a0U,!l,\ud82c!%\ud82f!\"&,$++.\ud835!w m %#!#%## ) ! & S ##( & > # $ !$& \u0091#3 3 0 3 0 3 0 3 0 3 (\ud83a!\u008b\ud83b\u0098# A % !#! . # ! !(!'! ! !   % !#! ! ! ! ! % !## & # # ! . 5&  $ 5\ud869!\u009f7\u008c\ud86d!\u00a1,g\ud86e!<#\u00a3\ud873!\u009e\ud87e!\u009a",
"\ud80c\ud840-\ud868\ud86a-\ud86c\ud86f-\ud872"),Yc=("#(?: [1-9])?|(?:'|"+rc+")(?: (?:[0-9']|"+rc+"))*").replace(/ /g,"[ \t]*"),kd=["([ \t\n\r]+)|(//.*)|(/\\*)","("+("(?:[0-9](?: [0-9])*(?: \\.(?! \\.)(?:(?! "+Yc+")|(?= (?: [Ee](?: [+-])?(?: [0-9])+)))(?: [0-9])*)?|\\.(?: [0-9])+)(?: [Ee](?: [+-])?(?: [0-9])+)?").replace(/ /g,"[ \t]*")+")","("+ma.map(Yd).join("|")+")","("+"[](){}||".split("").map(Yd).join("|")+")","("+bc+")","("+wa+")","("+Yc+")",'("[^"]*")|($)'].join("|"),Xe=new RegExp("[ \t]*".replace(/\*$/,
"+"),"g"),oe="ANY WS COMMENT START_COMMENT NUM OP BRA SUB SUP ID STR EOF".split(" ");(function(){const a=(new RegExp(kd,"g")).exec("");if(a.hasOwnProperty(oe.length))throw Error("RE has more groups than expected");if(!a.hasOwnProperty(oe.length-1))throw Error("RE has fewer groups than expected");})();Kc.prototype.advanceBy=function(a){this.advanceTo(this.pos+a)};Kc.prototype.advanceTo=function(a){for(this.pos=a;this.bols[0]<=a;)this.bol=this.bols.shift(),this.line++};Kc.prototype.curPos=function(){return{row:this.line,
col:this.pos-this.bol,pos:this.pos}};Kc.prototype.nextInternal=function(){const a=this.re.exec(this.input);if(a.index!==this.pos)throw ub("Invalid token",this.curPos(),this.input.substring(this.pos,a.index));const b=this.curPos();this.advanceBy(a[0].length);const c=this.curPos();let d;for(d=1;null==a[d];++d);return{start:b,end:c,raw:a[0],text:a[0].replace(Xe,""),toktype:oe[d]}};Kc.prototype.next=function(){let a;do if(a=this.nextInternal(),"START_COMMENT"===a.toktype){const b=/\*\/|\/\*/g;b.lastIndex=
a.start.pos+2;let c=1,d;for(;0<c;)if(d=b.exec(this.input))"/*"===d[0]?++c:--c;else throw ub("Unterminated comment",a.start,a.text);this.re.lastIndex=b.lastIndex;this.advanceTo(b.lastIndex);a.end=this.curPos();a.raw=this.input.substring(a.start.pos,a.end.pos);a.text=a.raw;a.toktype="COMMENT"}while("WS"===a.toktype||"COMMENT"===a.toktype);return a};const nf={ctype:"void"};fd.prototype.postprocess=function(a){if(null===a)return nf;if(a){if("infix"===a.ctype)if(":="===a.oper){const b=a.args[0];"function"===
b.ctype&&b.args.forEach(function(c){if(null===c||"variable"!==c.ctype)throw ub("Function argument must be an identifier",c.start||a.start);})}else if(","===a.oper)throw ub("comma may only be used to delimit list elements",a.start);a.args&&(a.args=a.args.map(this.postprocess,this));if(a.modifs)for(const b in a.modifs)a.modifs[b]=this.postprocess(a.modifs[b]);if("paren"===a.ctype)return a.args[0];if("infix"===a.ctype){if("."===a.oper){if(!a.args[1]||"variable"!==a.args[1].ctype)throw ub("Field name must be identifier",
a.start,a.text);a.ctype="field";a.obj=a.args[0];a.key=a.args[1].name;delete a.args}if(":"===a.oper){if(a.jsonatom){if(!a.args[1])throw ub("JSON: Value undefined",a.start,a.text);a.ctype="jsonatom";a.key=a.args[0];a.value=a.args[1];delete a.jsonatom}else{if(!a.args[1])throw ub("UserData: Key undefined",a.start,a.text);a.ctype="userdata";a.obj=a.args[0];a.key=a.args[1]}delete a.args}this.infixmap&&(a.impl=this.infixmap[a.oper])}else"variable"===a.ctype?this.usedVariables[a.name]=!0:"function"===a.ctype&&
(this.usedFunctions[a.oper]=!0)}if("infix"===a.ctype)return{ctype:"infix",oper:String(a.oper),args:[a.args[0],a.args[1]],impl:a.impl};if("variable"===a.ctype)return{ctype:"variable",name:String(a.name)};if("number"===a.ctype)return{ctype:"number",value:{real:+a.value.real,imag:+a.value.imag}};if("string"===a.ctype)return{ctype:"string",value:String(a.value)};if("list"===a.ctype)return{ctype:"list",value:a.value};if("function"===a.ctype)return{ctype:"function",oper:String(a.oper),args:a.args,modifs:a.modifs};
if("field"===a.ctype)return{ctype:"field",obj:a.obj,key:String(a.key)};if("userdata"===a.ctype)return{ctype:"userdata",obj:a.obj,key:a.key};if("jsonatom"===a.ctype)return{ctype:"jsonatom",key:a.key,value:a.value};throw Error("Unsupported AST node of type "+a.ctype);};fd.prototype.parse=function(a){try{const b=$d(new Kc(a));if("EOF"!==b.closedBy.toktype)throw ub("Closing bracket never opened.",b.closedBy.start,b.closedBy.text);return this.postprocess(b.expr)}catch(b){return b.ctype="error",b}};"undefined"!==
typeof process&&"undefined"!==typeof module&&"undefined"!==typeof module.exports&&"undefined"===typeof window&&(module.exports.Parser=fd,module.exports.Tokenizer=Kc,module.exports.unicodeLetters=rc,module.exports.parse=function(a){return(new fd).parse(a)});const Ac={};var sd=[];const na={lines:{},audioCtx:null,getAudioContext:function(){if(this.audioCtx)return this.audioCtx;window.AudioContext||window.webkitAudioContext?this.audioCtx=new (window.AudioContext||window.webkitAudioContext):console.warn("Web Audio API not supported in this browser");
return this.audioCtx},handleModif:function(a,b,c){if(void 0!==a){if(a=K(a),a.ctype===b){if("number"===a.ctype)return a.value.real;if("list"===a.ctype){b=a.value;a=[];for(c=0;c<b.length;c++)a[c]=b[c].value.real;return a}return a.value}}else return c},handleLineModif:function(a,b){return void 0!==a?(a=K(a),fa(a)):b},getBufferNode:function(a,b){var c=this.getAudioContext();if(b*c.sampleRate>a.length){let d=[];for(let f=0,k=0;f<c.sampleRate*b;f++,k++)k>a.length&&(k=0),d[f]=a[k];a=d}b=new Float32Array(a);
a=c.createBuffer(1,b.length,c.sampleRate);a.copyToChannel(b,0);c=c.createBufferSource();c.buffer=a;return c},createMonoOscillator:function(a,b){let c=this.getAudioContext().createOscillator();if(0!==b){let d=new Float32Array(2),f=new Float32Array(2);d[1]=Math.sin(b);f[1]=Math.cos(b);b=this.getAudioContext().createPeriodicWave(d,f,{disableNormalization:!0});c.setPeriodicWave(b)}else c.type="sine";c.mono=!0;c.frequency.setValueAtTime(a,this.audioCtx.currentTime);return c},createWaveOscillator:function(a,
b,c){let d=this.getAudioContext().createOscillator(),f=new Float32Array(b.length+1),k=new Float32Array(b.length+1);for(let m=0;m<b.length;m++)k[m+1]=b[m]*Math.cos(c[m]),f[m+1]=b[m]*Math.sin(c[m]);b=this.getAudioContext().createPeriodicWave(f,k,{disableNormalization:!0});d.setPeriodicWave(b);d.frequency.setValueAtTime(a,this.audioCtx.currentTime);return d},cleanup:function(){for(let a in this.lines)if("sin"===this.lines[a].lineType)if(this.lines[a].oscNodes.every(b=>!b.oscNode.isplaying))delete this.lines[a];
else for(let b=0;b<this.lines[a].oscNodes.length;b++)this.lines[a].oscNodes[b]&&!this.lines[a].oscNodes[b].oscNode.isplaying&&delete this.lines[a].oscNodes[b]},registerInput:function(a){a.cnt?a.cnt++:a.cnt=1},deregisterInput:function(a){a.cnt&&a.cnt--},hasRegisteredInput:function(a){return a.cnt&&0!==a.cnt},playOscillator:function(a,b,c,d,f,k){let m=this.getAudioContext(),p=m.createGain();p.gain.setValueAtTime(0,m.currentTime);a.connect(p);p.connect(b);na.registerInput(b);a.start(0);a.isplaying=!0;
a.onended=function(){this.isplaying=!1;p.disconnect();na.deregisterInput(b);na.hasRegisteredInput(b)||(b.disconnect(),b.panNode&&b.panNode.disconnect());na.cleanup()};p.gain.linearRampToValueAtTime(c,m.currentTime+d);0<=f&&(p.gain.setValueAtTime(c,m.currentTime+d+f),p.gain.linearRampToValueAtTime(0,m.currentTime+d+f+k),this.triggerStop(a,f+d+k));return{oscNode:a,gainNode:p}},softStop:function(a,b){let c=this.getAudioContext();a.gainNode.gain.cancelScheduledValues(c.currentTime);a.gainNode.gain.setValueAtTime(a.gainNode.gain.value,
c.currentTime);a.gainNode.gain.linearRampToValueAtTime(0,c.currentTime+b);this.triggerStop(a.oscNode,b)},extendDuration:function(a,b,c){let d=this.getAudioContext();a.gainNode.gain.cancelScheduledValues(d.currentTime);a.gainNode.gain.setValueAtTime(a.gainNode.gain.value,d.currentTime);a.gainNode.gain.setValueAtTime(a.gainNode.gain.value,d.currentTime+b);a.gainNode.gain.linearRampToValueAtTime(0,d.currentTime+b+c);this.triggerStop(a.oscNode,b+c)},triggerStop:function(a,b){a.timeoutId&&clearTimeout(a.timeoutId);
a.timeoutId=setTimeout(function(){a.stop(0)},1E3*b+10)}};class Ff{constructor(a){this.audioCtx=a;this.lineType="sin";this.oscNodes=[]}handleModif(a,b,c,d){if("phaseshift"===b)d=this.handlePhaseshiftModif(a.phaseshift,this.harmonics.length);else if(void 0!==a[b]&&(a=K(a[b]),a.ctype===c))if("number"===a.ctype)d=a.value.real;else if("list"===a.ctype){c=a.value;a=[];for(d=0;d<c.length;d++)a[d]=c[d].value.real;d=a}else d=a.value;return this[b]=d}handlePhaseshiftModif(a,b){this.phaseshift=Array(b).fill(0);
if(void 0!==a)if(a=K(a),"list"===a.ctype)for(b=a.value,a=0;a<b.length;a++)this.phaseshift[a]=b[a].value.real;else if("number"===a.ctype)for(let c=0;c<b;c++)this.phaseshift[c]=(c+1)*a.value.real;return this.phaseshift}cleanparameters(a){this.partials.length<this.harmonics.length&&(this.partials=Array(this.harmonics.length).fill(1),a.partials&&console.warn("Ignore partials because the given length does not match with the length of harmonics"));this.phaseshift.length<this.harmonics.length&&(this.phaseshift=
Array(this.harmonics.length).fill(0),a.phaseshift&&console.warn("Ignore phaseshift because the given length does not match with the length of harmonics"));this.precompute&=this.partials.every(b=>1E-8>Math.abs(b-1));0<this.damp&&(this.duration=Math.min(this.duration,6/this.damp))}panit(){0===this.pan||this.masterGain.panNode||(this.masterGain.disconnect(this.audioCtx.destination),this.masterGain.panNode=this.audioCtx.createStereoPanner(),this.masterGain.connect(this.masterGain.panNode),this.masterGain.panNode.connect(this.audioCtx.destination));
this.masterGain.panNode&&this.masterGain.panNode.pan.setValueAtTime(this.pan,this.audioCtx.currentTime)}dampit(){this.masterGain.gain.cancelScheduledValues(this.audioCtx.currentTime);this.masterGain.gain.setValueAtTime(this.masterGain.gain.value,this.audioCtx.currentTime);0<this.damp?this.masterGain.gain.setTargetAtTime(0,this.audioCtx.currentTime+this.attack,1/this.damp):0>this.damp&&this.masterGain.gain.setTargetAtTime(1,this.audioCtx.currentTime+this.attack,-this.damp)}startOscillators(){if(this.precompute)this.oscNodes[0]=
na.playOscillator(na.createWaveOscillator(this.freq,this.harmonics,this.phaseshift),this.masterGain,1,this.attack,this.duration,this.release);else for(let a=0;a<this.harmonics.length;a++)this.oscNodes[a]=na.playOscillator(na.createMonoOscillator(this.partials[a]*(a+1)*this.freq,this.phaseshift[a]),this.masterGain,this.harmonics[a],this.attack,this.duration,this.release)}stopOscillators(){for(let a in this.oscNodes)na.softStop(this.oscNodes[a],this.release),delete this.oscNodes[a]}stop(){this.stopOscillators()}updateFrequencyAndGain(){if(this.precompute)this.harmonicsdidnotchange()&&
this.oscNodes[0]&&this.oscNodes[0].oscNode.isplaying&&!this.oscNodes[0].oscNode.mono?(this.oscNodes[0].oscNode.frequency.setValueAtTime(this.freq,this.audioCtx.currentTime),na.extendDuration(this.oscNodes[0],this.duration,this.release)):(this.stopOscillators(),this.startOscillators());else{for(let a=0;a<this.harmonics.length;a++)0<this.harmonics[a]&&(this.oscNodes[a]&&this.oscNodes[a].oscNode.isplaying&&this.oscNodes[a].oscNode.mono?(this.oscNodes[a].oscNode.frequency.setValueAtTime(this.partials[a]*
(a+1)*this.freq,this.audioCtx.currentTime),this.oscNodes[a].gainNode.gain.setValueAtTime(this.harmonics[a],this.audioCtx.currentTime),na.extendDuration(this.oscNodes[a],this.duration,this.release)):(this.oscNodes[a]&&this.oscNodes[a].oscNode.isplaying&&!this.oscNodes[a].oscNode.mono&&na.softStop(this.oscNodes[a],this.release),this.oscNodes[a]=na.playOscillator(na.createMonoOscillator(this.partials[a]*(a+1)*this.freq,this.phaseshift[a]),this.masterGain,this.harmonics[a],this.attack,this.duration,this.release)));
for(let a in this.oscNodes)this.harmonics[a]||(na.softStop(this.oscNodes[a],this.release),delete this.oscNodes[a])}}generateNewMasterGain(a){this.masterGain=this.audioCtx.createGain();this.masterGain.connect(this.audioCtx.destination);this.masterGain.gain.setValueAtTime(a,this.audioCtx.currentTime)}harmonicsdidnotchange(){let a;if(this.lastharmonics){a=1&this.lastharmonics.length===this.harmonics.length;for(let b in this.harmonics)a&&(a&=this.harmonics[b]===this.lastharmonics[b])}else a=!1;return a}evokeplaysin(a,
b,c){this.cleanparameters(c);if(0===this.duration)return this.stop(),B;a||b&&0!==this.damp?(b&&!a&&this.stopOscillators(),this.generateNewMasterGain(this.amp),this.startOscillators()):(this.masterGain||this.generateNewMasterGain(this.amp),this.updateFrequencyAndGain());this.panit();this.dampit();this.lastharmonics=this.harmonics}}v.stopsound$0=function(){if(na.audioCtx){for(let a in na.lines)na.lines[a].stop(),delete na.lines[a];na.audioCtx.close();na.audioCtx=null}};v.playsin$1=function(a,b){var c=
na.getAudioContext();let d=na.handleLineModif(b.line,"0"),f=!1;na.lines[d]&&"sin"===na.lines[d].lineType||(na.lines[d]&&na.lines[d].stop(),na.lines[d]=new Ff(c),f=!0);c=na.lines[d];c.freq=K(a[0]).value.real;c.handleModif(b,"amp","number",.5);c.handleModif(b,"damp","number",0);c.handleModif(b,"duration","number",na.handleModif(b.stop,"number",1));c.handleModif(b,"harmonics","list",[1]);c.handleModif(b,"partials","list",[1]);c.handleModif(b,"attack","number",.01);c.handleModif(b,"release","number",
.01);c.handleModif(b,"pan","number",0);c.handleModif(b,"precompute","boolean",!1);c.handleModif(b,"phaseshift","phaseshift",Array(c.harmonics.length).fill(0));a=na.handleModif(b.restart,"boolean",!0);c.evokeplaysin(f,a,b);return B};v.playsin$0=function(a,b){if(void 0!==b.line&&(a=na.handleLineModif(b.line,"0"),a=na.lines[a])){a.handleModif(b,"freq","number",a.freq);a.handleModif(b,"amp","number",a.amp);a.handleModif(b,"damp","number",a.damp);a.handleModif(b,"duration","number",na.handleModif(b.stop,
"number",a.duration));a.handleModif(b,"harmonics","list",a.harmonics);a.handleModif(b,"partials","list",a.partials);a.handleModif(b,"attack","number",a.attack);a.handleModif(b,"release","number",a.release);a.handleModif(b,"pan","number",a.pan);a.handleModif(b,"precompute","boolean",a.precompute);a.handleModif(b,"phaseshift","phaseshift",a.phaseshift);let c=na.handleModif(b.restart,"boolean",!1);a.evokeplaysin(!1,c,b)}return B};v.playfunction$1=function(a,b){let c=na.getAudioContext();var d=a[0];a=
function(H){let Q=[];for(Q.push(H);0!==Q.length;){H=Q.pop();if("variable"===H.ctype&&K(H)===B&&["x","y","t"].includes(H.name))return H.name;if(H.args)for(let T in H.args)Q.push(H.args[T])}return B}(d);a!==B&&M.newvar(a);let f=na.handleLineModif(b.line,"0"),k=na.handleModif(b.start,"number",0),m=na.handleModif(b.amp,"number",.5),p=na.handleModif(b.damp,"number",0);na.handleModif(b.stop,"number",1);var u=na.handleModif(b.duration,"number",1);let x=na.handleModif(b.attack,"number",.01),y=na.handleModif(b.release,
"number",.01),C=na.handleModif(b.export,"boolean",!1),F=na.handleModif(b.silent,"boolean",!1);b=[];for(let H=0;H<c.sampleRate*u;H++){a!==B&&M.setvar(a,n.real(H/c.sampleRate));let Q=K(d);b[H]=Q.value.real*m*Math.exp(-p*H/c.sampleRate)}F||(na.lines[f]&&"function"===na.lines[f].lineType?(d=na.lines[f],d.masterGain.gain.linearRampToValueAtTime(0,c.currentTime+y),d.bufferNode.stop(c.currentTime+y),d.bufferNode=na.getBufferNode(b,u),d.bufferNode.connect(d.masterGain),d.bufferNode.start(k+y),d.masterGain.gain.linearRampToValueAtTime(m,
c.currentTime+y+x)):(na.lines[f]&&na.lines[f].stop(),na.lines[f]={lineType:"function",bufferNode:na.getBufferNode(b,u),masterGain:c.createGain(),stop:function(){this.bufferNode.stop()}},u=na.lines[f],u.masterGain.gain.setValueAtTime(0,c.currentTime),u.masterGain.connect(c.destination),u.bufferNode.connect(u.masterGain),u.bufferNode.start(k),u.masterGain.gain.linearRampToValueAtTime(m,c.currentTime+x)));a!==B&&M.removevar(a);return C?b:B};v.playwave$1=function(a,b){let c=na.getAudioContext();var d=
K(a[0]),f=na.handleLineModif(b.line,"0");a=na.handleModif(b.amp,"number",.5);na.handleModif(b.damp,"number",0);let k=na.handleModif(b.duration,"number",1),m=na.handleModif(b.attack,"number",.01),p=na.handleModif(b.release,"number",.01);b=na.handleModif(b.start,"number",0);if("list"!==d.ctype)return B;na.lines[f]&&"wave"===na.lines[f].lineType?(f=na.lines[f],f.masterGain.gain.linearRampToValueAtTime(0,c.currentTime+p),f.bufferNode.stop(c.currentTime+p),f.bufferNode=na.getBufferNode(G.unwrap(d),k),
f.bufferNode.connect(f.masterGain),f.bufferNode.start(b+p),f.masterGain.gain.linearRampToValueAtTime(a,c.currentTime+p+m)):(na.lines[f]&&na.lines[f].stop(),na.lines[f]={lineType:"wave",bufferNode:na.getBufferNode(G.unwrap(d),k),masterGain:c.createGain(),stop:function(){this.bufferNode.stop()}},d=na.lines[f],d.masterGain.gain.setValueAtTime(0,c.currentTime),d.masterGain.connect(c.destination),d.bufferNode.connect(d.masterGain),d.bufferNode.start(0),d.masterGain.gain.linearRampToValueAtTime(a,c.currentTime+
m));return B};const Ma={printArr:function(a){const b=a.value.length,c=[],d=[];let f=!1;for(let k=0;k<b;k++)c[k]=a.value[k].value.real,d[k]=a.value[k].value.imag,0!==d[k]&&(f=!0);console.log(c);f&&console.log(d)},zero:function(a){const b=[],c=n.real(0);for(let d=0;d<a.value.real;d++)b[d]=c;return h.turnIntoCSList(b)},number:function(a,b){b=Ma.zero(b);b.value[0]=a;return b},variable:function(a,b){b=Ma.zero(b);b.value[0]=a;b.value[1]=n.real(1);return b},add:function(a,b){return h.add(a,b)},sub:function(a,
b){return h.sub(a,b)},mult:function(a,b){if(a.value.length!==b.value.length)return console.error("dims don't fit return nada"),B;const c=a.value.length,d=Ma.zero(n.real(c));let f=n.real(0);for(let k=0;k<c;k++){for(let m=0;m<=k;m++)f=n.add(f,n.mult(a.value[m],b.value[k-m]));d.value[k]=f;f=n.real(0)}return d},pow:function(a,b){if(0>b.value.real||b.value.real!==Math.floor(b.value.real))return Ma.root(a,b);let c=a;for(let d=1;d<b.value.real;d++)c=Ma.mult(c,a);return c},root:function(a,b){const c=n.real(0),
d=n.real(1),f=n.add(d,b),k=a.value.length,m=Ma.zero(n.real(k));m.value[0]=n.pow(a.value[0],b);var p=c;let u,x;for(b=1;b<k;b++){x=n.real(b);for(let y=1;y<=b;y++)u=n.mult(f,n.real(y)),u=n.div(u,x),u=n.sub(u,d),u=n.mult(u,a.value[y]),u=n.mult(u,m.value[b-y]),p=n.add(p,u);p=n.div(p,a.value[0]);m.value[b]=p;p=c}return m},findFirstNoneZero:function(a,b,c){let d=Infinity,f=Infinity;for(let k=c;k<a.value.length;k++)if(1E-12<n.abs2(a.value[k]).value.real){d=k;break}for(a=c;a<b.value.length;a++)if(1E-12<n.abs2(b.value[a]).value.real){f=
a;break}return[d,f]},div:function(a,b){if(a.value.length!==b.value.length)return console.log("dims don't fit - return nada"),B;let c=a.value.length;const d=n.real(0),f=Ma.zero(n.real(c));let k=d;for(let p=0;p<c;p++){var m=Ma.findFirstNoneZero(a,b,p);p<m[0]&&m[0]===m[1]&&Infinity!==m[0]&&(a.value.splice(p,m[0]),b.value.splice(p,m[0]),f.value.splice(p,m[0]),c-=m[0]);m=a.value[p];for(let u=0;u<p;u++)k=n.add(k,n.mult(f.value[u],b.value[p-u]));m=n.sub(m,k);m=n.div(m,b.value[0]);f.value[p]=m;k=d}return f},
exp:function(a){const b=n.real(0),c=a.value.length,d=Ma.zero(n.real(c));let f=b,k;d.value[0]=n.exp(a.value[0]);for(let m=1;m<c;m++){for(let p=1;p<=m;p++)k=n.mult(n.real(p),a.value[p]),k=n.mult(k,d.value[m-p]),f=n.add(f,k);d.value[m]=n.div(f,n.real(m));f=b}return d},log:function(a){const b=n.real(0),c=a.value.length,d=Ma.zero(n.real(c));d.value[0]=n.log(a.value[0]);let f=b,k,m;for(let p=1;p<c;p++){k=a.value[p];for(let u=1;u<p;u++)m=n.mult(n.real(u),d.value[u]),m=n.mult(m,a.value[p-u]),f=n.add(f,m);
f=n.div(f,n.real(p));k=n.sub(k,f);k=n.div(k,a.value[0]);d.value[p]=k;f=b}return d},sincos:function(a){const b=n.real(0),c=a.value.length,d=Ma.zero(n.real(c)),f=Ma.zero(n.real(c));d.value[0]=n.sin(a.value[0]);f.value[0]=n.cos(a.value[0]);let k=b,m=b,p;let u;for(let y=1;y<c;y++){u=n.real(y);for(let C=1;C<=y;C++){var x=n.mult(n.real(C),a.value[C]);p=n.mult(x,f.value[y-C]);x=n.mult(x,d.value[y-C]);m=n.add(m,p);k=n.add(k,x)}m=n.div(m,u);k=n.div(k,n.neg(u));d.value[y]=m;f.value[y]=k;k=m=b}Ma.sinsave=d;
Ma.cossave=f;return[d,f]},sin:function(a){return Ma.sincos(a)[0]},cos:function(a){return Ma.sincos(a)[1]},faculty:function(a){let b=[];b[0]=n.real(1);let c=1;for(let d=1;d<=a.value.real;d++)c*=d,b[d]=n.real(c);return b=h.turnIntoCSList(b)},diff:function(a,b,c,d){let f;if("variable"===a.ctype)f=a.name!==b?Ma.number(K(a),d):Ma.variable(c,d);else if("number"===a.ctype)f=Ma.number(a,d);else{if("infix"===a.ctype){if("*"===a.oper)return Ma.mult(Ma.diff(a.args[0],b,c,d),Ma.diff(a.args[1],b,c,d));if("^"===
a.oper)return Ma.pow(Ma.diff(a.args[0],b,c,d),Ma.diff(a.args[1],b,c,d).value[0]);if("/"===a.oper)return Ma.div(Ma.diff(a.args[0],b,c,d),Ma.diff(a.args[1],b,c,d));if("+"===a.oper)return Ma.add(Ma.diff(a.args[0],b,c,d),Ma.diff(a.args[1],b,c,d));if("-"===a.oper)return Ma.sub(Ma.diff(a.args[0],b,c,d),Ma.diff(a.args[1],b,c,d));console.log("infix not found",a.oper);return B}if("function"===a.ctype){if("exp$1"===a.oper)return Ma.exp(Ma.diff(a.args[0],b,c,d));if("log$1"===a.oper)return Ma.log(Ma.diff(a.args[0],
b,c,d));if("sin$1"===a.oper)return Ma.sin(Ma.diff(a.args[0],b,c,d));if("cos$1"===a.oper)return Ma.cos(Ma.diff(a.args[0],b,c,d))}else return console.log("ctype not found",a.ctype),B}return f},adevaluate:function(a,b,c,d){a=Ma.diff(a,b,c,d);d=Ma.faculty(d);for(b=2;b<a.value.length;b++)a.value[b]=n.mult(a.value[b],d.value[b]);return a},autodiff:function(a,b,c,d){let f=[];const k=c.value.length;let m;for(let p=0;p<k;p++)m=Ma.adevaluate(a,b,c.value[p],d),f[p]=m;return f=h.turnIntoCSList(f)}},L={handleModifs:function(a,
b){L.dashing&&L.unSetDash();L.colorraw=null;L.fillcolorraw=null;L.fillrule="nonzero";L.size=null;0>=L.psize&&(L.psize=0);0>=L.lsize&&(L.lsize=0);L.overhang=1;L.dashing=!1;L.isArrow=!1;L.arrowSides="==>";L.arrowposition=1;L.headlen=10;L.arrowShape=L.arrowShapes.line;L.alpha=N.drawingstate.alpha;L.fillalpha=0;L.bold="";L.italics="";L.family="sans-serif";L.align=0;L.angle=0;L.xOffset=0;L.yOffset=0;L.lineCap="round";L.lineJoin="round";L.miterLimit=10;L.noborder=!1;let c,d;for(c in a){const f=a[c];f&&
((d=b[c])?(!0===d&&(d=L.modifHandlers[c]),d(K(f))):console.log("Modifier not supported: "+c))}null!==L.size?L.psize=L.lsize=L.size:(L.psize=N.drawingstate.pointsize,L.lsize=N.drawingstate.linesize);L.dashing&&L.dashing(L.lsize);null!==L.colorraw?L.pointColor=L.lineColor=L.textColor=L.makeColor(L.colorraw):1===L.alpha?(L.pointColor=N.drawingstate.pointcolor,L.lineColor=N.drawingstate.linecolor,L.textColor=N.drawingstate.textcolor):(L.pointColor=L.makeColor(N.drawingstate.pointcolorraw),L.lineColor=
L.makeColor(N.drawingstate.linecolorraw),L.textColor=L.makeColor(N.drawingstate.textcolorraw));L.black=1===L.alpha?"rgb(0,0,0)":"rgba(0,0,0,"+L.alpha+")";L.fillColor=L.fillcolorraw&&0<L.fillalpha?L.makeColor(L.fillcolorraw,L.fillalpha):null},modifHandlers:{size:function(a){"number"===a.ctype&&(L.size=a.value.real,0>L.size&&(L.size=0),1E3<L.size&&(L.size=1E3))},color:function(a){h.isNumberVector(a).value&&3===a.value.length&&(L.colorraw=[a.value[0].value.real,a.value[1].value.real,a.value[2].value.real])},
fillcolor:function(a){h.isNumberVector(a).value&&3===a.value.length&&(L.fillcolorraw=[a.value[0].value.real,a.value[1].value.real,a.value[2].value.real])},alpha:function(a){"number"===a.ctype&&(L.alpha=a.value.real)},fillalpha:function(a){"number"===a.ctype&&(L.fillalpha=a.value.real)},dashpattern:function(a){if("list"===a.ctype){const b=[];for(let c=0,d=0;c<a.value.length;c++)"number"===a.value[c].ctype&&(b[d++]=a.value[c].value.real);L.dashing=L.setDash.bind(null,b)}},dashtype:function(a){if("number"===
a.ctype)a=Math.floor(a.value.real);else if("string"===a.ctype)a=a.value;else return;if(a=L.dashTypes[a])L.dashing=L.setDash.bind(null,a)},dashing:function(a){"number"===a.ctype&&(a=Math.floor(a.value.real),L.dashing=L.setDash.bind(null,[2*a,a]))},overhang:function(a){"number"===a.ctype&&(L.overhang=L.overhang*a.value.real+(1-L.overhang)*(1-a.value.real))},arrow:function(a){"boolean"===a.ctype?L.isArrow=a.value:console.error("arrow needs to be of type boolean")},arrowshape:function(a){"string"!==a.ctype?
console.error("arrowshape needs to be of type string"):L.arrowShapes.hasOwnProperty(a.value)?(L.arrowShape=L.arrowShapes[a.value],L.isArrow=!0,L.arrowShape.deprecated&&(console.log("arrowshape "+a.value+" is deprecated, use "+L.arrowShape.deprecated+" instead."),L.arrowShape.deprecated=null)):(a=Object.keys(L.arrowShapes),a.sort(),a=a.join(", "),console.error("arrowshape needs to be one of "+a))},arrowsides:function(a){"string"!==a.ctype?console.error("arrowsides is not of type string"):"==>"!==a.value&&
"<==>"!==a.value&&"<=="!==a.value?console.error("arrowsides is unknows"):(L.arrowSides=a.value,L.isArrow=!0)},arrowposition:function(a){"number"!==a.ctype?console.error("arrowposition is not of type number"):0>a.value.real?console.error("arrowposition has to be positive"):1<a.value.real?L.overhang=L.overhang*a.value.real+(1-L.overhang)*(1-a.value.real):(L.arrowposition=a.value.real,L.isArrow=!0)},arrowsize:function(a){"number"!==a.ctype?console.error("arrowsize is not of type number"):0>a.value.real?
console.error("arrowsize has to be positive"):L.headlen*=a.value.real},bold:function(a){"boolean"===a.ctype&&a.value&&(L.bold="bold ")},italics:function(a){"boolean"===a.ctype&&a.value&&(L.italics="italic ")},family:function(a){"string"===a.ctype&&(L.family=a.value)},align:function(a){"string"===a.ctype&&(a=a.value,"left"===a&&(L.align=0),"right"===a&&(L.align=1),"mid"===a||"center"===a)&&(L.align=.5)},angle:function(a){"number"===a.ctype&&(L.angle=a.value.real)},xoffset:function(a){"number"===a.ctype&&
(L.xOffset=a.value.real)},yoffset:function(a){"number"===a.ctype&&(L.yOffset=a.value.real)},offset:function(a){"list"===a.ctype&&2===a.value.length&&"number"===a.value[0].ctype&&"number"===a.value[1].ctype&&(L.xOffset=a.value[0].value.real,L.yOffset=a.value[1].value.real)},lineCap:function(a){"string"!==a.ctype||"round"!==a.value&&"square"!==a.value&&"butt"!==a.value||(L.lineCap=a.value)},lineJoin:function(a){"string"!==a.ctype||"round"!==a.value&&"bevel"!==a.value&&"miter"!==a.value||(L.lineJoin=
a.value)},fillrule:function(a){"string"!==a.ctype||"nonzero"!==a.value&&"evenodd"!==a.value||(L.fillrule=a.value)},miterLimit:function(a){"number"===a.ctype&&0<a.value.real&&(L.miterLimit=Math.round(a.value.real))},noborder:function(a){"boolean"===a.ctype?L.noborder=a.value:console.error("noborder needs to be of type boolean")},border:function(a){"boolean"===a.ctype?L.noborder=!a.value:console.error("border needs to be of type boolean")}},lineModifs:{size:!0,color:!0,alpha:!0,dashpattern:!0,dashtype:!0,
dashing:!0,overhang:!0,arrow:!0,arrowshape:!0,arrowsides:!0,arrowposition:!0,arrowsize:!0,lineCap:!0,lineJoin:!0,miterLimit:!0},pointModifs:{size:!0,color:!0,alpha:!0,noborder:!0,border:!0}};L.pointAndLineModifs=L.lineModifs;L.conicModifs={size:!0,color:!0,alpha:!0,dashing:!0,dashpattern:!0,dashtype:!0,fillcolor:!0,fillrule:!0,fillalpha:!0,lineCap:!0,lineJoin:!0,miterLimit:!0};L.textModifs={size:!0,color:!0,alpha:!0,bold:!0,italics:!0,family:!0,align:!0,angle:!0,xoffset:!0,yoffset:!0,offset:!0};L.makeColor=
function(a,b){void 0===b&&(b=L.alpha);return"rgba("+Math.floor(255*a[0])+","+Math.floor(255*a[1])+","+Math.floor(255*a[2])+","+b+")"};L.preDrawCurve=function(){P.lineWidth=L.lsize;P.lineCap=L.lineCap;P.lineJoin=L.lineJoin;P.mozFillRule=L.fillrule;P.fillrule=L.fillrule;P.miterLimit=L.miterLimit;P.strokeStyle=L.lineColor};L.arrowShapes={default:{close:!1,fill:!1,ratio:1,deprecated:"line"},line:{close:!1,fill:!1,ratio:1},empty:{close:!0,fill:!1,ratio:1},hollow:{close:!0,fill:!1,ratio:1,deprecated:"empty"},
full:{close:!0,fill:!0,ratio:1},jet:{close:!0,fill:!0,ratio:1.5},delta:{close:!0,fill:!0,ratio:1.5,deprecated:"jet"}};L.clipSegment=function(a,b){var c=b.x-a.x;const d=b.y-a.y;var f=L.clipLineCore(-d,c,a.x*b.y-b.x*a.y);if(2!==f.length)return[];let k=f[0];f=f[1];const m=1/(c*c+d*d),p=((k.x-a.x)*c+(k.y-a.y)*d)*m;c=((f.x-a.x)*c+(f.y-a.y)*d)*m;0>p&&(k=a);1<p&&(k=b);0>c&&(f=a);1<c&&(f=b);return k===f?[]:[k,f]};L.drawsegcore=function(a,b){function c(F,H,Q,T){const X=F-T*y+.5*C,U=H-T*C-.5*y,pa=F-T*y-.5*
C;T=H-T*C+.5*y;P.beginPath();L.arrowShape.fill&&(P.lineWidth=L.lsize/2);P.moveTo(X,U);P.lineTo(F,H);P.lineTo(pa,T);L.arrowShape.close&&(P.fillStyle=L.lineColor,P.lineTo(F-Q*y,H-Q*C),P.closePath(),L.arrowShape.fill&&P.fill());P.stroke()}var d=N.drawingstate.matrix,f=a.x*d.a-a.y*d.b+d.tx,k=a.x*d.c-a.y*d.d-d.ty,m=b.x*d.a-b.y*d.b+d.tx,p=b.x*d.c-b.y*d.d-d.ty,u=L.overhang,x=1-u;b=u*f+x*m;d=u*k+x*p;a=u*m+x*f;u=u*p+x*k;if(0>b||b>$a||0>d||d>fb||0>a||a>$a||0>u||u>fb){u=L.clipSegment({x:b,y:d},{x:a,y:u});if(2!==
u.length||.01>L.lsize)return;b=u[0].x;d=u[0].y;a=u[1].x;u=u[1].y}L.preDrawCurve();if(!L.isArrow||f===k&&m===p).01>L.lsize||(P.beginPath(),P.moveTo(b,d),P.lineTo(a,u),P.stroke());else{f=m-f;k=p-k;m=L.headlen/Math.sqrt(f*f+k*k);var y=f*m,C=k*m;p=L.arrowposition;x=1-p;f=p*b+x*a;k=p*d+x*u;m=p*a+x*b;p=p*u+x*d;x=L.arrowSides;P.beginPath();L.arrowShape.close?("<==>"===x||"<=="===x?(1>L.arrowposition&&(P.moveTo(b,d),P.lineTo(f,k)),P.moveTo(f+y,k+C)):P.moveTo(b,d),"==>"===x||"<==>"===x?(P.lineTo(m-y,p-C),
1>L.arrowposition&&(P.moveTo(m,p),P.lineTo(a,u))):P.lineTo(a,u)):(P.moveTo(b,d),P.lineTo(a,u));P.stroke();"==>"!==x&&"<==>"!==x||c(m,p,1,L.arrowShape.ratio);"<=="!==x&&"<==>"!==x||c(f,k,-1,-L.arrowShape.ratio)}};L.drawpoint=function(a){const b=N.drawingstate.matrix,c=a.x*b.a-a.y*b.b+b.tx;a=a.x*b.c-a.y*b.d-b.ty;P.lineWidth=.3*L.psize;P.beginPath();P.arc(c,a,L.psize,0,2*Math.PI);P.fillStyle=L.pointColor;P.fill();L.noborder||(P.beginPath(),P.arc(c,a,1.15*L.psize,0,2*Math.PI),P.fillStyle=L.black,P.strokeStyle=
L.black,P.stroke())};L.clipLineCore=function(a,b,c){var d=Math.SQRT1_2*L.lsize;const f=0-d,k=$a+d,m=0-d;d=fb+d;const p=0>f*a+m*b+c,u=0>k*a+m*b+c,x=0>f*a+d*b+c,y=0>k*a+d*b+c,C=[];p!==u&&C.push({x:(-c-b*m)/a,y:m});u!==y&&C.push({x:k,y:(-c-a*k)/b});x!==y&&C.push({x:(-c-b*d)/a,y:d});p!==x&&C.push({x:f,y:(-c-a*f)/b});return C};L.clipLine=function(a){a=h.normalizeMax(h.productVM(a,N.toMat()));return L.clipLineCore(a.value[0].value.real,a.value[1].value.real,a.value[2].value.real)};L.drawline=function(a){h._helper.isAlmostReal(a)&&
(a=L.clipLine(a),2===a.length&&.01<=L.lsize&&(L.preDrawCurve(),P.beginPath(),P.moveTo(a[0].x,a[0].y),P.lineTo(a[1].x,a[1].y),P.stroke()))};L.drawRaySegment=function(a,b){a=A.extractPoint(a);b=A.extractPoint(b);if(a.ok&&b.ok){var c=a.x-b.x,d=a.y-b.y,f=25E3/N.drawingstate.matrix.sdet/Math.sqrt(c*c+d*d);c*=f;d*=f;L.drawsegcore(a,{x:a.x+c,y:a.y+d});L.drawsegcore(b,{x:b.x-c,y:b.y-d})}};L.dashTypes={solid:[],dashed:[10,10],tightdash:[10,4],dotted:[1,3],dashdot:[10,5,1,5],"dashvalue.solid":[],"dashvalue.dashed":[10,
10],"dashvalue.tightdash":[10,4],"dashvalue.dotted":[1,3],"dashvalue.dashdot":[10,5,1,5],0:[],1:[10,10],2:[10,4],3:[1,3],4:[10,5,1,5]};L.setDash=function(a,b){b=Math.sqrt(b);a=a.slice();for(let c=0;c<a.length;c++)a[c]*=b;P.webkitLineDash=a;P.setLineDash(a);P.mozDash=a};L.unSetDash=function(){P.webkitLineDash=[];P.setLineDash([]);P.mozDash=[]};be.prototype={set fillStyle(a){const b=this;Bd(a,function(c,d,f,k){b._fill="#"+Mc(c.toString(16),2)+Mc(d.toString(16),2)+Mc(f.toString(16),2);b._fillOpacity=
255===k?null:k})},set strokeStyle(a){const b=this;Bd(a,function(c,d,f,k){b._stroke="#"+Mc(c.toString(16),2)+Mc(d.toString(16),2)+Mc(f.toString(16),2);b._strokeOpacity=255===k?null:k})},clearRect:function(){},beginPath:function(){this._path=[]},_pathcmd:function(){this._path.push.apply(this._path,arguments)},closePath:function(){this._pathcmd("Z")},moveTo:function(a,b){this._pathcmd("M",a,b)},lineTo:function(a,b){this._pathcmd("L",a,b)},bezierCurveTo:function(a,b,c,d,f,k){this._pathcmd("C",a,b,c,d,
f,k)},quadraticCurveTo:function(a,b,c,d){this._pathcmd("Q",a,b,c,d)},arc:function(a,b,c,d,f,k){const m=c*Math.cos(d)+a,p=c*Math.sin(d)+b,u=c*Math.cos(f)+a,x=c*Math.sin(f)+b;f=k?d-f:f-d;f>=2*Math.PI?this._pathcmd(this._path.length?"L":"M",m,p,"A",c,c,0,0,k?1:0,a-c*Math.cos(d),b-c*Math.sin(d),"A",c,c,0,0,k?1:0,m,p):this._pathcmd(this._path.length?"L":"M",m,p,"A",c,c,0,f>Math.PI?1:0,k?1:0,u,x)},rect:function(a,b,c,d){this._pathcmd("M",a,b,"h",c,"v",d,"h",-c,"z")},_cmd:function(a){1!==this.globalAlpha?
(this._body.push('<g opacity="'+this.globalAlpha+'">'),this._body.push(a),this._body.push("</g>")):this._body.push(a)},_attrs:function(a){let b="";for(const c in a)null!==a[c]&&(b+=" "+c+'="'+a[c]+'"');return b},fill:function(){this._cmd("<path"+this._attrs({d:this._path.join(" "),fill:this._fill,"fill-opacity":this._fillOpacity})+"/>")},stroke:function(){this._cmd("<path"+this._attrs({d:this._path.join(" "),stroke:this._stroke,"stroke-opacity":this._strokeOpacity,"stroke-width":this.lineWidth,"stroke-linecap":this.lineCap,
"stroke-linejoin":this.lineJoin,"stroke-miterlimit":"miter"===this.lineJoin?this.miterLimit:null})+"/>")},clip:function(){++this._clipIndex;this._body.push('<clipPath id="clip'+this._clipIndex+'"><path d="'+this._path.join(" ")+'"/></clipPath>','<g clip-path="url(#clip'+this._clipIndex+')">');this._saveStack[this._saveStack.length-1]+="</g>"},save:function(){this._saveStack.push("")},restore:function(){this._body.push(this._saveStack.pop());0===this._saveStack.length&&this._saveStack.push("")},_transform:function(a){this._body.push('<g transform="'+
a+'">');this._saveStack[this._saveStack.length-1]+="</g>"},translate:function(a,b){this._transform("translate("+a+" "+b+")")},rotate:function(a){this._transform("rotate("+Math.PI/180*a+")")},scale:function(a,b){this._transform("scale("+a+" "+b+")")},transform:function(a,b,c,d,f,k){this._transform("matrix("+[a,b,c,d,f,k].join(" ")+")")},drawImage:function(a,b,c){if(3!==arguments.length)throw Error("SvgWriterContext only supports 3-argument version of drawImage");let d=this._imgcache.indexOf(a);if(-1===
d){d=this._imgcache.length;let f;f=a.cachedDataURL?a.cachedDataURL:Lc(a);this._defs.push('<image id="img'+d+'" x="0" y="0" width="'+a.width+'" height="'+a.height+'" xlink:href="'+f+'"/>');this._imgcache.push(a)}this._cmd('<use x="'+b+'" y="'+c+'" xlink:href="#img'+d+'"/>')},toBlob:function(){for(;1<this._saveStack.length||""!==this._saveStack[0];)this.restore();const a='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="'+
this.width+'px" height="'+this.height+'px">\n'+this._defs.join("\n")+'\n</defs>\n<g stroke="none" fill="none">\n'+this._body.join("\n")+"\n</g>\n</svg>\n";return new Blob([a],{type:"image/svg+xml"})}};ze.prototype={_cmd:function(){this._body.push(Array.prototype.join.call(arguments," "))},_setAlpha:function(a,b,c){const d=Math.round(255*a*this._globalAlpha);b+=d;this._extGState[b]="<< /"+c+" "+d/255+" >>";this._cmd("/"+b,"gs");return a},set globalAlpha(a){this._globalAlpha=a;this._setAlpha(this._strokeAlpha,
"As","CA");this._setAlpha(this._fillAlpha,"Af","ca")},set fillStyle(a){const b=this;Bd(a,function(c,d,f,k){b._cmd(c/255,d/255,f/255,"rg");b._setAlpha(b._fillAlpha=k,"Af","ca")})},set strokeStyle(a){const b=this;Bd(a,function(c,d,f,k){b._cmd(c/255,d/255,f/255,"RG");b._setAlpha(b._strokeAlpha=k,"As","CA")})},set lineWidth(a){this._cmd(a,"w")},set lineCap(a){this._cmd({butt:0,round:1,square:2}[a],"J")},set lineJoin(a){this._cmd({miter:0,round:1,bevel:2}[a],"j")},set miterLimit(a){this._cmd(a,"M")},clearRect:function(){},
beginPath:function(){this._pathUsed=!1},closePath:function(){this._cmd("h")},moveTo:function(a,b){this._cmd(this._xPos=a,this._yPos=-b,"m")},lineTo:function(a,b){this._cmd(this._xPos=a,this._yPos=-b,"l")},bezierCurveTo:function(a,b,c,d,f,k){this._cmd(a,-b,c,-d,this._xPos=f,this._yPos=-k,"c")},quadraticCurveTo:function(a,b,c,d){this.bezierCurveTo((2*a+this._xPos)/3,(2*b-this._yPos)/3,(c+2*a)/3,(d+2*b)/3,c,d)},_kappa:.5522847498307935,arc:function(a,b,c,d,f,k){if(0===d&&f===2*Math.PI)d=this._kappa*
c,this.moveTo(a+c,b),this.bezierCurveTo(a+c,b+d,a+d,b+c,a,b+c),this.bezierCurveTo(a-d,b+c,a-c,b+d,a-c,b),this.bezierCurveTo(a-c,b-d,a-d,b-c,a,b-c),this.bezierCurveTo(a+d,b-c,a+c,b-d,a+c,b);else throw Error("PdfWriterContext.arc only supports full circles");},rect:function(a,b,c,d){this._cmd(a,-b,c,-d,"re")},_usePath:function(a){if(this._pathUsed){const b=this._body[this._pathUsed],c={"S + f":"B","f + S":"B","W n + S":"W S","W n + f":"W f","S + W n":"W S","f + W n":"W f","B + W n":"W B","W S + f":"W B",
"W f + S":"W B"}[b+" + "+a];if(!c)throw Error("Don't know how to combine '"+b+"' and '"+a+"'");this._body.splice(this._pathUsed,1);a=c}this._pathUsed=this._body.length;this._cmd(a)},fill:function(){this._usePath("f")},stroke:function(){this._usePath("S")},clip:function(){this._usePath("W n")},save:function(){this._cmd("q")},restore:function(){this._cmd("Q")},translate:function(a,b){this.transform(1,0,0,1,a,b)},rotate:function(a){const b=Math.cos(a);a=Math.sin(a);this.transform(b,a,-a,b,0,0)},scale:function(a,
b){this.transform(a,0,0,b,0,0)},transform:function(a,b,c,d,f,k){this._cmd(a,-b,-c,d,f,-k,"cm")},_png:function(a){if("data:image/png;base64,"!==a.substr(0,22))return{error:"Not a base64-encoded PNG file"};a=af(a.substr(22));var b=bf(a);console.log("PNG chunks:",b.map(function(C){return C.type}));if("IHDR"!==b[0].type)throw Error("Image does not start with an IHDR");var c=b[0].data;a=(c[0]<<24|c[1]<<16|c[2]<<8|c[3])>>>0;const d=(c[4]<<24|c[5]<<16|c[6]<<8|c[7])>>>0,f=c[8];var k=c[9];const m=0===(k&2);
var p=0!==(k&4),u=c[10],x=c[11];c=c[12];if(0!==u)throw Error("Unsupported PNG compression method: "+u);if(0!==x)throw Error("Unsupported PNG filter method: "+x);if(0!==c)return{error:"Interlaced image not supported"};if(0!==(k&1))return{error:"Indexed PNG image not supported"};x=null;k=m?1:3;u=b.filter(function(C){return"IDAT"===C.type}).map(function(C){return C.data});if(p){p=window.pako;x=new p.Inflate;for(b=0;b<u.length;++b)x.push(u[b],b+1===u.length);if(x.err)throw Error(x.err);x=x.result;c=f>>>
3;if(x.length!==d*(a*(k+1)*c+1))throw Error("Data length mismatch");const C=k*c;u=new Uint8Array(d*(a*C+1));let F=new Uint8Array(d*(a*c+1)),H=0,Q=0,T=0;for(let X=0;X<d;++X){u[Q++]=F[T++]=x[H++];for(let U=0;U<a;++U){for(b=0;b<C;++b)u[Q++]=x[H++];for(b=0;b<c;++b)F[T++]=x[H++]}}if(H!==x.length||Q!==u.length||T!==F.length)throw Error("Seems we garbled our index computation somehow");F=p.deflate(F);x=this._strm({Type:"/XObject",Subtype:"/Image",Width:a,Height:d,ColorSpace:"/DeviceGray",BitsPerComponent:f,
Filter:"/FlateDecode",DecodeParms:this._dict({Predictor:15,Colors:1,BitsPerComponent:f,Columns:a})},F).ref;u=[p.deflate(u)]}let y=0;u.forEach(function(C){y+=C.length});return this._obj([this._dict({Type:"/XObject",Subtype:"/Image",Name:"/img"+this._imgcache.length,Width:a,Height:d,ColorSpace:m?"/DeviceGray":"/DeviceRGB",SMask:x,BitsPerComponent:f,Length:y,Filter:"/FlateDecode",DecodeParms:this._dict({Predictor:15,Colors:k,BitsPerComponent:f,Columns:a})}),"\nstream\n"].concat(u,["\nendstream"]))},
drawImage:function(a,b,c){if(3!==arguments.length)throw Error("PdfWriterContext only supports 3-argument version of drawImage");let d=this._imgcache.indexOf(a);if(-1===d){d=this._imgcache.length;this._imgcache.push(a);let f=this._png(a.cachedDataURL||"");f.hasOwnProperty("error")&&(f=this._png(Lc(a)));if(f.hasOwnProperty("error"))throw Error(f.error);this._xobjects["img"+d]=f.ref}this._cmd("q");this._setAlpha(1,"Af","ca");this._cmd(a.width,0,0,a.height,b,-c-a.height,"cm");this._cmd("/img"+d,"Do");
this._cmd("Q")},_dict:function(a){let b="<<";for(const c in a)b+=" /"+c+" "+a[c];return b+" >>"},_obj:function(a,b){b||(b=this._nextIndex++);Array.isArray(a)||(a=[this._dict(a)]);a.index=b;a.ref=b+" 0 R";a.offset=this._offset;let c=0;a.unshift(b+" 0 obj\n");a.push("\nendobj\n");for(b=0;b<a.length;++b)c+=a[b].length;this._offset+=c;this._objects.push(a);return a},_strm:function(a,b,c){a.Length=b.length;return this._obj([this._dict(a),"\nstream\n",b,"\nendstream"],c)},toBlob:function(){var a="["+[0,
-this.height,this.width,0].join(" ")+"]";this._obj({Type:"/Catalog",Pages:"2 0 R"},1);this._obj({Type:"/Pages",Kids:"[3 0 R]",Count:1},2);this._obj({Type:"/Page",Parent:"2 0 R",MediaBox:a,Contents:"4 0 R",Resources:this._dict({ProcSet:"[/PDF /Text /ImageB /ImageC /ImageI]",XObject:this._dict(this._xobjects),ExtGState:this._dict(this._extGState)})},3);var b=this._body.join("\n"),c=new Uint8Array(b.length);for(a=0;a<b.length;++a)c[a]=b.charCodeAt(a)&255;b=window.pako.deflate(c);this._strm({Filter:"/FlateDecode"},
b,4);b=this._objects;const d=[];for(a=1;a<b.length;++a)d[b[a].index]=b[a];c="xref\n0 "+d.length+"\n";for(a=0;a<d.length;++a)c=d[a]?c+(Mc(String(d[a].offset),10)+" 00000 n \n"):c+"0000000000 65535 f \n";a="trailer\n"+this._dict({Size:d.length,Root:"1 0 R"})+"\nstartxref\n"+this._offset+"\n%%EOF\n";b=Array.prototype.concat.apply([],b);b.push(c,a);return new Blob(b,{type:"application/pdf"})}};let we=null;Hc.push(ce);Kb.exportSVG=function(){Nc(be)};Kb.exportPDF=function(){Ab.loadScript("pako","pako.min.js",
function(){Nc(ze)})};Kb.exportPNG=function(){xf(P.canvas.toDataURL())};var xf=function(a){const b=document.createElement("a");document.body.appendChild(b);b.style="display: none";b.href=a;b.download="CindyJSExport";b.click();setTimeout(function(){document.body.removeChild(b);ce()},100)};let rf="Move",xe,dc=[],Sc=0,Df=0,Rd=0;var ba={Delete:{}};ba.Delete.actions=[];ba.Delete.actions[0]={};ba.Delete.actions[0].event="mousedown";ba.Delete.actions[0].tooltip="...";ba.Delete.actions[0].do=function(){tb=
Wc(bb);null!==tb&&pd(tb.mover.name);return!0};ba.Move={};ba.Move.actions=[];ba.Move.actions[0]={};ba.Move.actions[0].event="mousedown";ba.Move.actions[0].tooltip="Move free elements by dragging the mouse";ba.Move.actions[0].do=function(){{var a=bb;let k=null,m=1E6,p;for(const u of E.free){if(u.pinned||!1===u.visible||!0===u.tmp)continue;var b=void 0,c=void 0,d=void 0;const x=N.drawingstate.matrix.sdet;if("P"===u.kind){c=h.normalizeZ(u.homog);if(!h._helper.isAlmostReal(c))continue;b=c.value[0].value.real-
a.x;c=c.value[1].value.real-a.y;d=Math.sqrt(b*b+c*c);if(u.narrow&&d>("number"===typeof u.narrow?u.narrow:20)/x)continue}else if("C"===u.kind){c=h.normalizeZ(E.csnames[u.args[0]].homog);b=u.radius;if(!h._helper.isAlmostReal(c)||!n._helper.isAlmostReal(b))continue;d=c.value[0].value.real;var f=c.value[1].value.real;c=a.x-d;const y=a.y-f,C=Math.sqrt(c*c+y*y);if(0===C)continue;f+=y/C*b.value.real;b=d+c/C*b.value.real-a.x;c=f-a.y;d=Math.sqrt(b*b+c*c);d+=30/x;if(u.narrow&&d>(("number"===typeof u.narrow?
u.narrow:20)+30)/x)continue}else if("L"===u.kind)b=u.homog,d=n,c=d.add(d.mult(b.value[0],d.conjugate(b.value[0])),d.mult(b.value[1],d.conjugate(b.value[1]))),c=h.scaldiv(d.sqrt(c),b),d=c.value[0].value.real*a.x+c.value[1].value.real*a.y+c.value[2].value.real,b=-c.value[0].value.real*d,c=-c.value[1].value.real*d,0>d&&(d=-d),d+=25/x;else if("Text"===u.kind){if(!u.homog||u.dock||!u._bbox)continue;c=N.from(a.x,a.y,1);b=Math.max(0,c[0]-u._bbox.right,u._bbox.left-c[0]);c=Math.max(0,c[1]-u._bbox.bottom,
u._bbox.top-c[1]);d=Math.sqrt(b*b+c*c);if(20<d)continue;d/=x;c=h.normalizeZ(u.homog);if(!h._helper.isAlmostReal(c))continue;b=c.value[0].value.real-a.x;c=c.value[1].value.real-a.y}else continue;d<m+.2/x&&(m=d,k=u,p={x:b,y:c})}console.log("Moving "+(k?k.name:"nothing"));a=null===k?null:{mover:k,offset:p,prev:{x:a.x,y:a.y}}}tb=a;return!0};ba.Point={};ba.Point.actions=[];ba.Point.actions[0]={};ba.Point.actions[0].event="mousedown";ba.Point.actions[0].tooltip="Add a single point with the mouse";ba.Point.actions[0].do=
function(){zb({type:"Free",name:ac(),labeled:!0,pos:[Pb[0],Pb[1],1]});return!0};ba.Mid={};ba.Mid.actions=[];ba.Mid.actions[0]={};ba.Mid.actions[0].event="mousedown";ba.Mid.actions[0].tooltip="Construct two points and their midpoint by dragging";ba.Mid.actions[0].do=function(){Oc();return!0};ba.Mid.actions[1]={};ba.Mid.actions[1].event="mousemove";ba.Mid.actions[1].do=function(){Cd("Mid");return!0};ba.Mid.actions[2]={};ba.Mid.actions[2].event="mouseup";ba.Mid.actions[2].do=function(){gd();return!0};
ba.Circle={};ba.Circle.actions=[];ba.Circle.actions[0]={};ba.Circle.actions[0].event="mousedown";ba.Circle.actions[0].tooltip="Construct two points and a circle by dragging the mouse";ba.Circle.actions[0].do=function(){Oc();return!0};ba.Circle.actions[1]={};ba.Circle.actions[1].event="mousemove";ba.Circle.actions[1].do=function(){Cd("CircleMP");return!0};ba.Circle.actions[2]={};ba.Circle.actions[2].event="mouseup";ba.Circle.actions[2].do=function(){gd();return!0};ba.Compass={};ba.Compass.actions=
[];ba.Compass.actions[0]={};ba.Compass.actions[0].event="mousedown";ba.Compass.actions[0].tooltip="...";ba.Compass.actions[0].do=function(){Oc();return!0};ba.Compass.actions[1]={};ba.Compass.actions[1].event="mousedown";ba.Compass.actions[1].tooltip="...";ba.Compass.actions[1].do=function(){Oc();return!0};ba.Compass.actions[2]={};ba.Compass.actions[2].event="mousedown";ba.Compass.actions[2].tooltip="...";ba.Compass.actions[2].do=function(){Oc();zb({type:"Compass",name:ac(),labeled:!0,args:[dc[0].name,
dc[1].name,dc[2].name]});return!0};ba.Line={};ba.Line.actions=[];ba.Line.actions[0]={};ba.Line.actions[0].event="mousedown";ba.Line.actions[0].tooltip="Construct two points and their connecting line by dragging the mouse";ba.Line.actions[0].do=function(){Oc();return!0};ba.Line.actions[1]={};ba.Line.actions[1].event="mousemove";ba.Line.actions[1].do=function(){Cd("Join");return!0};ba.Line.actions[2]={};ba.Line.actions[2].event="mouseup";ba.Line.actions[2].do=function(){gd();return!0};ba.Segment={};
ba.Segment.actions=[];ba.Segment.actions[0]={};ba.Segment.actions[0].event="mousedown";ba.Segment.actions[0].tooltip="Draw a segment by dragging the mouse";ba.Segment.actions[0].do=function(){Oc();return!0};ba.Segment.actions[1]={};ba.Segment.actions[1].event="mousemove";ba.Segment.actions[1].do=function(){Cd("Segment");return!0};ba.Segment.actions[2]={};ba.Segment.actions[2].event="mouseup";ba.Segment.actions[2].do=function(){gd();return!0};ba.Parallel={};ba.Parallel.actions=[];ba.Parallel.actions[0]=
{};ba.Parallel.actions[0].event="mousedown";ba.Parallel.actions[0].tooltip="Construct a parallel line by dragging a line";ba.Parallel.actions[0].do=function(){return De()};ba.Parallel.actions[1]={};ba.Parallel.actions[1].event="mousemove";ba.Parallel.actions[1].do=function(){let a={type:"Free",name:ac(),labeled:!0,pos:[Pb[0],Pb[1],1],tmp:!0};a=zb(a);xe=zb({type:"Para",name:ac(),labeled:!0,args:[dc[0].name,a.name]});de(a);return!0};ba.Parallel.actions[2]={};ba.Parallel.actions[2].event="mouseup";ba.Parallel.actions[2].do=
function(){gd();return!0};ba.Orthogonal={};ba.Orthogonal.actions=[];ba.Orthogonal.actions[0]={};ba.Orthogonal.actions[0].event="mousedown";ba.Orthogonal.actions[0].tooltip="Construct a orthogonal line by dragging a line";ba.Orthogonal.actions[0].do=function(){if(De()){let a={type:"Free",name:ac(),labeled:!0,pos:[Pb[0],Pb[1],1],tmp:!0};a=zb(a);xe=zb({type:"Perp",name:ac(),labeled:!0,args:[dc[0].name,a.name]});de(a);return!0}return!1};ba.Orthogonal.actions[1]={};ba.Orthogonal.actions[1].event="mouseup";
ba.Orthogonal.actions[1].do=function(){gd();return!0};ba.Intersection={};ba.Intersection.actions=[];ba.Intersection.actions[0]={};ba.Intersection.actions[0].event="mousedown";ba.Intersection.actions[0].tooltip="Select two elements to define their intersection";ba.Intersection.actions[0].do=function(){return Pc()};ba.Intersection.actions[1]={};ba.Intersection.actions[1].event="mousedown";ba.Intersection.actions[1].do=function(){return Pc()?(xe=zb({type:"Meet",name:ac(),labeled:!0,args:[dc[0].name,
dc[1].name]}),!0):!1};class Uc{constructor(a){a?(this._e=[],this._e[0]=a[0][0],this._e[1]=a[1][0],this._e[2]=a[2][0],this._e[3]=a[0][1],this._e[4]=a[1][1],this._e[5]=a[2][1],this._e[6]=a[0][2],this._e[7]=a[1][2],this._e[8]=a[2][2]):this._e=[1,0,0,0,1,0,0,0,1]}clone(){let a=[...this._e],b=new Uc;b.set(a);return b}get(a){return this._e[a]}getRow(a){let b=this._e;return[b[a],b[3+a],b[6+a]]}set(a,b){1===arguments.length&&(this._e=a);2===arguments.length&&(this._e[a]=b)}exchange(a,b){[this._e[a],this._e[b]]=
[this._e[b],this._e[a]]}inverse(){var a=this._e;let b=-a[2]*a[4]*a[6]+a[1]*a[5]*a[6]+a[2]*a[3]*a[7]-a[0]*a[5]*a[7]-a[1]*a[3]*a[8]+a[0]*a[4]*a[8];a=[-a[4]*a[7]+a[4]*a[8],a[5]*a[6]-a[3]*a[8],-a[4]*a[6]+a[3]*a[7],a[2]*a[7]-a[1]*a[8],-a[2]*a[6]+a[0]*a[8],a[1]*a[6]-a[0]*a[7],-a[2]*a[4]+a[1]*a[5],a[2]*a[3]-a[0]*a[5],-a[1]*a[3]+a[0]*a[4]];1E-10>Math.abs(b)&&console.log("PSLQ: inverting singular matrix!");this._e=a.map(c=>c/b);return this}swRow(a,b){let c=0;for(;9>c;)this.exchange(c+a,c+b),c+=3}swCol(a,b){for(let c=
0;3>c;++c)this.exchange(3*a+c,3*b+c)}static mult(a,b,c){a=[a.get(0)*b.get(0)+a.get(3)*b.get(1)+a.get(6)*b.get(2),a.get(1)*b.get(0)+a.get(4)*b.get(1)+a.get(7)*b.get(2),a.get(2)*b.get(0)+a.get(5)*b.get(1)+a.get(8)*b.get(2),a.get(0)*b.get(3)+a.get(3)*b.get(4)+a.get(6)*b.get(5),a.get(1)*b.get(3)+a.get(4)*b.get(4)+a.get(7)*b.get(5),a.get(2)*b.get(3)+a.get(5)*b.get(4)+a.get(8)*b.get(5),a.get(0)*b.get(6)+a.get(3)*b.get(7)+a.get(6)*b.get(8),a.get(1)*b.get(6)+a.get(4)*b.get(7)+a.get(7)*b.get(8),a.get(2)*b.get(6)+
a.get(5)*b.get(7)+a.get(8)*b.get(8)];c.set(a)}getString(){let a=this._e;return"/"+a[0]+"\t "+a[3]+"\t "+a[6]+"\\\n|"+a[1]+"\t "+a[4]+"\t "+a[7]+"|\n\\"+a[2]+"\t "+a[5]+"\t "+a[8]+"/\n"}transpose(){this.exchange(1,3);this.exchange(2,6);this.exchange(5,7);return this}static VMmult(a,b,c){c[0]=b.get(0)*a[0]+b.get(1)*a[1]+b.get(2)*a[2];c[1]=b.get(3)*a[0]+b.get(4)*a[1]+b.get(5)*a[2];c[2]=b.get(6)*a[0]+b.get(7)*a[1]+b.get(8)*a[2]}}class dd{static dot(a,b){let c=0;for(let d=0;d<a.length;d++)c+=a[d]*b[d];
return c}static scale(a,b){for(let c=0;c<a.length;++c)a[c]*=b}static maxIndex(a){let b=0;for(let c=1;c<a.length;++c)a[c]>a[b]&&(b=c);return b}static get MAX_ITER(){return 20}static get GAMMA(){return 2/Math.sqrt(3)}static hermiteReduce(a){let b=[[1,0,0],[0,1,0],[0,0,1]];var c=a.length;let d=a.map(m=>[...m]),f;for(let m=1;m<c;m++)for(let p=m-1;0<=p;p--){f=Math.round(a[m][p]/a[p][p]);for(var k=0;k<=p;k++)d[m][k]-=f*d[p][k];for(k=0;k<c;k++)b[m][k]-=f*b[p][k]}for(c=0;3>c;c++)a[c]=d[c];return new Uc(b)}static doPSLQ(a,
b){const c=a.length;let d=[];var f=[];for(var k=0;k<c;++k){d[k]=a[k]/Math.sqrt(dd.dot(a,a));var m=0;for(var p=k;p<c;++p)m+=a[p]**2;f[k]=Math.sqrt(m)}dd.scale(f,1/f[0]);k=new Uc;a=new Uc;m=[];for(p=0;p<c;p++)m[p]=[];for(p=0;p<c;++p)for(var u=0;u<c-1;++u)m[p][u]=p>u?-d[p]*d[u]/f[u]/f[u+1]:p===u?f[p+1]/f[p]:0;p=dd.hermiteReduce(m);u=p.clone().inverse().transpose();Uc.VMmult(d,u,d);Uc.mult(p,k,k);Uc.mult(a,u,a);for(f=0;f<dd.MAX_ITER;++f){u=[m[0][0],m[1][1]];p=0;this.GAMMA**2*Math.abs(u[1])>this.GAMMA**
1*Math.abs(u[0])&&(p=1);let C=u=0,F=0;p<c-2&&(u=m[p+1][p],C=m[p+1][p+1],F=Math.sqrt(u**2+C**2));var x=d[p];d[p]=d[p+1];d[p+1]=x;x=[...m[p]];m[p]=m[p+1];m[p+1]=x;k.swRow(p,p+1);a.swCol(p,p+1);x=Array(2);for(var y=0;3>y;y++)x[y]=[];if(p<c-2){for(y=0;y<c-1;++y)for(let H=0;H<c-1;++H)x[y][H]=y===p&&H===p?u/F:y===p&&H===p+1?-C/F:y===p+1&&H===p?C/F:y===p+1&&H===p+1?u/F:y===H&&H!==p||y===H&&H!==p+1?1:0;m=[[m[0][0]*x[0][0]+m[0][1]*x[1][0],m[0][0]*x[0][1]+m[0][1]*x[1][1]],[m[1][0]*x[0][0]+m[1][1]*x[1][0],m[1][0]*
x[0][1]+m[1][1]*x[1][1]],[m[2][0]*x[0][0]+m[2][1]*x[1][0],m[2][0]*x[0][1]+m[2][1]*x[1][1]]]}p=dd.hermiteReduce(m);u=p.clone().inverse().transpose();Uc.VMmult(d,u,d);Uc.mult(p,k,k);Uc.mult(a,u,a);p=[d[0],d[1],d[2],m[0][0],m[1][1]];for(u=0;u<p.length;++u)if(Math.abs(p[u])<=10**(-b+5)){a.transpose();for(b=0;b<d.length;++b)d[b]=-Math.abs(d[b]);return a.getRow(dd.maxIndex(d))}}}}const cd={},N={drawingstate:{}};N.drawingstate.linecolor="rgb(0,0,255)";N.drawingstate.linecolorraw=[0,0,1];N.drawingstate.pointcolor=
"rgb(0,255,0)";N.drawingstate.pointcolorraw=[0,1,0];N.drawingstate.textcolor="rgb(0,0,0)";N.drawingstate.textcolorraw=[0,0,0];N.drawingstate.alpha=1;N.drawingstate.pointsize=4;N.drawingstate.linesize=1;N.drawingstate.textsize=null;N.drawingstate.matrix={};N.drawingstate.matrix.a=25;N.drawingstate.matrix.b=0;N.drawingstate.matrix.c=0;N.drawingstate.matrix.d=25;N.drawingstate.matrix.tx=250.5;N.drawingstate.matrix.ty=250.5;N.drawingstate.matrix.det=N.drawingstate.matrix.a*N.drawingstate.matrix.d-N.drawingstate.matrix.b*
N.drawingstate.matrix.c;N.drawingstate.matrix.sdet=Math.sqrt(N.drawingstate.matrix.det);N.drawingstate.initialmatrix={};N.drawingstate.initialmatrix.a=N.drawingstate.matrix.a;N.drawingstate.initialmatrix.b=N.drawingstate.matrix.b;N.drawingstate.initialmatrix.c=N.drawingstate.matrix.c;N.drawingstate.initialmatrix.d=N.drawingstate.matrix.d;N.drawingstate.initialmatrix.tx=N.drawingstate.matrix.tx;N.drawingstate.initialmatrix.ty=N.drawingstate.matrix.ty;N.drawingstate.initialmatrix.det=N.drawingstate.matrix.det;
N.drawingstate.initialmatrix.sdet=N.drawingstate.matrix.sdet;N.clone=function(a){if(null===a||"object"!==typeof a)return a;const b=a.constructor();for(const c in a)b[c]=N.clone(a[c]);return b};cd.backup=N.clone(N.drawingstate);cd.stack=[];N.clone(N.drawingstate);N.reset=function(){N.drawingstate.matrix.a=N.drawingstate.initialmatrix.a;N.drawingstate.matrix.b=N.drawingstate.initialmatrix.b;N.drawingstate.matrix.c=N.drawingstate.initialmatrix.c;N.drawingstate.matrix.d=N.drawingstate.initialmatrix.d;
N.drawingstate.matrix.tx=N.drawingstate.initialmatrix.tx;N.drawingstate.matrix.ty=N.drawingstate.initialmatrix.ty;N.drawingstate.matrix.det=N.drawingstate.initialmatrix.det;N.drawingstate.matrix.sdet=N.drawingstate.initialmatrix.sdet};N.from=function(a,b,c){a/=c;b/=c;c=N.drawingstate.matrix;return[(a*c.a-b*c.b+c.tx)/rb,(a*c.c-b*c.d-c.ty)/rb]};N.to=function(a,b){const c=N.drawingstate.matrix;a=a*rb-c.tx;b=b*rb+c.ty;return[(a*c.d-b*c.b)/c.det,-(-a*c.c+b*c.a)/c.det,1]};N.toMat=function(){const a=N.drawingstate.matrix;
return h.realMatrix([[a.d,-a.b,-a.tx*a.d-a.ty*a.b],[a.c,-a.a,-a.tx*a.c-a.ty*a.a],[0,0,a.det]])};N.dumpTrafo=function(){function a(c){return Math.round(1E3*c)/1E3}const b=N.drawingstate.matrix;console.log("a:"+a(b.a)+" b:"+a(b.b)+" c:"+a(b.c)+" d:"+a(b.d)+" tx:"+a(b.ty)+" ty:"+a(b.tx))};N.setMat=function(a,b,c,d,f,k){const m=N.drawingstate.matrix;m.a=a;m.b=b;m.c=c;m.d=d;m.tx=f;m.ty=k;m.det=a*d-b*c;m.sdet=Math.sqrt(m.det)};N.scaleAndOrigin=function(a,b,c){N.setMat(a,0,0,a,b,c)};N.visibleRect=function(a,
b,c,d){var f=c-a;const k=b-d;f=$a*k<fb*f?$a/f:fb/k;N.setMat(f,0,0,f,($a-f*(a+c))/2,(fb-f*(b+d))/2)};N.applyMat=function(a,b,c,d,f,k){const m=N.drawingstate.matrix;N.setMat(m.a*a+m.c*b,m.b*a+m.d*b,m.a*c+m.c*d,m.b*c+m.d*d,m.a*f+m.c*k+m.tx,m.b*f+m.d*k+m.ty)};N.translate=function(a,b){N.applyMat(1,0,0,1,a,b)};N.rotate=function(a){const b=Math.cos(a);a=Math.sin(a);N.applyMat(b,a,-a,b,0,0)};N.scale=function(a){N.applyMat(a,0,0,a,0,0)};N.gsave=function(){cd.stack.push(N.clone(N.drawingstate))};N.grestore=
function(){0!==cd.stack.length&&(N.drawingstate=cd.stack.pop())};N.greset=function(){N.drawingstate=N.clone(cd.backup);N.drawingstate.matrix.ty-=fb;N.drawingstate.initialmatrix.ty-=fb;cd.stack=[]};N.createnewbackup=function(){N.drawingstate.initialmatrix.a=N.drawingstate.matrix.a;N.drawingstate.initialmatrix.b=N.drawingstate.matrix.b;N.drawingstate.initialmatrix.c=N.drawingstate.matrix.c;N.drawingstate.initialmatrix.d=N.drawingstate.matrix.d;N.drawingstate.initialmatrix.tx=N.drawingstate.matrix.tx;
N.drawingstate.initialmatrix.ty=N.drawingstate.matrix.ty;N.drawingstate.initialmatrix.det=N.drawingstate.matrix.det;N.drawingstate.initialmatrix.sdet=N.drawingstate.matrix.sdet;cd.backup=N.clone(N.drawingstate)};N.makecolor=function(a,b,c){a=Math.floor(255*a);b=Math.floor(255*b);c=Math.floor(255*c);return 1===N.drawingstate.alpha?"rgb("+a+","+b+","+c+")":"rgba("+a+","+b+","+c+","+N.drawingstate.alpha+")"};N.setcolor=function(a){const b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;
N.drawingstate.linecolor=N.drawingstate.pointcolor=N.makecolor(b,c,a);N.drawingstate.linecolorraw=N.drawingstate.pointcolorraw=[b,c,a]};N.setlinecolor=function(a){const b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;N.drawingstate.linecolor=N.makecolor(b,c,a);N.drawingstate.linecolorraw=[b,c,a]};N.settextcolor=function(a){const b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;N.drawingstate.textcolor=N.makecolor(b,c,a);N.drawingstate.textcolorraw=[b,
c,a]};N.setpointcolor=function(a){const b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;N.drawingstate.pointcolor=N.makecolor(b,c,a);N.drawingstate.pointcolorraw=[b,c,a]};N.setalpha=function(a){N.drawingstate.alpha=a.value.real;N.drawingstate.linecolor=N.makecolor(N.drawingstate.linecolorraw[0],N.drawingstate.linecolorraw[1],N.drawingstate.linecolorraw[2]);N.drawingstate.pointcolor=N.makecolor(N.drawingstate.pointcolorraw[0],N.drawingstate.pointcolorraw[1],N.drawingstate.pointcolorraw[2]);
N.drawingstate.textcolor=N.makecolor(N.drawingstate.textcolorraw[0],N.drawingstate.textcolorraw[1],N.drawingstate.textcolorraw[2])};N.setpointsize=function(a){N.drawingstate.pointsize=a.value.real};N.setlinesize=function(a){N.drawingstate.linesize=a.value.real};N.settextsize=function(a){N.drawingstate.textsize=a.value.real};const vb={clip:"none",pointColor:[1,0,0],lineColor:[0,0,1],pointSize:5,lineSize:1,alpha:1,overhangLine:1,overhangSeg:1,dimDependent:.7,fontFamily:"sans-serif",textColor:[0,0,0],
textsize:20,noborder:!1,lineHeight:1.45};aa.defaultAppearance&&cf(aa.defaultAppearance);var Ze={};const yf={UL:0,UR:1,LR:2,LL:3},tf=["in","out","good","backup","prover"];let nd=new Float64Array(0);const Rc={};tf.forEach(function(a){Rc[a]=nd});let Hb=nd,Cc=nd,lc=nd,ec,mc,md;var uc;let Td,uf=!1;const zf={toString:function(){return"RefineException"}};let Af=null;var ra=null;aa.enableTraceLog&&(ra={logLength:Infinity,fullLog:[],currentMouseAndScripts:null,currentMover:null,currentStep:null,currentElement:null,
currentParam:null,labelTracing2:G.wrap("tracing2"),labelTracing4:G.wrap("tracing4"),labelTracingSesq:G.wrap("tracingSesq"),postMouseHooks:[]},"number"===typeof aa.enableTraceLog&&(ra.logLength=aa.enableTraceLog),Kb.getTraceLog=hf,Kb.formatTraceLog=Pe,Kb.addTraceHook=ra.postMouseHooks.push.bind(ra.postMouseHooks));hc.stateSize=12;ie.stateSize=24;qd.stateSize=24;let Sb=[];mb._helper={};mb._helper.duplicatePPLL=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return{P:"point",
L:"line"}[a.kind]+" "+a.name+" is duplicate of "+b.name},apply:jd(a,b),holds:function(){return h.projectiveDistMinScal(a.homog,b.homog)<n.epsbig}}};mb._helper.duplicatePsLs=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return{Ps:"point set",Ls:"line set"}[a.kind]+" "+a.name+" is duplicate of "+b.name},apply:jd(a,b),holds:function(){return mb._helper.isSetEq(a.results.value,b.results.value,h.projectiveDistMinScal)}}};mb._helper.duplicateCC=function(a,b){return{getInvolved:function(){return[a,
b]},toString:function(){return"Conic "+a.name+" is duplicate of "+b.name},apply:jd(a,b),holds:function(){return h.conicDist(a.matrix,b.matrix)<n.epsbig}}};mb._helper.duplicateCs=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"Conic set"+a.name+" is duplicate of "+b.name},apply:jd(a,b),holds:function(){return mb._helper.isSetEq(a.results,b.results,h.conicDist)}}};mb._helper.duplicateSS=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"Segment "+
a.name+" is duplicate of "+b.name},apply:jd(a,b),holds:function(){const c=a.startpos;var d=a.endpos;const f=b.startpos,k=b.endpos;let m=h.projectiveDistMinScal(c,f);m+=h.projectiveDistMinScal(d,k);d=h.projectiveDistMinScal(d,f);d+=h.projectiveDistMinScal(c,k);return Math.min(m,d)<n.epsbig}}};mb.P=function(a){E.points.forEach(function(b){a.name!==b.name&&(b=mb._helper.duplicatePPLL(a,b),b.holds()&&Sb.push(b))})};mb.Ps=function(a){E.sets.points.forEach(function(b){a.name!==b.name&&(b=mb._helper.duplicatePsLs(a,
b),b.holds()&&Sb.push(b))})};mb.Ls=function(a){E.sets.lines.forEach(function(b){a.name!==b.name&&(b=mb._helper.duplicatePsLs(a,b),b.holds()&&Sb.push(b))})};mb.Cs=function(a){E.sets.conics.forEach(function(b){a.name!==b.name&&(b=mb._helper.duplicateCs(a,b),b.holds()&&Sb.push(b))})};mb.L=function(a){E.lines.forEach(function(b){a.name!==b.name&&a.kind===b.kind&&(b=mb._helper.duplicatePPLL(a,b),b.holds()&&Sb.push(b))})};mb.S=function(a){E.lines.forEach(function(b){a.name!==b.name&&"S"===b.kind&&(b=mb._helper.duplicateSS(a,
b),b.holds()&&Sb.push(b))})};mb.C=function(a){E.conics.forEach(function(b){a.name!==b.name&&(b=mb._helper.duplicateCC(a,b),b.holds()&&Sb.push(b))})};mb._helper.isSetEq=function(a,b,c){a=a.slice();b=b.slice();if(a.length!==b.length)return!1;if(0===a.length&&0===b.length)return!0;const d=a.shift(),f=b.reduce(function(k,m,p,u){return c(m,d)<c(u[k],d)?p:k},0);return c(b[f],d)<n.epsbig?(b.splice(f,1),mb._helper.isSetEq(a,b,c)):!1};Gc.P=function(a){E.lines.forEach(function(b){b=Se(a,b);b.holds()&&Sb.push(b)});
E.conics.forEach(function(b){b=je(a,b);b.holds()&&Sb.push(b)})};Gc.L=function(a){E.points.forEach(function(b){b=Se(b,a);b.holds()&&Sb.push(b)})};Gc.S=Gc.L;Gc.C=function(a){E.points.forEach(function(b){b=je(b,a);b.holds()&&Sb.push(b)})};const t={_helper:{},RandomLine:{}};t.RandomLine.kind="L";t.RandomLine.signature=[];t.RandomLine.updatePosition=function(a){a.homog=h.realVector([Math.random()-.5,Math.random()-.5,Math.random()-.5]);a.homog=h.normalizeMax(a.homog);a.homog=G.withUsage(a.homog,"Line")};
t._helper.getRandMove=function(a){a=a.homog;const b=h.getRandComplexVec3(-.05,.05);return{type:"homog",value:h.add(a,b)}};t._helper.getRandPointMove=function(a){a=h.normalizeMax(a.homog);var b=a.value[2],c=n.abs(b).value.real;let d=n.real(0);c<n.eps&&(d=n.getRandComplex(-.05,.05),b=n.real(1));c=h.turnIntoCSList([n.getRandComplex(-.1,.1),n.getRandComplex(-.1,.1),d]);b=h.scalmult(b,c);b=h.add(a,b);return{type:"homog",value:b}};t.FreeLine={};t.FreeLine.kind="L";t.FreeLine.signature=[];t.FreeLine.isMovable=
!0;t.FreeLine.initialize=function(a){a=t._helper.initializeLine(a);Sa(a)};t.FreeLine.getParamForInput=function(a,b,c){"mouse"===c?(a=h.cross(b,h.ez),a=h.cross(a,b)):a="homog"===c?b:h.turnIntoCSList([n.zero,n.zero,n.zero]);return h.normalizeMax(a)};t.FreeLine.getParamFromState=function(a){return ab(3)};t.FreeLine.putParamToState=function(a,b){Sa(b)};t.FreeLine.updatePosition=function(a){const b=ab(3);Sa(b);a.homog=G.withUsage(b,"Line")};t.FreeLine.getRandomMove=t._helper.getRandMove;t.FreeLine.stateSize=
6;t.RandomPoint={};t.RandomPoint.kind="P";t.RandomPoint.signature=[];t.RandomPoint.updatePosition=function(a){a.homog=h.realVector([100*Math.random(),100*Math.random(),100*Math.random()]);a.homog=h.normalizeMax(a.homog);a.homog=G.withUsage(a.homog,"Point")};t.Join={};t.Join.kind="L";t.Join.signature=["P","P"];t.Join.updatePosition=function(a){a.homog=h.cross(E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog);a.homog=h.normalizeMax(a.homog);a.homog=G.withUsage(a.homog,"Line")};t.Segment={};t.Segment.kind=
"S";t.Segment.signature=["P","P"];t.Segment.updatePosition=function(a){const b=E.csnames[a.args[0]],c=E.csnames[a.args[1]];t.Segment.setSegmentPos(a,h.cross(b.homog,c.homog),h.scalmult(c.homog.value[2],b.homog),h.scalmult(b.homog.value[2],c.homog))};t.Segment.setSegmentPos=function(a,b,c,d){b=h.normalizeMax(b);a.homog=G.withUsage(b,"Line");b=h.turnIntoCSList([c,d]);b=h.normalizeMax(b);a.startpos=b.value[0];a.endpos=b.value[1];a.farpoint=h.sub(a.startpos,a.endpos);a.farpoint=h.sub(a.startpos,a.endpos)};
t.Meet={};t.Meet.kind="P";t.Meet.signature=["L","L"];t.Meet.updatePosition=function(a){a.homog=h.cross(E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog);a.homog=h.normalizeMax(a.homog);a.homog=G.withUsage(a.homog,"Point")};t.Meet.visiblecheck=function(a){let b=!0;const c=E.csnames[a.args[0]],d=E.csnames[a.args[1]];"S"===c.kind&&(b=Je(a,c));b&&"S"===d.kind&&(b=Je(a,d));a.isshowing=b};t._helper.midpoint=function(a,b){return h.normalizeMax(h.add(h.scalmult(b.value[2],a),h.scalmult(a.value[2],b)))};
t.Mid={};t.Mid.kind="P";t.Mid.signature=["P","P"];t.Mid.updatePosition=function(a){const b=t._helper.midpoint(E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog);a.homog=G.withUsage(b,"Point")};t.Perp={};t.Perp.kind="L";t.Perp.signature=["L","P"];t.Perp.updatePosition=function(a){var b=E.csnames[a.args[0]].homog;const c=E.csnames[a.args[1]].homog;b=h.turnIntoCSList([b.value[0],b.value[1],n.zero]);a.homog=h.cross(b,c);a.homog=h.normalizeMax(a.homog);a.homog=G.withUsage(a.homog,"Line")};t.Para={};
t.Para.kind="L";t.Para.signature=["L","P"];t.Para.updatePosition=function(a){const b=E.csnames[a.args[1]].homog;a.homog=h.cross(h.cross(h.linfty,E.csnames[a.args[0]].homog),b);a.homog=h.normalizeMax(a.homog);a.homog=G.withUsage(a.homog,"Line")};t.Horizontal={};t.Horizontal.kind="L";t.Horizontal.signature=["P"];t.Horizontal.updatePosition=function(a){a.homog=h.cross(h.ex,E.csnames[a.args[0]].homog);a.homog=h.normalizeMax(a.homog);a.homog=G.withUsage(a.homog,"Line")};t.HorizontalLine={};t.HorizontalLine.kind=
"L";t.HorizontalLine.signature=[];t.HorizontalLine.isMovable=!0;t.HorizontalLine.initialize=function(a){a=t._helper.initializeLine(a);a=h.turnIntoCSList([n.zero,a.value[1],a.value[2]]);a=h.normalizeMax(a);Sa(a)};t.HorizontalLine.getParamForInput=function(a,b,c){if("mouse"===c)b=h.cross(b,h.ex);else if("homog"===c){if(0!==b.value[0].real||0!==b.value[0].imag)b=h.turnIntoCSList([n.zero,b.value[1],b.value[2]])}else b=h.turnIntoCSList([n.zero,n.zero,n.zero]);return h.normalizeMax(b)};t.HorizontalLine.getParamFromState=
function(a){return ab(3)};t.HorizontalLine.putParamToState=function(a,b){Sa(b)};t.HorizontalLine.updatePosition=function(a){const b=ab(3);Sa(b);a.homog=G.withUsage(b,"Line")};t.HorizontalLine.getRandomMove=t._helper.getRandMove;t.HorizontalLine.stateSize=6;t.Vertical={};t.Vertical.kind="L";t.Vertical.signature=["P"];t.Vertical.updatePosition=function(a){a.homog=h.cross(h.ey,E.csnames[a.args[0]].homog);a.homog=h.normalizeMax(a.homog);a.homog=G.withUsage(a.homog,"Line")};t.VerticalLine={};t.VerticalLine.kind=
"L";t.VerticalLine.signature=[];t.VerticalLine.isMovable=!0;t.VerticalLine.initialize=function(a){a=t._helper.initializeLine(a);a=h.turnIntoCSList([a.value[0],n.zero,a.value[2]]);a=h.normalizeMax(a);Sa(a)};t.VerticalLine.getParamForInput=function(a,b,c){if("mouse"===c)b=h.cross(b,h.ey);else if("homog"===c){if(0!==b.value[1].real||0!==b.value[1].imag)b=h.turnIntoCSList([b.value[0],n.zero,b.value[2]])}else b=h.turnIntoCSList([n.zero,n.zero,n.zero]);return h.normalizeMax(b)};t.VerticalLine.getParamFromState=
function(a){return ab(3)};t.VerticalLine.putParamToState=function(a,b){Sa(b)};t.VerticalLine.updatePosition=function(a){const b=ab(3);Sa(b);a.homog=G.withUsage(b,"Line")};t.VerticalLine.getRandomMove=t._helper.getRandMove;t.VerticalLine.stateSize=6;t.LineByFixedAngle={};t.LineByFixedAngle.kind="L";t.LineByFixedAngle.signature=["L","P"];t.LineByFixedAngle.initialize=function(a){var b=n._helper.input(a.angle);const c=n.cos(b);b=n.sin(b);a.rot=h.turnIntoCSList([h.turnIntoCSList([b,c,n.zero]),h.turnIntoCSList([n.neg(c),
b,n.zero]),h.turnIntoCSList([n.zero,n.zero,n.zero])])};t.LineByFixedAngle.updatePosition=function(a){const b=E.csnames[a.args[1]],c=h.productMV(a.rot,E.csnames[a.args[0]].homog);a.homog=h.cross(b.homog,c);a.homog=h.normalizeMax(a.homog);a.homog=G.withUsage(a.homog,"Line")};t.Through={};t.Through.kind="L";t.Through.signature=["P"];t.Through.isMovable=!0;t.Through.initialize=function(a){a=a.dir?G.wrap(a.dir):h.realVector([a.pos[1],-a.pos[0],0]);Sa(a)};t.Through.getParamForInput=function(a,b,c){a="dir"===
c||"mouse"===c?h.cross(E.csnames[a.args[0]].homog,b):"homog"===c?b:h.turnIntoCSList([n.zero,n.zero,n.zero]);a=h.cross(h.linfty,a);return h.normalizeMax(a)};t.Through.getParamFromState=function(a){return ab(3)};t.Through.putParamToState=function(a,b){Sa(b)};t.Through.updatePosition=function(a){var b=ab(3);Sa(b);b=h.cross(E.csnames[a.args[0]].homog,b);b=h.normalizeMax(b);a.homog=G.withUsage(b,"Line")};t.Through.getRandomMove=t._helper.getRandMove;t.Through.stateSize=6;t.Through.set_angle=function(a,
b){if("number"===b.ctype){var c=n.cos(b);b=n.sin(b);c=h.turnIntoCSList([c,b,n.real(0)]);Rb(a,c,"dir")}};t.Through.set_slope=function(a,b){"number"===b.ctype&&(b=h.turnIntoCSList([n.real(1),b,n.real(0)]),Rb(a,b,"dir"))};t.Free={};t.Free.kind="P";t.Free.signature=[];t.Free.isMovable=!0;t.Free.initialize=function(a){a=t._helper.initializePoint(a);Sa(a)};t.Free.getParamForInput=function(a,b,c){if("mouse"===c&&td&&0!==Tb){b=h.normalizeZ(b);a=b.value[0].value.real;c=b.value[1].value.real;const d=Math.round(a/
Tb)*Tb,f=Math.round(c/Tb)*Tb;Math.abs(d-a)<ld&&Math.abs(f-c)<ld&&(b=h.realVector([d,f,1]))}return h.normalizeMax(b)};t.Free.getParamFromState=function(a){return ab(3)};t.Free.putParamToState=function(a,b){Sa(b)};t.Free.updatePosition=function(a){const b=ab(3);Sa(b);a.homog=G.withUsage(b,"Point")};t.Free.getRandomMove=t._helper.getRandPointMove;t.Free.stateSize=6;t._helper.projectPointToLine=function(a,b){const c=h.turnIntoCSList([b.value[0],b.value[1],n.zero]);a=h.cross(c,a);return h.normalizeMax(h.cross(a,
b))};t.PointOnLine={};t.PointOnLine.kind="P";t.PointOnLine.signature=["L"];t.PointOnLine.isMovable=!0;t.PointOnLine.initialize=function(a){let b=t._helper.initializePoint(a);a=E.csnames[a.args[0]].homog;b=t._helper.projectPointToLine(b,a);b=h.normalizeMax(b);let c=h.cross(h.linfty,b);h.normalizeMax(c);Sa(b);Sa(a);md=!1};t.PointOnLine.updatePosition=function(a,b){const c=E.csnames[a.args[0]].homog;var d=ab(3);ab(3);if(!b){ec=a.stateIdx;var f=Hb;Hb=lc;b=ab(3);const k=ab(3);Hb=f;f=h.cross(k,c);h._helper.isAlmostZero(f)&&
(f=h.cross(h.linfty,c));b=t._helper.CircleMP(f,b);b=t._helper.IntersectLC(c,b);f=t._helper.pointReflection(f,d);d=he(b[0],b[1],d,f)[0]}d=h.normalizeMax(d);Sa(d);Sa(c);a.homog=G.withUsage(d,"Point")};t.PointOnLine.getParamForInput=function(a,b,c){a=E.csnames[a.args[0]].homog;b=t._helper.projectPointToLine(b,a);"mouse"===c&&td&&0!==Tb&&(b=t._helper.snapPointToLine(b,a));return b};t.PointOnLine.getParamFromState=function(a){return ab(3)};t.PointOnLine.putParamToState=function(a,b){return Sa(b)};t.PointOnLine.getRandomMove=
t._helper.getRandPointMove;t.PointOnLine.stateSize=12;t.PointOnCircle={};t.PointOnCircle.kind="P";t.PointOnCircle.signature=["C"];t.PointOnCircle.isMovable=!0;t.PointOnCircle.initialize=function(a){var b=E.csnames[a.args[0]];a=h.normalizeZ(t._helper.initializePoint(a));var c=h.normalizeZ(t._helper.CenterOfCircle(b.matrix)),d=h.sub(a,c);d=h.turnIntoCSList([d.value[1],n.neg(d.value[0]),n.zero]);c=h.cross(a,c);b=t._helper.IntersectLC(c,b.matrix);c=h.projectiveDistMinScal(a,b[0]);h.projectiveDistMinScal(a,
b[1])<c?(a=b[1],b=b[0]):(a=b[0],b=b[1]);Sa(d);Sa(a);Sa(b);md=!1};t.PointOnCircle.putParamToState=function(a,b){Sa(b)};t.PointOnCircle.getParamFromState=function(a){return ab(3)};t.PointOnCircle.getParamForInput=function(a,b,c){c=h.normalizeZ(t._helper.CenterOfCircle(E.csnames[a.args[0]].matrix));b=h.sub(b,c);ec=a.stateIdx;a=ab(3);const d=h.normalizeZ(ab(3));c=h.sub(d,c);0>n.sub(n.mult(a.value[0],c.value[1]),n.mult(a.value[1],c.value[0])).value.real&&(b=h.neg(b));return h.turnIntoCSList([b.value[1],
n.neg(b.value[0]),n.zero])};t.PointOnCircle.parameterPath=function(a,b,c,d,f){d=h.normalizeAbs(d);f=h.normalizeAbs(f);var k=h.scalproduct(d,f);if(0<=k.value.real)return ge(a,b,c,d,f);a=h.turnIntoCSList([n.sub(d.value[1],f.value[1]),n.sub(f.value[0],d.value[0]),n.zero]);k=h.scalproduct(d,a);0>k.value.real&&(a=h.neg(a));0>b?(b=2*b+1,c=b*b,k=.25/(1+c),c=n.complex(2*b*k+.25,(1-c)*k)):(b=2*b-1,c=b*b,k=.25/(1+c),c=n.complex(2*b*k+.75,(1-c)*k));const m=n.sub(n.real(1),c);b=n.mult(c,c);k=n.mult(m,m);c=n.mult(c,
m);d=h.scalmult(k,d);d=h.add(d,h.scalmult(c,a));return d=h.add(d,h.scalmult(b,f))};t.PointOnCircle.updatePosition=function(a){var b=ab(3);Sa(b);var c=E.csnames[a.args[0]];b=h.productMV(c.matrix,b);c=t._helper.IntersectLC(b,c.matrix);c=hc(c[0],c[1]);b=h.normalizeMax(c.value[0]);a.homog=G.withUsage(b,"Point");a.antipodalPoint=c.value[1]};t.PointOnCircle.getRandomMove=t._helper.getRandPointMove;t.PointOnCircle.stateSize=6+hc.stateSize;t.PointOnCircle.get_angle=function(a){var b=t._helper.CenterOfCircle(E.csnames[a.args[0]].matrix);
const c=h._helper.isAlmostFarpoint;if(c(a.homog)||c(b))return B;a=h.normalizeZ(a.homog);b=h.normalizeZ(b);b=h.sub(a,b);b=n.arctan2(b.value[0],b.value[1]);a=n.real(ue);b=n.mod(n.add(b,a),a);return G.withUsage(b,"Angle")};t.PointOnCircle.set_angle=function(a,b){if("number"===b.ctype){var c=E.csnames[a.args[0]];let d=t._helper.CenterOfCircle(c.matrix);if(!h._helper.isAlmostFarpoint(d)){d=h.normalizeZ(d);const f=n.cos(b);b=n.sin(b);c=h.turnIntoCSList([n.mult(f,c.radius),n.mult(b,c.radius),n.real(0)]);
Rb(a,h.add(d,c),"homog")}}return B};t.OtherPointOnCircle={};t.OtherPointOnCircle.kind="P";t.OtherPointOnCircle.signature=["P"];t.OtherPointOnCircle.signatureConstraints=function(a){return"PointOnCircle"===E.csnames[a.args[0]].type};t.OtherPointOnCircle.updatePosition=function(a){let b=E.csnames[a.args[0]].antipodalPoint;b=h.normalizeMax(b);a.homog=G.withUsage(b,"Point")};t.PointOnSegment={};t.PointOnSegment.kind="P";t.PointOnSegment.signature=["S"];t.PointOnSegment.isMovable=!0;t.PointOnSegment.initialize=
function(a){const b=t._helper.initializePoint(a);a=t.PointOnSegment.getParamForInput(a,b);xc(a)};t.PointOnSegment.getParamForInput=function(a,b,c){a=E.csnames[a.args[0]];var d=a.homog;"mouse"===c&&td&&0!==Tb&&(b=t._helper.snapPointToLine(b,d));c=h.turnIntoCSList([d.value[0],d.value[1],n.zero]);d=h.sub(a.startpos,a.endpos);b=h.crossratio3(d,a.startpos,a.endpos,b,c);0>b.value.real&&(b=n.complex(0,b.value.imag));1<b.value.real&&(b=n.complex(1,b.value.imag));return b};t.PointOnSegment.getParamFromState=
function(a){return id()};t.PointOnSegment.putParamToState=function(a,b){xc(b)};t.PointOnSegment.updatePosition=function(a){var b=id();xc(b);var c=E.csnames[a.args[0]];const d=c.startpos;c=h.sub(c.endpos,d);b=h.add(d,h.scalmult(b,c));b=h.normalizeMax(b);a.homog=G.withUsage(b,"Point")};t.PointOnSegment.getRandomMove=t._helper.getRandPointMove;t.PointOnSegment.stateSize=2;t._helper.projectPointToCircle=function(a,b){var c=t._helper.CenterOfCircle(a.matrix);c=h.normalizeMax(c);c=h.normalizeMax(h.cross(b,
c));a=t._helper.IntersectLC(c,a.matrix);c=h.projectiveDistMinScal(b,a[0]);b=h.projectiveDistMinScal(b,a[1]);return c<b?a[0]:a[1]};t.PointOnArc={};t.PointOnArc.kind="P";t.PointOnArc.signature=["C"];t.PointOnArc.signatureConstraints=function(a){return E.csnames[a.args[0]].isArc};t.PointOnArc.isMovable=!0;t.PointOnArc.initialize=function(a){const b=t._helper.initializePoint(a);a=t.PointOnArc.getParamForInput(a,b);Sa(a)};t.PointOnArc.getParamForInput=function(a,b){a=E.csnames[a.args[0]];b=t._helper.projectPointToCircle(a,
b);b=h.normalizeMax(h.crossratio3harm(a.startPoint,a.endPoint,a.viaPoint,b,h.ii));a=n.div(b.value[0],b.value[1]);0>a.value.real&&(b=-1>a.value.real?h.realVector([1,0]):h.realVector([0,1]));return b};t.PointOnArc.getParamFromState=function(a){return ab(2)};t.PointOnArc.putParamToState=function(a,b){Sa(b)};t.PointOnArc.updatePosition=function(a){var b=E.csnames[a.args[0]],c=b.startPoint,d=b.viaPoint;const f=b.endPoint,k=h.ii;var m=h.cross(c,k);d=h.cross(d,k);var p=h.cross(f,k);p=h.turnIntoCSList([m,
p]);m=h.transpose(p);p=h.conjugate(p);m=h.productMM(p,m);d=h.productMV(p,d);m=h.productMV(h.adjoint2(m),d);d=m.value[0];m=m.value[1];p=ab(2);Sa(p);c=h.normalizeMax(h.add(h.scalmult(n.mult(d,p.value[0]),c),h.scalmult(n.mult(m,p.value[1]),f)));b=t._helper.conicOtherIntersection(b.matrix,k,c);a.homog=G.withUsage(b,"Point")};t.PointOnArc.getRandomMove=t._helper.getRandPointMove;t.PointOnArc.stateSize=4;t._helper.CenterOfCircle=function(a){return h.turnIntoCSList([a.value[2].value[0],a.value[2].value[1],
n.neg(a.value[0].value[0])])};t._helper.CenterOfConic=function(a){a=h.adjoint3(a);return{ctype:"list",value:[a.value[2].value[0],a.value[2].value[1],a.value[2].value[2]]}};t.CenterOfConic={};t.CenterOfConic.kind="P";t.CenterOfConic.signature=["C"];t.CenterOfConic.updatePosition=function(a){const b=t._helper.CenterOfConic(E.csnames[a.args[0]].matrix);a.homog=b;a.homog=h.normalizeMax(a.homog);a.homog=G.withUsage(a.homog,"Point")};t._helper.CircleMP=function(a,b){var c=a.value[0],d=a.value[1];a=n.neg(a.value[2]);
const f=n.zero;c=h.turnIntoCSList([h.turnIntoCSList([a,f,c]),h.turnIntoCSList([f,a,d]),h.turnIntoCSList([c,d,f])]);d=G.mult(G.mult(b,c),b);b=G.mult(G.mult(b,h.fund),b);d=G.mult(d,h.fund);b=G.mult(b,c);return h.sub(d,b)};t.CircleMP={};t.CircleMP.kind="C";t.CircleMP.signature=["P","P"];t.CircleMP.updatePosition=function(a){a.matrix=t._helper.CircleMP(E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog);a.matrix=h.normalizeMax(a.matrix);a.matrix=G.withUsage(a.matrix,"Circle")};t.CircleMr={};t.CircleMr.kind=
"C";t.CircleMr.signature=["P"];t.CircleMr.isMovable=!0;t.CircleMr.initialize=function(a){xc(n.real(a.radius))};t.CircleMr.getParamForInput=function(a,b,c){if("radius"===c)return b;a=E.csnames[a.args[0]].homog;a=h.normalizeZ(a);b=h.normalizeZ(b);b=h.sub(a,b);return b=h.abs(b)};t.CircleMr.getParamFromState=function(a){return id()};t.CircleMr.putParamToState=function(a,b){xc(b)};t.CircleMr.updatePosition=function(a){const b=id();xc(b);var c=E.csnames[a.args[0]].homog,d=n.mult(c.value[2],b);d=n.mult(d,
d);if(!n._helper.isFinite(d)&&!n._helper.isNaN(d))return h.fund;c=t._helper.ScaledCircleMrr(c,d);a.matrix=G.withUsage(c,"Circle");a.radius=b};t.CircleMr.getRandomMove=function(a){a=a.radius;return{type:"radius",value:n.abs(a).value.real<n.eps?n.getRandComplex(.05,.1):n.mult(a,n.getRandReal(.95,1.05))}};t.CircleMr.stateSize=2;t.CircleMr.set_radius=function(a,b){"number"===b.ctype&&Rb(a,b,"radius")};t._helper.ScaledCircleMrr=function(a,b){var c=a.value[0];const d=a.value[1];a=n.neg(a.value[2]);a=h.scalmult(a,
h.turnIntoCSList([c,d,a])).value;c=h.turnIntoCSList([c,d]);b=n.sub(h.scalproduct(c,c),b);b=t._helper.buildConicMatrix([a[2],n.zero,a[2],a[0],a[1],b]);return h.normalizeMax(b)};t.Compass={};t.Compass.kind="C";t.Compass.signature=["P","P","P"];t.Compass.updatePosition=function(a){var b=E.csnames[a.args[0]].homog;let c=E.csnames[a.args[1]].homog;var d=E.csnames[a.args[2]].homog;const f=b.value[2],k=c.value[2],m=d.value[2];b=h.scalmult(n.mult(k,m),b);c=h.scalmult(n.mult(f,m),c);d=h.scalmult(n.mult(f,
k),d);b=h.sub(c,b);d=t._helper.ScaledCircleMrr(d,h.scalproduct(b,b));a.matrix=G.withUsage(d,"Circle")};t._helper.getConicType=function(a){if(1E-16>n.abs(h.det(a)).value.real)return"degenerate";let b=n.mult(a.value[0].value[0],a.value[1].value[1]);b=n.sub(b,n.pow(a.value[0].value[1],n.real(2)));b=b.value.real;return 1E-16>Math.abs(b)?"parabola":1E-16<b?"ellipsoid":"hyperbola"};t._helper.ConicBy5=function(a,b,c,d,f,k){a=h.turnIntoCSList([h.cross(c,d)]);const m=h.turnIntoCSList([h.cross(b,f)]);b=h.turnIntoCSList([h.cross(b,
c)]);d=h.turnIntoCSList([h.cross(d,f)]);return t._helper.conicFromTwoDegenerates(a,m,b,d,k)};t._helper.conicFromTwoDegenerates=function(a,b,c,d,f){a=G.mult(h.transpose(b),a);c=G.mult(h.transpose(d),c);a=h.add(a,h.transpose(a));c=h.add(c,h.transpose(c));d=G.mult(G.mult(f,a),f);f=G.mult(G.mult(f,c),f);c=G.mult(d,c);f=G.mult(f,a);return h.sub(c,f)};t.ConicBy5={};t.ConicBy5.kind="C";t.ConicBy5.signature=["P","P","P","P","P"];t.ConicBy5.updatePosition=function(a){const b=t._helper.ConicBy5(a,E.csnames[a.args[0]].homog,
E.csnames[a.args[1]].homog,E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[4]].homog);a.matrix=b;a.matrix=h.normalizeMax(a.matrix);a.matrix=G.withUsage(a.matrix,"Conic")};t.FreeConic={};t.FreeConic.kind="C";t.FreeConic.signature=[];t.FreeConic.initialize=function(a){let b;b=a.pos?t._helper.inputConic(a.pos):h.zeromatrix(n.real(3),n.real(3));t.FreeConic.putParamToState(a,b)};t.FreeConic.getParamForInput=function(a,b,c){return h.normalizeMax(b)};t.FreeConic.getParamFromState=
function(a){return t._helper.buildConicMatrix(ab(6).value)};t.FreeConic.putParamToState=function(a,b){for(a=0;3>a;++a)for(let c=0;c<=a;++c)xc(b.value[a].value[c])};t.FreeConic.updatePosition=function(a){const b=ab(6);Sa(b);a.matrix=t._helper.buildConicMatrix(b.value);a.matrix=h.normalizeMax(a.matrix);a.matrix=G.withUsage(a.matrix,"Conic")};t.FreeConic.set_matrix=function(a,b){h._helper.isNumberMatrixMN(b,3,3)&&Rb(a,h.add(b,h.transpose(b)),"matrix")};t.FreeConic.stateSize=12;t._helper.buildConicMatrix=
function(a){const b=a[1],c=a[2],d=a[3],f=a[4],k=a[5];return h.turnIntoCSList([h.turnIntoCSList([a[0],b,d]),h.turnIntoCSList([b,c,f]),h.turnIntoCSList([d,f,k])])};t._helper.flattenConicMatrix=function(a){return h.turnIntoCSList([a.value[0].value[0],a.value[0].value[1],a.value[1].value[1],a.value[0].value[2],a.value[1].value[2],a.value[2].value[2]])};t._helper.splitDegenConic=function(a){var b=h.adjoint3(a),c=0,d,f=n.abs2(b.value[0].value[0]).value.real;for(d=1;3>d;d++){var k=n.abs2(b.value[d].value[d]).value.real;
k>f&&(c=d,f=k)}d=n.sqrt(n.mult(n.real(-1),b.value[c].value[c]));if(1E-16>n.abs2(d).value.real)return a=h.turnIntoCSList([n.zero,n.zero,n.zero]),[a,a];c=n.real(c+1);k=h.column(b,c);k=h.scaldiv(d,k);d=k.value[0];f=k.value[1];k=k.value[2];d=h.turnIntoCSList([h.turnIntoCSList([n.real(0),k,n.mult(n.real(-1),f)]),h.turnIntoCSList([n.mult(n.real(-1),k),n.real(0),d]),h.turnIntoCSList([f,n.mult(n.real(-1),d),n.real(0)])]);a=h.add(a,d);let m=0;for(d=f=b=0;3>d;d++)for(c=0;3>c;c++)k=n.abs2(a.value[d].value[c]).value.real,
k>f&&(m=d,b=c,f=k);d=a.value[m];a=h.transpose(a);a=a.value[b];d=h.normalizeMax(d);a=h.normalizeMax(a);d=G.withUsage(d,"Line");a=G.withUsage(a,"Line");return[d,a]};t._helper.inputConic=function(a){const b="xx xy yy xz yz zz".split(" ").map(function(c){let d=n._helper.input(a[c]);c[0]!==c[1]&&(d=n.realmult(.5,d));return d});return t._helper.buildConicMatrix(b)};t.SelectConic={};t.SelectConic.kind="C";t.SelectConic.signature=["Cs"];t.SelectConic.initialize=function(a){if(void 0!==a.index)return a.index-
1;const b=t._helper.inputConic(a.pos);a=E.csnames[a.args[0]].results;let c=h.conicDist(b,a[0]),d=0;for(let f=1;f<a.length;++f){const k=h.conicDist(b,a[f]);k<c&&(c=k,d=f)}return d};t.SelectConic.updatePosition=function(a){a.matrix=E.csnames[a.args[0]].results[a.param];a.matrix=h.normalizeMax(a.matrix);a.matrix=G.withUsage(a.matrix,"Conic")};t._helper.ConicBy4p1l=function(a,b,c,d,f,k){var m=h.scalproduct(b,k),p=h.scalproduct(c,k),u=h.scalproduct(d,k);const x=h.scalproduct(f,k),y=h.det3(c,d,f),C=h.det3(b,
c,f),F=h.det3(b,d,f),H=h.det3(b,c,d),Q=n.mult;p=n.sqrt(Q(Q(p,x),Q(y,C)));m=n.sqrt(Q(Q(m,u),Q(F,H)));u=h.cross(h.cross(b,d),k);k=h.cross(h.cross(c,f),k);u=h.scalmult(p,u);m=h.scalmult(m,k);k=h.normalizeMax(h.add(u,m));m=h.normalizeMax(h.sub(u,m));m=hc(k,m);k=t._helper.ConicBy5(a,b,c,d,f,m.value[0]);a=t._helper.ConicBy5(a,b,c,d,f,m.value[1]);return[h.normalizeMax(k),h.normalizeMax(a)]};t.ConicBy4p1l={};t.ConicBy4p1l.kind="Cs";t.ConicBy4p1l.signature=["P","P","P","P","L"];t.ConicBy4p1l.updatePosition=
function(a){const b=t._helper.ConicBy4p1l(a,E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog,E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[4]].homog);a.results=b};t.ConicBy4p1l.stateSize=hc.stateSize;t._helper.ConicBy3p2l=function(a,b,c,d,f){function k(U,pa,ca,Ba){return n.sub(n.mult(U,Ba),n.mult(pa,ca))}var m=h.cross(a,b),p=h.cross(d,f);d=h.cross(d,m);f=h.cross(f,m);m=h.turnIntoCSList([d,f,p]);c=h.productVM(c,h.adjoint3(m));p=h.adjoint3(h.turnIntoCSList([h.scalmult(c.value[0],
d),h.scalmult(c.value[1],f),h.scalmult(c.value[2],p)]));c=h.transpose(p);d=n.mult;f=h.productMV(c,a);a=f.value[0];f=f.value[1];m=h.productMV(c,b);b=m.value[0];m=m.value[1];const u=n.sqrt(d(a,f)),x=n.sqrt(d(b,m));let y;const C=Array(4);for(y=0;4>y;++y){var F=(y&2)-1,H=d(n.real(((y&1)<<1)-1),u),Q=d(n.real(F),x),T=k(f,H,m,Q),X=k(b,Q,a,H);F=k(a,f,b,m);const U=n.add(n.add(k(b,m,a,f),k(m,Q,f,H)),k(Q,b,H,a));H=d(T,T);Q=d(X,X);const pa=d(U,U);let ca=d(T,X);T=d(T,U);X=d(X,U);ca=n.sub(ca,d(n.real(.5),d(F,F)));
F=h.turnIntoCSList([h.turnIntoCSList([H,ca,T]),h.turnIntoCSList([ca,Q,X]),h.turnIntoCSList([T,X,pa])]);F=h.productMM(p,h.productMM(F,c));F=h.turnIntoCSList([F.value[0].value[0],F.value[0].value[1],F.value[0].value[2],F.value[1].value[1],F.value[1].value[2],F.value[2].value[2]]);C[y]=F}return C};t.ConicBy3p2l={};t.ConicBy3p2l.kind="Cs";t.ConicBy3p2l.signature=["P","P","P","L","L"];t.ConicBy3p2l.updatePosition=function(a){let b=t._helper.ConicBy3p2l(E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog,
E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[4]].homog);b=Qe(b);const c=Array(4);for(let d=0;4>d;++d){const f=b[d].value;c[d]=h.turnIntoCSList([h.turnIntoCSList([f[0],f[1],f[2]]),h.turnIntoCSList([f[1],f[3],f[4]]),h.turnIntoCSList([f[2],f[4],f[5]])])}a.results=c};t.ConicBy3p2l.stateSize=48;t.ConicBy2p3l={};t.ConicBy2p3l.kind="Cs";t.ConicBy2p3l.signature=["P","P","L","L","L"];t.ConicBy2p3l.updatePosition=function(a){let b=t._helper.ConicBy3p2l(E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog,
E.csnames[a.args[4]].homog,E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog);b=Qe(b);const c=Array(4);for(let f=0;4>f;++f){var d=b[f].value;d=h.turnIntoCSList([h.turnIntoCSList([d[0],d[1],d[2]]),h.turnIntoCSList([d[1],d[3],d[4]]),h.turnIntoCSList([d[2],d[4],d[5]])]);c[f]=h.normalizeMax(h.adjoint3(d))}a.results=c};t.ConicBy2p3l.stateSize=48;t.ConicBy1p4l={};t.ConicBy1p4l.kind="Cs";t.ConicBy1p4l.signature=["P","L","L","L","L"];t.ConicBy1p4l.updatePosition=function(a){var b=t._helper.ConicBy4p1l(a,
E.csnames[a.args[1]].homog,E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[4]].homog,E.csnames[a.args[0]].homog);let c=b[0];b=b[1];c=h.adjoint3(c);b=h.adjoint3(b);b=[c,b];a.results=b};t.ConicBy1p4l.stateSize=hc.stateSize;t.ConicParabolaPL={};t.ConicParabolaPL.kind="C";t.ConicParabolaPL.signature=["P","L"];t.ConicParabolaPL.updatePosition=function(a){var b=E.csnames[a.args[0]].homog.value,c=E.csnames[a.args[1]].homog.value,d=n.mult,f=n.neg;const k=n.add,m=n.sub,p=b[0],u=b[1];
var x=b[2],y=c[0];b=c[1];c=c[2];const C=d(x,x);var F=d(y,y),H=d(b,b);const Q=d(x,c),T=f(x);x=k(F,H);H=d(C,H);F=d(C,F);f=d(f(C),d(y,b));y=d(T,k(d(p,x),d(Q,y)));b=d(T,k(d(u,x),d(Q,b)));d=m(d(k(d(p,p),d(u,u)),x),d(C,d(c,c)));d=t._helper.buildConicMatrix([H,f,F,y,b,d]);d=h.normalizeMax(d);a.matrix=G.withUsage(d,"Conic")};t.ConicBy2Foci1P={};t.ConicBy2Foci1P.kind="Cs";t.ConicBy2Foci1P.signature=["P","P","P"];t.ConicBy2Foci1P.updatePosition=function(a){var b=E.csnames[a.args[0]].homog;const c=E.csnames[a.args[1]].homog;
var d=E.csnames[a.args[2]].homog,f=h.ii,k=h.jj,m=h.normalizeMax(h.cross(b,d)),p=h.normalizeMax(h.cross(c,d)),u=h.normalizeMax(h.cross(d,f));d=h.normalizeMax(h.cross(d,k));p=t._helper.coHarmonic(u,d,m,p);m=h.normalizeMax(p[0]);p=h.normalizeMax(p[1]);f=h.turnIntoCSList([f]);u=h.turnIntoCSList([k]);d=h.turnIntoCSList([b]);const x=h.turnIntoCSList([c]);k=t._helper.conicFromTwoDegenerates(f,u,d,x,m);k=h.normalizeMax(k);f=t._helper.conicFromTwoDegenerates(f,u,d,x,p);f=h.normalizeMax(f);k=h.normalizeMax(h.adjoint3(k));
f=h.normalizeMax(h.adjoint3(f));"ellipsoid"!==t._helper.getConicType(k)&&(m=k,k=f,f=m);h.almostequals(b,c).value&&(b=n.real(3),f=h.zeromatrix(b,b));a.results=[k,f]};t.ConicBy2Pol1P={};t.ConicBy2Pol1P.kind="C";t.ConicBy2Pol1P.signature=["P","L","P","L","P"];t.ConicBy2Pol1P.updatePosition=function(a){var b=E.csnames[a.args[0]].homog,c=E.csnames[a.args[1]].homog,d=E.csnames[a.args[2]].homog;const f=E.csnames[a.args[3]].homog;var k=E.csnames[a.args[4]].homog;const m=h.scalproduct,p=h.scalmult,u=h.sub;
var x=h.productMM;const y=n.realmult,C=h.transpose;var F=h.turnIntoCSList;const H=u(p(m(c,b),k),p(y(2,m(c,k)),b));var Q=u(p(m(f,d),k),p(y(2,m(f,k)),d));const T=F([h.cross(b,k)]);k=F([h.cross(d,k)]);Q=x(C(T),F([h.cross(b,Q)]));F=x(C(k),F([h.cross(d,H)]));x=x(C(T),k);b=m(b,f);c=m(d,c);d=h.add(p(c,Q),p(b,F));d=u(d,p(y(2,n.mult(b,c)),x));d=h.add(d,C(d));d=h.normalizeMax(d);d=G.withUsage(d,"Conic");a.matrix=d};t.ConicBy2Pol1L={};t.ConicBy2Pol1L.kind="C";t.ConicBy2Pol1L.signature=["P","L","P","L","L"];
t.ConicBy2Pol1L.updatePosition=function(a){var b=E.csnames[a.args[0]].homog;const c=E.csnames[a.args[1]].homog,d=E.csnames[a.args[2]].homog,f=E.csnames[a.args[3]].homog,k=E.csnames[a.args[4]].homog;var m=h.scalproduct;const p=h.scalmult,u=h.productMM,x=n.mult,y=h.transpose,C=h.turnIntoCSList,F=m(c,b),H=m(c,d),Q=m(f,b),T=m(f,d),X=m(k,b);m=m(k,d);const U=C([h.sub(p(x(Q,m),c),p(x(H,X),f))]);b=h.add(u(y(C([p(x(Q,H),k)])),C([h.sub(h.add(p(n.sub(x(F,m),x(H,X)),f),p(n.sub(x(T,X),x(Q,m)),c)),p(h.det3(c,f,
k),h.cross(b,d)))])),u(y(U),U));b=h.add(b,y(b));b=h.normalizeMax(b);b=G.withUsage(b,"Conic");a.matrix=b};t._helper.conic1Pol3Inc=function(a,b,c,d,f){const k=h.scalproduct,m=h.scalmult,p=h.productMM;var u=h.cross;const x=n.realmult,y=n.mult,C=h.transpose,F=h.turnIntoCSList,H=h.det3,Q=H(a,c,d);var T=F([u(c,f)]);const X=F([u(a,f)]),U=F([u(c,d)]),pa=k(b,a),ca=k(b,c);b=k(b,f);u=F([u(d,h.sub(m(pa,f),m(x(2,b),a)))]);T=m(Q,p(C(T),u));a=x(2,n.add(y(H(a,d,f),ca),y(Q,b)));a=n.sub(y(H(c,d,f),pa),a);T=h.add(T,
m(a,p(C(X),U)));T=h.add(T,C(T));return T=h.normalizeMax(T)};t.ConicBy1Pol3P={};t.ConicBy1Pol3P.kind="C";t.ConicBy1Pol3P.signature=["P","L","P","P","P"];t.ConicBy1Pol3P.updatePosition=function(a){let b=t._helper.conic1Pol3Inc(E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog,E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[4]].homog);b=G.withUsage(b,"Conic");a.matrix=b};t.ConicBy1Pol3L={};t.ConicBy1Pol3L.kind="C";t.ConicBy1Pol3L.signature=["P","L","L","L","L"];t.ConicBy1Pol3L.updatePosition=
function(a){let b=t._helper.conic1Pol3Inc(E.csnames[a.args[1]].homog,E.csnames[a.args[0]].homog,E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[4]].homog);b=h.normalizeMax(h.adjoint3(b));b=G.withUsage(b,"Conic");a.matrix=b};t.ConicBy1Pol2P1L={};t.ConicBy1Pol2P1L.kind="Cs";t.ConicBy1Pol2P1L.signature=["P","L","P","P","L"];t.ConicBy1Pol2P1L.updatePosition=function(a){var b=E.csnames[a.args[0]].homog,c=E.csnames[a.args[1]].homog,d=E.csnames[a.args[2]].homog,f=E.csnames[a.args[3]].homog,
k=E.csnames[a.args[4]].homog,m=n.add,p=h.turnIntoCSList;const u=h.cross;var x=h.productMM,y=n.mult,C=n.realmult;const F=h.scalmult;var H=h.scalproduct;const Q=n.sub,T=h.transpose,X=H(c,b),U=H(c,d),pa=H(c,f);c=H(k,b);const ca=H(k,d);H=H(k,f);k=p([u(b,d)]);b=p([u(b,f)]);d=p([u(d,f)]);f=n.sqrt(y(y(ca,H),y(Q(y(X,ca),C(2,y(c,U))),Q(y(X,H),C(2,y(c,pa))))));p=x(T(k),b);f=F(f,h.add(p,T(p)));m=F(Q(y(X,y(ca,H)),m(y(c,y(U,H)),y(c,y(ca,pa)))),p);C=h.add(h.sub(F(pa,k),F(U,b)),F(C(.5,X),d));m=h.add(m,F(y(c,c),
x(T(d),C)));m=h.add(m,T(m));x=h.normalizeMax(h.add(f,m));y=h.normalizeMax(h.sub(f,m));a.results=qd(x,y).value};t.ConicBy1Pol2P1L.stateSize=qd.stateSize;t.ConicBy1Pol1P2L={};t.ConicBy1Pol1P2L.kind="Cs";t.ConicBy1Pol1P2L.signature=["P","L","P","L","L"];t.ConicBy1Pol1P2L.updatePosition=function(a){var b=E.csnames[a.args[0]].homog,c=E.csnames[a.args[1]].homog;const d=E.csnames[a.args[2]].homog;var f=E.csnames[a.args[3]].homog,k=E.csnames[a.args[4]].homog;const m=n.add,p=h.turnIntoCSList,u=h.cross,x=h.productMM,
y=n.mult,C=n.realmult,F=h.scalmult;var H=h.scalproduct;const Q=n.sub,T=h.transpose,X=H(c,b),U=H(c,d),pa=H(f,b),ca=H(f,d),Ba=H(k,b),Pa=H(k,d),ta=y(X,X),Ka=y(X,U);H=y(U,U);const Xa=y(pa,pa),Ta=y(pa,ca),La=y(ca,ca),Oa=y(Ba,Ba);var eb=y(Ba,Pa),ka=y(Pa,Pa),xa=y(y(ta,La),ka);xa=Q(xa,C(2,y(y(Ka,Ta),ka)));xa=Q(xa,C(2,y(y(Ka,La),eb)));xa=m(xa,C(.5,y(y(H,Xa),ka)));xa=m(xa,C(3,y(y(H,Ta),eb)));xa=m(xa,C(.5,y(y(H,La),Oa)));eb=y(y(X,ca),Pa);eb=Q(eb,y(y(U,pa),Pa));eb=Q(eb,y(y(U,ca),Ba));eb=y(eb,y(H,Ba));ka=Q(y(X,
ca),C(2,y(U,pa)));ka=y(ka,y(H,y(ca,Ba)));xa=x(T(p([c])),p([h.add(h.add(F(xa,c),F(eb,f)),F(ka,k))]));eb=p([f]);xa=h.add(xa,F(C(.5,y(y(H,H),Oa)),x(T(eb),eb)));xa=h.add(xa,F(H,x(T(p([k])),p([h.add(F(Q(Q(C(2,y(Ka,Ta)),y(ta,La)),C(.5,y(H,Xa))),k),F(y(h.det3(c,f,k),Q(y(X,ca),y(U,pa))),u(b,d)))]))));xa=h.add(xa,T(xa));b=n.sqrt(y(y(ca,Pa),y(Q(y(X,ca),C(2,y(U,pa))),Q(y(X,Pa),C(2,y(U,Ba))))));c=x(T(p([c])),p([h.sub(F(Q(y(U,m(y(pa,Pa),y(ca,Ba))),y(X,y(ca,Pa))),c),F(H,h.add(F(Ba,f),F(pa,k))))]));c=h.add(c,F(y(X,
H),x(T(p([f])),p([k]))));c=F(b,c);c=h.add(c,T(c));f=h.normalizeMax(h.add(xa,c));k=h.normalizeMax(h.sub(xa,c));a.results=qd(f,k).value};t.ConicBy1Pol1P2L.stateSize=qd.stateSize;t._helper.coHarmonic=function(a,b,c,d){const f=h.realVector([100*Math.random(),100*Math.random(),1]);var k=h.det3(f,c,a);const m=h.det3(f,c,b);c=h.det3(f,d,a);d=h.det3(f,d,b);d=n.sqrt(n.mult(d,m));k=n.sqrt(n.mult(c,k));a=G.mult(a,d);k=G.mult(b,k);b=h.add(a,k);a=h.sub(a,k);return[b,a]};t.ConicInSquare={};t.ConicInSquare.kind=
"C";t.ConicInSquare.signature=["P","P","P","P"];t.ConicInSquare.updatePosition=function(a){var b=A.basismap(E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog,E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog),c=n.one;c=t._helper.buildConicMatrix([c,c,c,n.real(-3),c,c]);b=h.adjoint3(b);b=h.productMM(h.productMM(h.transpose(b),c),b);b=h.normalizeMax(b);a.matrix=G.withUsage(b,"Conic")};t.ConicBy5lines={};t.ConicBy5lines.kind="C";t.ConicBy5lines.signature=["L","L","L","L","L"];t.ConicBy5lines.updatePosition=
function(a){var b=t._helper.ConicBy5(a,E.csnames[a.args[0]].homog,E.csnames[a.args[1]].homog,E.csnames[a.args[2]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[4]].homog);b=h.adjoint3(b);a.matrix=b;a.matrix=h.normalizeMax(a.matrix);a.matrix=G.withUsage(a.matrix,"Conic")};t.ConicFromPrincipalDirections={};t.ConicFromPrincipalDirections.kind="C";t.ConicFromPrincipalDirections.signature=["P","P","P"];t.ConicFromPrincipalDirections.updatePosition=function(a){var b=E.csnames[a.args[0]].homog,c=E.csnames[a.args[1]].homog;
const d=E.csnames[a.args[2]].homog;var f=t._helper.pointReflection(b,c),k=h.cross(c,b);b=h.turnIntoCSList([k.value[0],k.value[1],n.zero]);k=h.turnIntoCSList([k]);c=h.turnIntoCSList([h.cross(c,b)]);f=h.turnIntoCSList([h.cross(f,b)]);a.matrix=t._helper.conicFromTwoDegenerates(k,k,c,f,d);a.matrix=h.normalizeMax(a.matrix);a.matrix=G.withUsage(a.matrix,"Conic")};t.CircleBy3={};t.CircleBy3.kind="C";t.CircleBy3.signature=["P","P","P"];t.CircleBy3.updatePosition=function(a){const b=t._helper.ConicBy5(a,E.csnames[a.args[0]].homog,
E.csnames[a.args[1]].homog,h.ii,h.jj,E.csnames[a.args[2]].homog);a.matrix=h.normalizeMax(b);a.matrix=G.withUsage(a.matrix,"Circle")};t.ArcBy3={};t.ArcBy3.kind="C";t.ArcBy3.signature=["P","P","P"];t.ArcBy3.updatePosition=function(a){t.CircleBy3.updatePosition(a);a.startPoint=E.csnames[a.args[0]].homog;a.viaPoint=E.csnames[a.args[1]].homog;a.endPoint=E.csnames[a.args[2]].homog};t.ArcBy3.initialize=function(a){a.startPoint=E.csnames[a.args[0]].homog;a.viaPoint=E.csnames[a.args[1]].homog;a.endPoint=E.csnames[a.args[2]].homog;
a.isArc=!0};t.PolarOfPoint={};t.PolarOfPoint.kind="L";t.PolarOfPoint.signature=["P","C"];t.PolarOfPoint.updatePosition=function(a){let b=G.mult(E.csnames[a.args[1]].matrix,E.csnames[a.args[0]].homog);b=h.normalizeMax(b);a.homog=G.withUsage(b,"Line")};t.PolarOfLine={};t.PolarOfLine.kind="P";t.PolarOfLine.signature=["L","C"];t.PolarOfLine.updatePosition=function(a){var b=E.csnames[a.args[0]];const c=h.adjoint3(E.csnames[a.args[1]].matrix);b=G.mult(c,b.homog);b=h.normalizeMax(b);a.homog=G.withUsage(b,
"Point")};t.AngleBisector={};t.AngleBisector.kind="Ls";t.AngleBisector.signature=["L","L","P"];t.AngleBisector.updatePosition=function(a){var b=E.csnames[a.args[0]].homog;const c=E.csnames[a.args[1]].homog,d=E.csnames[a.args[2]].homog;var f=h.add,k=h.sub;const m=h.abs,p=h.cross,u=h.scalmult,x=h.normalizeMax,y=h._helper.isAlmostZero,C=h.linfty,F=u(m(p(p(C,c),C)),b);b=u(m(p(p(C,b),C)),c);k=k(F,b);f=f(F,b);y(k)&&(k=p(p(p(C,f),C),d));y(f)&&(f=p(p(p(C,k),C),d));a.results=hc(x(k),x(f))};t.AngleBisector.stateSize=
hc.stateSize;t._helper.IntersectLC=function(a,b){var c=n,d=h.crossOperator(a),f=h.transpose(d);b=G.mult(f,G.mult(b,d));f=h.maxIndex(a,n.abs2);let k,m,p;0===f?(f=b.value[1].value[1],k=b.value[1].value[2],m=b.value[2].value[1],p=b.value[2].value[2],a=a.value[0]):1===f?(f=b.value[0].value[0],k=b.value[0].value[2],m=b.value[2].value[0],p=b.value[2].value[2],a=a.value[1]):(f=b.value[0].value[0],k=b.value[0].value[1],m=b.value[1].value[0],p=b.value[1].value[1],a=a.value[2]);c=c.div(c.sqrt(c.sub(c.mult(k,
m),c.mult(f,p))),a);c=h.add(b,h.scalmult(c,d));f=h.maxIndex(c,h.abs2);d=c.value[f];d=h.normalizeMax(d);d=G.withUsage(d,"Point");c=h.transpose(c);f=h.maxIndex(c,h.abs2);c=c.value[f];c=h.normalizeMax(c);c=G.withUsage(c,"Point");return[d,c]};t.IntersectLC={};t.IntersectLC.kind="Ps";t.IntersectLC.signature=["L","C"];t.IntersectLC.updatePosition=function(a){const b=t._helper.IntersectLC(E.csnames[a.args[0]].homog,E.csnames[a.args[1]].matrix);a.results=hc(b[0],b[1])};t.IntersectLC.stateSize=hc.stateSize;
t.OtherIntersectionCL={};t.OtherIntersectionCL.kind="P";t.OtherIntersectionCL.signature=["C","L","P"];t.OtherIntersectionCL.updatePosition=function(a){var b=E.csnames[a.args[2]].homog,c=t._helper.IntersectLC(E.csnames[a.args[1]].homog,E.csnames[a.args[0]].matrix);const d=c[0];c=c[1];const f=h.projectiveDistMinScal(d,b);b=h.projectiveDistMinScal(c,b);a.homog=f<b?c:d;a.homog=h.normalizeMax(a.homog);a.homog=G.withUsage(a.homog,"Point")};t.IntersectCirCir={};t.IntersectCirCir.kind="Ps";t.IntersectCirCir.signature=
["C","C"];t.IntersectCirCir.updatePosition=function(a){var b=E.csnames[a.args[0]].matrix,c=E.csnames[a.args[1]].matrix,d=h.scalmult(c.value[0].value[0],b.value[2]);c=h.scalmult(b.value[0].value[0],c.value[2]);d=h.sub(d,c);d=h.turnIntoCSList([d.value[0],d.value[1],n.realmult(.5,d.value[2])]);d=h.normalizeMax(d);b=t._helper.IntersectLC(d,b);a.results=hc(b[0],b[1])};t.IntersectCirCir.stateSize=hc.stateSize;t.OtherIntersectionCC={};t.OtherIntersectionCC.kind="P";t.OtherIntersectionCC.signature=["C","C",
"P"];t.OtherIntersectionCC.updatePosition=function(a){var b=E.csnames[a.args[0]].matrix,c=E.csnames[a.args[1]].matrix,d=E.csnames[a.args[2]].homog,f=h.scalmult(c.value[0].value[0],b.value[2]);c=h.scalmult(b.value[0].value[0],c.value[2]);f=h.sub(f,c);f=h.turnIntoCSList([f.value[0],f.value[1],n.realmult(.5,f.value[2])]);f=h.normalizeMax(f);f=t._helper.IntersectLC(f,b);b=f[0];f=f[1];c=h.projectiveDistMinScal(b,d);d=h.projectiveDistMinScal(f,d);a.homog=c<d?f:b;a.homog=h.normalizeMax(a.homog);a.homog=
G.withUsage(a.homog,"Point")};t._helper.IntersectConicConic=function(a,b){var c=a.value[0];const d=a.value[1],f=a.value[2];var k=b.value[0],m=b.value[1],p=b.value[2],u=h.det3(c,d,f),x=n.add(n.add(h.det3(c,d,p),h.det3(c,m,f)),h.det3(k,d,f));c=n.add(n.add(h.det3(c,m,p),h.det3(k,d,p)),h.det3(k,m,f));k=h.det3(k,m,p);p=n.abs2(u).value.real;m=n.abs2(k).value.real;p<m&&(p=a,a=b,b=p,p=k,k=u,u=p,p=c,c=x,x=p,p=m);1E-24>p?(u=a,x=b):(x=n.solveCubic(u,x,c,k),c=n.abs2(n.sub(x[0],x[1])).value.real,k=n.abs2(n.sub(x[0],
x[2])).value.real,m=n.abs2(n.sub(x[1],x[2])).value.real,c>k?(u=x[1],x=c>m?x[0]:x[2]):(u=x[2],x=k>m?x[0]:x[1]),u=h.add(h.scalmult(u,a),b),x=h.add(h.scalmult(x,a),b));b=t._helper.splitDegenConic(u);a=b[0];b=b[1];u=t._helper.splitDegenConic(x);c=u[0];x=u[1];u=h.cross(a,c);c=h.cross(b,c);a=h.cross(a,x);b=h.cross(b,x);u=h.normalizeMax(u);c=h.normalizeMax(c);a=h.normalizeMax(a);b=h.normalizeMax(b);u=G.withUsage(u,"Point");c=G.withUsage(c,"Point");a=G.withUsage(a,"Point");b=G.withUsage(b,"Point");return[u,
c,a,b]};t.IntersectConicConic={};t.IntersectConicConic.kind="Ps";t.IntersectConicConic.signature=["C","C"];t.IntersectConicConic.updatePosition=function(a){let b=t._helper.IntersectConicConic(E.csnames[a.args[0]].matrix,E.csnames[a.args[1]].matrix);b=ie(b[0],b[1],b[2],b[3]);a.results=b};t.IntersectConicConic.stateSize=ie.stateSize;t.SelectP={};t.SelectP.kind="P";t.SelectP.signature=["Ps"];t.SelectP.initialize=function(a){if(void 0!==a.index)return a.index-1;const b=E.csnames[a.args[0]].results.value;
a=t._helper.initializePoint(a);let c=h.projectiveDistMinScal(a,b[0]),d=0;for(let f=1;f<b.length;++f){const k=h.projectiveDistMinScal(a,b[f]);k<c&&(c=k,d=f)}return d};t.SelectP.updatePosition=function(a){a.homog=E.csnames[a.args[0]].results.value[a.param]};t.SelectL={};t.SelectL.kind="L";t.SelectL.signature=["Ls"];t.SelectL.initialize=function(a){if(void 0!==a.index)return a.index-1;const b=E.csnames[a.args[0]].results.value;a=t._helper.initializeLine(a);let c=h.projectiveDistMinScal(a,b[0]),d=0;for(let f=
1;f<b.length;++f){const k=h.projectiveDistMinScal(a,b[f]);k<c&&(c=k,d=f)}return d};t.SelectL.updatePosition=function(a){a.homog=E.csnames[a.args[0]].results.value[a.param];a.homog=G.withUsage(a.homog,"Line")};t._helper.moebiusStep=function(a,b,c){const d=n.add,f=n.sub,k=n.mult,m=a.value[0],p=a.value[1];a=a.value[2];const u=b.value[0],x=b.value[1];b=b.value[2];var y=c.value[0],C=c.value[1];const F=c.value[2];c=f(k(b,y),k(u,F));const H=f(k(b,C),k(x,F));y=f(k(m,F),k(a,y));C=f(k(p,F),k(a,C));return[f(k(m,
c),k(p,H)),d(k(p,c),k(m,H)),k(a,c),k(a,H),f(k(u,y),k(x,C)),d(k(x,y),k(u,C)),k(b,y),k(b,C)]};t.TrMoebius={};t.TrMoebius.kind="Mt";t.TrMoebius.signature="PPPPPP".split("");t.TrMoebius.updatePosition=function(a){var b=n.neg;const c=t._helper.moebiusStep(E.csnames[a.args[0]].homog,E.csnames[a.args[2]].homog,E.csnames[a.args[4]].homog);var d=t._helper.moebiusStep(E.csnames[a.args[1]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[5]].homog);d=h.normalizeMax(h.matrix([[d[0],b(d[1]),d[4],b(d[5])],[d[1],
d[0],d[5],d[4]],[d[2],b(d[3]),d[6],b(d[7])],[d[3],d[2],d[7],d[6]]]));b=h.normalizeMax(h.matrix([[c[6],b(c[4])],[c[7],b(c[5])],[b(c[2]),c[0]],[b(c[3]),c[1]]]));b=h.normalizeMax(h.productMM(d,b));a.moebius={anti:!1,ar:b.value[0].value[0],ai:b.value[1].value[0],br:b.value[0].value[1],bi:b.value[1].value[1],cr:b.value[2].value[0],ci:b.value[3].value[0],dr:b.value[2].value[1],di:b.value[3].value[1]};t._helper.moebiusPair(a)};t._helper.moebiusPair=function(a){var b=a.moebius;const c=n.neg,d=b.anti?c:G.identity;
b=h.normalizeMax(h.turnIntoCSList([h.matrix([[c(b.cr),d(b.ci),c(b.dr)],[b.ci,d(b.cr),b.di],[b.ar,c(d(b.ai)),b.br]]),h.matrix([[c(b.ci),c(d(b.cr)),c(b.di)],[c(b.cr),d(b.ci),c(b.dr)],[b.ai,d(b.ar),b.bi]])]));a.mat1=b.value[0];a.mat2=b.value[1]};t._helper.inverseMoebius=function(a){const b=n.neg,c=a.anti?b:G.identity;return{anti:a.anti,ar:a.dr,ai:c(a.di),br:b(a.br),bi:b(c(a.bi)),cr:b(a.cr),ci:b(c(a.ci)),dr:a.ar,di:c(a.ai)}};t.TrInverseMoebius={};t.TrInverseMoebius.kind="Mt";t.TrInverseMoebius.signature=
["Mt"];t.TrInverseMoebius.updatePosition=function(a){a.moebius=t._helper.inverseMoebius(E.csnames[a.args[0]].moebius);t._helper.moebiusPair(a)};t.TrMoebiusP={};t.TrMoebiusP.kind="P";t.TrMoebiusP.signature=["Mt","P"];t.TrMoebiusP.updatePosition=function(a){var b=E.csnames[a.args[0]];const c=E.csnames[a.args[1]].homog,d=h.productMV(b.mat1,c);b=h.productMV(b.mat2,c);a.homog=h.normalizeMax(h.cross(d,b));a.homog=G.withUsage(a.homog,"Point")};t._helper.TrMoebiusP=function(a,b){const c=h.productMV(b.mat1,
a);a=h.productMV(b.mat2,a);return h.normalizeMax(h.cross(c,a))};t.TrMoebiusL={};t.TrMoebiusL.kind="C";t.TrMoebiusL.signature=["Mt","L"];t.TrMoebiusL.updatePosition=function(a){var b=E.csnames[a.args[0]],c=E.csnames[a.args[1]].homog;const d=function(){const m=h.realVector([Math.random()-.5,Math.random()-.5,Math.random()-.5]);return h.normalizeMax(m)};var f=h.cross(d(),c),k=h.cross(d(),c);c=h.cross(d(),c);f=t._helper.TrMoebiusP(f,b);k=t._helper.TrMoebiusP(k,b);b=t._helper.TrMoebiusP(c,b);a.matrix=h.normalizeMax(t._helper.ConicBy5(null,
f,k,b,h.ii,h.jj));a.matrix=G.withUsage(a.matrix,"Circle")};t.TrMoebiusS={};t.TrMoebiusS.kind="C";t.TrMoebiusS.signature=["Mt","S"];t.TrMoebiusS.updatePosition=function(a){var b=E.csnames[a.args[0]],c=E.csnames[a.args[1]],d=c.startpos;c=c.endpos;var f=h.add(d,c);d=t._helper.TrMoebiusP(d,b);f=t._helper.TrMoebiusP(f,b);b=t._helper.TrMoebiusP(c,b);a.startPoint=d;a.viaPoint=f;a.endPoint=b;a.isArc=!0;a.matrix=h.normalizeMax(t._helper.ConicBy5(null,d,f,b,h.ii,h.jj));a.matrix=G.withUsage(a.matrix,"Circle")};
t.TrMoebiusC={};t.TrMoebiusC.kind="C";t.TrMoebiusC.signature=["Mt","C"];t.TrMoebiusC.signatureConstraints=function(a){return"Circle"===E.csnames[a.args[1]].matrix.usage};t.TrMoebiusC.updatePosition=function(a){var b=E.csnames[a.args[0]],c=E.csnames[a.args[1]].matrix,d=function(){const k=h.realVector([Math.random()-.5,Math.random()-.5,Math.random()-.5]);return h.normalizeMax(k)},f=t._helper.IntersectLC(d(),c);d=t._helper.IntersectLC(d(),c);c=f[1];d=d[1];f=t._helper.TrMoebiusP(f[0],b);c=t._helper.TrMoebiusP(c,
b);b=t._helper.TrMoebiusP(d,b);a.matrix=h.normalizeMax(t._helper.ConicBy5(null,f,c,b,h.ii,h.jj));a.matrix=G.withUsage(a.matrix,"Circle")};t.TrMoebiusArc={};t.TrMoebiusArc.kind="C";t.TrMoebiusArc.signature=["Mt","C"];t.TrMoebiusArc.signatureConstraints=function(a){return E.csnames[a.args[1]].isArc};t.TrMoebiusArc.updatePosition=function(a){var b=E.csnames[a.args[0]],c=E.csnames[a.args[1]],d=c.viaPoint;const f=c.endPoint;c=t._helper.TrMoebiusP(c.startPoint,b);d=t._helper.TrMoebiusP(d,b);b=t._helper.TrMoebiusP(f,
b);a.startPoint=c;a.viaPoint=d;a.endPoint=b;a.isArc=!0;a.matrix=h.normalizeMax(t._helper.ConicBy5(null,c,d,b,h.ii,h.jj));a.matrix=G.withUsage(a.matrix,"Circle")};t._helper.trBuildMatrix=function(a,b){const c=b(0);b=b(1);let d=h.productMM(b,h.adjoint3(c));a.matrix=h.normalizeMax(d);d=h.transpose(h.productMM(c,h.adjoint3(b)));a.dualMatrix=h.normalizeMax(d)};t.TrProjection={};t.TrProjection.kind="Tr";t.TrProjection.signature="PPPPPPPP".split("");t.TrProjection.initialize=function(a){a.isEuclidean=0};
t.TrProjection.updatePosition=function(a){t._helper.trBuildMatrix(a,function(b){return A.basismap(E.csnames[a.args[0+b]].homog,E.csnames[a.args[2+b]].homog,E.csnames[a.args[4+b]].homog,E.csnames[a.args[6+b]].homog)})};t.TrAffine={};t.TrAffine.kind="Tr";t.TrAffine.signature="PPPPPP".split("");t.TrAffine.initialize=function(a){a.isEuclidean=0};t.TrAffine.updatePosition=function(a){const b=n.mult,c=h.scalmult,d=h.turnIntoCSList;var f=h.transpose;const k=h.normalizeMax,m=h.productMM,p=h.adjoint3,u=d([E.csnames[a.args[0]].homog,
E.csnames[a.args[2]].homog,E.csnames[a.args[4]].homog]),x=d([E.csnames[a.args[1]].homog,E.csnames[a.args[3]].homog,E.csnames[a.args[5]].homog]);var y=f(u);f=f(x);const C=y.value[2].value,F=f.value[2].value,H=[b(C[0],F[2]),b(C[1],F[0]),b(C[2],F[1])];y=p(y).value;a.matrix=k(m(f,d([c(b(H[0],F[1]),y[0]),c(b(H[1],F[2]),y[1]),c(b(H[2],F[0]),y[2])])));y=u.value;a.dualMatrix=k(m(p(x),d([c(b(C[2],H[1]),y[0]),c(b(C[0],H[2]),y[1]),c(b(C[1],H[0]),y[2])])))};t.TrSimilarity={};t.TrSimilarity.kind="Tr";t.TrSimilarity.signature=
["P","P","P","P"];t.TrSimilarity.initialize=function(a){a.isEuclidean=1};t.TrSimilarity.updatePosition=function(a){t._helper.trBuildMatrix(a,function(b){return A.basismap(E.csnames[a.args[0+b]].homog,E.csnames[a.args[2+b]].homog,h.ii,h.jj)})};t.TrTranslation={};t.TrTranslation.kind="Tr";t.TrTranslation.signature=["P","P"];t.TrTranslation.initialize=function(a){a.isEuclidean=1};t.TrTranslation.updatePosition=function(a){var b=E.csnames[a.args[0]].homog,c=E.csnames[a.args[1]].homog,d=h.cross(b,c).value;
b=n.mult(b.value[2],c.value[2]);c=h.turnIntoCSList;const f=n.neg,k=n.zero;d=c([c([b,k,d[1]]),c([k,b,f(d[0])]),c([k,k,b])]);d=h.normalizeMax(d);a.matrix=d;b=f(d.value[0].value[0]);d=c([c([b,k,k]),c([k,b,k]),c([d.value[0].value[2],d.value[1].value[2],b])]);a.dualMatrix=d};t.TrRotationPNumb={};t.TrRotationPNumb.kind="Tr";t.TrRotationPNumb.signature=["P","V"];t.TrRotationPNumb.updatePosition=function(a){var b=E.csnames[a.args[0]].homog.value,c=E.csnames[a.args[1]].value,d=n.mult;const f=n.add,k=n.sub,
m=h.turnIntoCSList,p=h.normalizeMax,u=n.zero;var x=b[0],y=b[1];b=b[2];var C=n.cos(c),F=n.sin(c),H=k(n.real(1),C);c=d(H,x);H=d(H,y);x=d(F,x);y=d(F,y);C=d(C,b);d=d(F,b);F=n.neg(d);a.matrix=p(m([m([C,F,f(c,y)]),m([d,C,k(H,x)]),m([u,u,b])]));a.dualMatrix=p(m([m([C,F,u]),m([d,C,u]),m([k(c,y),f(H,x),b])]))};t.TrReflectionP={};t.TrReflectionP.kind="Tr";t.TrReflectionP.signature=["P"];t.TrReflectionP.initialize=function(a){a.isEuclidean=1};t.TrReflectionP.updatePosition=function(a){var b=E.csnames[a.args[0]].homog.value;
const c=n.realmult(-.5,b[2]),d=n.zero;b=h.turnIntoCSList([h.turnIntoCSList([c,d,b[0]]),h.turnIntoCSList([d,c,b[1]]),h.turnIntoCSList([d,d,n.neg(c)])]);b=h.normalizeMax(b);a.matrix=b;a.dualMatrix=h.transpose(b)};t.TrReflectionL={};t.TrReflectionL.kind="Tr";t.TrReflectionL.signature=["L"];t.TrReflectionL.initialize=function(a){a.isEuclidean=-1};t.TrReflectionL.updatePosition=function(a){var b=n.mult;const c=n.realmult,d=n.zero;var f=E.csnames[a.args[0]].homog.value;const k=f[0],m=f[1];f=f[2];const p=
b(k,k),u=b(m,m),x=c(-.5,n.sub(p,u)),y=b(k,m);b=h.turnIntoCSList([h.turnIntoCSList([n.neg(x),y,b(k,f)]),h.turnIntoCSList([y,x,b(m,f)]),h.turnIntoCSList([d,d,c(-.5,n.add(p,u))])]);b=h.normalizeMax(b);a.matrix=b;a.dualMatrix=h.transpose(b)};t.TrReflectionS={};t.TrReflectionS.kind="Tr";t.TrReflectionS.signature=["S"];t.TrReflectionS.updatePosition=t.TrReflectionL.updatePosition;t.TrReflectionC={};t.TrReflectionC.kind="Mt";t.TrReflectionC.signature=["C"];t.TrReflectionC.signatureConstraints=function(a){return"Circle"===
E.csnames[a.args[0]].matrix.usage};t.TrReflectionC.updatePosition=function(a){const b=E.csnames[a.args[0]].matrix,c=b.value[0].value[2],d=b.value[1].value[2],f=n.neg;a.moebius={anti:!0,ar:c,ai:d,br:b.value[2].value[2],bi:n.zero,cr:f(b.value[0].value[0]),ci:n.zero,dr:f(c),di:d};t._helper.moebiusPair(a)};t.TrInverse={};t.TrInverse.kind="Tr";t.TrInverse.signature=["Tr"];t.TrInverse.initialize=function(a){a.isEuclidean=E.csnames[a.args[0]].isEuclidean};t.TrInverse.updatePosition=function(a){const b=E.csnames[a.args[0]];
a.dualMatrix=h.transpose(b.matrix);a.matrix=h.transpose(b.dualMatrix)};t.TransformC={};t.TransformC.kind="C";t.TransformC.signature=["Tr","C"];t.TransformC.updatePosition=function(a){var b=E.csnames[a.args[0]].dualMatrix;b=h.productMM(h.productMM(b,E.csnames[a.args[1]].matrix),h.transpose(b));b=h.normalizeMax(b);a.matrix=G.withUsage(b,"Conic")};t.TransformArc={};t.TransformArc.kind="C";t.TransformArc.signature=["Tr","C"];t.TransformArc.signatureConstraints=function(a){return E.csnames[a.args[0]].isArc};
t.TransformArc.updatePosition=function(a){var b=E.csnames[a.args[0]].matrix,c=E.csnames[a.args[1]],d=c.viaPoint;const f=c.endPoint;c=h.normalizeMax(h.productMV(b,c.startPoint));d=h.normalizeMax(h.productMV(b,d));b=h.normalizeMax(h.productMV(b,f));a.startPoint=c;a.viaPoint=d;a.endPoint=b;a.isArc=!0;a.matrix=h.normalizeMax(t._helper.ConicBy5(null,c,d,b,h.ii,h.jj));a.matrix=G.withUsage(a.matrix,"Circle")};t.TransformP={};t.TransformP.kind="P";t.TransformP.signature=["Tr","P"];t.TransformP.updatePosition=
function(a){a.homog=h.normalizeMax(h.productMV(E.csnames[a.args[0]].matrix,E.csnames[a.args[1]].homog));a.homog=G.withUsage(a.homog,"Point")};t.TransformL={};t.TransformL.kind="L";t.TransformL.signature=["Tr","L"];t.TransformL.updatePosition=function(a){a.homog=h.normalizeMax(h.productMV(E.csnames[a.args[0]].dualMatrix,E.csnames[a.args[1]].homog));a.homog=G.withUsage(a.homog,"Line")};t.TransformS={};t.TransformS.kind="S";t.TransformS.signature=["Tr","S"];t.TransformS.updatePosition=function(a){const b=
E.csnames[a.args[0]],c=E.csnames[a.args[1]];t.Segment.setSegmentPos(a,h.productMV(b.dualMatrix,c.homog),h.productMV(b.matrix,c.startpos),h.productMV(b.matrix,c.endpos))};t.TransformPolygon={};t.TransformPolygon.kind="Poly";t.TransformPolygon.signature=["Tr","Poly"];t.TransformPolygon.updatePosition=function(a){const b=E.csnames[a.args[0]].matrix;a.vertices=h.turnIntoCSList(E.csnames[a.args[1]].vertices.value.map(function(c){c=h.normalizeMax(h.productMV(b,c));return c=G.withUsage(c,"Point")}))};t.TrComposeTrTr=
{};t.TrComposeTrTr.kind="Tr";t.TrComposeTrTr.signature=["Tr","Tr"];t.TrComposeTrTr.initialize=function(a){a.isEuclidean=E.csnames[a.args[0]].isEuclidean*E.csnames[a.args[1]].isEuclidean};t.TrComposeTrTr.updatePosition=function(a){const b=E.csnames[a.args[0]],c=E.csnames[a.args[1]];a.matrix=h.normalizeMax(h.productMM(c.matrix,b.matrix));a.dualMatrix=h.normalizeMax(h.productMM(c.dualMatrix,b.dualMatrix))};t._helper.composeMtMt=function(a,b,c){function d(C,F,H,Q){return m(u(C,F),u(H,Q))}function f(C,
F,H,Q,T,X,U,pa){return m(d(C,F,H,Q),d(T,X,U,pa))}function k(C,F,H,Q,T,X,U,pa){return p(d(C,F,H,Q),d(T,X,U,pa))}const m=n.add,p=n.sub,u=n.mult;var x=c.anti?k:f;const y=c.anti?f:k;x=h.normalizeMax(h.turnIntoCSList([y(b.ar,c.ar,b.cr,c.br,b.ai,c.ai,b.ci,c.bi),x(b.ar,c.ai,b.cr,c.bi,b.ai,c.ar,b.ci,c.br),y(b.br,c.ar,b.dr,c.br,b.bi,c.ai,b.di,c.bi),x(b.br,c.ai,b.dr,c.bi,b.bi,c.ar,b.di,c.br),y(b.ar,c.cr,b.cr,c.dr,b.ai,c.ci,b.ci,c.di),x(b.ar,c.ci,b.cr,c.di,b.ai,c.cr,b.ci,c.dr),y(b.br,c.cr,b.dr,c.dr,b.bi,c.ci,
b.di,c.di),x(b.br,c.ci,b.dr,c.di,b.bi,c.cr,b.di,c.dr)])).value;a.moebius={anti:b.anti!==c.anti,ar:x[0],ai:x[1],br:x[2],bi:x[3],cr:x[4],ci:x[5],dr:x[6],di:x[7]};t._helper.moebiusPair(a)};t._helper.euc2moeb=function(a){const b=a.matrix.value;return{anti:0>a.isEuclidean,ar:b[0].value[0],ai:b[1].value[0],br:b[0].value[2],bi:b[1].value[2],cr:n.zero,ci:n.zero,dr:b[2].value[2],di:n.zero}};t.TrComposeMtMt={};t.TrComposeMtMt.kind="Mt";t.TrComposeMtMt.signature=["Mt","Mt"];t.TrComposeMtMt.updatePosition=function(a){t._helper.composeMtMt(a,
E.csnames[a.args[0]].moebius,E.csnames[a.args[1]].moebius)};t.TrComposeTrMt={};t.TrComposeTrMt.kind="Mt";t.TrComposeTrMt.signature=["Tr","Mt"];t.TrComposeTrMt.signatureConstraints=function(a){return!!E.csnames[a.args[0]].isEuclidean};t.TrComposeTrMt.updatePosition=function(a){t._helper.composeMtMt(a,t._helper.euc2moeb(E.csnames[a.args[0]]),E.csnames[a.args[1]].moebius)};t.TrComposeMtTr={};t.TrComposeMtTr.kind="Mt";t.TrComposeMtTr.signature=["Mt","Tr"];t.TrComposeMtTr.signatureConstraints=function(a){return!!E.csnames[a.args[1]].isEuclidean};
t.TrComposeMtTr.updatePosition=function(a){t._helper.composeMtMt(a,E.csnames[a.args[0]].moebius,t._helper.euc2moeb(E.csnames[a.args[1]]))};t._helper.pointReflection=function(a,b){return h.normalizeMax(h.sub(h.scalmult(n.realmult(2,b.value[2]),a),h.scalmult(a.value[2],b)))};t._helper.conicOtherIntersection=function(a,b,c){var d=h.productMV(a,c);a=h.scalproduct(c,d);d=h.scalproduct(b,d);d=n.realmult(-2,d);b=h.scalmult(a,b);c=h.scalmult(d,c);c=h.add(b,c);return c=h.normalizeMax(c)};t.Dist={};t.Dist.kind=
"V";t.Dist.signature=["P","P"];t.Dist.updatePosition=function(a){const b=E.csnames[a.args[1]].homog;a.value=h.abs(h.sub(h.normalizeZ(E.csnames[a.args[0]].homog),h.normalizeZ(b)))};t.Angle={};t.Angle.kind="V";t.Angle.signature=["L","L","P"];t.Angle.initialize=function(a){void 0===a.angle&&(a.angle=.5*Math.PI);xc(n._helper.input(a.angle))};t.Angle.updatePosition=function(a){var b=E.csnames[a.args[1]].homog,c=E.csnames[a.args[2]].homog,d=h.cross(E.csnames[a.args[0]].homog,h.linfty);b=h.cross(b,h.linfty);
c=h.crossratio3(d,b,h.ii,h.jj,c);c=n.mult(n.complex(0,.5),n.log(c));d=(id().value.real-c.value.real)/Math.PI;b=Math.round(d);!md&&.01<Math.abs(b-d)&&Ed();c=n.complex(b*Math.PI+c.value.real,c.value.imag);xc(c);a.value=G.withUsage(c,"Angle")};t.Angle.stateSize=2;t.Text={};t.Text.kind="Text";t.Text.signature="**";t.Text.isMovable=!0;t.Text.updatePosition=ic;t.Text.initialize=function(a){a.text=String(a.text);a.pos&&(a.homog=t._helper.initializePoint(a));a.dock&&(a.dock.offset=a.dock.offset&&2===a.dock.offset.length?
h.realVector([+a.dock.offset[0],+a.dock.offset[1]]):h.realVector([0,0]))};t.Text.set_text=function(a,b){a.text=fa(b)};t.Text.getParamForInput=function(a,b,c){return t.Free.getParamForInput(a,b,c)};t.Text.getParamFromState=function(a){return a.homog};t.Text.putParamToState=function(a,b){a.homog=b};t.Calculation={};t.Calculation.kind="Text";t.Calculation.signature="**";t.Calculation.isMovable=!0;t.Calculation.updatePosition=ic;t.Calculation.initialize=function(a){t.Text.initialize(a);a.calculation=
qc(a.text)};t.Calculation.getText=function(a){return fa(K(a.calculation))};t.Calculation.getParamForInput=t.Text.getParamForInput;t.Calculation.getParamFromState=t.Text.getParamFromState;t.Calculation.putParamToState=t.Text.putParamToState;t.Equation={};t.Equation.kind="Text";t.Equation.isMovable=!0;t.Equation.signature="**";t.Equation.updatePosition=ic;t.Equation.initialize=function(a){t.Text.initialize(a);a.calculation=qc(a.text)};t.Equation.getText=function(a){return a.text+" = "+fa(K(a.calculation))};
t.Equation.getParamForInput=t.Text.getParamForInput;t.Equation.getParamFromState=t.Text.getParamFromState;t.Equation.putParamToState=t.Text.putParamToState;t.Evaluate={};t.Evaluate.kind="Text";t.Evaluate.isMovable=!0;t.Evaluate.signature="**";t.Evaluate.updatePosition=ic;t.Evaluate.initialize=function(a){t.Text.initialize(a);a.calculation=qc(a.text)};t.Evaluate.getText=function(a){K(a.calculation);return a.text};t.Evaluate.getParamForInput=t.Text.getParamForInput;t.Evaluate.getParamFromState=t.Text.getParamFromState;
t.Evaluate.putParamToState=t.Text.putParamToState;t.Plot={};t.Plot.kind="Text";t.Plot.isMovable=!0;t.Plot.signature="**";t.Plot.updatePosition=ic;t.Plot.initialize=function(a){t.Text.initialize(a);a.calculation=qc("plot(("+a.text+"))")};t.Plot.getText=function(a){K(a.calculation);return a.text};t.Plot.getParamForInput=t.Text.getParamForInput;t.Plot.getParamFromState=t.Text.getParamFromState;t.Plot.putParamToState=t.Text.putParamToState;t.Button={};t.Button.kind="Text";t.Button.signature="**";t.Button.isMovable=
!0;t.Button.updatePosition=ic;t.Button.initialize=function(a){const b=document.createElement("button");ke(a,"click",b)};t.Button.getParamForInput=t.Text.getParamForInput;t.Button.getParamFromState=t.Text.getParamFromState;t.Button.putParamToState=t.Text.putParamToState;t.Button.set_fillcolor=function(a,b){h._helper.isNumberVecN(b,3)&&(a.fillcolor=b.value.map(function(c){return c.value.real}),a.html.style.backgroundColor=L.makeColor(a.fillcolor,a.fillalpha))};t.Button.set_color=function(a,b){h._helper.isNumberVecN(b,
3)&&(a.color=b.value.map(function(c){return c.value.real}),a.html.style.color=L.makeColor(a.color,a.alpha))};t.ToggleButton={};t.ToggleButton.kind="Text";t.ToggleButton.signature="**";t.ToggleButton.isMovable=!0;t.ToggleButton.updatePosition=ic;t.ToggleButton.initialize=function(a){var b=void 0;void 0===b&&(b="CindyJSid");b+=++cb;const c=document.createElement("input"),d=document.createElement("label");c.setAttribute("id",b);d.setAttribute("for",b);c.setAttribute("type","checkbox");a.pressed&&(c.checked=
!0);a.checkbox=c;ke(a,"change",c,d)};t.ToggleButton.get_text=function(a){return G.string(String(a.text))};t.ToggleButton.set_currenttext=function(a,b){a.html.value=a.text=fa(b)};t.ToggleButton.getParamForInput=t.Text.getParamForInput;t.ToggleButton.getParamFromState=t.Text.getParamFromState;t.ToggleButton.putParamToState=t.Text.putParamToState;t.ToggleButton.set_fillcolor=t.Button.set_fillcolor;t.ToggleButton.set_color=t.Button.set_color;t.ToggleButton.set_text=t.ToggleButton.set_currenttext;t.ToggleButton.get_val=
t.ToggleButton.get_text;t.ToggleButton.set_val=t.ToggleButton.set_currenttext;t.EditableText={};t.EditableText.kind="Text";t.EditableText.isMovable=!0;t.EditableText.signature=[];t.EditableText.updatePosition=ic;t.EditableText.initialize=function(a){const b=document.createElement("input");b.setAttribute("type","text");b.className="CindyJS-editabletext";Ub(a.minwidth)&&(b.style.width=a.minwidth-3+"px");"string"===typeof a.text&&(b.value=a.text);b.addEventListener("keydown",function(c){13===c.keyCode&&
(a.text=a.html.value,b.blur())});b.addEventListener("change",function(c){a.text=a.html.value});ke(a,"change",b)};t.EditableText.getText=function(a){return!1};t.EditableText.getParamForInput=t.Text.getParamForInput;t.EditableText.getParamFromState=t.Text.getParamFromState;t.EditableText.putParamToState=t.Text.putParamToState;t.EditableText.set_fillcolor=t.Button.set_fillcolor;t.EditableText.set_color=t.Button.set_color;t.EditableText.get_currenttext=function(a){return G.string(String(a.html.value))};
t.EditableText.get_text=t.ToggleButton.get_text;t.EditableText.set_currenttext=t.ToggleButton.set_currenttext;t.EditableText.set_text=t.EditableText.set_currenttext;t.EditableText.get_val=t.EditableText.get_text;t.EditableText.set_val=t.EditableText.set_currenttext;t._helper.initializePoint=function(a){let b=0,c=0,d=0;if(a.pos){if("list"===a.pos.ctype&&h.isNumberVector(a.pos))return a.pos;2===a.pos.length&&(b=a.pos[0],c=a.pos[1],d=1);3===a.pos.length&&(b=a.pos[0],c=a.pos[1],d=a.pos[2])}a=h.turnIntoCSList([n._helper.input(b),
n._helper.input(c),n._helper.input(d)]);return a=h.normalizeMax(a)};t._helper.initializeLine=function(a){let b=0,c=0,d=0;if(a.pos){if("list"===a.pos.ctype&&h.isNumberVector(a.pos))return a.pos;3===a.pos.length&&(b=a.pos[0],c=a.pos[1],d=a.pos[2])}a=h.turnIntoCSList([n._helper.input(b),n._helper.input(c),n._helper.input(d)]);return a=h.normalizeMax(a)};t.Poly={};t.Poly.kind="Poly";t.Poly.signature="P*";t.Poly.updatePosition=function(a){a.vertices=h.turnIntoCSList(a.args.map(function(b){return E.csnames[b].homog}))};
let db=null;t.IFS={};t.IFS.kind="IFS";t.IFS.signature="**";t.IFS.signatureConstraints=function(a){for(let b=0;b<a.args.length;++b){const c=E.csnames[a.args[b]].kind;if("Tr"!==c&&"Mt"!==c)return!1}return 0<a.args.length};t.IFS.initialize=function(a){if(db)db.dirty=!0;else if(a=Ab.getBaseDir(),!1!==a){db={dirty:!1,params:{generation:0}};var b=db.worker=new Worker(a+"ifs.js");b.onmessage=function(c){db.img&&"function"===typeof db.img.close&&db.img.close();if(!vd){c=c.data;if(c.generation===db.params.generation){if(c.buffer){db.canvas||
(db.canvas=document.createElement("canvas"),db.ctx=db.canvas.getContext("2d"));db.canvas.width=c.width;db.canvas.height=c.height;var d=new Uint8ClampedArray(c.buffer,c.imgPtr,c.width*c.height*4);d=new ImageData(d,c.width,c.height);db.ctx.putImageData(d,0,0);db.img=db.canvas}else db.img=c.img;l()}else db.img=null;c.buffer?b.postMessage({cmd:"next",buffer:c.buffer},[c.buffer]):b.postMessage({cmd:"next"})}};Hc.push(b.terminate.bind(b))}};t.IFS.updatePosition=function(a){db.dirty=!0};t.IFS.updateParameters=
function(){if(db.worker){var a={cmd:"init",generation:db.params.generation,width:Math.round(4*$a),height:Math.round(4*fb)};a.systems=E.ifs.map(function(b){let c=0;var d;const f=b.ifs||[],k=b.args.map(function(x,y){x=f[y]||{};return{prob:x.prob||1,color:x.color||[0,0,0]}});for(d=0;d<k.length;++d)c+=k[d].prob;d=h.realMatrix([[1,0,0],[0,1,0],[0,0,4]]);const m=h.productMM(N.toMat(),d);for(d=0;d<b.args.length;++d){var p=E.csnames[b.args[d]],u=p.kind;const x=k[d];x.kind=u;x.prob/=c;if("Tr"===u)p=h.normalizeMax(h.productMM(h.adjoint3(m),
h.productMM(p.matrix,m))),h._helper.isAlmostReal(p)?x.mat=p.value.map(function(y){return y.value.map(function(C){return C.value.real})}):x.kind="cplx";else if("Mt"===u){u=N.drawingstate.matrix;u={anti:0<u.det,ar:n.real(u.a),ai:n.real(u.c),br:n.real(u.tx),bi:n.real(-u.ty),cr:n.zero,ci:n.zero,dr:n.real(.25),di:n.zero};const y={};t._helper.composeMtMt(y,p.moebius,u);u=t._helper.inverseMoebius(u);t._helper.composeMtMt(y,u,y.moebius);u=y.moebius;u=h.turnIntoCSList([u.ar,u.ai,u.br,u.bi,u.cr,u.ci,u.dr,u.di]);
h._helper.isAlmostReal(u)?(u=u.value,x.moebius={ar:u[0].value.real,ai:u[1].value.real,br:u[2].value.real,bi:u[3].value.real,cr:u[4].value.real,ci:u[5].value.real,dr:u[6].value.real,di:u[7].value.real,sign:p.moebius.anti?-1:1}):x.kind="cplx"}}return{trafos:k}});G.deeplyEqual(a,db.params)||(++a.generation,db.img=null,db.params=a,db.mat=N.drawingstate.matrix,db.worker.postMessage(a))}};t.IFS.probSetter=function(a,b,c){"number"===c.ctype&&(b.ifs[a].prob=c.value.real,db.dirty=!0)};(function(){for(let a=
0;10>a;++a)t.IFS["set_prob"+a]=t.IFS.probSetter.bind(null,a)})();t._helper.snapPointToLine=function(a,b){if(n._helper.isAlmostZero(a.value[2]))return a;var c=t._helper.projectPointToLine(a,b);c=h.normalizeZ(c);const d=c.value[0].value.real;c=c.value[1].value.real;const f=Math.round(d/Tb)*Tb,k=Math.round(c/Tb)*Tb,m=h.realVector([f,k,1]);Math.abs(f-d)<ld&&Math.abs(k-c)<ld&&n._helper.isAlmostZero(h.scalproduct(b,m))&&(a=t._helper.projectPointToLine(m,b));return a};const Sd={CircleByRadius:"CircleMr",
IntersectionCircleCircle:"IntersectCirCir",IntersectionConicConic:"IntersectConicConic",FreePoint:"Free",Orthogonal:"Perp",Parallel:"Para",Pole:"PolarOfLine",Polar:"PolarOfPoint",Arc:"ArcBy3",EuclideanMid:"Mid",AngularBisector:"AngleBisector",TransformConic:"TransformC",TransformSegment:"TransformS",TrMoebiusSegment:"TrMoebiusS",ReflectCC:"TrMoebiusC",ReflectCL:"TrMoebiusL",ReflectCP:"TrMoebiusP",ReflectCArc:"TrMoebiusArc",ReflectCS:"TrMoebiusS",TrMoebiusCircle:"TrMoebiusC"},sf={CircleMFixedr:function(a){a.pinned=
!0;a.type="CircleMr";return[a]},CircleByFixedRadius:function(a){a.pinned=!0;a.type="CircleMr";return[a]},IntersectionConicLine:function(a){a.args=[a.args[1],a.args[0]];a.type="IntersectLC";return[a]},angleBisector:function(a){const b={name:a.name+"_Intersection",type:"Meet",args:a.args,visible:!1};a.type="AngleBisector";a.args=[a.args[0],a.args[1],b.name];return[b,a]},Transform:function(a){var b=E.csnames[a.args[1]];b={Tr:"Transform",Mt:"TrMoebius"}[E.csnames[a.args[0]].kind]+(b.isArc?"Arc":b.kind);
if(t.hasOwnProperty(b))return a.type=b,[a];console.log(b+" not implemented yet");return[]},TrReflection:function(a){const b="TrReflection"+E.csnames[a.args[0]].kind;if(t.hasOwnProperty(b))return a.type=b,[a];console.log(b+" not implemented yet");return[]},TrCompose:function(a){const b="TrCompose"+a.args.map(function(c){return E.csnames[c].kind}).join("");if(t.hasOwnProperty(b))return a.type=b,[a];console.log(b+" not implemented yet");return[]}},Ef="align alpha angle args arrow arrowposition arrowshape arrowsides arrowsize clip color dashtype drawtrace fillalpha fillcolor filled labeled labelpos name overhang pinned printname radius size text text_fontfamily textbold textitalics textsize tracedim tracelength traceskip tracing type visible".split(" ");
Kb.saveState=function(){return{geometry:Gd()}};const Yb={};var Gf=[[],[.2],[.075,.225],[44/45,-56/15,32/9],[19372/6561,-25360/2187,64448/6561,-212/729],[9017/3168,-355/33,46732/5247,49/176,-5103/18656],[35/384,0,500/1113,125/192,-2187/6784,11/84]];var $e=[0,.2,.3,.8,8/9,1,1];var Hf=[35/384,0,500/1113,125/192,-2187/6784,11/84,0];var If=[5179/57600,0,7571/16695,.6140625,-92097/339200,187/2100,.025];let nc,Lb=[],vf=[],qf=!1;Yb.tick=function(a){a/=Hd;for(let b=0;b<Hd;b++)Yb.tick1(a),Xc+=a,K(Ha.simulationstep)};
Yb.tick1=function(a){var b=a;let c=0;for(;0<a&&c<.999*a||0>a&&c>.999*a;)b=Yb.oneRKStep(b),c+=b,b=Math.min(2*b,a-c),b=Math.max(b,1E-16),Yb.restorePosition(),Yb.doCollisions(),Yb.calculateForces(),Yb.moveToFinalPos();return!0};Yb.restorePosition=function(){nc.forEach(function(a){Ia[a.type].restorePos(a,9)})};Yb.doCollisions=function(){nc.forEach(function(a){Ia[a.type].doCollisions(a)})};Yb.calculateForces=function(){nc.forEach(function(a){Ia[a.type].calculateForces(a)})};Yb.moveToFinalPos=function(){nc.forEach(function(a){Ia[a.type].move(a)})};
Yb.oneRKStep=function(a){const b=function(x){nc.forEach(function(y){Ia[y.type].initRK(y,x);Ia[y.type].storePosition(y)})},c=function(x){nc.forEach(function(y){Ia[y.type].setToTimestep(y,$e[x])})},d=function(x){nc.forEach(function(y){Ia[y.type].proceedMotion(y,$e[x],x,Gf[x])})},f=function(){nc.forEach(function(x){Ia[x.type].resetForces(x)})},k=function(x){nc.forEach(function(y){Ia[y.type].calculateDelta(y,x)})},m=function(x){let y=0;nc.forEach(function(C){Ia[C.type].proceedMotion(C,$e[6],7,Hf);Ia[C.type].savePos(C,
8);Ia[C.type].proceedMotion(C,$e[6],7,If);Ia[C.type].savePos(C,9);y+=Ia[C.type].sqDist(C,8,9)});return y=Math.sqrt(y)/a},p=function(x){nc.forEach(function(y){Ia[y.type].recallPosition(y)})};let u=!1;for(;!u;){b(a);for(let x=0;7>x;x++)c(x),d(x),f(),Yb.calculateForces(),k(x);m(a)>Ia.env.errorbound&&a>Ia.env.lowestdeltat?(a/=Ia.env.slowdownfactor,p()):u=!0}return a};const Ia={Mass:{reset:function(a,b){a.vel=[0,0,0];a.pos=[0,0,0,0];a.el=b;"undefined"===typeof a.mass&&(a.mass=1);"undefined"===typeof a.charge&&
(a.charge=0);"undefined"===typeof a.friction&&(a.friction=0);a.lnfrict=0;"undefined"===typeof a.limitspeed&&(a.limitspeed=!1);"undefined"===typeof a.fixed&&(a.fixed=!1);"undefined"===typeof a.radius&&(a.radius=1);a.internalmove=!1;a.fx=0;a.fy=0;a.fz=0;a.vx=a.vx||0;a.vy=a.vy||0;a.vz=a.vz||0;a.mtype=0;a.env=Ia.env;a.deltat=0;a.mx=0;a.my=0;a.mz=0;a.mvx=0;a.mvy=0;a.mvz=0;a.dx=[0,0,0,0,0,0,0,0,0,0];a.dy=[0,0,0,0,0,0,0,0,0,0];a.dz=[0,0,0,0,0,0,0,0,0,0];a.dvx=[0,0,0,0,0,0,0,0,0,0];a.dvy=[0,0,0,0,0,0,0,0,
0,0];a.dvz=[0,0,0,0,0,0,0,0,0,0];a.midx=0;a.midy=0;a.midz=0;a.lx=0;a.ly=0;a.lz=0},resetForces:function(a){a.fx=0;a.fy=0;a.fz=0},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){const c=A.extractPoint(a.el.homog);a.x=c.x;a.y=c.y;a.z=0;a.xo=a.x;a.yo=a.y;a.zo=a.z;a.vxo=a.vx;a.vyo=a.vy;a.vzo=a.vz;a.deltat=b;a.fx=0;a.fy=0;a.fz=0},setVelocity:function(a,b,c,d){d||(d=0);a.vx=b;a.vy=c;a.vz=d},move:function(a){a.pos=[a.x,a.y,1];a.internalmove=!0;tb&&bb.down&&a.el===tb.mover||Rb(a.el,h.realVector(a.pos),
"homog");a.el.sx=a.x;a.el.sy=a.y;a.internalmove=!1},proceedMotion:function(a,b,c,d){if(!a.fixed)for(a.x=a.mx,a.y=a.my,a.z=a.mz,a.vx=a.mvx,a.vy=a.mvy,a.vz=a.mvz,b=0;b<c;b++)a.x+=d[b]*a.dx[b]*a.deltat,a.y+=d[b]*a.dy[b]*a.deltat,a.z+=d[b]*a.dz[b]*a.deltat,a.vx+=d[b]*a.dvx[b]*a.deltat,a.vy+=d[b]*a.dvy[b]*a.deltat,a.vz+=d[b]*a.dvz[b]*a.deltat},calculateForces:function(a){const b=Math.sqrt(a.vx*a.vx+a.vy*a.vy+a.vz*a.vz);a.lnfrict=-Math.log((1-a.friction)*(1-a.env.friction)*(.1<b&&a.limitSpeed?.1/b:1));
a.fx+=-a.vx*a.lnfrict*a.mass;a.fy+=-a.vy*a.lnfrict*a.mass;a.fz+=-a.vz*a.lnfrict*a.mass},calculateDelta:function(a,b){a.dx[b]=a.vx;a.dy[b]=a.vy;a.dz[b]=a.vz;a.dvx[b]=a.fx/a.mass;a.dvy[b]=a.fy/a.mass;a.dvz[b]=a.fz/a.mass},savePos:function(a,b){a.dx[b]=a.x;a.dy[b]=a.y;a.dz[b]=a.z;a.dvx[b]=a.vx;a.dvy[b]=a.vy;a.dvz[b]=a.vz},restorePos:function(a,b){a.fixed||(a.x=a.dx[b],a.y=a.dy[b],a.z=a.dz[b],a.vx=a.dvx[b],a.vy=a.dvy[b],a.vz=a.dvz[b])},sqDist:function(a,b,c){let d=(a.dx[b]-a.dx[c])*(a.dx[b]-a.dx[c]);
d+=(a.dy[b]-a.dy[c])*(a.dy[b]-a.dy[c]);d+=(a.dz[b]-a.dz[c])*(a.dz[b]-a.dz[c]);d+=(a.dvx[b]-a.dvx[c])*(a.dvx[b]-a.dvx[c]);d+=(a.dvy[b]-a.dvy[c])*(a.dvy[b]-a.dvy[c]);return d+=(a.dvz[b]-a.dvz[c])*(a.dvz[b]-a.dvz[c])},kineticEnergy:function(a){return.5*a.mass*(a.vx*a.vx+a.vy*a.vy+a.vz*a.vz)},storePosition:function(a){a.mx=a.x;a.my=a.y;a.mz=a.z;a.mvx=a.vx;a.mvy=a.vy;a.mvz=a.vz},recallPosition:function(a){a.fixed||(a.x=a.mx,a.y=a.my,a.z=a.mz,a.vx=a.mvx,a.vy=a.mvy,a.vz=a.mvz)},doCollisions:function(a){}},
Sun:{reset:function(a,b){a.vel=[0,0,0];a.pos=[0,0,0,0];a.el=b;"undefined"===typeof a.mass&&(a.mass=10);"undefined"===typeof a.friction&&(a.friction=0);a.charge=0;a.x=0;a.y=0;a.z=0},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){b=A.extractPoint(a.el.homog);a.x=b.x;a.y=b.y;a.z=0},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateDelta:function(a,b){},calculateForces:function(a){const b=a.x,c=a.y,d=a.z;for(const m of Lb){const p=
m.behavior.x;var f=m.behavior.y,k=m.behavior.z;const u=Math.sqrt((b-p)*(b-p)+(c-f)*(c-f)+(d-k)*(d-k));f=(c-f)*a.mass*m.behavior.mass/(u*u*u);k=(d-k)*a.mass*m.behavior.mass/(u*u*u);m.behavior.fx+=(b-p)*a.mass*m.behavior.mass/(u*u*u)*m.behavior.mass;m.behavior.fy+=f*m.behavior.mass;m.behavior.fz+=k*m.behavior.mass}},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},
Velocity:{reset:function(a){var b=E.csnames[a.geo[1]];console.log(b);const c=A.extractPoint(b.homog);a=A.extractPoint(E.csnames[a.geo[2]].homog);b=b.behavior;Ia[b.type].setVelocity(b,a.x-c.x,a.y-c.y,0)},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,d){},move:function(a){const b=E.csnames[a.geo[2]];if(!tb||!bb.down||b!==tb.mover){var c=E.csnames[a.geo[1]];a=A.extractPoint(c.homog);c=c.behavior;a=h.realVector([a.x+c.vx,a.y+c.vy,
1]);Rb(b,a,"homog")}},proceedMotion:function(a,b,c,d){},calculateForces:function(a){},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},Gravity:{reset:function(a,b){a.vel=[0,0,0];a.pos=[0,0,0,0];a.el=b;"undefined"===typeof a.strength&&(a.strength=1);a.namea=b.args[0];a.nameb=b.args[1];a.ma=E.csnames[a.namea];a.mb=E.csnames[a.nameb]},
resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateDelta:function(a,b){},calculateForces:function(a){const b=A.extractPoint(a.ma.homog),c=A.extractPoint(a.mb.homog),d=(c.x-b.x)*a.strength;a=(c.y-b.y)*a.strength;for(const f of Lb)f.behavior.fx+=d*f.behavior.mass,f.behavior.fy+=a*f.behavior.mass,f.behavior.fz+=0*f.behavior.mass},savePos:function(a,b){},restorePos:function(a,
b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},Spring:{reset:function(a,b){a.el=b;"undefined"===typeof a.strength&&(a.strength=1);"undefined"===typeof a.amplitude&&(a.amplitude=0);"undefined"===typeof a.phase&&(a.phase=0);"undefined"===typeof a.speed&&(a.speed=1);"undefined"===typeof a.l0&&(a.l0=0);"undefined"===typeof a.stype&&(a.stype=1);"undefined"===typeof a.readOnInit&&(a.readOnInit=!1);a.namea=
b.args[0];a.nameb=b.args[1];a.ma=E.csnames[a.namea];a.mb=E.csnames[a.nameb];b=A.extractPoint(a.ma.homog);const c=A.extractPoint(a.mb.homog);a.l0=Math.sqrt((b.x-c.x)*(b.x-c.x)+(b.y-c.y)*(b.y-c.y));a.env=Ia.env;a.ldiff=0},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateForces:function(a){let b;let c;if(!a.ma.behavior||tb&&bb.down&&a.ma===tb.mover){var d=A.extractPoint(a.ma.homog);
b=d.x;c=d.y}else b=a.ma.behavior.x,c=a.ma.behavior.y;if(!a.mb.behavior||tb&&bb.down&&a.mb===tb.mover){var f=A.extractPoint(a.mb.homog);d=f.x;f=f.y}else d=a.mb.behavior.x,f=a.mb.behavior.y;var k=Math.sqrt((b-d)*(b-d)+(c-f)*(c-f));let m=a.l0;a.ldiff=k-m;const p=a.stype;1===p&&(m=0);let u=0;if(2===p||3===p)u=a.ma.behavior.mass*a.mb.behavior.mass*a.strength;2===p&&(u=-u);let x,y;if(0===k||0!==p&&1!==p)if(a.ma.behavior&&a.mb.behavior&&0!==k){if(k*=k*k,2===p||3===p)x=(b-d)*u/k,y=(c-f)*u/k}else x=y=0;else x=
-(b-d)*a.strength*(k-m)/k*a.env.springstrength,y=-(c-f)*a.strength*(k-m)/k*a.env.springstrength;a.ma.behavior&&(a.ma.behavior.fx+=x,a.ma.behavior.fy+=y);a.mb.behavior&&(a.mb.behavior.fx-=x,a.mb.behavior.fy-=y)},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},det:function(a,b,c,d,f,k){return c*k-f*d+f*b-a*k+a*d-c*b},Bouncer:{reset:function(a,
b){a.el=b;"undefined"===typeof a.xdamp&&(a.xdamp=0);"undefined"===typeof a.ydamp&&(a.ydamp=0);"undefined"===typeof a.motorchanger&&(a.motorchanger=!0);a.namea=b.args[0];a.nameb=b.args[1];a.ma=E.csnames[a.namea];a.mb=E.csnames[a.nameb];b=A.extractPoint(a.ma.homog);const c=A.extractPoint(a.mb.homog);a.x1o=1.01*b.x-.01*c.x;a.y1o=1.01*b.y-.01*c.y;a.x2o=1.01*c.x-.01*b.x;a.y2o=1.01*c.y-.01*b.y;a.env=Ia.env},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){a.deltat=
b},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateForces:function(a){},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){var b=A.extractPoint(a.ma.homog),c=A.extractPoint(a.mb.homog);const d=b.x;b=b.y;const f=c.x;c=c.y;const k=a.x1o,m=a.y1o,p=a.x2o,u=a.y2o;var x=Math.sqrt((d-f)*
(d-f)+(b-c)*(b-c));const y=(d-f)/x;x=(b-c)/x;for(const Q of Lb){var C=Q.behavior.xo,F=Q.behavior.yo,H=Q.behavior.x;const T=Q.behavior.y;let X=n.mult(n.complex(k,m),n.complex(f,c)),U=n.mult(n.complex(p,u),n.complex(d,b));X=n.sub(X,U);U=n.mult(n.complex(C,F),n.complex(d,b));X=n.add(X,U);U=n.mult(n.complex(C,F),n.complex(f,c));X=n.sub(X,U);U=n.sub(n.complex(k,m),n.complex(p,u));X=n.div(X,U);0>Ia.det(d,b,f,c,H,T)*Ia.det(d,b,f,c,X.value.real,X.value.imag)&&0>Ia.det(d,b,H,T,X.value.real,X.value.imag)*Ia.det(f,
c,H,T,X.value.real,X.value.imag)&&(F=Q.behavior.mvx+a.deltat*(-X.value.real+Q.behavior.xo),H=Q.behavior.mvy+a.deltat*(-X.value.imag+Q.behavior.yo),C=y*F+x*H,F=x*F-y*H,Q.behavior.x=X.value.real,Q.behavior.y=X.value.imag,Q.behavior.vx=y*C*(1-a.xdamp),Q.behavior.vy=x*C*(1-a.xdamp),Q.behavior.vx+=-x*F*(1-a.ydamp),Q.behavior.vy+=y*F*(1-a.ydamp))}a.x1o=d;a.y1o=b;a.x2o=f;a.y2o=c}},Environment:{init:function(a){"undefined"===typeof a.gravity&&(a.gravity=0);"undefined"===typeof a.friction&&(a.friction=0);
"undefined"===typeof a.springstrength&&(a.springstrength=1);"undefined"!==typeof a.accuracy&&(Hd=a.accuracy);"undefined"!==typeof a.deltat&&pb(a.deltat/.6);"undefined"===typeof a.charges&&(a.charges=!1);"undefined"===typeof a.balls&&(a.balls=!1);"undefined"===typeof a.newton&&(a.newton=!1);"undefined"===typeof a.ballInteractionBoosting&&(a.ballInteractionBoosting=1);Ia.env=a;a.errorbound=.001;a.lowestdeltat=1E-7;a.slowdownfactor=2},reset:function(a){},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,
b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateForces:function(a){let b;let c,d,f,k;let m,p;if(a.newton)for(b=0;b<Lb.length-1;b++){var u=Lb[b];c=u.behavior.x;d=u.behavior.y;for(f=b+1;f<Lb.length;f++){k=Lb[f];var x=k.behavior.x;var y=k.behavior.y;p=Math.sqrt((c-x)*(c-x)+(d-y)*(d-y));x=(c-x)*u.behavior.mass*k.behavior.mass/(p*p*p);y=(d-y)*u.behavior.mass*k.behavior.mass/(p*p*p);u.behavior.fx-=x;u.behavior.fy-=y;k.behavior.fx+=
x;k.behavior.fy+=y}}if(a.charges)for(b=0;b<Lb.length-1;b++)for(u=Lb[b],c=u.behavior.x,d=u.behavior.y,f=b+1;f<Lb.length;f++)k=Lb[f],x=k.behavior.x,y=k.behavior.y,p=Math.sqrt((c-x)*(c-x)+(d-y)*(d-y)),x=(c-x)*u.behavior.charge*k.behavior.charge/(p*p*p),y=(d-y)*u.behavior.charge*k.behavior.charge/(p*p*p),u.behavior.fx+=x,u.behavior.fy+=y,k.behavior.fx-=x,k.behavior.fy-=y;if(a.balls)for(b=0;b<Lb.length-1;b++)if(u=Lb[b],0!==u.behavior.radius)for(c=u.behavior.x,d=u.behavior.y,f=b+1;f<Lb.length;f++)k=Lb[f],
0!==k.behavior.radius&&(x=k.behavior.x,y=k.behavior.y,m=u.behavior.radius+k.behavior.radius,p=Math.sqrt((c-x)*(c-x)+(d-y)*(d-y)),0===a.ballInteractionBoosting?(x=(c-x)/(p*p*p)*(p>m?0:(p-m)*(p-m)),y=(d-y)/(p*p*p)*(p>m?0:(p-m)*(p-m))):1===a.ballInteractionBoosting?(x=(c-x)/(p*p*p*p)*(p>m?0:(p-m)*(p-m)),y=(d-y)/(p*p*p*p)*(p>m?0:(p-m)*(p-m))):(x=(c-x)/(p*p*p*p*p)*(p>m?0:(p-m)*(p-m)),y=(d-y)/(p*p*p*p*p)*(p>m?0:(p-m)*(p-m))),u.behavior.fx+=x,u.behavior.fy+=y,k.behavior.fx-=x,k.behavior.fy-=y);for(b=0;b<
Lb.length;b++)u=Lb[b],u.behavior.fx+=0,u.behavior.fy+=-a.gravity*u.behavior.mass,u.behavior.fz+=0},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}}};return Kb};return Y}(),createCindy=CindyJS;
"undefined"!==typeof process&&"undefined"!==typeof module&&"undefined"!==typeof module.exports&&"undefined"===typeof window&&(module.exports=CindyJS);
//# sourceMappingURL=Cindy.js.map

