(function(){
'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(k,l,e){return k==a&&"q"==l&&e==b}}));return!0===b.q}catch(k){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,k){a!=Array.prototype&&a!=Object.prototype&&(a[b]=k.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.polyfill=function(a,b,k,l){if(b){k=$jscomp.global;a=a.split(".");for(l=0;l<a.length-1;l++){var e=a[l];e in k||(k[e]={});k=k[e]}a=a[a.length-1];l=k[a];b=b(l);b!=l&&null!=b&&$jscomp.defineProperty(k,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("WeakMap",function(a){function b(){if(!a||!Object.seal)return!1;try{var e=Object.seal({}),b=Object.seal({}),h=new a([[e,2],[b,3]]);if(2!=h.get(e)||3!=h.get(b))return!1;h.delete(e);h.set(b,4);return!h.has(e)&&4==h.get(b)}catch(w){return!1}}function k(a){$jscomp.owns(a,e)||$jscomp.defineProperty(a,e,{value:{}})}function l(a){var e=Object[a];e&&(Object[a]=function(a){k(a);return e(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;
var e="$jscomp_hidden_"+Math.random();l("freeze");l("preventExtensions");l("seal");var h=0,n=function(a){this.id_=(h+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var e;!(e=a.next()).done;)e=e.value,this.set(e[0],e[1])}};n.prototype.set=function(a,b){k(a);if(!$jscomp.owns(a,e))throw Error("WeakMap key fail: "+a);a[e][this.id_]=b;return this};n.prototype.get=function(a){return $jscomp.owns(a,e)?a[e][this.id_]:void 0};n.prototype.has=
function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)};n.prototype.delete=function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)?delete a[e][this.id_]:!1};return n},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var e=Object.seal({x:4}),b=new a($jscomp.makeIterator([[e,"s"]]));if("s"!=b.get(e)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var h=b.entries(),n=h.next();if(n.done||n.value[0]!=e||"s"!=n.value[1])return!1;n=h.next();return n.done||4!=n.value[0].x||"t"!=n.value[1]||!h.next().done?!1:!0}catch(q){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbol();$jscomp.initSymbolIterator();var k=new WeakMap,l=function(a){this.data_={};this.head_=n();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var e;!(e=a.next()).done;)e=e.value,this.set(e[0],e[1])}};l.prototype.set=function(a,b){a=0===a?0:a;var h=e(this,a);h.list||(h.list=this.data_[h.id]=[]);h.entry?h.entry.value=b:(h.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:a,value:b},h.list.push(h.entry),this.head_.previous.next=h.entry,this.head_.previous=h.entry,this.size++);return this};l.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};l.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=n();this.size=0};l.prototype.has=function(a){return!!e(this,a).entry};
l.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};l.prototype.entries=function(){return h(this,function(a){return[a.key,a.value]})};l.prototype.keys=function(){return h(this,function(a){return a.key})};l.prototype.values=function(){return h(this,function(a){return a.value})};l.prototype.forEach=function(a,e){for(var b=this.entries(),h;!(h=b.next()).done;)h=h.value,a.call(e,h[1],h[0],this)};l.prototype[Symbol.iterator]=l.prototype.entries;var e=function(a,e){var b=e&&typeof e;"object"==
b||"function"==b?k.has(e)?b=k.get(e):(b=""+ ++B,k.set(e,b)):b="p_"+e;var h=a.data_[b];if(h&&$jscomp.owns(a.data_,b))for(a=0;a<h.length;a++){var n=h[a];if(e!==e&&n.key!==n.key||e===n.key)return{id:b,list:h,index:a,entry:n}}return{id:b,list:h,index:-1,entry:void 0}},h=function(a,e){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:e(b)};b=null}return{done:!0,value:void 0}})},n=function(){var a={};return a.previous=
a.next=a.head=a},B=0;return l},"es6","es3");$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var k=0,l={next:function(){if(k<a.length){var e=k++;return{value:b(e,a[e]),done:!1}}l.next=function(){return{done:!0,value:void 0}};return l.next()}};l[Symbol.iterator]=function(){return l};return l};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.polyfill("Object.getOwnPropertySymbols",function(a){return a?a:function(){return[]}},"es6","es5");$jscomp.polyfill("Reflect.ownKeys",function(a){return a?a:function(a){var b=[],l=Object.getOwnPropertyNames(a);a=Object.getOwnPropertySymbols(a);for(var e=0;e<l.length;e++)("jscomp_symbol_"==l[e].substring(0,14)?a:b).push(l[e]);return b.concat(a)}},"es6","es5");
$jscomp.polyfill("Set",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),e=new a($jscomp.makeIterator([b]));if(!e.has(b)||1!=e.size||e.add(b)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var h=e.entries(),n=h.next();if(n.done||n.value[0]!=b||n.value[1]!=b)return!1;n=h.next();return n.done||n.value[0]==b||4!=n.value[0].x||n.value[1]!=n.value[0]?!1:h.next().done}catch(B){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbol();$jscomp.initSymbolIterator();var k=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};k.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};k.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};k.prototype.clear=
function(){this.map_.clear();this.size=0};k.prototype.has=function(a){return this.map_.has(a)};k.prototype.entries=function(){return this.map_.entries()};k.prototype.values=function(){return this.map_.values()};k.prototype.keys=k.prototype.values;k.prototype[Symbol.iterator]=k.prototype.values;k.prototype.forEach=function(a,b){var e=this;this.map_.forEach(function(h){return a.call(b,h,h,e)})};return k},"es6","es3");
$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,k){return k})}},"es8","es3");
var coerce={toList:function(a,b){b=void 0===b?null:b;return"list"!==a.ctype?(console.log("argument is not a list"),b):a.value},toHomog:function(a,b,k){b=void 0===b?[0,0,0,0]:b;k=void 0===k?3:k;a=coerce.toList(a);if(null===a)return b;b=a.map(coerce.toReal);b.length>k+1&&(console.log("Coordinate vector too long."),b=b.slice(0,k+1));for(;b.length<k;)b.push(0);b.length===k&&b.push(1);return b},toDirection:function(a,b){b=void 0===b?[0,0,0]:b;a=coerce.toList(a);if(null===a)return b;b=a.map(coerce.toReal);
3<b.length&&(console.log("Coordinate vector too long."),b=b.slice(0,3));for(;3>b.length;)b.push(0);return b},toDirectionPoint:function(a,b){b=void 0===b?[0,0,0,0]:b;a=coerce.toDirection(a,b);a!==b&&(a[3]=0);return a},toColor:function(a,b){b=void 0===b?[.5,.5,.5]:b;if("number"===a.ctype){var k=coerce.toInterval(0,1,a);if(!isNaN(k))return[k,k,k]}a=coerce.toList(a);return null===a?b:3!=a.length?(console.log("Not an RGB color vector"),b):a.map(function(a){return coerce.toInterval(0,1,a)})},toReal:function(a,
b){b=void 0===b?Number.NaN:b;if("number"!==a.ctype)return console.log("argument is not a number"),b;a=a.value;b=a.real;0!==a.imag&&console.log("complex number is not real");return b},toInt:function(a,b){b=void 0===b?Number.NaN:b;if("number"!==a.ctype)return console.log("argument is not a number"),b;b=a.value;a=b.real;b=b.imag;0!==b&&console.log("complex number is not real");b=Math.round(a);b!==a&&console.log("number is not an integer");return b},clamp:function(a,b,k){return k<a?a:k>b?b:k},toInterval:function(a,
b,k,l){l=void 0===l?Number.NaN:l;return coerce.clamp(a,b,coerce.toReal(k,l))},toString:function(a,b){b=void 0===b?null:b;if("string"===a.ctype)return a.value;console.log("argument is not a string");return b},toEnum:function(a,b,k){k=void 0===k?null:k;b=coerce.toString(b,k);if(b!==k&&-1!==a.indexOf(b))return b;console.log("argument is not one of "+a.join(", "));return k},toBool:function(a,b){if("boolean"===a.ctype)return a.value;console.log("argument is not boolean");return b}};function norm3(a){var b=a[0],k=a[1];a=a[2];return Math.sqrt(b*b+k*k+a*a)}function normalized3(a){var b=a[0],k=a[1];a=a[2];var l=1/Math.sqrt(b*b+k*k+a*a);return[l*b,l*k,l*a]}function dehom3(a){var b=1/a[3];return[b*a[0],b*a[1],b*a[2]]}function scale3(a,b){return[a*b[0],a*b[1],a*b[2]]}function transpose3(a){return[a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]]}function transpose4(a){return[a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]]}
function adj3(a){return[a[4]*a[8]-a[5]*a[7],a[2]*a[7]-a[1]*a[8],a[1]*a[5]-a[2]*a[4],a[5]*a[6]-a[3]*a[8],a[0]*a[8]-a[2]*a[6],a[2]*a[3]-a[0]*a[5],a[3]*a[7]-a[4]*a[6],a[1]*a[6]-a[0]*a[7],a[0]*a[4]-a[1]*a[3]]}function sub3(a,b){return[a[0]-b[0],a[1]-b[1],a[2]-b[2]]}function add3(a,b){return[a[0]+b[0],a[1]+b[1],a[2]+b[2]]}function add4(a,b){return[a[0]+b[0],a[1]+b[1],a[2]+b[2],a[3]+b[3]]}function cross3(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}
function mul4mm(a,b){return[a[0]*b[0]+a[1]*b[4]+a[2]*b[8]+a[3]*b[12],a[0]*b[1]+a[1]*b[5]+a[2]*b[9]+a[3]*b[13],a[0]*b[2]+a[1]*b[6]+a[2]*b[10]+a[3]*b[14],a[0]*b[3]+a[1]*b[7]+a[2]*b[11]+a[3]*b[15],a[4]*b[0]+a[5]*b[4]+a[6]*b[8]+a[7]*b[12],a[4]*b[1]+a[5]*b[5]+a[6]*b[9]+a[7]*b[13],a[4]*b[2]+a[5]*b[6]+a[6]*b[10]+a[7]*b[14],a[4]*b[3]+a[5]*b[7]+a[6]*b[11]+a[7]*b[15],a[8]*b[0]+a[9]*b[4]+a[10]*b[8]+a[11]*b[12],a[8]*b[1]+a[9]*b[5]+a[10]*b[9]+a[11]*b[13],a[8]*b[2]+a[9]*b[6]+a[10]*b[10]+a[11]*b[14],a[8]*b[3]+a[9]*
b[7]+a[10]*b[11]+a[11]*b[15],a[12]*b[0]+a[13]*b[4]+a[14]*b[8]+a[15]*b[12],a[12]*b[1]+a[13]*b[5]+a[14]*b[9]+a[15]*b[13],a[12]*b[2]+a[13]*b[6]+a[14]*b[10]+a[15]*b[14],a[12]*b[3]+a[13]*b[7]+a[14]*b[11]+a[15]*b[15]]}function mul3mv(a,b){return[a[0]*b[0]+a[1]*b[1]+a[2]*b[2],a[3]*b[0]+a[4]*b[1]+a[5]*b[2],a[6]*b[0]+a[7]*b[1]+a[8]*b[2]]}
function mul4mv(a,b){return[a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3],a[4]*b[0]+a[5]*b[1]+a[6]*b[2]+a[7]*b[3],a[8]*b[0]+a[9]*b[1]+a[10]*b[2]+a[11]*b[3],a[12]*b[0]+a[13]*b[1]+a[14]*b[2]+a[15]*b[3]]}function transform4to3(a,b){var k=1/(a[12]*b[0]+a[13]*b[1]+a[14]*b[2]+a[15]*b[3]);return[(a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3])*k,(a[4]*b[0]+a[5]*b[1]+a[6]*b[2]+a[7]*b[3])*k,(a[8]*b[0]+a[9]*b[1]+a[10]*b[2]+a[11]*b[3])*k]}
function triangleNormal(a,b,k){a=dehom3(a);b=sub3(dehom3(b),a);k=sub3(dehom3(k),a);return normalized3(cross3(b,k))};function nestedArrayToCSList(a){return Array.isArray(a)?{ctype:"list",value:a.map(function(a){return nestedArrayToCSList(a)})}:{ctype:"number",value:{real:a,imag:0}}}
function convertObjectToCindyDict(a,b,k){if(a instanceof Object&&k.has(a))return k.get(a);if(Array.isArray(a)){var l=[];a.forEach(function(a){a=convertObjectToCindyDict(a,b,k);null!=a&&l.push(a)});return{ctype:"list",value:l}}if("string"===typeof a||a instanceof String)return{ctype:"string",value:a};if("number"===typeof a&&isFinite(a))return{ctype:"number",value:{real:a,imag:0}};if("boolean"===typeof a)return{ctype:"boolean",value:a};if(null===a||"undefined"===typeof a||"function"===typeof a)return null;
var e={},h=new Map(k);h.set(a,e);for(var n in a)if(!b.has(n)&&a.hasOwnProperty(n)){var B=convertObjectToCindyDict(a[n],b,h);e[n]=B}return{ctype:"JSON",value:e}};(function(a){"object"===typeof exports&&"undefined"!==typeof module?module.exports=a():"function"===typeof define&&define.amd?define([],a):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).Leap=a()})(function(){return function(){function a(b,k,l){function e(n,v){if(!k[n]){if(!b[n]){var B="function"==typeof require&&require;if(!v&&B)return B(n,!0);if(h)return h(n,!0);v=Error("Cannot find module '"+n+"'");throw v.code="MODULE_NOT_FOUND",v;}v=
k[n]={exports:{}};b[n][0].call(v.exports,function(a){return e(b[n][1][a]||a)},v,v.exports,a,b,k,l)}return k[n].exports}for(var h="function"==typeof require&&require,n=0;n<l.length;n++)e(l[n]);return e}return a}()({1:[function(a,b,k){function l(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=t(null),this._eventsCount=0);this._maxListeners=this._maxListeners||void 0}function e(c,f,a,C){var d;if("function"!==typeof a)throw new TypeError('"listener" argument must be a function');
if(d=c._events){d.newListener&&(c.emit("newListener",f,a.listener?a.listener:a),d=c._events);var g=d[f]}else d=c._events=t(null),c._eventsCount=0;g?("function"===typeof g?g=d[f]=C?[a,g]:[g,a]:C?g.unshift(a):g.push(a),g.warned||(a=void 0===c._maxListeners?l.defaultMaxListeners:c._maxListeners)&&0<a&&g.length>a&&(g.warned=!0,a=Error("Possible EventEmitter memory leak detected. "+g.length+' "'+String(f)+'" listeners added. Use emitter.setMaxListeners() to increase limit.'),a.name="MaxListenersExceededWarning",
a.emitter=c,a.type=f,a.count=g.length,"object"===typeof console&&console.warn&&console.warn("%s: %s",a.name,a.message))):(d[f]=a,++c._eventsCount);return c}function h(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],
arguments[1],arguments[2]);default:for(var c=Array(arguments.length),f=0;f<c.length;++f)c[f]=arguments[f];this.listener.apply(this.target,c)}}function n(c,f,a){c={fired:!1,wrapFn:void 0,target:c,type:f,listener:a};f=u.call(h,c);f.listener=a;return c.wrapFn=f}function B(c,f,a){c=c._events;if(!c)return[];f=c[f];if(!f)return[];if("function"===typeof f)return a?[f.listener||f]:[f];if(a)for(a=Array(f.length),c=0;c<a.length;++c)a[c]=f[c].listener||f[c];else a=A(f,f.length);return a}function v(c){var d=
this._events;if(d){c=d[c];if("function"===typeof c)return 1;if(c)return c.length}return 0}function A(c,f){for(var d=Array(f),g=0;g<f;++g)d[g]=c[g];return d}function w(c){var d=function(){};d.prototype=c;return new d}function p(c){var d=[],f;for(f in c)Object.prototype.hasOwnProperty.call(c,f)&&d.push(f);return f}function q(c){var d=this;return function(){return d.apply(c,arguments)}}var t=Object.create||w,r=Object.keys||p,u=Function.prototype.bind||q;b.exports=l;l.EventEmitter=l;l.prototype._events=
void 0;l.prototype._maxListeners=void 0;var f=10;try{a={};Object.defineProperty&&Object.defineProperty(a,"x",{value:0});var c=0===a.x}catch(d){c=!1}c?Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(c){if("number"!==typeof c||0>c||c!==c)throw new TypeError('"defaultMaxListeners" must be a positive number');f=c}}):l.defaultMaxListeners=f;l.prototype.setMaxListeners=function(c){if("number"!==typeof c||0>c||isNaN(c))throw new TypeError('"n" argument must be a positive number');
this._maxListeners=c;return this};l.prototype.getMaxListeners=function(){return void 0===this._maxListeners?l.defaultMaxListeners:this._maxListeners};l.prototype.emit=function(c){var d,f,a;var D="error"===c;if(a=this._events)D=D&&null==a.error;else if(!D)return!1;if(D){1<arguments.length&&(d=arguments[1]);if(d instanceof Error)throw d;a=Error('Unhandled "error" event. ('+d+")");a.context=d;throw a;}d=a[c];if(!d)return!1;a="function"===typeof d;var b=arguments.length;switch(b){case 1:if(a)d.call(this);
else for(a=d.length,d=A(d,a),D=0;D<a;++D)d[D].call(this);break;case 2:D=arguments[1];if(a)d.call(this,D);else for(a=d.length,d=A(d,a),b=0;b<a;++b)d[b].call(this,D);break;case 3:D=arguments[1];b=arguments[2];if(a)d.call(this,D,b);else for(a=d.length,d=A(d,a),f=0;f<a;++f)d[f].call(this,D,b);break;case 4:D=arguments[1];b=arguments[2];f=arguments[3];if(a)d.call(this,D,b,f);else{a=d.length;d=A(d,a);for(var m=0;m<a;++m)d[m].call(this,D,b,f)}break;default:D=Array(b-1);for(f=1;f<b;f++)D[f-1]=arguments[f];
if(a)d.apply(this,D);else for(a=d.length,d=A(d,a),b=0;b<a;++b)d[b].apply(this,D)}return!0};l.prototype.addListener=function(c,f){return e(this,c,f,!1)};l.prototype.on=l.prototype.addListener;l.prototype.prependListener=function(c,f){return e(this,c,f,!0)};l.prototype.once=function(c,f){if("function"!==typeof f)throw new TypeError('"listener" argument must be a function');this.on(c,n(this,c,f));return this};l.prototype.prependOnceListener=function(c,f){if("function"!==typeof f)throw new TypeError('"listener" argument must be a function');
this.prependListener(c,n(this,c,f));return this};l.prototype.removeListener=function(c,f){var d;if("function"!==typeof f)throw new TypeError('"listener" argument must be a function');var g=this._events;if(!g)return this;var a=g[c];if(!a)return this;if(a===f||a.listener===f)0===--this._eventsCount?this._events=t(null):(delete g[c],g.removeListener&&this.emit("removeListener",c,a.listener||f));else if("function"!==typeof a){var b=-1;for(d=a.length-1;0<=d;d--)if(a[d]===f||a[d].listener===f){var m=a[d].listener;
b=d;break}if(0>b)return this;if(0===b)a.shift();else{d=b+1;for(var e=a.length;d<e;b+=1,d+=1)a[b]=a[d];a.pop()}1===a.length&&(g[c]=a[0]);g.removeListener&&this.emit("removeListener",c,m||f)}return this};l.prototype.removeAllListeners=function(c){var d=this._events;if(!d)return this;if(!d.removeListener)return 0===arguments.length?(this._events=t(null),this._eventsCount=0):d[c]&&(0===--this._eventsCount?this._events=t(null):delete d[c]),this;if(0===arguments.length){var f=r(d);for(d=0;d<f.length;++d){var a=
f[d];"removeListener"!==a&&this.removeAllListeners(a)}this.removeAllListeners("removeListener");this._events=t(null);this._eventsCount=0;return this}f=d[c];if("function"===typeof f)this.removeListener(c,f);else if(f)for(d=f.length-1;0<=d;d--)this.removeListener(c,f[d]);return this};l.prototype.listeners=function(c){return B(this,c,!0)};l.prototype.rawListeners=function(c){return B(this,c,!1)};l.listenerCount=function(c,f){return"function"===typeof c.listenerCount?c.listenerCount(f):v.call(c,f)};l.prototype.listenerCount=
v;l.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}],2:[function(a,b,k){a("./pointable");k=a("gl-matrix");var l=k.vec3,e=k.mat3,h=k.mat4;a("underscore");a=b.exports=function(a,b){this.finger=a;this._matrix=this._center=null;this.type=b.type;this.prevJoint=b.prevJoint;this.nextJoint=b.nextJoint;this.width=b.width;a=Array(3);l.sub(a,b.nextJoint,b.prevJoint);this.length=l.length(a);this.basis=b.basis};a.prototype.left=function(){return this._left?this._left:
this._left=0>e.determinant(this.basis[0].concat(this.basis[1]).concat(this.basis[2]))};a.prototype.matrix=function(){if(this._matrix)return this._matrix;var a=this.basis,b=this._matrix=h.create();b[0]=a[0][0];b[1]=a[0][1];b[2]=a[0][2];b[4]=a[1][0];b[5]=a[1][1];b[6]=a[1][2];b[8]=a[2][0];b[9]=a[2][1];b[10]=a[2][2];b[3]=this.center()[0];b[7]=this.center()[1];b[11]=this.center()[2];this.left()&&(b[0]*=-1,b[1]*=-1,b[2]*=-1);return this._matrix};a.prototype.lerp=function(a,b){l.lerp(a,this.prevJoint,this.nextJoint,
b)};a.prototype.center=function(){if(this._center)return this._center;var a=l.create();this.lerp(a,.5);return this._center=a};a.prototype.direction=function(){return[-1*this.basis[2][0],-1*this.basis[2][1],-1*this.basis[2][2]]}},{"./pointable":16,"gl-matrix":22,underscore:25}],3:[function(a,b,k){a=b.exports=function(a){this.pos=0;this._buf=[];this.size=a};a.prototype.get=function(a){void 0==a&&(a=0);if(!(a>=this.size||a>=this._buf.length))return this._buf[(this.pos-a-1)%this.size]};a.prototype.push=
function(a){this._buf[this.pos%this.size]=a;return this.pos++}},{}],4:[function(a,b,k){var l=a("../protocol").chooseProtocol;k=a("events").EventEmitter;var e=a("underscore"),h=b.exports=function(a){this.opts=e.defaults(a||{},{host:"127.0.0.1",enableGestures:!1,scheme:this.getScheme(),port:this.getPort(),background:!1,optimizeHMD:!1,requestProtocolVersion:h.defaultProtocolVersion});this.host=this.opts.host;this.port=this.opts.port;this.scheme=this.opts.scheme;this.protocolVersionVerified=!1;this.optimizeHMD=
this.background=null;this.on("ready",function(){this.enableGestures(this.opts.enableGestures);this.setBackground(this.opts.background);this.setOptimizeHMD(this.opts.optimizeHMD);this.opts.optimizeHMD?console.log("Optimized for head mounted display usage."):console.log("Optimized for desktop usage.")})};h.defaultProtocolVersion=6;h.prototype.getUrl=function(){return this.scheme+"//"+this.host+":"+this.port+"/v"+this.opts.requestProtocolVersion+".json"};h.prototype.getScheme=function(){return"ws:"};
h.prototype.getPort=function(){return 6437};h.prototype.setBackground=function(a){this.opts.background=a;this.protocol&&this.protocol.sendBackground&&this.background!==this.opts.background&&(this.background=this.opts.background,this.protocol.sendBackground(this,this.opts.background))};h.prototype.setOptimizeHMD=function(a){this.opts.optimizeHMD=a;this.protocol&&this.protocol.sendOptimizeHMD&&this.optimizeHMD!==this.opts.optimizeHMD&&(this.optimizeHMD=this.opts.optimizeHMD,this.protocol.sendOptimizeHMD(this,
this.opts.optimizeHMD))};h.prototype.handleOpen=function(){this.connected||(this.connected=!0,this.emit("connect"))};h.prototype.enableGestures=function(a){this.gesturesEnabled=a?!0:!1;this.send(this.protocol.encode({enableGestures:this.gesturesEnabled}))};h.prototype.handleClose=function(a,b){this.connected&&(this.disconnect(),1001===a&&1<this.opts.requestProtocolVersion&&(this.protocolVersionVerified?this.protocolVersionVerified=!1:this.opts.requestProtocolVersion--),this.startReconnection())};
h.prototype.startReconnection=function(){var a=this;this.reconnectionTimer||(this.reconnectionTimer=setInterval(function(){a.reconnect()},500))};h.prototype.stopReconnection=function(){this.reconnectionTimer=clearInterval(this.reconnectionTimer)};h.prototype.disconnect=function(a){a||this.stopReconnection();if(this.socket)return this.socket.close(),delete this.socket,delete this.protocol,delete this.background,delete this.optimizeHMD,delete this.focusedState,this.connected&&(this.connected=!1,this.emit("disconnect")),
!0};h.prototype.reconnect=function(){this.connected?this.stopReconnection():(this.disconnect(!0),this.connect())};h.prototype.handleData=function(a){a=JSON.parse(a);void 0===this.protocol?(a=this.protocol=l(a),this.protocolVersionVerified=!0,this.emit("ready")):a=this.protocol(a);this.emit(a.type,a)};h.prototype.connect=function(){if(!this.socket)return this.socket=this.setupSocket(),!0};h.prototype.send=function(a){this.socket.send(a)};h.prototype.reportFocus=function(a){this.connected&&this.focusedState!==
a&&(this.focusedState=a,this.emit(this.focusedState?"focus":"blur"),this.protocol&&this.protocol.sendFocused&&this.protocol.sendFocused(this,this.focusedState))};e.extend(h.prototype,k.prototype)},{"../protocol":17,events:1,underscore:25}],5:[function(a,b,k){var l=b.exports=a("./base");a=a("underscore");b=b.exports=function(a){l.call(this,a);var b=this;this.on("ready",function(){b.startFocusLoop()});this.on("disconnect",function(){b.stopFocusLoop()})};a.extend(b.prototype,l.prototype);b.__proto__=
l;b.prototype.useSecure=function(){return"https:"===location.protocol};b.prototype.getScheme=function(){return this.useSecure()?"wss:":"ws:"};b.prototype.getPort=function(){return this.useSecure()?6436:6437};b.prototype.setupSocket=function(){var a=this,b=new WebSocket(this.getUrl());b.onopen=function(){a.handleOpen()};b.onclose=function(b){a.handleClose(b.code,b.reason)};b.onmessage=function(b){a.handleData(b.data)};b.onerror=function(b){a.useSecure()&&"wss:"===a.scheme&&(a.scheme="ws:",a.port=6437,
a.disconnect(),a.connect())};return b};b.prototype.startFocusLoop=function(){if(!this.focusDetectorTimer){var a=this,b=null;b="undefined"!==typeof document.hidden?"hidden":"undefined"!==typeof document.mozHidden?"mozHidden":"undefined"!==typeof document.msHidden?"msHidden":"undefined"!==typeof document.webkitHidden?"webkitHidden":void 0;void 0===a.windowVisible&&(a.windowVisible=void 0===b?!0:!1===document[b]);var n=window.addEventListener("focus",function(b){a.windowVisible=!0;v()}),l=window.addEventListener("blur",
function(b){a.windowVisible=!1;v()});this.on("disconnect",function(){window.removeEventListener("focus",n);window.removeEventListener("blur",l)});var v=function(){a.reportFocus((void 0===b?!0:!1===document[b])&&a.windowVisible)};v();this.focusDetectorTimer=setInterval(v,100)}};b.prototype.stopFocusLoop=function(){this.focusDetectorTimer&&(clearTimeout(this.focusDetectorTimer),delete this.focusDetectorTimer)}},{"./base":4,underscore:25}],6:[function(a,b,k){var l=a("ws"),e=a("./base");a=a("underscore");
b=b.exports=function(a){e.call(this,a);var b=this;this.on("ready",function(){b.reportFocus(!0)})};a.extend(b.prototype,e.prototype);b.__proto__=e;b.prototype.setupSocket=function(){var a=this,b=new l(this.getUrl());b.on("open",function(){a.handleOpen()});b.on("message",function(b){a.handleData(b)});b.on("close",function(b,e){a.handleClose(b,e)});b.on("error",function(){a.startReconnection()});return b}},{"./base":4,underscore:25,ws:23}],7:[function(a,b,k){(function(l){var e=a("./frame"),h=a("./hand"),
n=a("./pointable"),k=a("./finger"),v=a("./circular_buffer"),A=a("./pipeline"),w=a("events").EventEmitter,p=a("./gesture").gestureListener,q=a("./dialog"),t=a("underscore"),r=b.exports=function(b){var f=this;b=t.defaults(b||{},{inNode:"undefined"!==typeof l&&l.versions&&l.versions.node});this.inNode=b.inNode;b=t.defaults(b||{},{frameEventName:this.useAnimationLoop()?"animationFrame":"deviceFrame",suppressAnimationLoop:!this.useAnimationLoop(),loopWhileDisconnected:!0,useAllPlugins:!1,checkVersion:!0});
this.animationFrameRequested=!1;this.onAnimationFrame=function(c){f.lastConnectionFrame.valid&&f.emit("animationFrame",f.lastConnectionFrame);f.emit("frameEnd",c);f.loopWhileDisconnected&&(!1!==f.connection.focusedState||f.connection.opts.background)?window.requestAnimationFrame(f.onAnimationFrame):f.animationFrameRequested=!1};this.suppressAnimationLoop=b.suppressAnimationLoop;this.loopWhileDisconnected=b.loopWhileDisconnected;this.frameEventName=b.frameEventName;this.useAllPlugins=b.useAllPlugins;
this.history=new v(200);this.lastConnectionFrame=this.lastValidFrame=this.lastFrame=e.Invalid;this.accumulatedGestures=[];this.checkVersion=b.checkVersion;this.connectionType=void 0===b.connectionType?this.inBrowser()?a("./connection/browser"):a("./connection/node"):b.connectionType;this.connection=new this.connectionType(b);this.streamingCount=0;this.devices={};this.plugins={};this._pluginPipelineSteps={};this._pluginExtendedMethods={};b.useAllPlugins&&this.useRegisteredPlugins();this.setupFrameEvents(b);
this.setupConnectionEvents();this.startAnimationLoop()};r.prototype.gesture=function(a,f){a=p(this,a);void 0!==f&&a.stop(f);return a};r.prototype.setBackground=function(a){this.connection.setBackground(a);return this};r.prototype.setOptimizeHMD=function(a){this.connection.setOptimizeHMD(a);return this};r.prototype.inBrowser=function(){return!this.inNode};r.prototype.useAnimationLoop=function(){return this.inBrowser()&&!this.inBackgroundPage()};r.prototype.inBackgroundPage=function(){return"undefined"!==
typeof chrome&&chrome.extension&&chrome.extension.getBackgroundPage&&chrome.extension.getBackgroundPage()===window};r.prototype.connect=function(){this.connection.connect();return this};r.prototype.streaming=function(){return 0<this.streamingCount};r.prototype.connected=function(){return!!this.connection.connected};r.prototype.startAnimationLoop=function(){this.suppressAnimationLoop||this.animationFrameRequested||(this.animationFrameRequested=!0,window.requestAnimationFrame(this.onAnimationFrame))};
r.prototype.disconnect=function(){this.connection.disconnect();return this};r.prototype.frame=function(a){return this.history.get(a)||e.Invalid};r.prototype.loop=function(a){if(a)if("function"===typeof a)this.on(this.frameEventName,a);else this.setupFrameEvents(a);return this.connect()};r.prototype.addStep=function(a){this.pipeline||(this.pipeline=new A(this));this.pipeline.addStep(a)};r.prototype.processFrame=function(a){a.gestures&&(this.accumulatedGestures=this.accumulatedGestures.concat(a.gestures));
this.lastConnectionFrame=a;this.startAnimationLoop();this.emit("deviceFrame",a)};r.prototype.processFinishedFrame=function(a){this.lastFrame=a;a.valid&&(this.lastValidFrame=a);a.controller=this;a.historyIdx=this.history.push(a);if(a.gestures){a.gestures=this.accumulatedGestures;this.accumulatedGestures=[];for(var f=0;f!=a.gestures.length;f++)this.emit("gesture",a.gestures[f],a)}this.pipeline&&(a=this.pipeline.run(a),a||(a=e.Invalid));this.emit("frame",a);this.emitHandEvents(a)};r.prototype.emitHandEvents=
function(a){for(var f=0;f<a.hands.length;f++)this.emit("hand",a.hands[f])};r.prototype.setupFrameEvents=function(a){if(a.frame)this.on("frame",a.frame);if(a.hand)this.on("hand",a.hand)};r.prototype.setupConnectionEvents=function(){var a=this;this.connection.on("frame",function(c){a.processFrame(c)});this.on(this.frameEventName,function(c){a.processFinishedFrame(c)});var f=function(){if(5>a.connection.opts.requestProtocolVersion&&0==a.streamingCount){a.streamingCount=1;var c={attached:!0,streaming:!0,
type:"unknown",id:"Lx00000000000"};a.devices[c.id]=c;a.emit("deviceAttached",c);a.emit("deviceStreaming",c);a.emit("streamingStarted",c);a.connection.removeListener("frame",f)}},c=function(){if(0<a.streamingCount){for(var c in a.devices)a.emit("deviceStopped",a.devices[c]),a.emit("deviceRemoved",a.devices[c]);a.emit("streamingStopped",a.devices[c]);a.streamingCount=0;for(c in a.devices)delete a.devices[c]}};this.connection.on("focus",function(){a.loopWhileDisconnected&&a.startAnimationLoop();a.emit("focus")});
this.connection.on("blur",function(){a.emit("blur")});this.connection.on("protocol",function(c){c.on("beforeFrameCreated",function(c){a.emit("beforeFrameCreated",c)});c.on("afterFrameCreated",function(c,d){a.emit("afterFrameCreated",c,d)});a.emit("protocol",c)});this.connection.on("ready",function(){a.checkVersion&&!a.inNode&&a.checkOutOfDate();a.emit("ready")});this.connection.on("connect",function(){a.emit("connect");a.connection.removeListener("frame",f);a.connection.on("frame",f)});this.connection.on("disconnect",
function(){a.emit("disconnect");c()});this.connection.on("deviceConnect",function(d){d.state?(a.emit("deviceConnected"),a.connection.removeListener("frame",f),a.connection.on("frame",f)):(a.emit("deviceDisconnected"),c())});this.connection.on("deviceEvent",function(c){c=c.state;var d=a.devices[c.id],f={},b;for(b in c)d&&d.hasOwnProperty(b)&&d[b]==c[b]||(f[b]=!0);a.devices[c.id]=c;f.attached&&a.emit(c.attached?"deviceAttached":"deviceRemoved",c);f.streaming&&(c.streaming?(a.streamingCount++,a.emit("deviceStreaming",
c),1==a.streamingCount&&a.emit("streamingStarted",c),f.attached||a.emit("deviceConnected")):f.attached&&c.attached||(a.streamingCount--,a.emit("deviceStopped",c),0==a.streamingCount&&a.emit("streamingStopped",c),a.emit("deviceDisconnected")))});this.on("newListener",function(c,f){"deviceConnected"!=c&&"deviceDisconnected"!=c||console.warn(c+" events are depricated.  Consider using 'streamingStarted/streamingStopped' or 'deviceStreaming/deviceStopped' instead")})};r.prototype.checkOutOfDate=function(){console.assert(this.connection&&
this.connection.protocol);var a=this.connection.protocol.serviceVersion,f=this.connection.protocol.version,c=this.connectionType.defaultProtocolVersion;return c>f?(console.warn("Your Protocol Version is v"+f+", this app was designed for v"+c),q.warnOutOfDate({sV:a,pV:f}),!0):!1};r._pluginFactories={};r.plugin=function(a,f){this._pluginFactories[a]&&console.warn('Plugin "'+a+'" already registered');return this._pluginFactories[a]=f};r.plugins=function(){return t.keys(this._pluginFactories)};r.prototype.use=
function(a,f){var c;var d="function"==typeof a?a:r._pluginFactories[a];if(!d)throw"Leap Plugin "+a+" not found.";f||(f={});if(this.plugins[a])return t.extend(this.plugins[a],f),this;this.plugins[a]=f;f=d.call(this,f);for(c in f)if(d=f[c],"function"===typeof d){var g=a,E=c;if(-1!=["beforeFrameCreated","afterFrameCreated"].indexOf(E))this.on(E,d);else this.pipeline||(this.pipeline=new A(this)),this._pluginPipelineSteps[g]||(this._pluginPipelineSteps[g]=[]),this._pluginPipelineSteps[g].push(this.pipeline.addWrappedStep(E,
d))}else{g=a;E=c;this._pluginExtendedMethods[g]||(this._pluginExtendedMethods[g]=[]);switch(E){case "frame":E=e;break;case "hand":E=h;break;case "pointable":E=n;t.extend(k.prototype,d);t.extend(k.Invalid,d);break;case "finger":E=k;break;default:throw g+' specifies invalid object type "'+E+'" for prototypical extension';}t.extend(E.prototype,d);t.extend(E.Invalid,d);this._pluginExtendedMethods[g].push([E,d])}return this};r.prototype.stopUsing=function(a){var f=this._pluginPipelineSteps[a],c=this._pluginExtendedMethods[a],
d;if(this.plugins[a]){if(f)for(d=0;d<f.length;d++)this.pipeline.removeStep(f[d]);if(c)for(d=0;d<c.length;d++){f=c[d][0];var g=c[d][1];for(var E in g)delete f.prototype[E],delete f.Invalid[E]}delete this.plugins[a];return this}};r.prototype.useRegisteredPlugins=function(){for(var a in r._pluginFactories)this.use(a)};t.extend(r.prototype,w.prototype)}).call(this,a("_process"))},{"./circular_buffer":3,"./connection/browser":5,"./connection/node":6,"./dialog":8,"./finger":9,"./frame":10,"./gesture":11,
"./hand":12,"./pipeline":15,"./pointable":16,_process:24,events:1,underscore:25}],8:[function(a,b,k){(function(a){var e=b.exports=function(a,b){this.options=b||{};this.message=a;this.createElement()};e.prototype.createElement=function(){this.element=document.createElement("div");this.element.className="leapjs-dialog";this.element.style.position="fixed";this.element.style.top="8px";this.element.style.left=0;this.element.style.right=0;this.element.style.textAlign="center";this.element.style.zIndex=
1E3;var a=document.createElement("div");this.element.appendChild(a);a.style.className="leapjs-dialog";a.style.display="inline-block";a.style.margin="auto";a.style.padding="8px";a.style.color="#222";a.style.background="#eee";a.style.borderRadius="4px";a.style.border="1px solid #999";a.style.textAlign="left";a.style.cursor="pointer";a.style.whiteSpace="nowrap";a.style.transition="box-shadow 1s linear";a.innerHTML=this.message;this.options.onclick&&a.addEventListener("click",this.options.onclick);this.options.onmouseover&&
a.addEventListener("mouseover",this.options.onmouseover);this.options.onmouseout&&a.addEventListener("mouseout",this.options.onmouseout);this.options.onmousemove&&a.addEventListener("mousemove",this.options.onmousemove)};e.prototype.show=function(){document.body.appendChild(this.element);return this};e.prototype.hide=function(){document.body.removeChild(this.element);return this};e.warnOutOfDate=function(a){a||(a={});var b="http://developer.leapmotion.com?";a.returnTo=window.location.href;for(var h in a)b+=
h+"="+encodeURIComponent(a[h])+"&";var l=new e("This site requires Leap Motion Tracking V2.<button id='leapjs-accept-upgrade'  style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 16px;'>Upgrade</button><button id='leapjs-decline-upgrade' style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 8px; '>Not Now</button>",{onclick:function(a){"leapjs-decline-upgrade"!=a.target.id&&(a=window.open(b,
"_blank","height=800,width=1000,location=1,menubar=1,resizable=1,status=1,toolbar=1,scrollbars=1"),window.focus&&a.focus());l.hide();return!0},onmousemove:function(a){a.target==document.getElementById("leapjs-decline-upgrade")?(document.getElementById("leapjs-decline-upgrade").style.color="#000",document.getElementById("leapjs-decline-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow=
"none"):(document.getElementById("leapjs-accept-upgrade").style.color="#000",document.getElementById("leapjs-accept-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none")},onmouseout:function(){document.getElementById("leapjs-decline-upgrade").style.color="#444";document.getElementById("leapjs-decline-upgrade").style.boxShadow="none";document.getElementById("leapjs-accept-upgrade").style.color=
"#444";document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"}});return l.show()};e.hasWarnedBones=!1;e.warnBones=function(){this.hasWarnedBones||(this.hasWarnedBones=!0,console.warn("Your Leap Service is out of date"),"undefined"!==typeof a&&a.versions&&a.versions.node||this.warnOutOfDate({reason:"bones"}))}}).call(this,a("_process"))},{_process:24}],9:[function(a,b,k){var l=a("./pointable"),e=a("./bone"),h=a("./dialog");a=a("underscore");b=b.exports=function(a){l.call(this,a);this.dipPosition=
a.dipPosition;this.pipPosition=a.pipPosition;this.mcpPosition=a.mcpPosition;this.carpPosition=a.carpPosition;this.extended=a.extended;this.type=a.type;this.finger=!0;this.positions=[this.carpPosition,this.mcpPosition,this.pipPosition,this.dipPosition,this.tipPosition];a.bases?this.addBones(a):h.warnBones()};a.extend(b.prototype,l.prototype);b.prototype.addBones=function(a){this.metacarpal=new e(this,{type:0,width:this.width,prevJoint:this.carpPosition,nextJoint:this.mcpPosition,basis:a.bases[0]});
this.proximal=new e(this,{type:1,width:this.width,prevJoint:this.mcpPosition,nextJoint:this.pipPosition,basis:a.bases[1]});this.medial=new e(this,{type:2,width:this.width,prevJoint:this.pipPosition,nextJoint:this.dipPosition,basis:a.bases[2]});this.distal=new e(this,{type:3,width:this.width,prevJoint:this.dipPosition,nextJoint:a.btipPosition,basis:a.bases[3]});this.bones=[this.metacarpal,this.proximal,this.medial,this.distal]};b.prototype.toString=function(){return"Finger [ id:"+this.id+" "+this.length+
"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"};b.Invalid={valid:!1}},{"./bone":2,"./dialog":8,"./pointable":16,underscore:25}],10:[function(a,b,k){var l=a("./hand"),e=a("./pointable"),h=a("./gesture").createGesture;k=a("gl-matrix");var n=k.mat3,B=k.vec3,v=a("./interaction_box"),A=a("./finger"),w=a("underscore");a=b.exports=function(a){this.valid=!0;this.id=a.id;this.timestamp=a.timestamp;this.hands=[];this.handsMap={};this.pointables=[];this.tools=[];this.fingers=[];a.interactionBox&&
(this.interactionBox=new v(a.interactionBox));this.gestures=[];this.pointablesMap={};this._translation=a.t;this._rotation=w.flatten(a.r);this._scaleFactor=a.s;this.data=a;this.type="frame";this.currentFrameRate=a.currentFrameRate;if(a.gestures)for(var b=0,e=a.gestures.length;b!=e;b++)this.gestures.push(h(a.gestures[b]));this.postprocessData(a)};a.prototype.postprocessData=function(a){a||(a=this.data);for(var b=0,h=a.hands.length;b!=h;b++){var n=new l(a.hands[b]);n.frame=this;this.hands.push(n);this.handsMap[n.id]=
n}a.pointables=w.sortBy(a.pointables,function(a){return a.id});b=0;for(h=a.pointables.length;b!=h;b++)n=a.pointables[b],n=n.dipPosition?new A(n):new e(n),n.frame=this,this.addPointable(n)};a.prototype.addPointable=function(a){this.pointables.push(a);this.pointablesMap[a.id]=a;(a.tool?this.tools:this.fingers).push(a);if(void 0!==a.handId&&this.handsMap.hasOwnProperty(a.handId)){var b=this.handsMap[a.handId];b.pointables.push(a);(a.tool?b.tools:b.fingers).push(a);switch(a.type){case 0:b.thumb=a;break;
case 1:b.indexFinger=a;break;case 2:b.middleFinger=a;break;case 3:b.ringFinger=a;break;case 4:b.pinky=a}}};a.prototype.tool=function(a){a=this.pointable(a);return a.tool?a:e.Invalid};a.prototype.pointable=function(a){return this.pointablesMap[a]||e.Invalid};a.prototype.finger=function(a){a=this.pointable(a);return a.tool?e.Invalid:a};a.prototype.hand=function(a){return this.handsMap[a]||l.Invalid};a.prototype.rotationAngle=function(a,b){if(!this.valid||!a.valid)return 0;var e=this.rotationMatrix(a);
e=Math.acos(.5*(e[0]+e[4]+e[8]-1));e=isNaN(e)?0:e;void 0!==b&&(a=this.rotationAxis(a),e*=B.dot(a,B.normalize(B.create(),b)));return e};a.prototype.rotationAxis=function(a){return this.valid&&a.valid?B.normalize(B.create(),[this._rotation[7]-a._rotation[5],this._rotation[2]-a._rotation[6],this._rotation[3]-a._rotation[1]]):B.create()};a.prototype.rotationMatrix=function(a){if(!this.valid||!a.valid)return n.create();var b=n.transpose(n.create(),this._rotation);return n.multiply(n.create(),a._rotation,
b)};a.prototype.scaleFactor=function(a){return this.valid&&a.valid?Math.exp(this._scaleFactor-a._scaleFactor):1};a.prototype.translation=function(a){return this.valid&&a.valid?B.subtract(B.create(),this._translation,a._translation):B.create()};a.prototype.toString=function(){var a="Frame [ id:"+this.id+" | timestamp:"+this.timestamp+" | Hand count:("+this.hands.length+") | Pointable count:("+this.pointables.length+")";this.gestures&&(a+=" | Gesture count:("+this.gestures.length+")");return a+" ]"};
a.prototype.dump=function(){var a="Frame Info:<br/>"+this.toString();a+="<br/><br/>Hands:<br/>";for(var b=0,e=this.hands.length;b!=e;b++)a+="  "+this.hands[b].toString()+"<br/>";a+="<br/><br/>Pointables:<br/>";b=0;for(e=this.pointables.length;b!=e;b++)a+="  "+this.pointables[b].toString()+"<br/>";if(this.gestures)for(a+="<br/><br/>Gestures:<br/>",b=0,e=this.gestures.length;b!=e;b++)a+="  "+this.gestures[b].toString()+"<br/>";return a=a+"<br/><br/>Raw JSON:<br/>"+JSON.stringify(this.data)};a.Invalid=
{valid:!1,hands:[],fingers:[],tools:[],gestures:[],pointables:[],pointable:function(){return e.Invalid},finger:function(){return e.Invalid},hand:function(){return l.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return n.create()},rotationAxis:function(){return B.create()},scaleFactor:function(){return 1},translation:function(){return B.create()}}},{"./finger":9,"./gesture":11,"./hand":12,"./interaction_box":14,
"./pointable":16,"gl-matrix":22,underscore:25}],11:[function(a,b,k){var l=a("gl-matrix").vec3;b=a("events").EventEmitter;var e=a("underscore");k.createGesture=function(a){switch(a.type){case "circle":var b=new n(a);break;case "swipe":b=new B(a);break;case "screenTap":b=new v(a);break;case "keyTap":b=new A(a);break;default:throw"unknown gesture type";}b.id=a.id;b.handIds=a.handIds.slice();b.pointableIds=a.pointableIds.slice();b.duration=a.duration;b.state=a.state;b.type=a.type;return b};k.gestureListener=
function(a,b){var n={},l={};a.on("gesture",function(a,f){if(a.type==b){if(("start"==a.state||"stop"==a.state)&&void 0===l[a.id]){var c=new h(a,f);l[a.id]=c;e.each(n,function(d,f){c.on(f,d)})}l[a.id].update(a,f);"stop"==a.state&&delete l[a.id]}});var v={start:function(a){n.start=a;return v},stop:function(a){n.stop=a;return v},complete:function(a){n.stop=a;return v},update:function(a){n.update=a;return v}};return v};var h=k.Gesture=function(a,b){this.gestures=[a];this.frames=[b]};h.prototype.update=
function(a,b){this.lastGesture=a;this.lastFrame=b;this.gestures.push(a);this.frames.push(b);this.emit(a.state,this)};h.prototype.translation=function(){return l.subtract(l.create(),this.lastGesture.startPosition,this.lastGesture.position)};e.extend(h.prototype,b.prototype);var n=function(a){this.center=a.center;this.normal=a.normal;this.progress=a.progress;this.radius=a.radius};n.prototype.toString=function(){return"CircleGesture ["+JSON.stringify(this)+"]"};var B=function(a){this.startPosition=a.startPosition;
this.position=a.position;this.direction=a.direction;this.speed=a.speed};B.prototype.toString=function(){return"SwipeGesture ["+JSON.stringify(this)+"]"};var v=function(a){this.position=a.position;this.direction=a.direction;this.progress=a.progress};v.prototype.toString=function(){return"ScreenTapGesture ["+JSON.stringify(this)+"]"};var A=function(a){this.position=a.position;this.direction=a.direction;this.progress=a.progress};A.prototype.toString=function(){return"KeyTapGesture ["+JSON.stringify(this)+
"]"}},{events:1,"gl-matrix":22,underscore:25}],12:[function(a,b,k){var l=a("./pointable"),e=a("./bone");k=a("gl-matrix");var h=k.mat3,n=k.vec3,B=a("underscore");a=b.exports=function(a){this.id=a.id;this.palmPosition=a.palmPosition;this.direction=a.direction;this.palmVelocity=a.palmVelocity;this.palmNormal=a.palmNormal;this.sphereCenter=a.sphereCenter;this.sphereRadius=a.sphereRadius;this.valid=!0;this.pointables=[];this.fingers=[];this.arm=a.armBasis?new e(this,{type:4,width:a.armWidth,prevJoint:a.elbow,
nextJoint:a.wrist,basis:a.armBasis}):null;this.tools=[];this._translation=a.t;this._rotation=B.flatten(a.r);this._scaleFactor=a.s;this.timeVisible=a.timeVisible;this.stabilizedPalmPosition=a.stabilizedPalmPosition;this.type=a.type;this.grabStrength=a.grabStrength;this.pinchStrength=a.pinchStrength;this.confidence=a.confidence};a.prototype.finger=function(a){return(a=this.frame.finger(a))&&a.handId==this.id?a:l.Invalid};a.prototype.rotationAngle=function(a,b){if(!this.valid||!a.valid||!a.hand(this.id).valid)return 0;
var e=this.rotationMatrix(a);e=Math.acos(.5*(e[0]+e[4]+e[8]-1));e=isNaN(e)?0:e;void 0!==b&&(a=this.rotationAxis(a),e*=n.dot(a,n.normalize(n.create(),b)));return e};a.prototype.rotationAxis=function(a){if(!this.valid||!a.valid)return n.create();a=a.hand(this.id);return a.valid?n.normalize(n.create(),[this._rotation[7]-a._rotation[5],this._rotation[2]-a._rotation[6],this._rotation[3]-a._rotation[1]]):n.create()};a.prototype.rotationMatrix=function(a){if(!this.valid||!a.valid)return h.create();a=a.hand(this.id);
if(!a.valid)return h.create();var b=h.transpose(h.create(),this._rotation);return h.multiply(h.create(),a._rotation,b)};a.prototype.scaleFactor=function(a){if(!this.valid||!a.valid)return 1;a=a.hand(this.id);return a.valid?Math.exp(this._scaleFactor-a._scaleFactor):1};a.prototype.translation=function(a){if(!this.valid||!a.valid)return n.create();a=a.hand(this.id);return a.valid?[this._translation[0]-a._translation[0],this._translation[1]-a._translation[1],this._translation[2]-a._translation[2]]:n.create()};
a.prototype.toString=function(){return"Hand ("+this.type+") [ id: "+this.id+" | palm velocity:"+this.palmVelocity+" | sphere center:"+this.sphereCenter+" ] "};a.prototype.pitch=function(){return Math.atan2(this.direction[1],-this.direction[2])};a.prototype.yaw=function(){return Math.atan2(this.direction[0],-this.direction[2])};a.prototype.roll=function(){return Math.atan2(this.palmNormal[0],-this.palmNormal[1])};a.Invalid={valid:!1,fingers:[],tools:[],pointables:[],left:!1,pointable:function(){return l.Invalid},
finger:function(){return l.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return h.create()},rotationAxis:function(){return n.create()},scaleFactor:function(){return 1},translation:function(){return n.create()}}},{"./bone":2,"./pointable":16,"gl-matrix":22,underscore:25}],13:[function(a,b,k){b.exports={Controller:a("./controller"),Frame:a("./frame"),Gesture:a("./gesture"),Hand:a("./hand"),Pointable:a("./pointable"),
Finger:a("./finger"),InteractionBox:a("./interaction_box"),CircularBuffer:a("./circular_buffer"),UI:a("./ui"),JSONProtocol:a("./protocol").JSONProtocol,glMatrix:a("gl-matrix"),mat3:a("gl-matrix").mat3,vec3:a("gl-matrix").vec3,loopController:void 0,version:a("./version.js"),_:a("underscore"),EventEmitter:a("events").EventEmitter,loop:function(a,b){a&&void 0===b&&"[object Function]"==={}.toString.call(a)&&(b=a,a={});this.loopController?a&&this.loopController.setupFrameEvents(a):this.loopController=
new this.Controller(a);this.loopController.loop(b);return this.loopController},plugin:function(a,b){this.Controller.plugin(a,b)}}},{"./circular_buffer":3,"./controller":7,"./finger":9,"./frame":10,"./gesture":11,"./hand":12,"./interaction_box":14,"./pointable":16,"./protocol":17,"./ui":18,"./version.js":21,events:1,"gl-matrix":22,underscore:25}],14:[function(a,b,k){var l=a("gl-matrix").vec3;a=b.exports=function(a){this.valid=!0;this.center=a.center;this.size=a.size;this.width=a.size[0];this.height=
a.size[1];this.depth=a.size[2]};a.prototype.denormalizePoint=function(a){return l.fromValues((a[0]-.5)*this.size[0]+this.center[0],(a[1]-.5)*this.size[1]+this.center[1],(a[2]-.5)*this.size[2]+this.center[2])};a.prototype.normalizePoint=function(a,b){a=l.fromValues((a[0]-this.center[0])/this.size[0]+.5,(a[1]-this.center[1])/this.size[1]+.5,(a[2]-this.center[2])/this.size[2]+.5);b&&(a[0]=Math.min(Math.max(a[0],0),1),a[1]=Math.min(Math.max(a[1],0),1),a[2]=Math.min(Math.max(a[2],0),1));return a};a.prototype.toString=
function(){return"InteractionBox [ width:"+this.width+" | height:"+this.height+" | depth:"+this.depth+" ]"};a.Invalid={valid:!1}},{"gl-matrix":22}],15:[function(a,b,k){a=b.exports=function(a){this.steps=[];this.controller=a};a.prototype.addStep=function(a){this.steps.push(a)};a.prototype.run=function(a){for(var b=this.steps.length,h=0;h!=b&&a;h++)a=this.steps[h](a);return a};a.prototype.removeStep=function(a){a=this.steps.indexOf(a);if(-1===a)throw"Step not found in pipeline";this.steps.splice(a,
1)};a.prototype.addWrappedStep=function(a,b){var e=this.controller,n=function(h){var n;var l="frame"==a?[h]:h[a+"s"]||[];var k=0;for(n=l.length;k<n;k++)b.call(e,l[k]);return h};this.addStep(n);return n}},{}],16:[function(a,b,k){a("gl-matrix");a=b.exports=function(a){this.valid=!0;this.id=a.id;this.handId=a.handId;this.length=a.length;this.tool=a.tool;this.width=a.width;this.direction=a.direction;this.stabilizedTipPosition=a.stabilizedTipPosition;this.tipPosition=a.tipPosition;this.tipVelocity=a.tipVelocity;
this.touchZone=a.touchZone;this.touchDistance=a.touchDistance;this.timeVisible=a.timeVisible};a.prototype.toString=function(){return"Pointable [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"};a.prototype.hand=function(){return this.frame.hand(this.handId)};a.Invalid={valid:!1}},{"gl-matrix":22}],17:[function(a,b,k){var l=a("./frame");a("./hand");a("./pointable");a("./finger");var e=a("underscore"),h=a("events").EventEmitter,n=function(a){this.type=a.type;
this.state=a.state};k.chooseProtocol=function(a){switch(a.version){case 1:case 2:case 3:case 4:case 5:case 6:var b=B(a);b.sendBackground=function(a,e){a.send(b.encode({background:e}))};b.sendFocused=function(a,e){a.send(b.encode({focused:e}))};b.sendOptimizeHMD=function(a,e){a.send(b.encode({optimizeHMD:e}))};break;default:throw"unrecognized version";}return b};var B=k.JSONProtocol=function(a){var b=function(a){if(a.event)return new n(a.event);b.emit("beforeFrameCreated",a);var e=new l(a);b.emit("afterFrameCreated",
e,a);return e};b.encode=function(a){return JSON.stringify(a)};b.version=a.version;b.serviceVersion=a.serviceVersion;b.versionLong="Version "+a.version;b.type="protocol";e.extend(b,h.prototype);return b}},{"./finger":9,"./frame":10,"./hand":12,"./pointable":16,events:1,underscore:25}],18:[function(a,b,k){k.UI={Region:a("./ui/region"),Cursor:a("./ui/cursor")}},{"./ui/cursor":19,"./ui/region":20}],19:[function(a,b,k){b.exports=function(){return function(a){var b=a.pointables.sort(function(a,b){return a.z-
b.z})[0];b&&b.valid&&(a.cursorPosition=b.tipPosition);return a}}},{}],20:[function(a,b,k){k=a("events").EventEmitter;a=a("underscore");var l=b.exports=function(a,b){this.start=new Vector(a);this.end=new Vector(b);this.enteredFrame=null};l.prototype.hasPointables=function(a){for(var b=0;b!=a.pointables.length;b++){var e=a.pointables[b].tipPosition;if(e.x>=this.start.x&&e.x<=this.end.x&&e.y>=this.start.y&&e.y<=this.end.y&&e.z>=this.start.z&&e.z<=this.end.z)return!0}return!1};l.prototype.listener=function(a){var b=
this;a&&a.nearThreshold&&this.setupNearRegion(a.nearThreshold);return function(a){return b.updatePosition(a)}};l.prototype.clipper=function(){var a=this;return function(b){a.updatePosition(b);return a.enteredFrame?b:null}};l.prototype.setupNearRegion=function(a){a=this.nearRegion=new l([this.start.x-a,this.start.y-a,this.start.z-a],[this.end.x+a,this.end.y+a,this.end.z+a]);var b=this;a.on("enter",function(a){b.emit("near",a)});a.on("exit",function(a){b.emit("far",a)});b.on("exit",function(a){b.emit("near",
a)})};l.prototype.updatePosition=function(a){this.nearRegion&&this.nearRegion.updatePosition(a);this.hasPointables(a)&&null==this.enteredFrame?(this.enteredFrame=a,this.emit("enter",this.enteredFrame)):this.hasPointables(a)||null==this.enteredFrame||(this.enteredFrame=null,this.emit("exit",this.enteredFrame));return a};l.prototype.normalize=function(a){return new Vector([(a.x-this.start.x)/(this.end.x-this.start.x),(a.y-this.start.y)/(this.end.y-this.start.y),(a.z-this.start.z)/(this.end.z-this.start.z)])};
l.prototype.mapToXY=function(a,b,n){a=this.normalize(a);var e=a.x,h=a.y;1<e?e=1:-1>e&&(e=-1);1<h?h=1:-1>h&&(h=-1);return[(e+1)/2*b,(1-h)/2*n,a.z]};a.extend(l.prototype,k.prototype)},{events:1,underscore:25}],21:[function(a,b,k){b.exports={full:"0.6.4",major:0,minor:6,dot:4}},{}],22:[function(a,b,k){(function(a){(function(a){if(!b)var b=1E-6;if(!e)var e="undefined"!==typeof Float32Array?Float32Array:Array;if(!l)var l=Math.random;var k={setMatrixArrayType:function(a){e=a}};"undefined"!==typeof a&&(a.glMatrix=
k);var A=Math.PI/180;k.toRadian=function(a){return a*A};var w={create:function(){var a=new e(2);a[0]=0;a[1]=0;return a},clone:function(a){var c=new e(2);c[0]=a[0];c[1]=a[1];return c},fromValues:function(a,c){var d=new e(2);d[0]=a;d[1]=c;return d},copy:function(a,c){a[0]=c[0];a[1]=c[1];return a},set:function(a,c,d){a[0]=c;a[1]=d;return a},add:function(a,c,d){a[0]=c[0]+d[0];a[1]=c[1]+d[1];return a},subtract:function(a,c,d){a[0]=c[0]-d[0];a[1]=c[1]-d[1];return a}};w.sub=w.subtract;w.multiply=function(a,
c,d){a[0]=c[0]*d[0];a[1]=c[1]*d[1];return a};w.mul=w.multiply;w.divide=function(a,c,d){a[0]=c[0]/d[0];a[1]=c[1]/d[1];return a};w.div=w.divide;w.min=function(a,c,d){a[0]=Math.min(c[0],d[0]);a[1]=Math.min(c[1],d[1]);return a};w.max=function(a,c,d){a[0]=Math.max(c[0],d[0]);a[1]=Math.max(c[1],d[1]);return a};w.scale=function(a,c,d){a[0]=c[0]*d;a[1]=c[1]*d;return a};w.scaleAndAdd=function(a,c,d,g){a[0]=c[0]+d[0]*g;a[1]=c[1]+d[1]*g;return a};w.distance=function(a,c){var d=c[0]-a[0];a=c[1]-a[1];return Math.sqrt(d*
d+a*a)};w.dist=w.distance;w.squaredDistance=function(a,c){var d=c[0]-a[0];a=c[1]-a[1];return d*d+a*a};w.sqrDist=w.squaredDistance;w.length=function(a){var c=a[0];a=a[1];return Math.sqrt(c*c+a*a)};w.len=w.length;w.squaredLength=function(a){var c=a[0];a=a[1];return c*c+a*a};w.sqrLen=w.squaredLength;w.negate=function(a,c){a[0]=-c[0];a[1]=-c[1];return a};w.normalize=function(a,c){var d=c[0],f=c[1];d=d*d+f*f;0<d&&(d=1/Math.sqrt(d),a[0]=c[0]*d,a[1]=c[1]*d);return a};w.dot=function(a,c){return a[0]*c[0]+
a[1]*c[1]};w.cross=function(a,c,d){c=c[0]*d[1]-c[1]*d[0];a[0]=a[1]=0;a[2]=c;return a};w.lerp=function(a,c,d,g){var f=c[0];c=c[1];a[0]=f+g*(d[0]-f);a[1]=c+g*(d[1]-c);return a};w.random=function(a,c){c=c||1;var d=2*l()*Math.PI;a[0]=Math.cos(d)*c;a[1]=Math.sin(d)*c;return a};w.transformMat2=function(a,c,d){var f=c[0];c=c[1];a[0]=d[0]*f+d[2]*c;a[1]=d[1]*f+d[3]*c;return a};w.transformMat2d=function(a,c,d){var f=c[0];c=c[1];a[0]=d[0]*f+d[2]*c+d[4];a[1]=d[1]*f+d[3]*c+d[5];return a};w.transformMat3=function(a,
c,d){var f=c[0];c=c[1];a[0]=d[0]*f+d[3]*c+d[6];a[1]=d[1]*f+d[4]*c+d[7];return a};w.transformMat4=function(a,c,d){var f=c[0];c=c[1];a[0]=d[0]*f+d[4]*c+d[12];a[1]=d[1]*f+d[5]*c+d[13];return a};w.forEach=function(){var a=w.create();return function(c,d,f,E,b,D){d||(d=2);f||(f=0);for(E=E?Math.min(E*d+f,c.length):c.length;f<E;f+=d)a[0]=c[f],a[1]=c[f+1],b(a,a,D),c[f]=a[0],c[f+1]=a[1];return c}}();w.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};"undefined"!==typeof a&&(a.vec2=w);var p={create:function(){var a=
new e(3);a[0]=0;a[1]=0;a[2]=0;return a},clone:function(a){var c=new e(3);c[0]=a[0];c[1]=a[1];c[2]=a[2];return c},fromValues:function(a,c,d){var f=new e(3);f[0]=a;f[1]=c;f[2]=d;return f},copy:function(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];return a},set:function(a,c,d,g){a[0]=c;a[1]=d;a[2]=g;return a},add:function(a,c,d){a[0]=c[0]+d[0];a[1]=c[1]+d[1];a[2]=c[2]+d[2];return a},subtract:function(a,c,d){a[0]=c[0]-d[0];a[1]=c[1]-d[1];a[2]=c[2]-d[2];return a}};p.sub=p.subtract;p.multiply=function(a,c,d){a[0]=
c[0]*d[0];a[1]=c[1]*d[1];a[2]=c[2]*d[2];return a};p.mul=p.multiply;p.divide=function(a,c,d){a[0]=c[0]/d[0];a[1]=c[1]/d[1];a[2]=c[2]/d[2];return a};p.div=p.divide;p.min=function(a,c,d){a[0]=Math.min(c[0],d[0]);a[1]=Math.min(c[1],d[1]);a[2]=Math.min(c[2],d[2]);return a};p.max=function(a,c,d){a[0]=Math.max(c[0],d[0]);a[1]=Math.max(c[1],d[1]);a[2]=Math.max(c[2],d[2]);return a};p.scale=function(a,c,d){a[0]=c[0]*d;a[1]=c[1]*d;a[2]=c[2]*d;return a};p.scaleAndAdd=function(a,c,d,g){a[0]=c[0]+d[0]*g;a[1]=c[1]+
d[1]*g;a[2]=c[2]+d[2]*g;return a};p.distance=function(a,c){var d=c[0]-a[0],f=c[1]-a[1];a=c[2]-a[2];return Math.sqrt(d*d+f*f+a*a)};p.dist=p.distance;p.squaredDistance=function(a,c){var d=c[0]-a[0],f=c[1]-a[1];a=c[2]-a[2];return d*d+f*f+a*a};p.sqrDist=p.squaredDistance;p.length=function(a){var c=a[0],d=a[1];a=a[2];return Math.sqrt(c*c+d*d+a*a)};p.len=p.length;p.squaredLength=function(a){var c=a[0],d=a[1];a=a[2];return c*c+d*d+a*a};p.sqrLen=p.squaredLength;p.negate=function(a,c){a[0]=-c[0];a[1]=-c[1];
a[2]=-c[2];return a};p.normalize=function(a,c){var d=c[0],f=c[1],E=c[2];d=d*d+f*f+E*E;0<d&&(d=1/Math.sqrt(d),a[0]=c[0]*d,a[1]=c[1]*d,a[2]=c[2]*d);return a};p.dot=function(a,c){return a[0]*c[0]+a[1]*c[1]+a[2]*c[2]};p.cross=function(a,c,d){var f=c[0],E=c[1];c=c[2];var b=d[0],D=d[1];d=d[2];a[0]=E*d-c*D;a[1]=c*b-f*d;a[2]=f*D-E*b;return a};p.lerp=function(a,c,d,g){var f=c[0],b=c[1];c=c[2];a[0]=f+g*(d[0]-f);a[1]=b+g*(d[1]-b);a[2]=c+g*(d[2]-c);return a};p.random=function(a,c){c=c||1;var d=2*l()*Math.PI,
f=2*l()-1,E=Math.sqrt(1-f*f)*c;a[0]=Math.cos(d)*E;a[1]=Math.sin(d)*E;a[2]=f*c;return a};p.transformMat4=function(a,c,d){var f=c[0],E=c[1];c=c[2];a[0]=d[0]*f+d[4]*E+d[8]*c+d[12];a[1]=d[1]*f+d[5]*E+d[9]*c+d[13];a[2]=d[2]*f+d[6]*E+d[10]*c+d[14];return a};p.transformMat3=function(a,c,d){var f=c[0],E=c[1];c=c[2];a[0]=f*d[0]+E*d[3]+c*d[6];a[1]=f*d[1]+E*d[4]+c*d[7];a[2]=f*d[2]+E*d[5]+c*d[8];return a};p.transformQuat=function(a,c,d){var f=c[0],E=c[1],b=c[2];c=d[0];var D=d[1],e=d[2];d=d[3];var m=d*f+D*b-e*
E,h=d*E+e*f-c*b,n=d*b+c*E-D*f;f=-c*f-D*E-e*b;a[0]=m*d+f*-c+h*-e-n*-D;a[1]=h*d+f*-D+n*-c-m*-e;a[2]=n*d+f*-e+m*-D-h*-c;return a};p.rotateX=function(a,c,d,g){var f=[],b=[];f[0]=c[0]-d[0];f[1]=c[1]-d[1];f[2]=c[2]-d[2];b[0]=f[0];b[1]=f[1]*Math.cos(g)-f[2]*Math.sin(g);b[2]=f[1]*Math.sin(g)+f[2]*Math.cos(g);a[0]=b[0]+d[0];a[1]=b[1]+d[1];a[2]=b[2]+d[2];return a};p.rotateY=function(a,c,d,g){var f=[],b=[];f[0]=c[0]-d[0];f[1]=c[1]-d[1];f[2]=c[2]-d[2];b[0]=f[2]*Math.sin(g)+f[0]*Math.cos(g);b[1]=f[1];b[2]=f[2]*
Math.cos(g)-f[0]*Math.sin(g);a[0]=b[0]+d[0];a[1]=b[1]+d[1];a[2]=b[2]+d[2];return a};p.rotateZ=function(a,c,d,g){var f=[],b=[];f[0]=c[0]-d[0];f[1]=c[1]-d[1];f[2]=c[2]-d[2];b[0]=f[0]*Math.cos(g)-f[1]*Math.sin(g);b[1]=f[0]*Math.sin(g)+f[1]*Math.cos(g);b[2]=f[2];a[0]=b[0]+d[0];a[1]=b[1]+d[1];a[2]=b[2]+d[2];return a};p.forEach=function(){var a=p.create();return function(c,d,f,b,C,D){d||(d=3);f||(f=0);for(b=b?Math.min(b*d+f,c.length):c.length;f<b;f+=d)a[0]=c[f],a[1]=c[f+1],a[2]=c[f+2],C(a,a,D),c[f]=a[0],
c[f+1]=a[1],c[f+2]=a[2];return c}}();p.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};"undefined"!==typeof a&&(a.vec3=p);var q={create:function(){var a=new e(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a},clone:function(a){var c=new e(4);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];return c},fromValues:function(a,c,d,g){var f=new e(4);f[0]=a;f[1]=c;f[2]=d;f[3]=g;return f},copy:function(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];return a},set:function(a,c,d,g,b){a[0]=c;a[1]=d;a[2]=g;a[3]=b;return a},
add:function(a,c,d){a[0]=c[0]+d[0];a[1]=c[1]+d[1];a[2]=c[2]+d[2];a[3]=c[3]+d[3];return a},subtract:function(a,c,d){a[0]=c[0]-d[0];a[1]=c[1]-d[1];a[2]=c[2]-d[2];a[3]=c[3]-d[3];return a}};q.sub=q.subtract;q.multiply=function(a,c,d){a[0]=c[0]*d[0];a[1]=c[1]*d[1];a[2]=c[2]*d[2];a[3]=c[3]*d[3];return a};q.mul=q.multiply;q.divide=function(a,c,d){a[0]=c[0]/d[0];a[1]=c[1]/d[1];a[2]=c[2]/d[2];a[3]=c[3]/d[3];return a};q.div=q.divide;q.min=function(a,c,d){a[0]=Math.min(c[0],d[0]);a[1]=Math.min(c[1],d[1]);a[2]=
Math.min(c[2],d[2]);a[3]=Math.min(c[3],d[3]);return a};q.max=function(a,c,d){a[0]=Math.max(c[0],d[0]);a[1]=Math.max(c[1],d[1]);a[2]=Math.max(c[2],d[2]);a[3]=Math.max(c[3],d[3]);return a};q.scale=function(a,c,d){a[0]=c[0]*d;a[1]=c[1]*d;a[2]=c[2]*d;a[3]=c[3]*d;return a};q.scaleAndAdd=function(a,c,d,g){a[0]=c[0]+d[0]*g;a[1]=c[1]+d[1]*g;a[2]=c[2]+d[2]*g;a[3]=c[3]+d[3]*g;return a};q.distance=function(a,c){var d=c[0]-a[0],f=c[1]-a[1],b=c[2]-a[2];a=c[3]-a[3];return Math.sqrt(d*d+f*f+b*b+a*a)};q.dist=q.distance;
q.squaredDistance=function(a,c){var d=c[0]-a[0],f=c[1]-a[1],b=c[2]-a[2];a=c[3]-a[3];return d*d+f*f+b*b+a*a};q.sqrDist=q.squaredDistance;q.length=function(a){var c=a[0],d=a[1],f=a[2];a=a[3];return Math.sqrt(c*c+d*d+f*f+a*a)};q.len=q.length;q.squaredLength=function(a){var c=a[0],d=a[1],f=a[2];a=a[3];return c*c+d*d+f*f+a*a};q.sqrLen=q.squaredLength;q.negate=function(a,c){a[0]=-c[0];a[1]=-c[1];a[2]=-c[2];a[3]=-c[3];return a};q.normalize=function(a,c){var d=c[0],f=c[1],b=c[2],C=c[3];d=d*d+f*f+b*b+C*C;
0<d&&(d=1/Math.sqrt(d),a[0]=c[0]*d,a[1]=c[1]*d,a[2]=c[2]*d,a[3]=c[3]*d);return a};q.dot=function(a,c){return a[0]*c[0]+a[1]*c[1]+a[2]*c[2]+a[3]*c[3]};q.lerp=function(a,c,d,g){var f=c[0],b=c[1],D=c[2];c=c[3];a[0]=f+g*(d[0]-f);a[1]=b+g*(d[1]-b);a[2]=D+g*(d[2]-D);a[3]=c+g*(d[3]-c);return a};q.random=function(a,c){c=c||1;a[0]=l();a[1]=l();a[2]=l();a[3]=l();q.normalize(a,a);q.scale(a,a,c);return a};q.transformMat4=function(a,c,d){var f=c[0],b=c[1],C=c[2];c=c[3];a[0]=d[0]*f+d[4]*b+d[8]*C+d[12]*c;a[1]=d[1]*
f+d[5]*b+d[9]*C+d[13]*c;a[2]=d[2]*f+d[6]*b+d[10]*C+d[14]*c;a[3]=d[3]*f+d[7]*b+d[11]*C+d[15]*c;return a};q.transformQuat=function(a,c,d){var f=c[0],b=c[1],C=c[2];c=d[0];var D=d[1],e=d[2];d=d[3];var m=d*f+D*C-e*b,h=d*b+e*f-c*C,n=d*C+c*b-D*f;f=-c*f-D*b-e*C;a[0]=m*d+f*-c+h*-e-n*-D;a[1]=h*d+f*-D+n*-c-m*-e;a[2]=n*d+f*-e+m*-D-h*-c;return a};q.forEach=function(){var a=q.create();return function(c,d,f,b,C,D){d||(d=4);f||(f=0);for(b=b?Math.min(b*d+f,c.length):c.length;f<b;f+=d)a[0]=c[f],a[1]=c[f+1],a[2]=c[f+
2],a[3]=c[f+3],C(a,a,D),c[f]=a[0],c[f+1]=a[1],c[f+2]=a[2],c[f+3]=a[3];return c}}();q.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.vec4=q);k={create:function(){var a=new e(4);a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},clone:function(a){var c=new e(4);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];return c},copy:function(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},transpose:function(a,c){if(a===
c){var d=c[1];a[1]=c[2];a[2]=d}else a[0]=c[0],a[1]=c[2],a[2]=c[1],a[3]=c[3];return a},invert:function(a,c){var d=c[0],f=c[1],b=c[2];c=c[3];var C=d*c-b*f;if(!C)return null;C=1/C;a[0]=c*C;a[1]=-f*C;a[2]=-b*C;a[3]=d*C;return a},adjoint:function(a,c){var d=c[0];a[0]=c[3];a[1]=-c[1];a[2]=-c[2];a[3]=d;return a},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},multiply:function(a,c,d){var f=c[0],b=c[1],C=c[2];c=c[3];var D=d[0],e=d[1],m=d[2];d=d[3];a[0]=f*D+C*e;a[1]=b*D+c*e;a[2]=f*m+C*d;a[3]=b*m+c*d;return a}};
k.mul=k.multiply;k.rotate=function(a,c,d){var f=c[0],b=c[1],C=c[2];c=c[3];var D=Math.sin(d);d=Math.cos(d);a[0]=f*d+C*D;a[1]=b*d+c*D;a[2]=f*-D+C*d;a[3]=b*-D+c*d;return a};k.scale=function(a,c,d){var f=c[1],b=c[2],C=c[3],D=d[0];d=d[1];a[0]=c[0]*D;a[1]=f*D;a[2]=b*d;a[3]=C*d;return a};k.str=function(a){return"mat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};k.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2))};k.LDU=function(a,c,d,g){a[2]=g[2]/g[0];d[0]=
g[0];d[1]=g[1];d[3]=g[3]-a[2]*d[1];return[a,c,d]};"undefined"!==typeof a&&(a.mat2=k);k={create:function(){var a=new e(6);a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a},clone:function(a){var c=new e(6);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];return c},copy:function(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a},invert:function(a,c){var d=c[0],f=c[1],b=c[2],C=c[3],D=c[4];c=c[5];
var e=d*C-f*b;if(!e)return null;e=1/e;a[0]=C*e;a[1]=-f*e;a[2]=-b*e;a[3]=d*e;a[4]=(b*c-C*D)*e;a[5]=(f*D-d*c)*e;return a},determinant:function(a){return a[0]*a[3]-a[1]*a[2]},multiply:function(a,c,d){var f=c[0],b=c[1],C=c[2],D=c[3],e=c[4];c=c[5];var m=d[0],h=d[1],n=d[2],l=d[3],k=d[4];d=d[5];a[0]=f*m+C*h;a[1]=b*m+D*h;a[2]=f*n+C*l;a[3]=b*n+D*l;a[4]=f*k+C*d+e;a[5]=b*k+D*d+c;return a}};k.mul=k.multiply;k.rotate=function(a,c,d){var f=c[0],b=c[1],C=c[2],D=c[3],e=c[4];c=c[5];var m=Math.sin(d);d=Math.cos(d);
a[0]=f*d+C*m;a[1]=b*d+D*m;a[2]=f*-m+C*d;a[3]=b*-m+D*d;a[4]=e;a[5]=c;return a};k.scale=function(a,c,d){var f=c[1],b=c[2],C=c[3],e=c[4],h=c[5],m=d[0];d=d[1];a[0]=c[0]*m;a[1]=f*m;a[2]=b*d;a[3]=C*d;a[4]=e;a[5]=h;return a};k.translate=function(a,c,d){var f=c[0],b=c[1],C=c[2],e=c[3],h=c[4];c=c[5];var m=d[0];d=d[1];a[0]=f;a[1]=b;a[2]=C;a[3]=e;a[4]=f*m+C*d+h;a[5]=b*m+e*d+c;return a};k.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};k.frob=function(a){return Math.sqrt(Math.pow(a[0],
2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};"undefined"!==typeof a&&(a.mat2d=k);var t={create:function(){var a=new e(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},fromMat4:function(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[4];a[4]=c[5];a[5]=c[6];a[6]=c[8];a[7]=c[9];a[8]=c[10];return a},clone:function(a){var c=new e(9);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c},copy:function(a,
c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];a[6]=c[6];a[7]=c[7];a[8]=c[8];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,c){if(a===c){var d=c[1],f=c[2],b=c[5];a[1]=c[3];a[2]=c[6];a[3]=d;a[5]=c[7];a[6]=f;a[7]=b}else a[0]=c[0],a[1]=c[3],a[2]=c[6],a[3]=c[1],a[4]=c[4],a[5]=c[7],a[6]=c[2],a[7]=c[5],a[8]=c[8];return a},invert:function(a,c){var d=c[0],f=c[1],b=c[2],C=c[3],e=c[4],h=c[5],m=c[6],n=c[7];c=c[8];var l=
c*e-h*n,k=-c*C+h*m,r=n*C-e*m,p=d*l+f*k+b*r;if(!p)return null;p=1/p;a[0]=l*p;a[1]=(-c*f+b*n)*p;a[2]=(h*f-b*e)*p;a[3]=k*p;a[4]=(c*d-b*m)*p;a[5]=(-h*d+b*C)*p;a[6]=r*p;a[7]=(-n*d+f*m)*p;a[8]=(e*d-f*C)*p;return a},adjoint:function(a,c){var d=c[0],f=c[1],b=c[2],C=c[3],e=c[4],h=c[5],m=c[6],n=c[7];c=c[8];a[0]=e*c-h*n;a[1]=b*n-f*c;a[2]=f*h-b*e;a[3]=h*m-C*c;a[4]=d*c-b*m;a[5]=b*C-d*h;a[6]=C*n-e*m;a[7]=f*m-d*n;a[8]=d*e-f*C;return a},determinant:function(a){var c=a[3],d=a[4],f=a[5],b=a[6],C=a[7],e=a[8];return a[0]*
(e*d-f*C)+a[1]*(-e*c+f*b)+a[2]*(C*c-d*b)},multiply:function(a,c,d){var f=c[0],b=c[1],C=c[2],e=c[3],h=c[4],m=c[5],n=c[6],l=c[7];c=c[8];var k=d[0],r=d[1],p=d[2],q=d[3],v=d[4],B=d[5],t=d[6],u=d[7];d=d[8];a[0]=k*f+r*e+p*n;a[1]=k*b+r*h+p*l;a[2]=k*C+r*m+p*c;a[3]=q*f+v*e+B*n;a[4]=q*b+v*h+B*l;a[5]=q*C+v*m+B*c;a[6]=t*f+u*e+d*n;a[7]=t*b+u*h+d*l;a[8]=t*C+u*m+d*c;return a}};t.mul=t.multiply;t.translate=function(a,c,d){var f=c[0],b=c[1],C=c[2],e=c[3],h=c[4],m=c[5],n=c[6],l=c[7];c=c[8];var k=d[0];d=d[1];a[0]=f;
a[1]=b;a[2]=C;a[3]=e;a[4]=h;a[5]=m;a[6]=k*f+d*e+n;a[7]=k*b+d*h+l;a[8]=k*C+d*m+c;return a};t.rotate=function(a,c,d){var f=c[0],b=c[1],C=c[2],e=c[3],h=c[4],m=c[5],n=c[6],l=c[7];c=c[8];var k=Math.sin(d);d=Math.cos(d);a[0]=d*f+k*e;a[1]=d*b+k*h;a[2]=d*C+k*m;a[3]=d*e-k*f;a[4]=d*h-k*b;a[5]=d*m-k*C;a[6]=n;a[7]=l;a[8]=c;return a};t.scale=function(a,c,d){var f=d[0];d=d[1];a[0]=f*c[0];a[1]=f*c[1];a[2]=f*c[2];a[3]=d*c[3];a[4]=d*c[4];a[5]=d*c[5];a[6]=c[6];a[7]=c[7];a[8]=c[8];return a};t.fromMat2d=function(a,c){a[0]=
c[0];a[1]=c[1];a[2]=0;a[3]=c[2];a[4]=c[3];a[5]=0;a[6]=c[4];a[7]=c[5];a[8]=1;return a};t.fromQuat=function(a,c){var d=c[0],g=c[1],f=c[2];c=c[3];var b=d+d,e=g+g,h=f+f;d*=b;var m=g*b;g*=e;var n=f*b,l=f*e;f*=h;b*=c;e*=c;c*=h;a[0]=1-g-f;a[3]=m-c;a[6]=n+e;a[1]=m+c;a[4]=1-d-f;a[7]=l-b;a[2]=n-e;a[5]=l+b;a[8]=1-d-g;return a};t.normalFromMat4=function(a,c){var d=c[0],g=c[1],f=c[2],b=c[3],e=c[4],h=c[5],m=c[6],n=c[7],l=c[8],k=c[9],r=c[10],p=c[11],q=c[12],v=c[13],B=c[14];c=c[15];var t=d*h-g*e,u=d*m-f*e,w=d*n-
b*e,A=g*m-f*h,F=g*n-b*h,G=f*n-b*m,K=l*v-k*q,H=l*B-r*q;l=l*c-p*q;var I=k*B-r*v;k=k*c-p*v;r=r*c-p*B;p=t*r-u*k+w*I+A*l-F*H+G*K;if(!p)return null;p=1/p;a[0]=(h*r-m*k+n*I)*p;a[1]=(m*l-e*r-n*H)*p;a[2]=(e*k-h*l+n*K)*p;a[3]=(f*k-g*r-b*I)*p;a[4]=(d*r-f*l+b*H)*p;a[5]=(g*l-d*k-b*K)*p;a[6]=(v*G-B*F+c*A)*p;a[7]=(B*w-q*G-c*u)*p;a[8]=(q*F-v*w+c*t)*p;return a};t.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};t.frob=function(a){return Math.sqrt(Math.pow(a[0],
2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};"undefined"!==typeof a&&(a.mat3=t);var r={create:function(){var a=new e(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},clone:function(a){var c=new e(16);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];
c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c},copy:function(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];a[6]=c[6];a[7]=c[7];a[8]=c[8];a[9]=c[9];a[10]=c[10];a[11]=c[11];a[12]=c[12];a[13]=c[13];a[14]=c[14];a[15]=c[15];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,c){if(a===c){var d=c[1],g=c[2],f=c[3],b=c[6],e=c[7],h=c[11];a[1]=c[4];a[2]=
c[8];a[3]=c[12];a[4]=d;a[6]=c[9];a[7]=c[13];a[8]=g;a[9]=b;a[11]=c[14];a[12]=f;a[13]=e;a[14]=h}else a[0]=c[0],a[1]=c[4],a[2]=c[8],a[3]=c[12],a[4]=c[1],a[5]=c[5],a[6]=c[9],a[7]=c[13],a[8]=c[2],a[9]=c[6],a[10]=c[10],a[11]=c[14],a[12]=c[3],a[13]=c[7],a[14]=c[11],a[15]=c[15];return a},invert:function(a,c){var d=c[0],g=c[1],b=c[2],f=c[3],e=c[4],h=c[5],m=c[6],n=c[7],l=c[8],k=c[9],r=c[10],p=c[11],q=c[12],v=c[13],B=c[14];c=c[15];var t=d*h-g*e,u=d*m-b*e,w=d*n-f*e,A=g*m-b*h,F=g*n-f*h,G=b*n-f*m,K=l*v-k*q,H=l*
B-r*q,I=l*c-p*q,J=k*B-r*v,O=k*c-p*v,P=r*c-p*B,L=t*P-u*O+w*J+A*I-F*H+G*K;if(!L)return null;L=1/L;a[0]=(h*P-m*O+n*J)*L;a[1]=(b*O-g*P-f*J)*L;a[2]=(v*G-B*F+c*A)*L;a[3]=(r*F-k*G-p*A)*L;a[4]=(m*I-e*P-n*H)*L;a[5]=(d*P-b*I+f*H)*L;a[6]=(B*w-q*G-c*u)*L;a[7]=(l*G-r*w+p*u)*L;a[8]=(e*O-h*I+n*K)*L;a[9]=(g*I-d*O-f*K)*L;a[10]=(q*F-v*w+c*t)*L;a[11]=(k*w-l*F-p*t)*L;a[12]=(h*H-e*J-m*K)*L;a[13]=(d*J-g*H+b*K)*L;a[14]=(v*u-q*A-B*t)*L;a[15]=(l*A-k*u+r*t)*L;return a},adjoint:function(a,c){var d=c[0],g=c[1],b=c[2],f=c[3],
e=c[4],h=c[5],m=c[6],n=c[7],l=c[8],k=c[9],r=c[10],p=c[11],q=c[12],v=c[13],B=c[14];c=c[15];a[0]=h*(r*c-p*B)-k*(m*c-n*B)+v*(m*p-n*r);a[1]=-(g*(r*c-p*B)-k*(b*c-f*B)+v*(b*p-f*r));a[2]=g*(m*c-n*B)-h*(b*c-f*B)+v*(b*n-f*m);a[3]=-(g*(m*p-n*r)-h*(b*p-f*r)+k*(b*n-f*m));a[4]=-(e*(r*c-p*B)-l*(m*c-n*B)+q*(m*p-n*r));a[5]=d*(r*c-p*B)-l*(b*c-f*B)+q*(b*p-f*r);a[6]=-(d*(m*c-n*B)-e*(b*c-f*B)+q*(b*n-f*m));a[7]=d*(m*p-n*r)-e*(b*p-f*r)+l*(b*n-f*m);a[8]=e*(k*c-p*v)-l*(h*c-n*v)+q*(h*p-n*k);a[9]=-(d*(k*c-p*v)-l*(g*c-f*v)+
q*(g*p-f*k));a[10]=d*(h*c-n*v)-e*(g*c-f*v)+q*(g*n-f*h);a[11]=-(d*(h*p-n*k)-e*(g*p-f*k)+l*(g*n-f*h));a[12]=-(e*(k*B-r*v)-l*(h*B-m*v)+q*(h*r-m*k));a[13]=d*(k*B-r*v)-l*(g*B-b*v)+q*(g*r-b*k);a[14]=-(d*(h*B-m*v)-e*(g*B-b*v)+q*(g*m-b*h));a[15]=d*(h*r-m*k)-e*(g*r-b*k)+l*(g*m-b*h);return a},determinant:function(a){var c=a[0],d=a[1],g=a[2],b=a[3],f=a[4],e=a[5],h=a[6],m=a[7],n=a[8],l=a[9],k=a[10],r=a[11],p=a[12],v=a[13],q=a[14];a=a[15];return(c*e-d*f)*(k*a-r*q)-(c*h-g*f)*(l*a-r*v)+(c*m-b*f)*(l*q-k*v)+(d*h-
g*e)*(n*a-r*p)-(d*m-b*e)*(n*q-k*p)+(g*m-b*h)*(n*v-l*p)},multiply:function(a,c,d){var g=c[0],b=c[1],f=c[2],e=c[3],h=c[4],m=c[5],n=c[6],l=c[7],k=c[8],r=c[9],p=c[10],v=c[11],q=c[12],B=c[13],t=c[14];c=c[15];var u=d[0],w=d[1],A=d[2],F=d[3];a[0]=u*g+w*h+A*k+F*q;a[1]=u*b+w*m+A*r+F*B;a[2]=u*f+w*n+A*p+F*t;a[3]=u*e+w*l+A*v+F*c;u=d[4];w=d[5];A=d[6];F=d[7];a[4]=u*g+w*h+A*k+F*q;a[5]=u*b+w*m+A*r+F*B;a[6]=u*f+w*n+A*p+F*t;a[7]=u*e+w*l+A*v+F*c;u=d[8];w=d[9];A=d[10];F=d[11];a[8]=u*g+w*h+A*k+F*q;a[9]=u*b+w*m+A*r+F*
B;a[10]=u*f+w*n+A*p+F*t;a[11]=u*e+w*l+A*v+F*c;u=d[12];w=d[13];A=d[14];F=d[15];a[12]=u*g+w*h+A*k+F*q;a[13]=u*b+w*m+A*r+F*B;a[14]=u*f+w*n+A*p+F*t;a[15]=u*e+w*l+A*v+F*c;return a}};r.mul=r.multiply;r.translate=function(a,c,d){var g=d[0],b=d[1];d=d[2];if(c===a)a[12]=c[0]*g+c[4]*b+c[8]*d+c[12],a[13]=c[1]*g+c[5]*b+c[9]*d+c[13],a[14]=c[2]*g+c[6]*b+c[10]*d+c[14],a[15]=c[3]*g+c[7]*b+c[11]*d+c[15];else{var f=c[0];var e=c[1];var h=c[2];var m=c[3];var n=c[4];var l=c[5];var k=c[6];var r=c[7];var p=c[8];var v=c[9];
var q=c[10];var B=c[11];a[0]=f;a[1]=e;a[2]=h;a[3]=m;a[4]=n;a[5]=l;a[6]=k;a[7]=r;a[8]=p;a[9]=v;a[10]=q;a[11]=B;a[12]=f*g+n*b+p*d+c[12];a[13]=e*g+l*b+v*d+c[13];a[14]=h*g+k*b+q*d+c[14];a[15]=m*g+r*b+B*d+c[15]}return a};r.scale=function(a,c,d){var g=d[0],b=d[1];d=d[2];a[0]=c[0]*g;a[1]=c[1]*g;a[2]=c[2]*g;a[3]=c[3]*g;a[4]=c[4]*b;a[5]=c[5]*b;a[6]=c[6]*b;a[7]=c[7]*b;a[8]=c[8]*d;a[9]=c[9]*d;a[10]=c[10]*d;a[11]=c[11]*d;a[12]=c[12];a[13]=c[13];a[14]=c[14];a[15]=c[15];return a};r.rotate=function(a,c,d,g){var f=
g[0],e=g[1];g=g[2];var h=Math.sqrt(f*f+e*e+g*g);if(Math.abs(h)<b)return null;h=1/h;f*=h;e*=h;g*=h;var n=Math.sin(d);var m=Math.cos(d);var l=1-m;d=c[0];h=c[1];var k=c[2];var r=c[3];var p=c[4];var v=c[5];var q=c[6];var B=c[7];var u=c[8];var w=c[9];var t=c[10];var A=c[11];var W=f*f*l+m;var F=e*f*l+g*n;var G=g*f*l-e*n;var K=f*e*l-g*n;var H=e*e*l+m;var I=g*e*l+f*n;var J=f*g*l+e*n;f=e*g*l-f*n;e=g*g*l+m;a[0]=d*W+p*F+u*G;a[1]=h*W+v*F+w*G;a[2]=k*W+q*F+t*G;a[3]=r*W+B*F+A*G;a[4]=d*K+p*H+u*I;a[5]=h*K+v*H+w*I;
a[6]=k*K+q*H+t*I;a[7]=r*K+B*H+A*I;a[8]=d*J+p*f+u*e;a[9]=h*J+v*f+w*e;a[10]=k*J+q*f+t*e;a[11]=r*J+B*f+A*e;c!==a&&(a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);return a};r.rotateX=function(a,c,d){var g=Math.sin(d);d=Math.cos(d);var b=c[4],f=c[5],e=c[6],h=c[7],m=c[8],n=c[9],l=c[10],k=c[11];c!==a&&(a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);a[4]=b*d+m*g;a[5]=f*d+n*g;a[6]=e*d+l*g;a[7]=h*d+k*g;a[8]=m*d-b*g;a[9]=n*d-f*g;a[10]=l*d-e*g;a[11]=k*d-h*g;return a};
r.rotateY=function(a,c,d){var g=Math.sin(d);d=Math.cos(d);var b=c[0],f=c[1],e=c[2],h=c[3],m=c[8],n=c[9],l=c[10],k=c[11];c!==a&&(a[4]=c[4],a[5]=c[5],a[6]=c[6],a[7]=c[7],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);a[0]=b*d-m*g;a[1]=f*d-n*g;a[2]=e*d-l*g;a[3]=h*d-k*g;a[8]=b*g+m*d;a[9]=f*g+n*d;a[10]=e*g+l*d;a[11]=h*g+k*d;return a};r.rotateZ=function(a,c,d){var g=Math.sin(d);d=Math.cos(d);var b=c[0],f=c[1],e=c[2],h=c[3],m=c[4],n=c[5],l=c[6],k=c[7];c!==a&&(a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11],
a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);a[0]=b*d+m*g;a[1]=f*d+n*g;a[2]=e*d+l*g;a[3]=h*d+k*g;a[4]=m*d-b*g;a[5]=n*d-f*g;a[6]=l*d-e*g;a[7]=k*d-h*g;return a};r.fromRotationTranslation=function(a,c,d){var g=c[0],b=c[1],f=c[2],e=c[3],h=g+g,m=b+b,n=f+f;c=g*h;var l=g*m;g*=n;var k=b*m;b*=n;f*=n;h*=e;m*=e;e*=n;a[0]=1-(k+f);a[1]=l+e;a[2]=g-m;a[3]=0;a[4]=l-e;a[5]=1-(c+f);a[6]=b+h;a[7]=0;a[8]=g+m;a[9]=b-h;a[10]=1-(c+k);a[11]=0;a[12]=d[0];a[13]=d[1];a[14]=d[2];a[15]=1;return a};r.fromQuat=function(a,c){var d=
c[0],g=c[1],b=c[2];c=c[3];var f=d+d,e=g+g,h=b+b;d*=f;var m=g*f;g*=e;var n=b*f,l=b*e;b*=h;f*=c;e*=c;c*=h;a[0]=1-g-b;a[1]=m+c;a[2]=n-e;a[3]=0;a[4]=m-c;a[5]=1-d-b;a[6]=l+f;a[7]=0;a[8]=n+e;a[9]=l-f;a[10]=1-d-g;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};r.frustum=function(a,c,d,g,b,e,h){var f=1/(d-c),E=1/(b-g),C=1/(e-h);a[0]=2*e*f;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*e*E;a[6]=0;a[7]=0;a[8]=(d+c)*f;a[9]=(b+g)*E;a[10]=(h+e)*C;a[11]=-1;a[12]=0;a[13]=0;a[14]=h*e*2*C;a[15]=0;return a};r.perspective=function(a,
c,d,g,b){c=1/Math.tan(c/2);var f=1/(g-b);a[0]=c/d;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(b+g)*f;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*b*g*f;a[15]=0;return a};r.ortho=function(a,c,d,g,b,e,h){var f=1/(c-d),E=1/(g-b),C=1/(e-h);a[0]=-2*f;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*E;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*C;a[11]=0;a[12]=(c+d)*f;a[13]=(b+g)*E;a[14]=(h+e)*C;a[15]=1;return a};r.lookAt=function(a,c,d,g){var f=c[0],e=c[1];c=c[2];var h=g[0];var n=g[1];var m=g[2];var l=d[0];g=
d[1];var k=d[2];if(Math.abs(f-l)<b&&Math.abs(e-g)<b&&Math.abs(c-k)<b)return r.identity(a);d=f-l;g=e-g;l=c-k;var p=1/Math.sqrt(d*d+g*g+l*l);d*=p;g*=p;l*=p;k=n*l-m*g;m=m*d-h*l;h=h*g-n*d;(p=Math.sqrt(k*k+m*m+h*h))?(p=1/p,k*=p,m*=p,h*=p):h=m=k=0;n=g*h-l*m;var v=l*k-d*h;var q=d*m-g*k;(p=Math.sqrt(n*n+v*v+q*q))?(p=1/p,n*=p,v*=p,q*=p):q=v=n=0;a[0]=k;a[1]=n;a[2]=d;a[3]=0;a[4]=m;a[5]=v;a[6]=g;a[7]=0;a[8]=h;a[9]=q;a[10]=l;a[11]=0;a[12]=-(k*f+m*e+h*c);a[13]=-(n*f+v*e+q*c);a[14]=-(d*f+g*e+l*c);a[15]=1;return a};
r.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};r.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],
2)+Math.pow(a[15],2))};"undefined"!==typeof a&&(a.mat4=r);var u={create:function(){var a=new e(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}};u.rotationTo=function(){var a=p.create(),c=p.fromValues(1,0,0),d=p.fromValues(0,1,0);return function(g,b,f){var e=p.dot(b,f);if(-.999999>e)return p.cross(a,c,b),1E-6>p.length(a)&&p.cross(a,d,b),p.normalize(a,a),u.setAxisAngle(g,a,Math.PI),g;if(.999999<e)return g[0]=0,g[1]=0,g[2]=0,g[3]=1,g;p.cross(a,b,f);g[0]=a[0];g[1]=a[1];g[2]=a[2];g[3]=1+e;return u.normalize(g,
g)}}();u.setAxes=function(){var a=t.create();return function(c,d,g,b){a[0]=g[0];a[3]=g[1];a[6]=g[2];a[1]=b[0];a[4]=b[1];a[7]=b[2];a[2]=-d[0];a[5]=-d[1];a[8]=-d[2];return u.normalize(c,u.fromMat3(c,a))}}();u.clone=q.clone;u.fromValues=q.fromValues;u.copy=q.copy;u.set=q.set;u.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};u.setAxisAngle=function(a,c,d){d*=.5;var g=Math.sin(d);a[0]=g*c[0];a[1]=g*c[1];a[2]=g*c[2];a[3]=Math.cos(d);return a};u.add=q.add;u.multiply=function(a,c,d){var g=c[0],
b=c[1],e=c[2];c=c[3];var f=d[0],h=d[1],m=d[2];d=d[3];a[0]=g*d+c*f+b*m-e*h;a[1]=b*d+c*h+e*f-g*m;a[2]=e*d+c*m+g*h-b*f;a[3]=c*d-g*f-b*h-e*m;return a};u.mul=u.multiply;u.scale=q.scale;u.rotateX=function(a,c,d){d*=.5;var g=c[0],b=c[1],e=c[2];c=c[3];var f=Math.sin(d);d=Math.cos(d);a[0]=g*d+c*f;a[1]=b*d+e*f;a[2]=e*d-b*f;a[3]=c*d-g*f;return a};u.rotateY=function(a,c,d){d*=.5;var g=c[0],b=c[1],e=c[2];c=c[3];var f=Math.sin(d);d=Math.cos(d);a[0]=g*d-e*f;a[1]=b*d+c*f;a[2]=e*d+g*f;a[3]=c*d-b*f;return a};u.rotateZ=
function(a,c,d){d*=.5;var g=c[0],b=c[1],e=c[2];c=c[3];var f=Math.sin(d);d=Math.cos(d);a[0]=g*d+b*f;a[1]=b*d-g*f;a[2]=e*d+c*f;a[3]=c*d-e*f;return a};u.calculateW=function(a,c){var d=c[0],g=c[1];c=c[2];a[0]=d;a[1]=g;a[2]=c;a[3]=-Math.sqrt(Math.abs(1-d*d-g*g-c*c));return a};u.dot=q.dot;u.lerp=q.lerp;u.slerp=function(a,c,d,g){var b=c[0],e=c[1],f=c[2];c=c[3];var h=d[0],m=d[1],n=d[2];d=d[3];var l=b*h+e*m+f*n+c*d;0>l&&(l=-l,h=-h,m=-m,n=-n,d=-d);if(1E-6<1-l){var k=Math.acos(l);var p=Math.sin(k);l=Math.sin((1-
g)*k)/p;g=Math.sin(g*k)/p}else l=1-g;a[0]=l*b+g*h;a[1]=l*e+g*m;a[2]=l*f+g*n;a[3]=l*c+g*d;return a};u.invert=function(a,c){var d=c[0],g=c[1],b=c[2];c=c[3];var e=d*d+g*g+b*b+c*c;e=e?1/e:0;a[0]=-d*e;a[1]=-g*e;a[2]=-b*e;a[3]=c*e;return a};u.conjugate=function(a,c){a[0]=-c[0];a[1]=-c[1];a[2]=-c[2];a[3]=c[3];return a};u.length=q.length;u.len=u.length;u.squaredLength=q.squaredLength;u.sqrLen=u.squaredLength;u.normalize=q.normalize;u.fromMat3=function(a,c){var d=c[0]+c[4]+c[8];if(0<d)d=Math.sqrt(d+1),a[3]=
.5*d,d=.5/d,a[0]=(c[7]-c[5])*d,a[1]=(c[2]-c[6])*d,a[2]=(c[3]-c[1])*d;else{var g=0;c[4]>c[0]&&(g=1);c[8]>c[3*g+g]&&(g=2);var b=(g+1)%3,e=(g+2)%3;d=Math.sqrt(c[3*g+g]-c[3*b+b]-c[3*e+e]+1);a[g]=.5*d;d=.5/d;a[3]=(c[3*e+b]-c[3*b+e])*d;a[b]=(c[3*b+g]+c[3*g+b])*d;a[e]=(c[3*e+g]+c[3*g+e])*d}return a};u.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.quat=u)})("undefined"===typeof k?"undefined"!==typeof window?window:a:k)})(this)},{}],23:[function(a,b,k){b.exports=
function(){throw Error("ws does not work in the browser. Browser clients must use the native WebSocket object");}},{}],24:[function(a,b,k){function l(){throw Error("setTimeout has not been defined");}function e(){throw Error("clearTimeout has not been defined");}function h(a){if(p===setTimeout)return setTimeout(a,0);if((p===l||!p)&&setTimeout)return p=setTimeout,setTimeout(a,0);try{return p(a,0)}catch(d){try{return p.call(null,a,0)}catch(g){return p.call(this,a,0)}}}function n(a){if(q===clearTimeout)return clearTimeout(a);
if((q===e||!q)&&clearTimeout)return q=clearTimeout,clearTimeout(a);try{return q(a)}catch(d){try{return q.call(null,a)}catch(g){return q.call(this,a)}}}function B(){r&&u&&(r=!1,u.length?t=u.concat(t):f=-1,t.length&&v())}function v(){if(!r){var a=h(B);r=!0;for(var d=t.length;d;){u=t;for(t=[];++f<d;)u&&u[f].run();f=-1;d=t.length}u=null;r=!1;n(a)}}function A(a,d){this.fun=a;this.array=d}function w(){}a=b.exports={};try{var p="function"===typeof setTimeout?setTimeout:l}catch(c){p=l}try{var q="function"===
typeof clearTimeout?clearTimeout:e}catch(c){q=e}var t=[],r=!1,u,f=-1;a.nextTick=function(a){var c=Array(arguments.length-1);if(1<arguments.length)for(var g=1;g<arguments.length;g++)c[g-1]=arguments[g];t.push(new A(a,c));1!==t.length||r||h(v)};A.prototype.run=function(){this.fun.apply(null,this.array)};a.title="browser";a.browser=!0;a.env={};a.argv=[];a.version="";a.versions={};a.on=w;a.addListener=w;a.once=w;a.off=w;a.removeListener=w;a.removeAllListeners=w;a.emit=w;a.prependListener=w;a.prependOnceListener=
w;a.listeners=function(a){return[]};a.binding=function(a){throw Error("process.binding is not supported");};a.cwd=function(){return"/"};a.chdir=function(a){throw Error("process.chdir is not supported");};a.umask=function(){return 0}},{}],25:[function(a,b,k){(function(a){(function(a,h){"object"===typeof k&&"undefined"!==typeof b?b.exports=h():function(){var b=a._,e=h();a._=e;e.noConflict=function(){a._=b;return e}}()})(this,function(){function b(a){if(a instanceof b)return a;if(!(this instanceof b))return new b(a);
this._wrapped=a}function h(a,c,d){if(void 0===c)return a;switch(null==d?3:d){case 1:return function(d){return a.call(c,d)};case 3:return function(d,b,g){return a.call(c,d,b,g)};case 4:return function(d,b,g,e){return a.call(c,d,b,g,e)}}return function(){return a.apply(c,arguments)}}function n(a,c,d){return null==a?qa:Q(a)?h(a,c,d):ba(a)&&!T(a)?fa(a):ra(a)}function l(a,c){return n(a,c,Infinity)}function k(a,c,d){return b.iteratee!==l?b.iteratee(a,c):n(a,c,d)}function A(a,c){c=null==c?a.length-1:+c;
return function(){for(var d=Math.max(arguments.length-c,0),b=Array(d),g=0;g<d;g++)b[g]=arguments[g+c];switch(c){case 0:return a.call(this,b);case 1:return a.call(this,arguments[0],b);case 2:return a.call(this,arguments[0],arguments[1],b)}d=Array(c+1);for(g=0;g<c;g++)d[g]=arguments[g];d[c]=b;return a.apply(this,d)}}function w(a){if(!ba(a))return{};if(Ea)return Ea(a);sa.prototype=a;a=new sa;sa.prototype=null;return a}function p(a){return function(c){return null==c?void 0:c[a]}}function q(a,c){return null!=
a&&Fa.call(a,c)}function t(a,c){for(var d=c.length,b=0;b<d;b++){if(null==a)return;a=a[c[b]]}return d?a:void 0}function r(a){a=U(a);return"number"==typeof a&&0<=a&&a<=cb}function u(a,c,d){c=h(c,d);var b;if(r(a))for(d=0,b=a.length;d<b;d++)c(a[d],d,a);else{var g=H(a);d=0;for(b=g.length;d<b;d++)c(a[g[d]],g[d],a)}return a}function f(a,c,d){c=k(c,d);d=!r(a)&&H(a);for(var b=(d||a).length,g=Array(b),e=0;e<b;e++){var f=d?d[e]:e;g[e]=c(a[f],f,a)}return g}function c(a){return function(c,d,b,g){var e=3<=arguments.length,
f=h(d,g,4),m=b,E=!r(c)&&H(c),n=(E||c).length,G=0<a?0:n-1;e||(m=c[E?E[G]:G],G+=a);for(;0<=G&&G<n;G+=a)e=E?E[G]:G,m=f(m,c[e],e,c);return m}}function d(a,c,d){c=(r(a)?ta:N)(a,c,d);if(void 0!==c&&-1!==c)return a[c]}function g(a,c,d){var b=[];c=k(c,d);u(a,function(a,d,g){c(a,d,g)&&b.push(a)});return b}function E(a,c,d){c=k(c,d);d=!r(a)&&H(a);for(var b=(d||a).length,g=0;g<b;g++){var e=d?d[g]:g;if(!c(a[e],e,a))return!1}return!0}function C(a,c,d){c=k(c,d);d=!r(a)&&H(a);for(var b=(d||a).length,g=0;g<b;g++){var e=
d?d[g]:g;if(c(a[e],e,a))return!0}return!1}function D(a,c,d,b){r(a)||(a=J(a));if("number"!=typeof d||b)d=0;return 0<=Ga(a,c,d)}function X(a,c){return f(a,ra(c))}function m(a,c,d){var b=-Infinity,g=-Infinity,e;if(null==c||"number"==typeof c&&"object"!=typeof a[0]&&null!=a){a=r(a)?a:J(a);for(var f=0,h=a.length;f<h;f++)d=a[f],null!=d&&d>b&&(b=d)}else c=k(c,d),u(a,function(a,d,f){e=c(a,d,f);if(e>g||-Infinity===e&&-Infinity===b)b=a,g=e});return b}function M(a,c,d){if(null==c||d)return r(a)||(a=J(a)),a[ua(a.length-
1)];a=r(a)?Ha(a):J(a);d=U(a);c=Math.max(Math.min(c,d),0);--d;for(var b=0;b<c;b++){var g=ua(b,d),e=a[b];a[b]=a[g];a[g]=e}return a.slice(0,c)}function Y(a,c){return function(d,b,g){var e=c?[[],[]]:{};b=k(b,g);u(d,function(c,g){g=b(c,g,d);a(e,c,g)});return e}}function Z(a,c,d){return null==a||1>a.length?null==c?void 0:[]:null==c||d?a[0]:ea(a,a.length-c)}function ea(a,c,d){return ha.call(a,0,Math.max(0,a.length-(null==c||d?1:c)))}function aa(a,c,d){return ha.call(a,null==c||d?1:c)}function S(a,c,d,b){b=
b||[];for(var g=b.length,e=0,f=U(a);e<f;e++){var h=a[e];if(r(h)&&(T(h)||ia(h)))if(c)for(var m=0,E=h.length;m<E;)b[g++]=h[m++];else S(h,c,d,b),g=b.length;else d||(b[g++]=h)}return b}function V(a,c,d,b){Ia(c)||(b=d,d=c,c=!1);null!=d&&(d=k(d,b));b=[];for(var g=[],e=0,f=U(a);e<f;e++){var h=a[e],m=d?d(h,e,a):h;c&&!d?(e&&g===m||b.push(h),g=m):d?D(g,m)||(g.push(m),b.push(h)):D(b,h)||b.push(h)}return b}function ja(a){for(var c=a&&m(a,U).length||0,d=Array(c),b=0;b<c;b++)d[b]=X(a,b);return d}function ka(a){return function(c,
d,b){d=k(d,b);b=U(c);for(var g=0<a?0:b-1;0<=g&&g<b;g+=a)if(d(c[g],g,c))return g;return-1}}function ca(a,c,d,b){d=k(d,b,1);c=d(c);b=0;for(var g=U(a);b<g;){var e=Math.floor((b+g)/2);d(a[e])<c?b=e+1:g=e}return b}function la(a,c,d){return function(b,g,e){var f=0,h=U(b);if("number"==typeof e)0<a?f=0<=e?e:Math.max(e+h,f):h=0<=e?Math.min(e+1,h):e+h+1;else if(d&&e&&h)return e=d(b,g),b[e]===g?e:-1;if(g!==g)return e=c(ha.call(b,f,h),Ja),0<=e?e+f:-1;for(e=0<a?f:h-1;0<=e&&e<h;e+=a)if(b[e]===g)return e;return-1}}
function W(a,c,d,b,g){if(!(b instanceof c))return a.apply(d,g);c=w(a.prototype);a=a.apply(c,g);return ba(a)?a:c}function F(a){return function(){return!a.apply(this,arguments)}}function G(a,c){var d;return function(){0<--a&&(d=c.apply(this,arguments));1>=a&&(c=null);return d}}function K(a,c){var d=Ka.length,b=a.constructor;b=Q(b)&&b.prototype||va;var g="constructor";for(q(a,g)&&!D(c,g)&&c.push(g);d--;)g=Ka[d],g in a&&a[g]!==b[g]&&!D(c,g)&&c.push(g)}function H(a){if(!ba(a))return[];if(La)return La(a);
var c=[],d;for(d in a)q(a,d)&&c.push(d);Ma&&K(a,c);return c}function I(a){if(!ba(a))return[];var c=[],d;for(d in a)c.push(d);Ma&&K(a,c);return c}function J(a){for(var c=H(a),d=c.length,b=Array(d),g=0;g<d;g++)b[g]=a[c[g]];return b}function O(a){for(var c={},d=H(a),b=0,g=d.length;b<g;b++)c[a[d[b]]]=d[b];return c}function P(a){var c=[],d;for(d in a)Q(a[d])&&c.push(d);return c.sort()}function L(a,c){return function(d){var b=arguments.length;c&&(d=Object(d));if(2>b||null==d)return d;for(var g=1;g<b;g++)for(var e=
arguments[g],f=a(e),h=f.length,m=0;m<h;m++){var E=f[m];c&&void 0!==d[E]||(d[E]=e[E])}return d}}function N(a,c,d){c=k(c,d);d=H(a);for(var b,g=0,e=d.length;g<e;g++)if(b=d[g],c(a[b],b,a))return b}function db(a,c,d){return c in d}function Ha(a){return ba(a)?T(a)?a.slice():Na({},a):a}function Oa(a,c){var d=H(c),b=d.length;if(null==a)return!b;a=Object(a);for(var g=0;g<b;g++){var e=d[g];if(c[e]!==a[e]||!(e in a))return!1}return!0}function wa(a,c,d,b){if(a===c)return 0!==a||1/a===1/c;if(null==a||null==c)return!1;
if(a!==a)return c!==c;var g=typeof a;return"function"!==g&&"object"!==g&&"object"!=typeof c?!1:eb(a,c,d,b)}function eb(a,c,d,g){a instanceof b&&(a=a._wrapped);c instanceof b&&(c=c._wrapped);var e=ma.call(a);if(e!==ma.call(c))return!1;switch(e){case "[object RegExp]":case "[object String]":return""+a===""+c;case "[object Number]":return+a!==+a?+c!==+c:0===+a?1/+a===1/c:+a===+c;case "[object Date]":case "[object Boolean]":return+a===+c;case "[object Symbol]":return Pa.valueOf.call(a)===Pa.valueOf.call(c)}e=
"[object Array]"===e;if(!e){if("object"!=typeof a||"object"!=typeof c)return!1;var f=a.constructor,h=c.constructor;if(f!==h&&!(Q(f)&&f instanceof f&&Q(h)&&h instanceof h)&&"constructor"in a&&"constructor"in c)return!1}d=d||[];g=g||[];for(f=d.length;f--;)if(d[f]===a)return g[f]===c;d.push(a);g.push(c);if(e){f=a.length;if(f!==c.length)return!1;for(;f--;)if(!wa(a[f],c[f],d,g))return!1}else{e=H(a);f=e.length;if(H(c).length!==f)return!1;for(;f--;)if(h=e[f],!q(c,h)||!wa(a[h],c[h],d,g))return!1}d.pop();
g.pop();return!0}function R(a){return function(c){return ma.call(c)==="[object "+a+"]"}}function ba(a){var c=typeof a;return"function"===c||"object"===c&&!!a}function Ja(a){return Qa(a)&&Ra(a)}function Ia(a){return!0===a||!1===a||"[object Boolean]"===ma.call(a)}function qa(a){return a}function ra(a){return T(a)?function(c){return t(c,a)}:p(a)}function fa(a){a=na({},a);return function(c){return Oa(c,a)}}function ua(a,c){null==c&&(c=a,a=0);return a+Math.floor(Math.random()*(c-a+1))}function Sa(a){var c=
function(c){return a[c]},d="(?:"+H(a).join("|")+")",b=RegExp(d),g=RegExp(d,"g");return function(a){a=null==a?"":""+a;return b.test(a)?a.replace(g,c):a}}function xa(a,c){return a._chain?b(c).chain():c}function Ta(a){u(P(a),function(c){var d=b[c]=a[c];b.prototype[c]=function(){var a=[this._wrapped];fb.apply(a,arguments);return xa(this,d.apply(b,a))}});return b}var oa="object"==typeof self&&self.self===self&&self||"object"==typeof a&&a.global===a&&a||Function("return this")()||{},pa=Array.prototype,
va=Object.prototype,Pa="undefined"!==typeof Symbol?Symbol.prototype:null,fb=pa.push,ha=pa.slice,ma=va.toString,Fa=va.hasOwnProperty,gb=Array.isArray,La=Object.keys,Ea=Object.create,Ra=oa.isNaN,hb=oa.isFinite,sa=function(){},ib=b.VERSION="1.10.2";b.iteratee=l;var cb=Math.pow(2,53)-1,U=p("length"),ya=c(1),Ua=c(-1),jb=A(function(a,c,d){if(Q(c))var b=c;else if(T(c)){var g=c.slice(0,-1);c=c[c.length-1]}return f(a,function(a){var e=b;if(!e){g&&g.length&&(a=t(a,g));if(null==a)return;e=a[c]}return null==
e?e:e.apply(a,d)})}),kb=Y(function(a,c,d){q(a,d)?a[d].push(c):a[d]=[c]}),lb=Y(function(a,c,d){a[d]=c}),mb=Y(function(a,c,d){q(a,d)?a[d]++:a[d]=1}),nb=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g,ob=Y(function(a,c,d){a[d?0:1].push(c)},!0),pb=A(function(a,c){return Va(a,c)}),qb=A(function(a){return V(S(a,!0,!0))}),Va=A(function(a,c){c=S(c,!0,!0);return g(a,function(a){return!D(c,a)})}),rb=A(ja),ta=ka(1),Wa=ka(-1),Ga=la(1,ta,ca),sb=la(-1,Wa),Xa=A(function(a,c,d){if(!Q(a))throw new TypeError("Bind must be called on a function");
var b=A(function(g){return W(a,b,c,this,d.concat(g))});return b}),da=A(function(a,c){var d=da.placeholder,b=function(){for(var g=0,e=c.length,f=Array(e),h=0;h<e;h++)f[h]=c[h]===d?arguments[g++]:c[h];for(;g<arguments.length;)f.push(arguments[g++]);return W(a,b,this,this,f)};return b});da.placeholder=b;var tb=A(function(a,c){c=S(c,!1,!1);var d=c.length;if(1>d)throw Error("bindAll must be passed function names");for(;d--;){var b=c[d];a[b]=Xa(a[b],a)}}),za=A(function(a,c,d){return setTimeout(function(){return a.apply(null,
d)},c)}),ub=da(za,b,1),vb=da(G,2),Ma=!{toString:null}.propertyIsEnumerable("toString"),Ka="valueOf isPrototypeOf toString propertyIsEnumerable hasOwnProperty toLocaleString".split(" "),Na=L(I),na=L(H),Ya=A(function(a,c){var d={},b=c[0];if(null==a)return d;Q(b)?(1<c.length&&(b=h(b,c[1])),c=I(a)):(b=db,c=S(c,!1,!1),a=Object(a));for(var g=0,e=c.length;g<e;g++){var f=c[g],m=a[f];b(m,f,a)&&(d[f]=m)}return d}),wb=A(function(a,c){var d=c[0],b;Q(d)?(d=F(d),1<c.length&&(b=c[1])):(c=f(S(c,!1,!1),String),d=
function(a,d){return!D(c,d)});return Ya(a,d,b)}),Za=L(I,!0),T=gb||R("Array"),ia=R("Arguments"),Q=R("Function"),Aa=R("String"),Qa=R("Number"),xb=R("Date"),yb=R("RegExp"),zb=R("Error"),$a=R("Symbol"),Ab=R("Map"),Bb=R("WeakMap"),Cb=R("Set"),Db=R("WeakSet");(function(){ia(arguments)||(ia=function(a){return q(a,"callee")})})();var Eb=oa.document&&oa.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof Eb&&(Q=function(a){return"function"==typeof a||!1});var Ba=Date.now||
function(){return(new Date).getTime()},ab={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Fb=O(ab),Gb=Sa(ab),Hb=Sa(Fb),Ib=0,Jb=b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Ca=/(.)^/,Kb={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Lb=/\\|'|\r|\n|\u2028|\u2029/g,Mb=function(a){return"\\"+Kb[a]};u("pop push reverse shift sort splice unshift".split(" "),function(a){var c=pa[a];b.prototype[a]=
function(){var d=this._wrapped;c.apply(d,arguments);"shift"!==a&&"splice"!==a||0!==d.length||delete d[0];return xa(this,d)}});u(["concat","join","slice"],function(a){var c=pa[a];b.prototype[a]=function(){return xa(this,c.apply(this._wrapped,arguments))}});b.prototype.value=function(){return this._wrapped};b.prototype.valueOf=b.prototype.toJSON=b.prototype.value;b.prototype.toString=function(){return String(this._wrapped)};var bb=Ta({"default":b,VERSION:ib,iteratee:l,restArguments:A,each:u,forEach:u,
map:f,collect:f,reduce:ya,foldl:ya,inject:ya,reduceRight:Ua,foldr:Ua,find:d,detect:d,filter:g,select:g,reject:function(a,c,d){return g(a,F(k(c)),d)},every:E,all:E,some:C,any:C,contains:D,includes:D,include:D,invoke:jb,pluck:X,where:function(a,c){return g(a,fa(c))},findWhere:function(a,c){return d(a,fa(c))},max:m,min:function(a,c,d){var b=Infinity,g=Infinity,e;if(null==c||"number"==typeof c&&"object"!=typeof a[0]&&null!=a){a=r(a)?a:J(a);for(var f=0,h=a.length;f<h;f++)d=a[f],null!=d&&d<b&&(b=d)}else c=
k(c,d),u(a,function(a,d,f){e=c(a,d,f);if(e<g||Infinity===e&&Infinity===b)b=a,g=e});return b},shuffle:function(a){return M(a,Infinity)},sample:M,sortBy:function(a,c,d){var b=0;c=k(c,d);return X(f(a,function(a,d,g){return{value:a,index:b++,criteria:c(a,d,g)}}).sort(function(a,c){var d=a.criteria,b=c.criteria;if(d!==b){if(d>b||void 0===d)return 1;if(d<b||void 0===b)return-1}return a.index-c.index}),"value")},groupBy:kb,indexBy:lb,countBy:mb,toArray:function(a){return a?T(a)?ha.call(a):Aa(a)?a.match(nb):
r(a)?f(a,qa):J(a):[]},size:function(a){return null==a?0:r(a)?a.length:H(a).length},partition:ob,first:Z,head:Z,take:Z,initial:ea,last:function(a,c,d){return null==a||1>a.length?null==c?void 0:[]:null==c||d?a[a.length-1]:aa(a,Math.max(0,a.length-c))},rest:aa,tail:aa,drop:aa,compact:function(a){return g(a,Boolean)},flatten:function(a,c){return S(a,c,!1)},without:pb,uniq:V,unique:V,union:qb,intersection:function(a){for(var c=[],d=arguments.length,b=0,g=U(a);b<g;b++){var e=a[b];if(!D(c,e)){var f;for(f=
1;f<d&&D(arguments[f],e);f++);f===d&&c.push(e)}}return c},difference:Va,unzip:ja,zip:rb,object:function(a,c){for(var d={},b=0,g=U(a);b<g;b++)c?d[a[b]]=c[b]:d[a[b][0]]=a[b][1];return d},findIndex:ta,findLastIndex:Wa,sortedIndex:ca,indexOf:Ga,lastIndexOf:sb,range:function(a,c,d){null==c&&(c=a||0,a=0);d||(d=c<a?-1:1);c=Math.max(Math.ceil((c-a)/d),0);for(var b=Array(c),g=0;g<c;g++,a+=d)b[g]=a;return b},chunk:function(a,c){if(null==c||1>c)return[];for(var d=[],b=0,g=a.length;b<g;)d.push(ha.call(a,b,b+=
c));return d},bind:Xa,partial:da,bindAll:tb,memoize:function(a,c){var d=function(b){var g=d.cache,e=""+(c?c.apply(this,arguments):b);q(g,e)||(g[e]=a.apply(this,arguments));return g[e]};d.cache={};return d},delay:za,defer:ub,throttle:function(a,c,d){var b,g,e,f,h=0;d||(d={});var m=function(){h=!1===d.leading?0:Ba();b=null;f=a.apply(g,e);b||(g=e=null)},E=function(){var E=Ba();h||!1!==d.leading||(h=E);var n=c-(E-h);g=this;e=arguments;0>=n||n>c?(b&&(clearTimeout(b),b=null),h=E,f=a.apply(g,e),b||(g=e=
null)):b||!1===d.trailing||(b=setTimeout(m,n));return f};E.cancel=function(){clearTimeout(b);h=0;b=g=e=null};return E},debounce:function(a,c,d){var b,g,e=function(c,d){b=null;d&&(g=a.apply(c,d))},f=A(function(f){b&&clearTimeout(b);if(d){var h=!b;b=setTimeout(e,c);h&&(g=a.apply(this,f))}else b=za(e,c,this,f);return g});f.cancel=function(){clearTimeout(b);b=null};return f},wrap:function(a,c){return da(c,a)},negate:F,compose:function(){var a=arguments,c=a.length-1;return function(){for(var d=c,b=a[c].apply(this,
arguments);d--;)b=a[d].call(this,b);return b}},after:function(a,c){return function(){if(1>--a)return c.apply(this,arguments)}},before:G,once:vb,keys:H,allKeys:I,values:J,mapObject:function(a,c,d){c=k(c,d);d=H(a);for(var b=d.length,g={},e=0;e<b;e++){var f=d[e];g[f]=c(a[f],f,a)}return g},pairs:function(a){for(var c=H(a),d=c.length,b=Array(d),g=0;g<d;g++)b[g]=[c[g],a[c[g]]];return b},invert:O,functions:P,methods:P,extend:Na,extendOwn:na,assign:na,findKey:N,pick:Ya,omit:wb,defaults:Za,create:function(a,
c){a=w(a);c&&na(a,c);return a},clone:Ha,tap:function(a,c){c(a);return a},isMatch:Oa,isEqual:function(a,c){return wa(a,c)},isEmpty:function(a){return null==a?!0:r(a)&&(T(a)||Aa(a)||ia(a))?0===a.length:0===H(a).length},isElement:function(a){return!(!a||1!==a.nodeType)},isArray:T,isObject:ba,isArguments:ia,isFunction:Q,isString:Aa,isNumber:Qa,isDate:xb,isRegExp:yb,isError:zb,isSymbol:$a,isMap:Ab,isWeakMap:Bb,isSet:Cb,isWeakSet:Db,isFinite:function(a){return!$a(a)&&hb(a)&&!Ra(parseFloat(a))},isNaN:Ja,
isBoolean:Ia,isNull:function(a){return null===a},isUndefined:function(a){return void 0===a},has:function(a,c){if(!T(c))return q(a,c);for(var d=c.length,b=0;b<d;b++){var g=c[b];if(null==a||!Fa.call(a,g))return!1;a=a[g]}return!!d},identity:qa,constant:function(a){return function(){return a}},noop:function(){},property:ra,propertyOf:function(a){return null==a?function(){}:function(c){return T(c)?t(a,c):a[c]}},matcher:fa,matches:fa,times:function(a,c,d){var b=Array(Math.max(0,a));c=h(c,d,1);for(d=0;d<
a;d++)b[d]=c(d);return b},random:ua,now:Ba,escape:Gb,unescape:Hb,result:function(a,c,d){T(c)||(c=[c]);var b=c.length;if(!b)return Q(d)?d.call(a):d;for(var g=0;g<b;g++){var e=null==a?void 0:a[c[g]];void 0===e&&(e=d,g=b);a=Q(e)?e.call(a):e}return a},uniqueId:function(a){var c=++Ib+"";return a?a+c:c},templateSettings:Jb,template:function(a,c,d){!c&&d&&(c=d);c=Za({},c,b.templateSettings);d=RegExp([(c.escape||Ca).source,(c.interpolate||Ca).source,(c.evaluate||Ca).source].join("|")+"|$","g");var g=0,e=
"__p+='";a.replace(d,function(c,d,b,f,h){e+=a.slice(g,h).replace(Lb,Mb);g=h+c.length;d?e+="'+\n((__t=("+d+"))==null?'':_.escape(__t))+\n'":b?e+="'+\n((__t=("+b+"))==null?'':__t)+\n'":f&&(e+="';\n"+f+"\n__p+='");return c});e+="';\n";c.variable||(e="with(obj||{}){\n"+e+"}\n");e="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+e+"return __p;\n";try{var f=new Function(c.variable||"obj","_",e)}catch(Da){throw Da.source=e,Da;}d=function(a){return f.call(this,a,
b)};d.source="function("+(c.variable||"obj")+"){\n"+e+"}";return d},chain:function(a){a=b(a);a._chain=!0;return a},mixin:Ta});return bb._=bb})}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}]},{},[13])(13)});var CindyLeap=function(a){function b(a,b){var e,h;for(e in a)(h=b[e])?h(l(a[e])):console.log("Modifier "+e+" not supported")}var k=a.nada,l=a.evaluate,e=a.defineFunction;e("initleapmotion",0,function(e,n){var h=!1;b(n,{enablegestures:function(a){return h=coerce.toBool(a,!1)},usehandtransformcdy3d:function(a){return setManipulateSceneTransformActive(coerce.toBool(a,!1))},rotationfactor:function(a){return setLeapMotionRotationFactor(coerce.toReal(a,2))},translationfactor:function(a){return setLeapMotionTranslationFactor(coerce.toReal(a,
1))}});initLeapMotion(a,h);return k});e("leapdebugprinthands",0,function(a,b){a=getLeapHandsData();0<a.length&&console.log(a);return k});e("leapdebugprintgestures",0,function(a,b){a=getLeapGestureData();0<a.length&&console.log(a);return k});e("leapnormalizeposition",1,function(b,e){b=a.evaluate(b[0]).value;b=leapNormalizePosition([b[0].value.real,b[1].value.real,b[2].value.real]);return nestedArrayToCSList(b)});e("getleaphandsdata",0,function(a,b){a=new Set(["frame"]);b=getLeapHandsData();return convertObjectToCindyDict(b,
a,new Map)});e("getleapgesturedata",0,function(a,b){a=new Set(["frame"]);b=getLeapGestureData();return convertObjectToCindyDict(b,a,new Map)});e("getleapmotionmodelmatrix",0,function(a,b){a=getLeapMotionModelMatrix();return nestedArrayToCSList([[a[0],a[1],a[2],a[3]],[a[4],a[5],a[6],a[7]],[a[8],a[9],a[10],a[11]],[a[12],a[13],a[14],a[15]]])});e("getleapmotionrotationmatrix",0,function(a,b){a=getLeapMotionModelMatrix();return nestedArrayToCSList([[a[0],a[1],a[2]],[a[4],a[5],a[6]],[a[8],a[9],a[10]]])});
e("getleapmotiontranslationvector",0,function(a,b){a=getLeapMotionModelMatrix();return nestedArrayToCSList([a[3]+1E-6,a[7],a[11]])});e("getleapmotiontransformhaschanged",0,function(a,b){return{ctype:"boolean",value:getLeapMotionTransformHasChanged()}})};CindyLeap.leapPreRender=leapPreRender;CindyLeap.leapPostRender=leapPostRender;CindyJS.registerPlugin(1,"CindyLeap",CindyLeap);var modelMatrixTmp,mvMatrixTmp,leapMotionModelMatrixInternal=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],leapMotionRotationMatrixInternal=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],leapMotionTransformHasChanged=!1,leapMotionRotationFactor=2,leapMotionTranslationFactor=1,lastLeapFrame=null,manipulateSceneTransformActive=!1,gesturesEnabled=!1;
function leapPreRender(a){if(manipulateSceneTransformActive){modelMatrixTmp=a.modelMatrix.slice();mvMatrixTmp=a.mvMatrix.slice();var b=getLeapMotionModelMatrix();a.modelMatrix=mul4mm(b,a.modelMatrix);a.mvMatrix=mul4mm(a.viewMatrix,a.modelMatrix)}}function leapPostRender(a){manipulateSceneTransformActive&&(a.modelMatrix=modelMatrixTmp.slice(),a.mvMatrix=mvMatrixTmp.slice())}
function initLeapMotion(a,b){gesturesEnabled=b;var k=new Leap.Controller({enableGestures:b});k.on("frame",function(b){onLeapMotionControllerFrame(a,k,b)});k.connect()}
function onLeapMotionControllerFrame(a,b,k){if(0<k.hands.length){lastLeapFrame=k;var l=k.hands[0];b=b.frame(1);l.rotationMatrix(b);k=k.interactionBox.normalizePoint(l.palmPosition,!0);b=l.palmNormal;var e=l.direction;b=[b[1]*e[2]-b[2]*e[1],b[2]*e[0]-b[0]*e[2],b[0]*e[1]-b[1]*e[0]];leapMotionRotationMatrixInternal=[b[0],b[1],b[2],0,l.palmNormal[0],l.palmNormal[1],l.palmNormal[2],0,l.direction[0],l.direction[1],l.direction[2],0,0,0,0,1];leapMotionRotationMatrixInternal=transpose4(mul4mm([1,0,0,0,0,-1,
0,0,0,0,-1,0,0,0,0,1],leapMotionRotationMatrixInternal));2==leapMotionRotationFactor?leapMotionRotationMatrixInternal=mul4mm(leapMotionRotationMatrixInternal,leapMotionRotationMatrixInternal):1!=leapMotionRotationFactor&&(l=axisAngleFromRotationMatrix(leapMotionRotationMatrixInternal),leapMotionRotationMatrixInternal=rotationMatrixFromAxisAngle(l[0],leapMotionRotationFactor*l[1]));leapMotionModelMatrixInternal=leapMotionRotationMatrixInternal.slice();leapMotionModelMatrixInternal[3]=leapMotionTranslationFactor*
(2*k[0]-1);leapMotionModelMatrixInternal[7]=leapMotionTranslationFactor*(2*k[1]-1);leapMotionModelMatrixInternal[11]=leapMotionTranslationFactor*(2*k[2]-1);leapMotionTransformHasChanged=!0;a.scheduleUpdate()}}function setManipulateSceneTransformActive(a){manipulateSceneTransformActive=a}function getLeapHandsData(){return null!=lastLeapFrame?lastLeapFrame.hands:[]}function getLeapGestureData(){return null!=lastLeapFrame&&gesturesEnabled?lastLeapFrame.gestures:[]}
function leapNormalizePosition(a){return null!=lastLeapFrame?(a=lastLeapFrame.interactionBox.normalizePoint(a,!0),[leapMotionTranslationFactor*(2*a[0]-1),leapMotionTranslationFactor*(2*a[1]-1),leapMotionTranslationFactor*(2*a[2]-1)]):a}function rotationMatrixFromAxisAngle(a,b){var k=Math.sin(b);b=Math.cos(b);var l=1-b;return[b+a[0]*a[0]*l,a[0]*a[1]*l-a[2]*k,a[0]*a[2]*l+a[1]*k,0,a[1]*a[0]*l+a[2]*k,b+a[1]*a[1]*l,a[1]*a[2]*l-a[0]*k,0,a[2]*a[0]*l-a[1]*k,a[2]*a[1]*l+a[0]*k,b+a[2]*a[2]*l,0,0,0,0,1]}
function axisAngleFromRotationMatrix(a){var b=function(a){return a*a};if(.001>Math.abs(a[1]-a[4])&&.001>Math.abs(a[2]-a[8])&&.001>Math.abs(a[6]-a[9])){if(.001>Math.abs(a[1]+a[4])&&.01>Math.abs(a[2]+a[8])&&.01>Math.abs(a[6]+a[9])&&.01>Math.abs(a[0]+a[5]+a[10]-3))return[[1,0,0],0];b=(a[0]+1)/2;var k=(a[5]+1)/2,l=(a[10]+1)/2,e=(a[1]+a[4])/4,h=(a[2]+a[8])/4;a=(a[6]+a[9])/4;var n=1/Math.sqrt(2);b>k&&b>l?.001>b?(x=0,z=y=n):(x=Math.sqrt(b),y=e/x,z=h/x):k>l?.001>k?(x=n,y=0,z=n):(y=Math.sqrt(k),x=e/y,z=a/
y):.001>l?(y=x=n,z=0):(z=Math.sqrt(l),x=h/z,y=a/z);return[[0,0,0],Math.PI]}b=Math.sqrt(b(a[9]-a[6])+b(a[2]-a[8])+b(a[4]-a[1]));return[[(a[9]-a[6])/b,(a[2]-a[8])/b,(a[4]-a[1])/b],Math.acos((a[0]+a[5]+a[10]-1)/2)]}function getLeapMotionModelMatrix(){return leapMotionModelMatrixInternal}function getLeapMotionTransformHasChanged(){return leapMotionTransformHasChanged?(leapMotionTransformHasChanged=!1,!0):!1}function setLeapMotionRotationFactor(a){leapMotionRotationFactor=a}
function setLeapMotionTranslationFactor(a){leapMotionTranslationFactor=a};/*
 LeapJS v0.6.4                                                  
 http://github.com/leapmotion/leapjs/                                        

 Copyright 2013 LeapMotion, Inc. and other contributors                      
 Released under the Apache-2.0 license                                     
 http://github.com/leapmotion/leapjs/blob/master/LICENSE.txt                 
*/
(function(a,b,k){function l(h,k){if(!b[h]){if(!a[h]){var n="function"==typeof require&&require;if(!k&&n)return n(h,!0);if(e)return e(h,!0);throw Error("Cannot find module '"+h+"'");}k=b[h]={exports:{}};a[h][0].call(k.exports,function(b){var e=a[h][1][b];return l(e?e:b)},k,k.exports)}return b[h].exports}for(var e="function"==typeof require&&require,h=0;h<k.length;h++)l(k[h]);return l})({1:[function(a,b,k){a("./pointable");k=a("gl-matrix");var l=k.vec3,e=k.mat3,h=k.mat4;a("underscore");a=b.exports=
function(a,b){this.finger=a;this._matrix=this._center=null;this.type=b.type;this.prevJoint=b.prevJoint;this.nextJoint=b.nextJoint;this.width=b.width;a=Array(3);l.sub(a,b.nextJoint,b.prevJoint);this.length=l.length(a);this.basis=b.basis};a.prototype.left=function(){return this._left?this._left:this._left=0>e.determinant(this.basis[0].concat(this.basis[1]).concat(this.basis[2]))};a.prototype.matrix=function(){if(this._matrix)return this._matrix;var a=this.basis,b=this._matrix=h.create();b[0]=a[0][0];
b[1]=a[0][1];b[2]=a[0][2];b[4]=a[1][0];b[5]=a[1][1];b[6]=a[1][2];b[8]=a[2][0];b[9]=a[2][1];b[10]=a[2][2];b[3]=this.center()[0];b[7]=this.center()[1];b[11]=this.center()[2];this.left()&&(b[0]*=-1,b[1]*=-1,b[2]*=-1);return this._matrix};a.prototype.lerp=function(a,b){l.lerp(a,this.prevJoint,this.nextJoint,b)};a.prototype.center=function(){if(this._center)return this._center;var a=l.create();this.lerp(a,.5);return this._center=a};a.prototype.direction=function(){return[-1*this.basis[2][0],-1*this.basis[2][1],
-1*this.basis[2][2]]}},{"./pointable":14,"gl-matrix":23,underscore:24}],2:[function(a,b,k){a=b.exports=function(a){this.pos=0;this._buf=[];this.size=a};a.prototype.get=function(a){void 0==a&&(a=0);if(!(a>=this.size||a>=this._buf.length))return this._buf[(this.pos-a-1)%this.size]};a.prototype.push=function(a){this._buf[this.pos%this.size]=a;return this.pos++}},{}],3:[function(a,b,k){var l=a("../protocol").chooseProtocol;k=a("events").EventEmitter;var e=a("underscore"),h=b.exports=function(a){this.opts=
e.defaults(a||{},{host:"127.0.0.1",enableGestures:!1,scheme:this.getScheme(),port:this.getPort(),background:!1,optimizeHMD:!1,requestProtocolVersion:h.defaultProtocolVersion});this.host=this.opts.host;this.port=this.opts.port;this.scheme=this.opts.scheme;this.protocolVersionVerified=!1;this.optimizeHMD=this.background=null;this.on("ready",function(){this.enableGestures(this.opts.enableGestures);this.setBackground(this.opts.background);this.setOptimizeHMD(this.opts.optimizeHMD);this.opts.optimizeHMD?
console.log("Optimized for head mounted display usage."):console.log("Optimized for desktop usage.")})};h.defaultProtocolVersion=6;h.prototype.getUrl=function(){return this.scheme+"//"+this.host+":"+this.port+"/v"+this.opts.requestProtocolVersion+".json"};h.prototype.getScheme=function(){return"ws:"};h.prototype.getPort=function(){return 6437};h.prototype.setBackground=function(a){this.opts.background=a;this.protocol&&this.protocol.sendBackground&&this.background!==this.opts.background&&(this.background=
this.opts.background,this.protocol.sendBackground(this,this.opts.background))};h.prototype.setOptimizeHMD=function(a){this.opts.optimizeHMD=a;this.protocol&&this.protocol.sendOptimizeHMD&&this.optimizeHMD!==this.opts.optimizeHMD&&(this.optimizeHMD=this.opts.optimizeHMD,this.protocol.sendOptimizeHMD(this,this.opts.optimizeHMD))};h.prototype.handleOpen=function(){this.connected||(this.connected=!0,this.emit("connect"))};h.prototype.enableGestures=function(a){this.gesturesEnabled=a?!0:!1;this.send(this.protocol.encode({enableGestures:this.gesturesEnabled}))};
h.prototype.handleClose=function(a,b){this.connected&&(this.disconnect(),1001===a&&1<this.opts.requestProtocolVersion&&(this.protocolVersionVerified?this.protocolVersionVerified=!1:this.opts.requestProtocolVersion--),this.startReconnection())};h.prototype.startReconnection=function(){var a=this;this.reconnectionTimer||(this.reconnectionTimer=setInterval(function(){a.reconnect()},500))};h.prototype.stopReconnection=function(){this.reconnectionTimer=clearInterval(this.reconnectionTimer)};h.prototype.disconnect=
function(a){a||this.stopReconnection();if(this.socket)return this.socket.close(),delete this.socket,delete this.protocol,delete this.background,delete this.optimizeHMD,delete this.focusedState,this.connected&&(this.connected=!1,this.emit("disconnect")),!0};h.prototype.reconnect=function(){this.connected?this.stopReconnection():(this.disconnect(!0),this.connect())};h.prototype.handleData=function(a){a=JSON.parse(a);void 0===this.protocol?(a=this.protocol=l(a),this.protocolVersionVerified=!0,this.emit("ready")):
a=this.protocol(a);this.emit(a.type,a)};h.prototype.connect=function(){if(!this.socket)return this.socket=this.setupSocket(),!0};h.prototype.send=function(a){this.socket.send(a)};h.prototype.reportFocus=function(a){this.connected&&this.focusedState!==a&&(this.focusedState=a,this.emit(this.focusedState?"focus":"blur"),this.protocol&&this.protocol.sendFocused&&this.protocol.sendFocused(this,this.focusedState))};e.extend(h.prototype,k.prototype)},{"../protocol":15,events:21,underscore:24}],4:[function(a,
b,k){var l=b.exports=a("./base");a=a("underscore");b=b.exports=function(a){l.call(this,a);var b=this;this.on("ready",function(){b.startFocusLoop()});this.on("disconnect",function(){b.stopFocusLoop()})};a.extend(b.prototype,l.prototype);b.__proto__=l;b.prototype.useSecure=function(){return"https:"===location.protocol};b.prototype.getScheme=function(){return this.useSecure()?"wss:":"ws:"};b.prototype.getPort=function(){return this.useSecure()?6436:6437};b.prototype.setupSocket=function(){var a=this,
b=new WebSocket(this.getUrl());b.onopen=function(){a.handleOpen()};b.onclose=function(b){a.handleClose(b.code,b.reason)};b.onmessage=function(b){a.handleData(b.data)};b.onerror=function(b){a.useSecure()&&"wss:"===a.scheme?(a.scheme="ws:",a.port=6437,a.disconnect(),a.connect()):confirm("Leap Motion controller driver (V2) not found. Please download the driver from the following website and check that the port 6437 is open.")&&(window.location.href="https://developer.leapmotion.com/sdk/v2")};return b};
b.prototype.startFocusLoop=function(){if(!this.focusDetectorTimer){var a=this,b=null;b="undefined"!==typeof document.hidden?"hidden":"undefined"!==typeof document.mozHidden?"mozHidden":"undefined"!==typeof document.msHidden?"msHidden":"undefined"!==typeof document.webkitHidden?"webkitHidden":void 0;void 0===a.windowVisible&&(a.windowVisible=void 0===b?!0:!1===document[b]);var l=window.addEventListener("focus",function(b){a.windowVisible=!0;v()}),k=window.addEventListener("blur",function(b){a.windowVisible=
!1;v()});this.on("disconnect",function(){window.removeEventListener("focus",l);window.removeEventListener("blur",k)});var v=function(){a.reportFocus((void 0===b?!0:!1===document[b])&&a.windowVisible)};v();this.focusDetectorTimer=setInterval(v,100)}};b.prototype.stopFocusLoop=function(){this.focusDetectorTimer&&(clearTimeout(this.focusDetectorTimer),delete this.focusDetectorTimer)}},{"./base":3,underscore:24}],5:[function(a,b,k){var l=a("__browserify_process"),e=a("./frame"),h=a("./hand"),n=a("./pointable"),
B=a("./finger"),v=a("./circular_buffer"),A=a("./pipeline");k=a("events").EventEmitter;var w=a("./gesture").gestureListener,p=a("./dialog"),q=a("underscore"),t=b.exports=function(b){var h=this;b=q.defaults(b||{},{inNode:"undefined"!==typeof l&&l.versions&&l.versions.node});this.inNode=b.inNode;b=q.defaults(b||{},{frameEventName:this.useAnimationLoop()?"animationFrame":"deviceFrame",suppressAnimationLoop:!this.useAnimationLoop(),loopWhileDisconnected:!0,useAllPlugins:!1,checkVersion:!0});this.animationFrameRequested=
!1;this.onAnimationFrame=function(a){h.lastConnectionFrame.valid&&h.emit("animationFrame",h.lastConnectionFrame);h.emit("frameEnd",a);h.loopWhileDisconnected&&(!1!==h.connection.focusedState||h.connection.opts.background)?window.requestAnimationFrame(h.onAnimationFrame):h.animationFrameRequested=!1};this.suppressAnimationLoop=b.suppressAnimationLoop;this.loopWhileDisconnected=b.loopWhileDisconnected;this.frameEventName=b.frameEventName;this.useAllPlugins=b.useAllPlugins;this.history=new v(200);this.lastConnectionFrame=
this.lastValidFrame=this.lastFrame=e.Invalid;this.accumulatedGestures=[];this.checkVersion=b.checkVersion;this.connectionType=void 0===b.connectionType?this.inBrowser()?a("./connection/browser"):a("./connection/node"):b.connectionType;this.connection=new this.connectionType(b);this.streamingCount=0;this.devices={};this.plugins={};this._pluginPipelineSteps={};this._pluginExtendedMethods={};b.useAllPlugins&&this.useRegisteredPlugins();this.setupFrameEvents(b);this.setupConnectionEvents();this.startAnimationLoop()};
t.prototype.gesture=function(a,b){a=w(this,a);void 0!==b&&a.stop(b);return a};t.prototype.setBackground=function(a){this.connection.setBackground(a);return this};t.prototype.setOptimizeHMD=function(a){this.connection.setOptimizeHMD(a);return this};t.prototype.inBrowser=function(){return!this.inNode};t.prototype.useAnimationLoop=function(){return this.inBrowser()&&!this.inBackgroundPage()};t.prototype.inBackgroundPage=function(){return"undefined"!==typeof chrome&&chrome.extension&&chrome.extension.getBackgroundPage&&
chrome.extension.getBackgroundPage()===window};t.prototype.connect=function(){this.connection.connect();return this};t.prototype.streaming=function(){return 0<this.streamingCount};t.prototype.connected=function(){return!!this.connection.connected};t.prototype.startAnimationLoop=function(){this.suppressAnimationLoop||this.animationFrameRequested||(this.animationFrameRequested=!0,window.requestAnimationFrame(this.onAnimationFrame))};t.prototype.disconnect=function(){this.connection.disconnect();return this};
t.prototype.frame=function(a){return this.history.get(a)||e.Invalid};t.prototype.loop=function(a){if(a)if("function"===typeof a)this.on(this.frameEventName,a);else this.setupFrameEvents(a);return this.connect()};t.prototype.addStep=function(a){this.pipeline||(this.pipeline=new A(this));this.pipeline.addStep(a)};t.prototype.processFrame=function(a){a.gestures&&(this.accumulatedGestures=this.accumulatedGestures.concat(a.gestures));this.lastConnectionFrame=a;this.startAnimationLoop();this.emit("deviceFrame",
a)};t.prototype.processFinishedFrame=function(a){this.lastFrame=a;a.valid&&(this.lastValidFrame=a);a.controller=this;a.historyIdx=this.history.push(a);if(a.gestures){a.gestures=this.accumulatedGestures;this.accumulatedGestures=[];for(var b=0;b!=a.gestures.length;b++)this.emit("gesture",a.gestures[b],a)}this.pipeline&&(a=this.pipeline.run(a),a||(a=e.Invalid));this.emit("frame",a);this.emitHandEvents(a)};t.prototype.emitHandEvents=function(a){for(var b=0;b<a.hands.length;b++)this.emit("hand",a.hands[b])};
t.prototype.setupFrameEvents=function(a){if(a.frame)this.on("frame",a.frame);if(a.hand)this.on("hand",a.hand)};t.prototype.setupConnectionEvents=function(){var a=this;this.connection.on("frame",function(c){a.processFrame(c)});this.on(this.frameEventName,function(c){a.processFinishedFrame(c)});var b=function(){if(5>a.connection.opts.requestProtocolVersion&&0==a.streamingCount){a.streamingCount=1;var c={attached:!0,streaming:!0,type:"unknown",id:"Lx00000000000"};a.devices[c.id]=c;a.emit("deviceAttached",
c);a.emit("deviceStreaming",c);a.emit("streamingStarted",c);a.connection.removeListener("frame",b)}},e=function(){if(0<a.streamingCount){for(var c in a.devices)a.emit("deviceStopped",a.devices[c]),a.emit("deviceRemoved",a.devices[c]);a.emit("streamingStopped",a.devices[c]);a.streamingCount=0;for(c in a.devices)delete a.devices[c]}};this.connection.on("focus",function(){a.loopWhileDisconnected&&a.startAnimationLoop();a.emit("focus")});this.connection.on("blur",function(){a.emit("blur")});this.connection.on("protocol",
function(c){c.on("beforeFrameCreated",function(c){a.emit("beforeFrameCreated",c)});c.on("afterFrameCreated",function(c,b){a.emit("afterFrameCreated",c,b)});a.emit("protocol",c)});this.connection.on("ready",function(){a.checkVersion&&!a.inNode&&a.checkOutOfDate();a.emit("ready")});this.connection.on("connect",function(){a.emit("connect");a.connection.removeListener("frame",b);a.connection.on("frame",b)});this.connection.on("disconnect",function(){a.emit("disconnect");e()});this.connection.on("deviceConnect",
function(c){c.state?(a.emit("deviceConnected"),a.connection.removeListener("frame",b),a.connection.on("frame",b)):(a.emit("deviceDisconnected"),e())});this.connection.on("deviceEvent",function(c){c=c.state;var d=a.devices[c.id],b={},e;for(e in c)d&&d.hasOwnProperty(e)&&d[e]==c[e]||(b[e]=!0);a.devices[c.id]=c;b.attached&&a.emit(c.attached?"deviceAttached":"deviceRemoved",c);b.streaming&&(c.streaming?(a.streamingCount++,a.emit("deviceStreaming",c),1==a.streamingCount&&a.emit("streamingStarted",c),b.attached||
a.emit("deviceConnected")):b.attached&&c.attached||(a.streamingCount--,a.emit("deviceStopped",c),0==a.streamingCount&&a.emit("streamingStopped",c),a.emit("deviceDisconnected")))});this.on("newListener",function(a,d){"deviceConnected"!=a&&"deviceDisconnected"!=a||console.warn(a+" events are depricated.  Consider using 'streamingStarted/streamingStopped' or 'deviceStreaming/deviceStopped' instead")})};t.prototype.checkOutOfDate=function(){console.assert(this.connection&&this.connection.protocol);var a=
this.connection.protocol.serviceVersion,b=this.connection.protocol.version,e=this.connectionType.defaultProtocolVersion;return e>b?(console.warn("Your Protocol Version is v"+b+", this app was designed for v"+e),p.warnOutOfDate({sV:a,pV:b}),!0):!1};t._pluginFactories={};t.plugin=function(a,b){this._pluginFactories[a]&&console.warn('Plugin "'+a+'" already registered');return this._pluginFactories[a]=b};t.plugins=function(){return q.keys(this._pluginFactories)};t.prototype.use=function(a,b){var f;var c=
"function"==typeof a?a:t._pluginFactories[a];if(!c)throw"Leap Plugin "+a+" not found.";b||(b={});if(this.plugins[a])return q.extend(this.plugins[a],b),this;this.plugins[a]=b;b=c.call(this,b);for(f in b)if(c=b[f],"function"===typeof c){var d=a,g=f;if(-1!==["beforeFrameCreated","afterFrameCreated"].indexOf(g))this.on(g,c);else this.pipeline||(this.pipeline=new A(this)),this._pluginPipelineSteps[d]||(this._pluginPipelineSteps[d]=[]),this._pluginPipelineSteps[d].push(this.pipeline.addWrappedStep(g,c))}else{d=
a;g=f;this._pluginExtendedMethods[d]||(this._pluginExtendedMethods[d]=[]);switch(g){case "frame":g=e;break;case "hand":g=h;break;case "pointable":g=n;q.extend(B.prototype,c);q.extend(B.Invalid,c);break;case "finger":g=B;break;default:throw d+' specifies invalid object type "'+g+'" for prototypical extension';}q.extend(g.prototype,c);q.extend(g.Invalid,c);this._pluginExtendedMethods[d].push([g,c])}return this};t.prototype.stopUsing=function(a){var b=this._pluginPipelineSteps[a],e=this._pluginExtendedMethods[a],
c;if(this.plugins[a]){if(b)for(c=0;c<b.length;c++)this.pipeline.removeStep(b[c]);if(e)for(c=0;c<e.length;c++){b=e[c][0];var d=e[c][1];for(var g in d)delete b.prototype[g],delete b.Invalid[g]}delete this.plugins[a];return this}};t.prototype.useRegisteredPlugins=function(){for(var a in t._pluginFactories)this.use(a)};q.extend(t.prototype,k.prototype)},{"./circular_buffer":2,"./connection/browser":4,"./connection/node":20,"./dialog":6,"./finger":7,"./frame":8,"./gesture":9,"./hand":10,"./pipeline":13,
"./pointable":14,__browserify_process:22,events:21,underscore:24}],6:[function(a,b,k){var l=a("__browserify_process"),e=b.exports=function(a,b){this.options=b||{};this.message=a;this.createElement()};e.prototype.createElement=function(){this.element=document.createElement("div");this.element.className="leapjs-dialog";this.element.style.position="fixed";this.element.style.top="8px";this.element.style.left=0;this.element.style.right=0;this.element.style.textAlign="center";this.element.style.zIndex=
1E3;var a=document.createElement("div");this.element.appendChild(a);a.style.className="leapjs-dialog";a.style.display="inline-block";a.style.margin="auto";a.style.padding="8px";a.style.color="#222";a.style.background="#eee";a.style.borderRadius="4px";a.style.border="1px solid #999";a.style.textAlign="left";a.style.cursor="pointer";a.style.whiteSpace="nowrap";a.style.transition="box-shadow 1s linear";a.innerHTML=this.message;this.options.onclick&&a.addEventListener("click",this.options.onclick);this.options.onmouseover&&
a.addEventListener("mouseover",this.options.onmouseover);this.options.onmouseout&&a.addEventListener("mouseout",this.options.onmouseout);this.options.onmousemove&&a.addEventListener("mousemove",this.options.onmousemove)};e.prototype.show=function(){document.body.appendChild(this.element);return this};e.prototype.hide=function(){document.body.removeChild(this.element);return this};e.warnOutOfDate=function(a){a||(a={});var b="http://developer.leapmotion.com?";a.returnTo=window.location.href;for(var h in a)b+=
h+"="+encodeURIComponent(a[h])+"&";var l=new e("This site requires Leap Motion Tracking V2.<button id='leapjs-accept-upgrade'  style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 16px;'>Upgrade</button><button id='leapjs-decline-upgrade' style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 8px; '>Not Now</button>",{onclick:function(a){"leapjs-decline-upgrade"!=a.target.id&&(a=window.open(b,
"_blank","height=800,width=1000,location=1,menubar=1,resizable=1,status=1,toolbar=1,scrollbars=1"),window.focus&&a.focus());l.hide();return!0},onmousemove:function(a){a.target==document.getElementById("leapjs-decline-upgrade")?(document.getElementById("leapjs-decline-upgrade").style.color="#000",document.getElementById("leapjs-decline-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow=
"none"):(document.getElementById("leapjs-accept-upgrade").style.color="#000",document.getElementById("leapjs-accept-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none")},onmouseout:function(){document.getElementById("leapjs-decline-upgrade").style.color="#444";document.getElementById("leapjs-decline-upgrade").style.boxShadow="none";document.getElementById("leapjs-accept-upgrade").style.color=
"#444";document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"}});return l.show()};e.hasWarnedBones=!1;e.warnBones=function(){this.hasWarnedBones||(this.hasWarnedBones=!0,console.warn("Your Leap Service is out of date"),"undefined"!==typeof l&&l.versions&&l.versions.node||this.warnOutOfDate({reason:"bones"}))}},{__browserify_process:22}],7:[function(a,b,k){var l=a("./pointable"),e=a("./bone"),h=a("./dialog");a=a("underscore");b=b.exports=function(a){l.call(this,a);this.dipPosition=
a.dipPosition;this.pipPosition=a.pipPosition;this.mcpPosition=a.mcpPosition;this.carpPosition=a.carpPosition;this.extended=a.extended;this.type=a.type;this.finger=!0;this.positions=[this.carpPosition,this.mcpPosition,this.pipPosition,this.dipPosition,this.tipPosition];a.bases?this.addBones(a):h.warnBones()};a.extend(b.prototype,l.prototype);b.prototype.addBones=function(a){this.metacarpal=new e(this,{type:0,width:this.width,prevJoint:this.carpPosition,nextJoint:this.mcpPosition,basis:a.bases[0]});
this.proximal=new e(this,{type:1,width:this.width,prevJoint:this.mcpPosition,nextJoint:this.pipPosition,basis:a.bases[1]});this.medial=new e(this,{type:2,width:this.width,prevJoint:this.pipPosition,nextJoint:this.dipPosition,basis:a.bases[2]});this.distal=new e(this,{type:3,width:this.width,prevJoint:this.dipPosition,nextJoint:a.btipPosition,basis:a.bases[3]});this.bones=[this.metacarpal,this.proximal,this.medial,this.distal]};b.prototype.toString=function(){return"Finger [ id:"+this.id+" "+this.length+
"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"};b.Invalid={valid:!1}},{"./bone":1,"./dialog":6,"./pointable":14,underscore:24}],8:[function(a,b,k){var l=a("./hand"),e=a("./pointable"),h=a("./gesture").createGesture;k=a("gl-matrix");var n=k.mat3,B=k.vec3,v=a("./interaction_box"),A=a("./finger"),w=a("underscore");a=b.exports=function(a){this.valid=!0;this.id=a.id;this.timestamp=a.timestamp;this.hands=[];this.handsMap={};this.pointables=[];this.tools=[];this.fingers=[];a.interactionBox&&
(this.interactionBox=new v(a.interactionBox));this.gestures=[];this.pointablesMap={};this._translation=a.t;this._rotation=w.flatten(a.r);this._scaleFactor=a.s;this.data=a;this.type="frame";this.currentFrameRate=a.currentFrameRate;if(a.gestures)for(var b=0,e=a.gestures.length;b!=e;b++)this.gestures.push(h(a.gestures[b]));this.postprocessData(a)};a.prototype.postprocessData=function(a){a||(a=this.data);for(var b=0,h=a.hands.length;b!=h;b++){var k=new l(a.hands[b]);k.frame=this;this.hands.push(k);this.handsMap[k.id]=
k}a.pointables=w.sortBy(a.pointables,function(a){return a.id});b=0;for(h=a.pointables.length;b!=h;b++)k=a.pointables[b],k=k.dipPosition?new A(k):new e(k),k.frame=this,this.addPointable(k)};a.prototype.addPointable=function(a){this.pointables.push(a);this.pointablesMap[a.id]=a;(a.tool?this.tools:this.fingers).push(a);if(void 0!==a.handId&&this.handsMap.hasOwnProperty(a.handId)){var b=this.handsMap[a.handId];b.pointables.push(a);(a.tool?b.tools:b.fingers).push(a);switch(a.type){case 0:b.thumb=a;break;
case 1:b.indexFinger=a;break;case 2:b.middleFinger=a;break;case 3:b.ringFinger=a;break;case 4:b.pinky=a}}};a.prototype.tool=function(a){a=this.pointable(a);return a.tool?a:e.Invalid};a.prototype.pointable=function(a){return this.pointablesMap[a]||e.Invalid};a.prototype.finger=function(a){a=this.pointable(a);return a.tool?e.Invalid:a};a.prototype.hand=function(a){return this.handsMap[a]||l.Invalid};a.prototype.rotationAngle=function(a,b){if(!this.valid||!a.valid)return 0;var e=this.rotationMatrix(a);
e=Math.acos(.5*(e[0]+e[4]+e[8]-1));e=isNaN(e)?0:e;void 0!==b&&(a=this.rotationAxis(a),e*=B.dot(a,B.normalize(B.create(),b)));return e};a.prototype.rotationAxis=function(a){return this.valid&&a.valid?B.normalize(B.create(),[this._rotation[7]-a._rotation[5],this._rotation[2]-a._rotation[6],this._rotation[3]-a._rotation[1]]):B.create()};a.prototype.rotationMatrix=function(a){if(!this.valid||!a.valid)return n.create();var b=n.transpose(n.create(),this._rotation);return n.multiply(n.create(),a._rotation,
b)};a.prototype.scaleFactor=function(a){return this.valid&&a.valid?Math.exp(this._scaleFactor-a._scaleFactor):1};a.prototype.translation=function(a){return this.valid&&a.valid?B.subtract(B.create(),this._translation,a._translation):B.create()};a.prototype.toString=function(){var a="Frame [ id:"+this.id+" | timestamp:"+this.timestamp+" | Hand count:("+this.hands.length+") | Pointable count:("+this.pointables.length+")";this.gestures&&(a+=" | Gesture count:("+this.gestures.length+")");return a+" ]"};
a.prototype.dump=function(){var a="Frame Info:<br/>"+this.toString();a+="<br/><br/>Hands:<br/>";for(var b=0,e=this.hands.length;b!=e;b++)a+="  "+this.hands[b].toString()+"<br/>";a+="<br/><br/>Pointables:<br/>";b=0;for(e=this.pointables.length;b!=e;b++)a+="  "+this.pointables[b].toString()+"<br/>";if(this.gestures)for(a+="<br/><br/>Gestures:<br/>",b=0,e=this.gestures.length;b!=e;b++)a+="  "+this.gestures[b].toString()+"<br/>";return a=a+"<br/><br/>Raw JSON:<br/>"+JSON.stringify(this.data)};a.Invalid=
{valid:!1,hands:[],fingers:[],tools:[],gestures:[],pointables:[],pointable:function(){return e.Invalid},finger:function(){return e.Invalid},hand:function(){return l.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return n.create()},rotationAxis:function(){return B.create()},scaleFactor:function(){return 1},translation:function(){return B.create()}}},{"./finger":7,"./gesture":9,"./hand":10,"./interaction_box":12,
"./pointable":14,"gl-matrix":23,underscore:24}],9:[function(a,b,k){var l=a("gl-matrix").vec3;b=a("events").EventEmitter;var e=a("underscore");k.createGesture=function(a){switch(a.type){case "circle":var b=new n(a);break;case "swipe":b=new B(a);break;case "screenTap":b=new v(a);break;case "keyTap":b=new A(a);break;default:throw"unknown gesture type";}b.id=a.id;b.handIds=a.handIds.slice();b.pointableIds=a.pointableIds.slice();b.duration=a.duration;b.state=a.state;b.type=a.type;return b};k.gestureListener=
function(a,b){var l={},k={};a.on("gesture",function(a,f){if(a.type==b){if(("start"==a.state||"stop"==a.state)&&void 0===k[a.id]){var c=new h(a,f);k[a.id]=c;e.each(l,function(a,b){c.on(b,a)})}k[a.id].update(a,f);"stop"==a.state&&delete k[a.id]}});var n={start:function(a){l.start=a;return n},stop:function(a){l.stop=a;return n},complete:function(a){l.stop=a;return n},update:function(a){l.update=a;return n}};return n};var h=k.Gesture=function(a,b){this.gestures=[a];this.frames=[b]};h.prototype.update=
function(a,b){this.lastGesture=a;this.lastFrame=b;this.gestures.push(a);this.frames.push(b);this.emit(a.state,this)};h.prototype.translation=function(){return l.subtract(l.create(),this.lastGesture.startPosition,this.lastGesture.position)};e.extend(h.prototype,b.prototype);var n=function(a){this.center=a.center;this.normal=a.normal;this.progress=a.progress;this.radius=a.radius};n.prototype.toString=function(){return"CircleGesture ["+JSON.stringify(this)+"]"};var B=function(a){this.startPosition=a.startPosition;
this.position=a.position;this.direction=a.direction;this.speed=a.speed};B.prototype.toString=function(){return"SwipeGesture ["+JSON.stringify(this)+"]"};var v=function(a){this.position=a.position;this.direction=a.direction;this.progress=a.progress};v.prototype.toString=function(){return"ScreenTapGesture ["+JSON.stringify(this)+"]"};var A=function(a){this.position=a.position;this.direction=a.direction;this.progress=a.progress};A.prototype.toString=function(){return"KeyTapGesture ["+JSON.stringify(this)+
"]"}},{events:21,"gl-matrix":23,underscore:24}],10:[function(a,b,k){var l=a("./pointable"),e=a("./bone");k=a("gl-matrix");var h=k.mat3,n=k.vec3,B=a("underscore");a=b.exports=function(a){this.id=a.id;this.palmPosition=a.palmPosition;this.direction=a.direction;this.palmVelocity=a.palmVelocity;this.palmNormal=a.palmNormal;this.sphereCenter=a.sphereCenter;this.sphereRadius=a.sphereRadius;this.valid=!0;this.pointables=[];this.fingers=[];this.arm=a.armBasis?new e(this,{type:4,width:a.armWidth,prevJoint:a.elbow,
nextJoint:a.wrist,basis:a.armBasis}):null;this.tools=[];this._translation=a.t;this._rotation=B.flatten(a.r);this._scaleFactor=a.s;this.timeVisible=a.timeVisible;this.stabilizedPalmPosition=a.stabilizedPalmPosition;this.type=a.type;this.grabStrength=a.grabStrength;this.pinchStrength=a.pinchStrength;this.confidence=a.confidence};a.prototype.finger=function(a){return(a=this.frame.finger(a))&&a.handId==this.id?a:l.Invalid};a.prototype.rotationAngle=function(a,b){if(!this.valid||!a.valid||!a.hand(this.id).valid)return 0;
var e=this.rotationMatrix(a);e=Math.acos(.5*(e[0]+e[4]+e[8]-1));e=isNaN(e)?0:e;void 0!==b&&(a=this.rotationAxis(a),e*=n.dot(a,n.normalize(n.create(),b)));return e};a.prototype.rotationAxis=function(a){if(!this.valid||!a.valid)return n.create();a=a.hand(this.id);return a.valid?n.normalize(n.create(),[this._rotation[7]-a._rotation[5],this._rotation[2]-a._rotation[6],this._rotation[3]-a._rotation[1]]):n.create()};a.prototype.rotationMatrix=function(a){if(!this.valid||!a.valid)return h.create();a=a.hand(this.id);
if(!a.valid)return h.create();var b=h.transpose(h.create(),this._rotation);return h.multiply(h.create(),a._rotation,b)};a.prototype.scaleFactor=function(a){if(!this.valid||!a.valid)return 1;a=a.hand(this.id);return a.valid?Math.exp(this._scaleFactor-a._scaleFactor):1};a.prototype.translation=function(a){if(!this.valid||!a.valid)return n.create();a=a.hand(this.id);return a.valid?[this._translation[0]-a._translation[0],this._translation[1]-a._translation[1],this._translation[2]-a._translation[2]]:n.create()};
a.prototype.toString=function(){return"Hand ("+this.type+") [ id: "+this.id+" | palm velocity:"+this.palmVelocity+" | sphere center:"+this.sphereCenter+" ] "};a.prototype.pitch=function(){return Math.atan2(this.direction[1],-this.direction[2])};a.prototype.yaw=function(){return Math.atan2(this.direction[0],-this.direction[2])};a.prototype.roll=function(){return Math.atan2(this.palmNormal[0],-this.palmNormal[1])};a.Invalid={valid:!1,fingers:[],tools:[],pointables:[],left:!1,pointable:function(){return l.Invalid},
finger:function(){return l.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return h.create()},rotationAxis:function(){return n.create()},scaleFactor:function(){return 1},translation:function(){return n.create()}}},{"./bone":1,"./pointable":14,"gl-matrix":23,underscore:24}],11:[function(a,b,k){b.exports={Controller:a("./controller"),Frame:a("./frame"),Gesture:a("./gesture"),Hand:a("./hand"),Pointable:a("./pointable"),
Finger:a("./finger"),InteractionBox:a("./interaction_box"),CircularBuffer:a("./circular_buffer"),UI:a("./ui"),JSONProtocol:a("./protocol").JSONProtocol,glMatrix:a("gl-matrix"),mat3:a("gl-matrix").mat3,vec3:a("gl-matrix").vec3,loopController:void 0,version:a("./version.js"),_:a("underscore"),EventEmitter:a("events").EventEmitter,loop:function(a,b){a&&void 0===b&&"[object Function]"==={}.toString.call(a)&&(b=a,a={});this.loopController?a&&this.loopController.setupFrameEvents(a):this.loopController=
new this.Controller(a);this.loopController.loop(b);return this.loopController},plugin:function(a,b){this.Controller.plugin(a,b)}}},{"./circular_buffer":2,"./controller":5,"./finger":7,"./frame":8,"./gesture":9,"./hand":10,"./interaction_box":12,"./pointable":14,"./protocol":15,"./ui":16,"./version.js":19,events:21,"gl-matrix":23,underscore:24}],12:[function(a,b,k){var l=a("gl-matrix").vec3;a=b.exports=function(a){this.valid=!0;this.center=a.center;this.size=a.size;this.width=a.size[0];this.height=
a.size[1];this.depth=a.size[2]};a.prototype.denormalizePoint=function(a){return l.fromValues((a[0]-.5)*this.size[0]+this.center[0],(a[1]-.5)*this.size[1]+this.center[1],(a[2]-.5)*this.size[2]+this.center[2])};a.prototype.normalizePoint=function(a,b){a=l.fromValues((a[0]-this.center[0])/this.size[0]+.5,(a[1]-this.center[1])/this.size[1]+.5,(a[2]-this.center[2])/this.size[2]+.5);b&&(a[0]=Math.min(Math.max(a[0],0),1),a[1]=Math.min(Math.max(a[1],0),1),a[2]=Math.min(Math.max(a[2],0),1));return a};a.prototype.toString=
function(){return"InteractionBox [ width:"+this.width+" | height:"+this.height+" | depth:"+this.depth+" ]"};a.Invalid={valid:!1}},{"gl-matrix":23}],13:[function(a,b,k){a=b.exports=function(a){this.steps=[];this.controller=a};a.prototype.addStep=function(a){this.steps.push(a)};a.prototype.run=function(a){for(var b=this.steps.length,h=0;h!=b&&a;h++)a=this.steps[h](a);return a};a.prototype.removeStep=function(a){a=this.steps.indexOf(a);if(-1===a)throw"Step not found in pipeline";this.steps.splice(a,
1)};a.prototype.addWrappedStep=function(a,b){var e=this.controller,k=function(h){var k;var l="frame"==a?[h]:h[a+"s"]||[];var n=0;for(k=l.length;n<k;n++)b.call(e,l[n]);return h};this.addStep(k);return k}},{}],14:[function(a,b,k){a("gl-matrix");a=b.exports=function(a){this.valid=!0;this.id=a.id;this.handId=a.handId;this.length=a.length;this.tool=a.tool;this.width=a.width;this.direction=a.direction;this.stabilizedTipPosition=a.stabilizedTipPosition;this.tipPosition=a.tipPosition;this.tipVelocity=a.tipVelocity;
this.touchZone=a.touchZone;this.touchDistance=a.touchDistance;this.timeVisible=a.timeVisible};a.prototype.toString=function(){return"Pointable [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"};a.prototype.hand=function(){return this.frame.hand(this.handId)};a.Invalid={valid:!1}},{"gl-matrix":23}],15:[function(a,b,k){var l=a("./frame");a("./hand");a("./pointable");a("./finger");var e=a("underscore"),h=a("events").EventEmitter,n=function(a){this.type=a.type;
this.state=a.state};k.chooseProtocol=function(a){switch(a.version){case 1:case 2:case 3:case 4:case 5:case 6:var b=B(a);b.sendBackground=function(a,e){a.send(b.encode({background:e}))};b.sendFocused=function(a,e){a.send(b.encode({focused:e}))};b.sendOptimizeHMD=function(a,e){a.send(b.encode({optimizeHMD:e}))};break;default:throw"unrecognized version";}return b};var B=k.JSONProtocol=function(a){var b=function(a){if(a.event)return new n(a.event);b.emit("beforeFrameCreated",a);var e=new l(a);b.emit("afterFrameCreated",
e,a);return e};b.encode=function(a){return JSON.stringify(a)};b.version=a.version;b.serviceVersion=a.serviceVersion;b.versionLong="Version "+a.version;b.type="protocol";e.extend(b,h.prototype);return b}},{"./finger":7,"./frame":8,"./hand":10,"./pointable":14,events:21,underscore:24}],16:[function(a,b,k){k.UI={Region:a("./ui/region"),Cursor:a("./ui/cursor")}},{"./ui/cursor":17,"./ui/region":18}],17:[function(a,b,k){b.exports=function(){return function(a){var b=a.pointables.sort(function(a,b){return a.z-
b.z})[0];b&&b.valid&&(a.cursorPosition=b.tipPosition);return a}}},{}],18:[function(a,b,k){k=a("events").EventEmitter;a=a("underscore");var l=b.exports=function(a,b){this.start=new Vector(a);this.end=new Vector(b);this.enteredFrame=null};l.prototype.hasPointables=function(a){for(var b=0;b!=a.pointables.length;b++){var e=a.pointables[b].tipPosition;if(e.x>=this.start.x&&e.x<=this.end.x&&e.y>=this.start.y&&e.y<=this.end.y&&e.z>=this.start.z&&e.z<=this.end.z)return!0}return!1};l.prototype.listener=function(a){var b=
this;a&&a.nearThreshold&&this.setupNearRegion(a.nearThreshold);return function(a){return b.updatePosition(a)}};l.prototype.clipper=function(){var a=this;return function(b){a.updatePosition(b);return a.enteredFrame?b:null}};l.prototype.setupNearRegion=function(a){a=this.nearRegion=new l([this.start.x-a,this.start.y-a,this.start.z-a],[this.end.x+a,this.end.y+a,this.end.z+a]);var b=this;a.on("enter",function(a){b.emit("near",a)});a.on("exit",function(a){b.emit("far",a)});b.on("exit",function(a){b.emit("near",
a)})};l.prototype.updatePosition=function(a){this.nearRegion&&this.nearRegion.updatePosition(a);this.hasPointables(a)&&null==this.enteredFrame?(this.enteredFrame=a,this.emit("enter",this.enteredFrame)):this.hasPointables(a)||null==this.enteredFrame||(this.enteredFrame=null,this.emit("exit",this.enteredFrame));return a};l.prototype.normalize=function(a){return new Vector([(a.x-this.start.x)/(this.end.x-this.start.x),(a.y-this.start.y)/(this.end.y-this.start.y),(a.z-this.start.z)/(this.end.z-this.start.z)])};
l.prototype.mapToXY=function(a,b,k){a=this.normalize(a);var e=a.x,h=a.y;1<e?e=1:-1>e&&(e=-1);1<h?h=1:-1>h&&(h=-1);return[(e+1)/2*b,(1-h)/2*k,a.z]};a.extend(l.prototype,k.prototype)},{events:21,underscore:24}],19:[function(a,b,k){b.exports={full:"0.6.4",major:0,minor:6,dot:4}},{}],20:[function(a,b,k){},{}],21:[function(a,b,k){a=a("__browserify_process");a.EventEmitter||(a.EventEmitter=function(){});k=k.EventEmitter=a.EventEmitter;var l="function"===typeof Array.isArray?Array.isArray:function(a){return"[object Array]"===
Object.prototype.toString.call(a)};k.prototype.setMaxListeners=function(a){this._events||(this._events={});this._events.maxListeners=a};k.prototype.emit=function(a){if("error"===a&&(!this._events||!this._events.error||l(this._events.error)&&!this._events.error.length)){if(arguments[1]instanceof Error)throw arguments[1];throw Error("Uncaught, unspecified 'error' event.");}if(!this._events)return!1;var b=this._events[a];if(!b)return!1;if("function"==typeof b){switch(arguments.length){case 1:b.call(this);
break;case 2:b.call(this,arguments[1]);break;case 3:b.call(this,arguments[1],arguments[2]);break;default:var e=Array.prototype.slice.call(arguments,1);b.apply(this,e)}return!0}if(l(b)){e=Array.prototype.slice.call(arguments,1);b=b.slice();for(var k=0,v=b.length;k<v;k++)b[k].apply(this,e);return!0}return!1};k.prototype.addListener=function(a,b){if("function"!==typeof b)throw Error("addListener only takes instances of Function");this._events||(this._events={});this.emit("newListener",a,b);if(this._events[a])if(l(this._events[a])){if(!this._events[a].warned){var e;
(e=void 0!==this._events.maxListeners?this._events.maxListeners:10)&&0<e&&this._events[a].length>e&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),console.trace())}this._events[a].push(b)}else this._events[a]=[this._events[a],b];else this._events[a]=b;return this};k.prototype.on=k.prototype.addListener;k.prototype.once=function(a,b){var e=this;e.on(a,
function v(){e.removeListener(a,v);b.apply(this,arguments)});return this};k.prototype.removeListener=function(a,b){if("function"!==typeof b)throw Error("removeListener only takes instances of Function");if(!this._events||!this._events[a])return this;var e=this._events[a];if(l(e)){a:if(e.indexOf)b=e.indexOf(b);else{for(var h=0;h<e.length;h++)if(b===e[h]){b=h;break a}b=-1}if(0>b)return this;e.splice(b,1);0==e.length&&delete this._events[a]}else this._events[a]===b&&delete this._events[a];return this};
k.prototype.removeAllListeners=function(a){if(0===arguments.length)return this._events={},this;a&&this._events&&this._events[a]&&(this._events[a]=null);return this};k.prototype.listeners=function(a){this._events||(this._events={});this._events[a]||(this._events[a]=[]);l(this._events[a])||(this._events[a]=[this._events[a]]);return this._events[a]};k.listenerCount=function(a,b){return a._events&&a._events[b]?"function"===typeof a._events[b]?1:a._events[b].length:0}},{__browserify_process:22}],22:[function(a,
b,k){a=b.exports={};a.nextTick=function(){if("undefined"!==typeof window&&window.setImmediate)return function(a){return window.setImmediate(a)};if("undefined"!==typeof window&&window.postMessage&&window.addEventListener){var a=[];window.addEventListener("message",function(b){var e=b.source;e!==window&&null!==e||"process-tick"!==b.data||(b.stopPropagation(),0<a.length&&a.shift()())},!0);return function(b){a.push(b);window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}();a.title=
"browser";a.browser=!0;a.env={};a.argv=[];a.binding=function(a){throw Error("process.binding is not supported");};a.cwd=function(){return"/"};a.chdir=function(a){throw Error("process.chdir is not supported");}},{}],23:[function(a,b,k){(function(a){if("undefined"===typeof k)if("function"==typeof define&&"object"==typeof define.amd&&define.amd){var b={};define(function(){return b})}else b="undefined"!==typeof window?window:a;else b=k;(function(a){if(!b)var b=1E-6;if(!e)var e="undefined"!==typeof Float32Array?
Float32Array:Array;if(!h)var h=Math.random;var k={setMatrixArrayType:function(a){e=a}};"undefined"!==typeof a&&(a.glMatrix=k);var l=Math.PI/180;k.toRadian=function(a){return a*l};var p={create:function(){var a=new e(2);a[0]=0;a[1]=0;return a},clone:function(a){var c=new e(2);c[0]=a[0];c[1]=a[1];return c},fromValues:function(a,d){var c=new e(2);c[0]=a;c[1]=d;return c},copy:function(a,d){a[0]=d[0];a[1]=d[1];return a},set:function(a,d,b){a[0]=d;a[1]=b;return a},add:function(a,d,b){a[0]=d[0]+b[0];a[1]=
d[1]+b[1];return a},subtract:function(a,d,b){a[0]=d[0]-b[0];a[1]=d[1]-b[1];return a}};p.sub=p.subtract;p.multiply=function(a,d,b){a[0]=d[0]*b[0];a[1]=d[1]*b[1];return a};p.mul=p.multiply;p.divide=function(a,d,b){a[0]=d[0]/b[0];a[1]=d[1]/b[1];return a};p.div=p.divide;p.min=function(a,d,b){a[0]=Math.min(d[0],b[0]);a[1]=Math.min(d[1],b[1]);return a};p.max=function(a,d,b){a[0]=Math.max(d[0],b[0]);a[1]=Math.max(d[1],b[1]);return a};p.scale=function(a,d,b){a[0]=d[0]*b;a[1]=d[1]*b;return a};p.scaleAndAdd=
function(a,d,b,e){a[0]=d[0]+b[0]*e;a[1]=d[1]+b[1]*e;return a};p.distance=function(a,d){var c=d[0]-a[0];a=d[1]-a[1];return Math.sqrt(c*c+a*a)};p.dist=p.distance;p.squaredDistance=function(a,d){var c=d[0]-a[0];a=d[1]-a[1];return c*c+a*a};p.sqrDist=p.squaredDistance;p.length=function(a){var c=a[0];a=a[1];return Math.sqrt(c*c+a*a)};p.len=p.length;p.squaredLength=function(a){var c=a[0];a=a[1];return c*c+a*a};p.sqrLen=p.squaredLength;p.negate=function(a,d){a[0]=-d[0];a[1]=-d[1];return a};p.normalize=function(a,
d){var c=d[0],b=d[1];c=c*c+b*b;0<c&&(c=1/Math.sqrt(c),a[0]=d[0]*c,a[1]=d[1]*c);return a};p.dot=function(a,d){return a[0]*d[0]+a[1]*d[1]};p.cross=function(a,d,b){d=d[0]*b[1]-d[1]*b[0];a[0]=a[1]=0;a[2]=d;return a};p.lerp=function(a,d,b,e){var c=d[0];d=d[1];a[0]=c+e*(b[0]-c);a[1]=d+e*(b[1]-d);return a};p.random=function(a,d){d=d||1;var c=2*h()*Math.PI;a[0]=Math.cos(c)*d;a[1]=Math.sin(c)*d;return a};p.transformMat2=function(a,d,b){var c=d[0];d=d[1];a[0]=b[0]*c+b[2]*d;a[1]=b[1]*c+b[3]*d;return a};p.transformMat2d=
function(a,d,b){var c=d[0];d=d[1];a[0]=b[0]*c+b[2]*d+b[4];a[1]=b[1]*c+b[3]*d+b[5];return a};p.transformMat3=function(a,d,b){var c=d[0];d=d[1];a[0]=b[0]*c+b[3]*d+b[6];a[1]=b[1]*c+b[4]*d+b[7];return a};p.transformMat4=function(a,d,b){var c=d[0];d=d[1];a[0]=b[0]*c+b[4]*d+b[12];a[1]=b[1]*c+b[5]*d+b[13];return a};p.forEach=function(){var a=p.create();return function(c,b,e,f,h,k){b||(b=2);e||(e=0);for(f=f?Math.min(f*b+e,c.length):c.length;e<f;e+=b)a[0]=c[e],a[1]=c[e+1],h(a,a,k),c[e]=a[0],c[e+1]=a[1];return c}}();
p.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};"undefined"!==typeof a&&(a.vec2=p);var q={create:function(){var a=new e(3);a[0]=0;a[1]=0;a[2]=0;return a},clone:function(a){var c=new e(3);c[0]=a[0];c[1]=a[1];c[2]=a[2];return c},fromValues:function(a,d,b){var c=new e(3);c[0]=a;c[1]=d;c[2]=b;return c},copy:function(a,d){a[0]=d[0];a[1]=d[1];a[2]=d[2];return a},set:function(a,d,b,e){a[0]=d;a[1]=b;a[2]=e;return a},add:function(a,d,b){a[0]=d[0]+b[0];a[1]=d[1]+b[1];a[2]=d[2]+b[2];return a},subtract:function(a,
d,b){a[0]=d[0]-b[0];a[1]=d[1]-b[1];a[2]=d[2]-b[2];return a}};q.sub=q.subtract;q.multiply=function(a,d,b){a[0]=d[0]*b[0];a[1]=d[1]*b[1];a[2]=d[2]*b[2];return a};q.mul=q.multiply;q.divide=function(a,d,b){a[0]=d[0]/b[0];a[1]=d[1]/b[1];a[2]=d[2]/b[2];return a};q.div=q.divide;q.min=function(a,d,b){a[0]=Math.min(d[0],b[0]);a[1]=Math.min(d[1],b[1]);a[2]=Math.min(d[2],b[2]);return a};q.max=function(a,d,b){a[0]=Math.max(d[0],b[0]);a[1]=Math.max(d[1],b[1]);a[2]=Math.max(d[2],b[2]);return a};q.scale=function(a,
d,b){a[0]=d[0]*b;a[1]=d[1]*b;a[2]=d[2]*b;return a};q.scaleAndAdd=function(a,d,b,e){a[0]=d[0]+b[0]*e;a[1]=d[1]+b[1]*e;a[2]=d[2]+b[2]*e;return a};q.distance=function(a,d){var c=d[0]-a[0],b=d[1]-a[1];a=d[2]-a[2];return Math.sqrt(c*c+b*b+a*a)};q.dist=q.distance;q.squaredDistance=function(a,d){var c=d[0]-a[0],b=d[1]-a[1];a=d[2]-a[2];return c*c+b*b+a*a};q.sqrDist=q.squaredDistance;q.length=function(a){var c=a[0],b=a[1];a=a[2];return Math.sqrt(c*c+b*b+a*a)};q.len=q.length;q.squaredLength=function(a){var c=
a[0],b=a[1];a=a[2];return c*c+b*b+a*a};q.sqrLen=q.squaredLength;q.negate=function(a,d){a[0]=-d[0];a[1]=-d[1];a[2]=-d[2];return a};q.normalize=function(a,d){var c=d[0],b=d[1],e=d[2];c=c*c+b*b+e*e;0<c&&(c=1/Math.sqrt(c),a[0]=d[0]*c,a[1]=d[1]*c,a[2]=d[2]*c);return a};q.dot=function(a,d){return a[0]*d[0]+a[1]*d[1]+a[2]*d[2]};q.cross=function(a,d,b){var c=d[0],g=d[1];d=d[2];var e=b[0],f=b[1];b=b[2];a[0]=g*b-d*f;a[1]=d*e-c*b;a[2]=c*f-g*e;return a};q.lerp=function(a,d,b,e){var c=d[0],g=d[1];d=d[2];a[0]=
c+e*(b[0]-c);a[1]=g+e*(b[1]-g);a[2]=d+e*(b[2]-d);return a};q.random=function(a,d){d=d||1;var c=2*h()*Math.PI,b=2*h()-1,e=Math.sqrt(1-b*b)*d;a[0]=Math.cos(c)*e;a[1]=Math.sin(c)*e;a[2]=b*d;return a};q.transformMat4=function(a,d,b){var c=d[0],g=d[1];d=d[2];a[0]=b[0]*c+b[4]*g+b[8]*d+b[12];a[1]=b[1]*c+b[5]*g+b[9]*d+b[13];a[2]=b[2]*c+b[6]*g+b[10]*d+b[14];return a};q.transformMat3=function(a,d,b){var c=d[0],g=d[1];d=d[2];a[0]=c*b[0]+g*b[3]+d*b[6];a[1]=c*b[1]+g*b[4]+d*b[7];a[2]=c*b[2]+g*b[5]+d*b[8];return a};
q.transformQuat=function(a,d,b){var c=d[0],g=d[1],e=d[2];d=b[0];var f=b[1],m=b[2];b=b[3];var h=b*c+f*e-m*g,k=b*g+m*c-d*e,l=b*e+d*g-f*c;c=-d*c-f*g-m*e;a[0]=h*b+c*-d+k*-m-l*-f;a[1]=k*b+c*-f+l*-d-h*-m;a[2]=l*b+c*-m+h*-f-k*-d;return a};q.rotateX=function(a,d,b,e){var c=[],g=[];c[0]=d[0]-b[0];c[1]=d[1]-b[1];c[2]=d[2]-b[2];g[0]=c[0];g[1]=c[1]*Math.cos(e)-c[2]*Math.sin(e);g[2]=c[1]*Math.sin(e)+c[2]*Math.cos(e);a[0]=g[0]+b[0];a[1]=g[1]+b[1];a[2]=g[2]+b[2];return a};q.rotateY=function(a,d,b,e){var c=[],g=
[];c[0]=d[0]-b[0];c[1]=d[1]-b[1];c[2]=d[2]-b[2];g[0]=c[2]*Math.sin(e)+c[0]*Math.cos(e);g[1]=c[1];g[2]=c[2]*Math.cos(e)-c[0]*Math.sin(e);a[0]=g[0]+b[0];a[1]=g[1]+b[1];a[2]=g[2]+b[2];return a};q.rotateZ=function(a,d,b,e){var c=[],g=[];c[0]=d[0]-b[0];c[1]=d[1]-b[1];c[2]=d[2]-b[2];g[0]=c[0]*Math.cos(e)-c[1]*Math.sin(e);g[1]=c[0]*Math.sin(e)+c[1]*Math.cos(e);g[2]=c[2];a[0]=g[0]+b[0];a[1]=g[1]+b[1];a[2]=g[2]+b[2];return a};q.forEach=function(){var a=q.create();return function(c,b,e,f,h,k){b||(b=3);e||(e=
0);for(f=f?Math.min(f*b+e,c.length):c.length;e<f;e+=b)a[0]=c[e],a[1]=c[e+1],a[2]=c[e+2],h(a,a,k),c[e]=a[0],c[e+1]=a[1],c[e+2]=a[2];return c}}();q.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};"undefined"!==typeof a&&(a.vec3=q);var t={create:function(){var a=new e(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a},clone:function(a){var c=new e(4);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];return c},fromValues:function(a,d,b,f){var c=new e(4);c[0]=a;c[1]=d;c[2]=b;c[3]=f;return c},copy:function(a,d){a[0]=
d[0];a[1]=d[1];a[2]=d[2];a[3]=d[3];return a},set:function(a,d,b,e,f){a[0]=d;a[1]=b;a[2]=e;a[3]=f;return a},add:function(a,d,b){a[0]=d[0]+b[0];a[1]=d[1]+b[1];a[2]=d[2]+b[2];a[3]=d[3]+b[3];return a},subtract:function(a,d,b){a[0]=d[0]-b[0];a[1]=d[1]-b[1];a[2]=d[2]-b[2];a[3]=d[3]-b[3];return a}};t.sub=t.subtract;t.multiply=function(a,d,b){a[0]=d[0]*b[0];a[1]=d[1]*b[1];a[2]=d[2]*b[2];a[3]=d[3]*b[3];return a};t.mul=t.multiply;t.divide=function(a,d,b){a[0]=d[0]/b[0];a[1]=d[1]/b[1];a[2]=d[2]/b[2];a[3]=d[3]/
b[3];return a};t.div=t.divide;t.min=function(a,d,b){a[0]=Math.min(d[0],b[0]);a[1]=Math.min(d[1],b[1]);a[2]=Math.min(d[2],b[2]);a[3]=Math.min(d[3],b[3]);return a};t.max=function(a,d,b){a[0]=Math.max(d[0],b[0]);a[1]=Math.max(d[1],b[1]);a[2]=Math.max(d[2],b[2]);a[3]=Math.max(d[3],b[3]);return a};t.scale=function(a,d,b){a[0]=d[0]*b;a[1]=d[1]*b;a[2]=d[2]*b;a[3]=d[3]*b;return a};t.scaleAndAdd=function(a,d,b,e){a[0]=d[0]+b[0]*e;a[1]=d[1]+b[1]*e;a[2]=d[2]+b[2]*e;a[3]=d[3]+b[3]*e;return a};t.distance=function(a,
d){var c=d[0]-a[0],b=d[1]-a[1],e=d[2]-a[2];a=d[3]-a[3];return Math.sqrt(c*c+b*b+e*e+a*a)};t.dist=t.distance;t.squaredDistance=function(a,d){var c=d[0]-a[0],b=d[1]-a[1],e=d[2]-a[2];a=d[3]-a[3];return c*c+b*b+e*e+a*a};t.sqrDist=t.squaredDistance;t.length=function(a){var c=a[0],b=a[1],e=a[2];a=a[3];return Math.sqrt(c*c+b*b+e*e+a*a)};t.len=t.length;t.squaredLength=function(a){var c=a[0],b=a[1],e=a[2];a=a[3];return c*c+b*b+e*e+a*a};t.sqrLen=t.squaredLength;t.negate=function(a,d){a[0]=-d[0];a[1]=-d[1];
a[2]=-d[2];a[3]=-d[3];return a};t.normalize=function(a,d){var c=d[0],b=d[1],e=d[2],f=d[3];c=c*c+b*b+e*e+f*f;0<c&&(c=1/Math.sqrt(c),a[0]=d[0]*c,a[1]=d[1]*c,a[2]=d[2]*c,a[3]=d[3]*c);return a};t.dot=function(a,d){return a[0]*d[0]+a[1]*d[1]+a[2]*d[2]+a[3]*d[3]};t.lerp=function(a,d,b,e){var c=d[0],g=d[1],f=d[2];d=d[3];a[0]=c+e*(b[0]-c);a[1]=g+e*(b[1]-g);a[2]=f+e*(b[2]-f);a[3]=d+e*(b[3]-d);return a};t.random=function(a,d){d=d||1;a[0]=h();a[1]=h();a[2]=h();a[3]=h();t.normalize(a,a);t.scale(a,a,d);return a};
t.transformMat4=function(a,d,b){var c=d[0],g=d[1],e=d[2];d=d[3];a[0]=b[0]*c+b[4]*g+b[8]*e+b[12]*d;a[1]=b[1]*c+b[5]*g+b[9]*e+b[13]*d;a[2]=b[2]*c+b[6]*g+b[10]*e+b[14]*d;a[3]=b[3]*c+b[7]*g+b[11]*e+b[15]*d;return a};t.transformQuat=function(a,d,b){var c=d[0],g=d[1],e=d[2];d=b[0];var f=b[1],m=b[2];b=b[3];var h=b*c+f*e-m*g,k=b*g+m*c-d*e,l=b*e+d*g-f*c;c=-d*c-f*g-m*e;a[0]=h*b+c*-d+k*-m-l*-f;a[1]=k*b+c*-f+l*-d-h*-m;a[2]=l*b+c*-m+h*-f-k*-d;return a};t.forEach=function(){var a=t.create();return function(c,b,
e,f,h,k){b||(b=4);e||(e=0);for(f=f?Math.min(f*b+e,c.length):c.length;e<f;e+=b)a[0]=c[e],a[1]=c[e+1],a[2]=c[e+2],a[3]=c[e+3],h(a,a,k),c[e]=a[0],c[e+1]=a[1],c[e+2]=a[2],c[e+3]=a[3];return c}}();t.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.vec4=t);k={create:function(){var a=new e(4);a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},clone:function(a){var c=new e(4);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];return c},copy:function(a,d){a[0]=d[0];a[1]=d[1];a[2]=d[2];
a[3]=d[3];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},transpose:function(a,d){if(a===d){var c=d[1];a[1]=d[2];a[2]=c}else a[0]=d[0],a[1]=d[2],a[2]=d[1],a[3]=d[3];return a},invert:function(a,d){var c=d[0],b=d[1],e=d[2];d=d[3];var f=c*d-e*b;if(!f)return null;f=1/f;a[0]=d*f;a[1]=-b*f;a[2]=-e*f;a[3]=c*f;return a},adjoint:function(a,d){var c=d[0];a[0]=d[3];a[1]=-d[1];a[2]=-d[2];a[3]=c;return a},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},multiply:function(a,d,b){var c=d[0],
g=d[1],e=d[2];d=d[3];var f=b[0],m=b[1],h=b[2];b=b[3];a[0]=c*f+e*m;a[1]=g*f+d*m;a[2]=c*h+e*b;a[3]=g*h+d*b;return a}};k.mul=k.multiply;k.rotate=function(a,d,b){var c=d[0],g=d[1],e=d[2];d=d[3];var f=Math.sin(b);b=Math.cos(b);a[0]=c*b+e*f;a[1]=g*b+d*f;a[2]=c*-f+e*b;a[3]=g*-f+d*b;return a};k.scale=function(a,d,b){var c=d[1],g=d[2],e=d[3],f=b[0];b=b[1];a[0]=d[0]*f;a[1]=c*f;a[2]=g*b;a[3]=e*b;return a};k.str=function(a){return"mat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};k.frob=function(a){return Math.sqrt(Math.pow(a[0],
2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2))};k.LDU=function(a,d,b,e){a[2]=e[2]/e[0];b[0]=e[0];b[1]=e[1];b[3]=e[3]-a[2]*b[1];return[a,d,b]};"undefined"!==typeof a&&(a.mat2=k);k={create:function(){var a=new e(6);a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a},clone:function(a){var c=new e(6);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];return c},copy:function(a,d){a[0]=d[0];a[1]=d[1];a[2]=d[2];a[3]=d[3];a[4]=d[4];a[5]=d[5];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=
0;a[3]=1;a[4]=0;a[5]=0;return a},invert:function(a,d){var c=d[0],b=d[1],e=d[2],f=d[3],h=d[4];d=d[5];var m=c*f-b*e;if(!m)return null;m=1/m;a[0]=f*m;a[1]=-b*m;a[2]=-e*m;a[3]=c*m;a[4]=(e*d-f*h)*m;a[5]=(b*h-c*d)*m;return a},determinant:function(a){return a[0]*a[3]-a[1]*a[2]},multiply:function(a,d,b){var c=d[0],g=d[1],e=d[2],f=d[3],m=d[4];d=d[5];var h=b[0],k=b[1],l=b[2],n=b[3],p=b[4];b=b[5];a[0]=c*h+e*k;a[1]=g*h+f*k;a[2]=c*l+e*n;a[3]=g*l+f*n;a[4]=c*p+e*b+m;a[5]=g*p+f*b+d;return a}};k.mul=k.multiply;k.rotate=
function(a,d,b){var c=d[0],e=d[1],g=d[2],f=d[3],m=d[4];d=d[5];var h=Math.sin(b);b=Math.cos(b);a[0]=c*b+g*h;a[1]=e*b+f*h;a[2]=c*-h+g*b;a[3]=e*-h+f*b;a[4]=m;a[5]=d;return a};k.scale=function(a,d,b){var c=d[1],e=d[2],g=d[3],f=d[4],m=d[5],h=b[0];b=b[1];a[0]=d[0]*h;a[1]=c*h;a[2]=e*b;a[3]=g*b;a[4]=f;a[5]=m;return a};k.translate=function(a,d,b){var c=d[0],e=d[1],g=d[2],f=d[3],m=d[4];d=d[5];var h=b[0];b=b[1];a[0]=c;a[1]=e;a[2]=g;a[3]=f;a[4]=c*h+g*b+m;a[5]=e*h+f*b+d;return a};k.str=function(a){return"mat2d("+
a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};k.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};"undefined"!==typeof a&&(a.mat2d=k);var r={create:function(){var a=new e(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},fromMat4:function(a,d){a[0]=d[0];a[1]=d[1];a[2]=d[2];a[3]=d[4];a[4]=d[5];a[5]=d[6];a[6]=d[8];a[7]=d[9];a[8]=d[10];return a},clone:function(a){var c=new e(9);
c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c},copy:function(a,d){a[0]=d[0];a[1]=d[1];a[2]=d[2];a[3]=d[3];a[4]=d[4];a[5]=d[5];a[6]=d[6];a[7]=d[7];a[8]=d[8];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,d){if(a===d){var c=d[1],b=d[2],e=d[5];a[1]=d[3];a[2]=d[6];a[3]=c;a[5]=d[7];a[6]=b;a[7]=e}else a[0]=d[0],a[1]=d[3],a[2]=d[6],a[3]=d[1],a[4]=d[4],a[5]=d[7],a[6]=d[2],a[7]=
d[5],a[8]=d[8];return a},invert:function(a,d){var c=d[0],b=d[1],e=d[2],f=d[3],h=d[4],m=d[5],k=d[6],l=d[7];d=d[8];var n=d*h-m*l,p=-d*f+m*k,q=l*f-h*k,r=c*n+b*p+e*q;if(!r)return null;r=1/r;a[0]=n*r;a[1]=(-d*b+e*l)*r;a[2]=(m*b-e*h)*r;a[3]=p*r;a[4]=(d*c-e*k)*r;a[5]=(-m*c+e*f)*r;a[6]=q*r;a[7]=(-l*c+b*k)*r;a[8]=(h*c-b*f)*r;return a},adjoint:function(a,d){var c=d[0],b=d[1],e=d[2],f=d[3],h=d[4],m=d[5],k=d[6],l=d[7];d=d[8];a[0]=h*d-m*l;a[1]=e*l-b*d;a[2]=b*m-e*h;a[3]=m*k-f*d;a[4]=c*d-e*k;a[5]=e*f-c*m;a[6]=f*
l-h*k;a[7]=b*k-c*l;a[8]=c*h-b*f;return a},determinant:function(a){var c=a[3],b=a[4],e=a[5],f=a[6],h=a[7],k=a[8];return a[0]*(k*b-e*h)+a[1]*(-k*c+e*f)+a[2]*(h*c-b*f)},multiply:function(a,d,b){var c=d[0],e=d[1],g=d[2],f=d[3],m=d[4],h=d[5],k=d[6],l=d[7];d=d[8];var n=b[0],p=b[1],q=b[2],r=b[3],t=b[4],u=b[5],v=b[6],B=b[7];b=b[8];a[0]=n*c+p*f+q*k;a[1]=n*e+p*m+q*l;a[2]=n*g+p*h+q*d;a[3]=r*c+t*f+u*k;a[4]=r*e+t*m+u*l;a[5]=r*g+t*h+u*d;a[6]=v*c+B*f+b*k;a[7]=v*e+B*m+b*l;a[8]=v*g+B*h+b*d;return a}};r.mul=r.multiply;
r.translate=function(a,d,b){var c=d[0],e=d[1],g=d[2],f=d[3],m=d[4],h=d[5],k=d[6],l=d[7];d=d[8];var n=b[0];b=b[1];a[0]=c;a[1]=e;a[2]=g;a[3]=f;a[4]=m;a[5]=h;a[6]=n*c+b*f+k;a[7]=n*e+b*m+l;a[8]=n*g+b*h+d;return a};r.rotate=function(a,d,b){var c=d[0],e=d[1],g=d[2],f=d[3],m=d[4],h=d[5],k=d[6],l=d[7];d=d[8];var n=Math.sin(b);b=Math.cos(b);a[0]=b*c+n*f;a[1]=b*e+n*m;a[2]=b*g+n*h;a[3]=b*f-n*c;a[4]=b*m-n*e;a[5]=b*h-n*g;a[6]=k;a[7]=l;a[8]=d;return a};r.scale=function(a,d,b){var c=b[0];b=b[1];a[0]=c*d[0];a[1]=
c*d[1];a[2]=c*d[2];a[3]=b*d[3];a[4]=b*d[4];a[5]=b*d[5];a[6]=d[6];a[7]=d[7];a[8]=d[8];return a};r.fromMat2d=function(a,d){a[0]=d[0];a[1]=d[1];a[2]=0;a[3]=d[2];a[4]=d[3];a[5]=0;a[6]=d[4];a[7]=d[5];a[8]=1;return a};r.fromQuat=function(a,d){var c=d[0],b=d[1],e=d[2];d=d[3];var f=c+c,h=b+b,m=e+e;c*=f;var k=b*f;b*=h;var l=e*f,n=e*h;e*=m;f*=d;h*=d;d*=m;a[0]=1-b-e;a[3]=k-d;a[6]=l+h;a[1]=k+d;a[4]=1-c-e;a[7]=n-f;a[2]=l-h;a[5]=n+f;a[8]=1-c-b;return a};r.normalFromMat4=function(a,d){var c=d[0],b=d[1],e=d[2],f=
d[3],h=d[4],m=d[5],k=d[6],l=d[7],n=d[8],p=d[9],q=d[10],r=d[11],t=d[12],u=d[13],v=d[14];d=d[15];var B=c*m-b*h,w=c*k-e*h,A=c*l-f*h,F=b*k-e*m,G=b*l-f*m,K=e*l-f*k,H=n*u-p*t,I=n*v-q*t;n=n*d-r*t;var J=p*v-q*u;p=p*d-r*u;q=q*d-r*v;r=B*q-w*p+A*J+F*n-G*I+K*H;if(!r)return null;r=1/r;a[0]=(m*q-k*p+l*J)*r;a[1]=(k*n-h*q-l*I)*r;a[2]=(h*p-m*n+l*H)*r;a[3]=(e*p-b*q-f*J)*r;a[4]=(c*q-e*n+f*I)*r;a[5]=(b*n-c*p-f*H)*r;a[6]=(u*K-v*G+d*F)*r;a[7]=(v*A-t*K-d*w)*r;a[8]=(t*G-u*A+d*B)*r;return a};r.str=function(a){return"mat3("+
a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};r.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};"undefined"!==typeof a&&(a.mat3=r);var u={create:function(){var a=new e(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},clone:function(a){var c=
new e(16);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c},copy:function(a,d){a[0]=d[0];a[1]=d[1];a[2]=d[2];a[3]=d[3];a[4]=d[4];a[5]=d[5];a[6]=d[6];a[7]=d[7];a[8]=d[8];a[9]=d[9];a[10]=d[10];a[11]=d[11];a[12]=d[12];a[13]=d[13];a[14]=d[14];a[15]=d[15];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=
0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,d){if(a===d){var c=d[1],b=d[2],e=d[3],f=d[6],h=d[7],m=d[11];a[1]=d[4];a[2]=d[8];a[3]=d[12];a[4]=c;a[6]=d[9];a[7]=d[13];a[8]=b;a[9]=f;a[11]=d[14];a[12]=e;a[13]=h;a[14]=m}else a[0]=d[0],a[1]=d[4],a[2]=d[8],a[3]=d[12],a[4]=d[1],a[5]=d[5],a[6]=d[9],a[7]=d[13],a[8]=d[2],a[9]=d[6],a[10]=d[10],a[11]=d[14],a[12]=d[3],a[13]=d[7],a[14]=d[11],a[15]=d[15];return a},invert:function(a,d){var c=d[0],b=d[1],e=d[2],f=d[3],h=d[4],m=d[5],k=d[6],l=d[7],n=d[8],
p=d[9],q=d[10],r=d[11],t=d[12],u=d[13],v=d[14];d=d[15];var B=c*m-b*h,w=c*k-e*h,A=c*l-f*h,F=b*k-e*m,G=b*l-f*m,K=e*l-f*k,H=n*u-p*t,I=n*v-q*t,J=n*d-r*t,O=p*v-q*u,P=p*d-r*u,L=q*d-r*v,N=B*L-w*P+A*O+F*J-G*I+K*H;if(!N)return null;N=1/N;a[0]=(m*L-k*P+l*O)*N;a[1]=(e*P-b*L-f*O)*N;a[2]=(u*K-v*G+d*F)*N;a[3]=(q*G-p*K-r*F)*N;a[4]=(k*J-h*L-l*I)*N;a[5]=(c*L-e*J+f*I)*N;a[6]=(v*A-t*K-d*w)*N;a[7]=(n*K-q*A+r*w)*N;a[8]=(h*P-m*J+l*H)*N;a[9]=(b*J-c*P-f*H)*N;a[10]=(t*G-u*A+d*B)*N;a[11]=(p*A-n*G-r*B)*N;a[12]=(m*I-h*O-k*H)*
N;a[13]=(c*O-b*I+e*H)*N;a[14]=(u*w-t*F-v*B)*N;a[15]=(n*F-p*w+q*B)*N;return a},adjoint:function(a,d){var c=d[0],b=d[1],e=d[2],f=d[3],h=d[4],m=d[5],k=d[6],l=d[7],n=d[8],p=d[9],q=d[10],r=d[11],t=d[12],u=d[13],v=d[14];d=d[15];a[0]=m*(q*d-r*v)-p*(k*d-l*v)+u*(k*r-l*q);a[1]=-(b*(q*d-r*v)-p*(e*d-f*v)+u*(e*r-f*q));a[2]=b*(k*d-l*v)-m*(e*d-f*v)+u*(e*l-f*k);a[3]=-(b*(k*r-l*q)-m*(e*r-f*q)+p*(e*l-f*k));a[4]=-(h*(q*d-r*v)-n*(k*d-l*v)+t*(k*r-l*q));a[5]=c*(q*d-r*v)-n*(e*d-f*v)+t*(e*r-f*q);a[6]=-(c*(k*d-l*v)-h*(e*
d-f*v)+t*(e*l-f*k));a[7]=c*(k*r-l*q)-h*(e*r-f*q)+n*(e*l-f*k);a[8]=h*(p*d-r*u)-n*(m*d-l*u)+t*(m*r-l*p);a[9]=-(c*(p*d-r*u)-n*(b*d-f*u)+t*(b*r-f*p));a[10]=c*(m*d-l*u)-h*(b*d-f*u)+t*(b*l-f*m);a[11]=-(c*(m*r-l*p)-h*(b*r-f*p)+n*(b*l-f*m));a[12]=-(h*(p*v-q*u)-n*(m*v-k*u)+t*(m*q-k*p));a[13]=c*(p*v-q*u)-n*(b*v-e*u)+t*(b*q-e*p);a[14]=-(c*(m*v-k*u)-h*(b*v-e*u)+t*(b*k-e*m));a[15]=c*(m*q-k*p)-h*(b*q-e*p)+n*(b*k-e*m);return a},determinant:function(a){var c=a[0],b=a[1],e=a[2],f=a[3],h=a[4],k=a[5],m=a[6],l=a[7],
n=a[8],p=a[9],q=a[10],r=a[11],t=a[12],u=a[13],v=a[14];a=a[15];return(c*k-b*h)*(q*a-r*v)-(c*m-e*h)*(p*a-r*u)+(c*l-f*h)*(p*v-q*u)+(b*m-e*k)*(n*a-r*t)-(b*l-f*k)*(n*v-q*t)+(e*l-f*m)*(n*u-p*t)},multiply:function(a,d,b){var c=d[0],e=d[1],f=d[2],g=d[3],h=d[4],k=d[5],l=d[6],n=d[7],p=d[8],q=d[9],r=d[10],t=d[11],u=d[12],v=d[13],B=d[14];d=d[15];var w=b[0],A=b[1],F=b[2],G=b[3];a[0]=w*c+A*h+F*p+G*u;a[1]=w*e+A*k+F*q+G*v;a[2]=w*f+A*l+F*r+G*B;a[3]=w*g+A*n+F*t+G*d;w=b[4];A=b[5];F=b[6];G=b[7];a[4]=w*c+A*h+F*p+G*u;
a[5]=w*e+A*k+F*q+G*v;a[6]=w*f+A*l+F*r+G*B;a[7]=w*g+A*n+F*t+G*d;w=b[8];A=b[9];F=b[10];G=b[11];a[8]=w*c+A*h+F*p+G*u;a[9]=w*e+A*k+F*q+G*v;a[10]=w*f+A*l+F*r+G*B;a[11]=w*g+A*n+F*t+G*d;w=b[12];A=b[13];F=b[14];G=b[15];a[12]=w*c+A*h+F*p+G*u;a[13]=w*e+A*k+F*q+G*v;a[14]=w*f+A*l+F*r+G*B;a[15]=w*g+A*n+F*t+G*d;return a}};u.mul=u.multiply;u.translate=function(a,d,b){var c=b[0],e=b[1];b=b[2];if(d===a)a[12]=d[0]*c+d[4]*e+d[8]*b+d[12],a[13]=d[1]*c+d[5]*e+d[9]*b+d[13],a[14]=d[2]*c+d[6]*e+d[10]*b+d[14],a[15]=d[3]*c+
d[7]*e+d[11]*b+d[15];else{var f=d[0];var g=d[1];var h=d[2];var k=d[3];var l=d[4];var n=d[5];var p=d[6];var q=d[7];var r=d[8];var t=d[9];var u=d[10];var v=d[11];a[0]=f;a[1]=g;a[2]=h;a[3]=k;a[4]=l;a[5]=n;a[6]=p;a[7]=q;a[8]=r;a[9]=t;a[10]=u;a[11]=v;a[12]=f*c+l*e+r*b+d[12];a[13]=g*c+n*e+t*b+d[13];a[14]=h*c+p*e+u*b+d[14];a[15]=k*c+q*e+v*b+d[15]}return a};u.scale=function(a,d,b){var c=b[0],e=b[1];b=b[2];a[0]=d[0]*c;a[1]=d[1]*c;a[2]=d[2]*c;a[3]=d[3]*c;a[4]=d[4]*e;a[5]=d[5]*e;a[6]=d[6]*e;a[7]=d[7]*e;a[8]=
d[8]*b;a[9]=d[9]*b;a[10]=d[10]*b;a[11]=d[11]*b;a[12]=d[12];a[13]=d[13];a[14]=d[14];a[15]=d[15];return a};u.rotate=function(a,d,e,f){var c=f[0],g=f[1];f=f[2];var h=Math.sqrt(c*c+g*g+f*f);if(Math.abs(h)<b)return null;h=1/h;c*=h;g*=h;f*=h;var m=Math.sin(e);var k=Math.cos(e);var l=1-k;e=d[0];h=d[1];var n=d[2];var p=d[3];var q=d[4];var r=d[5];var E=d[6];var t=d[7];var u=d[8];var v=d[9];var w=d[10];var A=d[11];var B=c*c*l+k;var G=g*c*l+f*m;var K=f*c*l-g*m;var H=c*g*l-f*m;var I=g*g*l+k;var J=f*g*l+c*m;var O=
c*f*l+g*m;c=g*f*l-c*m;g=f*f*l+k;a[0]=e*B+q*G+u*K;a[1]=h*B+r*G+v*K;a[2]=n*B+E*G+w*K;a[3]=p*B+t*G+A*K;a[4]=e*H+q*I+u*J;a[5]=h*H+r*I+v*J;a[6]=n*H+E*I+w*J;a[7]=p*H+t*I+A*J;a[8]=e*O+q*c+u*g;a[9]=h*O+r*c+v*g;a[10]=n*O+E*c+w*g;a[11]=p*O+t*c+A*g;d!==a&&(a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15]);return a};u.rotateX=function(a,d,b){var c=Math.sin(b);b=Math.cos(b);var e=d[4],f=d[5],g=d[6],h=d[7],k=d[8],l=d[9],n=d[10],p=d[11];d!==a&&(a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a[12]=d[12],a[13]=d[13],a[14]=
d[14],a[15]=d[15]);a[4]=e*b+k*c;a[5]=f*b+l*c;a[6]=g*b+n*c;a[7]=h*b+p*c;a[8]=k*b-e*c;a[9]=l*b-f*c;a[10]=n*b-g*c;a[11]=p*b-h*c;return a};u.rotateY=function(a,d,b){var c=Math.sin(b);b=Math.cos(b);var e=d[0],f=d[1],g=d[2],h=d[3],k=d[8],l=d[9],n=d[10],p=d[11];d!==a&&(a[4]=d[4],a[5]=d[5],a[6]=d[6],a[7]=d[7],a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15]);a[0]=e*b-k*c;a[1]=f*b-l*c;a[2]=g*b-n*c;a[3]=h*b-p*c;a[8]=e*c+k*b;a[9]=f*c+l*b;a[10]=g*c+n*b;a[11]=h*c+p*b;return a};u.rotateZ=function(a,d,b){var c=Math.sin(b);
b=Math.cos(b);var e=d[0],f=d[1],g=d[2],h=d[3],k=d[4],l=d[5],n=d[6],p=d[7];d!==a&&(a[8]=d[8],a[9]=d[9],a[10]=d[10],a[11]=d[11],a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15]);a[0]=e*b+k*c;a[1]=f*b+l*c;a[2]=g*b+n*c;a[3]=h*b+p*c;a[4]=k*b-e*c;a[5]=l*b-f*c;a[6]=n*b-g*c;a[7]=p*b-h*c;return a};u.fromRotationTranslation=function(a,d,b){var c=d[0],e=d[1],f=d[2],g=d[3],h=c+c,k=e+e,l=f+f;d=c*h;var n=c*k;c*=l;var p=e*k;e*=l;f*=l;h*=g;k*=g;g*=l;a[0]=1-(p+f);a[1]=n+g;a[2]=c-k;a[3]=0;a[4]=n-g;a[5]=1-(d+f);a[6]=
e+h;a[7]=0;a[8]=c+k;a[9]=e-h;a[10]=1-(d+p);a[11]=0;a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=1;return a};u.fromQuat=function(a,d){var c=d[0],b=d[1],e=d[2];d=d[3];var f=c+c,h=b+b,k=e+e;c*=f;var l=b*f;b*=h;var n=e*f,p=e*h;e*=k;f*=d;h*=d;d*=k;a[0]=1-b-e;a[1]=l+d;a[2]=n-h;a[3]=0;a[4]=l-d;a[5]=1-c-e;a[6]=p+f;a[7]=0;a[8]=n+h;a[9]=p-f;a[10]=1-c-b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};u.frustum=function(a,b,e,f,h,k,l){var c=1/(e-b),d=1/(h-f),g=1/(k-l);a[0]=2*k*c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=
2*k*d;a[6]=0;a[7]=0;a[8]=(e+b)*c;a[9]=(h+f)*d;a[10]=(l+k)*g;a[11]=-1;a[12]=0;a[13]=0;a[14]=l*k*2*g;a[15]=0;return a};u.perspective=function(a,b,e,f,h){b=1/Math.tan(b/2);var c=1/(f-h);a[0]=b/e;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(h+f)*c;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*h*f*c;a[15]=0;return a};u.ortho=function(a,b,e,f,h,k,l){var c=1/(b-e),d=1/(f-h),g=1/(k-l);a[0]=-2*c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*d;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*g;a[11]=0;a[12]=(b+e)*c;a[13]=
(h+f)*d;a[14]=(l+k)*g;a[15]=1;return a};u.lookAt=function(a,d,e,f){var c=d[0],g=d[1];d=d[2];var h=f[0];var k=f[1];var l=f[2];var n=e[0];f=e[1];var p=e[2];if(Math.abs(c-n)<b&&Math.abs(g-f)<b&&Math.abs(d-p)<b)return u.identity(a);e=c-n;f=g-f;n=d-p;var q=1/Math.sqrt(e*e+f*f+n*n);e*=q;f*=q;n*=q;p=k*n-l*f;l=l*e-h*n;h=h*f-k*e;(q=Math.sqrt(p*p+l*l+h*h))?(q=1/q,p*=q,l*=q,h*=q):h=l=p=0;k=f*h-n*l;var r=n*p-e*h;var t=e*l-f*p;(q=Math.sqrt(k*k+r*r+t*t))?(q=1/q,k*=q,r*=q,t*=q):t=r=k=0;a[0]=p;a[1]=k;a[2]=e;a[3]=
0;a[4]=l;a[5]=r;a[6]=f;a[7]=0;a[8]=h;a[9]=t;a[10]=n;a[11]=0;a[12]=-(p*c+l*g+h*d);a[13]=-(k*c+r*g+t*d);a[14]=-(e*c+f*g+n*d);a[15]=1;return a};u.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};u.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[6],
2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};"undefined"!==typeof a&&(a.mat4=u);var f={create:function(){var a=new e(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}};f.rotationTo=function(){var a=q.create(),b=q.fromValues(1,0,0),e=q.fromValues(0,1,0);return function(c,d,g){var h=q.dot(d,g);if(-.999999>h)return q.cross(a,b,d),1E-6>q.length(a)&&q.cross(a,e,d),q.normalize(a,a),f.setAxisAngle(c,
a,Math.PI),c;if(.999999<h)return c[0]=0,c[1]=0,c[2]=0,c[3]=1,c;q.cross(a,d,g);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=1+h;return f.normalize(c,c)}}();f.setAxes=function(){var a=r.create();return function(c,b,e,h){a[0]=e[0];a[3]=e[1];a[6]=e[2];a[1]=h[0];a[4]=h[1];a[7]=h[2];a[2]=-b[0];a[5]=-b[1];a[8]=-b[2];return f.normalize(c,f.fromMat3(c,a))}}();f.clone=t.clone;f.fromValues=t.fromValues;f.copy=t.copy;f.set=t.set;f.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};f.setAxisAngle=function(a,b,e){e*=
.5;var c=Math.sin(e);a[0]=c*b[0];a[1]=c*b[1];a[2]=c*b[2];a[3]=Math.cos(e);return a};f.add=t.add;f.multiply=function(a,b,e){var c=b[0],d=b[1],f=b[2];b=b[3];var g=e[0],h=e[1],k=e[2];e=e[3];a[0]=c*e+b*g+d*k-f*h;a[1]=d*e+b*h+f*g-c*k;a[2]=f*e+b*k+c*h-d*g;a[3]=b*e-c*g-d*h-f*k;return a};f.mul=f.multiply;f.scale=t.scale;f.rotateX=function(a,b,e){e*=.5;var c=b[0],d=b[1],f=b[2];b=b[3];var g=Math.sin(e);e=Math.cos(e);a[0]=c*e+b*g;a[1]=d*e+f*g;a[2]=f*e-d*g;a[3]=b*e-c*g;return a};f.rotateY=function(a,b,e){e*=
.5;var c=b[0],d=b[1],f=b[2];b=b[3];var g=Math.sin(e);e=Math.cos(e);a[0]=c*e-f*g;a[1]=d*e+b*g;a[2]=f*e+c*g;a[3]=b*e-d*g;return a};f.rotateZ=function(a,b,e){e*=.5;var c=b[0],d=b[1],f=b[2];b=b[3];var g=Math.sin(e);e=Math.cos(e);a[0]=c*e+d*g;a[1]=d*e-c*g;a[2]=f*e+b*g;a[3]=b*e-f*g;return a};f.calculateW=function(a,b){var c=b[0],d=b[1];b=b[2];a[0]=c;a[1]=d;a[2]=b;a[3]=-Math.sqrt(Math.abs(1-c*c-d*d-b*b));return a};f.dot=t.dot;f.lerp=t.lerp;f.slerp=function(a,b,e,f){var c=b[0],d=b[1],g=b[2];b=b[3];var h=
e[0],k=e[1],l=e[2];e=e[3];var n=c*h+d*k+g*l+b*e;0>n&&(n=-n,h=-h,k=-k,l=-l,e=-e);if(1E-6<1-n){var p=Math.acos(n);var q=Math.sin(p);n=Math.sin((1-f)*p)/q;f=Math.sin(f*p)/q}else n=1-f;a[0]=n*c+f*h;a[1]=n*d+f*k;a[2]=n*g+f*l;a[3]=n*b+f*e;return a};f.invert=function(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var f=c*c+d*d+e*e+b*b;f=f?1/f:0;a[0]=-c*f;a[1]=-d*f;a[2]=-e*f;a[3]=b*f;return a};f.conjugate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=b[3];return a};f.length=t.length;f.len=f.length;f.squaredLength=
t.squaredLength;f.sqrLen=f.squaredLength;f.normalize=t.normalize;f.fromMat3=function(a,b){var c=b[0]+b[4]+b[8];if(0<c)c=Math.sqrt(c+1),a[3]=.5*c,c=.5/c,a[0]=(b[7]-b[5])*c,a[1]=(b[2]-b[6])*c,a[2]=(b[3]-b[1])*c;else{var d=0;b[4]>b[0]&&(d=1);b[8]>b[3*d+d]&&(d=2);var e=(d+1)%3,f=(d+2)%3;c=Math.sqrt(b[3*d+d]-b[3*e+e]-b[3*f+f]+1);a[d]=.5*c;c=.5/c;a[3]=(b[3*f+e]-b[3*e+f])*c;a[e]=(b[3*e+d]+b[3*d+e])*c;a[f]=(b[3*f+d]+b[3*d+f])*c}return a};f.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+
")"};"undefined"!==typeof a&&(a.quat=f)})(b)})(this)},{}],24:[function(a,b,k){(function(){var a=this,e=a._,h={},n=Array.prototype,B=Object.prototype,v=n.push,A=n.slice,w=n.concat,p=B.toString,q=B.hasOwnProperty,t=n.forEach,r=n.map,u=n.reduce,f=n.reduceRight,c=n.filter,d=n.every,g=n.some,E=n.indexOf,C=n.lastIndexOf;B=Array.isArray;var D=Object.keys,X=Function.prototype.bind,m=function(a){if(a instanceof m)return a;if(!(this instanceof m))return new m(a);this._wrapped=a};"undefined"!==typeof k?("undefined"!==
typeof b&&b.exports&&(k=b.exports=m),k._=m):a._=m;m.VERSION="1.4.4";var M=m.each=m.forEach=function(a,b,c){if(null!=a)if(t&&a.forEach===t)a.forEach(b,c);else if(a.length===+a.length)for(var d=0,e=a.length;d<e&&b.call(c,a[d],d,a)!==h;d++);else for(d in a)if(m.has(a,d)&&b.call(c,a[d],d,a)===h)break};m.map=m.collect=function(a,b,c){var d=[];if(null==a)return d;if(r&&a.map===r)return a.map(b,c);M(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)});return d};m.reduce=m.foldl=m.inject=function(a,b,c,d){var e=
2<arguments.length;null==a&&(a=[]);if(u&&a.reduce===u)return d&&(b=m.bind(b,d)),e?a.reduce(b,c):a.reduce(b);M(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c};m.reduceRight=m.foldr=function(a,b,c,d){var e=2<arguments.length;null==a&&(a=[]);if(f&&a.reduceRight===f)return d&&(b=m.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var g=a.length;if(g!==+g){var h=m.keys(a);g=h.length}M(a,function(f,k,l){k=h?h[--g]:--g;
e?c=b.call(d,c,a[k],k,l):(c=a[k],e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c};m.find=m.detect=function(a,b,c){var d;Y(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0});return d};m.filter=m.select=function(a,b,d){var e=[];if(null==a)return e;if(c&&a.filter===c)return a.filter(b,d);M(a,function(a,c,f){b.call(d,a,c,f)&&(e[e.length]=a)});return e};m.reject=function(a,b,c){return m.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)};m.every=m.all=function(a,
b,c){b||(b=m.identity);var e=!0;if(null==a)return e;if(d&&a.every===d)return a.every(b,c);M(a,function(a,d,f){if(!(e=e&&b.call(c,a,d,f)))return h});return!!e};var Y=m.some=m.any=function(a,b,c){b||(b=m.identity);var d=!1;if(null==a)return d;if(g&&a.some===g)return a.some(b,c);M(a,function(a,e,f){if(d||(d=b.call(c,a,e,f)))return h});return!!d};m.contains=m.include=function(a,b){return null==a?!1:E&&a.indexOf===E?-1!==a.indexOf(b):Y(a,function(a){return a===b})};m.invoke=function(a,b){var c=A.call(arguments,
2),d=m.isFunction(b);return m.map(a,function(a){return(d?b:a[b]).apply(a,c)})};m.pluck=function(a,b){return m.map(a,function(a){return a[b]})};m.where=function(a,b,c){return m.isEmpty(b)?c?null:[]:m[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})};m.findWhere=function(a,b){return m.where(a,b,!0)};m.max=function(a,b,c){if(!b&&m.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.max.apply(Math,a);if(!b&&m.isEmpty(a))return-Infinity;var d={computed:-Infinity,value:-Infinity};
M(a,function(a,e,f){e=b?b.call(c,a,e,f):a;e>=d.computed&&(d={value:a,computed:e})});return d.value};m.min=function(a,b,c){if(!b&&m.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.min.apply(Math,a);if(!b&&m.isEmpty(a))return Infinity;var d={computed:Infinity,value:Infinity};M(a,function(a,e,f){e=b?b.call(c,a,e,f):a;e<d.computed&&(d={value:a,computed:e})});return d.value};m.shuffle=function(a){var b,c=0,d=[];M(a,function(a){b=m.random(c++);d[c-1]=d[b];d[b]=a});return d};var Z=function(a){return m.isFunction(a)?
a:function(b){return b[a]}};m.sortBy=function(a,b,c){var d=Z(b);return m.pluck(m.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(c<d||void 0===d)return-1}return a.index<b.index?-1:1}),"value")};var ea=function(a,b,c,d){var e={},f=Z(b||m.identity);M(a,function(b,g){g=f.call(c,b,g,a);d(e,g,b)});return e};m.groupBy=function(a,b,c){return ea(a,b,c,function(a,b,c){(m.has(a,b)?a[b]:a[b]=[]).push(c)})};
m.countBy=function(a,b,c){return ea(a,b,c,function(a,b){m.has(a,b)||(a[b]=0);a[b]++})};m.sortedIndex=function(a,b,c,d){c=null==c?m.identity:Z(c);b=c.call(d,b);for(var e=0,f=a.length;e<f;){var g=e+f>>>1;c.call(d,a[g])<b?e=g+1:f=g}return e};m.toArray=function(a){return a?m.isArray(a)?A.call(a):a.length===+a.length?m.map(a,m.identity):m.values(a):[]};m.size=function(a){return null==a?0:a.length===+a.length?a.length:m.keys(a).length};m.first=m.head=m.take=function(a,b,c){if(null!=a)return null==b||c?
a[0]:A.call(a,0,b)};m.initial=function(a,b,c){return A.call(a,0,a.length-(null==b||c?1:b))};m.last=function(a,b,c){if(null!=a)return null==b||c?a[a.length-1]:A.call(a,Math.max(a.length-b,0))};m.rest=m.tail=m.drop=function(a,b,c){return A.call(a,null==b||c?1:b)};m.compact=function(a){return m.filter(a,m.identity)};var aa=function(a,b,c){M(a,function(a){m.isArray(a)?b?v.apply(c,a):aa(a,b,c):c.push(a)});return c};m.flatten=function(a,b){return aa(a,b,[])};m.without=function(a){return m.difference(a,
A.call(arguments,1))};m.uniq=m.unique=function(a,b,c,d){m.isFunction(b)&&(d=c,c=b,b=!1);c=c?m.map(a,c,d):a;var e=[],f=[];M(c,function(c,d){(b?d&&f[f.length-1]===c:m.contains(f,c))||(f.push(c),e.push(a[d]))});return e};m.union=function(){return m.uniq(w.apply(n,arguments))};m.intersection=function(a){var b=A.call(arguments,1);return m.filter(m.uniq(a),function(a){return m.every(b,function(b){return 0<=m.indexOf(b,a)})})};m.difference=function(a){var b=w.apply(n,A.call(arguments,1));return m.filter(a,
function(a){return!m.contains(b,a)})};m.zip=function(){for(var a=A.call(arguments),b=m.max(m.pluck(a,"length")),c=Array(b),d=0;d<b;d++)c[d]=m.pluck(a,""+d);return c};m.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;d<e;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c};m.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c)if("number"==typeof c)d=0>c?Math.max(0,e+c):c;else return d=m.sortedIndex(a,b),a[d]===b?d:-1;if(E&&a.indexOf===E)return a.indexOf(b,c);for(;d<
e;d++)if(a[d]===b)return d;return-1};m.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(C&&a.lastIndexOf===C)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(c=d?c:a.length;c--;)if(a[c]===b)return c;return-1};m.range=function(a,b,c){1>=arguments.length&&(b=a||0,a=0);c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=Array(d);e<d;)f[e++]=a,a+=c;return f};m.bind=function(a,b){if(a.bind===X&&X)return X.apply(a,A.call(arguments,1));var c=A.call(arguments,2);return function(){return a.apply(b,
c.concat(A.call(arguments)))}};m.partial=function(a){var b=A.call(arguments,1);return function(){return a.apply(this,b.concat(A.call(arguments)))}};m.bindAll=function(a){var b=A.call(arguments,1);0===b.length&&(b=m.functions(a));M(b,function(b){a[b]=m.bind(a[b],a)});return a};m.memoize=function(a,b){var c={};b||(b=m.identity);return function(){var d=b.apply(this,arguments);return m.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}};m.delay=function(a,b){var c=A.call(arguments,2);return setTimeout(function(){return a.apply(null,
c)},b)};m.defer=function(a){return m.delay.apply(m,[a,1].concat(A.call(arguments,1)))};m.throttle=function(a,b){var c,d,e,f,g=0,h=function(){g=new Date;e=null;f=a.apply(c,d)};return function(){var k=new Date,l=b-(k-g);c=this;d=arguments;0>=l?(clearTimeout(e),e=null,g=k,f=a.apply(c,d)):e||(e=setTimeout(h,l));return f}};m.debounce=function(a,b,c){var d,e;return function(){var f=this,g=arguments,h=c&&!d;clearTimeout(d);d=setTimeout(function(){d=null;c||(e=a.apply(f,g))},b);h&&(e=a.apply(f,g));return e}};
m.once=function(a){var b=!1,c;return function(){if(b)return c;b=!0;c=a.apply(this,arguments);a=null;return c}};m.wrap=function(a,b){return function(){var c=[a];v.apply(c,arguments);return b.apply(this,c)}};m.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;0<=c;c--)b=[a[c].apply(this,b)];return b[0]}};m.after=function(a,b){return 0>=a?b():function(){if(1>--a)return b.apply(this,arguments)}};m.keys=D||function(a){if(a!==Object(a))throw new TypeError("Invalid object");
var b=[],c;for(c in a)m.has(a,c)&&(b[b.length]=c);return b};m.values=function(a){var b=[],c;for(c in a)m.has(a,c)&&b.push(a[c]);return b};m.pairs=function(a){var b=[],c;for(c in a)m.has(a,c)&&b.push([c,a[c]]);return b};m.invert=function(a){var b={},c;for(c in a)m.has(a,c)&&(b[a[c]]=c);return b};m.functions=m.methods=function(a){var b=[],c;for(c in a)m.isFunction(a[c])&&b.push(c);return b.sort()};m.extend=function(a){M(A.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]});return a};m.pick=
function(a){var b={},c=w.apply(n,A.call(arguments,1));M(c,function(c){c in a&&(b[c]=a[c])});return b};m.omit=function(a){var b={},c=w.apply(n,A.call(arguments,1)),d;for(d in a)m.contains(c,d)||(b[d]=a[d]);return b};m.defaults=function(a){M(A.call(arguments,1),function(b){if(b)for(var c in b)null==a[c]&&(a[c]=b[c])});return a};m.clone=function(a){return m.isObject(a)?m.isArray(a)?a.slice():m.extend({},a):a};m.tap=function(a,b){b(a);return a};var S=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;
if(null==a||null==b)return a===b;a instanceof m&&(a=a._wrapped);b instanceof m&&(b=b._wrapped);var e=p.call(a);if(e!=p.call(b))return!1;switch(e){case "[object String]":return a==String(b);case "[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==
a)return d[f]==b;c.push(a);d.push(b);f=0;var g=!0;if("[object Array]"==e){if(f=a.length,g=f==b.length)for(;f--&&(g=S(a[f],b[f],c,d)););}else{e=a.constructor;var h=b.constructor;if(e!==h&&!(m.isFunction(e)&&e instanceof e&&m.isFunction(h)&&h instanceof h))return!1;for(var k in a)if(m.has(a,k)&&(f++,!(g=m.has(b,k)&&S(a[k],b[k],c,d))))break;if(g){for(k in b)if(m.has(b,k)&&!f--)break;g=!f}}c.pop();d.pop();return g};m.isEqual=function(a,b){return S(a,b,[],[])};m.isEmpty=function(a){if(null==a)return!0;
if(m.isArray(a)||m.isString(a))return 0===a.length;for(var b in a)if(m.has(a,b))return!1;return!0};m.isElement=function(a){return!(!a||1!==a.nodeType)};m.isArray=B||function(a){return"[object Array]"==p.call(a)};m.isObject=function(a){return a===Object(a)};M("Arguments Function String Number Date RegExp".split(" "),function(a){m["is"+a]=function(b){return p.call(b)=="[object "+a+"]"}});m.isArguments(arguments)||(m.isArguments=function(a){return!(!a||!m.has(a,"callee"))});"function"!==typeof/./&&(m.isFunction=
function(a){return"function"===typeof a});m.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};m.isNaN=function(a){return m.isNumber(a)&&a!=+a};m.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==p.call(a)};m.isNull=function(a){return null===a};m.isUndefined=function(a){return void 0===a};m.has=function(a,b){return q.call(a,b)};m.noConflict=function(){a._=e;return this};m.identity=function(a){return a};m.times=function(a,b,c){for(var d=Array(a),e=0;e<a;e++)d[e]=b.call(c,
e);return d};m.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var V={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};V.unescape=m.invert(V.escape);var ja={escape:new RegExp("["+m.keys(V.escape).join("")+"]","g"),unescape:new RegExp("("+m.keys(V.unescape).join("|")+")","g")};m.each(["escape","unescape"],function(a){m[a]=function(b){return null==b?"":(""+b).replace(ja[a],function(b){return V[a][b]})}});m.result=function(a,b){if(null==
a)return null;b=a[b];return m.isFunction(b)?b.call(a):b};m.mixin=function(a){M(m.functions(a),function(b){var c=m[b]=a[b];m.prototype[b]=function(){var a=[this._wrapped];v.apply(a,arguments);return F.call(this,c.apply(m,a))}})};var ka=0;m.uniqueId=function(a){var b=++ka+"";return a?a+b:b};m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var ca=/(.)^/,la={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},W=/\\|'|\r|\n|\t|\u2028|\u2029/g;
m.template=function(a,b,c){c=m.defaults({},c,m.templateSettings);var d=new RegExp([(c.escape||ca).source,(c.interpolate||ca).source,(c.evaluate||ca).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){f+=a.slice(e,h).replace(W,function(a){return"\\"+la[a]});c&&(f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'");d&&(f+="'+\n((__t=("+d+"))==null?'':__t)+\n'");g&&(f+="';\n"+g+"\n__p+='");e=h+b.length;return b});f+="';\n";c.variable||(f="with(obj||{}){\n"+f+"}\n");f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+
f+"return __p;\n";try{var g=new Function(c.variable||"obj","_",f)}catch(L){throw L.source=f,L;}if(b)return g(b,m);b=function(a){return g.call(this,a,m)};b.source="function("+(c.variable||"obj")+"){\n"+f+"}";return b};m.chain=function(a){return m(a).chain()};var F=function(a){return this._chain?m(a).chain():a};m.mixin(m);M("pop push reverse shift sort splice unshift".split(" "),function(a){var b=n[a];m.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);"shift"!=a&&"splice"!=a||0!==c.length||
delete c[0];return F.call(this,c)}});M(["concat","join","slice"],function(a){var b=n[a];m.prototype[a]=function(){return F.call(this,b.apply(this._wrapped,arguments))}});m.extend(m.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this)},{}],25:[function(a,b,k){"undefined"!==typeof window&&"function"!==typeof window.requestAnimationFrame&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||
window.msRequestAnimationFrame||function(a){setTimeout(a,1E3/60)});Leap=a("../lib/index")},{"../lib/index":11}]},{},[25]);
}).call(this);//# sourceMappingURL=CindyLeap.js.map

