(function(){
'use strict';var ba={addc:"vec2 addc(vec2 a,vec2 b){\nreturn a+b;\n}\n",arccosc:"vec2 arccosc(vec2 a){\nvec2 t2=multc(a,negc(a));\nvec2 tmp=sqrtc(addc(vec2(1.0,0.0),t2));\nvec2 tmp1=addc(multc(a,vec2(0.0,1.0)),tmp);\nvec2 erg=addc(multc(logc(tmp1),vec2(0.0,1.0)),vec2(pi*0.5,0.0));\nreturn erg;\n}\n",arcsinc:"vec2 arcsinc(vec2 a){\nvec2 t2=multc(a,negc(a));\nvec2 tmp=sqrtc(addc(vec2(1.0,0.0),t2));\nvec2 tmp1=addc(multc(a,vec2(0.0,1.0)),tmp);\nvec2 erg=multc(logc(tmp1),vec2(0.0,-1.0));\nreturn erg;\n}\n",
arctan2c:"\n\n\n\nvec2 arctan2c(vec2 x,vec2 y){\nvec2 r=logc(divc(x+vec2(-y.y,y.x),sqrtc(multc(x,x)+multc(y,y))));\nreturn vec2(r.y, -r.x);\n}\n",arctan2vec2:"float arctan2vec2(vec2 v){\nreturn atan(v.y,v.x);\n}\n",arctan2vec2c:"vec2 arctan2vec2c(vec4 v){\nreturn arctan2c(v.xy,v.zw);\n}\n",arctanc:"vec2 arctanc(vec2 a){\nvec2 t1=logc(addc(multc(a,vec2(0.0,-1.0)),vec2(1.0,0.0)));\nvec2 t2=logc(addc(multc(a,vec2(0.0,1.0)),vec2(1.0,0.0)));\nvec2 erg=multc(subc(t1,t2),vec2(0.0,0.5));\nreturn erg;\n}\n",
blue:"vec3 blue(float f)\n{\nreturn vec3(0.,0.,clamp(f,0.,1.));\n}\n",cimag:"float imagc(vec2 a){\nreturn a.y;\n}\n",conjugate:"vec2 conjugate(vec2 a){\nreturn vec2(a.x, -a.y);\n}\n",copytexture_f:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D sampler;\nvarying vec2 cgl_pixel;\n\nvoid main(void){\ngl_FragColor=texture2D(sampler,cgl_pixel);\n}\n",copytexture_v:"attribute vec3 aPos;\nattribute vec2 aTexCoord;\nvarying vec2 cgl_pixel;\n\nvoid main(void){\ngl_Position=vec4(aPos,1.);\ncgl_pixel=aTexCoord;\n}\n",
cosc:"vec2 cosc(vec2 a){\n\nfloat n=exp(a.y);\nfloat imag1=n*sin(-a.x);\nfloat real1=n*cos(-a.x);\nn=exp(-a.y);\nfloat imag2=n*sin(a.x);\nfloat real2=n*cos(a.x);\nfloat i= (imag1+imag2) /2.0;\nfloat r= (real1+real2) /2.0;\n\nreturn vec2(r,i);\n}\n",creal:"float realc(vec2 a){\nreturn a.x;\n}\n",dehomogenize:"vec2 dehomogenize(vec3 z){\nreturn vec2(z.x,z.y)/z.z;\n}\n",divc:"vec2 divc(vec2 a,vec2 b){\nreturn 1./(b.x*b.x+b.y*b.y)*multc(a,vec2(b.x,-b.y));\n}\n",expc:"vec2 expc(vec2 a){\nfloat n=exp(a.x);\nfloat r=n*cos(a.y);\nfloat i=n*sin(a.y);\nreturn vec2(r,i);\n}\n",
float2color:"vec4 float2color(float f)\n{\nreturn vec4(f,f,f,1.);\n}\n",gray:"vec3 gray(float f)\n{\nf=clamp(f,0.,1.);\nreturn vec3(f,f,f);\n}\n",green:"vec3 green(float f)\n{\nreturn vec3(0.,clamp(f,0.,1.),0.);\n}\n",hsv2rgb:"vec3 hsv2rgb(vec3 c)\n{\nvec4 K=vec4(1.0,2.0/3.0,1.0/3.0,3.0);\nvec3 p=abs(fract(c.xxx+K.xyz) *6.0-K.www);\nreturn c.z*mix(K.xxx,clamp(p-K.xxx,0.0,1.0),c.y);\n}\n",hue:"vec3 hue(float a){\nreturn hsv2rgb(vec3(a,1.,1.));\n}\n",imagc:"float imagc(vec2 a){\nreturn a.y;\n}\n",invc:"vec2 invc(vec2 a){\nfloat n=a.x*a.x+a.y*a.y;\nreturn vec2(a.x/n,-a.y/n);\n}\n",
logc:"vec2 logc(vec2 a){\nfloat re=a.x;\nfloat im=a.y;\nfloat s=sqrt(re*re+im*im);\nfloat i=im;\nfloat imag=atan(im,re);\nif(i<0.0){\nimag+= (2.0*pi);\n}\nif(i==0.0&&re<0.0){\nimag=pi;\n}\nif(imag>pi){\nimag-= (2.0*pi);\n};\nfloat real=log(s);\n\nreturn vec2(real,imag);\n}\n",logr:"vec2 logr(float a){\nif(a>=0.)return vec2(log(a),0);\nelse return vec2(log(-a),pi);\n}\n",mat2complex:"mat4 mat2complex(mat2 a)\n{\nreturn mat4(\nvec4(a[0][0],0,a[0][1],0),\nvec4(0,a[0][0],0,a[0][1]),\nvec4(a[1][0],0,a[1][1],0),\nvec4(0,a[1][0],0,a[1][1])\n);\n}\n",
multc:"vec2 multc(vec2 a,vec2 b){\nreturn vec2(a.x*b.x-a.y*b.y+0.0000000000000001,a.y*b.x+a.x*b.y);\n}\n",negc:"vec2 negc(vec2 a){\nreturn vec2(-a.x,-a.y);\n}\n",powc:"vec2 powc(vec2 a,vec2 b){\nreturn expc(multc(logc(a),b));\n}\n",powi:"float powi(float a,int b){\nreturn pow(a,float(b));\n}\n",random:"uniform float rnd_;\n\nfloat last_rnd= .1231;\nfloat random(){\nfloat a=mod(rnd_*plain_pixel.x*32.23,1.21);\nfloat b=mod(last_rnd*plain_pixel.y*54.21,1.32);\nlast_rnd=mod(a+b+12232.2213*(1.+rnd_)*dot(plain_pixel,plain_pixel)+a+sin(b)+b*sin(dot(plain_pixel,vec2(232.121+rnd_,2232.11))+last_rnd*121.11)*129.12+rnd_,1.);\nreturn last_rnd;\n\n\n}\n",
realc:"float realc(vec2 a){\nreturn a.x;\n}\n",red:"vec3 red(float f)\n{\nreturn vec3(clamp(f,0.,1.),0.,0.);\n}\n",rgb2hsv:"vec3 rgb2hsv(vec3 c)\n{\nvec4 K=vec4(0.0, -1.0/3.0,2.0/3.0, -1.0);\nvec4 p=mix(vec4(c.bg,K.wz),vec4(c.gb,K.xy),step(c.b,c.g));\nvec4 q=mix(vec4(p.xyw,c.r),vec4(c.r,p.yzx),step(p.x,c.r));\n\nfloat d=q.x-min(q.w,q.y);\nfloat e=1.0e-10;\nreturn vec3(abs(q.z+ (q.w-q.y) / (6.0*d+e)),d/ (q.x+e),q.x);\n}\n",sinc:"\n\nvec2 sinc(vec2 a){\n\nfloat n=exp(a.y);\nfloat imag1=n*sin(-a.x);\nfloat real1=n*cos(-a.x);\nn=exp(-a.y);\nfloat imag2=n*sin(a.x);\nfloat real2=n*cos(a.x);\nfloat r= -(imag1-imag2) /2.0;\nfloat i= (real1-real2) /2.0;\n\nreturn vec2(r,i);\n}\n",
sqrtc:"vec2 sqrtc(vec2 a){\nreturn expc(multc(logc(a),vec2(0.5,0.0)));\n}\n",sqrtf:"vec2 sqrtf(float a){\nif(a>=0.)return vec2(sqrt(a),0.);\nelse return vec2(0.,sqrt(-a));\n}\n",standardFragmentHeader:"#ifdef GL_ES\nprecision highp float;\n#endif\n\n#define pi 3.141592653589793\n\nvarying vec2 cgl_pixel;\nvarying vec2 plain_pixel;\n",subc:"vec2 subc(vec2 a,vec2 b){\nreturn a-b;\n}\n",tanc:"vec2 tanc(vec2 a){\nvec2 s=sinc(a);\nvec2 c=cosc(a);\nreturn divc(s,c);\n}\n",vec2complex:"vec4 vec2complex(vec2 a)\n{\nreturn vec4(a.x,0.,a.y,0);\n}\n",
vshader:"attribute vec3 aPos;\nattribute vec2 aTexCoord;\nvarying vec2 cgl_pixel;\nvarying vec2 plain_pixel;\nuniform mat3 transformMatrix;\nvoid main(void){\ngl_Position=vec4(aPos,1.);\nplain_pixel=aTexCoord;\nvec3 r=transformMatrix*vec3(plain_pixel,1);\ncgl_pixel=r.xy/r.z;\n}\n"};var ca=!1,h,da,l,n={},q,r={},u={},ea=!1,fa,ga=!1,ha=1,v={},w=[],ia=[];
function ja(){function a(c){h.removeEventListener("webglcontextcreationerror",a,!1);c.statusMessage&&(b=c.statusMessage)}if(!ca){h=document.createElement("canvas");h.id="glcanvas";h.style.display="none";h.width=h.height=0;document.body.appendChild(h);da=document.createElement("canvas");da.id="tmpcanvas";da.style.display="none";document.body.appendChild(da);var b="Unknown";h.addEventListener("webglcontextcreationerror",a,!1);(l=h.getContext("webgl"))||(l=h.getContext("experimental-webgl"));if(!l)throw new ka("Could not obtain a WebGL context.\nReason: "+
b);h.removeEventListener("webglcontextcreationerror",a,!1);ga=l.getExtension("OES_texture_float")&&l.getExtension("OES_texture_float_linear");ga||(console.error("Your browser does not suppert OES_texture_float, trying OES_texture_half_float..."),(ea=(fa=l.getExtension("OES_texture_half_float"))&&l.getExtension("OES_texture_half_float_linear"))||console.error("Your browser does not suppert OES_texture_half_float, will use 8-bit textures."));ca=!0}};function la(a){var b;if(null==a||"object"!=typeof a)return a;if(a instanceof Array){b=[];for(var c=0,d=a.length;c<d;c++)b[c]=la(a[c]);return b}if(a instanceof Object){b={};for(c in a)a.hasOwnProperty(c)&&0<="oper impl args ctype stack name modifs arglist value real imag key obj body".split(" ").indexOf(c)&&(b[c]=la(a[c]));return b}}function ma(a){return"number"===typeof a}
function na(a,b){if(a===b)return!0;if(ma(a)||ma(b))return a===b;for(var c in a)if(a.hasOwnProperty(c)&&(!b.hasOwnProperty(c)||!na(a[c],b[c])))return!1;for(var d in b)if(b.hasOwnProperty(d)&&!a.hasOwnProperty(d))return!1;return!0}function oa(a){return-1===a.indexOf("$")?a:a.substr(0,a.indexOf("$"))}
function pa(a){if("boolean"===a.ctype)return x;if("number"===a.ctype)return a=a.value,1E-10>Math.abs(a.imag)?(a.real|0)===a.real?y:A:B;if("list"===a.ctype){var b=a.value;if(0<b.length){for(var c=pa(b[0]),d=1;d<b.length;d++)c=qa(c,pa(b[d]));if(C(c,A)){if(2==b.length)return D;if(3==b.length)return E;if(4==b.length)return F}if(C(c,B)&&2==b.length)return G;if(c===D&&2==b.length)return H;if(c===G&&2==b.length)return ra;if(c===E&&3==b.length)return sa;if(c===F&&4==b.length)return ta}}else if("string"===
a.ctype)return I;console.error("Cannot guess type of "+JSON.stringify(a));return q}var ua=0;function va(){ua++;return"_helper"+ua}function wa(a,b){if(a>h.width||b>h.height)h.width=Math.ceil(a),h.height=Math.ceil(b)}function xa(a,b,c){a=a.getInitialMatrix();b=b-a.tx;c+=a.ty;return{x:(b*a.d-c*a.b)/a.det,y:-(-b*a.c+c*a.a)/a.det}}function ya(a){return xa(a,0,a.instance.canvas.clientHeight)}function za(a){return xa(a,a.instance.canvas.clientWidth,a.instance.canvas.clientHeight)}
var Aa=new Float32Array(1),Ba=new Int32Array(Aa.buffer);function Ca(a){Aa[0]=a;a=Ba[0];var b=a>>16&32768,c=(a&2147483647)+4096;if(1199570944<=c)return 1199570944<=(a&2147483647)?2139095040>c?b|31744:b|31744|(a&8388607)>>13:b|31743;if(947912704<=c)return b|c-939524096>>13;if(855638016>c)return b;c=(a&2147483647)>>23;return b|(a&8388607|8388608)+(8388608>>>c-102)>>126-c}
function Da(a){if(ga)return new Float32Array(a);if(ea){for(var b=new Uint16Array(a.length),c=0;c<a.length;c++)b[c]=Ca(a[c]);return b}b=new Uint8Array(a.length);for(c=0;c<a.length;c++)b[c]=255*a[c];return b}function Ea(a){for(var b=1;b<a;)b<<=1;return b};function Fa(a,b){if(!n.hasOwnProperty(a)){var c=b.getImage(a,!0);c instanceof Image&&!c.ready&&(console.error("Image not ready. Creating onload event."),c.onload=function(){c.ready=!0;n[a]=new Ga(c);console.log("Image "+a+" has been loaded now");ha++});n[a]=new Ga(c)}}
function Ga(a){this.A=a;this.v=a.width;this.u=a.height;this.C=Ea(this.v);this.D=Ea(this.u);this.h=0;da.width=this.C;da.height=this.D;var b=da.getContext("2d");b.translate(0,this.u);b.scale(1,-1);b.drawImage(a,0,0,this.v,this.u);b=b.getImageData(0,0,this.C,this.D).data;if(ga){for(var c=new Float32Array(b.length),d=0;d<b.length;d++)c[d]=b[d]/255;b=c}else if(ea){c=new Uint16Array(b.length);for(d=0;d<b.length;d++)c[d]=Ca(b[d]/255);b=c}else b=new Uint8Array(b);this.i=[];this.o=[];a.drawTo=this.B.bind(this);
a.cdyUpdate=this.G.bind(this);for(a=0;2>a;a++)this.i[a]=l.createTexture(),l.bindTexture(l.TEXTURE_2D,this.i[a]),l.pixelStorei(l.UNPACK_ALIGNMENT,1),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,this.C,this.D,0,l.RGBA,ga?l.FLOAT:ea?fa.HALF_FLOAT_OES:l.UNSIGNED_BYTE,b),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),this.o[a]=l.createFramebuffer(),l.bindFramebuffer(l.FRAMEBUFFER,this.o[a]),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,
l.TEXTURE_2D,this.i[a],0);this.l=new Ha(ba.copytexture_v,ba.copytexture_f);a=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,a);a=new Float32Array([-1,-1,0,1,-1,0,-1,1,0,1,1,0]);b=l.getAttribLocation(this.l.h,"aPos");l.enableVertexAttribArray(b);c=l.getAttribLocation(this.l.h,"aTexCoord");l.enableVertexAttribArray(c);var d=new Float32Array([0,0,1,0,0,1,1,1]),e=a.byteLength;l.bufferData(l.ARRAY_BUFFER,e+d.byteLength,l.STATIC_DRAW);l.bufferSubData(l.ARRAY_BUFFER,0,a);l.bufferSubData(l.ARRAY_BUFFER,e,d);
l.vertexAttribPointer(b,3,l.FLOAT,!1,0,0);l.vertexAttribPointer(c,2,l.FLOAT,!1,0,e)}Ga.prototype.bindTexture=function(){l.bindTexture(l.TEXTURE_2D,this.i[this.h])};Ga.prototype.bindFramebuffer=function(){l.bindFramebuffer(l.FRAMEBUFFER,this.o[this.h^1]);this.h^=1};Ga.prototype.G=function(){var a=this.A.getContext("2d");a.clearRect(0,0,this.v,this.u);this.B(a,0,0)};
Ga.prototype.B=function(a,b,c){wa(this.v,this.u);l.viewport(0,0,this.C,this.D);l.useProgram(this.l.h);l.activeTexture(l.TEXTURE0);l.bindTexture(l.TEXTURE_2D,this.i[this.h]);this.l.i.sampler([0]);l.bindFramebuffer(l.FRAMEBUFFER,null);l.drawArrays(l.TRIANGLE_STRIP,0,4);l.flush();a.drawImage(h,0,h.height-this.u,this.v,this.u,b,c,this.v,this.u)};function Ia(a,b){this.s=a;var c=Ja(new Ka(a),b);this.i=c.m;this.H=c.H;this.l=ba.standardFragmentHeader+c.code;this.o=ba.vshader;this.h=new Ha(this.o,this.l);c=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,c);var c=new Float32Array([-1,-1,0,1,-1,0,-1,1,0,1,1,0]),d=l.getAttribLocation(this.h.h,"aPos");l.enableVertexAttribArray(d);var e=l.getAttribLocation(this.h.h,"aTexCoord");l.enableVertexAttribArray(e);var f=new Float32Array([0,0,1,0,0,1,1,1]),g=c.byteLength;l.bufferData(l.ARRAY_BUFFER,g+f.byteLength,
l.STATIC_DRAW);l.bufferSubData(l.ARRAY_BUFFER,0,c);l.bufferSubData(l.ARRAY_BUFFER,g,f);l.vertexAttribPointer(d,3,l.FLOAT,!1,0,0);l.vertexAttribPointer(e,2,l.FLOAT,!1,0,g)};createCindy.registerPlugin(1,"CindyGL",function(a){function b(b,d,e,f,g,p){if(!b.M||b.L<ha)b.M=!0,b.L=ha,b.O=new Ia(a,b);b=b.O;var k=g/f,m=d.x+-(e.y-d.y)*k,k=d.y+(e.x-d.x)*k;wa(f,g);l.viewport(0,0,f,g);l.useProgram(b.h.h);d=[e.x-d.x,m-d.x,d.x,e.y-d.y,k-d.y,d.y,0,0,1];b.h.i.hasOwnProperty("transformMatrix")&&b.h.i.transformMatrix([d[0],d[3],d[6],d[1],d[4],d[7],d[2],d[5],d[8]]);for(var t in b.i)if(d=b.s.evaluateAndVal(b.i[t].w),g=b.i[t].type,e=b.h.i[t],void 0!==e)switch(g){case B:e([d.value.real,d.value.imag]);
break;case x:d.value?e([1]):e([0]);break;case y:case A:e([d.value.real]);break;case D:case E:case F:f=0;g===D&&(f=2);g===E&&(f=3);g===F&&(f=4);g=[];for(m=0;m<f;m++)g.push(d.value[m].value.real);e(g);break;case H:case sa:case ta:f=0;g===H&&(f=2);g===sa&&(f=3);g===ta&&(f=4);g=[];for(m=0;m<f;m++)for(k=0;k<f;k++)g.push(d.value[k].value[m].value.real);e(g);break;case G:e([d.value[0].value.real,d.value[0].value.imag,d.value[1].value.real,d.value[1].value.imag]);break;case ra:f=Array(16);for(g=0;2>g;g++)for(m=
0;2>m;m++)k=d.value[g].value[m].value,f[8*m+2*g]=k.real,f[4*(2*m+1)+2*g+1]=k.real,f[4*(2*m+1)+2*g]=-k.imag,f[8*m+2*g+1]=k.imag;e(f);break;default:console.error("Don't know how to set uniform"+t+", which has the type "+J(g)+", to "+d)}b.h.i.hasOwnProperty("rnd_")&&b.h.i.rnd_([Math.random()]);for(t=0;t<b.H.length;t++)l.activeTexture(l.TEXTURE0+t),d=b.H[t],e=n[d],e.bindTexture(),b.h.i["_sampler_"+d]([t]),b.h.i["_ratio_"+d]([e.v/e.u]),b.h.i["_cropfact_"+d]([e.v/e.C,e.u/e.D]);p?p.bindFramebuffer():l.bindFramebuffer(l.FRAMEBUFFER,
null);l.drawArrays(l.TRIANGLE_STRIP,0,4);l.flush()}q=a.nada;a.defineFunction("compile",1,function(b){b=Ja(new Ka(a),b[0]);console.log(b);return{ctype:"string",value:b}});a.defineFunction("forcerecompile",0,function(){ha++;return q});a.defineFunction("colorplot",1,function(c){ja();var d=a.instance.canvas.clientWidth,e=a.instance.canvas.clientHeight,f=a.instance.canvas.width,g=a.instance.canvas.height;b(c[0],ya(a),za(a),f,g,null);a.instance.canvas.getContext("2d").drawImage(h,0,0,f,g,0,0,d,e);return q});
a.defineFunction("colorplot",3,function(c){ja();var d=c[0],e=a.extractPoint(a.evaluateAndVal(c[1])),f=a.extractPoint(a.evaluateAndVal(c[2])),g={x:Math.min(e.x,f.x),y:Math.min(e.y,f.y)},p={x:Math.max(e.x,f.x),y:Math.min(e.y,f.y)};c=a.instance.canvas.clientWidth;var k=a.instance.canvas.clientHeight,m=a.instance.canvas.width,t=a.instance.canvas.height,z=xa(a,0,0),U=ya(a),aa=za(a),aa=Math.abs((e.x-f.x)/(U.x-aa.x)),z=Math.abs((e.y-f.y)/(z.y-U.y));b(d,g,p,m*aa,t*z,null);d=a.instance.canvas.getContext("2d");
g=Math.min(e.x,f.x);e=Math.max(e.y,f.y);f=a.getInitialMatrix();d.drawImage(h,0,h.height-t*z,m*aa,t*z,g*f.a-e*f.b+f.tx,g*f.c-e*f.d-f.ty,aa*c,z*k);return q});a.defineFunction("colorplot",4,function(c){ja();var d=a.extractPoint(a.evaluateAndVal(c[0])),e=a.extractPoint(a.evaluateAndVal(c[1])),f=a.evaluateAndVal(c[2]);c=c[3];if(!d.ok||!e.ok||"string"!==f.ctype)return q;var g=a.getImage(f.value,!0);if("undefined"===typeof g||null===g)return q;var p=g.width,g=g.height;Fa(f.value,a);b(c,d,e,p,g,n[f.value]);
return q});a.defineFunction("colorplot",2,function(c){ja();var d=ya(a),e=za(a),f=a.evaluateAndVal(c[0]);c=c[1];if("string"!==f.ctype)return q;var g=a.getImage(f.value,!0);if("undefined"===typeof g||null===g)return q;var p=g.width,k=g.height;n.hasOwnProperty(f.value)||(n[f.value]=new Ga(g));b(c,d,e,p,k,n[f.value]);return q});a.defineFunction("setpixel",4,function(b){var d;var e=a.evaluateAndVal(b[0]),f;f=void 0===f?null:f;"string"===e.ctype?d=e.value:(console.log("argument is not a string"),d=f);e=
La(a.evaluateAndVal(b[1]));f=La(a.evaluateAndVal(b[2]));b=Ma(a.evaluateAndVal(b[3]));if(isFinite(e)&&isFinite(f)&&d&&n.hasOwnProperty(d)&&b){d=n[d];d.bindTexture();b=[b[0],b[1],b[2],1];l.texSubImage2D(l.TEXTURE_2D,0,e,f,1,1,l.RGBA,ga?l.FLOAT:ea?fa.HALF_FLOAT_OES:l.UNSIGNED_BYTE,Da(b));d=d.A.getContext("2d");var g=d.createImageData(1,1);g.data.d=b;d.putImageData(g,e,f)}return q})});function C(a,b){return a===b?!0:ma(a)&&ma(b)?void 0===w[a]?!1:1073741824>w[a][b]:!1}var K=0;function qa(a,b){var c=void 0;if(C(b,a))return a;if(C(a,b)||!ma(a))return b;if(!ma(b))return a;for(var d=0;d<K;d++)C(a,d)&&C(b,d)&&(void 0===c?c=d:C(d,c)&&(c=d));return c}function Na(a){return{index:a,type:"template"}}var L={};
function Oa(a,b){for(var c in L[a]){for(var d=L[a][c],e=b.length===d.f.length,f={},g=0;g<b.length&&e;g++)"template"===d.f[g].type?(void 0===f[d.f[g].index]&&(f[d.f[g].index]=[]),f[d.f[g].index].push(b[g])):e&=C(b[g],d.f[g]);if(e){var p={},k;for(k in f){p[k]=f[k][0];for(var m in f[k])p[k]=qa(p[k],f[k][m]),void 0===p[k]&&(e=!1)}if(e){c={f:[]};for(g=0;g<b.length&&e;g++)c.f[g]="template"===d.f[g].type?p[d.f[g].index]:d.f[g];c.g="template"===d.g.type?p[d.g.index]:d.g;return c}}}return q};var x=1,y=2,A=3,B=4,D=6,E=7,F=8,H=11,sa=12,ta=13,I=14,G=16,ra=17,Pa={P:x,U:y,T:A,R:B,ea:5,aa:D,ca:E,da:F,color:9,Z:10,V:H,X:sa,Y:ta,$:I,S:15,ba:G,W:ra};Object.freeze(Pa);function J(a){return"bool int float complex voidt float[2] float[3] float[4] color point float[2,2] float[3,3] float[4,4] string 2D-Coordinate complex[2] complex[2,2]".split(" ")[a-1]}v[x]=[y];v[y]=[A];v[A]=[B,9];v[E]=[9,10];v[F]=[9];v[10]=[15];v[D]=[15,G];v[B]=[15];v[H]=[ra];
var Qa={f:[x],g:x},Ra={f:[x,x],g:x},Sa={f:[y],g:y},M={f:[y,y],g:y},Ta={f:[],g:A},N={f:[A],g:A},O={f:[A,A],g:A},P={f:[B],g:B},Q={f:[B,B],g:B},Ua={f:[D,D],g:D},Va={f:[E,E],g:E},Wa={f:[F,F],g:F},Xa={f:[A],g:B},R={f:[B],g:A},Ya={f:[B,B],g:A},Za={f:[D],g:A},$a={f:[E],g:A},ab={f:[F],g:A},bb={f:[D,D],g:A},cb={f:[E,E],g:A},db={f:[F,F],g:A},eb={f:[y,y],g:x},fb={f:[A,A],g:x},S=Na(1),gb=Na(2),hb=Na(3);L.sqrt=[Xa,P];L.abs=[N,R,Za,$a,ab];L.exp=[N,P];L.log=[Xa,P];L.sin=[N,P];L.cos=[N,P];L.tan=[N,P];
L.arccos=[Xa,P];L.arcsin=[Xa,P];L.arctan=[N,P];L.arctan2=[O,Q,R,{f:[D],g:A},{f:[G],g:B}];L.add=[M,O,Q,Ua,Va,Wa];L.sub=[M,O,Q,Ua,Va,Wa,{f:[5,y],g:y},{f:[5,A],g:A},{f:[5,B],g:B},{f:[5,D],g:D},{f:[5,E],g:E},{f:[5,F],g:F}];L.mult=[M,O];var ib=[B,D,E,F];ib.forEach(function(a){L.mult.push({f:[A,a],g:a});L.mult.push({f:[a,A],g:a})});L.mult=L.mult.concat([Q,{f:[H,D],g:D},{f:[ra,G],g:G},{f:[sa,E],g:E},{f:[ta,F],g:F}]);L.mult.push(bb);L.mult.push(cb);L.mult.push(db);L.div=[O,Q];
ib.forEach(function(a){L.div.push({f:[a,A],g:a})});L.pow=[{f:[A,y],g:A},{f:[B,B],g:B}];L.re=[R];L.conjugate=[P];L.im=[R];L.round=[{f:[A],g:y},{f:[B],g:B}];L.floor=[{f:[A],g:y},{f:[B],g:B}];L.ceil=[{f:[A],g:y},{f:[B],g:B}];L.mod=[M,O,Q];L.random=[Ta,N,P];L.randominteger=[Sa];L.randomint=[Sa];L.seedrandom=[{f:[A],g:5}];L.randombool=[{f:[],g:x}];L.randomnormal=[{f:[],g:A}];L.dist=[O,Ya,bb,cb,db];L._=[{f:[D,y],g:A},{f:[E,y],g:A},{f:[F,y],g:A},{f:[G,y],g:B}];L["^"]=L.pow;L["*"]=L.mult;L["/"]=L.div;
L["+"]=L.add;L["-"]=L.sub;[">","<",">=","<=","=="].forEach(function(a){return L[a]=[eb,fb]});L["&"]=[Ra];L["%"]=[Ra];L["="]=[{f:[S,gb],g:gb}];L[";"]=[{f:[S,5],g:S},{f:[S,gb],g:gb},{f:[S],g:S}];L.abs_infix=L.abs;L.dist_infix=L.dist;L.not=[Qa];L.and=[Ra];L.or=[Ra];L.xor=[Ra];"red green blue gray grey hue".split(" ").forEach(function(a){return L[a]=[{f:[A],g:E}]});L["if"]=[{f:[x,S,S],g:S},{f:[x,S,gb],g:5},{f:[x,S],g:S}];L.repeat=[{f:[y,S],g:S}];
L.apply=[{f:[{type:"list",length:S,N:gb},{type:"expression",f:gb,g:hb}],g:{type:"list",length:S,N:hb}}];L.min=[M,O];L.max=[M,O];L.complex=[{f:[D],g:B}];L.re=[R];L.im=[R];L.genList=[{f:[A,A],g:D},{f:[A,A,A],g:E},{f:[A,A,A,A],g:F},{f:[B,B],g:G}];L.imagergb=[{f:[I,15],g:E},{f:[15,15,I,15],g:E}];L.imagergba=[{f:[I,15],g:F},{f:[15,15,I,15],g:F}];Object.freeze(L);for(var jb in Pa)var kb=Pa[jb]+1,lb=K,K=lb>kb?lb:kb;
for(var w=Array(K),ia=Array(K),mb=0;mb<K;mb++){w[mb]=Array(K);ia[mb]=Array(K);for(var nb=0;nb<K;nb++)w[mb][nb]=1073741824,ia[mb][nb]=-1;w[mb][mb]=0}for(var ob=0;ob<K;ob++)for(var pb in v[ob]){var qb=v[ob][pb];w[ob][qb]=1;ia[ob][qb]=qb}for(var rb=0;rb<K;rb++)for(var sb=0;sb<K;sb++)for(var tb=0;tb<K;tb++)w[sb][rb]+w[rb][tb]<w[sb][tb]&&(w[sb][tb]=w[sb][rb]+w[rb][tb],ia[sb][tb]=ia[sb][rb]);Object.freeze(v);Object.freeze(w);Object.freeze(ia);var T={};function ub(a,b){if(!b.J.hasOwnProperty(a)){b.J[a]=!0;for(var c in T[a])ub(T[a][c],b);b.K.push(ba[a])}}function V(a){return function(b,c){ub(a,c);return W(a)(b)}};function Ka(a){this.o={};this.l={};this.h={};this.m={};this.J={};this.K=[];this.G={};this.B=[];this.A=!1;this.i={};this.s=a;this.F={}}function vb(a,b,c,d){if(!C(c,d))return console.error(J(c)+" is no subtype of "+J(d)+" (trying to cast the term "+b+")"),b;if(c===d)return b;var e=ia[c][d];return X.hasOwnProperty(c)&&X[c].hasOwnProperty(e)?vb(a,X[c][e](b,a),e,d):(console.error("CindyGL: No type-inclusion function for "+J(c)+" to "+J(e)+" found. \n Using identity"),vb(a,b,e,d))}
function wb(a,b,c){if(b.isuniform)return a.m[b.uvariable].type;if("variable"===b.ctype){b=b.name;if("#"===b)return D;if(a.h.hasOwnProperty(c)&&a.h[c].hasOwnProperty(b))return a.h[c][b];if(a.h.hasOwnProperty("")&&a.h[""].hasOwnProperty(b))return a.h[""][b]}else if("function"===b.ctype&&a.i.hasOwnProperty(b.oper)){if(a.h.hasOwnProperty("")&&a.h[""].hasOwnProperty(b.oper))return a.h[""][b.oper]}else{if("number"===b.ctype)return 0!==b.value.imag?B:(b.value.real|0)===b.value.real?y:A;if("void"===b.ctype)return 5;
if("field"===b.ctype)return A;if("string"===b.ctype)return I;for(var d=Array(b.args.length),e=0;e<b.args.length;e++)d[e]=xb(a,b.args[e],c);a=Oa(oa(b.oper),d);return void 0===a||a===q?q:a.g}return q}function xb(a,b,c){a.A&&b.hasOwnProperty("computedType")||(b.computedType=wb(a,b,c));return b.computedType}
function yb(a,b){function c(a,b){d.hasOwnProperty(b)||(d[b]=[]);e.hasOwnProperty(b)||(e[b]={});for(var k in a.args)c(a.args[k],b);if("="===a.oper){var m=a.args[0].name;k=b;-1===d[b].indexOf(m)&&(k="",-1===d[k].indexOf(m)&&(d[k].push(m),e[k][m]=[]));e[k][m].push({w:a.args[1],I:b})}else if(void 0!==a.oper&&"regional"===oa(a.oper))for(m=0;m<a.args.length;m++)"variable"===a.args[m].ctype&&(k=a.args[m].name,-1===d[b].indexOf(k)&&(d[b].push(k),e[b][k]=[]));else if("function"===a.ctype&&f.hasOwnProperty(a.oper)){k=
a.oper;d.hasOwnProperty(k)||(d[k]=[]);e.hasOwnProperty(k)||(e[k]={});for(m in f[k].arglist){var t=f[k].arglist[m].name;d[k].push(t);e[k].hasOwnProperty(t)||(e[k][t]=[]);e[k][t].push({w:a.args[m],I:b})}c(f[k].body,k);-1===d[""].indexOf(k)&&(d[""].push(k),e[""][k]=[{w:f[k].body,I:k}])}}var d={},e={},f=a.i;c(b,"");a.o=d;a.l=e}
function zb(a,b){function c(a,b){if(a.hasOwnProperty("dependsOnPixel")&&!0===a.dependsOnPixel)return!0;if("variable"===a.ctype){var d=a.name;return e.hasOwnProperty(b)&&e[b][d]||-1===f[b].indexOf(d)&&e.hasOwnProperty("")&&e[""][d]?a.dependsOnPixel=!0:a.dependsOnPixel=!1}for(d in a.args)if(c(a.args[d],b))return a.dependsOnPixel=!0;return"function"===a.ctype&&"random"===oa(a.oper)||"function"===a.ctype&&g.hasOwnProperty(a.oper)&&(d=a.oper,e.hasOwnProperty(d)||(e[d]={}),c(g[d].body,d))?a.dependsOnPixel=
!0:"field"===a.ctype?a.dependsOnPixel=c(a.obj,b):!1}function d(a,b){if(c(a,b)){for(var e in a.args)d(a.args[e],b);"field"===a.ctype&&d(a.obj,b);"function"===a.ctype&&g.hasOwnProperty(a.oper)&&(e=a.oper,m.hasOwnProperty(e)||(m[e]=!0,d(g[e].body,e)))}else"number"!==a.ctype&&"string"!==a.ctype&&"void"!==a.ctype&&(e=va(),a.isuniform=!0,a.uvariable=e,t[e]={w:a,type:q})}var e={"":{"#":!0}},f=a.o,g=a.i,p;for(p in a.l)for(var k in a.l[p])e.hasOwnProperty(p)||(e[p]={}),e[p][k]=!0;c(b,"");var m={"":!0},t={};
d(b,"");a.m=t}function Ab(a,b){if("function"===b.ctype&&!a.i.hasOwnProperty(b.oper)&&null!==a.s.getMyfunction(b.oper)){var c=b.oper;a.i[c]=la(a.s.getMyfunction(c));Ab(a,a.i[c].body)}for(var d in b.args)Ab(a,b.args[d])}
function Y(a,b,c,d){if(b.isuniform){b=b.uvariable;var e=a.m[b].type;return d?{code:"",j:b,type:e}:{code:""}}if(";"===b.oper){for(var e={type:5,j:""},f="",g=b.args.length-1,p=g;0<=p;p--)"void"===b.args[p].ctype&&g--;for(p=0;p<=g;p++)e=Y(a,b.args[p],c,d&&p===g),f+=e.code;return d?{code:f,j:e.j,type:e.type}:{code:f}}if("="===b.oper)return e=Y(a,b.args[1],c,!0),f=b.args[0].name,b=f+" = "+vb(a,e.j,e.type,xb(a,b.args[0],c)),d?{code:e.code,j:b,type:a.h[c][f]}:{code:e.code+b+";\n"};if("repeat$2"===b.oper){if("number"!==
b.args[0].ctype)return console.error("repeat possible only for fixed constant number in GLSL"),q;e=va();f=b.args[0].value.real|0;b=Y(a,b.args[1],c,d);p=g="";d&&(p=va(),g+=r[b.type]+" "+p+";");g=g+("for(int "+e+"=0; "+e+" < "+f+"; "+e+"++) {\n")+b.code;d&&(g+=p+" = "+b.j+";\n");g+="}\n";return d?{code:g,j:p,type:b.type}:{code:g}}if("repeat$3"===b.oper)console.error("TODO");else{if("if$2"===b.oper||"if$3"===b.oper){var p=Y(a,b.args[0],c,!0),k=Y(a,b.args[1],c,d),f=e="",g=xb(a,b,c);d&&(f=va(),e+=r[g]+
" "+f+";");e+=p.code;e+="if("+p.j+") {\n";e+=k.code;d&&(e+=f+" = "+vb(a,k.j,k.type,g)+";\n");"if$3"===b.oper&&(b=Y(a,b.args[2],c,d),e=e+"} else {\n"+b.code,d&&(e+=f+" = "+vb(a,b.j,b.type,g)+";\n"));e+="}\n";return d?{code:e,j:f,type:g}:{code:e}}if("function"===b.ctype||"infix"===b.ctype){var m=b.oper;b=b.args.map(function(b){return Y(a,b,c,!0)});f=b.map(function(a){return a.type});if(a.i.hasOwnProperty(m)){e=Bb(a,m);g=Array(b.length);for(p=0;p<b.length;p++)g[p]=a.h[m][a.i[m].arglist[p].name];p=a.h[""][m]}else{m=
oa(m);if("regional"===m)return d?{j:"",type:5,code:""}:{code:""};var t=Oa(m,f);if(t===q)return console.error("Could not find a signature for "+m+"("+f.map(J).join(", ")+").\nReturning empty code"),d?{j:"",type:5,code:""}:{code:""};g=t.f;p=t.g;e=q;for(k in u[m])if(na(u[m][k][0],t)){e=u[m][k][1];break}e===q&&(console.error("There is no webgl-implementation for "+m+"("+t.f.map(J).join(", ")+").\ndefualt: Try glsl-function with same name"),e=function(a){return m+"("+a.join(", ")+")"})}for(var k="",t=
Array(b.length),z=0;z<b.length;z++)k+=b[z].code,t[z]=vb(a,b[z].j,f[z],g[z]);b=e(t,a);return d?{j:b,type:p,code:k}:{code:k+b+";\n"}}if("number"===b.ctype)return f=xb(a,b,c),f===y?e=b.value.real|0:f===A?e=b.value.real:f===B&&(e="vec2( "+b.value.real+", "+b.value.imag+")"),d?{j:e,type:f,code:""}:{code:f+";\n"};if("string"===b.ctype)return e=I,b=b.value,d?{j:b,type:e,code:""}:{code:e+";\n"};if("variable"===b.ctype)return e=xb(a,b,c),b=b.name,"#"===b&&(b="cgl_pixel"),d?{j:b,type:e,code:""}:{code:b+";\n"};
if("void"===b.ctype)return d?{j:"",type:5,code:""}:{code:""};if("field"===b.ctype)return e=xb(a,b,c),f=Y(a,b.obj,c,!0).j,f+="."+b.key,d?{j:f,type:e,code:""}:{code:f+";\n"}}console.error("dont know how to this.compile "+JSON.stringify(b))}function Bb(a,b){Cb(a,b,a.i[b].arglist.length);return W(b)}
function Cb(a,b,c){if(!a.G.hasOwnProperty(b)){a.G[b]=!0;for(var d=a.i[b],e=Array(c),f=0;f<c;f++)e[f]=d.arglist[f].name;c=5===r[a.h[""][b]];var f=r[a.h[""][b]]+" "+oa(b)+"("+e.map(function(c){return r[a.h[b][c]]+" "+c}).join(", ")+"){\n",g;for(g in a.o[b]){for(var p=!0,k=a.o[b][g],m=0;m<e.length;m++)p&=k!==e[m];p&&(f+=r[a.h[b][k]]+" "+k+";\n")}d=Y(a,d.body,b,!c);f+=d.code;c||(f+="return "+vb(a,d.j,d.type,a.h[""][b])+";\n");a.B.push(f+"}\n")}}
function Ja(a,b){var c=b=la(b);a.A=!1;Ab(a,c);yb(a,c);zb(a,c);for(var d in a.m)a.m[d].type=A,c=a.s.evaluateAndVal(a.m[d].w),a.m[d].type=pa(c),console.log("guessed type "+J(a.m[d].type)+" for "+JSON.stringify(a.m[d].w.name)+" because it has value "+JSON.stringify(c.value));for(d=!0;d;){d=!1;for(var e in a.l)for(var f in a.l[e])for(var g in a.l[e][f]){var c=xb(a,a.l[e][f][g].w,a.l[e][f][g].I),p=q;a.h.hasOwnProperty(e)&&a.h[e].hasOwnProperty(f)&&(p=a.h[e][f]);var k=p;c!==q&&(k=p===q?c:C(c,p)?p:qa(p,
c),k!==q&&k!==p&&(a.h.hasOwnProperty(e)||(a.h[e]={}),a.h[e][f]=k,console.log("variable "+f+" in scope "+e+" got type "+J(k)+" (oltype/othertype is "+J(p)+"/"+J(c)+")"),d=!0))}}a.A=!0;e=Y(a,b,"",!0);f=vb(a,e.j,e.type,9);C(e.type,9)||console.error("expression does not generate a color");var m;g=[];for(m in a.m)g.push("uniform "+r[a.m[m].type]+" "+m+";");m=g.join("\n");g="";for(var t in a.F)g+=a.F[t]+"\n";m=m+g+a.K.join("\n");for(var z in a.o[""])t=a.o[""][z],a.i.hasOwnProperty(t)||(m+=r[a.h[""][t]]+
" "+t+";\n");m+=a.B.join("\n");m+="void main(void) {\n"+e.code+"gl_FragColor = "+f+";\n}\n";console.log(m);z=[];for(var U in a.F)z.push(U);return{code:m,m:a.m,H:z}};function Db(a,b){var c=a[2];if(null==b.s.getImage(c,!0))return console.error("Could not find image "+c+"."),q;Fa(c,b.s);b.F.hasOwnProperty(c)||(b.F[c]=["uniform sampler2D _sampler_",c,";uniform float _ratio_",c,";uniform vec2 _cropfact_",c,";vec4 _imagergba_",c,"(vec2 A, vec2 B, vec2 p) {p -= A; B -= A;float b = dot(B,B);p = vec2(dot(p,B),_ratio_",c,"*dot(p,vec2(-B.y,B.x)))/b;if(0. <= p.x && p.x <= 1. && 0. <= p.y && p.y <= 1.)return texture2D(_sampler_",c,", p*_cropfact_",c,");else return vec4(0.);}vec3 _imagergb_",
c,"(vec2 A, vec2 B, vec2 p) {return _imagergba_",c,"(A, B, p).rgb;}"].join(""));return["_imagergba_",c,"(",a[0],",",a[1],",",a[3],")"].join("")};r[x]="bool";r[y]="int";r[A]="float";r[B]="vec2";r[5]="void";r[D]="vec2";r[E]="vec3";r[F]="vec4";r[H]="mat2";r[sa]="mat3";r[ta]="mat4";r[9]="vec4";r[10]="vec3";r[15]="vec2";r[G]="vec4";r[ra]="mat4";Object.freeze(r);function W(a){return function(b){return oa(a)+"("+b+")"}}function Z(a){return function(b){return"("+b.join(a)+")"}}function Eb(a){return a}var X={},Fb;for(Fb in Pa)X[Pa[Fb]]={};X[x][y]=W("int");X[y][A]=W("float");X[A][B]=function(a){return"vec2("+a+", 0.)"};X[A][9]=V("float2color");
X[9][E]=function(a){return"("+a+").rgb"};X[9][F]=Eb;X[D][10]=function(a){return"vec3("+a+",1.0)"};X[E][9]=function(a){return"vec4("+a+",1.0)"};X[E][10]=Eb;X[F][9]=Eb;X[10][D]=V("dehomogenize");X[10][E]=Eb;X[10][15]=V("dehomogenize");X[D][15]=Eb;X[B][15]=Eb;X[D][G]=V("vec2complex");X[H][ra]=V("mat2complex");Object.freeze(X);u.sqrt=[[Xa,V("sqrtf")],[P,V("sqrtc")]];u.abs=[[N,W("abs")],[R,W("length")],[Za,W("length")],[$a,W("length")],[ab,W("length")]];u.abs_infix=u.abs;
u.dist=[[O,function(a){return W("abs")(Z("-")(a))}],[Ya,function(a){return W("length")(Z("-")(a))}],[bb,function(a){return W("length")(Z("-")(a))}],[cb,function(a){return W("length")(Z("-")(a))}],[db,function(a){return W("length")(Z("-")(a))}]];u.dist_infix=u.dist;u.sin=[[N,W("sin")],[P,V("sinc")]];u.cos=[[N,W("cos")],[P,V("cosc")]];u.tan=[[N,W("tan")],[P,V("tanc")]];u.exp=[[N,W("exp")],[P,V("expc")]];u.arctan=[[N,W("atan")],[P,V("arctanc")]];u.log=[[Xa,V("logr")],[P,V("logc")]];u.add=[];u.sub=[];
[M,O,Q,Ua,Va,Wa].forEach(function(a){u.add.push([a,Z("+")]);u.sub.push([a,Z("-")])});function Gb(a){return"-("+a[1]+")"}[y,A,B,D,E,F].forEach(function(a){u.sub.push([{f:[5,a],g:a},Gb])});function Hb(a){return isFinite(a[1])?"("+a[0]+")["+(a[1]-1)+"]":"("+a[0]+")["+a[1]+"-1]"}
u._=[[{f:[D,y],g:A},Hb],[{f:[E,y],g:A},Hb],[{f:[F,y],g:A},Hb],[{f:[G,y],g:B},function(a){if(1===a[1])return"("+a[0]+").xy";if(2===a[1])return"("+a[0]+").zw";console.error("access of components of complex[2] only works for indeces that were hardcoded in CindyJS");return"ERROR: SEE CONSOLE (index was "+a[1]+") \n"}]];u["+"]=u.add;u["-"]=u.sub;
u.mult=[[M,Z("*")],[O,Z("*")],[Q,V("multc")],[{f:[H,D],g:D},Z("*")],[{f:[ra,G],g:G},Z("*")],[{f:[sa,E],g:E},Z("*")],[{f:[ta,F],g:F},Z("*")],[bb,W("dot")],[cb,W("dot")],[db,W("dot")]];ib.forEach(function(a){u.mult.push([{f:[A,a],g:a},Z("*")]);u.mult.push([{f:[a,A],g:a},Z("*")])});u["*"]=u.mult;u.div=[[O,Z("/")],[Q,V("divc")]];ib.forEach(function(a){u.div.push([{f:[a,A],g:a},Z("/")])});u["/"]=u.div;u.re=[[R,V("realc")]];u.im=[[R,V("imagc")]];
u.floor=[[{f:[A],g:y},function(a){return"int(floor("+a+"))"}],[{f:[B],g:B},W("floor")]];u.round=[[{f:[A],g:y},function(a){return"int(floor("+a+"+.5))"}],[{f:[B],g:B},function(a){return"floor("+a+"+vec2(.5))"}]];u.ceil=[[{f:[A],g:y},function(a){return"int(ceil("+a+"))"}],[{f:[B],g:B},W("ceil")]];u.mod=[[M,Z("%")],[O,W("mod")]];u.random=[[Ta,V("random")],[N,function(a,b){return V("random")([],b)+"*"+a[0]}],[P,function(a,b){return"vec2("+V("random")([],b)+","+V("random")([],b)+")*"+a[0]}]];
u.arctan2=[[O,function(a){return"atan("+a[1]+", "+a[0]+")"}],[Q,V("arctan2c")],[R,V("arctan2vec2")],[{f:[D],g:A},V("arctan2vec2")],[{f:[G],g:B},V("arctan2vec2c")]];["red","green","blue","gray","hue"].forEach(function(a){return u[a]=[[{f:[A],g:E},V(a)]]});u.grey=u.gray;u.min=[[M,W("min")],[O,W("min")]];u.max=[[M,W("max")],[O,W("max")]];u.complex=[[{f:[D],g:B},Eb]];u.pow=[[{f:[A,y],g:A},function(a){return"pow("+a[0]+", float("+a[1]+"))"}],[{f:[B,B],g:B},V("powc")]];u["^"]=u.pow;
u.re=[[R,function(a){return"("+a+").x"}]];u.conjugate=[[P,V("conjugate")]];u.im=[[R,function(a){return"("+a+").y"}]];u.genList=[[{f:[A,A],g:D},W("vec2")],[{f:[A,A,A],g:E},W("vec3")],[{f:[A,A,A,A],g:F},W("vec4")],[{f:[B,B],g:G},W("vec4")]];u["&"]=[[Ra,Z("&&")]];u["%"]=[[Ra,Z("||")]];[">","<",">=","<=","=="].forEach(function(a){return u[a]=[[eb,Z(a)],[fb,Z(a)]]});
u.imagergb=[[{f:[I,15],g:E},function(a,b){var c=a[0];Db(["",""].concat(a),b);var d=ya(b.s),e=za(b.s);return["_imagergb_",c,"(vec2(",d.x,",",d.y,"),vec2(",e.x,",",e.y,"), ",a[1],")"].join("")}],[{f:[15,15,I,15],g:E},function(a,b){var c=a[2];Db(a,b);return["_imagergb_",c,"(",a[0],",",a[1],",",a[3],")"].join("")}]];
u.imagergba=[[{f:[I,15],g:F},function(a,b){var c=a[0];Db(["",""].concat(a),b);var d=ya(b.s),e=za(b.s);return["_imagergba_",c,"(vec2(",d.x,",",d.y,"),vec2(",e.x,",",e.y,"), ",a[1],")"].join("")}],[{f:[15,15,I,15],g:F},Db]];Object.freeze(u);T.divc=["multc"];T.powc=["expc","multc","logc"];T.sqrtc=["expc","multc","logc"];T.arccosc=["multc","negc","sqrtc","addc","logc"];T.arcsinc=["multc","negc","sqrtc","addc","logc"];T.tanc=["sinc","cosc","divc"];T.arctanc=["logc","addc","multc","subc"];
T.arctan2c=["logc","divc","sqrtc","multc"];T.arctan2vec2c=["arctan2c"];T.hue=["hsv2rgb"];Object.freeze(T);function Ib(a){var b;b=void 0===b?null:b;return"list"!==a.ctype?(console.log("argument is not a list"),b):a.value}function Ma(a){var b;b=void 0===b?[.5,.5,.5]:b;if("number"===a.ctype){var c=Jb(a);if(!isNaN(c))return[c,c,c]}a=Ib(a);return null===a?b:3!=a.length?(console.log("Not an RGB color vector"),b):a.map(function(a){return Jb(a)})}
function La(a){var b;b=void 0===b?Number.NaN:b;if("number"!==a.ctype)return console.log("argument is not a number"),b;b=a.value;a=b.real;b=b.imag;0!==b&&console.log("complex number is not real");b=Math.round(a);b!==a&&console.log("number is not an integer");return b}
function Jb(a){var b;b=void 0===b?Number.NaN:b;b=void 0===b?Number.NaN:b;"number"!==a.ctype?(console.log("argument is not a number"),a=b):(a=a.value,b=a.real,0!==a.imag&&console.log("complex number is not real"),a=b);return 0>a?0:1<a?1:a};function ka(a){this.h=a}ka.prototype.toString=function(){return this.h};
function Ha(a,b){var c=l;this.h=c.createProgram();Kb(this,c,c.VERTEX_SHADER,a);Kb(this,c,c.FRAGMENT_SHADER,b);var d=this.h;c.linkProgram(d);if(!c.getProgramParameter(d,c.LINK_STATUS))throw new ka("Error linking shader:\n"+c.getProgramInfoLog(d));c.validateProgram(d);if(!c.getProgramParameter(d,c.VALIDATE_STATUS))throw new ka("Error validating shader:\n"+c.getProgramInfoLog(d));var e,f=this.h,g,p,k,m={},t,z,U,aa;e=c.getProgramParameter(f,c.ACTIVE_UNIFORMS);for(d=0;d<e;++d)if(g=c.getActiveUniform(f,
d),null!==g&&(p=g.name.replace(/\]/g,""))){for(t=m;null!==(k=/[.\[]/.exec(p));)z=p.substr(0,k.index),t.hasOwnProperty(z)?t=t[z]:"."===k[0]?t=t[z]={}:t=t[z]=[],p=p.substr(k.index+1);if(1<g.size){k=g.size;aa=Array(k);for(z=0;z<k;++z)U=g.name+"["+z+"]",U=Lb(this,c,U,g),aa[z]=U;t[p]=aa}else U=Lb(this,c,g.name,g),t[p]=U}this.i=m}
function Kb(a,b,c,d){c=b.createShader(c);b.shaderSource(c,d);b.compileShader(c);if(!b.getShaderParameter(c,b.COMPILE_STATUS))throw console.warn(d.split("\n")),new ka("Error compiling shader:\n"+b.getShaderInfoLog(c));b.attachShader(a.h,c)}
function Lb(a,b,c,d){a=b.getUniformLocation(a.h,c);switch(d.type){case b.FLOAT:return b.uniform1fv.bind(b,a);case b.FLOAT_VEC2:return b.uniform2fv.bind(b,a);case b.FLOAT_VEC3:return b.uniform3fv.bind(b,a);case b.FLOAT_VEC4:return b.uniform4fv.bind(b,a);case b.BOOL:case b.INT:case b.SAMPLER_2D:case b.SAMPLER_CUBE:return b.uniform1iv.bind(b,a);case b.BOOL_VEC2:case b.INT_VEC2:return b.uniform2iv.bind(b,a);case b.BOOL_VEC3:case b.INT_VEC3:return b.uniform3iv.bind(b,a);case b.BOOL_VEC4:case b.INT_VEC4:return b.uniform4iv.bind(b,
a);case b.FLOAT_MAT2:return b.uniformMatrix2fv.bind(b,a,!1);case b.FLOAT_MAT3:return b.uniformMatrix3fv.bind(b,a,!1);case b.FLOAT_MAT4:return b.uniformMatrix4fv.bind(b,a,!1);default:throw new ka("Unknown data type for uniform "+c);}};
})();//# sourceMappingURL=CindyGL.js.map


